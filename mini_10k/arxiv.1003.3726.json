{"id": "http://arxiv.org/abs/1003.3726v2", "guidislink": true, "updated": "2011-01-17T13:26:21Z", "updated_parsed": [2011, 1, 17, 13, 26, 21, 0, 17, 0], "published": "2010-03-19T06:56:31Z", "published_parsed": [2010, 3, 19, 6, 56, 31, 4, 78, 0], "title": "Escape probabilities for branching Brownian motion among mild obstacles", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1003.2870%2C1003.2633%2C1003.1043%2C1003.4671%2C1003.0603%2C1003.1252%2C1003.2050%2C1003.4980%2C1003.5242%2C1003.1013%2C1003.3345%2C1003.2008%2C1003.2847%2C1003.0817%2C1003.5062%2C1003.5757%2C1003.5694%2C1003.4005%2C1003.0147%2C1003.3591%2C1003.6058%2C1003.6082%2C1003.4394%2C1003.1295%2C1003.5926%2C1003.3111%2C1003.2103%2C1003.5591%2C1003.5466%2C1003.3049%2C1003.2548%2C1003.1086%2C1003.0553%2C1003.4819%2C1003.3726%2C1003.5460%2C1003.2858%2C1003.4172%2C1003.3482%2C1003.4859%2C1003.4752%2C1003.0619%2C1003.3656%2C1003.5024%2C1003.1921%2C1003.5947%2C1003.4098%2C1003.6096%2C1003.2105%2C1003.2828%2C1003.4633%2C1003.0634%2C1003.3293%2C1003.0434%2C1003.6020%2C1003.0229%2C1003.3686%2C1003.1841%2C1003.1716%2C1003.2033%2C1003.3517%2C1003.0863%2C1003.3244%2C1003.3178%2C1003.0431%2C1003.2277%2C1003.4369%2C1003.1146%2C1003.5921%2C1003.0512%2C1003.1138%2C1003.0265%2C1003.1468%2C1003.0396%2C1003.4177%2C1003.0364%2C1003.1312%2C1003.0374%2C1003.2551%2C1003.0934%2C1003.4471%2C1003.5705%2C1003.5955%2C1003.3985%2C1003.2135%2C1003.3125%2C1003.2936%2C1003.5369%2C1003.4249%2C1003.0613%2C1003.1464%2C1003.4725%2C1003.5235%2C1003.0349%2C1003.5850%2C1003.2946%2C1003.4598%2C1003.0204%2C1003.3251%2C1003.0282%2C1003.1203&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Escape probabilities for branching Brownian motion among mild obstacles"}, "summary": "We derive asymptotics for the quenched probability that a critical branching\nBrownian motion killed at a small rate in Poissonian obstacles exits a large\ndomain. Results are formulated in terms of the solution to a semilinear partial\ndifferential equation with singular boundary conditions. The proofs depend on a\nquenched homogenization theorem for branching Brownian motion among mild\nobstacles.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1003.2870%2C1003.2633%2C1003.1043%2C1003.4671%2C1003.0603%2C1003.1252%2C1003.2050%2C1003.4980%2C1003.5242%2C1003.1013%2C1003.3345%2C1003.2008%2C1003.2847%2C1003.0817%2C1003.5062%2C1003.5757%2C1003.5694%2C1003.4005%2C1003.0147%2C1003.3591%2C1003.6058%2C1003.6082%2C1003.4394%2C1003.1295%2C1003.5926%2C1003.3111%2C1003.2103%2C1003.5591%2C1003.5466%2C1003.3049%2C1003.2548%2C1003.1086%2C1003.0553%2C1003.4819%2C1003.3726%2C1003.5460%2C1003.2858%2C1003.4172%2C1003.3482%2C1003.4859%2C1003.4752%2C1003.0619%2C1003.3656%2C1003.5024%2C1003.1921%2C1003.5947%2C1003.4098%2C1003.6096%2C1003.2105%2C1003.2828%2C1003.4633%2C1003.0634%2C1003.3293%2C1003.0434%2C1003.6020%2C1003.0229%2C1003.3686%2C1003.1841%2C1003.1716%2C1003.2033%2C1003.3517%2C1003.0863%2C1003.3244%2C1003.3178%2C1003.0431%2C1003.2277%2C1003.4369%2C1003.1146%2C1003.5921%2C1003.0512%2C1003.1138%2C1003.0265%2C1003.1468%2C1003.0396%2C1003.4177%2C1003.0364%2C1003.1312%2C1003.0374%2C1003.2551%2C1003.0934%2C1003.4471%2C1003.5705%2C1003.5955%2C1003.3985%2C1003.2135%2C1003.3125%2C1003.2936%2C1003.5369%2C1003.4249%2C1003.0613%2C1003.1464%2C1003.4725%2C1003.5235%2C1003.0349%2C1003.5850%2C1003.2946%2C1003.4598%2C1003.0204%2C1003.3251%2C1003.0282%2C1003.1203&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We derive asymptotics for the quenched probability that a critical branching\nBrownian motion killed at a small rate in Poissonian obstacles exits a large\ndomain. Results are formulated in terms of the solution to a semilinear partial\ndifferential equation with singular boundary conditions. The proofs depend on a\nquenched homogenization theorem for branching Brownian motion among mild\nobstacles."}, "authors": ["Jean-Francois Le Gall", "Amandine Veber"], "author_detail": {"name": "Amandine Veber"}, "author": "Amandine Veber", "arxiv_comment": "24 pages, to appear in Journal of Theoretical Probability", "links": [{"href": "http://arxiv.org/abs/1003.3726v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1003.3726v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "Primary: 60K37, 60J80. Secondary: 60J68", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1003.3726v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1003.3726v2", "journal_reference": null, "doi": null, "fulltext": "Escape probabilities for branching Brownian motion\namong mild obstacles\n\narXiv:1003.3726v2 [math.PR] 17 Jan 2011\n\nJean-Fran\u00e7ois Le Gall, Amandine V\u00e9ber\nJune 15, 2018\n\nAbstract\nWe derive asymptotics for the quenched probability that a critical branching Brownian motion\nkilled at a small rate \u03b5 in Poissonian obstacles exits a large domain. Results are formulated in terms\nof the solution to a semilinear partial differential equation with singular boundary conditions. The\nproofs depend on a quenched homogenization theorem for branching Brownian motion among mild\nobstacles.\nKeywords and phrases. Branching Brownian motion, Poissonian obstacles, super-Brownian\nmotion, escape probability, homogenization, semilinear partial differential equation.\nMSC2010 Classification Numbers. Primary: 60K37, 60J80. Secondary: 60J68.\n\n1\n\nIntroduction\n\nIn the present work, we are interested in the long-term behaviour of branching Brownian motion killed\nin Poissonian obstacles. Let us start by describing a simple special case of our results. We consider\na critical branching Brownian motion in Rd (d \u2265 1), where all initial particles start from the origin.\nWe assume that particles are killed at a (small) rate \u03b5 > 0 within random balls of fixed radius, whose\ncenters are distributed according to a homogeneous Poisson point process on Rd . Then, how many\ninitial particles do we need so that, with high probability, one of their descendants reaches distance R\nfrom the origin ? Let p\u03b5 (R) be the (quenched) probability for our randomly killed branching Brownian\nmotion starting with a single particle at 0 to visit the complement of a large ball of radius R centered\nat the origin. The preceding question is equivalent to determining the limiting behaviour of p\u03b5 (R)\nwhen \u03b5 tends to 0 and simultaneously R tends to infinity.\nThe answer involves several regimes depending on the respective values of \u03b5 and R. If \u03b5 is small\nin comparison with 1/R2 , the killing phenomenon does not matter and the result is the same as if\nthere were no killing: p\u03b5 (R) behaves like a constant times 1/R2 (informally, the branching process\nmust survive up to a time of order R2 so that at least one of the particles travels a distance R, and\nwell-known estimates for critical branching processes then lead to the correct asymptotics). On the\nother hand, if \u03b5 is large in comparison with 1/R2 , then the probability p\u03b5 (R) decreases exponentially\n\u221a\nfast as a function of R \u03b5: See Proposition 1 below.\nOur main results focus on the critical regime where \u03b5R2 converges to a constant a > 0. We show that\nthe probability p\u03b5 (R) behaves like R\u22122 , as in the case without killing, but with a multiplicative constant\nwhich depends on a and can be identified as the value at the origin of the solution of a semilinear partial\ndifferential equation with singular boundary conditions. A key tool to derive these asymptotics is a\nquenched homogenization theorem which shows that our branching Brownian motions among obstacles,\nsuitably rescaled, are close to super-Brownian motion killed at a certain rate depending on a.\nLet us formulate our assumptions more precisely in order to state our results. First, let us define\nthe collection of obstacles. We denote the set of all compact subsets of Rd by K. This set is equipped\nwith the usual Hausdorff metric dH . Recall that (K, dH ) is a Polish space. For every r > 0, Kr denotes\n1\n\n\fthe subset of K which consists of all compact sets that are contained in the closed ball of radius r\ncentered at the origin. Let \u0398 be a finite measure on K, and assume that \u0398 is supported on Kr0 for\nsome r0 > 0. Let\nX\nN =\n\u03b4(xi ,Ki )\ni\u2208I\n\nbe a Poisson point measure on Rd \u00d7 K with intensity \u03bbd \u2297 \u0398, where \u03bbd stands for Lebesgue measure\non Rd . We assume that this point measure is defined on a probability space (\u03a9, P) and we denote the\ngeneric element of \u03a9 by \u031f. Our set of obstacles is then defined by\n[\n\u0393\u031f = (xi + Ki ),\n(1)\ni\u2208I\n\nwhere obviously xi + Ki = {z = xi + y : y \u2208 Ki }. Note that we use the notation \u0393\u031f to emphasize\nthat the set of obstacles depends on the variable \u031f representing the environment. Let us also define a\nconstant \u03ba by\n\u0011\n\u0010 Z\n\u0398(dK) \u03bbd (K) .\n\u03ba = P(0 \u2208 \u0393\u031f ) = 1 \u2212 exp \u2212\nK\n\nTo avoid trivial cases, we assume that \u03ba > 0, or equivalently \u0398(\u03bbd (K) > 0) > 0. By translation\ninvariance, we also have P(x \u2208 \u0393\u031f ) = \u03ba for every x \u2208 Rd .\nLet us now introduce the sequence of branching Brownian motions of interest. Given \u031f \u2208 \u03a9 and\na parameter \u03b5 \u2265 0, we consider a branching Brownian motion on Rd such that\n\u2022 each particle moves around in Rd according to the law of Brownian motion killed at rate \u03b5 within\n\u0393\u031f ;\n\u2022 each particle branches at rate 1. During a branching event, the particle generates a random\nnumber of offspring, according to an offspring distribution \u03bd which has mean one and finite\nvariance \u03c3 2 \u2208 (0, \u221e).\n\nThis branching Brownian motion is denoted by Z \u031f,\u03b5 = (Zt\u031f,\u03b5)t\u22650 , where Zt\u031f,\u03b5 stands for the sum of\nthe Dirac point masses at the particles alive at time t. The processes Z \u031f,\u03b5 are defined on a probability\nspace \u03a9. For every finite point measure \u03bc on Rd , we use the notation P\u03bc for the probability measure\non \u03a9 under which each of the processes Z \u031f,\u03b5 starts from \u03bc.\nLet A be a bounded domain of class C 2 in Rd containing 0. We say that the branching Brownian\nmotion Z \u031f,\u03b5 hits Ac if there exists t > 0 such that Zt\u031f,\u03b5 (Ac ) > 0. We are interested in asymptotics for\nthe quantity\nP\u03b40 (Z \u031f,\u03b5 hits (RA)c )\nwhen R \u2192 \u221e and \u03b5 \u2192 0. Here we use the obvious notation RA = {z = Ry : y \u2208 A}.\nTheorem 1. For every a \u2265 0, let u(a) = (u(a) (x), x \u2208 A) be the unique nonnegative solution of the\nsingular boundary value problem\n\uf8f1\n\u03c32 2\n\uf8f2 1\n\u2206u =\nu + au\nin A,\n(2)\n2\n2\n\uf8f3\nu|\u2202A = +\u221e .\n\nThen,\n\nlim\n\nR\u2192\u221e\n\n\u0010\n\nsup R2 P\u03b40 (Z \u031f,\u03b5 hits (RA)c ) \u2212 u(\u03ba\u03b5R2 ) (0)\n\u03b5\u22650\n\n\u0011\n\n=0,\n\nP(d\u031f) a.s.\n\nLet us state a corollary of the theorem, which is motivated by the simple question we asked at\nthe beginning of this introduction. For every a \u2265 0, we denote by u\u25e6(a) the solution of the boundary\nproblem (2) when A is the open unit ball of Rd .\n2\n\n\fCorollary 1. For every \u03b5 \u2208 (0, 1), let n\u03b5 be a positive integer. Assume that \u03b5n\u03b5 \u2212\u2192 b as \u03b5 \u2192 0,\nfor some b > 0. Denote by R\u031f,\u03b5 the maximal distance from the origin attained by a particle of the\n\u221a\nbranching Brownian motion Z \u031f,\u03b5 . Then, P(d\u031f) a.s., the law of \u03b5 R\u031f,\u03b5 under Pn\u03b5 \u03b40 converges as\n\u03b5 \u2192 0 towards the probability measure \u03c0b on R+ defined by\n\u03c0b ([0, r]) = exp(\u2212\n\nb \u25e6\nu (0))\nr 2 (\u03bar)\n\nfor every r > 0.\nIn the setting of Theorem 1, it is not hard to see that u(a) (0) tends to 0 as a \u2192 \u221e (see Lemma\n2 below) and thus this theorem does not give much information when R \u2192 \u221e and \u03b5 \u2192 0 in such a\nway that \u03b5R2 tends to \u221e. In that case, the next proposition provides an exponential decay, which\ncontrasts with the preceding theorem. Since our bounds are clearly not optimal, we consider only the\ncase when A is a ball. We denote the open ball of radius r centered at the origin by B(0, r). In the\ngeneral case we may apply the bounds (i) and (ii) of the proposition after replacing A by a ball B(0, r)\nsuch that B(0, r) \u2283 A or B(0, r) \u2282 A respectively.\nProposition 1. (i) There exists a positive constant C0 = C0 (\u03bd) such that, for every \u031f \u2208 \u03a9, R \u2265 1\nand \u03b5 \u2208 [1/R2 , 1],\n\u221a\nP\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) \u2265 C0 \u03b5 exp(\u2212R 2\u03b5).\n(ii) There exists a positive constant C1 = C1 (\u0398) such that for every R \u2265 1 and \u03b5 \u2208 [1/R2 , 1],\n\u221a\nP \u2297 P\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) \u2264 exp(\u2212C1 R \u03b5).\n\nConsequently, we can find two positive constants C2 = C2 (\u0398) and C3 = C3 (\u0398) such that P(d\u031f) a.s.,\nfor every sufficiently large R and every \u03b5 \u2208 [C2 (log log R)2 /R2 , 1],\n\u221a\nP\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) \u2264 exp(\u2212C3 R \u03b5).\nPart (i) of the proposition is derived from an estimate about branching Brownian motion killed\nhomogeneously at rate \u03b5, which explains why this bound holds for every \u031f \u2208 \u03a9 and does not depend\non the measure \u0398. The bounds in (ii) follow from an estimate for Brownian motion killed in mild\nobstacles and therefore do not depend on the offspring distribution \u03bd. The first assertion in (ii) may\nbe compared to Proposition 5.2.8 in [Szn98].\nProposition 1 only gives rather crude estimates, and it would be of interest to obtain more precise\ninformation on the decay of the quenched probabilities P\u03b40 (Z \u031f,\u03b5 hits (RA)c ) in the case when \u03b5R2\ntends to \u221e. This leads to large deviations problems in the spirit of the work of Sznitman [Szn98],\nwhich we do not address here.\nA major ingredient of the proof of Theorem 1 is the following quenched homogenization result. We\nneed to introduce a rescaled version of the process Z \u031f,\u03b5. For every \u03b5 > 0 and every t \u2265 0, let us define\na random measure Xt\u031f,\u03b5 on Rd by setting, for any nonnegative measurable function \u03c6 on Rd ,\nZ\n\u031f,\u03b5\n1/2\nhXt , \u03c6i = \u03b5 Z\u03b5\u031f,\u03b5\nx).\n(3)\n\u22121 t (dx) \u03c6(\u03b5\nHere and later, the notation h\u03bc, \u03c6i stands for the integral of the function \u03c6 against the measure \u03bc,\nwhenever this integral makes sense.\nFor every real x \u2265 0, [x] denotes the integer part of x.\nTheorem 2. Except for a P-negligible set of values of \u031f, the law of (Xt\u031f,\u03b5 )t\u22650 under P[\u03b5\u22121]\u03b40 converges\nweakly as \u03b5 \u2192 0, in the Skorokhod sense, to that of a super-Brownian motion with branching mechanism\n2\n\u03c8(\u03ba) (u) := \u03c32 u2 + \u03bau started at \u03b40 .\n3\n\n\fThe definition of super-Brownian motion with branching mechanism \u03c8(\u03ba) is recalled in Section 2\nbelow.\nAs a hint of why Theorem 2 should be true, notice that for a given realization of the obstacles, the\nprobability that a single Brownian motion starting from 0 and killed at rate \u03b5 within \u0393\u031f is still alive\nby time t > 0 is given by\nZ t\noi\nh\nn\nI\u0393\u031f (\u03bes )ds ,\n(4)\nE exp \u2212 \u03b5\n0\n\nwhere \u03be denotes standard d-dimensional Brownian motion. Let us focus on the integral within the\nexponential in (4). Averaging over the law of the obstacles and using Fubini's theorem, we obtain for\neach t \u2265 0\nii\nhZ t\nh h Z t\ni\nI\u0393\u031f (\u03bes )ds = \u03b5 E\nE E \u03b5\nP[\u03bes \u2208 \u0393\u031f ]ds = \u03b5\u03bat.\n0\n\n0\n\n\u221a\nWe can thus guess, and easily prove, that the rescaled Brownian motion ( \u03b5 \u03be\u03b5\u22121 t , t \u2265 0), which\n\u221a\nis killed at rate 1 within \u03b5 \u0393\u031f , converges to Brownian motion killed at homogeneous rate \u03ba as\n\u03b5 \u2192 0. Theorem 2 shows that an analogous convergence indeed holds in our more general framework\nof branching Brownian motions, for any fixed \u031f contained in a set of P-probability one.\nLet us briefly explain how Theorem 1 is derived from Theorem 2. Consider a sequence (\u03b5n , Rn )\nsuch that Rn \u2192 \u221e and \u03b5n Rn2 converges to a positive constant a. By a simple scaling transforma1/2\ntion, the probability P\u03b40 (Z \u031f,\u03b5n hits (Rn A)c ) coincides with P\u03b40 (X \u031f,\u03b5n hits (bn A)c ), where bn = \u03b5n Rn\n\u221a\nconverges to a. We can then use Theorem 2 to investigate the asymptotic behaviour of the latter\nhitting probabilities. This limiting behaviour involves the corresponding hitting probabilities for superBrownian motion, which are known to be related to solutions of semilinear partial differential equations\nfrom the work of Dynkin [Dy91, Dy93]. One difficulty in implementing the preceding idea comes from\nthe fact that the convergence in Theorem 2 is not strong enough to ensure that hitting probabilities for\nthe processes (Xt\u031f,\u03b5 )t\u22650 converge to hitting probabilities for the limiting process. Much of the proof\nof Theorem 1 in Section 4 is devoted to a precise justification of this property (Lemma 7).\nTo complete this introduction, let us mention that branching Brownian motion and superprocesses\namong random obstacles have been studied recently in several papers, including Engl\u00e4nder and den\nHollander [EdH03] and Engl\u00e4nder [Eng08]. These papers concentrate on the case of supercritical\nbranching, in contrast with critical branching which is considered here. See also the survey [Eng07]. A\nhomogenization theorem related to Theorem 2 has been proved in [V\u00e9b09] for super-Brownian motion\namong hard obstacles, in the case when the intensity of the obstacles grows to infinity but their\ndiameters shrink to 0. There is a huge literature about Brownian motion and random walks among\n(hard or mild) obstacles, and the reader may look at the book of Sznitman [Szn98] for additional\nreferences.\nThe rest of this paper is laid out as follows. In Section 2, we introduce the basic notation and\nobjects, and state several results about hitting probabilities for spatial branching processes we shall\nneed in the sequel. Theorem 2 and Proposition 1 are proved in Section 3. Theorem 1 and Corollary 1\nare then derived in Section 4.\n\n2\n2.1\n\nPreliminaries\nNotation\n\nWe denote the set of all finite measures on Rd by Mf (Rd ). This set is equipped with the weak topology.\nWe write Mp (Rd ) for the subset of Mf (Rd ) which consists of all finite point measures on Rd .\nIf E is a metric space, we denote the set of all bounded continuous functions on the space E by\nC\u0304(E) and we let kf k stand for the supremum norm of f \u2208 C\u0304(E). We write C 2 (Rd ) for the set of\nall twice continuously differentiable functions on Rd , and C\u0304 2 (Rd ) for that of all bounded functions in\n\n4\n\n\fC 2 (Rd ) whose first and second derivatives are also bounded. An index + added to this notation means\nthat we require the functions to be nonnegative. We equip C\u0304 2 (Rd ) with the topology induced by the\nseminorms kf k(R) , where for every R > 0\nkf k(R)\n\n\u001a\n\u001b\nd\nd\nX\nX\n\u2202f\n\u22022f\n:= sup |f (x)| +\n(x) +\n(x) .\n\u2202xi\n\u2202xi \u2202xj\n|x|\u2264R\ni=1\n\ni,j=1\n\nIf E is a Polish space, we let DE [0, \u221e) be the set of all c\u00e0dl\u00e0g paths with values in E, equipped\nwith the Skorokhod topology.\nIf x \u2208 Rd and r > 0, B(x, r) denotes the open ball of radius r centered at x, and B\u0304(x, r) stands\nfor the corresponding closed ball. More generally, the closure of a subset F of Rd is denoted by F\u0304 .\nLebesgue measure on Rd is denoted by \u03bbd .\nFinally, the notation \u03be = (\u03bet )t\u22650 will stand for a standard Brownian motion in Rd , which starts\nfrom x under the probability measure Px . It will also be convenient to use the notation \u03be \u031f,\u03b5 for\nBrownian motion in Rd killed at rate \u03b5 in the set \u0393\u031f . As usual, the value of \u03be \u031f,\u03b5 after its killing time\nis a cemetery point \u2206 added to Rd , and we agree that all functions vanish at \u2206.\n\n2.2\n\nSuper-Brownian motion\n2\n\nLet a \u2265 0 and set \u03c8(a) (u) = \u03c32 u2 + a u, for every u \u2265 0 (the offspring distribution \u03bd, and thus the\nparameter \u03c3 > 0 are fixed throughout this work). Super-Brownian motion with branching mechanism\n\u03c8(a) is the continuous strong Markov process with values in Mf (Rd ), whose transition kernels (Qt )t\u22650\nare characterized as follows: For every g \u2208 C\u0304+ (Rd ) and every \u03bc \u2208 Mf (Rd ), we have for every t \u2265 0\nZ\nQt (\u03bc, d\u03bc\u2032 ) exp(\u2212h\u03bc\u2032 , gi) = exp(\u2212h\u03bc, Vt gi),\n(5)\nwhere the function ut (x) = Vt g(x), t \u2265 0, x \u2208 Rd , is the unique nonnegative solution of the semilinear\nparabolic problem\n\uf8f1\n\uf8f2 \u2202u = 1 \u2206u \u2212 \u03c8 (u) in (0, \u221e) \u00d7 Rd ,\n(a)\n2\n\u2202t\n\uf8f3\nu0 = g .\n\nLet Y = (Yt )t\u22650 be a super-Brownian motion with branching mechanism \u03c8(a) , started at \u03bc \u2208\n2 (Rd )\nMf (Rd ). Then, for every g \u2208 C\u0304+\n\u2212hYt ,gi\n\ne\n\n\u2212hY0 ,gi\n\n\u2212e\n\nZ tD\nE\n1\nYs , \u2212 \u2206g + \u03c8(a) (g) e\u2212hYs ,gi ds\n\u2212\n2\n0\n\n(6)\n\nis a martingale. It is well known that this martingale problem and the initial value \u03bc characterize the\nlaw of Y . This is indeed an application of the classical \"duality method\" (see in particular Chapter\n4 in [EK86]). The nonlinear semigroup g \u2192 Vt g provides a deterministic dual to super-Brownian\nmotion, and the duality argument then shows that if a measure-valued process started from \u03bc satisfies\nthe preceding martingale problem, the Laplace functional of its value at time t must be given by the\nright-hand side of (5). See Section 1.6 of [Eth00] for more details.\n\n2.3\n\nBranching Brownian motion among random obstacles\n\nIn view of our applications (and in particular because we want to refer to some results of [Ch91]),\nit will be convenient to give a more formal description of the branching Brownian motions that were\nalready introduced in Section 1 above. Recall that our offspring distribution \u03bd is assumed to be critical\nand that var(\u03bd) = \u03c3 2 \u2208 (0, \u221e). The probability generating function of \u03bd will be denoted by \u03a5.\n5\n\n\fLet T be a Galton-Watson tree with offspring distribution \u03bd (see e.g. [LG05]). As usual, we view\nT as a random finite subset of\n\u221e\n[\nNn ,\nU :=\nn=0\n\nN0\n\nwhere N = {1, 2, 3, . . .}, and\n= {\u2205}. If v = (v1 , . . . , vn ) \u2208 U \\{\u2205}, the parent of v is denoted by\nv\u0302 = (v1 , . . . , vn\u22121 ) and we also use the notation v \u227a v \u2032 to mean that v \u2032 is a descendant of v distinct\nfrom v. Consider a collection (ev , v \u2208 U ) of independent exponential random variables with parameter\n1, which is also independent of T . We define for every v \u2208 U its birth time \u03b1v and its death time \u03b2v\nrecursively by setting \u03b1\u2205 = 0 and \u03b2\u2205 = e\u2205 , and for every v \u2208 U \\{\u2205},\n\u03b1v = \u03b2v\u0302 , \u03b2v = \u03b1v + ev .\nLet us now construct the spatial motions. Fix a starting point x \u2208 Rd , and consider a collection\n(B v , v \u2208 U ) of independent standard Brownian motions in Rd (started from 0), independent of T and\nof (ev , v \u2208 U ). For every v \u2208 U , define the historical path \u03c9 v = (\u03c9tv , 0 \u2264 t \u2264 \u03b2v ) associated with v\nin the following way. First \u03c9t\u2205 = x + Bt\u2205 for 0 \u2264 t \u2264 \u03b2\u2205 . Then, if v \u2208 U \\{\u2205}, set \u03c9tv = \u03c9tv\u0302 for all\n0 \u2264 t \u2264 \u03b1v and\nv\n\u03c9tv = \u03c9\u03b1v\u0302 v + Bt\u2212\u03b1\nfor \u03b1v \u2264 t \u2264 \u03b2v .\nv\n\nA branching Brownian motion (without killing in obstacles) starting from \u03b4x is obtained by setting for\nevery t \u2265 0,\nX\nZt =\n\u03b4\u03c9tv ,\nv\u2208T ,v\u223ct\n\nwhere the notation v \u223c t means that \u03b1v \u2264 t < \u03b2v .\nIn this formalism, it is now easy to introduce killing in obstacles. Consider yet another independent\ncollection (\u03b3v )v\u2208U of independent exponential random variables with parameter 1, and define for every\n\u031f \u2208 \u03a9, \u03b5 \u2265 0, and for every v \u2208 U\n\u001a\n\u001b\nZ s\n\u031f,\u03b5\nv\n\u22121\ndr I\u0393\u031f (\u03c9r ) > \u03b5 \u03b3v ,\n\u03b6v := inf s \u2208 [\u03b1v , \u03b2v ) :\n\u03b1v\n\nwhere inf \u2205 = \u221e. By setting\nZt\u031f,\u03b5 =\n\nX\n\nv\u2208T ,v\u223ct\n\nI{t<\u03b6v\u031f,\u03b5 and \u03b6 \u031f,\u03b5\n\u03b4\u03c9tv ,\n\u2032\n\u2032 =\u221e, for every v \u227av}\nv\n\nwe obtain a branching Brownian motion killed at rate \u03b5 in the obstacle set \u0393\u031f , starting from \u03b4x .\nAn obvious extension of the preceding construction allows us to obtain branching Brownian motions\nstarting from any point measure \u03bc \u2208 Mp (Rd ).\nWe now recall a special case of the classical convergence of rescaled branching Brownian motions\ntowards super-Brownian motion. For our applications, we state the case where particles are killed at a\nconstant rate homogeneously over Rd (this case is obtained from the preceding construction of Z \u031f,\u03b5 by\n(\u03b5)\nreplacing \u0393\u031f by Rd ). In the next two statements, for every \u03b5 > 0, Z (\u03b5) = (Zt )t\u22650 denotes a branching\nBrownian motion with offspring distribution \u03bd, where particles are killed homogeneously over Rd at\nrate \u03b5. As previously Z (\u03b5) starts from \u03bc under the probability measure P\u03bc , for every \u03bc \u2208 Mp (Rd ).\n(\u03b5)\n\nProposition 2. Let a \u2265 0. For every \u03b5 > 0, define a measure-valued process (Xt )t\u22650 by setting\nZ\n(a\u03b5)\n(\u03b5)\nhXt , \u03c6i = \u03b5 Z\u03b5\u22121 t (dx) \u03c6(\u03b51/2 x),\nfor every \u03c6 \u2208 C\u0304(Rd ). For every fixed \u03b7 > 0, the law of X (\u03b5) under P[\u03b7\u03b5\u22121 ]\u03b40 converges as \u03b5 \u2192 0, in the\nSkorokhod sense, towards the law of super-Brownian motion with branching mechanism \u03c8(a) starting\nfrom \u03b7\u03b40 .\n6\n\n\fA proof of Proposition 2 can be found in Chapter 1 of [Eth00] in the case a = 0, and arguments\nare easily adapted to cover the general case.\nFinally, we shall use an estimate for the probability that a branching Brownian motion starting from\n\u03b40 exits a large ball centered at the origin. Similar estimates can be found in Sawyer and Fleischman\n[SF79], but we provide a short proof for the sake of completeness.\nLemma 1. Suppose that d = 1. There exist two positive constants C0\u2032 = C0\u2032 (\u03bd) and C1\u2032 = C1\u2032 (\u03bd) such\nthat, for every \u03b5 \u2208 [0, 1] and r \u2265 1,\nC0\u2032 (r \u22122 I{r\u2264 \u221a1\n\n\u03b5\n\n\u2212r\n} + \u03b5e\n\n\u221a\n\n2\u03b5\n\nI{r> \u221a1 } ) \u2264 P\u03b40 (Z (\u03b5) hits (\u2212r, r)c ) \u2264 C1\u2032 (r \u22122 I{r\u2264 \u221a1\n\u03b5\n\n\u03b5\n\n\u2212r\n} + \u03b5e\n\n\u221a\n\n2\u03b5\n\nI{r> \u221a1 } ).\n\u03b5\n\nRemark. As an immediate consequence of the upper bound of the lemma, we have in dimension d,\nfor every r > 0,\nP\u03b40 (Z (0) hits B(0, r)c ) \u2264 C1\u2032\u2032 (r + 1)\u22122\n(7)\nwith a constant C1\u2032\u2032 = C1\u2032\u2032 (d, \u03bd).\n\nProof. It clearly suffices to prove that the stated bounds hold for the quantity P\u03b4r (Z (\u03b5) hits (\u2212\u221e, 0])\ninstead of P\u03b40 (Z (\u03b5) hits (\u2212r, r)c ). We fix \u03b5 \u2265 0, and for every x > 0 and t \u2265 0, we set\n\u0010\n\u0011\nq\u03b5 (x, t) = P\u03b4x Z (\u03b5) does not hit (\u2212\u221e, 0] before time t .\n\nand\n\n\u0010\n\u0011\np\u03b5 (x) = P\u03b4x Z (\u03b5) hits (\u2212\u221e, 0] = lim \u2191 (1 \u2212 q(x, t)).\nt\u2191\u221e\n\nP\u03b5x\n\nIn this proof only, we write\nfor the probability under which \u03be is a Brownian motion starting from\nx and killed at rate \u03b5 (upon killing, \u03be is sent to the cemetery point \u2206 and we recall that all functions\nvanish at \u2206). Write S := inf{t \u2265 0 : \u03bet \u2208 (\u2212\u221e, 0]}. By standard arguments (see e.g. the proof of\nProposition II.3 in [LG99]), the function q\u03b5 solves the integral equation\nq\u03b5 (x, t) = P\u03b5x (S > t) + E\u03b5x\n\nhZ\n\nt\u2227S\n0\n\ni\n(\u03a5(q\u03b5 (\u03bes , t \u2212 s)) \u2212 q\u03b5 (\u03bes , t \u2212 s)) ds ,\n\nwhere we recall that \u03a5 denotes the generating function of the offspring distribution \u03bd. For every\na \u2208 [0, 1], set \u03a6(a) = \u03a5(1 \u2212 a) \u2212 (1 \u2212 a). Note that \u03a6(0) = 0 and the function \u03a6 is monotone increasing\n2\nunder our assumptions. Furthermore, \u03a6(a) = \u03c32 a2 + o(a2 ) when a \u2192 0. By a monotone passage to\nthe limit we get that, for every x > 0,\np\u03b5 (x)\n\n+ E\u03b5x\n\nhZ\n\nS\n0\n\ni\n\u03a6(p\u03b5 (\u03bes )) ds = P\u03b5x (S < \u221e).\n\n(8)\n\nIt follows that the function p\u03b5 satisfies the differential equation\n1 \u2032\u2032\np = \u03b5 p\u03b5 + \u03a6(p\u03b5 )\n2 \u03b5\n\non (0, \u221e) with boundary conditions p\u03b5 (0) = 1, p\u03b5 (\u221e) = 0. By solving this differential equation, we\nget, for every x > 0,\nZ 1\ndu\np\n=x\n2\n2\u03b5u + 4\u0393(u)\np\u03b5 (x)\nRu\nwhere \u0393(u) = 0 \u03a6(v) dv. Note that there exist positive constants c, c\u2032 such that cu3 \u2264 \u0393(u) \u2264 c\u2032 u3\nfor every u \u2208 [0, 1]. The desired bounds then follow from easy analytic arguments.\n\u0003\n7\n\n\f2.4\n\nHitting probabilities for super-Brownian motion\n(a)\n\nLet Y (a) = (Yt )t\u22650 be a super-Brownian motion with branching mechanism \u03c8(a) for some a \u2265 0.\nSuppose that Y (a) starts from \u03bc under the probability measure P\u03bc , for every \u03bc \u2208 Mf (Rd ).\nThe range of Y (a) is by definition\n!\n\u221e\n[ [\n(a)\nR(Y (a) ) =\nsupp(Yt ) ,\n\u03b5>0\n\nt=\u03b5\n\nwhere for every \u03bc \u2208 Mf (Rd ), supp(\u03bc) denotes the topological support of \u03bc.\nLet D be a domain in Rd and let x \u2208 D. Consider the process Y (a) started from \u03b4x . We say\nthat Y (a) hits D c if the range R(Y (a) ) intersects D c . By a famous result of Dynkin [Dy91, Dy93] the\nfunction\n\u0011\n\u0010\n(a)\n) \u2229 D c 6= \u2205) , x \u2208 D ,\nuD\n(a) (x) = \u2212 log 1 \u2212 P\u03b4x (R(Y\n\nis the maximal nonnegative solution of the semilinear partial differential equation 12 \u2206u = \u03c8(a) (u) in\nD.\nUnder mild regularity assumptions on D (which hold e.g. when D satisfies an exterior cone condition\nat every point of \u2202D), the function uD\n(a) has boundary value +\u221e at every point of \u2202D and is the unique\nnonnegative solution of the equation 21 \u2206u = \u03c8(a) (u) in D with boundary value +\u221e everywhere on\n\u2202D. A discussion of this result and related ones can be found in Chapter VI of the book [LG99]. This\nreference considers only the case a = 0, but the same results can be obtained for any a \u2265 0 by similar\narguments: Note that the Brownian snake approach can be extended from the case a = 0 considered in\n[LG99] to a \u2265 0, simply by replacing the reflecting Brownian motion driving the snake by a reflecting\nBrownian motion with negative drift (see Chapter 4 of [DLG02] for a discussion of the snake approach\nto superprocesses with a general branching mechanism).\nWe shall be interested in the special case D = A. Recall that 0 \u2208 A and that we assume A is a\ndomain of class C 2 , meaning that the boundary of A can be represented locally as the graph of a twice\ncontinuously differentiable function, in a suitable system of coordinates. We write u(a) (x) = uA\n(a) (x) to\nsimplify notation. From the analytic viewpoint, the function u(a) may be constructed as follows. For\nevery integer n \u2265 1, let u(a),n be the unique nonnegative solution of the nonlinear Dirichlet problem\n\u001a\n\n1\n2 \u2206u\n\n= \u03c8(a) (u) in A ,\nu|\u2202A = n .\n\nThen u(a) = lim \u2191 u(a),n as n \u2192 \u221e.\nThe following lemma records certain analytic properties which will be useful in the forthcoming\nproofs.\nLemma 2. (i) Let x \u2208 A. The function a \u2212\u2192 u(a) (x) is continuous and nonincreasing on [0, \u221e), and\ntends to 0 as a \u2192 \u221e.\n(ii) For every \u03b4 \u2208 (0, dist(0, Ac )), let A\u03b4 be the subdomain of A defined as the connected component of\n\u03b4\nthe open set {x \u2208 A : dist(x, Ac ) > \u03b4} that contains 0. Then, for every a \u2265 0, uA\n(a) (0) tends to u(a) (0)\nas \u03b4 \u2192 0.\nProof. (i) Let us first verify that the function a \u2212\u2192 u(a) (x) is monotone nonincreasing, for every\nx \u2208 A. To see this, we apply a standard comparison principle (see e.g. Lemma V.7 in [LG99]) to\nobtain that u(a\u2032 ),n \u2264 u(a),n if a \u2264 a\u2032 , for every n \u2265 1. It then suffices to let n \u2192 \u221e.\nLet (ak )k\u22651 be a sequence of nonnegative reals increasing to a \u2208 (0, \u221e). We can set for every x \u2208 A\nv(x) = lim \u2193 u(ak ) (x),\nk\u2191\u221e\n\n8\n\n\fand we have v \u2265 u(a) . In order to verify that v \u2264 u(a) , we only need to check that v solves 21 \u2206v = \u03c8(a) (v)\nin A (recall that u(a) is the maximal nonnegative solution of this equation). To do so, let B be an\nopen ball whose closure B\u0304 is contained in A. For every k \u2265 1, the restriction of u(ak ) to B solves the\nequation 12 \u2206u = \u03c8(ak ) (u) in B. By the probabilistic interpretation of the integral equation associated\nwith this PDE (see e.g. Chapter V in [LG99]), this implies that, for every x \u2208 B,\n\u0015\n\u0014 Z \u03c4B\n\u0002\n\u0003\nu(ak ) (x) + Ex\n\u03c8(ak ) (u(ak ) (\u03bes )) ds = Ex u(ak ) (\u03be\u03c4B ) ,\n0\n\nwhere we recall our notation \u03be for a Brownian motion starting from x under the probability measure\nPx , and \u03c4B := inf{t \u2265 0 : \u03bet \u2208\n/ B}. By passing to the limit k \u2192 \u221e in the previous display, we can\nwrite\n\u0015\n\u0014 Z \u03c4B\n\u0002\n\u0003\nv(x) + Ex\n\u03c8(a) (v(\u03bes )) ds = Ex v(\u03be\u03c4B ) ,\n0\n\nwhich is enough to obtain that v solves 12 \u2206v\nSimilar arguments show that, if (ak )k\u22651\n\n= \u03c8(a) (v) in B, and therefore in A since B was arbitrary.\nis a decreasing sequence of nonnegative reals converging\nto a \u2208 [0, \u221e), then u(ak ) (x) converges to u(a) (x) for every x \u2208 A. Finally, the fact that u(a) (x) tends\nto 0 as a \u2192 \u221e can be obtained from the comparison principle: If B is a ball such that B\u0304 \u2282 A, the\nrestriction of u(a) to B is bounded above by the solution v(a) of the linear equation 21 \u2206v(a) = a v(a)\nin B, with boundary value equal to the restriction of u(0) to B. It is easily seen that v(a) (x) \u2212\u2192 0 as\na \u2192 \u221e, for instance by using the Feynman-Kac formula.\n\u03b4\n\u2032\n(ii) Fix a \u2265 0. If 0 < \u03b4 < \u03b4\u2032 , the closure of A\u03b4\u2032 is contained in A\u03b4 . The restriction of uA\n(a) to A\u03b4 is\nA\n\na nonnegative solution of 12 \u2206u = \u03c8(a) (u) in A\u03b4\u2032 and is thus bounded above by u(a)\u03b4\u2032 . Hence, for every\n\u03b4\nfixed x \u2208 A the function \u03b4 \u2192 uA\n(a) (x), which is defined for \u03b4 > 0 small enough, is nondecreasing and\nwe can set\n\u03b4\nv(x) = lim uA\n(a) (x).\n\n\u03b4\u21930\n\n\u03b4\nBy the same argument we used to obtain the monotonicity of the mapping \u03b4 \u2192 uA\n(a) (x), we also have\nv(x) \u2265 u(a) (x) for every x \u2208 A. To obtain the reverse inequality v \u2264 u(a) , it is enough to verify that\nv solves 12 \u2206v = \u03c8(a) (v) in B. But this follows by arguments similar to those we used in the proof of\npart (i) of the lemma.\n\u0003\n\nLemma 3. For every a \u2265 0 and x \u2208 A,\n{R(Y (a) ) \u2229 Ac 6= \u2205} = {R(Y (a) ) \u2229 \u0100c 6= \u2205} ,\n\nP\u03b4x a.s.\n\nProof. The inclusion\n{R(Y (a) ) \u2229 Ac 6= \u2205} \u2283 {R(Y (a) ) \u2229 \u0100c 6= \u2205}\nis trivial. To show the reverse inclusion, we may argue as follows. By Theorem IV.9 in [LG99] (which\nholds under much less stringent assumptions on A), the event {R(Y (a) ) \u2229 Ac 6= \u2205} holds if and only if\nthe exit measure of the super-Brownian motion Y (a) from A is nonzero. Applying the special Markov\nproperty of superprocesses [Dy93, Theorem 1.3], we see that it is enough to prove that for superBrownian motion starting from a nonzero initial measure supported on \u2202A, the range immediately hits\n(\u0100)c . This is however easy under our regularity assumptions on A. We leave the details to the reader.\n\u0003\nFrom now on, we write {Y (a) hits F } for the event {R(Y (a) ) \u2229 F 6= \u2205}.\n\n9\n\n\f3\n\nQuenched convergence to super-Brownian motion\n\nThe main goal of this section is to prove Theorem 2. At the end of the section, we also establish\nProposition 1, using certain arguments related to the proof of Theorem 2. To simplify notation, we\nset for every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1),\n[ \u221a\n\u221a\n\u0393\u03b5\u031f = \u03b5 \u0393\u031f =\n\u03b5(xi + Ki ).\ni\u2208I\n\nThe following lemma identifies a martingale problem solved by our branching Brownian motion\nZ \u031f,\u03b5. It can be proved by standard arguments (see e.g. Section 9.4 in [EK86]).\nLemma 4. Let \u031f \u2208 \u03a9 and \u03b5 \u2265 0. Under each probability P\u03bc , \u03bc \u2208 Mp (Rd ), the process Z \u031f,\u03b5 solves\n2 (Rd ) such that 0 < inf f \u2264 f \u2264 1, the process\nthe following martingale problem: For every f \u2208 C\u0304+\nhZt\u031f,\u03b5 ,log f i\n\ne\n\nhZ0\u031f,\u03b5 ,log f i\n\n\u2212e\n\n\u2212\n\nZ t\u001c\n0\n\n1\n\u2206f\nZs\u031f,\u03b5, 2\n\n\u001d\n+ \u03b5I\u0393\u031f (1 \u2212 f ) + \u03a5(f ) \u2212 f hZs\u031f,\u03b5 ,log f i\ne\nds\nf\n\nis a martingale.\nWe can derive from Lemma 4 (or from a direct argument) that for every g \u2208 C\u0304 2 (Rd ),\nZ tD\nE\n\u031f,\u03b5\n\u031f,\u03b5\n\u031f,\u03b5 1\nZs , \u2206g \u2212 \u03b5I\u0393\u031f g ds\nMt (g) := hZt , gi \u2212 hZ0 , gi \u2212\n2\n0\n\nis a martingale. An easy computation gives that the square bracket of this martingale is\nZ t\nX\n\u031f,\u03b5\nhZs\u031f,\u03b5, \u2207g.\u2207gi ds +\nhZs\u031f,\u03b5 \u2212 Zs\u2212\n, gi2 .\n[M (g), M (g)]t =\n0\n\n(9)\n\n(10)\n\n0\u2264s\u2264t\n\nThe last sum in the right-hand side is an increasing process with compensator\nZ t\nhZs\u031f,\u03b5 , (\u03c3 2 + \u03b5I\u0393\u031f )g2 i ds.\n\n(11)\n\n0\n\nThe proof of Theorem 2 relies on the following two results, in which we use the notation (Yt )t\u22650 for\nthe canonical process on DMf (Rd ) [0, \u221e). Recall from (3) the definition of the process X \u031f,\u03b5 in terms\nof Z \u031f,\u03b5.\nLemma 5. For every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1), let \u03a0\u031f,\u03b5 be the law of the process X \u031f,\u03b5 under P[\u03b5\u22121]\u03b40 .\nThen,\n(i) For every \u03b4 > 0 and T > 0, there is a compact subset K\u03b4,T of Rd such that, for every \u031f \u2208 \u03a9,\n\u0010\n\u0011\nc\n) <\u03b4\nsup \u03a0\u031f,\u03b5 sup Yt (K\u03b4,T\n\u03b5\u2208(0,1)\n\n0\u2264t\u2264T\n\n(ii) For every g \u2208 C\u0304 2 (Rd ) and \u031f \u2208 \u03a9, the collection of the laws of the process (hYt , gi)t\u22650 under \u03a0\u031f,\u03b5 ,\n\u03b5 \u2208 (0, 1), is relatively compact in the space of all probability measures on DR [0, \u221e).\nConsequently, for every \u031f \u2208 \u03a9, the collection (\u03a0\u031f,\u03b5 )\u03b5\u2208(0,1) is relatively compact in the space of all\nprobability measures on DMf (Rd ) [0, \u221e).\nThe last assertion of the lemma is an immediate consequence of (i) and (ii) using Theorem II.4.1\nin [Per02].\n10\n\n\f2 (Rd ). There exists a measurable subset \u03a9 of \u03a9 such that P(\u03a9 ) = 1 and\nProposition 3. Let g \u2208 C\u0304+\ng\ng\nthe following holds for every \u031f \u2208 \u03a9g . For every\ns,\nt\n\u2265\n0,\nfor\nevery\ninteger\np\n\u2208\nN\nand\nevery\nchoice of\n\u0001\nd\nt1 , . . . , tp \u2208 [0, t] and f1 , . . . , fp \u2208 C\u0304 Mf (R ) , we have\n\nlim E[\u03b5\u22121 ]\u03b40\n\n\u03b5\u21920\n\n\u0014\u001a\n\n\u031f,\u03b5\n\u2212hXt+s\n,gi\n\ne\n\n\u2212hXt\u031f,\u03b5 ,gi\n\n\u2212e\n\n\u2212\n\nZ\n\nt\n\nt+s D\n\nE\n\n1\nXu\u031f,\u03b5 , \u2212 \u2206g + \u03c8(\u03ba) (g)\n2\n\n\u2212hXu\u031f,\u03b5 ,gi\n\ne\n\ndu\n\n\u001bY\np\n\n\u0015\n\nfi (Xt\u031f,\u03b5\n)\ni\n\ni=1\n\n= 0.\n\nWe postpone the proof of Lemma 5 and Proposition 3, and explain how Theorem 2 follows from\n2 (Rd ) and set\nthese two statements. We choose a countable dense subset G of C\u0304+\n\u03a9\u2032 =\n\n\\\n\n\u03a9g .\n\ng\u2208G\n\nFix \u031f \u2208 \u03a9\u2032 . By Lemma 5, the collection (\u03a0\u031f,\u03b5 )\u03b5\u2208(0,1) is relatively compact. Let \u03a0\u2217 be a sequential\nlimit of this collection as \u03b5 tends to 0. We deduce from Proposition 3 that,\n\u0001 for every g \u2208 G, for every\nd\ns, t \u2265 0 and every choice of t1 , . . . , tp \u2208 [0, t] and f1 , . . . , fp \u2208 C\u0304 Mf (R ) , we have\n\u0014\u001a\nZ\n\u03a0\ne\u2212hYt+s ,gi \u2212 e\u2212hYt ,gi \u2212\n\u2217\n\nt\n\nt+s D\n\n\u0015\n\u001bY\np\nE\n1\n\u2212hYu ,gi\nYu , \u2212 \u2206g + \u03c8(\u03ba) (g) e\nfi (Yti ) = 0.\ndu\n2\n\n(12)\n\ni=1\n\nThe required passage to the limit under the expectation sign is easily justified: Note that, by comparing\nwith the case when there is no killing and using standard results of the theory of critical branching\nprocesses, we have for every T > 0\ni\u0011\n\u0010\nh\n(13)\nsup E[\u03b5\u22121\u03b40 ] sup hXr\u031f,\u03b5 , 1i2 < \u221e.\n\u03b5\u2208(0,1)\n\n0\u2264r\u2264T\n\n2 (Rd ), another easily justified passage to the limit shows that (12) holds for every\nSince G is dense in C\u0304+\n2\nd\ng \u2208 C\u0304+ (R ). Thus, \u03a0\u2217 satisfies the martingale problem for super-Brownian motion with branching\nmechanism \u03c8(\u03ba) as stated in Section 2. Since it is also clear that \u03a0\u2217 (Y0 = \u03b40 ) = 1, \u03a0\u2217 must be the law\nof super-Brownian motion with branching mechanism \u03c8(\u03ba) started from \u03b40 . This completes the proof\nof Theorem 2, but we still need to establish Lemma 5 and Proposition 3.\n\u0003\n\nProof of Lemma 5. The compact containment condition (i) in the lemma is immediately obtained\nby observing that X \u031f,\u03b5 is dominated by X 0 = X \u031f,0 and by using the convergence of rescaled branching\nBrownian motions (without killing in the obstacles) towards super-Brownian motion. So we only need\n2 (Rd ). To simplify notation,\nto verify (ii). In the remaining part of the proof, we fix \u031f \u2208 \u03a9 and g \u2208 C\u0304+\nwe set\nXt\u03b5 = hXt\u031f,\u03b5 , gi.\nBy the remarks following Lemma 4 and an elementary scaling transformation, we have\nXt\u03b5 = X0\u03b5 + Mt\u03b5 + Vt\u03b5 ,\nwhere\nVt\u03b5\n\nZ tD\nE\n1\nXs\u031f,\u03b5 , \u2206g \u2212 I\u0393\u03b5\u031f g ds\n=\n2\n0\n\nand M \u03b5 is a martingale, whose square bracket is given by\nZ t\nX\n\u031f,\u03b5\n\u03b5\n\u03b5\n, gi2 .\nhXs\u031f,\u03b5 , \u03b5\u2207g.\u2207gi ds +\nhXs\u031f,\u03b5 \u2212 Xs\u2212\n[M , M ]t =\n0\n\n0\u2264s\u2264t\n\n11\n\n\fFurthermore, the oblique bracket of M \u03b5 is equal to\nZ t\n\u0001\nhM \u03b5 , M \u03b5 it =\nXs\u031f,\u03b5 , \u03c3 2 g2 + \u03b5 \u2207g.\u2207g + I\u0393\u03b5\u031f g2 ds.\n0\n\nBy standard criteria (see in particular Theorem VI.4.13 in Jacod and Shiryaev [JS87]), the tightness\nof the laws of the processes X \u03b5 , \u03b5 \u2208 (0, 1), will follow if we can verify that the laws of the processes V \u03b5\nand hM \u03b5 , M \u03b5 i, for \u03b5 \u2208 (0, 1), are C-tight. But this is immediate from the preceding explicit formulas\nand (13).\n\u0003\n\u0001\nProof of Proposition 3. Let us fix s, t \u2265 0, t1 , . . . , tp \u2208 [0, t] and f1 , . . . , fp \u2208 C\u0304 Mf (Rd ) . Let\n\u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1). Using\nthe facts that \u03a5(1) = \u03a5\u2032 (1) = 1, \u03a5\u2032\u2032 (1) = \u03c3 2 and Lemma 4 applied to\n\b\n\u221a\nthe function f (x) = exp \u2212 \u03b5g(x \u03b5) , we can write\n\u0014\u001a\nZ\n\u031f,\u03b5\n\u2212hXt+s\n,gi\n\u2212hXt\u031f,\u03b5 ,gi\n\u22122\n0 = E[\u03b5\u22121]\u03b40 e\n\u2212e\n\u2212\u03b5\n\u0001\n+ \u03b5I\u0393\u03b5\u031f 1 \u2212 e\u2212\u03b5g e\u03b5g + e\u03b5g\n\nD\n\u0001\n1\n\u2212 \u03b52 \u2206g + \u03b53 \u2207g.\u2207g\nXu\u031f,\u03b5 ,\n2\nt\n\u001bY\n\u0015\np\nE\n\u0001\n\u0001 \u2212hX \u031f,\u03b5 ,gi\n\u031f,\u03b5 \u0001\n\u2212\u03b5g\n\u2212\u03b5g\nu\nfi Xti\ne\ndu\n\u03a5 e\n\u2212e\n\n\u0014\u001a\nZ\n\u031f,\u03b5\n\u2212hXt+s\n,gi\n\u2212hXt\u031f,\u03b5 ,gi\n= E[\u03b5\u22121]\u03b40 e\n\u2212e\n\u2212\n\nt+s\n\ni=1\n\nt+s D\n\n\u03b5\n1\nXu\u031f,\u03b5 , \u2212 \u2206g + \u2207g.\u2207g\n2\n2\nt\n\u0015\n\u001bY\np\nE\n2\n\u0001\n\u031f,\u03b5\n\u03c3\n+ I\u0393\u03b5\u031f (g + \u03b7\u03b5 ) + (g2 + \u03b7\u0303\u03b5 ) e\u2212hXu ,gi du\n,\nfi Xt\u031f,\u03b5\ni\n2\n\n(14)\n\ni=1\n\nwhere k\u03b7\u03b5 k \u2264 C1 (g)\u03b5 for some constant C1 (g) depending only on g, and k\u03b7\u0303\u03b5 k \u2192 0 as \u03b5 \u2192 0. On the\none hand, using Fubini's theorem, the fact that (hXr\u031f,\u03b5 , 1i)r\u22650 is a supermartingale and the inequality\nE[\u03b5\u22121]\u03b40 [hX0\u031f,\u03b5 , 1i] \u2264 1, we have\n\u001bY\n\u0015\np\n\u03c3 2 E \u2212hXu\u031f,\u03b5 ,gi\n\u03b5\n\u031f,\u03b5 \u0001\nfi Xti\ndu\n\u2207g.\u2207g + I\u0393\u03b5\u031f \u03b7\u03b5 + \u03b7\u0303\u03b5 e\nE[\u03b5\u22121]\u03b40\n2\n2\nt\ni=1\n\u0012\n\u0013\n\u0015\n\u0014 Z t+s\n\u0013\u0012 Y\np\n\u0001 \u03c32\n\u03b5\n\u2264\nkfi k E[\u03b5\u22121]\u03b40\nhXu\u031f,\u03b5 , 1i du\nk\u2207g.\u2207gk + 2C1 (g) + k\u03b7\u0303\u03b5 k\n2\n2\nt\ni=1\n\u0013\n\u0012Y\np\n\u0001\nkfi k s\n\u2264 C2 (g) \u03b5 + (\u03c3 2 /2)k\u03b7\u0303\u03b5 k\n\u0014 \u001aZ\n\nt+s D\n\nXu\u031f,\u03b5 ,\n\ni=1\n\nwith a constant C2 (g) depending only on g. On the other hand,\nE[\u03b5\u22121 ]\u03b40\n\n\u0014 \u001aZ\n\nt+s\nt\n\n= E[\u03b5\u22121]\u03b40\n\nXu\u031f,\u03b5 ,\n\n\u0014\u001a Z\n\n+ E[\u03b5\u22121]\u03b40\n\nI\n\n\u0393\u03b5\u031f\n\n\u2212hXu\u031f,\u03b5 ,gi\n\ng e\n\ndu\n\n\u001bY\np\ni=1\n\nt+s\nt\n\n\u0014\u001a Z\n\nhXu\u031f,\u03b5 , \u03bagi\n\nt+s\nt\n\nXu\u031f,\u03b5 ,\n\n\u2212hXu\u031f,\u03b5 ,gi\n\ne\n\ndu\n\n\u001bY\np\ni=1\n\nI\u0393\u03b5\u031f\n\n\u0015\n\n\u0001\nfi Xt\u031f,\u03b5\ni\n\n\u0015\n\n\u0001\nfi Xt\u031f,\u03b5\ni\n\n\u0015\n\u001bY\np\n\u0001\n\u031f,\u03b5 \u0001\n\u2212hXu\u031f,\u03b5 ,gi\nfi Xti\n.\n\u2212\u03ba g e\ndu\ni=1\n\nThe absolute value of the second term in the right-hand side of (15) is bounded above by\n\u0012Y\np\ni=1\n\n\u0013Z\nkfi k\n\nt+s\nt\n\nE[\u03b5\u22121 ]\u03b40\n\nh\n\n12\n\n\u0001 i\nXu\u031f,\u03b5 , I\u0393\u03b5\u031f \u2212 \u03ba g du.\n\n(15)\n\n\fConsequently, going back to (14) and using the preceding estimates, we obtain for every \u031f \u2208 \u03a9 and\n\u03b5 \u2208 (0, 1),\n\n\u0015\n\u001bY\np\n\u03c3 2 2 E \u2212hXu\u031f,\u03b5 ,gi\n\u031f,\u03b5 \u0001\nfi Xti\ndu\n+ \u03bag + g e\n2\n2\nt\ni=1\n\u0013\n\u0013\u0012\n\u0012Y\np\n\b\n2\nC2 (g) \u03b5 + (\u03c3 /2)k\u03b7\u0303\u03b5 k s + r\u03b5 (\u031f, g, t, t + s) ,\n(16)\nkfi k\n\u2264\n\n\u0014\u001a\nZ\n\u031f,\u03b5\n\u2212hXt+s\n,gi\n\u2212hXt\u031f,\u03b5 ,gi\nE[\u03b5\u22121]\u03b40 e\n\u2212e\n\u2212\n\nt+s D\n\n1\nXu\u031f,\u03b5 , \u2212 \u2206g\n\ni=1\n\nwhere r\u03b5 (\u031f, g, t1 , t2 ) is defined for 0 \u2264 t1 \u2264 t2 by\nr\u03b5 (\u031f, g, t1 , t2 ) =\n\nZ\n\nt2\n\nt1\n\nE[\u03b5\u22121 ]\u03b40\n\nh\n\nLemma 6. Let u > 0. Then, P-a.s.\nlim E[\u03b5\u22121 ]\u03b40\n\n\u03b5\u2192\u221e\n\nh\n\n\u0001 i\nXu\u031f,\u03b5 , I\u0393\u03b5\u031f \u2212 \u03ba g du.\n\n\u0001 i\n= 0.\nXu\u031f,\u03b5 , I\u0393\u03b5\u031f \u2212 \u03ba g\n\n(17)\n\nAssuming that the lemma is proved, we can\ncomplete the proof of Proposition 3. Using\n\u0002 readily\n\u0003\nFubini's theorem, we may find a set \u03a9g with P \u03a9g = 1, such that, for every \u031f \u2208 \u03a9g , the convergence\nin (17) holds simultaneously for all u > 0, except possibly on a set of zero Lebesgue measure (depending\non \u031f). Since for every \u031f \u2208 \u03a9, \u03b5 \u2208 (0, 1) and u \u2265 0\nh\n\u0001 i\n\u2264 kgk E[\u03b5\u22121 ]\u03b40 [hXu\u031f,\u03b5 , 1i] \u2264 kgk,\nE[\u03b5\u22121]\u03b40 Xu\u031f,\u03b5 , I\u0393\u03b5\u031f \u2212 \u03ba g\n\ndominated convergence guarantees that for each \u031f \u2208 \u03a9g , lim\u03b5\u21920 r\u03b5 (\u031f, g, t, t + s) = 0 for all t, s \u2265 0. It\nfollows that the right-hand side of (16) tends to 0 as \u03b5 \u2192 0 when \u031f \u2208 \u03a9g , which completes the proof\nof Proposition 3.\n\u0003\nProof of Lemma 6. Recall that \u03be \u031f,\u03b5 denotes standard d-dimensional Brownian motion killed at\nrate \u03b5 within \u0393\u031f . We also use the notation \u03c7\u031f,\u03b5 for Brownian motion killed at rate 1 within \u0393\u03b5\u031f . Both\nprocesses \u03be \u031f,\u03b5 and \u03c7\u031f,\u03b5 start from x under the probability measure Px .\nWe first recall classical moment formulas for branching Brownian motion. For every x \u2208 Rd , k \u2208 N,\nand every bounded measurable function h on Rd , we have\nEk\u03b4x [hZt\u031f,\u03b5 , hi] = k Ex [h(\u03bet\u031f,\u03b5 )]\nand\nEk\u03b4x [hZt\u031f,\u03b5 , hi2 ]\n\n=\n\nk Ex [h(\u03bet\u031f,\u03b5 )2 ] +\n\nk(k \u2212\n\n1)Ex [h(\u03bet\u031f,\u03b5 )]2\n\n2\n\n+ k\u03c3 Ex\n\n\u0014Z\n\nt\n\nds E\n0\n\n\u03bes\u031f,\u03b5\n\n\u031f,\u03b5 2\n[h(\u03bet\u2212s\n)]\n\n\u0015\n\n.\n\nThese formulas are easily derived, first for k = 1, from the well-known formula for the Laplace functional\nof Zt\u031f,\u03b5 under P\u03b4x : See e.g. Proposition II.3 in [LG99].\nRecalling the definition of X \u031f,\u03b5 in terms of Z \u031f,\u03b5, we get similar formulas for the first and second\nmoment of hXs\u031f,\u03b5 , hi. In particular, for s \u2265 0 and for every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1), we have\nh\n\u0001\n\u0001 2i\n2\n\u22121 \u031f,\u03b5\n= \u03b52 [\u03b5\u22121 ]2 \u2212 [\u03b5\u22121 ] A\u031f,\u03b5\n(18)\nE[\u03b5\u22121 ]\u03b40 Xs\u031f,\u03b5 , I\u0393\u03b5\u031f \u2212 \u03ba g\n1 (0, s, g) + \u03b5[\u03b5 ]A2 (0, s, g),\nwhere, for every x \u2208 Rd ,\n\nh\ni\n\u0001\n\u031f,\u03b5\n\u031f,\u03b5\n\u03b5 (\u03c7\nA\u031f,\u03b5\n(x,\ns,\ng)\n:=\nE\nI\n)\n\u2212\n\u03ba\ng(\u03c7\n)\n,\nx\n\u0393\ns\ns\n1\n\u031f\n13\n\n\fand\n2\nA\u031f,\u03b5\n2 (x, s, g) := \u03c3 Ex\n\n\u0014Z\n\ns\n0\n\n\u0015\ni\nh\n\u00012\n\u031f,\u03b5\n2\n\u031f,\u03b5\n\u031f,\u03b5 2\n\u03b5\n.\nA\u031f,\u03b5\n(\u03c7\n,\ns\n\u2212\nv,\ng)\ndv\n+\n\u03b5\nE\nI\n(\u03c7\n)\n\u2212\n\u03ba\ng(\u03c7\n)\nx\n\u0393\u031f\nv\ns\ns\n1\n\nWe claim that, for every x \u2208 Rd and s > 0,\nh\n\u0001\n\u0001\n\u0001i\n\u031f,\u03b5\nP\u2212a.s.,\nlim Ex I\u0393\u03b5\u031f \u03c7\u031f,\u03b5\n\u2212\n\u03ba\ng\n\u03c7\n= 0.\ns\ns\n\n(19)\n\n\u03b5\u21920\n\nAssume for the moment that the claim holds. By taking x = 0 in (19), we obtain that A\u031f,\u03b5\n1 (0, s, g)\n\u031f,\u03b5\n\u031f,\u03b5\ntends to 0 as \u03b5 \u2192 0, P-a.s. Consider next A2 (0, s, g). The second term in the formula for A2 (x, s, g)\nobviously tends to 0 uniformly in x, s and independently of the obstacles, as \u03b5 \u2192 0. To handle the\ne of full probability,\nfirst term, use Fubini's theorem to obtain that, for every \u031f belonging to a set \u03a9\nd\nthere exists a set N\u031f \u2282 R \u00d7 R+ of zero Lebesgue measure such that the convergence in (19) holds\nsimultaneously for all (x, s) \u2208\n/ N\u031f . We can then write the first term in the formula for A\u031f,\u03b5\n2 (0, s, g) as\nfollows:\nZ s Z\nh\ni2\n\u0001\n\u031f,\u03b5\n\u031f,\u03b5\n\u03b5\ndy p\u031f,\u03b5\n(0,\ny)\nE\nI\n(\u03c7\n)\n\u2212\n\u03ba\ng(\u03c7\n)\n\u03c32\n,\n(20)\ndv\ny\n\u0393\u031f\nv\ns\u2212v\ns\u2212v\n0\n\nRd\n\n\u031f,\u03b5 at time v. Plainly, we have p\u031f,\u03b5 (x, y) \u2264 p (x, y) for each\nwhere p\u031f,\u03b5\nv (*, *) is the transition kernel of \u03c7\nv\nv\nv \u2265 0 and \u03b5 \u2208 (0, 1), where pv (*, *) is the transition kernel of standard Brownian motion at time v.\nUsing this bound and dominated convergence gives us that the quantity in (20) tends to 0 as \u03b5 \u2192 0,\ne Hence A\u031f,\u03b5 (0, s, g) tends to 0 as \u03b5 \u2192 0, P-a.s. The result of Lemma 6 now follows\nfor every \u031f \u2208 \u03a9.\n2\nfrom (18) and the Cauchy-Schwarz inequality.\nWe still have to prove our claim (19). We fix x \u2208 Rd and s > 0. Let \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1). From\nthe definition of Brownian motion killed at rate 1 in \u0393\u03b5\u031f , we have\noi\nn Z s\nh\ni\nh\n\u0001\n\u0001\n\u031f,\u03b5\n\u03b5\n\u03b5\n(\u03be\n)du\n.\n(21)\nI\n(\u03be\n)\n\u2212\n\u03ba\ng(\u03be\n)\nexp\n\u2212\nI\n)\n\u2212\n\u03ba\ng(\u03c7\n)\n=\nE\nEx I\u0393\u03b5\u031f (\u03c7\u031f,\u03b5\n\u0393\u031f u\ns\n\u0393\u031f s\nx\ns\ns\n0\n\nLet \u03b7 > 0 and choose \u03b8 \u2208 (0, s) such that e\u2212\u03b8 \u2265 1 \u2212 \u03b7. By the Markov property applied at time s \u2212 \u03b8,\nthe quantities in (21) are equal to\n\u0014\nh\noi\u0015\nn Z \u03b8\no\nn Z s\u2212\u03b8\n\u0001\nI\u0393\u03b5\u031f (\u03bev )dv\nI\u0393\u03b5\u031f (\u03beu )du E\u03bes\u2212\u03b8 I\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) exp \u2212\nEx exp \u2212\n0\n0\n\u0014\nh\ni\u0015\no\nn Z s\u2212\u03b8\n\u0001\n\u03b5\n\u03b5\n= Ex exp \u2212\nI\u0393\u031f (\u03beu )du E\u03bes\u2212\u03b8 I\u0393\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\n(22)\n0\n\u0014\no\n\u0011i\u0015\nh\n\u0010\nn Z \u03b8\no\nn Z s\u2212\u03b8\n\u0001\n\u03b5\n\u03b5\n\u03b5\n+Ex exp \u2212\nI\u0393\u031f (\u03bev )dv \u2212 1\n.\nI\u0393\u031f (\u03beu )du E\u03bes\u2212\u03b8 I\u0393\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) exp \u2212\n0\n\n0\n\nThe condition 1 \u2212 e\u2212\u03b8 \u2264 \u03b7 entails that the absolute value of the second term in the right-hand side of\n(22) is bounded above by kgk\u03b7. Suppose we know that for every y \u2208 Rd we have\nh\ni\n\u0001\nP\u2212a.s.,\nlim Ey I\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) = 0.\n(23)\n\u03b5\u21920\n\nThen, using the fact that the law of \u03bes\u2212\u03b8 is absolutely continuous with respect to Lebesgue measure\n(and Fubini's theorem to see that the convergence in (23) holds simultaneously for almost all y \u2208 Rd ,\nP-a.s.), we conclude that the first term in the right-hand side of (22) converges to 0 with P-probability\n1 as \u03b5 \u2192 0. Consequently, we have P-a.s.\nh\ni\n\u0001\n\u031f,\u03b5\nlim sup Ex I\u0393\u03b5\u031f (\u03c7\u031f,\u03b5\n)\n\u2212\n\u03ba\ng(\u03c7\n)\n\u2264 kgk\u03b7.\ns\ns\n\u03b5\u21920\n\nSince \u03b7 was arbitrary, our claim (19) follows.\n\n14\n\n\fIt thus remains to prove that (23) holds. We fix y \u2208 Rd and \u03b8 > 0. In the following, \u03be \u2032 stands for\nanother Brownian motion independent of \u03be, which also starts from y under the probability measure\nPy . For each \u03b5 \u2208 (0, 1), we have\nh \u0002\nh \u0002\n\u0003i\n\u0001\n\u0001\n\u0001\n\u00032 i\n= E Ey I\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba I\u0393\u03b5\u031f (\u03be\u03b8\u2032 ) \u2212 \u03ba g(\u03be\u03b8 )g(\u03be\u03b8\u2032 )\nE Ey I\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\noi\nn \u0002\nh\n\u0003\n(24)\n= Ey g(\u03be\u03b8 )g(\u03be\u03b8\u2032 ) P \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f \u2212 \u03ba2 ,\n\nwhere the last line uses Fubini's theorem and the definition of \u03ba. Recall that the measure \u0398 is\nsupported on compact sets which are contained in the fixed ball B(0, r0 ). If |x \u2212 x\u2032 | > 2r0 , the sets\n{(z, K) : x \u2208 z + K and K \u2282 B(0, r0 )} and {(z, K) : x\u2032 \u2208 z + K and K \u2282 B(0, r0 )} are disjoint, and\n\u221a\nso the events {x \u2208 \u0393\u031f } and {x\u2032 \u2208 \u0393\u031f } are independent under P. Recalling that \u0393\u03b5\u031f = \u03b5 \u0393\u031f , we see\n\u221a\nthat if |x \u2212 x\u2032 | > 2r0 \u03b5 we have P[x \u2208 \u0393\u03b5\u031f ; x\u2032 \u2208 \u0393\u03b5\u031f ] = P[x \u2208 \u0393\u03b5\u031f ]P[x\u2032 \u2208 \u0393\u03b5\u031f ] = \u03ba2 , which enables us\nto write\n\u0002\n\u0003\n\u0002\n\u0003\nP \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f = \u03ba2 I{|\u03be\u03b8 \u2212\u03be \u2032 |>2r0 \u221a\u03b5} + P \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f I{|\u03be\u03b8 \u2212\u03be \u2032 |\u22642r0 \u221a\u03b5} .\n\u03b8\n\n\u03b8\n\nGoing back to (24), we obtain\nh\nh \u0002\noi\nn \u0002\n\u0001\n\u00032 i\n\u0003\n= Ey g(\u03be\u03b8 )g(\u03be\u03b8\u2032 )I{|\u03be\u03b8 \u2212\u03be \u2032 |\u22642r0 \u221a\u03b5} P \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f \u2212 \u03ba2\nE Ey I\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\n\u03b8\n\u0002\n\u221a \u0003\n2\n\u2032\n\u2264 kgk Py |\u03be\u03b8 \u2212 \u03be\u03b8 | \u2264 2r0 \u03b5\n\u0002\n\u221a \u0003\n= kgk2 P0 |\u03be2\u03b8 | \u2264 2r0 \u03b5\n\u2264C\n\nkgk2 d/2\n\u03b5 ,\n\u03b8 d/2\n\n(25)\n\nwhere the constant C > 0 depends only on r0 . Let \u03b7 > 0. By the Markov inequality, we can write\nh \u0002\ni\n\u0001\n\u0003\n\u0001\n\u00032 i\n1 h \u0002\nkgk2\nP Ey I\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) > \u03b7 \u2264 2 E Ey I\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\n\u2264 C 2 d/2 \u03b5d/2 .\n\u03b7\n\u03b7 \u03b8\n\nApplying the last bound with \u03b5 = \u03b5k = k\u22123 , for every k \u2208 N, yields a convergent series, and so by the\nBorel-Cantelli lemma we have P-a.s.,\n\u0002\n\u0001\n\u0003\nlim sup Ey I\u0393\u03b5\u031fk (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) \u2264 \u03b7.\nk\u2192\u221e\n\nSince \u03b7 > 0 was arbitrary, the convergence (23) holds along the sequence (\u03b5k )k\u22651 .\nTo complete the proof, we set for every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1)\n\u0002\n\u0003\nU\u031f,\u03b5 = Ey I\u0393\u03b5\u031f (\u03be\u03b8 ) g(\u03be\u03b8 )\n\n(recall that y and \u03b8 are fixed). We shall prove the following result: For every \u031f \u2208 \u03a9,\nlim\n\nsup\n\nk\u2192\u221e (k+1)\u22123 \u2264\u03b5\u2264k \u22123\n\nU\u031f,\u03b5 \u2212 U\u031f,\u03b5k = 0.\n\n(26)\n\nCombining (26) with the fact that the convergence (23) is true along the sequence (\u03b5k )k\u22651 will then\nlead to the desired conclusion. In order to prove (26), we first note that for every \u03b5 \u2208 (0, 1),\nZ\nZ\n|x\u2212y|2\n1\n\u2212\n2\nI\u0393\u03b5\u031f (x) h(x)dx,\nI\u0393\u03b5 (x) g(x)e 2\u03b8 dx =\nU\u031f,\u03b5 =\n(2\u03c0\u03b8)d/2 Rd \u031f\nRd\n2 (Rd ) which depends on y and \u03b8, but not on \u031f. Furthermore, for any fixed\nwith a function h \u2208 C\u0304+\nR\n\u03b7 > 0 we can find a large closed ball B centered at the origin and such that B c h(x)dx < \u03b7. Hence, if\nwe set\nZ\n\u2032\nh(x) I\u0393\u03b5\u031f (x)dx,\nU\u031f,\u03b5 =\nB\n\n15\n\n\f\u2032 | \u2264 \u03b7 for every \u03b5 \u2208 (0, 1). Thanks to this remark, it is enough to prove that (26)\nwe have |U\u031f,\u03b5 \u2212 U\u031f,\u03b5\n\u2032\n\u2032\nrespectively.\nand U\u031f,\u03b5\nholds when U\u031f,\u03b5 and U\u031f,\u03b5k are replaced by U\u031f,\u03b5\nk\n\u22123\n\u22123\nLet k \u2208 N and \u03b5 \u2208 [(k + 1) , k ). We have\nZ\n\u221a \u0001\n\u2032\nd/2\nh x \u03b5 I\u0393\u031f (x)dx\nU\u031f,\u03b5 = \u03b5\n\u22121/2 B\nZ\nZ\u03b5\n\u221a \u0001\n\u221a \u0001\nd/2\nd/2\nh x \u03b5 I\u0393\u031f (x)dx.\n(27)\n=\u03b5\nh x \u03b5 I\u0393\u031f (x)dx + \u03b5\n(\u03b5\u22121/2 B)\\(k 3/2 B)\n\nk 3/2 B\n\nNow, the first term in the right-hand side of (27) is equal to\nZ\nZ\n\u0010 x \u0011i\n\u0010 x \u0011\nh \u0010 \u221a \u0011\n\u0001\nd/2\n3 d/2 1\n\u2212\nh\nh\nh\nx\nI\nI\u0393\u031f (x)dx\n(x)dx\n+\n\u03b5\n\u03b5k\n\u03b5\n\u0393\u031f\nk3d/2 k3/2 B\nk3/2\nk3/2\nk 3/2 B\n\u0001d/2 \u2032\n= \u03b5k 3\nU\u031f,\u03b5k + \u03b9(\u031f, \u03b5, k),\n\nwhere\n\n3 d/2\n\n\u03b9(\u031f, \u03b5, k) = (\u03b5k )\nNote that 0 \u2264\nthat\n\n\u221a\n1 \u2212 k3/2 \u03b5\n\nZ h\nB\n\n\u2264\n\nC\nk\n\ni\n\u221a\nh((k3/2 \u03b5)y) \u2212 h(y) I\u0393\u031f (k3/2 y)dy.\n\nwith a constant C independent of \u03b5 and k, from which it easily follows\nsup\n(k+1)\u22123 \u2264\u03b5\u2264k \u22123\n\n|\u03b9(\u031f, \u03b5, k)| \u2264\n\nC\u2032\nk\u2207hk,\nk\n\nwith a constant C \u2032 depending only on B.\nSimilarly, the second term in the right-hand side of (27) is bounded above by\n\u0002\n\u0003\nC \u2032\u2032 khk\n\u03b5d/2 khk \u03b5\u2212d/2 \u2212 k3d/2 \u03bbd (B) \u2264\n.\nk\n\nFinally, from (27) and the preceding estimates, we have\n\n\u2032\n\u2032\n\u2032\nU\u031f,\u03b5\n\u2212 U\u031f,\u03b5\n+\n\u2264 (1 \u2212 (\u03b5k 3 )d/2 ) U\u031f,\u03b5\nk\nk\n\nC \u2032 k\u2207hk C \u2032\u2032 khk\n+\n,\nk\nk\n\nand the convergence (26) follows. This completes the proof.\n\n\u0003\n\nProof of Proposition 1. Clearly we get a lower bound for the quantity P\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) if we\nreplace Z \u031f,\u03b5 by branching Brownian motion killed homogeneously over Rd at rate \u03b5. Part (i) of the\nproposition thus follows from the lower bound in Lemma 1.\nLet us turn to the proof of the first assertion in (ii). We have the following inequality: For every\n\u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1),\n\u0002\n\u0003\n\u0002\n\u0003\n(28)\nP\u03b40 Z \u031f,\u03b5 hits B(0, R)c \u2264 P0 \u03be \u031f,\u03b5 hits B(0, R)c .\n\nIndeed, using the formalism of Subsection 2.3, the criticality of the offspring distribution can be used\nto check that the right-hand side of (28) is just the expected value of the number of those historical\npaths \u03c9 v that first exit B(0, R) during the interval [\u03b1v , \u03b2v \u2227\u0002 \u03b6v\u031f,\u03b5). Alternatively,\n\u0003 it is easy to derive\nan integral equation similar to (8) for the function x \u2192 P\u03b4x Z \u031f,\u03b5 hits B(0, R)c , and the bound (28)\nthen trivially follows from this\u0002integral equation. \u0003\nThen, let us bound P \u2297 P0 \u03be \u031f,\u03b5 hits B(0, R)c . We write \u03be \u031f,\u03b5,k for the k-th coordinate of \u03be \u031f,\u03b5 , for\nevery k = 1, . . . , d. First, observe that\nd\n\u221a \u0003\n\u221a\n\u0002\n\u0003 X\n\u0002\nP \u2297 P0 \u03be \u031f,\u03b5 hits B(0, R)c \u2264\nP \u2297 P0 \u03be \u031f,\u03b5,k hits (\u2212R/ d, R/ d)c .\nk=1\n\n16\n\n(29)\n\n\f\u221a \u221a\nClearly, we can restrict our attention to the first term in the sum. Define N\u03b5,R := [R \u03b5/ d] and for\nevery j \u2208 Z, set Tj\u03b5 = inf{t \u2265 0 : \u03bet1 = j\u03b5\u22121/2 }, where \u03be 1 stands for the first coordinate of \u03be. In this\nnotation, we can write\n\u221a \u0003\n\u221a\n\u0002\nP \u2297 P0 \u03be \u031f,\u03b5,1 hits (\u2212R/ d, R/ d)c\nh\n\u0001c i\n\u2264 P \u2297 P0 \u03be \u031f,\u03b5,1 hits \u2212 N\u03b5,R \u03b5\u22121/2 , N\u03b5,R \u03b5\u22121/2\n\u001b\u0015\n\u0014\n\u001a\n\u001b\u0015\n\u0014\n\u001a\nZ T\u03b5\nZ T\u03b5\nN\u03b5,R\n\u2212N\u03b5,R\n\u2264 E \u2297 E0 exp \u2212 \u03b5\nI\u0393\u031f (\u03bes )ds\n+ E \u2297 E0 exp \u2212 \u03b5\nI\u0393\u031f (\u03bes )ds .\n(30)\n0\n\n0\n\nConsider the first term in the right-hand side of (30). Recall the definition (1) of the set of obstacles,\nand set for every j \u2208 N and \u03b5 > 0,\n\b\nIj\u03b5 := i \u2208 I : xi \u2208 ((j \u2212 1)\u03b5\u22121/2 , j\u03b5\u22121/2 ) \u00d7 Rd\u22121 ,\n[\n\u221a\n(xi + Ki )\nand\n\u0393\u03b5\u031f (j) := \u03b5 \u0393\u031f (j, \u03b5).\n\u0393\u031f (j, \u03b5) :=\ni\u2208Ij\u03b5\n\nNote that the random sets \u0393\u031f (j, \u03b5), j \u2208 N, are independent under P, by properties of Poisson measures.\nWe have then\n\u001b\u0015\n\u0014\n\u001a\n\u0014\n\u001a\n\u001b\u0015\nN\u03b5,R Z T \u03b5\nZ T\u03b5\nX\nj\nN\u03b5,R\nE \u2297 E0 exp \u2212 \u03b5\nI\u0393\u031f (\u03bes )ds \u2264 E \u2297 E0 exp \u2212 \u03b5\nI\u0393\u031f (j,\u03b5) (\u03bes )ds\n0\n\n\u0014\n\n= E \u2297 E0 exp\n\n\u001a\n\nj=1\n\n\u2212\u03b5\n\nZ\n\n\u03b5\nTj\u22121\n\nT1\u03b5\n\n0\n\nI\u0393\u031f (1,\u03b5) (\u03bes )ds\n\n\u001b\u0015N\u03b5,R\n\n,\n\n(31)\n\nwhere the equality comes from an application of the strong Markov property of \u03be, together with the\nindependence of the random sets \u0393\u031f (j, \u03b5) and the fact that the distribution of each of these random\nsets is invariant under translations by elements of {0} \u00d7 Rd\u22121 . By scaling, if T1 denotes the entrance\ntime of \u03be into [1, \u221e) \u00d7 Rd\u22121 , we can write\n\u0014\n\u001a\n\u001b\u0015\n\u001b\u0015\n\u0014\n\u001a Z T1\nZ T\u03b5\n1\n\u03b1\u03b5 := E \u2297 E0 exp \u2212 \u03b5\nI\u0393\u031f (1,\u03b5) (\u03bes )ds\n= E \u2297 E0 exp \u2212\nI\u0393\u03b5\u031f (1) (\u03bes )ds .\n0\n\nWe then observe that\n\nZ\n\nT1\n0\n\n0\n\nI\u0393\u03b5\u031f (1) (\u03bes )I(0,1) (\u03bes1 ) ds\n\n(P )\n\n\u2212\u2192 \u03ba\n\u03b5\u21920\n\nZ\n\nT1\n0\n\nI(0,1) (\u03bes1 )ds\n\n(32)\n\n(P )\n\nwhere the notation \u2212\u2192 refers to convergence in probability under P\u2297P0 . To see this, we use arguments\n\nsimilar to the proof of Lemma 6. Notice that P[y \u2208 \u0393\u03b5\u031f (1)] \u2264 \u03ba if y \u2208 (0, 1) \u00d7 Rd\u22121 , with equality if\n\u221a\n\u221a\ny \u2208 (r0 \u03b5, 1 \u2212 r0 \u03b5) \u00d7 Rd\u22121 . Using this remark, and the same argument as in the derivation of (25),\nwe can write for every fixed u > 0,\n\u001b2 \u0015\n\u0014\u001a Z T1 \u2227u\n\u0001\n1\nE \u2297 E0\nI\u0393\u03b5\u031f (1) (\u03bes ) \u2212 \u03ba I(0,1) (\u03bes )ds\n0\n\u0014 Z T1 \u2227uZ T1 \u2227u\n\u0015\n1\n1\n= E \u2297 E0\nI\u0393\u03b5\u031f (1) (\u03bes ) \u2212 \u03ba)(I\u0393\u03b5\u031f (1) (\u03bet ) \u2212 \u03ba) I(0,1) (\u03bes ) I(0,1) (\u03bet ) dsdt\n0\n0\n\u0014 Z T1 \u2227uZ T1 \u2227u\n\u0015\n\b \u0002\n\u0003\n\u03b5\n2\n1\n1\n= E0\nP \u03bes , \u03bet \u2208 \u0393\u031f (1) \u2212 \u03ba I(0,1) (\u03bes ) I(0,1) (\u03bet ) dsdt + O(\u03b51/2 )\n0\n0\n\u0015\n\u0014 Z T1 \u2227uZ T1 \u2227u\n\b \u0002\n\u0003\n= E0\nP \u03bes , \u03bet \u2208 \u0393\u03b5\u031f (1) \u2212 \u03ba2 I{|\u03bes \u2212\u03bet |\u22642r0 \u221a\u03b5} I(0,1) (\u03bes1 ) I(0,1) (\u03bet1 ) dsdt + O(\u03b51/2 )\n\u0015\n\u0014 Z0 uZ u 0\n\u221a\n\u2264 E0\nI{|\u03bes \u2212\u03bet |\u22642r0 \u03b5} dsdt + O(\u03b51/2 )\n0\n\n0\n\n17\n\n\fwhere the error term O(\u03b51/2 ) corresponds to the contribution of times s, t such that \u03bes1 or \u03bet1 belongs\n\u221a\n\u221a\nto the set (0, r0 \u03b5] \u222a [1 \u2212 r0 \u03b5, 1). The preceding quantity tends to 0 as \u03b5 \u2192 0, which yields the\nconvergence (32). Since the limiting variable in (32) is (strictly) positive a.s., we can find \u03b51 \u2208 (0, 1)\nand c1 < 1 such that \u03b1\u03b5 \u2264 c1 for every \u03b5 \u2208 (0, \u03b51 ). Using (29), (30) and (31), we arrive at\n\u0002\n\u0003\nN\nP \u2297 P0 \u03be \u031f,\u03b5 hits B(0, R)c \u2264 2d c1 \u03b5,R ,\n\nfor \u03b5 \u2208 (0, \u03b51 ). This completes the proof of the first assertion in (ii).\nLet us turn to the second assertion. Let C2 > 0 be a positive constant whose choice will be specified\nlater. By simple comparison arguments, it is enough to prove the desired estimate when R is of the\nform R = 2k , for k \u2208 N large enough, and \u03b5 is of the form \u03b5 = 2\u2212j , with j \u2208 {0, 1, . . . , 2k} such that\n\u03b5 \u2265 C2 (log log R)2 /R2 .\nBy the first assertion in (ii) and the Markov inequality,\ni\nh \u0002\n\u0003\n\u221a\n\u221a\n(33)\nP P\u03b40 Z \u031f,\u03b5 hits B(0, R)c \u2265 exp(\u2212C1 R \u03b5/2) \u2264 exp(\u2212C1 R \u03b5/2).\nHowever, if R = 2k and \u03b5 \u2265 C2 (log log R)2 /R2 , we have\np\np\n\u221a\nR \u03b5 \u2265 C2 log log R = C2 (log k + log log 2).\n\nUsing this bound, we can choose the constant C2 sufficiently large so that we get a convergence series\nwhen we sum the right-hand side of (33) over all R = 2k and \u03b5 = 2\u2212j for j \u2208 {0, 1, . . . , 2k} such that\n\u03b5 \u2265 C2 (log log R)2 /R2 . The Borel-Cantelli lemma now yields the desired result.\n\u0003\n\n4\n\nProof of the main result\n\nIn this section, we prove Theorem 1. We fix the environment \u031f such that the weak convergence of\nTheorem 2 holds, and derive the convergence in Theorem 1 for this fixed value of the environment. For\nthe sake of simplicity, we shall omit \u031f in the notation and write Z \u03b5 instead of Z \u031f,\u03b5 , and X \u03b5 instead\nof X \u031f,\u03b5 .\nWe shall verify that for any increasing sequence (Rn )n\u22651 of positive reals converging to +\u221e and\nany sequence (\u03b5n )n\u22651 of nonnegative reals such that \u03b5n Rn2 \u2192 a \u2208 [0, \u221e], we have\nlim Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = u(\u03baa) (0),\n\nn\u2192\u221e\n\n(34)\n\nwhere u(\u221e) (0) = 0 by convention.\nThe statement of Theorem 1 follows from this convergence. Indeed, if the conclusion of the theorem\nfails, then we can find a sequence Rn \u2191 \u221e and a sequence (\u03b5n ) of nonnegative reals such that, for every\nn \u2265 1,\n|Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2212 u(\u03ba\u03b5n R2n ) (0)| \u2265 \u03b4\n\nfor some constant \u03b4 > 0. By extracting a subsequence, we may assume that \u03b5n Rn2 \u2212\u2192 a \u2208 [0, \u221e] and\nthus obtain a contradiction with (34) since we know from Lemma 2 that the mapping b \u2192 u(b) (0) is\ncontinuous on [0, \u221e].\nIn proving (34), we may assume that \u03b5n \u2192 0 as n \u2192 \u221e. Indeed, suppose that (34) holds in this\nparticular case and let (\u03b5\u2032n ) be a sequence that does not converge to 0. If the sequence \u03b5\u2032n Rn2 converges\nthen necessarily its limit is +\u221e, and we can find another sequence \u03b5\u2032\u2032n such that 0 \u2264 \u03b5\u2032\u2032n \u2264 \u03b5\u2032n , \u03b5\u2032\u2032n \u2192 0\nand \u03b5\u2032\u2032n Rn2 \u2192 \u221e. So, if we know that (34) holds in the case when the sequence (\u03b5n ) tends to 0, we\nobtain\n\u2032\u2032\nlim Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = 0.\nn\u2192\u221e\n\n18\n\n\fHowever, from the inequality \u03b5\u2032\u2032n \u2264 \u03b5\u2032n and a coupling argument (obvious if one uses the construction\ndescribed in Subsection 2.3), we get the same result for the sequence (\u03b5\u2032n ).\nA similar comparison argument shows that it is enough to prove (34) in the case when a < \u221e.\nOtherwise, it suffices to replace \u03b5n by \u03b5n \u2227 bRn\u22122 and let b \u2192 \u221e, using the fact that u(b) (0) \u2192 0 as\nb \u2192 \u221e.\nLet us now proceed to the proof of (34). We fix the sequences Rn \u2191 \u221e and \u03b5n \u2192 0 such that\n\u03b5n Rn2 \u2212\u2192 a \u2208 [0, \u221e). We first assume that a > 0. The case a = 0 will be discussed at the end of the\nsection.\nLet B be a closed subset of Rd . For every \u03b5 > 0, we have by the definition of X \u03b5\nP[\u03b5\u22121 ]\u03b40 (X \u03b5 hits B) = P[\u03b5\u22121]\u03b40 (\u2203t \u2265 0 : Xt\u03b5 (B) > 0)\n\u0012\n\u0013\nZ\n\u221a\n\u03b5\n= P[\u03b5\u22121]\u03b40 \u2203t \u2265 0 : Z\u03b5\u22121 t (dx) IB (x \u03b5) > 0\n= P[\u03b5\u22121]\u03b40 (Z \u03b5 hits \u03b5\u22121/2 B)\n\n= 1 \u2212 P\u03b40 (Z \u03b5 does not hit \u03b5\u22121/2 B)[\u03b5\n\n\u22121 ]\n\n,\n\nsince (for a fixed environment) the law of Z \u03b5 under P[\u03b5\u22121 ]\u03b40 is obtained by adding [\u03b5\u22121 ] independent\n1/2\n\ncopies of Z \u03b5 under P\u03b40 . Applying the preceding identity with \u03b5 = \u03b5n and B = bn Ac , where bn = \u03b5n Rn ,\ngives us that\n\u22121\n1 \u2212 P\u03b40 (Z \u03b5n does not hit Rn Ac )[\u03b5n ] = P[\u03b5\u22121\n(X \u03b5n hits bn Ac )\n(35)\nn ]\u03b40\n\nconverges as n \u2192 \u221e to the law of superBy Theorem 2, we know that the law of X \u03b5n under P[\u03b5\u22121\nn ]\u03b40\nBrownian motion with branching mechanism \u03c8(\u03ba) started from \u03b40 . The next lemma is essentially a\nconsequence of this convergence. We use the notation of Subsection 2.4.\nLemma 7. We have\nlim P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) = P\u03b40 (Y (\u03ba) hits bAc ),\nn ]\u03b40\n\nwhere b =\n\n\u221a\n\nn\u2192\u221e\n\na = lim bn .\n\nWe postpone the proof of Lemma 7 and proceed to the proof of (34), in the case when a > 0. By\nthe results recalled in Subsection 2.4, we know that\nP\u03b40 (Y (\u03ba) hits bAc ) = 1 \u2212 exp(\u2212v(0)) ,\n\n(36)\n\nwhere the function (v(x), x \u2208 bA) is the unique nonnegative solution of the singular boundary value\nproblem\n(1\nin bA ,\n2 \u2206v = \u03c8(\u03ba) (u)\nu|\u2202(bA) = +\u221e .\n\nIt is immediate to verify that u(\u03baa) (x) = a v(bx) for every x \u2208 A, and in particular u(\u03baa) (0) = a v(0).\nFrom (35), (36) and Lemma 7, we obtain\n\u22121\n\nlim (1 \u2212 P\u03b40 (Z \u03b5n hits Rn Ac ))[\u03b5n\n\nn\u2192\u221e\n\n]\n\n= exp(\u2212v(0))\n\nand thus\nlim \u03b5\u22121 P\u03b40 (Z \u03b5n\nn\u2192\u221e n\n\nhits Rn Ac ) = v(0),\n\nor equivalently, since \u03b5n Rn2 \u2212\u2192 a,\nlim Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = av(0) = u(\u03baa) (0).\n\nn\u2192\u221e\n\n19\n\n\fThis completes the proof of (34), in the case a > 0.\n\u0003\nProof of Lemma 7. By replacing A with bA, we may and shall assume in this proof that b = 1. We\nthus have bn \u2212\u2192 1 as n \u2192 \u221e. We first prove that\nlim inf P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) \u2265 P\u03b40 (Y (\u03ba) hits Ac ).\nn ]\u03b40\nn\u2192\u221e\n\n(37)\n\nBy Lemma 3, the events {Y (\u03ba) hits Ac } and {Y (\u03ba) hits \u0100c } coincide a.s. We can then find a countable\ncollection (\u03c6i )i\u22651 of continuous functions with compact support contained in (\u0100)c , such that\n\u0011\no\n\u0010\nn\n(\u03ba)\nP\u03b40 a.s..\n{Y (\u03ba) hits (\u0100)c } = sup sup hYt , \u03c6i i > 0 ,\ni\u22651\n\nt>0\n\nHence, if (tj )j\u22651 is a sequence dense in [0, \u221e), we have\n\u0011\n\u0011\n\u0010\n\u0010\n(\u03ba)\nsup hYtj , \u03c6i i > 0 .\nP\u03b40 (Y (\u03ba) hits (\u0100)c ) = lim \u2191 P\u03b40 sup\nN \u2192\u221e\n\n1\u2264i\u2264N\n\nHowever, Theorem 2 implies that, for every N \u2265 1,\n\u0011\n\u0011\n\u0010\n\u0010\n\u0011\n\u0011\n\u0010\n\u0010\n(\u03ba)\n\u03b5n\n,\n\u03c6\ni\n>\n0\n.\nsup\nhY\nsup\n,\n\u03c6\ni\n>\n0\n\u2265\nP\nsup\nhX\nlim inf P[\u03b5\u22121\nsup\ni\ni\n\u03b4\nt\nt\n0\nj\nj\nn ]\u03b40\nn\u2192\u221e\n\n1\u2264i\u2264N\n\n1\u2264i\u2264N\n\n1\u2264j\u2264N\n\n(38)\n\n1\u2264j\u2264N\n\n(39)\n\n1\u2264j\u2264N\n\nRecall that bn \u2192 1, and note that the support of each function \u03c6i is at a strictly positive distance of\nthe set A. As a consequence, for every fixed N , the support of \u03c6i will be contained in bn \u0100c for every\ni = 1, . . . , N , as soon as n is large enough. Hence, for all large enough n,\n\u0011\no\n\u0010\nn\nsup hXt\u03b5jn , \u03c6i i > 0 \u2282 {X \u03b5n hits bn Ac }.\nsup\n1\u2264i\u2264N\n\n1\u2264j\u2264N\n\nUsing this inclusion and then (39) and (38), we immediately obtain (37).\nWe next turn to the more difficult upper bound\nlim sup P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) \u2264 P\u03b40 (Y (\u03ba) hits Ac ).\nn ]\u03b40\nn\u2192\u221e\n\n(40)\n\nWe fix \u03b4 > 0 small enough so that the closed ball of radius 4\u03b4 centered at 0 is contained in A. As in\nLemma 2, we let A\u03b4 be the connected component of the open set\n{x \u2208 A : dist(x, Ac ) > \u03b4}\nthat contains 0. We denote the exit measure from A\u03b4 for the rescaled branching Brownian motion X \u03b5n\nby E\u03b4n . In other words, the measure E\u03b4n is equal to \u03b5n times the sum of the Dirac point masses at all\npoints of \u2202A\u03b4 which are first exit points from A\u03b4 for one of the historical paths associated with X \u03b5n\n(these historical paths are defined in Subsection 2.3 for the branching Brownian motion Z \u03b5n , and this\ndefinition is extended to X \u03b5n by an obvious scaling transformation).\nLet \u03a6 be a continuous function on Rd such that 0 \u2264 \u03a6 \u2264 1, \u03a6 = 0 on A3\u03b4 and \u03a6 = 1 on Ac2\u03b4 . Then,\nfor every \u03b7 > 0 and \u03c1 > 0,\n(X \u03b5n hits bn Ac , hE\u03b4n , 1i < \u03b7)\n(X \u03b5n hits bn Ac ) = P[\u03b5\u22121\nP[\u03b5\u22121\nn ]\u03b40\nn ]\u03b40\n\u0013\n\u0012\nZ \u221e\n\u03b5n\n\u03b5n\nc\nn\nhXs , \u03a6ids \u2264 \u03c1\nX hits bn A , hE\u03b4 , 1i \u2265 \u03b7,\n+ P[\u03b5\u22121\nn ]\u03b40\n0\n\u0013\n\u0012\nZ \u221e\n\u03b5n\nc\nn\n\u03b5n\nhXs , \u03a6ids > \u03c1 .\nX hits bn A , hE\u03b4 , 1i \u2265 \u03b7,\n+ P[\u03b5\u22121\nn ]\u03b40\n\n(41)\n\n0\n\nLet \u03b1n (\u03b7), \u03b2n (\u03b7, \u03c1) and \u03b3n (\u03b7, \u03c1) be the three terms appearing in the right-hand side of (41) in this\norder.\n20\n\n\fWe first bound \u03b1n (\u03b7). Provided n is sufficiently large, bn Ac is contained in Ac\u03b4/2 and thus\n\u03b1n (\u03b7) \u2264 P[\u03b5\u22121\n(X \u03b5n hits Ac\u03b4/2 , hE\u03b4n , 1i < \u03b7).\nn ]\u03b40\nNote that the times at which the historical paths of X \u03b5n exit A\u03b4 form a stopping line in the sense of\n[Ch91]. We can thus apply the strong Markov property at a stopping line (Proposition 2.1 in [Ch91]) to\nsee that \u03b1n (\u03b4) is bounded above by the probability for a branching Brownian motion (without killing)\nstarting initially with less than \u03b7\u03b5\u22121\nn particles, that one of the historical paths reaches a distance greater\n\u221a\nthan \u03b4/(2 \u03b5n ) from its starting point (to be precise we need a slight extension of the results in [Ch91],\nsince our spatial motion is not standard Brownian motion, but Brownian motion killed inside \u0393\u031f ).\nThe estimate (7) now gives\n4\u03b7\n(42)\n\u03b1n (\u03b7) \u2264 C1\u2032\u2032 (d, \u03bd) 2 .\n\u03b4\nThen, we have\n\u0013\n\u0012\nZ\n\u03b2n (\u03b7, \u03c1) \u2264 P[\u03b5\u22121\nhE\u03b4n , 1i \u2265 \u03b7,\nn ]\u03b40\n\n\u221e\n\n0\n\nhXs\u03b5n , \u03a6ids \u2264 \u03c1 .\n\nRecall that \u03a6 = 1 on Ac2\u03b4 and in particular \u03a6 = 1 on B(x, \u03b4) for every x \u2208 \u2202A\u03b4 . We use the strong\nMarkov property at the same stopping line as in the previous argument, together with a simple coupling\nargument, to write that\n\u0013\n\u0012Z \u221e\n\u03b5n\ne\nhXs , IB(0,\u03b4) ids \u2264 \u03c1 ,\n\u03b2n (\u03b7, \u03c1) \u2264 P[\u03b7\u03b5\u22121\nn ]\u03b40\n0\n\ne \u03b5n is defined in terms of a branching Brownian motion Ze\u03b5n in the same way as X \u03b5n was\nwhere X\ndefined from Z \u03b5n . This branching Brownian motion Ze\u03b5n has the same offspring distribution as Z \u03b5n ,\nbut particles are now killed at rate \u03b5n homogeneously over Rd . Furthermore, Ze\u03b5n also starts from k\u03b40\nunder the probability measure Pk\u03b40 .\ne \u03b5n )t\u22650 under P \u22121 converges as n \u2192 \u221e to the law of Y (1) under\nBy Proposition 2, the law of (X\nt\n\n[\u03b7\u03b5n ]\u03b40\n\n(1)\n\nP\u03b7\u03b40 (in the notation of Subsection 2.4). Noting that, for every fixed s > 0, Ys a.s. does not charge\nthe boundary of the ball B(0, \u03b4), it follows that\n\u0012Z \u221e\n\u0013\n\u0013\n\u0012Z \u221e\n\u03b5n\n(1)\ne\nhXs , IB(0,\u03b4) ids \u2264 \u03c1 \u2264 P\u03b7\u03b40\nlim sup P[\u03b7\u03b5\u22121\nhYs , IB(0,\u03b4) ids \u2264 \u03c1 =: \u03b2\u221e (\u03b7, \u03c1).\nn ]\u03b40\nn\u2192\u221e\n\n0\n\n0\n\nThe continuity of sample paths of Y (1) ensures that \u03b2\u221e (\u03b7, \u03c1) \u2212\u2192 0 as \u03c1 \u2192 0, for every fixed \u03b7 > 0.\nFor the term \u03b3n (\u03b7, \u03c1), we simply use the bound\n\u0013\n\u0012Z \u221e\n\u03b5n\nhXs , \u03a6ids > \u03c1 .\n\u03b3n (\u03b7, \u03c1) \u2264 P[\u03b5\u22121\nn ]\u03b40\n0\n\nThis bound and the weak convergence of Theorem 2 imply that\n\u0010Z \u221e\n\u0011\nlim sup \u03b3n (\u03b7, \u03c1) \u2264 P\u03b40\nhYs(\u03ba) , \u03a6ids \u2265 \u03c1 \u2264 P\u03b40 (Y (\u03ba) hits Ac3\u03b4 ),\nn\u2192\u221e\n\n0\n\nsince \u03a6 = 0 on A3\u03b4 . (To justify the first inequality in the last display, we also use the fact that the\nare stochastically bounded, which follows from a standard result\nextinction times of X \u03b5n under P[\u03b5\u22121\nn ]\u03b40\nin the case without killing.)\nTo complete the argument, fix \u03b8 > 0. By Lemma 2 (ii), we can choose \u03b4 > 0 sufficiently small so\nthat\n\u03b8\nP\u03b40 (Y (\u03ba) hits Ac3\u03b4 ) \u2264 P\u03b40 (Y (\u03ba) hits Ac ) + .\n3\n21\n\n\fFrom (42), we can then choose \u03b7 > 0 sufficiently small so that for all large n,\n\u03b1n (\u03b7) \u2264\n\n\u03b8\n.\n3\n\nFinally we choose \u03c1 > 0 such that \u03b2\u221e (\u03b7, \u03c1) \u2264 \u03b83 . From (41) and the previous estimates, we obtain\nlim sup P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) \u2264 P\u03b40 (Y (\u03ba) hits Ac ) + \u03b8,\nn ]\u03b40\nn\u2192\u221e\n\nand since \u03b8 was arbitrary this completes the proof of (40) and Lemma 7.\n\n\u0003\n\nWe still have to discuss the case a = 0 in (34). So, let us consider two sequences (\u03b5n )n\u22651 and\n(Rn )n\u22651 such that \u03b5n Rn2 \u2192 0. Let a0 > 0 and \u03b5\u2032n = \u03b5n \u2228 (a0 Rn\u22122 ). Since \u03b5n \u2264 \u03b5\u2032n , we have\n\u2032\n\nlim inf Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2265 lim inf Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = u(\u03baa0 ) (0),\nn\u2192\u221e\n\nn\u2192\u221e\n\nby the case a > 0. By Lemma 2 (i), u(\u03baa0 ) (0) can be made arbitrarily close to u(0) (0) when a0 is small,\nand so\nlim inf Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2265 u(0) (0).\nn\u2192\u221e\n\nTo obtain the corresponding upper bound, a similar coupling argument shows that it suffices to consider\nthe case when \u03b5n = 0 for every n, that is when there is no killing inside the obstacles. Hence, consider\nthe branching Brownian motion Z 0 = Z \u031f,0 (the notation is even more legitimate since Z \u031f,0 does not\ndepend on \u031f). For every \u03c1 > 0, define a rescaled version of Z 0 by setting\nZ\n(\u03c1)\nhX t , \u03c6i = \u03c1 Z\u03c10\u22121 t (dx) \u03c6(\u03c11/2 x).\n(\u03c1)\n\nBy Proposition 2, the law of (X t )t\u22650 under P[\u03c1\u22121 ]\u03b40 converges to the law of Y (0) under P\u03b40 as \u03c1 tends\nto 0. Set \u03c1n = Rn\u22122 , in such a way that\n{Z 0 hits Rn Ac } = {X\n\n(\u03c1n )\n\nhits Ac }.\n\n(43)\n\nA simplified version of the arguments of the proof of Lemma 7 shows that\nlim sup P[\u03c1\u22121\n(X\nn ]\u03b40\n\n(\u03c1n )\n\nn\u2192\u221e\n\nhits Ac ) \u2264 P\u03b40 (Y (0) hits Ac ) = 1 \u2212 exp(\u2212u(0) (0)).\n\nArguing as in the first part of the proof of the theorem and using (43) yields\nlim sup Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2264 u(0) (0),\nn\u2192\u221e\n\nwhich completes the proof of Theorem 1.\n\n\u0003\n\nProof of Corollary 1. For every r > 0,\n\u0010\n\u0011 n\u03b5\n\u221a\nPn\u03b5 \u03b40 ( \u03b5 R\u031f,\u03b5 < r) = 1 \u2212 P\u03b40 (Z \u031f,\u03b5 hits B(0, \u03b5\u22121/2 r)c ) .\n\nHowever, Theorem 1 shows that, P(d\u031f) a.s.,\n\nn\u03b5 P\u03b40 (Z \u031f,\u03b5 hits B(0, \u03b5\u22121/2 r)c ) =\nconverges to\n\nb\nr2\n\n\u0011\n\u03b5n\u03b5 \u0010 r 2\n\u031f,\u03b5\n\u22121/2 c\nP\n(Z\nhits\nB(0,\n\u03b5\nr)\n)\n\u00d7\n\u03b4\nr2\n\u03b5 0\n\nu\u25e6\u03bar2 (0) as \u03b5 \u2192 0. The desired result follows.\n22\n\n\u0003\n\n\fReferences\n[Ch91] B. Chauvin. Product martingales and stopping lines for branching Brownian motion. Ann.\nProbab., 19:1195\u20131205, 1991.\n[DLG02] T. Duquesne, J.-F. Le Gall. Random trees, L\u00e9vy processes and spatial branching processes.\nAst\u00e9risque 281. Soc. Math. France, 2002.\n[Dy91] E.B. Dynkin. A probabilistic approach to one class of nonlinear differential equations. Probab.\nTh. Rel. Fields, 89:89\u2013115, 1991.\n[Dy93] E.B. Dynkin. Superprocesses and partial differential equations. Ann. Probab., 21:1185\u20131262,\n1993.\n[Eng07] J. Engl\u00e4nder. Branching diffusions, superdiffusions and random media. Probab. Surveys, 4:303\u2013\n364, 2007.\n[Eng08] J. Engl\u00e4nder. Quenched law of large numbers for branching Brownian motion in a random\nmedium. Ann. Inst. Henri Poincar\u00e9 Probab. Stat., 44:490\u2013518, 2008.\n[EdH03] J. Engl\u00e4nder and F. den Hollander. Survival asymptotics for branching Brownian motion in\na Poissonian trap field. Markov Process. Related Fields, 9:363\u2013389, 2003.\n[Eth00] A.M. Etheridge. An introduction to superprocesses. AMS University Lecture Series, Vol. 20,\n2000.\n[EK86] S.N. Ethier and T.G. Kurtz. Markov processes: characterization and convergence. Wiley, New\nYork, 1986.\n[JS87] J. Jacod and A.N. Shiryaev. Limit theorems for stochastic processes. Springer, Berlin, 1987.\n[LG99] J.-F. Le Gall. Spatial branching processes, random snakes and partial differential equations.\nLectures in Mathematics ETH Z\u00fcrich. Birkh\u00e4user, Boston, 1999.\n[LG05] J.-F. Le Gall. Random trees and applications. Probab. Surveys, 2:245-311, 2005.\n[Per02] E.A. Perkins. Dawson-Watanabe superprocesses and measure-valued diffusions. Ecole d'\u00e9t\u00e9 de\nprobabilit\u00e9s de Saint-Flour 1999. Lecture Notes Math., vol. 1781. Springer, Berlin, 2002.\n[SF79] S. Sawyer and J. Fleischman. Maximum geographic range of a mutant allele considered as a\nsubtype of a Brownian branching random field. Proc. Nat. Acad. Sci. USA, 76:872\u2013875, 1979.\n[Szn98] A.-S. Sznitman. Brownian motion, obstacles and random media. Springer, Berlin, 1998.\n[V\u00e9b09] A. V\u00e9ber. Quenched convergence of a sequence of superprocesses in Rd among Poissonian\nobstacles. Stochastic Process. Appl., 119:2598-2624, 2009.\nJ.F. Le Gall, D\u00e9partement de math\u00e9matiques, Universit\u00e9 Paris-Sud, 91405 ORSAY C\u00e9dex, France\ne-mail: jean-francois.legall@math.u-psud.fr\nA. V\u00e9ber, DMA, Ecole normale sup\u00e9rieure, 45 rue d'Ulm, 75230 PARIS C\u00e9dex 05, France\ne-mail: amandine.veber@ens.fr\n\n23\n\n\fEscape probabilities for branching Brownian motion\namong soft obstacles\n\narXiv:1003.3726v2 [math.PR] 17 Jan 2011\n\nJean-Fran\u00e7ois Le Gall, Amandine V\u00e9ber\nJune 15, 2018\n\nAbstract\nWe derive asymptotics for the quenched probability that a critical branching Brownian motion\nkilled at a small rate \u03b5 in Poissonian obstacles exits a large domain. Results are formulated in terms\nof the solution to a semilinear partial differential equation with singular boundary conditions. The\nproofs depend on a quenched homogenization theorem for branching Brownian motion among soft\nobstacles.\nKeywords and phrases. Branching Brownian motion, Poissonian obstacles, super-Brownian\nmotion, escape probability, homogenization, semilinear partial differential equation.\nMSC2010 Classification Numbers. Primary: 60K37, 60J80. Secondary: 60J68.\n\n1\n\nIntroduction\n\nIn the present work, we are interested in the long-term behaviour of branching Brownian motion killed\nin Poissonian obstacles. Let us start by describing a simple special case of our results. We consider\na critical branching Brownian motion in Rd (d \u2265 1), where all initial particles start from the origin.\nWe assume that particles are killed at a (small) rate \u03b5 > 0 within random balls of fixed radius, whose\ncenters are distributed according to a homogeneous Poisson point process on Rd . Then, how many\ninitial particles do we need so that, with high probability, one of their descendants reaches distance R\nfrom the origin ? Let p\u03b5 (R) be the (quenched) probability for our randomly killed branching Brownian\nmotion starting with a single particle at 0 to visit the complement of a large ball of radius R centered\nat the origin. The preceding question is equivalent to determining the limiting behaviour of p\u03b5 (R)\nwhen \u03b5 tends to 0 and simultaneously R tends to infinity.\nThe answer involves several regimes depending on the respective values of \u03b5 and R. If \u03b5 is small\nin comparison with 1/R2 , the killing phenomenon does not matter and the result is the same as if\nthere were no killing: p\u03b5 (R) behaves like a constant times 1/R2 (informally, the branching process\nmust survive up to a time of order R2 so that at least one of the particles travels a distance R, and\nwell-known estimates for critical branching processes then lead to the correct asymptotics). On the\nother hand, if \u03b5 is large in comparison with 1/R2 , then the probability p\u03b5 (R) decreases exponentially\n\u221a\nfast as a function of R \u03b5: See Proposition 1 below.\nOur main results focus on the critical regime where \u03b5R2 converges to a constant a > 0. We show that\nthe probability p\u03b5 (R) behaves like R\u22122 , as in the case without killing, but with a multiplicative constant\nwhich depends on a and can be identified as the value at the origin of the solution of a semilinear partial\ndifferential equation with singular boundary conditions. A key tool to derive these asymptotics is a\nquenched homogenization theorem which shows that our branching Brownian motions among obstacles,\nsuitably rescaled, are close to super-Brownian motion killed at a certain rate depending on a.\nLet us formulate our assumptions more precisely in order to state our results. First, let us define\nthe collection of obstacles. We denote the set of all compact subsets of Rd by K. This set is equipped\nwith the usual Hausdorff metric dH . Recall that (K, dH ) is a Polish space. For every r > 0, Kr denotes\n1\n\n\fthe subset of K which consists of all compact sets that are contained in the closed ball of radius r\ncentered at the origin. Let \u0398 be a finite measure on K, and assume that \u0398 is supported on Kr0 for\nsome r0 > 0. Let\nX\nN =\n\u03b4(xi ,Ki )\ni\u2208I\n\nbe a Poisson point measure on Rd \u00d7 K with intensity \u03bbd \u2297 \u0398, where \u03bbd stands for Lebesgue measure\non Rd . We assume that this point measure is defined on a probability space (\u03a9, P) and we denote the\ngeneric element of \u03a9 by \u031f. Our set of obstacles is then defined by\n[\n\u0393\u031f = (xi + Ki ),\n(1)\ni\u2208I\n\nwhere obviously xi + Ki = {z = xi + y : y \u2208 Ki }. Note that we use the notation \u0393\u031f to emphasize\nthat the set of obstacles depends on the variable \u031f representing the environment. Let us also define a\nconstant \u03ba by\n\u0011\n\u0010 Z\n\u0398(dK) \u03bbd (K) .\n\u03ba = P(0 \u2208 \u0393\u031f ) = 1 \u2212 exp \u2212\nK\n\nTo avoid trivial cases, we assume that \u03ba > 0, or equivalently \u0398(\u03bbd (K) > 0) > 0. By translation\ninvariance, we also have P(x \u2208 \u0393\u031f ) = \u03ba for every x \u2208 Rd .\nLet us now introduce the sequence of branching Brownian motions of interest. Given \u031f \u2208 \u03a9 and\na parameter \u03b5 \u2265 0, we consider a branching Brownian motion on Rd such that\n\u2022 each particle moves around in Rd according to the law of Brownian motion killed at rate \u03b5 within\n\u0393\u031f ;\n\u2022 each particle branches at rate 1. During a branching event, the particle generates a random\nnumber of offspring, according to an offspring distribution \u03bd which has mean one and finite\nvariance \u03c3 2 \u2208 (0, \u221e).\nThis branching Brownian motion is denoted by Z \u031f,\u03b5 = (Zt\u031f,\u03b5)t\u22650 , where Zt\u031f,\u03b5 stands for the sum of\nthe Dirac point masses at the particles alive at time t. The processes Z \u031f,\u03b5 are defined on a probability\nspace \u03a9. For every finite point measure \u03bc on Rd , we use the notation P\u03bc for the probability measure\non \u03a9 under which each of the processes Z \u031f,\u03b5 starts from \u03bc.\nLet A be a bounded domain of class C 2 in Rd containing 0. We say that the branching Brownian\nmotion Z \u031f,\u03b5 hits Ac if there exists t > 0 such that Zt\u031f,\u03b5 (Ac ) > 0. We are interested in asymptotics for\nthe quantity\nP\u03b40 (Z \u031f,\u03b5 hits RAc )\nwhen R \u2192 \u221e and \u03b5 \u2192 0. Here we use the obvious notation RA = {z = Ry : y \u2208 A}.\nTheorem 1. For every a \u2265 0, let u(a) = (u(a) (x), x \u2208 A) be the unique nonnegative solution of the\nsingular boundary value problem\n\uf8f1\n\u03c32 2\n\uf8f2 1\n\u2206u =\nu + au\nin A,\n(2)\n2\n2\n\uf8f3\nu|\u2202A = +\u221e .\n\nThen,\n\nlim\n\nR\u2192\u221e\n\n\u0010\n\nsup R2 P\u03b40 (Z \u031f,\u03b5 hits RAc ) \u2212 u(\u03ba\u03b5R2 ) (0)\n\u03b5\u22650\n\n2\n\n\u0011\n\n=0,\n\nP(d\u031f) a.s.\n\n\fRemark. The existence and uniqueness of the nonnegative solution of the problem (2) is a special\ncase of Theorem 4.12 in [V\u00e9r96]. Alternatively, a probabilistic proof can be given along the lines of\n[LG99, Chapter VI]\nLet us state a corollary of the theorem, which is motivated by the simple question we asked at\nthe beginning of this introduction. For every a \u2265 0, we denote by u\u25e6(a) the solution of the boundary\nproblem (2) when A is the open unit ball of Rd .\nCorollary 1. For every \u03b5 \u2208 (0, 1), let n\u03b5 be a positive integer. Assume that \u03b5n\u03b5 \u2212\u2192 b as \u03b5 \u2192 0,\nfor some b > 0. Denote by R\u031f,\u03b5 the maximal distance from the origin attained by a particle of the\n\u221a\nbranching Brownian motion Z \u031f,\u03b5 . Then, P-a.s., the law of \u03b5 R\u031f,\u03b5 under Pn\u03b5 \u03b40 converges as \u03b5 \u2192 0\ntowards the probability measure \u03c0b on R+ defined by\n\u001a\n\u001b\nb \u25e6\n\u03c0b ([0, r]) = exp \u2212 2 u(\u03bar2 ) (0)\nr\nfor every r > 0.\nIn the setting of Theorem 1, it is not hard to see that u(a) (0) tends to 0 as a \u2192 \u221e (see Lemma\n2 below) and thus this theorem does not give much information when R \u2192 \u221e and \u03b5 \u2192 0 in such a\nway that \u03b5R2 tends to \u221e. In that case, the next proposition provides an exponential decay, which\ncontrasts with the preceding theorem. Since our bounds are clearly not optimal, we consider only the\ncase when A is a ball. We denote the open ball of radius r centered at the origin by B(0, r). In the\ngeneral case we may apply the bounds (i) and (ii) of the proposition after replacing A by a ball B(0, r)\nsuch that B(0, r) \u2283 A or B(0, r) \u2282 A respectively.\nProposition 1. Recall that \u03bd denotes the offspring distribution of the particles.\n(i) There exists a positive constant C0 = C0 (\u03bd) such that, for every \u031f \u2208 \u03a9, R \u2265 1 and \u03b5 \u2208 [1/R2 , 1],\n\u221a\nP\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) \u2265 C0 \u03b5 exp(\u2212R 2\u03b5).\n(ii) There exists a positive constant C1 = C1 (d, \u03bd, \u0398) such that for every R \u2265 1 and \u03b5 \u2208 [0, 1],\n\u221a\nP \u2297 P\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) \u2264 exp(\u2212C1 R \u03b5).\nMoreover, we can find two positive constants C2 = C2 (d, \u03bd, \u0398) and C3 = C3 (d, \u03bd, \u0398) such that P-a.s.,\nfor every sufficiently large R and every \u03b5 \u2208 [C2 (log log R)2 /R2 , 1],\n\u221a\nP\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) \u2264 exp(\u2212C3 R \u03b5).\nPart (i) of the proposition is derived from an estimate about branching Brownian motion killed\nhomogeneously at rate \u03b5, which explains why this bound holds for every \u031f \u2208 \u03a9 and does not depend\non the measure \u0398. The bounds in (ii) follow from an estimate for Brownian motion killed in soft\nobstacles. The first assertion in (ii) may be compared to Proposition 5.2.8 in [Szn98].\nProposition 1 only gives rather crude estimates, and it would be of interest to obtain more precise\ninformation on the decay of the quenched probabilities P\u03b40 (Z \u031f,\u03b5 hits RAc ) in the case when \u03b5R2 tends\nto \u221e. Because our branching mechanism is critical, the following upper bound holds for any \u031f \u2208 \u03a9,\n\u03b5 \u2265 0 and R > 0 :\n\u0001\n\u0002\n\u0003\n\u0001\nP\u03b40 Z \u031f,\u03b5 hits B(0, R)c \u2264 E\u03b40 # particles of Z \u031f,\u03b5 that hit B(0, R)c = P0 \u03be \u031f,\u03b5 hits B(0, R)c , (3)\nwhere \u03be \u031f,\u03b5 denotes d-dimensional Brownian motion killed at rate \u03b5 within \u0393\u031f and starting from 0\nunder P0 . Known results about the survival of Brownian motion among soft obstacles (see in particular\nSznitman's book [Szn98]) can be used to estimate the right-hand side of (3). On the other hand, one\nmay expect that the inequality in (3) is \"not too crude\", but we do not pursue this matter here.\n3\n\n\fA major ingredient of the proof of Theorem 1 is the following quenched homogenization result. We\nneed to introduce a rescaled version of the process Z \u031f,\u03b5. For every \u03b5 > 0 and every t \u2265 0, let us define\na random measure Xt\u031f,\u03b5 on Rd by setting, for every Borel subset A of Rd ,\nZ\nXt\u031f,\u03b5 (A) = \u03b5 Z\u03b5\u031f,\u03b5\n(4)\n\u22121 t (dx)1\u03b5\u22121/2 A (x).\nFor every real x \u2265 0, [x] denotes the integer part of x.\n\nTheorem 2. Except for a P-negligible set of values of \u031f, the law of (Xt\u031f,\u03b5 )t\u22650 under P[\u03b5\u22121]\u03b40 converges\nweakly as \u03b5 \u2192 0, in the Skorokhod sense, to that of a super-Brownian motion with branching mechanism\n2\n\u03c8(\u03ba) (u) := \u03c32 u2 + \u03bau started at \u03b40 .\nThe definition of super-Brownian motion with branching mechanism \u03c8(\u03ba) is recalled in Section 2\nbelow.\nAs a hint of why Theorem 2 should be true, notice that for a given realization of the obstacles, the\nprobability that a single Brownian motion starting from 0 and killed at rate \u03b5 within \u0393\u031f is still alive\nby time t > 0 is given by\nZ t\noi\nh\nn\n1\u0393\u031f (\u03bes )ds ,\n(5)\nE exp \u2212 \u03b5\n0\n\nwhere \u03be denotes standard d-dimensional Brownian motion. Let us focus on the integral within the\nexponential in (5). Averaging over the law of the obstacles and using Fubini's theorem, we obtain for\neach t \u2265 0\nii\nhZ t\ni\nh h Z t\n1\u0393\u031f (\u03bes )ds = \u03b5 E\nP[\u03bes \u2208 \u0393\u031f ]ds = \u03b5\u03bat.\nE E \u03b5\n0\n\n0\n\n\u221a\nWe can thus guess, and easily prove, that the rescaled Brownian motion ( \u03b5 \u03be\u03b5\u22121 t , t \u2265 0), which\n\u221a\nis killed at rate 1 within \u03b5 \u0393\u031f , converges to Brownian motion killed at homogeneous rate \u03ba as\n\u03b5 \u2192 0. Theorem 2 shows that an analogous convergence indeed holds in our more general framework\nof branching Brownian motions, for any fixed \u031f contained in a set of P-probability one.\nLet us briefly explain how Theorem 1 is derived from Theorem 2. Consider a sequence (\u03b5n , Rn ) such\nthat Rn \u2192 \u221e and \u03b5n Rn2 converges to a positive constant a. By a simple scaling transformation, the\n1/2\nprobability P\u03b40 (Z \u031f,\u03b5n hits Rn Ac ) coincides with P\u03b40 (X \u031f,\u03b5n hits bn Ac ), where bn = \u03b5n Rn converges\n\u221a\nto a. We can then use Theorem 2 to investigate the asymptotic behaviour of the latter hitting probabilities. This limiting behaviour involves the corresponding hitting probabilities for super-Brownian\nmotion, which are known to be related to solutions of semilinear partial differential equations from\nthe work of Dynkin [Dy91, Dy93]. One difficulty in implementing the preceding idea comes from the\nfact that the convergence in Theorem 2 is not strong enough to ensure that hitting probabilities for\nthe processes (Xt\u031f,\u03b5 )t\u22650 converge to hitting probabilities for the limiting process. Much of the proof\nof Theorem 1 in Section 4 is devoted to a precise justification of this property (Lemma 7).\nTo complete this introduction, let us mention that branching Brownian motion and superprocesses\namong random obstacles have been studied recently in several papers, including Engl\u00e4nder and den\nHollander [EdH03] and Engl\u00e4nder [Eng08]. These papers concentrate on the case of supercritical\nbranching, in contrast with critical branching which is considered here. See also the survey [Eng07]. A\nhomogenization theorem related to Theorem 2 has been proved in [V\u00e9b09] for super-Brownian motion\namong hard obstacles, in the case when the intensity of the obstacles grows to infinity but their\ndiameters shrink to 0. There is a huge literature about Brownian motion and random walks among\n(hard or soft) obstacles, and the reader may look at the book of Sznitman [Szn98] for additional\nreferences.\nThe rest of this paper is laid out as follows. In Section 2, we introduce the basic notation and\nobjects, and state several results about hitting probabilities for spatial branching processes we shall\nneed in the sequel. Theorem 2 and Proposition 1 are proved in Section 3. Theorem 1 and Corollary 1\nare then derived in Section 4.\n4\n\n\f2\n2.1\n\nPreliminaries\nNotation\n\nWe denote the set of all finite measures on Rd by Mf (Rd ). This set is equipped with the weak topology.\nWe write Mp (Rd ) for the subset of Mf (Rd ) which consists of all finite point measures on Rd . The\nintegral of a function \u03c6 against the measure \u03bc is denoted by h\u03bc, \u03c6i.\nIf E is a metric space, we denote the set of all bounded continuous functions on the space E by\nC\u0304(E) and we let kf k stand for the supremum norm of f \u2208 C\u0304(E). We write C 2 (Rd ) for the set of\nall twice continuously differentiable functions on Rd , and C\u0304 2 (Rd ) for that of all bounded functions in\nC 2 (Rd ) whose first and second derivatives are also bounded. An index + added to this notation means\nthat we require the functions to be nonnegative. We equip C\u0304 2 (Rd ) with the topology induced by the\nseminorms kf k(R) , where for every R > 0\nkf k(R)\n\n\u001b\n\u001a\nd\nd\nX\nX\n\u22022f\n\u2202f\n(x) +\n(x) .\n:= sup |f (x)| +\n\u2202xi\n\u2202xi \u2202xj\n|x|\u2264R\ni,j=1\n\ni=1\n\nIf E is a Polish space, we let DE [0, \u221e) be the set of all c\u00e0dl\u00e0g paths with values in E, equipped\nwith the Skorokhod topology. We also let CE [0, \u221e) stand for the set of all E-valued continuous paths,\nwhich is equipped with the topology of uniform convergence on every compact set.\nIf x \u2208 Rd and r > 0, B(x, r) denotes the open ball of radius r centered at x, and B\u0304(x, r) stands\nfor the corresponding closed ball. More generally, the closure of a subset F of Rd is denoted by F\u0304 .\nLebesgue measure on Rd is denoted by \u03bbd .\nFinally, the notation \u03be = (\u03bet )t\u22650 will stand for a standard Brownian motion in Rd , which starts\nfrom x under the probability measure Px . It will also be convenient to use the notation \u03be \u031f,\u03b5 for\nBrownian motion in Rd killed at rate \u03b5 in the set \u0393\u031f . As usual, the value of \u03be \u031f,\u03b5 after its killing time\nis a cemetery point \u2206 added to Rd , and we agree that all functions vanish at \u2206.\n\n2.2\n\nSuper-Brownian motion\n\nLet a \u2265 0 and set \u03c8(a) (u) = (\u03c3 2 /2)u2 + a u, for every u \u2265 0 (the offspring distribution \u03bd, and thus the\nparameter \u03c3 > 0 are fixed throughout this work). Super-Brownian motion with branching mechanism\n\u03c8(a) is the continuous strong Markov process with values in Mf (Rd ), whose transition kernels (Qt )t\u22650\nare characterized as follows: For every g \u2208 C\u0304+ (Rd ) and every \u03bc \u2208 Mf (Rd ), we have for every t \u2265 0\nZ\nQt (\u03bc, d\u03bc\u2032 ) exp(\u2212h\u03bc\u2032 , gi) = exp(\u2212h\u03bc, Vt gi),\n(6)\nwhere the function ut (x) = Vt g(x), t \u2265 0, x \u2208 Rd , is the unique nonnegative solution of the semilinear\nparabolic problem\n\uf8f1\n\uf8f2 \u2202u = 1 \u2206u \u2212 \u03c8 (u) in (0, \u221e) \u00d7 Rd ,\n(a)\n2\n\u2202t\n\uf8f3\nu0 = g .\n\nLet Y = (Yt )t\u22650 be a super-Brownian motion with branching mechanism \u03c8(a) , started at \u03bc \u2208\n2 (Rd )\nMf (Rd ). Then, for every g \u2208 C\u0304+\nZ tD\nE\n1\nYs , \u2212 \u2206g + \u03c8(a) (g) e\u2212hYs ,gi ds\ne\u2212hYt ,gi \u2212 e\u2212hY0 ,gi \u2212\n(7)\n2\n0\n\nis a martingale. It is well known that this martingale problem and the initial value \u03bc characterize the\nlaw of Y . This is indeed an application of the classical \"duality method\" (see in particular Chapter\n4 in [EK86]). The nonlinear semigroup g \u2192 Vt g provides a deterministic dual to super-Brownian\n5\n\n\fmotion, and the duality argument then shows that if a measure-valued process started from \u03bc satisfies\nthe preceding martingale problem, the Laplace functional of its value at time t must be given by the\nright-hand side of (6). See Section 1.6 of [Eth00] for more details.\n\n2.3\n\nBranching Brownian motion among random obstacles\n\nIn view of our applications (and in particular because we want to refer to some results of [Ch91]),\nit will be convenient to give a more formal description of the branching Brownian motions that were\nalready introduced in Section 1 above. Recall that our offspring distribution \u03bd is assumed to be critical\nand that var(\u03bd) = \u03c3 2 \u2208 (0, \u221e). The probability generating function of \u03bd will be denoted by \u03a5.\nLet T be a Galton-Watson tree with offspring distribution \u03bd (see e.g. [LG05]). As usual, we view\nT as a random finite subset of\n\u221e\n[\nNn ,\nU :=\nn=0\n\nN0\n\nwhere N = {1, 2, 3, . . .}, and\n= {\u2205}. If v = (v1 , . . . , vn ) \u2208 U \\{\u2205}, the parent of v is denoted by\nv\u0302 = (v1 , . . . , vn\u22121 ) and we also use the notation v \u227a v \u2032 to mean that v \u2032 is a descendant of v distinct\nfrom v. Consider a collection (ev , v \u2208 U ) of independent exponential random variables with parameter\n1, which is also independent of T . We define for every v \u2208 U its birth time \u03b1v and its death time \u03b2v\nrecursively by setting \u03b1\u2205 = 0 and \u03b2\u2205 = e\u2205 , and for every v \u2208 U \\{\u2205},\n\u03b1v = \u03b2v\u0302 , \u03b2v = \u03b1v + ev .\nLet us now construct the spatial motions. Fix a starting point x \u2208 Rd , and consider a collection\n(B v , v \u2208 U ) of independent standard Brownian motions in Rd (started from 0), independent of T and\nof (ev , v \u2208 U ). For every v \u2208 U , define the historical path \u03c9 v = (\u03c9tv , 0 \u2264 t \u2264 \u03b2v ) associated with v\nin the following way. First \u03c9t\u2205 = x + Bt\u2205 for 0 \u2264 t \u2264 \u03b2\u2205 . Then, if v \u2208 U \\{\u2205}, set \u03c9tv = \u03c9tv\u0302 for all\n0 \u2264 t \u2264 \u03b1v and\nv\n\u03c9tv = \u03c9\u03b1v\u0302 v + Bt\u2212\u03b1\nfor \u03b1v \u2264 t \u2264 \u03b2v .\nv\n\nA branching Brownian motion (without killing in obstacles) starting from \u03b4x is obtained by setting for\nevery t \u2265 0,\nX\nZt =\n\u03b4\u03c9tv ,\nv\u2208T ,v\u223ct\n\nwhere the notation v \u223c t means that \u03b1v \u2264 t < \u03b2v .\nIn this formalism, it is now easy to introduce killing in obstacles. Consider yet another independent\ncollection (\u03b3v )v\u2208U of independent exponential random variables with parameter 1, and define for every\n\u031f \u2208 \u03a9, \u03b5 \u2265 0, and for every v \u2208 U\n\u001b\n\u001a\nZ s\nv\n\u22121\n\u031f,\u03b5\ndr 1\u0393\u031f (\u03c9r ) > \u03b5 \u03b3v ,\n\u03b6v := inf s \u2208 [\u03b1v , \u03b2v ) :\n\u03b1v\n\nwhere inf \u2205 = \u221e. By setting\nZt\u031f,\u03b5 =\n\nX\n\nv\u2208T ,v\u223ct\n\n1{t<\u03b6v\u031f,\u03b5 and \u03b6 \u031f,\u03b5\n\u03b4\u03c9tv ,\n\u2032\n\u2032 =\u221e, for every v \u227av}\nv\n\nwe obtain a branching Brownian motion killed at rate \u03b5 in the obstacle set \u0393\u031f , starting from \u03b4x .\nAn obvious extension of the preceding construction allows us to obtain branching Brownian motions\nstarting from any point measure \u03bc \u2208 Mp (Rd ).\nWe now recall a special case of the classical convergence of rescaled branching Brownian motions\ntowards super-Brownian motion. For our applications, we state the case where particles are killed at a\nconstant rate homogeneously over Rd (this case is obtained from the preceding construction of Z \u031f,\u03b5 by\n6\n\n\f(\u03b5)\n\nreplacing \u0393\u031f by Rd ). In the next two statements, for every \u03b5 > 0, Z (\u03b5) = (Zt )t\u22650 denotes a branching\nBrownian motion with offspring distribution \u03bd, where particles are killed homogeneously over Rd at\nrate \u03b5. As previously Z (\u03b5) starts from \u03bc under the probability measure P\u03bc , for every \u03bc \u2208 Mp (Rd ).\n(\u03b5)\n\nProposition 2. Let a \u2265 0. For every \u03b5 > 0, define a measure-valued process (Xt )t\u22650 by setting\nZ\n(a\u03b5)\n(\u03b5)\nhXt , \u03c6i = \u03b5 Z\u03b5\u22121 t (dx) \u03c6(\u03b51/2 x),\nfor every \u03c6 \u2208 C\u0304(Rd ). For every fixed \u03b7 > 0, the law of X (\u03b5) under P[\u03b7\u03b5\u22121 ]\u03b40 converges as \u03b5 \u2192 0, in the\nSkorokhod sense, towards the law of super-Brownian motion with branching mechanism \u03c8(a) starting\nfrom \u03b7\u03b40 .\nA proof of Proposition 2 can be found in Chapter 1 of [Eth00] in the case a = 0, and arguments\nare easily adapted to cover the general case.\nFinally, we shall use an estimate for the probability that a branching Brownian motion starting from\n\u03b40 exits a large ball centered at the origin. Similar estimates can be found in Sawyer and Fleischman\n[SF79], but we provide a short proof for the sake of completeness.\nLemma 1. Suppose that d = 1. There exist two positive constants C0\u2032 = C0\u2032 (\u03bd) and C1\u2032 = C1\u2032 (\u03bd) such\nthat, for every \u03b5 \u2208 [0, 1] and r \u2265 1,\n\u0010\n\u0011\n\u0011\n\u0010\n\u221a\n\u221a\nC0\u2032 r \u22122 1{r\u2264 \u221a1 } + \u03b5e\u2212r 2\u03b5 1{r> \u221a1 } \u2264 P\u03b40 (Z (\u03b5) hits (\u2212r, r)c ) \u2264 C1\u2032 r \u22122 1{r\u2264 \u221a1 } + \u03b5e\u2212r 2\u03b5 1{r> \u221a1 } .\n\u03b5\n\n\u03b5\n\n\u03b5\n\n\u03b5\n\nRemark. In dimension d, we can apply the bounds of Lemma 1 to the projection of Z (\u03b5) on each\ncoordinate. In particular, taking \u03b5 = 0, we deduce from the upper bound of the lemma that we have\nfor every r > 0,\nP\u03b40 (Z (0) hits B(0, r)c ) \u2264 C1\u2032\u2032 (r + 1)\u22122\n(8)\nwith a constant C1\u2032\u2032 = C1\u2032\u2032 (d, \u03bd).\n\nProof. It clearly suffices to prove that the stated bounds hold for the quantity P\u03b4r (Z (\u03b5) hits (\u2212\u221e, 0])\ninstead of P\u03b40 (Z (\u03b5) hits (\u2212r, r)c ). We fix \u03b5 \u2265 0, and for every x > 0 and t \u2265 0, we set\n\u0010\n\u0011\nq\u03b5 (x, t) = P\u03b4x Z (\u03b5) does not hit (\u2212\u221e, 0] before time t .\n\nand\n\n\u0010\n\u0011\np\u03b5 (x) = P\u03b4x Z (\u03b5) hits (\u2212\u221e, 0] = lim \u2191 (1 \u2212 q\u03b5 (x, t)).\nt\u2191\u221e\n\nP\u03b5x\n\nIn this proof only, we write\nfor the probability under which \u03be is a Brownian motion starting from\nx and killed at rate \u03b5 (upon killing, \u03be is sent to the cemetery point \u2206 and we recall that all functions\nvanish at \u2206). Write S := inf{t \u2265 0 : \u03bet \u2208 (\u2212\u221e, 0]}. By standard arguments (see e.g. the proof of\nProposition II.3 in [LG99]), the function q\u03b5 solves the integral equation\nq\u03b5 (x, t) =\n\nP\u03b5x (S\n\n> t)\n\n+ E\u03b5x\n\nhZ\n\nt\u2227S\n0\n\ni\n(\u03a5(q\u03b5 (\u03bes , t \u2212 s)) \u2212 q\u03b5 (\u03bes , t \u2212 s)) ds ,\n\nwhere we recall that \u03a5 denotes the generating function of the offspring distribution \u03bd. For every\na \u2208 [0, 1], set \u03a6(a) = \u03a5(1 \u2212 a) \u2212 (1 \u2212 a). Note that \u03a6(0) = 0 and the function \u03a6 is monotone increasing\nunder our assumptions. Furthermore, \u03a6(a) = (\u03c3 2 /2)a2 + o(a2 ) when a \u2192 0. By a monotone passage\nto the limit we get that, for every x > 0,\nhZ S\ni\n\u03b5\n\u03a6(p\u03b5 (\u03bes )) ds = P\u03b5x (S < \u221e).\n(9)\np\u03b5 (x) + Ex\n0\n\n7\n\n\fFrom standard connections between Brownian motion and partial differential equations (see e.g. Chapter 8 of Durrett [Dur84]), it follows that the function p\u03b5 satisfies the differential equation\n1 \u2032\u2032\np = \u03b5 p\u03b5 + \u03a6(p\u03b5 )\n2 \u03b5\non (0, \u221e) with boundary conditions p\u03b5 (0) = 1, p\u03b5 (\u221e) = 0. By solving this differential equation, we\nget, for every x > 0,\nZ 1\ndu\np\n=x\n2\n2\u03b5u + 4\u0393(u)\np\u03b5 (x)\nRu\nwhere \u0393(u) = 0 \u03a6(v) dv. Note that there exist positive constants c, c\u2032 such that cu3 \u2264 \u0393(u) \u2264 c\u2032 u3\nfor every u \u2208 [0, 1]. The desired bounds then follow from easy analytic arguments.\n\u0003\n\n2.4\n\nHitting probabilities for super-Brownian motion\n(a)\n\nLet Y (a) = (Yt )t\u22650 be a super-Brownian motion with branching mechanism \u03c8(a) for some a \u2265 0.\nSuppose that Y (a) starts from \u03bc under the probability measure P\u03bc , for every \u03bc \u2208 Mf (Rd ).\nFollowing [Per02, p.200], we define the range of Y (a) by\n!\n\u221e\n[ [\n(a)\nR(Y (a) ) =\nsupp(Yt ) ,\n\u03b5>0\n\nt=\u03b5\n\nwhere for every \u03bc \u2208 Mf (Rd ), supp(\u03bc) denotes the topological support of \u03bc.\nLet D be a domain in Rd and let x \u2208 D. Consider the process Y (a) started from \u03b4x . We say\nthat Y (a) hits D c if the range R(Y (a) ) intersects D c . By a famous result of Dynkin [Dy91, Dy93] the\nfunction\n\u0011\n\u0010\n(a)\nc\nuD\n(R(Y\n)\n\u2229\nD\n=\n6\n\u2205)\n, x \u2208 D,\n(x)\n=\n\u2212\nlog\n1\n\u2212\nP\n\u03b4x\n(a)\n\nis the maximal nonnegative solution of the semilinear partial differential equation 12 \u2206u = \u03c8(a) (u) in\nD.\nUnder mild regularity assumptions on D (which hold e.g. when D satisfies an exterior cone condition\nat every point of \u2202D), the function uD\n(a) has boundary value +\u221e at every point of \u2202D and is the unique\nnonnegative solution of the equation 21 \u2206u = \u03c8(a) (u) in D with boundary value +\u221e everywhere on\n\u2202D. A discussion of this result and related ones can be found in Chapter VI of the book [LG99]. This\nreference considers only the case a = 0, but the same results can be obtained for any a \u2265 0 by similar\narguments: Note that the Brownian snake approach can be extended from the case a = 0 considered in\n[LG99] to a \u2265 0, simply by replacing the reflecting Brownian motion driving the snake by a reflecting\nBrownian motion with negative drift (see Chapter 4 of [DLG02] for a discussion of the snake approach\nto superprocesses with a general branching mechanism).\nWe shall be interested in the special case D = A. Recall that 0 \u2208 A and that we assume A is a\ndomain of class C 2 , meaning that the boundary of A can be represented locally as the graph of a twice\ncontinuously differentiable function, in a suitable system of coordinates. We write u(a) (x) = uA\n(a) (x) to\nsimplify notation. From the analytic viewpoint, the function u(a) may be constructed as follows. For\nevery integer n \u2265 1, let u(a),n be the unique nonnegative solution of the nonlinear Dirichlet problem\n\u001a\n\n1\n2 \u2206u\n\nu|\u2202A\n\n= \u03c8(a) (u) in A ,\n= n.\n\nThen u(a) = lim \u2191 u(a),n as n \u2192 \u221e.\nThe following lemma records certain analytic properties which will be useful in the forthcoming\nproofs.\n8\n\n\fLemma 2. (i) Let x \u2208 A. The function a \u2212\u2192 u(a) (x) is continuous and nonincreasing on [0, \u221e), and\ntends to 0 as a \u2192 \u221e.\n(ii) For every \u03b4 \u2208 (0, dist(0, Ac )), let A\u03b4 be the subdomain of A defined as the connected component of\n\u03b4\nthe open set {x \u2208 A : dist(x, Ac ) > \u03b4} that contains 0. Then, for every a \u2265 0, uA\n(a) (0) tends to u(a) (0)\nas \u03b4 \u2192 0.\nProof. (i) Let us first verify that the function a \u2212\u2192 u(a) (x) is monotone nonincreasing, for every\nx \u2208 A. To see this, we apply a standard comparison principle (see e.g. Lemma V.7 in [LG99]) to\nobtain that u(a\u2032 ),n \u2264 u(a),n if a \u2264 a\u2032 , for every n \u2265 1. It then suffices to let n \u2192 \u221e.\nLet (ak )k\u22651 be a sequence of nonnegative reals increasing to a \u2208 (0, \u221e). We can set for every x \u2208 A\nv(x) = lim \u2193 u(ak ) (x),\nk\u2191\u221e\n\nand we have v \u2265 u(a) . In order to verify that v \u2264 u(a) , we only need to check that v solves 12 \u2206v = \u03c8(a) (v)\nin A (recall that u(a) is the maximal nonnegative solution of this equation). To do so, let B be an\nopen ball whose closure B\u0304 is contained in A. For every k \u2265 1, the restriction of u(ak ) to B solves the\nequation 12 \u2206u = \u03c8(ak ) (u) in B. By the probabilistic interpretation of the integral equation associated\nwith this PDE (see e.g. Chapter V in [LG99]), this implies that, for every x \u2208 B,\n\u0015\n\u0014 Z \u03c4B\n\u0002\n\u0003\nu(ak ) (x) + Ex\n\u03c8(ak ) (u(ak ) (\u03bes )) ds = Ex u(ak ) (\u03be\u03c4B ) ,\n0\n\nwhere we recall our notation \u03be for a Brownian motion starting from x under the probability measure\nPx , and \u03c4B := inf{t \u2265 0 : \u03bet \u2208\n/ B}. By passing to the limit k \u2192 \u221e in the previous display, we can\nwrite\n\u0015\n\u0014 Z \u03c4B\n\u0002\n\u0003\nv(x) + Ex\n\u03c8(a) (v(\u03bes )) ds = Ex v(\u03be\u03c4B ) ,\n0\n\nwhich is enough to obtain that v solves 12 \u2206v\nSimilar arguments show that, if (ak )k\u22651\n\n= \u03c8(a) (v) in B, and therefore in A since B was arbitrary.\nis a decreasing sequence of nonnegative reals converging\nto a \u2208 [0, \u221e), then u(ak ) (x) converges to u(a) (x) for every x \u2208 A. Finally, the fact that u(a) (x) tends\nto 0 as a \u2192 \u221e can be obtained from the comparison principle: If B is a ball such that B\u0304 \u2282 A, the\nrestriction of u(a) to B is bounded above by the solution v(a) of the linear equation 21 \u2206v(a) = a v(a)\nin B, with boundary value equal to the restriction of u(0) to B. It is easily seen that v(a) (x) \u2212\u2192 0 as\na \u2192 \u221e, for instance by using the Feynman-Kac formula.\n\u03b4\nto A\u03b4\u2032 is\n(ii) Fix a \u2265 0. If 0 < \u03b4 < \u03b4\u2032 , the closure of A\u03b4\u2032 is contained in A\u03b4 . The restriction of uA\n(a)\nA\n\na nonnegative solution of 12 \u2206u = \u03c8(a) (u) in A\u03b4\u2032 and is thus bounded above by u(a)\u03b4\u2032 . Hence, for every\n\u03b4\nfixed x \u2208 A the function \u03b4 \u2192 uA\n(a) (x), which is defined for \u03b4 > 0 small enough, is nondecreasing and\nwe can set\n\u03b4\nv(x) = lim uA\n(a) (x).\n\n\u03b4\u21930\n\n\u03b4\nBy the same argument we used to obtain the monotonicity of the mapping \u03b4 \u2192 uA\n(a) (x), we also have\nv(x) \u2265 u(a) (x) for every x \u2208 A. To obtain the reverse inequality v \u2264 u(a) , it is enough to verify that\nv solves 12 \u2206v = \u03c8(a) (v) in B. But this follows by arguments similar to those we used in the proof of\npart (i) of the lemma.\n\u0003\n\nLemma 3. For every a \u2265 0 and x \u2208 A,\n{R(Y (a) ) \u2229 Ac 6= \u2205} = {R(Y (a) ) \u2229 (\u0100)c 6= \u2205} ,\n\n9\n\nP\u03b4x a.s.\n\n\fProof. The inclusion\n{R(Y (a) ) \u2229 Ac 6= \u2205} \u2283 {R(Y (a) ) \u2229 (\u0100)c 6= \u2205}\nis trivial. To show the reverse inclusion, we may argue as follows. By Theorem IV.9 in [LG99]\n(which holds under much less stringent assumptions on A), the event {R(Y (a) ) \u2229 Ac 6= \u2205} holds if and\nonly if the exit measure of the super-Brownian motion Y (a) from A is nonzero. Applying the special\nMarkov property of superprocesses [Dy93, Theorem 1.3], we see that it is enough to prove that for\nsuper-Brownian motion starting from a nonzero initial measure supported on \u2202A, the support process\nimmediately hits (\u0100)c . Under our regularity assumptions on A, this easily follows from Wiener's test\nfor super-Brownian motion (Theorem VI.6 in [LG99]).\n\u0003\nFrom now on, we write {Y (a) hits F } for the event {R(Y (a) ) \u2229 F 6= \u2205}.\n\n3\n\nQuenched convergence to super-Brownian motion\n\nThe main goal of this section is to prove Theorem 2. At the end of the section, we also establish\nProposition 1, using certain arguments related to the proof of Theorem 2. To simplify notation, we\nset for every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1),\n[ \u221a\n\u221a\n\u0393\u03b5\u031f = \u03b5 \u0393\u031f =\n\u03b5(xi + Ki ).\ni\u2208I\n\nThe following lemma identifies a martingale problem solved by our branching Brownian motion\nIt can be proved by standard arguments: Since killing in the obstacles can be viewed as a\nlocation-dependent branching phenomenon, our martingale problem is indeed the same as in (4.10) of\n[EK86, Section 9.4] (see also Section 1.2 in [Eth00]).\nZ \u031f,\u03b5.\n\nLemma 4. Let \u031f \u2208 \u03a9 and \u03b5 \u2265 0. Under each probability P\u03bc , \u03bc \u2208 Mp (Rd ), the process Z \u031f,\u03b5 solves\n2 (Rd ) such that 0 < inf f \u2264 f \u2264 1, the process\nthe following martingale problem: For every f \u2208 C\u0304+\nhZt\u031f,\u03b5 ,log f i\n\ne\n\nhZ0\u031f,\u03b5 ,log f i\n\n\u2212e\n\n\u001d\nZ t\u001c\n1\n\u031f,\u03b5\n\u031f,\u03b5 2 \u2206f + \u03b51\u0393\u031f (1 \u2212 f ) + \u03a5(f ) \u2212 f\nehZs ,log f i ds\n\u2212\nZs ,\nf\n0\n\nis a martingale.\nWe can derive from Lemma 4 (or from a direct argument) that for every g \u2208 C\u0304 2 (Rd ),\nMt (g) :=\n\nhZt\u031f,\u03b5 , gi\n\n\u2212\n\nhZ0\u031f,\u03b5, gi\n\nZ tD\nE\n1\nZs\u031f,\u03b5 , \u2206g \u2212 \u03b51\u0393\u031f g ds\n\u2212\n2\n0\n\nis a martingale. An easy computation gives that the square bracket of this martingale is\nZ t\nX\n\u031f,\u03b5\n, gi2 .\nhZs\u031f,\u03b5, \u2207g.\u2207gi ds +\nhZs\u031f,\u03b5 \u2212 Zs\u2212\n[M (g), M (g)]t =\n0\n\n(10)\n\n(11)\n\n0\u2264s\u2264t\n\nThe last sum in the right-hand side is an increasing process with compensator\nZ t\nhZs\u031f,\u03b5, (\u03c3 2 + \u03b51\u0393\u031f )g2 i ds.\n\n(12)\n\n0\n\nThe proof of Theorem 2 relies on the following two results, in which we use the notation (Yt )t\u22650 for\nthe canonical process on DMf (Rd ) [0, \u221e). Recall from (4) the definition of the process X \u031f,\u03b5 in terms\nof Z \u031f,\u03b5.\n10\n\n\fLemma 5. For every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1), let \u03a0\u031f,\u03b5 be the law of the process X \u031f,\u03b5 under P[\u03b5\u22121]\u03b40 .\nThen,\n(i) For every \u03b4 > 0 and T > 0, there is a compact subset K\u03b4,T of Rd such that, for every \u031f \u2208 \u03a9,\n\u0011\n\u0010\nc\n) <\u03b4\nsup \u03a0\u031f,\u03b5 sup Yt (K\u03b4,T\n0\u2264t\u2264T\n\n\u03b5\u2208(0,1)\n\n(ii) For every g \u2208 C\u0304 2 (Rd ) and \u031f \u2208 \u03a9, the collection of the laws of the process (hYt , gi)t\u22650 under \u03a0\u031f,\u03b5 ,\n\u03b5 \u2208 (0, 1), is relatively compact in the space of all probability measures on DR [0, \u221e).\nConsequently, for every \u031f \u2208 \u03a9, the collection (\u03a0\u031f,\u03b5 )\u03b5\u2208(0,1) is relatively compact in the space of all\nprobability measures on DMf (Rd ) [0, \u221e).\nThe last assertion of the lemma is an immediate consequence of (i) and (ii) using Theorem II.4.1\nin [Per02].\n2 (Rd ). There exists a measurable subset \u03a9 of \u03a9 such that P(\u03a9 ) = 1 and\nProposition 3. Let g \u2208 C\u0304+\ng\ng\nthe following holds for every \u031f \u2208 \u03a9g . For every\ns,\nt\n\u2265\n0,\nfor\nevery\ninteger\np\n\u2208\nN\nand\nevery\nchoice of\n\u0001\nt1 , . . . , tp \u2208 [0, t] and f1 , . . . , fp \u2208 C\u0304 Mf (Rd ) , we have\n\nlim E[\u03b5\u22121 ]\u03b40\n\n\u03b5\u21920\n\n\u0014\u001a\n\n\u031f,\u03b5\n\u2212hXt+s\n,gi\n\ne\n\n\u2212hXt\u031f,\u03b5 ,gi\n\n\u2212e\n\n\u2212\n\nZ\n\nt\n\nt+s D\n\nE\n\n1\nXu\u031f,\u03b5 , \u2212 \u2206g + \u03c8(\u03ba) (g)\n2\n\n\u2212hXu\u031f,\u03b5 ,gi\n\ne\n\ndu\n\n\u001bY\np\n\n\u0015\n\nfi (Xt\u031f,\u03b5\n)\ni\n\ni=1\n\n= 0.\n\nWe postpone the proof of Lemma 5 and Proposition 3, and explain how Theorem 2 follows from\n2 (Rd ) and set\nthese two statements. We choose a countable dense subset G of C\u0304+\n\u03a9\u2032 =\n\n\\\n\n\u03a9g .\n\ng\u2208G\n\nFix \u031f \u2208 \u03a9\u2032 . By Lemma 5, the collection (\u03a0\u031f,\u03b5 )\u03b5\u2208(0,1) is relatively compact. Let \u03a0\u2217 be a sequential\nlimit of this collection as \u03b5 tends to 0. We deduce from Proposition 3 that,\n\u0001 for every g \u2208 G, for every\ns, t \u2265 0 and every choice of t1 , . . . , tp \u2208 [0, t] and f1 , . . . , fp \u2208 C\u0304 Mf (Rd ) , we have\n\u0014\u001a\nZ\n\u2212hYt+s ,gi\n\u2212hYt ,gi\n\u03a0\ne\n\u2212e\n\u2212\n\u2217\n\nt\n\nt+s D\n\n\u0015\n\u001bY\np\nE\n1\n\u2212hYu ,gi\nfi (Yti ) = 0.\ndu\nYu , \u2212 \u2206g + \u03c8(\u03ba) (g) e\n2\n\n(13)\n\ni=1\n\nThe required passage to the limit under the expectation sign is easily justified: Note that, by comparing\nwith the case when there is no killing and using standard results of the theory of critical branching\nprocesses, we have for every T > 0\ni\u0011\n\u0010\nh\n(14)\nsup E[\u03b5\u22121\u03b40 ] sup hXr\u031f,\u03b5 , 1i2 < \u221e.\n\u03b5\u2208(0,1)\n\n0\u2264r\u2264T\n\n2 (Rd ), another easily justified passage to the limit shows that (13) holds for every\nSince G is dense in C\u0304+\n2 (Rd ). Thus, \u03a0\u2217 satisfies the martingale problem for super-Brownian motion with branching\ng \u2208 C\u0304+\nmechanism \u03c8(\u03ba) as stated in Section 2. Since it is also clear that \u03a0\u2217 (Y0 = \u03b40 ) = 1, \u03a0\u2217 must be the law\nof super-Brownian motion with branching mechanism \u03c8(\u03ba) started from \u03b40 . This completes the proof\nof Theorem 2, but we still need to establish Lemma 5 and Proposition 3.\n\u0003\n\nProof of Lemma 5. The compact containment condition (i) in the lemma is immediately obtained\nby observing that X \u031f,\u03b5 is dominated by X 0 = X \u031f,0 and by using the convergence of rescaled branching\nBrownian motions (without killing in the obstacles) towards super-Brownian motion. So we only need\n11\n\n\f2 (Rd ). To simplify notation,\nto verify (ii). In the remaining part of the proof, we fix \u031f \u2208 \u03a9 and g \u2208 C\u0304+\nwe set\nXt\u03b5 = hXt\u031f,\u03b5 , gi.\n\nBy the remarks following Lemma 4 and an elementary scaling transformation, we have\nXt\u03b5 = X0\u03b5 + Mt\u03b5 + Vt\u03b5 ,\n\nwhere\nVt\u03b5\nand\n\nM\u03b5\n\n=\n\nZ tD\n0\n\nE\n1\nXs\u031f,\u03b5 , \u2206g \u2212 1\u0393\u03b5\u031f g ds\n2\n\nis a martingale, whose square bracket is given by\nZ t\nX\n\u031f,\u03b5\nhXs\u031f,\u03b5 , \u03b5\u2207g.\u2207gi ds +\nhXs\u031f,\u03b5 \u2212 Xs\u2212\n, gi2 .\n[M \u03b5 , M \u03b5 ]t =\n0\n\n0\u2264s\u2264t\n\nFurthermore, the oblique bracket of M \u03b5 is equal to\nZ t\n\u0001\n\u03b5\n\u03b5\nhM , M it =\nXs\u031f,\u03b5 , \u03c3 2 g2 + \u03b5 \u2207g.\u2207g + 1\u0393\u03b5\u031f g2 ds.\n0\n\nBy standard criteria (see in particular Theorem VI.4.13 in Jacod and Shiryaev [JS87]), the tightness\nof the laws of the processes X \u03b5 , \u03b5 \u2208 (0, 1), will follow if we can verify that the laws of the processes V \u03b5\nand hM \u03b5 , M \u03b5 i, for \u03b5 \u2208 (0, 1), are tight in the space of probability measures on CR [0, \u221e). But this is\nimmediate from the preceding explicit formulas and (14).\n\u0003\n\u0001\nd\nProof of Proposition 3. Let us fix s, t \u2265 0, t1 , . . . , tp \u2208 [0, t] and f\b1 , . . . , fp \u2208 C\u0304 Mf (R ) . Let\n\u221a\n\u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1). By Lemma 4 applied to the function f (x) = exp \u2212 \u03b5g(x \u03b5) , we can write\n\u0014\u001a\nZ t+s D\n\u0001\n\u031f,\u03b5\n1\n\u2212hXt+s\n,gi\n\u2212hXt\u031f,\u03b5 ,gi\n\u22122\n\u2212 \u03b52 \u2206g + \u03b53 \u2207g.\u2207g\n0 = E[\u03b5\u22121]\u03b40 e\nXu\u031f,\u03b5 ,\n\u2212e\n\u2212\u03b5\n2\nt\n\u0015\n\u001bY\np\nE\n\u0001 \u03b5g\n\u0001\n\u0001 \u2212hX \u031f,\u03b5 ,gi\n\u031f,\u03b5 \u0001\n\u2212\u03b5g\n\u03b5g\n\u2212\u03b5g\n\u2212\u03b5g\nu\nfi Xti\ne\ndu\ne +e \u03a5 e\n\u2212e\n+ \u03b51\u0393\u03b5\u031f 1 \u2212 e\n\u0014\u001a\nZ\n\u031f,\u03b5\n\u2212hXt+s\n,gi\n\u2212hXt\u031f,\u03b5 ,gi\n= E[\u03b5\u22121]\u03b40 e\n\u2212\n\u2212e\n\ni=1\n\nt+s D\n\n1\n\u03b5\nXu\u031f,\u03b5 , \u2212 \u2206g + \u2207g.\u2207g\n2\n2\nt\n\u0015\n\u001bY\np\nE\n2\n\u0001\n\u031f,\u03b5\n\u03c3\n,\nfi Xt\u031f,\u03b5\n+ 1\u0393\u03b5\u031f (g + \u03b7\u03b5 ) + (g2 + \u03b7\u0303\u03b5 ) e\u2212hXu ,gi du\ni\n2\n\n(15)\n\ni=1\n\nwhere \u03b7\u03b5 := \u03b5\u22121 (1 \u2212 e\u2212\u03b5g )e\u03b5g \u2212 g and \u03b7\u0303\u03b5 := (2/\u03c3 2 )\u03b5\u22122 e\u03b5g (\u03a5(e\u2212\u03b5g ) \u2212 e\u2212\u03b5g ) \u2212 g2 . Using a Taylor\nexpansion and the facts that \u03a5(1) = \u03a5\u2032 (1) = 1, \u03a5\u2032\u2032 (1) = \u03c3 2 , we readily obtain that for \u03b5 small\nenough we have k\u03b7\u03b5 k \u2264 C1 (g)\u03b5 for some constant C1 (g) depending only on g, and k\u03b7\u0303\u03b5 k \u2192 0 as \u03b5 \u2192 0.\nNow, using Fubini's theorem, the fact that (hXr\u031f,\u03b5 , 1i)r\u22650 is a supermartingale and the inequality\nE[\u03b5\u22121]\u03b40 [hX0\u031f,\u03b5 , 1i] = \u03b5[\u03b5\u22121 ] \u2264 1, we have\n\u0015\n\u001bY\np\n\u03b5\n\u03c3 2 E \u2212hXu\u031f,\u03b5 ,gi\n\u031f,\u03b5 \u0001\n\u03b5\nE[\u03b5\u22121]\u03b40\nfi Xti\ndu\n\u2207g.\u2207g + 1\u0393\u031f \u03b7\u03b5 + \u03b7\u0303\u03b5 e\n2\n2\nt\ni=1\n\u0013\n\u0012\n\u0015\n\u0013\u0012 Y\n\u0014 Z t+s\np\n\u0001 \u03c32\n\u03b5\n\u031f,\u03b5\nkfi k E[\u03b5\u22121]\u03b40\n\u2264\nhXu , 1i du\nk\u2207g.\u2207gk + 2C1 (g) + k\u03b7\u0303\u03b5 k\n2\n2\nt\ni=1\n\u0013\n\u0012 p\n\u0001 Y\n2\nkfi k s\n\u2264 C2 (g) \u03b5 + (\u03c3 /2)k\u03b7\u0303\u03b5 k\n\u0014 \u001aZ\n\nt+s D\n\nXu\u031f,\u03b5 ,\n\ni=1\n\n12\n\n\fwith a constant C2 (g) depending only on g. On the other hand,\nE[\u03b5\u22121]\u03b40\n\n\u0014 \u001aZ\n\nt+s\n\nt\n\n= E[\u03b5\u22121]\u03b40\n\nXu\u031f,\u03b5 ,\n\n\u0014\u001a Z\n\n1\u0393\u03b5\u031f g e\n\ndu\n\n\u001bY\np\ni=1\n\nt+s\n\nt\n\n+ E[\u03b5\u22121 ]\u03b40\n\n\u2212hXu\u031f,\u03b5 ,gi\n\n\u0014\u001a Z\n\n\u031f,\u03b5\n\nhXu\u031f,\u03b5 , \u03bagi e\u2212hXu\n\nt+s\n\nt\n\n,gi\n\n\u0001\nfi Xt\u031f,\u03b5\ni\n\n\u0015\n\n\u001bY\n\u0015\np\n\u0001\nfi Xt\u031f,\u03b5\ndu\ni\ni=1\n\n\u0015\n\u001bY\np\n\u0001\n\u031f,\u03b5 \u0001\n\u2212hXu\u031f,\u03b5 ,gi\n.\nfi Xti\n\u2212\u03ba g e\ndu\n\nXu\u031f,\u03b5 , 1\u0393\u03b5\u031f\n\n(16)\n\ni=1\n\nThe absolute value of the second term in the right-hand side of (16) is bounded above by\n\u0012Y\np\ni=1\n\n\u0013Z\nkfi k\n\nt+s\n\nE[\u03b5\u22121]\u03b40\n\nt\n\nh\n\n\u0001 i\nXu\u031f,\u03b5 , 1\u0393\u03b5\u031f \u2212 \u03ba g du.\n\nConsequently, going back to (15) and using the preceding estimates, we obtain for every \u031f \u2208 \u03a9 and\n\u03b5 \u2208 (0, 1),\n\u0014\u001a\nZ\n\u031f,\u03b5\n\u2212hXt+s\n,gi\n\u2212hXt\u031f,\u03b5 ,gi\nE[\u03b5\u22121]\u03b40 e\n\u2212e\n\u2212\n\n\u0015\n\u001bY\np\n\u03c3 2 2 E \u2212hXu\u031f,\u03b5 ,gi\n\u031f,\u03b5 \u0001\nfi Xti\ndu\n+ \u03bag + g e\n2\n2\nt\ni=1\n\u0013\n\u0013\u0012\n\u0012Y\np\n\b\n2\nC2 (g) \u03b5 + (\u03c3 /2)k\u03b7\u0303\u03b5 k s + r\u03b5 (\u031f, g, t, t + s) ,\n(17)\nkfi k\n\u2264\nt+s D\n\n1\nXu\u031f,\u03b5 , \u2212 \u2206g\n\ni=1\n\nwhere r\u03b5 (\u031f, g, t1 , t2 ) is defined for 0 \u2264 t1 \u2264 t2 by\nr\u03b5 (\u031f, g, t1 , t2 ) =\n\nZ\n\nt2\nt1\n\nE[\u03b5\u22121]\u03b40\n\nh\n\nXu\u031f,\u03b5 ,\n\n1\n\n\u0393\u03b5\u031f\n\nLemma 6. Let u > 0. Then, P-a.s.\nlim E[\u03b5\u22121]\u03b40\n\n\u03b5\u2192\u221e\n\nh\n\n\u0001 i\n\u2212 \u03ba g du.\n\n\u0001 i\n= 0.\nXu\u031f,\u03b5 , 1\u0393\u03b5\u031f \u2212 \u03ba g\n\n(18)\n\nAssuming that the lemma is proved, we can\ncomplete the proof of Proposition 3. Using\n\u0002 readily\n\u0003\nFubini's theorem, we may find a set \u03a9g with P \u03a9g = 1, such that, for every \u031f \u2208 \u03a9g , the convergence\nin (18) holds simultaneously for all u > 0, except possibly on a set of zero Lebesgue measure (depending\non \u031f). Since for every \u031f \u2208 \u03a9, \u03b5 \u2208 (0, 1) and u \u2265 0\nh\n\u0001 i\n\u031f,\u03b5\n\u03b5\n\u2264 kgk E[\u03b5\u22121 ]\u03b40 [hXu\u031f,\u03b5 , 1i] \u2264 kgk,\nE[\u03b5\u22121 ]\u03b40 Xu , 1\u0393\u031f \u2212 \u03ba g\n\ndominated convergence guarantees that for each \u031f \u2208 \u03a9g , lim\u03b5\u21920 r\u03b5 (\u031f, g, t, t + s) = 0 for all t, s \u2265 0. It\nfollows that the right-hand side of (17) tends to 0 as \u03b5 \u2192 0 when \u031f \u2208 \u03a9g , which completes the proof\nof Proposition 3.\n\u0003\nProof of Lemma 6. Recall that \u03be \u031f,\u03b5 denotes standard d-dimensional Brownian motion killed at\nrate \u03b5 within \u0393\u031f . We also use the notation \u03c7\u031f,\u03b5 for Brownian motion killed at rate 1 within \u0393\u03b5\u031f . Both\nprocesses \u03be \u031f,\u03b5 and \u03c7\u031f,\u03b5 start from x under the probability measure Px .\nWe first recall classical moment formulas for branching Brownian motion. For every x \u2208 Rd , k \u2208 N,\nand every bounded measurable function h on Rd , we have\nEk\u03b4x [hZt\u031f,\u03b5 , hi] = k Ex [h(\u03bet\u031f,\u03b5 )]\n13\n\n\fand\n\u0014Z t \u0010\n\u00112 \u0015\n\u0010\n\u00112\n\u031f,\u03b5\nds E\u03bes\u031f,\u03b5 [h(\u03bet\u2212s\n)]\nEk\u03b4x [hZt\u031f,\u03b5 , hi2 ] = k Ex [h(\u03bet\u031f,\u03b5 )2 ] + k(k \u2212 1) Ex [h(\u03bet\u031f,\u03b5 )] + k\u03c3 2 Ex\n.\n0\n\nThese formulas are easily derived, first for k = 1, from the well-known formula for the Laplace functional\nof Zt\u031f,\u03b5 under P\u03b4x : See e.g. Proposition II.3 in [LG99].\nRecalling the definition of X \u031f,\u03b5 in terms of Z \u031f,\u03b5, we get similar formulas for the first and second\nmoment of hXs\u031f,\u03b5 , hi. In particular, for s \u2265 0 and for every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1), we have\nh\n\u0001\n\u0001 2i\n2\n\u22121 \u031f,\u03b5\n= \u03b52 [\u03b5\u22121 ]2 \u2212 [\u03b5\u22121 ] A\u031f,\u03b5\n(19)\nE[\u03b5\u22121]\u03b40 Xs\u031f,\u03b5 , 1\u0393\u03b5\u031f \u2212 \u03ba g\n1 (0, s, g) + \u03b5[\u03b5 ]A2 (0, s, g),\nwhere, for every x \u2208 Rd ,\n\n\u0002\n\u0001\n\u0003\n\u031f,\u03b5\n\u031f,\u03b5\nA\u031f,\u03b5\n1 (x, s, g) := Ex 1\u0393\u03b5\u031f (\u03c7s ) \u2212 \u03ba g(\u03c7s ) ,\n\nand\nA\u031f,\u03b5\n2 (x, s, g)\n\n2\n\n:= \u03c3 Ex\n\n\u0014Z\n\ns\n\n0\n\n\u031f,\u03b5\nA\u031f,\u03b5\n1 (\u03c7v , s\n\nWe claim that, for every x \u2208 Rd and s > 0,\nP\u2212a.s.,\n\n\u0015\n\n\u0002\n\u00012\n\u0003\n\u031f,\u03b5 2\n\u2212 v, g) dv + \u03b5 Ex 1\u0393\u03b5\u031f (\u03c7\u031f,\u03b5\ns ) \u2212 \u03ba g(\u03c7s ) .\n2\n\nlim A\u031f,\u03b5\n1 (x, s, g) = 0.\n\n(20)\n\n\u03b5\u21920\n\nAssume for the moment that the claim holds. By taking x = 0 in (20), we obtain that A\u031f,\u03b5\n1 (0, s, g)\n\u031f,\u03b5\ntends to 0 as \u03b5 \u2192 0, P-a.s. Consider next A\u031f,\u03b5\n(0,\ns,\ng).\nThe\nsecond\nterm\nin\nthe\nformula\nfor\nA\n2\n2 (x, s, g)\nobviously tends to 0 uniformly in x, s and independently of the obstacles, as \u03b5 \u2192 0. To handle the\ne of full probability,\nfirst term, use Fubini's theorem to obtain that, for every \u031f belonging to a set \u03a9\nd\nthere exists a set N\u031f \u2282 R \u00d7 R+ of zero Lebesgue measure such that the convergence in (20) holds\nsimultaneously for all (x, s) \u2208\n/ N\u031f . We can then write the first term in the formula for A\u031f,\u03b5\n2 (0, s, g) as\nfollows:\nZ s Z\nh\ni2\n\u0001\n\u031f,\u03b5\n\u031f,\u03b5\n\u03b5\n)\n)\n\u2212\n\u03ba\ng(\u03c7\ndy p\u031f,\u03b5\n(0,\ny)\nE\n1\n(\u03c7\n,\n(21)\n\u03c32\ndv\ny\n\u0393\u031f\nv\ns\u2212v\ns\u2212v\n0\n\nRd\n\np\u031f,\u03b5\nv (*, *)\n\nwhere\nis the transition kernel of \u03c7\u031f,\u03b5 at time v. Plainly, we have p\u031f,\u03b5\nv (x, y) \u2264 pv (x, y) for each\nv \u2265 0 and \u03b5 \u2208 (0, 1), where pv (*, *) is the transition kernel of standard Brownian motion at time v.\nUsing this bound and dominated convergence gives us that the quantity in (21) tends to 0 as \u03b5 \u2192 0,\ne Hence A\u031f,\u03b5 (0, s, g) tends to 0 as \u03b5 \u2192 0, P-a.s. The result of Lemma 6 now follows\nfor every \u031f \u2208 \u03a9.\n2\nfrom (19) and the Cauchy-Schwarz inequality.\nWe still have to prove our claim (20). We fix x \u2208 Rd and s > 0. Let \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1). From\nthe definition of Brownian motion killed at rate 1 in \u0393\u03b5\u031f , we have\nh\nh\noi\ni\nn Z s\n\u0001\n\u0001\n\u031f,\u03b5\n\u031f,\u03b5\n(22)\n1\u0393\u03b5\u031f (\u03beu )du .\nEx 1\u0393\u03b5\u031f (\u03c7s ) \u2212 \u03ba g(\u03c7s ) = Ex 1\u0393\u03b5\u031f (\u03bes ) \u2212 \u03ba g(\u03bes ) exp \u2212\n0\n\nLet \u03b7 > 0 and choose \u03b8 \u2208 (0, s) such that e\u2212\u03b8 \u2265 1 \u2212 \u03b7. By the Markov property applied at time s \u2212 \u03b8,\nthe right-hand side of (22) is equal to\n\u0014\nn Z s\u2212\u03b8\nh\no\nn Z \u03b8\noi\u0015\n\u0001\nEx exp \u2212\n1\u0393\u03b5\u031f (\u03beu )du E\u03bes\u2212\u03b8 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) exp \u2212\n1\u0393\u03b5\u031f (\u03bev )dv\n0\n0\n\u0014\nh\ni\u0015\no\nn Z s\u2212\u03b8\n\u0001\n= Ex exp \u2212\n1\u0393\u03b5\u031f (\u03beu )du E\u03bes\u2212\u03b8 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\n(23)\n0\n\u0014\no\n\u0011i\u0015\no\nh\n\u0010\nn Z \u03b8\nn Z s\u2212\u03b8\n\u0001\n+Ex exp \u2212\n1\u0393\u03b5\u031f (\u03bev )dv \u2212 1\n1\u0393\u03b5\u031f (\u03beu )du E\u03bes\u2212\u03b8 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) exp \u2212\n.\n0\n\n0\n\n14\n\n\fThe condition 1 \u2212 e\u2212\u03b8 \u2264 \u03b7 entails that the absolute value of the second term in the right-hand side of\n(23) is bounded above by kgk\u03b7. Suppose we know that for every y \u2208 Rd we have\nh\ni\n\u0001\nP\u2212a.s.,\nlim Ey 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) = 0.\n(24)\n\u03b5\u21920\n\nThen, using the fact that the law of \u03bes\u2212\u03b8 is absolutely continuous with respect to Lebesgue measure\n(and Fubini's theorem to see that the convergence in (24) holds simultaneously for almost all y \u2208 Rd ,\nP-a.s.), we conclude that the first term in the right-hand side of (23) converges to 0 with P-probability\n1 as \u03b5 \u2192 0. Consequently, we have P-a.s.\nh\ni\n\u0001\n\u031f,\u03b5\nlim sup Ex 1\u0393\u03b5\u031f (\u03c7\u031f,\u03b5\ns ) \u2212 \u03ba g(\u03c7s ) \u2264 kgk\u03b7.\n\u03b5\u21920\n\nSince \u03b7 was arbitrary, our claim (20) follows.\nIt thus remains to prove that (24) holds. We fix y \u2208 Rd and \u03b8 > 0. In the following, \u03be \u2032 stands for\nanother Brownian motion independent of \u03be, which also starts from y under the probability measure\nPy . For each \u03b5 \u2208 (0, 1), we have\nh \u0002\nh \u0002\n\u0001\n\u00032 i\n\u0003i\n\u0001\n\u0001\nE Ey 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\n= E Ey 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba 1\u0393\u03b5\u031f (\u03be\u03b8\u2032 ) \u2212 \u03ba g(\u03be\u03b8 )g(\u03be\u03b8\u2032 )\nh\nn \u0002\noi\n\u0003\n(25)\n= Ey g(\u03be\u03b8 )g(\u03be\u03b8\u2032 ) P \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f \u2212 \u03ba2 ,\n\nwhere the last line uses Fubini's theorem and the definition of \u03ba. Recall that the measure \u0398 is\nsupported on compact sets which are contained in the fixed ball B(0, r0 ). If |x \u2212 x\u2032 | > 2r0 , the sets\n{(z, K) : x \u2208 z + K and K \u2282 B(0, r0 )} and {(z, K) : x\u2032 \u2208 z + K and K \u2282 B(0, r0 )} are disjoint, and\n\u221a\nso the events {x \u2208 \u0393\u031f } and {x\u2032 \u2208 \u0393\u031f } are independent under P. Recalling that \u0393\u03b5\u031f = \u03b5 \u0393\u031f , we see\n\u221a\nthat if |x \u2212 x\u2032 | > 2r0 \u03b5 we have P[x \u2208 \u0393\u03b5\u031f ; x\u2032 \u2208 \u0393\u03b5\u031f ] = P[x \u2208 \u0393\u03b5\u031f ]P[x\u2032 \u2208 \u0393\u03b5\u031f ] = \u03ba2 , which enables us\nto write\n\u0002\n\u0003\n\u0002\n\u0003\nP \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f = \u03ba2 1{|\u03be\u03b8 \u2212\u03be \u2032 |>2r0 \u221a\u03b5} + P \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f 1{|\u03be\u03b8 \u2212\u03be \u2032 |\u22642r0 \u221a\u03b5} .\n\u03b8\n\n\u03b8\n\nGoing back to (25), we obtain\nn \u0002\noi\nh\nh \u0002\n\u0003\n\u0001\n\u00032 i\nE Ey 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\n= Ey g(\u03be\u03b8 )g(\u03be\u03b8\u2032 )1{|\u03be\u03b8 \u2212\u03be \u2032 |\u22642r0 \u221a\u03b5} P \u03be\u03b8 \u2208 \u0393\u03b5\u031f ; \u03be\u03b8\u2032 \u2208 \u0393\u03b5\u031f \u2212 \u03ba2\n\u03b8\n\u0002\n\u221a \u0003\n\u2264 kgk2 Py |\u03be\u03b8 \u2212 \u03be\u03b8\u2032 | \u2264 2r0 \u03b5\n\u0002\n\u221a \u0003\n= kgk2 P0 |\u03be2\u03b8 | \u2264 2r0 \u03b5\n\u2264C\n\nkgk2 d/2\n\u03b5 ,\n\u03b8 d/2\n\n(26)\n\nwhere the constant C > 0 depends only on r0 . Let \u03b7 > 0. By the Markov inequality, we can write\ni\nh \u0002\n\u0001\n\u0003\n\u0001\n\u00032 i\n1 h \u0002\nkgk2\nP Ey 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) > \u03b7 \u2264 2 E Ey 1\u0393\u03b5\u031f (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 )\n\u2264 C 2 d/2 \u03b5d/2 .\n\u03b7\n\u03b7 \u03b8\n\nApplying the last bound with \u03b5 = \u03b5k = k\u22123 , for every k \u2208 N, yields a convergent series, and so by the\nBorel-Cantelli lemma we have P-a.s.,\n\u0002\n\u0001\n\u0003\nlim sup Ey 1\u0393\u03b5\u031fk (\u03be\u03b8 ) \u2212 \u03ba g(\u03be\u03b8 ) \u2264 \u03b7.\nk\u2192\u221e\n\nSince \u03b7 > 0 was arbitrary, the convergence (24) holds along the sequence (\u03b5k )k\u22651 .\nTo complete the proof, we set for every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1)\n\u0002\n\u0003\nU\u031f,\u03b5 = Ey 1\u0393\u03b5\u031f (\u03be\u03b8 ) g(\u03be\u03b8 )\n15\n\n\f(recall that y and \u03b8 are fixed). We shall prove the following result: For every \u031f \u2208 \u03a9,\nlim\n\nsup\n\nk\u2192\u221e (k+1)\u22123 \u2264\u03b5\u2264k \u22123\n\nU\u031f,\u03b5 \u2212 U\u031f,\u03b5k = 0.\n\n(27)\n\nCombining (27) with the fact that the convergence (24) is true along the sequence (\u03b5k )k\u22651 will then\nlead to the desired conclusion. In order to prove (27), we first note that for every \u03b5 \u2208 (0, 1),\nZ\nZ\n2\n1\n\u2212 |x\u2212y|\n2\n2\u03b8\nU\u031f,\u03b5 =\n1\u0393\u03b5\u031f (x) h(x)dx,\ndx =\n1\u0393\u03b5 (x) g(x)e\n(2\u03c0\u03b8)d/2 Rd \u031f\nRd\n2 (Rd ) which depends on y and \u03b8, but not on \u031f. Furthermore, for any fixed\nwith a function h \u2208 C\u0304+\nR\n\u03b7 > 0 we can find a large closed ball B centered at the origin and such that B c h(x)dx < \u03b7. Hence, if\nwe set\nZ\n\u2032\nh(x) 1\u0393\u03b5\u031f (x)dx,\nU\u031f,\u03b5\n=\nB\n\n\u2032 |\nU\u031f,\u03b5\n\nwe have |U\u031f,\u03b5 \u2212\n\u2264 \u03b7 for every \u03b5 \u2208 (0, 1). Thanks to this remark, it is enough to prove that (27)\n\u2032\n\u2032\nrespectively.\nholds when U\u031f,\u03b5 and U\u031f,\u03b5k are replaced by U\u031f,\u03b5\nand U\u031f,\u03b5\nk\n\u22123\n\u22123\nLet k \u2208 N and \u03b5 \u2208 [(k + 1) , k ). We have\nZ\n\u221a \u0001\n\u2032\nd/2\nU\u031f,\u03b5 = \u03b5\nh x \u03b5 1\u0393\u031f (x)dx\n\u22121/2 B\nZ\u03b5\nZ\n\u221a \u0001\n\u221a \u0001\nd/2\nd/2\n=\u03b5\nh x \u03b5 1\u0393\u031f (x)dx + \u03b5\nh x \u03b5 1\u0393\u031f (x)dx.\n(28)\n(\u03b5\u22121/2 B)\\(k 3/2 B)\n\nk 3/2 B\n\nNow, the first term in the right-hand side of (28) is equal to\nZ\nZ\n\u0010 x \u0011i\nh \u0010 \u221a \u0011\n\u0010 x \u0011\n\u0001\nd/2\n3 d/2 1\n\u03b5\n\u2212\nh\nh\nx\nh\n1\n1\u0393\u031f (x)dx\n(x)dx\n+\n\u03b5\n\u03b5k\n\u0393\n\u031f\nk3d/2 k3/2 B\nk3/2\nk3/2\nk 3/2 B\n\u0001d/2 \u2032\n= \u03b5k3\nU\u031f,\u03b5k + \u03b9(\u031f, \u03b5, k),\n\nwhere\n\n\u03b9(\u031f, \u03b5, k) = (\u03b5k 3 )d/2\nNote that 0 \u2264\nthat\n\n\u221a\n1 \u2212 k3/2 \u03b5\n\nZ h\nB\n\n\u2264\n\nC\nk\n\ni\n\u221a\nh((k3/2 \u03b5)y) \u2212 h(y) 1\u0393\u031f (k3/2 y)dy.\n\nwith a constant C independent of \u03b5 and k, from which it easily follows\nsup\n(k+1)\u22123 \u2264\u03b5\u2264k \u22123\n\n|\u03b9(\u031f, \u03b5, k)| \u2264\n\nC\u2032\nk\u2207hk,\nk\n\nwith a constant C \u2032 depending only on B.\nSimilarly, the second term in the right-hand side of (28) is bounded above by\n\u0002\n\u0003\nC \u2032\u2032 khk\n.\n\u03b5d/2 khk \u03b5\u2212d/2 \u2212 k3d/2 \u03bbd (B) \u2264\nk\n\nFinally, from (28) and the preceding estimates, we have\n\n\u2032\n\u2032\n\u2032\nU\u031f,\u03b5\n\u2212 U\u031f,\u03b5\n\u2264 (1 \u2212 (\u03b5k 3 )d/2 ) U\u031f,\u03b5\n+\nk\nk\n\nC \u2032 k\u2207hk C \u2032\u2032 khk\n+\n,\nk\nk\n\n\u2032\n)\nis bounded by construction). This\nand the convergence (27) follows (note that the sequence (U\u031f,\u03b5\nk k\u22651\ncompletes the proof.\n\u0003\n\nProof of Proposition 1. Clearly we get a lower bound for the quantity P\u03b40 (Z \u031f,\u03b5 hits B(0, R)c ) if we\nreplace Z \u031f,\u03b5 by branching Brownian motion killed homogeneously over Rd at rate \u03b5. This intuitively\n16\n\n\fobvious fact can be proved by a coupling argument. Part (i) of the proposition thus follows by applying\nthe lower bound in Lemma 1 to the projection of Z (\u03b5) on the first coordinate.\nLet us turn to the proof of the first\n\u221a assertion in (ii). We may restrict our attention to the values\nof R \u2265 1 and \u03b5 \u2208 [0, 1] such that \u03b5 R is larger than a fixed constant depending on d: Just observe\nthat the probability that (unkilled) branching Brownian motion starting with one initial particle at\nthe origin exits the unit ball is bounded above by a constant (depending on \u03bd) strictly smaller than 1.\nWe then have the following inequality: For every \u031f \u2208 \u03a9 and \u03b5 \u2208 (0, 1),\n\u0002\n\u0003\n\u0002\n\u0003\n(29)\nP\u03b40 Z \u031f,\u03b5 hits B(0, R)c \u2264 P0 \u03be \u031f,\u03b5 hits B(0, R)c .\n\nIndeed, using the formalism of Subsection 2.3, the criticality of the offspring distribution can be used\nto check that the right-hand side of (29) is just the expected value of the number of those historical\npaths \u03c9 v that first exit B(0, R) during the interval [\u03b1v , \u03b2v \u2227\u0002 \u03b6v\u031f,\u03b5). Alternatively,\n\u0003 it is easy to derive\nan integral equation similar to (9) for the function x \u2192 P\u03b4x Z \u031f,\u03b5 hits B(0, R)c , and the bound (29)\nthen trivially follows from this\u0002integral equation. \u0003\nThen, let us bound P \u2297 P0 \u03be \u031f,\u03b5 hits B(0, R)c . We write \u03be \u031f,\u03b5,k for the k-th coordinate of \u03be \u031f,\u03b5 , for\nevery k = 1, . . . , d. We observe that\nd\n\u221a \u0003\n\u221a\n\u0002\n\u0003 X\n\u0002\nP \u2297 P0 \u03be \u031f,\u03b5 hits B(0, R)c \u2264\nP \u2297 P0 \u03be \u031f,\u03b5,k hits (\u2212R/ d, R/ d)c .\n\n(30)\n\nk=1\n\n\u221a \u221a\nLet us consider the first term in the sum. Define N\u03b5,R := [R \u03b5/ d] and for every j \u2208 Z, set\nTj\u03b5 = inf{t \u2265 0 : \u03bet1 = j\u03b5\u22121/2 }, where \u03bet1 stands for the first coordinate of \u03bet . With this notation, we\ncan write\n\u221a \u0003\n\u221a\n\u0002\nP \u2297 P0 \u03be \u031f,\u03b5,1 hits (\u2212R/ d, R/ d)c\nh\n\u0001c i\n\u2264 P \u2297 P0 \u03be \u031f,\u03b5,1 hits \u2212 N\u03b5,R \u03b5\u22121/2 , N\u03b5,R \u03b5\u22121/2\n\u001b\u0015\n\u001b\u0015\n\u0014\n\u001a\n\u0014\n\u001a\nZ T\u03b5\nZ T\u03b5\nN\u03b5,R\n\u2212N\u03b5,R\n\u2264 E \u2297 E0 exp \u2212 \u03b5\n1\u0393\u031f (\u03bes )ds\n+ E \u2297 E0 exp \u2212 \u03b5\n1\u0393\u031f (\u03bes )ds .\n(31)\n0\n\n0\n\nConsider the first term in the right-hand side of (31). Recall the definition (1) of the set of obstacles,\nand set for every j \u2208 N and \u03b5 > 0,\n\b\nIj\u03b5 := i \u2208 I : xi \u2208 ((j \u2212 1)\u03b5\u22121/2 , j\u03b5\u22121/2 ) \u00d7 Rd\u22121 ,\n[\n\u221a\n(xi + Ki )\nand\n\u0393\u03b5\u031f (j) := \u03b5 \u0393\u031f (j, \u03b5).\n\u0393\u031f (j, \u03b5) :=\ni\u2208Ij\u03b5\n\nNote that the random sets \u0393\u031f (j, \u03b5), j \u2208 N, are independent under P, by properties of Poisson measures.\nWe have then\n\u001b\u0015\n\u0014\n\u001a\n\u001b\u0015\n\u0014\n\u001a\nN\u03b5,R Z T \u03b5\nZ T\u03b5\nX\nj\nN\u03b5,R\nE \u2297 E0 exp \u2212 \u03b5\n1\u0393\u031f (\u03bes )ds \u2264 E \u2297 E0 exp \u2212 \u03b5\n1\u0393\u031f (j,\u03b5)(\u03bes )ds\n0\n\n\u0014\n\n= E \u2297 E0 exp\n\n\u001a\n\nj=1\n\n\u2212\u03b5\n\nZ\n\n\u03b5\nTj\u22121\n\nT1\u03b5\n\n0\n\n1\u0393\u031f (1,\u03b5) (\u03bes )ds\n\n\u001b\u0015N\u03b5,R\n\n,\n\n(32)\n\nwhere the equality comes from an application of the strong Markov property of \u03be, together with the\nindependence of the random sets \u0393\u031f (j, \u03b5) and the fact that the distribution of each of these random\nsets is invariant under translations by elements of {0} \u00d7 Rd\u22121 . By scaling, if T1 denotes the entrance\ntime of \u03be into [1, \u221e) \u00d7 Rd\u22121 , we can write\n\u001b\u0015\n\u001b\u0015\n\u0014\n\u001a\n\u0014\n\u001a Z T1\nZ T\u03b5\n1\n\u03b1\u03b5 := E \u2297 E0 exp \u2212 \u03b5\n1\u0393\u031f (1,\u03b5) (\u03bes )ds\n= E \u2297 E0 exp \u2212\n1\u0393\u03b5\u031f (1) (\u03bes )ds .\n0\n\n0\n\n17\n\n\fWe then observe that\nZ\n\n0\n\nT1\n\n1\u0393\u03b5\u031f (1) (\u03bes )1(0,1) (\u03bes1 ) ds\n\n(P )\n\n\u2212\u2192 \u03ba\n\u03b5\u21920\n\nZ\n\nT1\n0\n\n1(0,1) (\u03bes1 )ds\n\n(33)\n\n(P )\n\nwhere the notation \u2212\u2192 refers to convergence in probability under P \u2297 P0 (and we recall that \u03bes1 is the\nfirst coordinate of \u03bes ). To see this, we use arguments similar to the proof of Lemma 6. Notice that\n\u221a\n\u221a\nP[y \u2208 \u0393\u03b5\u031f (1)] \u2264 \u03ba if y \u2208 (0, 1) \u00d7 Rd\u22121 , with equality if y \u2208 (r0 \u03b5, 1 \u2212 r0 \u03b5) \u00d7 Rd\u22121 . Using this remark,\nand the same argument as in the derivation of (26), we can write for every fixed u > 0,\nE \u2297 E0\n\n\u0014\u001a Z\n\nT1 \u2227u\n0\n\n\u0014Z\n\n\u0001\n1\u0393\u03b5\u031f (1) (\u03bes ) \u2212 \u03ba 1(0,1) (\u03bes1 )ds\n\nT1 \u2227uZ T1 \u2227u\n\n\u001b2 \u0015\n\u03ba) 1(0,1) (\u03bes1 ) 1(0,1) (\u03bet1 ) dsdt\n\n\u0015\n\n1\u0393\u03b5\u031f (1) (\u03bes ) \u2212 \u03ba)(1\u0393\u03b5\u031f (1) (\u03bet ) \u2212\n= E \u2297 E0\n0\n0\n\u0014 Z T1 \u2227uZ T1 \u2227u\n\u0015\n\b \u0002\n\u0003\n\u03b5\n2\n1\n1\n= E0\nP \u03bes , \u03bet \u2208 \u0393\u031f (1) \u2212 \u03ba 1(0,1) (\u03bes ) 1(0,1) (\u03bet ) dsdt + O(\u03b51/2 )\n0\n0\n\u0015\n\u0014 Z T1 \u2227uZ T1 \u2227u\n\b \u0002\n\u0003\n1\n1\n2\n\u03b5\n\u221a\n= E0\nP \u03bes , \u03bet \u2208 \u0393\u031f (1) \u2212 \u03ba 1{|\u03bes \u2212\u03bet |\u22642r0 \u03b5} 1(0,1) (\u03bes ) 1(0,1) (\u03bet ) dsdt + O(\u03b51/2 )\n0\n0\n\u0014 Z uZ u\n\u0015\n\u2264 E0\n1{|\u03bes \u2212\u03bet |\u22642r0 \u221a\u03b5} dsdt + O(\u03b51/2 )\n0\n\n0\n\nwhere the error term O(\u03b51/2 ) corresponds to the contribution of times s, t such that \u03bes1 or \u03bet1 belongs\n\u221a\n\u221a\nto the set (0, r0 \u03b5] \u222a [1 \u2212 r0 \u03b5, 1). The preceding quantity tends to 0 as \u03b5 \u2192 0, which yields the\nconvergence (33). Since the limiting variable in (33) is (strictly) positive a.s., we can find \u03b51 \u2208 (0, 1)\nand c1 < 1 such that \u03b1\u03b5 \u2264 c1 for every \u03b5 \u2208 (0, \u03b51 ). Using (31) and (32), we see that the first term\nN\nof the sum in (30) is bounded above by 2 c1 \u03b5,R provided that \u03b5 \u2208 (0, \u03b51 ). The same bound will hold,\npossibly with a different value of \u03b51 , for the other terms of the sum in (30). Therefore, we arrive at\nthe bound\n\u0002\n\u0003\nN\nP \u2297 P0 \u03be \u031f,\u03b5 hits B(0, R)c \u2264 2d c1 \u03b5,R ,\n\nfor \u03b5 \u2208 (0, \u03b51 ). Now recall from\n\u221a the beginning of the proof that we may restrict our attention to the\nvalues of R and \u03b5 such that \u03b5 R is larger than a fixed constant depending on d. The first assertion in\n(ii) now follows from (29) and the last bound.\nLet us turn to the second assertion. Let C2 > 0 be a positive constant whose choice will be specified\nlater. By simple comparison arguments, it is enough to prove the desired estimate when R is of the\nform R = 2k , for k \u2208 N large enough, and \u03b5 is of the form \u03b5 = 2\u2212j , with j \u2208 {0, 1, . . . , 2k} such that\n\u03b5 \u2265 C2 (log log R)2 /R2 .\nBy the first assertion in (ii) and the Markov inequality,\ni\nh \u0002\n\u0003\n\u221a\n\u221a\n(34)\nP P\u03b40 Z \u031f,\u03b5 hits B(0, R)c \u2265 exp(\u2212C1 R \u03b5/2) \u2264 exp(\u2212C1 R \u03b5/2).\nHowever, if R = 2k and \u03b5 \u2265 C2 (log log R)2 /R2 , we have\np\np\n\u221a\nR \u03b5 \u2265 C2 log log R = C2 (log k + log log 2).\n\nUsing this bound, we can choose the constant C2 sufficiently large so that we get a convergent series\nwhen we sum the right-hand side of (34) over all R = 2k and \u03b5 = 2\u2212j for j \u2208 {0, 1, . . . , 2k} such that\n\u03b5 \u2265 C2 (log log R)2 /R2 . The Borel-Cantelli lemma now yields the desired result.\n\u0003\n\n18\n\n\f4\n\nProof of the main result\n\nIn this section, we prove Theorem 1. We fix the environment \u031f such that the weak convergence of\nTheorem 2 holds, and derive the convergence in Theorem 1 for this fixed value of the environment. For\nthe sake of simplicity, we shall omit \u031f in the notation and write Z \u03b5 instead of Z \u031f,\u03b5 , and X \u03b5 instead\nof X \u031f,\u03b5 .\nWe shall verify that for any increasing sequence (Rn )n\u22651 of positive reals converging to +\u221e and\nany sequence (\u03b5n )n\u22651 of nonnegative reals such that \u03b5n Rn2 \u2192 a \u2208 [0, \u221e], we have\nlim Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = u(\u03baa) (0),\n\n(35)\n\nn\u2192\u221e\n\nwhere u(\u221e) (0) = 0 by convention.\nThe statement of Theorem 1 follows from this convergence. Indeed, if the conclusion of the theorem\nfails, then we can find a sequence Rn \u2191 \u221e and a sequence (\u03b5n ) of nonnegative reals such that, for every\nn \u2265 1,\n|Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2212 u(\u03ba\u03b5n R2n ) (0)| \u2265 \u03b4\n\nfor some constant \u03b4 > 0. By extracting a subsequence, we may assume that \u03b5n Rn2 \u2212\u2192 a \u2208 [0, \u221e] and\nthus obtain a contradiction with (35) since we know from Lemma 2 that the mapping b \u2192 u(b) (0) is\ncontinuous on [0, \u221e].\nIn proving (35), we may assume that \u03b5n \u2192 0 as n \u2192 \u221e. Indeed, suppose that (35) holds in this\nparticular case and let (\u03b5\u2032n ) be a sequence that does not converge to 0. If the sequence \u03b5\u2032n Rn2 converges\nthen necessarily its limit is +\u221e, and we can find another sequence \u03b5\u2032\u2032n such that 0 \u2264 \u03b5\u2032\u2032n \u2264 \u03b5\u2032n , \u03b5\u2032\u2032n \u2192 0\nand \u03b5\u2032\u2032n Rn2 \u2192 \u221e. So, if we know that (35) holds in the case when the sequence (\u03b5n ) tends to 0, we\nobtain\n\u2032\u2032\nlim Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = 0.\nn\u2192\u221e\n\n\u03b5\u2032\u2032n\n\nHowever, from the inequality\n\u2264 \u03b5\u2032n and a coupling argument (obvious if one uses the construction\ndescribed in Subsection 2.3), we get the same result for the sequence (\u03b5\u2032n ).\nA similar comparison argument shows that it is enough to prove (35) in the case when a < \u221e.\nOtherwise, it suffices to replace \u03b5n by \u03b5n \u2227 bRn\u22122 and let b \u2192 \u221e, using the fact that u(b) (0) \u2192 0 as\nb \u2192 \u221e.\nLet us now proceed to the proof of (35). We fix the sequences Rn \u2191 \u221e and \u03b5n \u2192 0 such that\n\u03b5n Rn2 \u2212\u2192 a \u2208 [0, \u221e). We first assume that a > 0. The case a = 0 will be discussed at the end of the\nsection.\nLet B be a closed subset of Rd . For every \u03b5 > 0, we have by the definition of X \u03b5\nP[\u03b5\u22121]\u03b40 (X \u03b5 hits B) = P[\u03b5\u22121]\u03b40 (\u2203t \u2265 0 : Xt\u03b5 (B) > 0)\n\u0013\n\u0012\nZ\n\u221a\n\u03b5\n= P[\u03b5\u22121]\u03b40 \u2203t \u2265 0 : Z\u03b5\u22121 t (dx) 1B (x \u03b5) > 0\n= P[\u03b5\u22121]\u03b40 (Z \u03b5 hits \u03b5\u22121/2 B)\n\n= 1 \u2212 P\u03b40 (Z \u03b5 does not hit \u03b5\u22121/2 B)[\u03b5\n\n\u22121 ]\n\n,\n\nsince (for a fixed environment) the law of Z \u03b5 under P[\u03b5\u22121 ]\u03b40 is obtained by adding [\u03b5\u22121 ] independent\n1/2\n\ncopies of Z \u03b5 under P\u03b40 . Applying the preceding identity with \u03b5 = \u03b5n and B = bn Ac , where bn = \u03b5n Rn ,\ngives us that\n\u22121\n1 \u2212 P\u03b40 (Z \u03b5n does not hit Rn Ac )[\u03b5n ] = P[\u03b5\u22121\n(X \u03b5n hits bn Ac )\n(36)\nn ]\u03b40\n\nconverges as n \u2192 \u221e to the law of superBy Theorem 2, we know that the law of X \u03b5n under P[\u03b5\u22121\nn ]\u03b40\nBrownian motion with branching mechanism \u03c8(\u03ba) started from \u03b40 . The next lemma is essentially a\nconsequence of this convergence. We use the notation of Subsection 2.4.\n19\n\n\fLemma 7. We have\nlim P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) = P\u03b40 (Y (\u03ba) hits bAc ),\nn ]\u03b40\n\nwhere b =\n\n\u221a\n\nn\u2192\u221e\n\na = lim bn .\n\nWe postpone the proof of Lemma 7 and proceed to the proof of (35), in the case when a > 0. By\nthe results recalled in Subsection 2.4, we know that\nP\u03b40 (Y (\u03ba) hits bAc ) = 1 \u2212 exp(\u2212v(0)) ,\n\n(37)\n\nwhere the function (v(x), x \u2208 bA) is the unique nonnegative solution of the singular boundary value\nproblem\n(1\nin bA ,\n2 \u2206v = \u03c8(\u03ba) (u)\nu|\u2202(bA) = +\u221e .\n\nIt is immediate to verify that u(\u03baa) (x) = a v(bx) for every x \u2208 A, and in particular u(\u03baa) (0) = a v(0).\nFrom (36), (37) and Lemma 7, we obtain\n\u22121\n\nlim (1 \u2212 P\u03b40 (Z \u03b5n hits Rn Ac ))[\u03b5n\n\nn\u2192\u221e\n\n]\n\n= exp(\u2212v(0))\n\nand thus\nlim \u03b5\u22121 P\u03b40 (Z \u03b5n\nn\u2192\u221e n\n\nhits Rn Ac ) = v(0),\n\nor equivalently, since \u03b5n Rn2 \u2212\u2192 a,\nlim Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = av(0) = u(\u03baa) (0).\n\nn\u2192\u221e\n\nThis completes the proof of (35), in the case a > 0.\n\n\u0003\n\nProof of Lemma 7. By replacing A with bA, we may and shall assume in this proof that b = 1. We\nthus have bn \u2212\u2192 1 as n \u2192 \u221e. We first prove that\nlim inf P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) \u2265 P\u03b40 (Y (\u03ba) hits Ac ).\nn ]\u03b40\nn\u2192\u221e\n\n(38)\n\nBy Lemma 3, the events {Y (\u03ba) hits Ac } and {Y (\u03ba) hits (\u0100)c } coincide a.s. We can then find a countable\ncollection (\u03c6i )i\u22651 of continuous functions with compact support contained in (\u0100)c , such that\n\u0011\no\n\u0010\nn\n(\u03ba)\nP\u03b40 a.s..\n{Y (\u03ba) hits (\u0100)c } = sup sup hYt , \u03c6i i > 0 ,\ni\u22651\n\nt>0\n\nHence, if (tj )j\u22651 is a sequence dense in [0, \u221e), we have\n\u0011\n\u0011\n\u0010\n\u0010\n(\u03ba)\nsup hYtj , \u03c6i i > 0 .\nP\u03b40 (Y (\u03ba) hits (\u0100)c ) = lim \u2191 P\u03b40 sup\nN \u2192\u221e\n\n1\u2264i\u2264N\n\nHowever, Theorem 2 implies that, for every N \u2265 1,\n\u0011\n\u0011\n\u0010\n\u0010\n\u0011\n\u0011\n\u0010\n\u0010\n(\u03ba)\n\u03b5n\nsup hYtj , \u03c6i i > 0 .\nsup hXtj , \u03c6i i > 0 \u2265 P\u03b40 sup\nsup\nlim inf P[\u03b5\u22121\nn ]\u03b40\nn\u2192\u221e\n\n1\u2264i\u2264N\n\n1\u2264i\u2264N\n\n1\u2264j\u2264N\n\n(39)\n\n1\u2264j\u2264N\n\n(40)\n\n1\u2264j\u2264N\n\nRecall that bn \u2192 1, and note that the support of each function \u03c6i is at a strictly positive distance\nfrom the set A. As a consequence, for every fixed N , the support of \u03c6i will be contained in bn (\u0100)c for\nevery i = 1, . . . , N , as soon as n is large enough. Hence, for all large enough n,\n\u0011\no\n\u0010\nn\nsup hXt\u03b5jn , \u03c6i i > 0 \u2282 {X \u03b5n hits bn Ac }.\nsup\n1\u2264i\u2264N\n\n1\u2264j\u2264N\n\n20\n\n\fUsing this inclusion and then (40) and (39), we immediately obtain (38).\nWe next turn to the more difficult upper bound\nlim sup P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) \u2264 P\u03b40 (Y (\u03ba) hits Ac ).\nn ]\u03b40\nn\u2192\u221e\n\n(41)\n\nWe fix \u03b4 > 0 small enough so that the closed ball of radius 4\u03b4 centered at 0 is contained in A. As in\nLemma 2, we let A\u03b4 be the connected component of the open set\n{x \u2208 A : dist(x, Ac ) > \u03b4}\nthat contains 0. We denote the exit measure from A\u03b4 for the rescaled branching Brownian motion X \u03b5n\nby E\u03b4n . In other words, the measure E\u03b4n is equal to \u03b5n times the sum of the Dirac point masses at all\npoints of \u2202A\u03b4 which are first exit points from A\u03b4 for one of the historical paths associated with X \u03b5n\n(these historical paths are defined in Subsection 2.3 for the branching Brownian motion Z \u03b5n , and this\ndefinition is extended to X \u03b5n by an obvious scaling transformation).\nLet \u03a6 be a continuous function on Rd such that 0 \u2264 \u03a6 \u2264 1, \u03a6 = 0 on A3\u03b4 and \u03a6 = 1 on Ac2\u03b4 . Then,\nfor every \u03b7 > 0 and \u03c1 > 0,\n(X \u03b5n hits bn Ac , hE\u03b4n , 1i < \u03b7)\nP[\u03b5\u22121\n(X \u03b5n hits bn Ac ) = P[\u03b5\u22121\nn ]\u03b40\nn ]\u03b40\n\u0013\n\u0012\nZ \u221e\n\u03b5n\n\u03b5n\nc\nn\n,\n\u03a6ids\n\u2264\n\u03c1\nhX\n+ P[\u03b5\u22121\nX\nhits\nb\nA\n,\nhE\n,\n1i\n\u2265\n\u03b7,\nn\ns\n\u03b4\nn ]\u03b40\n\u0013\n\u0012\nZ0 \u221e\n\u03b5n\nc\nn\n\u03b5n\nhXs , \u03a6ids > \u03c1 .\nX hits bn A , hE\u03b4 , 1i \u2265 \u03b7,\n+ P[\u03b5\u22121\nn ]\u03b40\n\n(42)\n\n0\n\nLet \u03b1n (\u03b7), \u03b2n (\u03b7, \u03c1) and \u03b3n (\u03b7, \u03c1) be the three terms appearing in the right-hand side of (42) in this\norder.\nWe first bound \u03b1n (\u03b7). Provided n is sufficiently large, bn Ac is contained in Ac\u03b4/2 and thus\n\u03b1n (\u03b7) \u2264 P[\u03b5\u22121\n(X \u03b5n hits Ac\u03b4/2 , hE\u03b4n , 1i < \u03b7).\nn ]\u03b40\nNote that the times at which the historical paths of X \u03b5n exit A\u03b4 form a stopping line in the sense of\n[Ch91]. We can thus apply the strong Markov property at a stopping line (Proposition 2.1 in [Ch91],\nor more precisely a slight extension of the results in [Ch91] since our spatial motion is not standard\nBrownian motion, but Brownian motion killed inside \u0393\u031f ) to obtain that\nh\n\u0001i\nc\n\u03b5n\nc\nn\n\u03b5n\nn\nhits\nA\nX\n1\nP\n,\n1i\n<\n\u03b7)\n=\nE\nhits\nA\n,\nhE\nP[\u03b5\u22121\n(X\n\u22121\nn\n{hE\u03b4 ,1i<\u03b7} \u1ebc\n\u03b4\n\u03b4/2 ,\n\u03b4/2\n[\u03b5n ]\u03b40\nn ]\u03b40\n\u03b4\n\nd  \u0303n\nn 1/2\nwhere E \u0303\u03b4n is the point measure defined by E \u0303\u03b4n (B) = \u03b5\u22121\nn E\u03b4 (\u03b5n B) for every Borel subset B of R (E\u03b4\n\u22121/2\nis in fact the exit measure of the unscaled process Z \u03b5n from \u03b5n A\u03b4 ). From this equality, we see that\n\u03b1n (\u03b7) is bounded above by the probability for a branching Brownian motion (without killing) starting\ninitially with less than \u03b7\u03b5\u22121\nn particles, that one of the historical paths reaches a distance greater than\n\u221a\n\u03b4/(2 \u03b5n ) from its starting point. The estimate (8) now gives\n\nThen, we have\n\n\u0001\n\u221a\n4\u03b7\n(0)\nhits B(0, \u03b4/(2 \u03b5n ))c \u2264 C1\u2032\u2032 (d, \u03bd) 2 .\n\u03b1n (\u03b7) \u2264 \u03b7\u03b5\u22121\nn \u00d7 P\u03b40 Z\n\u03b4\n\u03b2n (\u03b7, \u03c1) \u2264 P[\u03b5\u22121\nn ]\u03b40\n\n\u0012\n\nhE\u03b4n , 1i\n\n\u2265 \u03b7,\n\nZ\n\n\u221e\n0\n\nhXs\u03b5n , \u03a6ids\n\n\u0013\n\n(43)\n\n\u2264\u03c1 .\n\nRecall that \u03a6 = 1 on Ac2\u03b4 and in particular \u03a6 = 1 on B(x, \u03b4) for every x \u2208 \u2202A\u03b4 . We use the strong\nMarkov property at the same stopping line as in the previous argument, together with a simple coupling\nargument, to write that\n\u0013\n\u0012Z \u221e\n\u03b5n\ne\nhXs , 1B(0,\u03b4) ids \u2264 \u03c1 ,\n\u03b2n (\u03b7, \u03c1) \u2264 P[\u03b7\u03b5\u22121\nn ]\u03b40\n0\n\n21\n\n\fe \u03b5n is defined in terms of a branching Brownian motion Ze\u03b5n in the same way as X \u03b5n was\nwhere X\ndefined from Z \u03b5n . This branching Brownian motion Ze\u03b5n has the same offspring distribution as Z \u03b5n ,\nbut particles are now killed at rate \u03b5n homogeneously over Rd . Furthermore, Ze\u03b5n also starts from k\u03b40\nunder the probability measure Pk\u03b40 .\ne \u03b5n )t\u22650 under P \u22121 converges as n \u2192 \u221e to the law of Y (1) under\nBy Proposition 2, the law of (X\nt\n[\u03b7\u03b5n ]\u03b40\n(1)\n\nP\u03b7\u03b40 (in the notation of Subsection 2.4). Noting that, for every fixed s > 0, Ys a.s. does not charge\nthe boundary of the ball B(0, \u03b4), it follows that\n\u0013\n\u0013\n\u0012Z \u221e\n\u0012Z \u221e\n\u03b5n\n(1)\ne\nhXs , 1B(0,\u03b4) ids \u2264 \u03c1 \u2264 P\u03b7\u03b40\nhYs , 1B(0,\u03b4) ids \u2264 \u03c1 =: \u03b2\u221e (\u03b7, \u03c1).\nlim sup P[\u03b7\u03b5\u22121\nn ]\u03b40\nn\u2192\u221e\n\n0\n\n0\n\nThe continuity of sample paths of Y (1) ensures that \u03b2\u221e (\u03b7, \u03c1) \u2212\u2192 0 as \u03c1 \u2192 0, for every fixed \u03b7 > 0.\nFor the term \u03b3n (\u03b7, \u03c1), we simply use the bound\n\u0013\n\u0012Z \u221e\n\u03b5n\nhXs , \u03a6ids > \u03c1 .\n\u03b3n (\u03b7, \u03c1) \u2264 P[\u03b5\u22121\nn ]\u03b40\n0\n\nThis bound and the weak convergence of Theorem 2 imply that\n\u0010Z \u221e\n\u0011\nlim sup \u03b3n (\u03b7, \u03c1) \u2264 P\u03b40\nhYs(\u03ba) , \u03a6ids \u2265 \u03c1 \u2264 P\u03b40 (Y (\u03ba) hits Ac3\u03b4 ),\nn\u2192\u221e\n\n0\n\nsince \u03a6 = 0 on A3\u03b4 . (To justify the first inequality in the last display, we also use the fact that the\nare stochastically bounded, which follows from a standard result\nextinction times of X \u03b5n under P[\u03b5\u22121\nn ]\u03b40\nin the case without killing.)\nTo complete the argument, fix \u03b8 > 0. By Lemma 2 (ii), we can choose \u03b4 > 0 sufficiently small so\nthat\n\u03b8\nP\u03b40 (Y (\u03ba) hits Ac3\u03b4 ) \u2264 P\u03b40 (Y (\u03ba) hits Ac ) + .\n3\nFrom (43), we can then choose \u03b7 > 0 sufficiently small so that for all large n,\n\u03b1n (\u03b7) \u2264\n\n\u03b8\n.\n3\n\nFinally we choose \u03c1 > 0 such that \u03b2\u221e (\u03b7, \u03c1) \u2264 \u03b83 . From (42) and the previous estimates, we obtain\nlim sup P[\u03b5\u22121\n(X \u03b5n hits bn Ac ) \u2264 P\u03b40 (Y (\u03ba) hits Ac ) + \u03b8,\nn ]\u03b40\nn\u2192\u221e\n\nand since \u03b8 was arbitrary this completes the proof of (41) and Lemma 7.\n\u0003\nWe still have to discuss the case a = 0 in (35). So, let us consider two sequences (\u03b5n )n\u22651 and\n(Rn )n\u22651 such that \u03b5n Rn2 \u2192 0. Let a0 > 0 and \u03b5\u2032n = \u03b5n \u2228 (a0 Rn\u22122 ). Since \u03b5n \u2264 \u03b5\u2032n , we have\n\u2032\n\nlim inf Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2265 lim inf Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) = u(\u03baa0 ) (0),\nn\u2192\u221e\n\nn\u2192\u221e\n\nby the case a > 0. By Lemma 2 (i), u(\u03baa0 ) (0) can be made arbitrarily close to u(0) (0) when a0 is small,\nand so\nlim inf Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2265 u(0) (0).\nn\u2192\u221e\n\nTo obtain the corresponding upper bound, a similar coupling argument shows that it suffices to consider\nthe case when \u03b5n = 0 for every n, that is when there is no killing inside the obstacles. Hence, consider\nthe branching Brownian motion Z 0 = Z \u031f,0 (the notation is even more legitimate since Z \u031f,0 does not\ndepend on \u031f). For every \u03c1 > 0, define a rescaled version of Z 0 by setting\nZ\n(\u03c1)\nhX t , \u03c6i = \u03c1 Z\u03c10\u22121 t (dx) \u03c6(\u03c11/2 x).\n22\n\n\f(\u03c1)\n\nBy Proposition 2, the law of (X t )t\u22650 under P[\u03c1\u22121 ]\u03b40 converges to the law of Y (0) under P\u03b40 as \u03c1 tends\nto 0. Set \u03c1n = Rn\u22122 , and note that\n{Z 0 hits Rn Ac } = {X\n\n(\u03c1n )\n\nhits Ac }.\n\n(44)\n\nA simplified version of the arguments of the proof of Lemma 7 shows that\nlim sup P[\u03c1\u22121\n(X\nn ]\u03b40\n\n(\u03c1n )\n\nn\u2192\u221e\n\nhits Ac ) \u2264 P\u03b40 (Y (0) hits Ac ) = 1 \u2212 exp(\u2212u(0) (0)).\n\nArguing as in the first part of the proof of the theorem and using (44) yields\nlim sup Rn2 P\u03b40 (Z \u03b5n hits Rn Ac ) \u2264 u(0) (0),\nn\u2192\u221e\n\nwhich completes the proof of Theorem 1.\n\n\u0003\n\nProof of Corollary 1. For every r > 0,\n\u0010\n\u0011 n\u03b5\n\u221a\nPn\u03b5 \u03b40 ( \u03b5 R\u031f,\u03b5 < r) = 1 \u2212 P\u03b40 (Z \u031f,\u03b5 hits B(0, \u03b5\u22121/2 r)c ) .\n\nHowever, Theorem 1 shows that, P(d\u031f) a.s.,\n\nn\u03b5 P\u03b40 (Z \u031f,\u03b5 hits B(0, \u03b5\u22121/2 r)c ) =\nconverges to\n\nb\nr2\n\n\u0011\n\u03b5n\u03b5 \u0010 r 2\n\u031f,\u03b5\n\u22121/2 c\nP\n(Z\nhits\nB(0,\n\u03b5\nr)\n)\n\u00d7\n\u03b4\nr2\n\u03b5 0\n\nu\u25e6(\u03bar2 ) (0) as \u03b5 \u2192 0. The desired result follows.\n\n\u0003\n\nAcknowledgment. We thank the referees for their careful reading of the manuscript and several\nhelpful suggestions.\n\nReferences\n[Ch91] B. Chauvin. Product martingales and stopping lines for branching Brownian motion. Ann.\nProbab., 19:1195\u20131205, 1991.\n[DLG02] T. Duquesne, J.-F. Le Gall. Random trees, L\u00e9vy processes and spatial branching processes.\nAst\u00e9risque 281. Soc. Math. France, 2002.\n[Dur84] R. Durrett. Brownian motion and martingales in analysis. Wadsworth, Belmont, 1984.\n[Dy91] E.B. Dynkin. A probabilistic approach to one class of nonlinear differential equations. Probab.\nTh. Rel. Fields, 89:89\u2013115, 1991.\n[Dy93] E.B. Dynkin. Superprocesses and partial differential equations. Ann. Probab., 21:1185\u20131262,\n1993.\n[Eng07] J. Engl\u00e4nder. Branching diffusions, superdiffusions and random media. Probab. Surveys, 4:303\u2013\n364, 2007.\n[Eng08] J. Engl\u00e4nder. Quenched law of large numbers for branching Brownian motion in a random\nmedium. Ann. Inst. Henri Poincar\u00e9 Probab. Stat., 44:490\u2013518, 2008.\n[EdH03] J. Engl\u00e4nder and F. den Hollander. Survival asymptotics for branching Brownian motion in\na Poissonian trap field. Markov Process. Related Fields, 9:363\u2013389, 2003.\n\n23\n\n\f[Eth00] A.M. Etheridge. An introduction to superprocesses. AMS University Lecture Series, Vol. 20,\n2000.\n[EK86] S.N. Ethier and T.G. Kurtz. Markov processes: characterization and convergence. Wiley, New\nYork, 1986.\n[JS87] J. Jacod and A.N. Shiryaev. Limit theorems for stochastic processes. Springer, Berlin, 1987.\n[LG99] J.-F. Le Gall. Spatial branching processes, random snakes and partial differential equations.\nLectures in Mathematics ETH Z\u00fcrich. Birkh\u00e4user, Boston, 1999.\n[LG05] J.-F. Le Gall. Random trees and applications. Probab. Surveys, 2:245-311, 2005.\n[Per02] E.A. Perkins. Dawson-Watanabe superprocesses and measure-valued diffusions. Ecole d'\u00e9t\u00e9 de\nprobabilit\u00e9s de Saint-Flour 1999. Lecture Notes Math., vol. 1781. Springer, Berlin, 2002.\n[SF79] S. Sawyer and J. Fleischman. Maximum geographic range of a mutant allele considered as a\nsubtype of a Brownian branching random field. Proc. Nat. Acad. Sci. USA, 76:872\u2013875, 1979.\n[Szn98] A.-S. Sznitman. Brownian motion, obstacles and random media. Springer, Berlin, 1998.\n[V\u00e9b09] A. V\u00e9ber. Quenched convergence of a sequence of superprocesses in Rd among Poissonian\nobstacles. Stochastic Process. Appl., 119:2598-2624, 2009.\n[V\u00e9r96] L. V\u00e9ron. Singularities of solutions of second order quasilinear equations. Longman, Harlow,\n1996.\nJ.F. Le Gall, D\u00e9partement de math\u00e9matiques, Universit\u00e9 Paris-Sud, 91405 ORSAY C\u00e9dex, France\ne-mail: jean-francois.legall@math.u-psud.fr\nA. V\u00e9ber, CMAP - \u00c9cole Polytechnique, route de Saclay, 91128 Palaiseau Cedex, France\ne-mail: amandine.veber@cmap.polytechnique.fr\n\n24\n\n\f"}