{"id": "http://arxiv.org/abs/1108.1635v1", "guidislink": true, "updated": "2011-08-08T08:56:19Z", "updated_parsed": [2011, 8, 8, 8, 56, 19, 0, 220, 0], "published": "2011-08-08T08:56:19Z", "published_parsed": [2011, 8, 8, 8, 56, 19, 0, 220, 0], "title": "Genetic Draft and Quasi-Neutrality in Large Facultatively Sexual\n  Populations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1108.5751%2C1108.5398%2C1108.3100%2C1108.5082%2C1108.0554%2C1108.5642%2C1108.0179%2C1108.6017%2C1108.1224%2C1108.5562%2C1108.1992%2C1108.6059%2C1108.5778%2C1108.5078%2C1108.1635%2C1108.6263%2C1108.0142%2C1108.4210%2C1108.3747%2C1108.3350%2C1108.3253%2C1108.4095%2C1108.0467%2C1108.5277%2C1108.0251%2C1108.2976%2C1108.3824%2C1108.5278%2C1108.3627%2C1108.5105%2C1108.1711%2C1108.5493%2C1108.5643%2C1108.5815%2C1108.0784%2C1108.5183%2C1108.6035%2C1108.5843%2C1108.1728%2C1108.4114%2C1108.0486%2C1108.1167%2C1108.2827%2C1108.3943%2C1108.6034%2C1108.3019%2C1108.0432%2C1108.3866%2C1108.1769%2C1108.3323%2C1108.5043%2C1108.4686%2C1108.3597%2C1108.3756%2C1108.4302%2C1108.4523%2C1108.4470%2C1108.3143%2C1108.6184%2C1108.2728%2C1108.5404%2C1108.2533%2C1108.0664%2C1108.3340%2C1108.2696%2C1108.6282%2C1108.2237%2C1108.3894%2C1108.2984%2C1108.4607%2C1108.1825%2C1108.4718%2C1108.3573%2C1108.2147%2C1108.3416%2C1108.5990%2C1108.0657%2C1108.1961%2C1108.3947%2C1108.0151%2C1108.2024%2C1108.5569%2C1108.5820%2C1108.6270%2C1108.0826%2C1108.3654%2C1108.2572%2C1108.3596%2C1108.1188%2C1108.5213%2C1108.4515%2C1108.0524%2C1108.4188%2C1108.5780%2C1108.6037%2C1108.3433%2C1108.4421%2C1108.2538%2C1108.0877%2C1108.3919%2C1108.5755&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Genetic Draft and Quasi-Neutrality in Large Facultatively Sexual\n  Populations"}, "summary": "Large populations may contain numerous simultaneously segregating\npolymorphisms subject to natural selection. Since selection acts on individuals\nwhose fitness depends on many loci, different loci affect each other's\ndynamics. This leads to stochastic fluctuations of allele frequencies above and\nbeyond genetic drift - an effect known as genetic draft. Since recombination\ndisrupts associations between alleles, draft is strong when recombination is\nrare. Here, we study a facultatively outcrossing population in a regime where\nthe frequency of out-crossing and recombination, r, is small compared to the\ncharacteristic scale of fitness differences \\sigma. In this regime, fit\ngenotypes expand clonally, leading to large fluctuations in the number of\nrecombinant offspring genotypes. The power law tail in the distribution of the\nlatter makes it impossible to capture the dynamics of draft by an effective\nneutral model. Instead, we find that the fixation time of a neutral allele\nincreases only slowly with the population size but depends sensitively on the\nratio r/\\sigma. The efficacy of selection is reduced dramatically and alleles\nbehave \"quasi-neutrally\" even for Ns>> 1, provided that |s|< s_c, where s_c\ndepends strongly on r/\\sigma, but only weakly on population size N. In\naddition, the anomalous fluctuations due to draft change the spectrum of\n(quasi)-neutral alleles from f(\\nu)\\sim 1/\\nu, corresponding to drift, to\n\\sim1/\\nu^2. Finally, draft accelerates the rate of two step adaptations\nthrough deleterious intermediates.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1108.5751%2C1108.5398%2C1108.3100%2C1108.5082%2C1108.0554%2C1108.5642%2C1108.0179%2C1108.6017%2C1108.1224%2C1108.5562%2C1108.1992%2C1108.6059%2C1108.5778%2C1108.5078%2C1108.1635%2C1108.6263%2C1108.0142%2C1108.4210%2C1108.3747%2C1108.3350%2C1108.3253%2C1108.4095%2C1108.0467%2C1108.5277%2C1108.0251%2C1108.2976%2C1108.3824%2C1108.5278%2C1108.3627%2C1108.5105%2C1108.1711%2C1108.5493%2C1108.5643%2C1108.5815%2C1108.0784%2C1108.5183%2C1108.6035%2C1108.5843%2C1108.1728%2C1108.4114%2C1108.0486%2C1108.1167%2C1108.2827%2C1108.3943%2C1108.6034%2C1108.3019%2C1108.0432%2C1108.3866%2C1108.1769%2C1108.3323%2C1108.5043%2C1108.4686%2C1108.3597%2C1108.3756%2C1108.4302%2C1108.4523%2C1108.4470%2C1108.3143%2C1108.6184%2C1108.2728%2C1108.5404%2C1108.2533%2C1108.0664%2C1108.3340%2C1108.2696%2C1108.6282%2C1108.2237%2C1108.3894%2C1108.2984%2C1108.4607%2C1108.1825%2C1108.4718%2C1108.3573%2C1108.2147%2C1108.3416%2C1108.5990%2C1108.0657%2C1108.1961%2C1108.3947%2C1108.0151%2C1108.2024%2C1108.5569%2C1108.5820%2C1108.6270%2C1108.0826%2C1108.3654%2C1108.2572%2C1108.3596%2C1108.1188%2C1108.5213%2C1108.4515%2C1108.0524%2C1108.4188%2C1108.5780%2C1108.6037%2C1108.3433%2C1108.4421%2C1108.2538%2C1108.0877%2C1108.3919%2C1108.5755&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Large populations may contain numerous simultaneously segregating\npolymorphisms subject to natural selection. Since selection acts on individuals\nwhose fitness depends on many loci, different loci affect each other's\ndynamics. This leads to stochastic fluctuations of allele frequencies above and\nbeyond genetic drift - an effect known as genetic draft. Since recombination\ndisrupts associations between alleles, draft is strong when recombination is\nrare. Here, we study a facultatively outcrossing population in a regime where\nthe frequency of out-crossing and recombination, r, is small compared to the\ncharacteristic scale of fitness differences \\sigma. In this regime, fit\ngenotypes expand clonally, leading to large fluctuations in the number of\nrecombinant offspring genotypes. The power law tail in the distribution of the\nlatter makes it impossible to capture the dynamics of draft by an effective\nneutral model. Instead, we find that the fixation time of a neutral allele\nincreases only slowly with the population size but depends sensitively on the\nratio r/\\sigma. The efficacy of selection is reduced dramatically and alleles\nbehave \"quasi-neutrally\" even for Ns>> 1, provided that |s|< s_c, where s_c\ndepends strongly on r/\\sigma, but only weakly on population size N. In\naddition, the anomalous fluctuations due to draft change the spectrum of\n(quasi)-neutral alleles from f(\\nu)\\sim 1/\\nu, corresponding to drift, to\n\\sim1/\\nu^2. Finally, draft accelerates the rate of two step adaptations\nthrough deleterious intermediates."}, "authors": ["Richard A. Neher", "Boris I. Shraiman"], "author_detail": {"name": "Boris I. Shraiman"}, "author": "Boris I. Shraiman", "arxiv_comment": "Includes supplement as appendix", "links": [{"href": "http://arxiv.org/abs/1108.1635v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1108.1635v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1108.1635v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1108.1635v1", "journal_reference": null, "doi": null, "fulltext": "Genetic Draft and Quasi-Neutrality in Large Facultatively Sexual Populations.\nR. A. Neher\u2217 \u2020 and B. I. Shraiman\u2217\u2021\nKavli Institute for Theoretical Physics,\n\u2021\nDepartment of Physics, University of California, Santa Barbara, CA 91306 and\n\u2020\nMax-Planck Institute for Developmental Biology, T\u00fcbingen, 72070, Germany\n\u2217\n\n(Dated: October 30, 2018)\n\narXiv:1108.1635v1 [q-bio.PE] 8 Aug 2011\n\nAbstract\n\nLarge populations may contain numerous simultaneously segregating polymorphisms subject to natural selection.\nSince selection acts on individuals whose fitness depends on many loci, different loci affect each other's dynamics.\nThis leads to stochastic fluctuations of allele frequencies above and beyond genetic drift - an effect known as genetic\ndraft. Since recombination disrupts associations between alleles, draft is strong when recombination is rare. Here,\nwe study a facultatively outcrossing population in a regime where the frequency of out-crossing and recombination,\nr, is small compared to the characteristic scale of fitness differences \u03c3. In this regime, fit genotypes expand clonally,\nleading to large fluctuations in the number of recombinant offspring genotypes. The power law tail in the distribution\nof the latter makes it impossible to capture the dynamics of draft by an effective neutral model. Instead, we find that\nthe fixation time of a neutral allele increases only slowly with the population size but depends sensitively on the ratio\nr/\u03c3. The efficacy of selection is reduced dramatically and alleles behave \"quasi-neutrally\" even for N s \u001d 1, provided\nthat |s| < sc , where sc depends strongly on r/\u03c3, but only weakly on population size N . In addition, the anomalous\nfluctuations due to draft change the spectrum of (quasi)-neutral alleles from f (\u03bd) \u223c \u03bd \u22121 , corresponding to drift, to\n\u223c \u03bd \u22122 . Finally, draft accelerates the rate of two step adaptations through deleterious intermediates.\nIntroduction\n\nThe genetic diversity of a population is determined by mutation, selection, recombination and genetic drift, i.e. the\nstochasticity inherent in reproduction. Understanding how genetic diversity depends on these elements of evolutionary\ndynamics is central to population genetics, since it allows to make inferences about the past history and to predict\nhow rapidly populations can adapt.\nPopulation genetic inference focuses on the diversity at putatively neutral sites and assumes that the history of these\nsites is described by the neutral \"coalescent\" (Kingman 1982). Coalescent theory models the genealogy of asexual\norganisms or non-recombining segments of a genome by positing that lineages merge at random, backwards in time,\ndue to common ancestry. Under this assumption, the mean time to the most recent common ancestor, TC , of the\nextant N individuals, is 2N generations. The coalescence time scale is very important, since the genetic diversity of\nthe population is given by the number of mutations that occur in all lineages descending from the most recent common\nancestor of the population. Genetic diversity is therefore controlled by TC and hence, under the assumption of neutral\nevolution, proportional to N . (Coalescent theory has been extended to weak selection (Krone and Neuhauser\n1997) and recombination (Griffiths and Marjoram 1996; Hudson 1983).)\nHowever, the prediction that neutral genetic diversity is proportional to N is at odds with observations: population\nsizes of different organisms differ by many orders of magnitude, while genetic variation among organisms is fairly\nconstant (Lewontin 1974). To resolve this 'paradox of variation', Maynard Smith and Haigh (1974) suggested\nthat selection acting on linked loci might reduce diversity at a neutral locus. Rapid fixation of a novel mutation at a\nlinked locus will perturb the allele frequencies. These perturbations can bring alleles to fixation and, more generally,\nreduce the coalescence time and hence the average genetic diversity (Barton 1998; Gillespie 2001; Kaplan et al.\n1989). Such \"hitch-hiking\" of neutral alleles on linked selected loci will dominate over genetic drift in large populations.\nSince hitch-hiking leads to larger perturbations for more closely linked loci, one expects genetic variation to correlate\nwith the recombination rate, as is indeed observed in Drosophila (Andolfatto and Przeworski 2001; Begun and\nAquadro 1992; Sella et al. 2009; Stephan and Mitchell 1992).\nA related effect was described earlier by Hill and Robertson (1966), who studied the reduction in the fixation\nprobability of a novel beneficial mutation because of selection acting at a linked locus. This effect is commonly known\nas Hill-Robertson interference (Felsenstein 1974). Hitchhiking and Hill-Robertson interference are different aspects\nof the same phenomenon, one focusing on the effects of linked selection on genetic diversity, the other on the efficacy\nof selection. While hitchhiking and Hill-Robertson effects are primarily associated with positive selection for novel\n\n\f2\nalleles, purifying selection against deleterious mutations also affects genetic diversity. The elimination of (neutral)\nalleles linked with deleterious mutations is known as background selection. The lower the recombination rates are,\nthe larger is the target for linked deleterious mutations, resulting in stronger background selection (Charlesworth\net al. 1993; Hudson and Kaplan 1995; Nordborg et al. 1996).\nMost models used to study Hill-Robertson and hitch-hiking effects between positively selected mutations consider\nonly two loci. Deleterious mutations, however, are expected to be much more frequent, and background selection\nmodels typically consider many mutations with small deleterious effects. A systematic study of the effect of interference between many weakly selected sites in a mutation/selection/drift equilibrium was presented by McVean and\nCharlesworth (2000), who used computer simulations of a model of codon bias evolution. They showed that linkage\ndependent interference between a large number of weakly selected sites has substantial effects on genetic diversity,\nfixation probability of mutations and the degree of adaptation measured as the frequency of preferred codons. This\nand subsequent computational studies reinforced the understanding that the Hill-Roberson effect reduces the effectiveness of selection and made clear that a quantitative understanding of Hill-Robertson effects in multi-locus systems\nrequires an analysis that goes beyond two locus models (Comeron and Kreitman 2002; Seger et al. 2010), see\n(Comeron et al. 2008) for a recent review.\nIt is common to interpret the effect of linked selection in terms of increased variance in offspring number. In this\ninterpretation, linked selection can be thought of as a stochastic force analogous to genetic drift and is often referred\nto as genetic draft \u2013 a term coined by Gillespie (2000). Following Hill and Robertson (1966) and Felsenstein\n(1974), the increased variance in offspring number is often captured by a reduction in the \"effective population\" size,\nNe , in a neutral model (which means enhanced drift and accelerated coalescence). It has, however, been noted that\na rescaled neutral model does not consistently explain all observables (Barton and Etheridge 2004; Braverman\net al. 1995; Charlesworth et al. 1993; Fay and Wu 2000; McVean and Charlesworth 2000; Seger et al. 2010),\nand that different effective population sizes need to be defined depending on the question and time scale of interest\n(Ewens 2004; Karasov et al. 2010). Furthermore, the dependence of Ne on the actual population size and other\nrelevant parameters is not understood (Gillespie 2000; Lynch 2007; Wiehe and Stephan 1993).\nHere, we provide analytic results on the effect of draft in a stochastic multi-locus evolution model. Instead of a\nmutation/selection equilibrium considered in McVean and Charlesworth (2000), our focus here is a continuously\nadapting and facultatively sexual population, like HIV in coevolution with the host's immune system. Our model\nand its relation to the biology of HIV are described in more detail below. The scope of the model, however, extends\nbeyond HIV and is equally applicable to scenarios where background selection is dominant. Many important and well\nstudied organisms such as influenza, yeast and plants are facultatively sexual. Rice, for example, is a partly selfing\nspecies and strong selection has acted during its domestication (Caicedo et al. 2007). While dominance effects can\nrender the selfing of diploid organisms more complicated than facultatively sexual propagation of haploid organisms\n(Charlesworth et al. 1991; Kelly and Williamson 2000), our analysis should still provides a null model on top\nof which dominance effects can be investigated.\nUsing computer simulations of an adapting population, we first demonstrate how quantities such as the coalescence\ntime, the fixation probability of beneficial or deleterious mutations, as well as the allele frequency spectra, depend on\nthe rate of outcrossing relative to selection. We also show that our in silico observations cannot be described by a\nneutral model with a reduced effective population size. This is because single genotypes can, through clonal expansion,\ngive rise to a wildly fluctuating number of recombinant genotypes. The distribution is so broad, that its variance\ndiverges, which in turn makes an effectively neutral diffusion limit impossible. To provide an analytic understanding\nof the simulation results, we use a branching process model that allows us to study the stochastic dynamics of\nnovel mutations (neutral, beneficial and deleterious) as they spread through the population. We calculate fixation\nprobabilities and the typical time to fixation, Tf ix , (and more generally, the probability of attaining n copies after\ntime T ) for a new mutant allele, making explicit the dependence on the rate of recombination, fitness variance and\nthe population size. An important consequence of genetic draft is a qualitatively different frequency spectrum of rare\nalleles, which we also calculate analytically. Finally, we will show that empirical HIV allele frequency spectra are in\nagreement with our theoretical prediction, confirming the relevance of our model to the dynamics of HIV adaptation.\n\nModel\n\nOur model is inspired by the intra-patient evolution of HIV. We will first outline briefly the biology of HIV, and then\ndescribe our computational model and the branching process approximation used to study the phenomena analytically.\n\n\f3\nIntra-Patient evolution of HIV\n\nAfter successful infection, the virus proliferates quickly to levels of more than 106 viral genomes per milliliter blood.\nThis acute phase lasts for several weeks, after which the immune system of the host reduces the number of viral\ngenomes per milliliter blood to roughly 100 \u2212 104 . The following chronic infection can last for many years and is\nlargely asymptomatic up to the onset of AIDS. However, even in the chronic phase of infection the total number of\nviruses produced per day is estimated to be \u223c 1010 per ml, while the generation time is roughly two days (Markowitz\net al. 2003; Perelson et al. 1996). The viral population is subject to clearance by cytotoxic T-lymphocyte (CTL)\nmediated cell death and anti-body mediated destruction of virus (Paul 2008), which puts the virus under constant\nselection to change its proteins. CTL epitopes are found throughout the HIV genome (Korber et al. 2007) and escape\nmutations are often selected for with coefficients of a few percent per generation (Asquith et al. 2006). Antibodies\nbind primarily to the products of the envelope gene. In response to antibody recognition, numerous escape mutants\narise in the envelope gene and spread through the population driven by selection coefficients of one to a few percent\n(Neher and Leitner 2010; Williamson 2003). Additional, even stronger, selection pressure is put on the viral\npopulation by drug treatment, resulting in rapid emergence of resistance during suboptimal therapy (Hedskog et al.\n2010; Larder et al. 1989). Several hundred mutations are implicated in drug resistance (Rhee et al. 2003).\nHIV carries two copies of its RNA genome (104 bps), from which one cDNA is produced and integrated into the\nhost cell genome. Recombination in HIV occurs through frequent template switching of the reverse transcriptase in\nthe process of cDNA (Levy et al. 2004) production. In other words, the two genomes of the \"diploid\" virion are\ncombined to produce a \"haploid\" cDNA, from which all the viral proteins and the next generations genomes are\nproduced. The rate of recombination is limited by co-infection of host cells with several viruses, which is necessary\nto produce a heterozygous virus (see Figure 1A). Estimates suggest an effective recombination rate of \u2248 1.5 \u00d7 10\u22125\nper base per generation (Neher and Leitner 2010), corresponding to a co-infection rate \u2264 10%. Viruses therefore\nundergo clonal amplification most of the time, while different parts of the genome are only weakly linked in the event\nof \"outcrossing\" (heterozygote formation, followed by template switching).\n\nComputational model\n\nBased on the discussion above our model must include the following elements: a large population, selection at many\npolymorphic loci, a constant supply of beneficial mutations, and facultative mating with substantial reassortment in\ncase of outcrossing. Models combining all of these elements have already been established in (Neher et al. 2010;\nRouzine and Coffin 2005, 2010) and a similar model will be used here. In our simulation a (nearly) constant\nvariance of fitness in the population, \u03c3 2 , is maintained by a constant supply of beneficial mutations. This results in a\ncontinuously adapting population, with a rate of adaptation given approximately by the variance in fitness. Of course,\none does not expect constant selection to persist indefinitely (see (Mustonen and L\u00e4ssig 2010) for a discussion of\nevolution in changing environments): steady conditions on the time scale of fixation of a single allele would suffice for\nthe validity of our analysis.\nTo simulate population dynamics with the ingredients described above, we implemented a discrete time (FisherWright) dynamics of individuals with haploid genomes and a large number of loci which additively define the (log)fitness x of an individual. Each individual contributes a Poisson distributed number of gametes to the next generation\nwith mean exp(x \u2212 x\u0304 \u2212 \u03b1), where x\u0304 is the current mean fitness and \u03b1 is adjusted to keep the population size\napproximately constant at N . To implement facultative mating, a fraction r of the gametes are paired at random, the\nalleles at all of their loci reassorted, and the two resulting recombinant offspring are placed into the next generation.\nThe remaining 1 \u2212 r fraction of gametes is placed unchanged into the next generation. New beneficial mutations with\neffect size s0 (N s0 \u001d 1) are introduced into a randomly chosen individual at rate N Ub \u001d 1. After equilibration,\nthe fitness distribution in the population is approximately Gaussian with a nearly constant variance and steadily\nincreasing mean fitness. Into this adapting population wave, we introduce additional mutations, neutral, deleterious\nor beneficial, and track their dynamics. In particular, we record after what time these mutations reach certain\nfrequency thresholds and the fitness of genotypes on which successful mutations originate. We also measure the allele\nfrequency spectra and the cumulative number of individuals that carried a particular mutation before it goes extinct.\nA further, and more detailed, description of the implementation is given in Appendix B.\nOur focus here is on rapidly adapting populations with many concurrent sweeps responsible for the fitness variance\n\u03c3 2 . HIV, as any other organism, also suffers from deleterious mutations which vastly outnumber the beneficial\nmutations. Deleterious mutations also contribute to fitness variation and increase \u03c3 2 . For the present investigation,\nit does not matter whether fitness variation is due to sweeping beneficial mutations, deleterious mutations subject to\npurifying selection, or a combination of the two. The two extreme scenarios are illustrated in Fig. 1B. We shall see\nthat the fate of novel mutations depends on how the fitness of clones changes with respect to the mean fitness of the\n\n\f4\npopulation. It is irrelevant whether this fitness difference decreases because the mean fitness increases, or because the\nfitness of the clone decreases due to deleterious mutations.\n\nA\n\nmultiply infected host cell\n\nrecombinant cDNA\n\n\"heterozygote\" virus\n\nB\n\nrecombinant virus\n\nmean fitness\nselection\n\nhost adaptation\nor\ndel. mutations\n\nFitness\nFIG. 1 Panel A illustrates the process of recombination in HIV. Diversifying recombination occurs only in \"heterozygote\"\nvirions, which require multiple infections of the host cell in the previous generation. This is rare, leading to an effectively\nfacultative sexual population. Panel B illustrates the dynamics of the fitness distribution. Selection and mutation are shown\nas separate steps, for simplicity. Selection, acting between the left and center panel, results in a shift of the fitness distribution\ntowards higher fitness. In a deleterious mutation/selection balance, this increase in fitness is compensated by deleterious\nmutations occurring during the step leading from the center to the right panel. If deleterious mutations are not the dominant\nforce, but continuous adaptation to a coevolving host is modeled, the adaptation of the host counter balances the fitness advance\nof the population.\n\nMathematical model\n\nTo understand the results of the computer simulations, we analyze analytically an idealized model, which describes\nthe propagation of a new allele (under selection, drift and occasional recombination onto a different genetic background) within a population with a fitness distribution approximated by a Gaussian traveling wave. This is justified\nif many beneficial mutations are sweeping through the population at the same time (which requires N Ub \u001d 1 and\nis true for HIV) and is supported by our numerical simulations. Gaussian fitness distributions are expected in large\nasexual populations (Desai and Fisher 2007; Rouzine et al. 2003; Tsimring et al. 1996) and in the context of\nbackground selection (the deterministic equilibrium distribution in case of multiplicative selection is Poisson (Haigh\n1978), which is well approximated by a Gaussian in the limit of interest). Recombination stabilizes the Gaussian\nform if outcrossing rates are much larger than the inverse of the coalescence times (Cohen et al. 2005; Rouzine and\nCoffin 2005), see Fig. S1 in the supplement. Selection moves this Gaussian distribution towards higher fitness at a\nrate v equal to the variance in fitness \u03c3 2 (Fisher's \"Fundamental Theorem\" of natural selection).\nBranching process approximation. The fate of a novel allele is decided mainly at early times when the allele is rare\nand the finite population size constraint can be neglected. In this case the dynamics of the novel allele is governed by\na stochastic branching process which in addition to the birth/death events also accounts for the recombination process\nwhich transfers the novel allele to different genetic backgrounds with different fitness x0 (Barton 1995a; Neher et al.\n2010). Within the branching process approximation the probability of finding n copies of the allele (with effect s on\nfitness) anywhere in the population at time T , given that there were k copies on background genotypes with fitness\n\n\f5\nx at time t, obeys the equation (see Supplement)\n\u2212\u2202t p(n, T |k, t, x) = \u2212 k(B + D + r)p(n, T |k, t, x) + kBp(n, T |k + 1, t, x) + kDp(n, T |k \u2212 1, t, x)\nXZ\n+ rk\ndx0 Kxx0 p(n \u2212 n0 , T |k \u2212 1, t, x)p(n0 , T |1, t, x0 ) ,\n\n(1)\n\nn0\n\nwhere B = 1 + x \u2212 x\u0304(t) + s is the birth rate, D = 1 the rate at which individuals die (used to set the unit of\ntime), and r is the outcrossing rate. The first term describes the probability flux out of state (k, t). The second term\ncorresponds to a birth, which happens with rate kB and in which case the final state (n, T ) is reached with probability\np(n, T |k + 1, t, x). Analogously after a death, the probability of reaching (n, T ) is p(n, T |k \u2212 1, t, x). The last term\ndescribes the process of outcrossing with the offspring fitness distribution parameterized by a recombination function\nKxx0 , which depends on the details of the model.\nIn a model of outcrossing where offsprings are produced by mating two individuals at random and re-assorting all\nof their genes, the recombination kernel Kxx0 , after averaging over the mating partner, is given by\nKxx0 =\n\nr\n\n0\n\nx\u2212x\u0304(t)\n2\n\n2 \u2212 2(x \u2212x\u0304(t)\u22122\n3\u03c3\ne\n3\u03c0\u03c3 2\n\n)\n\n2\n\n(2)\n\nIn this model, known as the infinitesimal model, the fitness distribution of the offspring fitness is centered around half\nthe fitness of the parent carrying the focal allele, measured relative to the instantaneous mean fitness x\u0304(t) (Barton\n2009; Bulmer 1980) (the model was referred to as the full recombination model in (Neher et al. 2010)). (Note\nthat the variance of offspring fitness relative to parental mean is \u03c3 2 /2. The variance of 3\u03c3 2 /4 in Eq. (2) is the\nresult of averaging over the mate.) We assume that individuals are polygamous, i.e. each offspring is the result of an\nindependent mating event.\nFor most of the analytic calculations, we employ an even simpler recombination model, where offspring fitness is\nsimply a random sample from the population, independent of the parents.\nKxx0 = \u221a\n\n1\n2\u03c0\u03c3 2\n\ne\u2212\n\n(x0 \u2212x\u0304(t))2\n2\u03c3 2\n\n(3)\n\nIn this communal recombination model new offspring are assembled from the genetic diversity in the entire population,\ni.e. the novel genotype is drawn from a product distribution with the current allele frequencies in the population\n(Barton 2009; Neher et al. 2010). Note, however, that this model does not lead to instantaneous elimination\nof correlations between loci (linkage disequilibrium), since only a fraction of the population outcrosses in a single\ngeneration. The infinitesimal and communal model have been shown to yield very similar results in Neher et al.\n(2010). We will confirm this again by simulation of both models. Even though this model is a drastic idealization, it\nmight resemble rather closely the recombination process in HIV. Since recombination in HIV depends on coinfection\nof T-cells with several viruses, most recombination occurs in centers with high concentrations of virus (Jung et al.\n2002). In these centers, lineages might undergo several successive outcrossing events, effectively producing a cloud of\noffspring that contain genetic material from a large number of parents.\n\nResults\nSimulation results\n\nFigure 2 shows simulation results for the fixation time of neutral mutations and the fixation probability of beneficial\nand deleterious mutations for populations of different size and different outcrossing rates. At low r/\u03c3, fixation times\n(Panel A) are reduced by orders of magnitude below the neutral expectation of 2N and reach the latter only for r/\u03c3 is\nwell above one, an effect already observed in Charlesworth et al. (1992). The scaling of the data in panel A reveals\nthat fixation times are not proportional to the population size at low r/\u03c3, in which case the curves would lie on top\nof each other. Genetic draft has an equally dramatic effect on the efficacy of selection, which is shown in Fig. 2b.\nThe fixation probabilities of beneficial and deleterious mutations are only slightly perturbed from N \u22121 if r/\u03c3 < 1,\neven though |N s| ranges up to 80. The fact that genetic draft reduces fixation times and the efficacy of selection is\nof course well known and it is customary to describe this effect by a neutral model with a reduced population size,\ni.e. treating draft as if it were just an enhancement of genetic drift. This, however, is often not appropriate, as draft\ncauses fluctuations of a very different nature from that of genetic drift. To illustrate the problem, we define 2Ne as the\nfixation time of neutral mutations Tf ix . With this definition, a mutation with effect size s should fix with probability\n\n\f6\nsTf ix\n.\nN (1\u2212e\u2212sTf ix )\n\nHowever, the observed fixation probability does not follow this expectation if r \u2264 \u03c3, as shown in Fig. 3a\n\n(note the logarithmic scale).\nAnother striking feature where a neutral model with a reduced effective population size fails to capture the effects\nof draft is the allele frequency spectrum, shown in Fig. 3b for various ratios of r/\u03c3. For small r/\u03c3, the frequency\nspectrum f (\u03bd) of neutral alleles falls off much more rapidly than the prediction of the diffusion theory: it decays as\n\u03bd \u22122 with frequency instead of \u03bd \u22121 . This effect is often referred to as \"excess of rare variants\" (Braverman et al.\n1995), but would, in fact, more aptly be called a \"lack of common variants\". Very similar dependencies of the fixation\ntime, fixation probabilities, and allele frequency spectra on r/\u03c3 are observed if fitness variation is not due to multiple\nselective sweeps but due to purifying selection. Simulation results for such a background selection scenario are shown\nin the supplementary figures S2 and S3.\nA\n\nB\n102\n\n101\n\nN = 1000\nN = 2000\nN = 4000\nN = 8000\nN = 16000\nN = 32000\nN = 64000\nneutral coalescent\n\n10\u22121\n\n10\u22122\n\n10\u22121\n\n100\n\nN pf ix\n\nTf ix/N of neutral mutations\n\n100\n\ns = \u22120.005\ns = \u22120.0025\ns = \u22120.001\ns = 0.0\ns = 0.001\ns = 0.0025\ns = 0.005\n\n100\n\n10\u22121\n\n101\n\n10\u22122 \u22121\n10\n\nr/\u03c3\n\n100\n\n101\n\nr/\u03c3\n\nFIG. 2 Genetic draft dramatically reduces fixation times and the efficacy of selection. Panel A) shows mean fixation times Tf ix\nof neutral mutations, normalized by the populations size N , as a function of r/\u03c3 for different N . For r/\u03c3 < 1, Tf ix increases\nonly slowly (sublinear) with N . Panel B) shows the fixation probability of beneficial and deleterious mutations relative to that\nof neutral mutations. Even though |N s| > 50, fixation probabilities are close to N \u22121 at low outcrossing rates. (N = 16000)\n\nTo rationalize the observed behavior we solved analytically a simplified branching process model describing the\ndynamics of alleles in an adapting population; compare Mathematical model. This branching process solution shows\nexplicitly how observables depend on population parameters and elucidates the difference between draft and drift.\n\nAnalytic results for the branching process model\n\nThe key to understanding the qualitatively different behavior at low r/\u03c3 compared to r/\u03c3 \u001d 1 is the fact that\ngenotypes with fitness x can expand clonally if x \u2212 x\u0304 \u2212 r > 0, i.e. if their growth rate exceeds the rate at which they\noutcross. In contrast to the case of r/\u03c3 \u001d 1, for r/\u03c3 \u2264 1 the condition for clonal expansion is fulfilled for a substantial\nfraction of the genotypes in a finite population. A genotype establishes with probability x \u2212 r (setting x\u0304(t0 ) = 0) and\nis clonally amplified so that its copy number subsequently grows as\nn(T, x) \u2248\n\n1 (x\u2212r)T \u2212\u03c32 T 2 /2\ne\nx\u2212r\n\n(4)\n\nRT\nwhere T is the time since establishment (Desai and Fisher 2007). The term \u03c3 2 T 2 /2 = 0 dtx\u0304(t) accounts for the\nincreasing mean fitness, x\u0304(t) = \u03c3 2 T , of the rest of the population, competing with the clone. After establishment, a\nfit genotype therefore gives rise to a clone whose size has aR Gaussian profile in time, as illustrated in Fig. 4a. During\n\u221e\nits lifetime, an individual clone spawns an average of \u03be = r 0 dt n(t) recombinant genotypes. For x \u2212 r \u001d \u03c3 one finds\n(x\u2212r)2\n\n\u03be \u2248 \u03c3(x \u2212 r)\u22121 e 2\u03c32 , which increases rapidly with increasing x \u2212 r. In the Discussion, we will develop this intuition\ninto a simplified model of the genealogy of clones. Fig. 4b shows the copy number of the mutant allele on different\ngenetic backgrounds as a function of time in the continuous time branching process model. The observed stochastic\ntrajectory shows the features embodied in the simplified effective model: An anomalously fit genotype gives rise to\nmany recombinant offspring genotypes, resulting in large fluctuations in the copy number of the mutant allele.\n\n\f7\n\nA\n\nB\n102\n\n104\n103\n102\n\nf (\u03bd), s = 0.0\n\nN pf ix\n\n101\n\n100\n\n101\n100\n10\u22121\n\nr/\u03c3 = 0.6\n\n10\u22123\n\nr/\u03c3 = 6.4\n10\u22122\n\u221210\n\n10\n\nTf ixs/(1 \u2212 e\u2212Tf ixs)\n0\n\n10\n\n20\n\nTf ix s\n\n30\n\n40\n\n50\n\nr/\u03c3 = 0.2\nr/\u03c3 = 0.4\n\n10\u22122\n10\u22121\n\nr/\u03c3 = 0.0\n\n\u22124\n\n10\u22125 \u22124\n10\n\nr/\u03c3 = 0.6\nr/\u03c3 = 1.0\nr/\u03c3 = 1.6\nr/\u03c3 = 3.2\n10\u22123\n\n10\u22122\n\n\u03bd\n\n10\u22121\n\n100\n\nFIG. 3 Fixation probabilities and allele frequency spectra are inconsistent with a neutral model with reduced effective population\nsize. Panel A) shows the rescaled fixation probability N pf ix of mutations with effect size s as a function of Tf ix s, where Tf ix is\nthe fixation time of neutral mutations. In a neutral model, Tf ix = 2N , hence it seems sensible to define an effective populations\nsize Ne = Tf ix /2. The fixation probability of a mutation in a neutral model is indicated as black solid line. While the effective\nneutral model describes pf ix well for r/\u03c3 = 6.4, it fails for r/\u03c3 = 0.6 (note the log scale). Panel B) shows the distribution of\nderived allele frequencies f (\u03bd) in a population of N = 32000 individuals for different r/\u03c3. For r/\u03c3 < 1, allele frequency spectra\nfall off much more steeply than the prediction f (\u03bd) \u223c \u03bd \u22121 of the neutral model. In fact, the distribution falls off more like\nf (\u03bd) \u223c \u03bd \u22122 , which is the leading behavior predicted by Eq. (8). All curves are normalized to unit area and the two power laws\nare indicated by straight lines.\n\n%\"&'$((\n\n!\"#$\n\n%\"&'$(()*\"(&+\",-&\".'\n\nFIG. 4 Clonal expansion results in large fluctuations. Panel A: A clone with high initial fitness can grow to large numbers\nbefore going extinct. Large clones give rise to many recombinant daughter clones. Panel B shows a corresponding trajectory\nobtained by simulation of the branching process equation, see Model. The mutant allele originated on a background with fitness\nx \u2212 x\u0304(t) = 2\u03c3 at time t = 0. Each subclone of the population appears as a vertical line whose horizontal position indicates its\nfitness x. The size of a clone (color coded) rises as long as x \u2212 x\u0304(t) \u2212 r > 0 and shrinks after the population wave has passed.\nThe larger a subclone, the more daughter clones it produces. The mean fitness x\u0304(t) as well as x\u0304(t) \u00b1 3\u03c3 are indicated as white\nlines.\n\n\f8\nThe dynamics of the distribution p(n, T |x) of a mutant allele, given that it arose on a genotype with fitness\nx (k = 1, t = 0), can be described by the branching process defined in Eq. (1). We will proceed by analyzing the\nfixation probability, the typical time to fixation, and the allele frequency spectra for neutral, beneficial and deleterious\nmutations for the case r/\u03c3 \u2264 1. In the opposite limit of rapid outcrossing, the effect of selection during the life time\nof a genotype is small and Eq. 1 can be analyzed perturbatively in \u03c3/r. This perturbation analysis was performed\nin (Neher et al. 2010). It was shown that the fixation probabilities of beneficial mutations are reduced by a factor\n1 \u2212 \u03b1\u03c3 2 /r2 , where \u03b1 is numerical factor of order one and depends on the details of the recombination model. This is\nconsistent with the classical argument of Robertson (1961) showing that the cumulative effect of draft is proportional\nto the square of the degree of linkage (Barton 2009; Santiago and Caballero 1998). The analysis and derivation\nof the results is mainly relegated to the appendix: here we present and discuss the results.\n\nExtinction and survival of neutral mutations\n\nThe fundamental quantity describing the stochastic dynamics of an allele is the distribution, p(n, T ), of the number\nof copies that exist T generations after the founding mutation. Note that the mutation could have arisen on genotypes\nwith different background fitness x, and p(n, T ) is the average over all possible x at time T = 0. Of particular\nimportance is the survival probability PS (T ) = 1 \u2212 p(0, T ). Fig. 5 shows PS (T ) for a neutral mutation for different\noutcrossing rates in the communal recombination model, obtained by a numerical solution of Eq. (C6). Initially,\nPS (T ) decays as (1 + T )\u22121 , regardless of the outcrossing rate. This is the same behavior seen in homogenous or\ncompletely neutral populations. Selection on the heterogenous backgrounds starts influencing the fate of the allele at\ntimes T > \u03c3 \u22121 , i.e. the reciprocal of the typical selection differentials in the population. After this initial transient,\nthe survival probability depends strongly on the relative magnitude of the outcrossing rate and the fitness variance in\nthe population, decaying faster for smaller r/\u03c3. We show in the Appendix (Eq. (C12) and Appendix A.2), that the\ntime dependence of the survival probability is given by\n(\n\u221a\n2\n3 \u22122\n\u03c32\n\u03c3e\u2212 2r2 log (r \u03c3 T ) \u03c3/ log N < r < \u03c3\nPS (T ) \u223c\n(5)\n(1 + T )\u22121\nr\u001d\u03c3\nConsistent with our previous argument, we find that for r \u001d \u03c3 neutral mutations are unaffected by selection on the\nbackground, reproducing the familiar result PS (T ) \u223c T \u22121 . However, a strong deviation from this neutral behavior\noccurs as soon as r/\u03c3 approaches one. In the regime with r < \u03c3, the ratio r/\u03c3 enters the dynamics of PS (T )\nas a prefactor of log2 T in the\n\u221a exponent, resulting in faster extinction at lower r. (Yet another regime appears at\neven smaller r for r/\u03c3 < 1/ log N and is discussed in the Supplement). Eq. (5) was derived using the communal\nrecombination model. In Fig. 8 we show, via simulation of the branching process, that the infinitesimal model exhibits\nthe same asymptotic dependence on parameters.\n\nDynamics of surviving alleles and fixation times\n\nGiven that a new allele is not lost after T generations, what is the mean number of its copies? The answer to\nthis question is surprisingly simple and will inform us about the scaling of fixation times of neutral alleles. The\nunconditional expected number of copies after time T is obtained by multiplying Eq. 1 by n, summing over n and\naveraging over the distribution of x at T = 0. One finds the simple expression\nhn(T )i = esT ,\n\n(6)\n\nwhich reduces to hn(T )i = 1 in the neutral case. Here, h. . .i denotes the average over p(n, T ), while the overbar\ndenotes the average over the fitness of the founding genotype. Hence, the expected number of copies depends neither\non recombination, nor on the speed of adaptation. It only depends on the intrinsic fitness effect of the novel allele.\nHowever, hn(T )i is a product of the survival probability, times the average n conditioned on survival. For neutral\nmutations, the mean n conditioned on survival is therefore the reciprocal of the survival probability, and when PS (T )\nis of order N \u22121 , a non-extinct allele has reached copy numbers of \u223c N and has essentially fixed. The first passage\ntime, Tf p , to allele frequency \u03bd, i.e. to \u03bdN copies, is given asymptotically by\n(\n\u221a\n\u22121 \u221a\n2 log \u03c3\u03bdN\n\u03c3 2 r\u22123 er\u03c3\n\u03c3/ log N < r < \u03c3\nTf p \u223c\n(7)\n\u03bdN\nr\u001d\u03c3\n\n\f9\n\nA\n\nB\n\n100\nT =\u03c3\n\n\u22121\n\nSurvival Probability PS (T )\n\nr/\u03c3 = 0.0\n\nPS (T )\n\nr/\u03c3 = 0.1\nr/\u03c3 = 0.4\n10\u22123\n\nr/\u03c3 = 0.8\nr/\u03c3 = 1.0\n\n10\u22124\n\nr/\u03c3 = 1.6\n\n101\n\n10\u22124\n10\u22126\n10\u22128\n100\n10\u221210\n10\u22121\n10\u221212\n10\u22122\n\nr/\u03c3 = 3.2\n\n10\u221214\n\n(1 + T )\u22121\n10\u22125\n\ns = \u22120.1\u03c3\ns=0\ns = 0.1\u03c3\n\n10\u22122\n\n10\u22121\n\n10\u22122\n\n100\n\n102\n\n103\n\n10\u221216\n\n104\n\n10\u22123 0\n10\n0\n500\n\n101\n1000\n\n102\n1500\n\n2000\n\n2500\n\n3000\n\n3500\n\n4000\n\nTime T [generations]\n\nTime T [generations]\n\nFIG. 5 Survival of novel mutations in the branching process model. Panel A shows the survival probabilities of neutral mutations\nin the communal recombination model for different outcrossing rates as a function of time (obtained through numerical solution\nfor the generating function of the branching process). For large r/\u03c3, the survival probability closely follows the result for a\nsingle neutral locus PS = (1 + T )\u22121 (note the log-log scale). For r/\u03c3 \u2264 1, PS (T ) decays much more rapidly as soon as T \u001d \u03c3 \u22121 .\nPanel B illustrates how an intrinsic fitness effect s affects the survival probability for r/\u03c3 = 0.4 (note the log-linear scale). At\nshort times, beneficial and deleterious mutations behave like neutral mutations. After a crossover time, which depends on s,\nthe survival probability of deleterious mutations continues to decay exponentially with rate s, while the survival probability of\nbeneficial mutations becomes time independent. PS (\u03c4 ) of neutral mutations (s\u0303 = 0) decays to zero with a decreasing rate.\n\nWe see that the time to reach allele frequency \u03bd scales very differently with N in the two regimes. Instead of diffusive\ndynamics with diffusion constant \u223c N \u22121 , the rapid turnover of individuals by selection at r < \u03c3 results in large\nfluctuations, which can propel a mutation rapidly to large numbers. Simulation results confirming the validity of the\nargument that inverse survival probability can be used as a proxy for typical copy numbers, as well as the adequacy\nof modeling allele frequency dynamics by a branching process are shown in Fig. 8.\nA different approach to calculate fixation times in a model of continuous adaptation with facultative out-crossing\nhas been developed in Rouzine and Coffin (2007, 2010). Rouzine and Coffin use a coalescence approach based\non the\n\u221a clonal structure of the population to calculate fixation times and obtain the same exponential dependence on\nr\u03c3 \u22121 2 log N r.\nAllele frequency spectra\n\nIn addition to changing the dependence of the fixation time on the population parameters, draft also results in a\nqualitatively different allele frequency spectrum. This has been noted previously (Braverman et al. 1995; Fay and\nWu 2000; Gillespie 2000; McVean and Charlesworth 2000) but to our knowledge never calculated explicitly.\nFigure 3b shows the distribution of derived neutral alleles frequencies \u03bd = n/N at different outcrossing rates measured\nin individual-based computer simulations. At high outcrossing rates, we observe f (\u03bd) \u223c \u03bd \u22121 as expected for mutations\nsubject to random drift alone. However, when draft is dominant, f (\u03bd) decays more steeply as\n\u22121 \u221a\n\n2 log N \u03bd\u03c3\ner\u03c3\nf (\u03bd) \u223c\n.\n\u03bd 2 log N \u03bd\u03c3\n\n(8)\n\nThis steep decay persists up to a crossover frequency that depends on r/\u03c3 and the population size. Beyond this\ncrossover frequency, the finite population size constraint becomes important. The calculation of the allele frequency\nspectra is detailed in Appendix A.4 and the result of the copy number distribution is given in Eq. (A22).\nThe f (\u03bd) \u223c \u03bd \u22122 behavior can be understood heuristically by considering the sizes of clones containing the allele.\nLet's consider the asexual case with r = 0. To calculate the copy number distribution of a novel allele, T generations\nafter it originated, we have to average over the initial fitness x of the genotype that it could have arisen on. Given that\nthe allele arose on a genetic background with fitness x, its average number after T generations is given by Eq. (4). Since\n2\n2\nwe know that the distribution of x is P (x, 0) = (2\u03c0\u03c3 2 )\u22121/2 e\u2212x /2\u03c3 , we can calculate the expected distribution of n\n\n\f10\n2\n\nlog n\nafter time T within the deterministic approximation of Eq. (4). One finds that p(n, T ) \u223c n\u22123/2 exp(\u2212\u03c3 2 T 2 /8\u2212 2\u03c3\n2 T 2 ).\nThe allele frequency spectrum is an average over alleles of different age, T , and the above expression therefore has\nto be integrated over T , which yields f (n) \u223c n\u22122 . In a facultatively sexual population with r < \u03c3, allele frequency\nspectra are also driven by the clonal expansion of individual genotypes. However, in contrast to the asexual case,\nadditional clones are constantly seeded through outcrossing so that the novel allele resides in many different clones\nof different ages, similar to the average over asexual clones of different ages. For this reason, both the copy number\nspectrum of individual alleles as well as the frequency spectrum averaged over alleles of different ages have a leading\nbehavior p(n, T ) \u223c n\u22122 and f (\u03bd) \u223c \u03bd \u22122 . This reasoning is confirmed by the branching process calculation given in\nthe Appendix A.2.\nIn addition to a much steeper spectrum at low frequencies, the spectra of neutral and deleterious mutations are\nnon-monotonic and increase again at frequencies near one (Fay and Wu 2000). On a linear chromosome with isolated\nsweeps that affect tightly linked neutral variants, this effect is easy to understand: A tightly linked variant is brought\nclose to fixation, resulting in a pile-up of derived variants at frequencies close to one. In our case with many unlinked\nsweeps in a facultatively mating population the effect is less intuitive, but ultimately of similar origin.\n\nSelection efficiency and quasi-neutrality\n\nThe rapid and erratic dynamics of alleles incurred by selection on other loci not only affects the time to fixation, but\nalso the ability of selection to prune deleterious mutations and fix beneficial mutations. Mutations behave essentially\nneutrally, as long as selection on the intrinsic effect of the allele is outweighed by fluctuations. A beneficial mutation\nhas established when it has risen to sufficient numbers that future extinction is improbable and the allele goes to\nfixation deterministically. Without draft, a beneficial mutation is established when it has reached copy numbers of\nabout s\u22121 . With additional fluctuations through draft, however, the allele is more likely to go extinct and has to rise to\nmuch higher numbers to establish. Similarly, draft can propel deleterious mutations to copy numbers they would never\nreach under drift alone. This reduction of the efficacy of selection is a hallmark of Hill-Robertson interference (Hill\nand Robertson 1966) and was mainly studied in obligate sexuals (Barton 1994; McVean and Charlesworth\n2000). Here, we explore these effects in facultative outcrossers.\nSince an allele that has survived longer is likely to be present in more copies, the influence of stochastic fluctuations\nand hence the rate at which the mutant allele goes extinct decreases over time. This is explicit in the time derivative\nof the log survival probability, which in the regime r < \u03c3 is given by (see Appendix A.3)\n\u2202T log PS (T ) \u2248 s \u2212\n\n\u03c3 2 log(r3 \u03c3 \u22122 T )\nr2 T\n\n(9)\n\nThe first term s accounts for the deterministic bias due to the intrinsic effect of the allele, which causes accelerated\nextinction if s < 0 and preferential survival if s > 0, comp. Fig. 5b. The second term accounts for the stochastic forces\non the allele, whose importance decreases with T . The time after which the allele's fate is dominated by selection on\nits intrinsic fitness can be roughly determined by equating the two terms in Eq. (9). In the regime of intermediate\noutcrossing rates r < \u03c3, we find this crossover time to be T \u2217 \u2248 \u03c3 2 log(r/s)/r2 s. If fixation of a neutral mutation\noccurs before that time, selection has little effect and the fate of the mutation is dominated by fluctuations until\nfixation. Hence, we find a window of quasi-neutrality for mutations with selection coefficient smaller than sc\n|s| < sc =\n\n\u22121 \u221a\n\u03c3 2 log(r/s)\n2 log \u03c3N\n,\n\u223c re\u2212r\u03c3\n2\nr Tf ix\n\n(10)\n\nwithin which the fixation probability of a mutation is pf ix \u223c N \u22121 . Beneficial mutations with effects larger then\n\u03c3 2 log2 r/s\n\nsc have a chance of fixation pf ix = logrr/s e\u2212 2r2 , as already found in (Neher et al. 2010). Propagation of\ndeleterious mutations with |s| < sc is also dominated by fluctuations, resulting in allele frequency spectra similar\nto neutral mutations. Only for |s| > sc does the allele frequency spectrum f (\u03bd) decay exponentially as expected\nfor deleterious mutations. Fixation of deleterious mutations is exponentially suppressed with pf ix \u223c N \u22121 e\u2212|s|Tf ix .\nSimulation results, qualitatively showing this behavior, are presented in Fig. 2b and 3.\nA related phenomenon is observed in the context of a linear chromosome in the limit where only one sweep affects\na polymorphism at any given time. Barton (1994) showed that a beneficial allele that is subject to many sequential,\nweakly linked interfering sweeps has little chance of fixation if its selection coefficient is below a critical value. The\ncritical value reported by Barton is sc \u223c \u03c3 2 /R, where \u03c3 2 /R is the fitness variance of sweeps per map length. In this\napproximation, the frequency of the focal allele is repeatedly reduced by a factor that depends on the degree of linkage\nand the strength of the interfering sweeps: this results in an effective reduction in the growth rate of the frequency\n\n\f11\nof the focal allele to s \u2212 sc . In the case of numerous concurrent sweeps that we consider, the situation is different\nbecause the focal allele is spread over many different backgrounds subject to selection. The older the allele, the more\nlikely it is to be spread over many backgrounds, attenuating the effect of interference. Hence we find an additional\ndependence of sc on the typical fixation time scale and the extent of recombination that occurs during this time.\nStochastic tunneling and complex adaptations\n\nConsider an adaptation process where two mutations at the same locus are needed to confer a fitness advantage,\nbut either mutation in isolation is neutral or deleterious. The rate of this process is given by the probability per\nunit time that the second mutation occurs in an individual already carrying the first mutation. More generally, the\nprobability that the double mutant genotype never existed up to a time T is\nP (T ) = e\u2212\u03bc\n\nRT\n0\n\ndt(n1 (t)+n2 (t))\n\n,\n\n(11)\n\nwhere \u03bc is the mutation rate and ni (t) is the number of individuals carrying mutation i. The deleterious single\nmutants form a transient subpopulation in the large background population, to which we refer as a mutant \"bubble\".\nThe important quantity determining the rate of such secondary events is the distribution of the cumulative number\nRT\nof single mutants w(T ) = 0 dtn(t), i.e. the integrated bubble size. For homogeneous background populations, where\ngenetic drift dominates the dynamics of neutral alleles, this quantity has been calculated by Iwasa et al. (2004);\nLynch (2010); Weissman et al. (2009, 2010). In most cases of interest the rate of secondary events is small, so that\nthe probability of tunneling in a single bubble is low. Hence tunneling takes longer than the lifetime of a typical\nbubble and only the long time limit of w(T ) is important. In analogy to the results presented above, we calculate the\nmoment generating function \u03a6(z) = he\u2212zw i of the bubble size w, where h. . .i denotes the average over the bubble size\ndistribution P (w). The calculation given in Appendix A.5 yields for the \u03a6(z)\n(\n\u22121 \u221a\n\u22121 \u221a\n\u22122 log z\n\u22122 log z\nzer\u03c3\n|s| \u001c re\u2212r\u03c3\n\u221a\n\u03a6(z) = z\n(12)\n\u2212r\u03c3 \u22121 \u22122 log z\n|s| \u001d re\n|s|\nThe result for strongly deleterious mutations is the same as in homogenous populations (Weissman et al. 2009). The\ncrossover between the two regimes occurs essentially at the quasi-neutrality threshold, with N replaced by z \u22121 . The\ngenerating function \u03a6(z), which is also the Laplace transform of P (w), is of immediate practical relevance, since it is\nexactly the probability that a secondary event with rate z does not occur within a single bubble. From the Laplace\ntransform, we calculate the distribution of P (w), which in the draft dominated regime we find to be\nP (w) \u223c\n\n1\n\u221a\nw2 2 log w\n\n(13)\n\nThe latter has to be compared to the result for drift alone: P (w) \u223c w\u22123/2 . Both of these behaviors are clearly seen\nin the simulation results shown in Fig. 6. Draft causes large neutral bubbles to become rarer, but also dramatically\nenhances the probability of large bubbles for deleterious (quasi-neutral) alleles.\n\nDiscussion\n\nThe importance of hitch-hiking and draft as a source of fluctuations was first discussed by Maynard Smith and\nHaigh (1974) as a possible explanation for the apparent insensitivity of genetic variation on the census population\nsize, dubbed the \"paradox of variation\" (Lewontin 1974). Draft is expected to dominate over genetic drift in\nvery large populations and hence is the factor determining the level of genetic diversity and the efficacy of selection\n(Barton 1995b; Gillespie 2001). It was shown to have appreciable effects on genetic diversity in Drosophila (Sella\net al. 2009). Draft is expected to be even more pronounced in facultatively outcrossing organisms, where alleles stay\nassociated with each other for longer periods of time. Such organisms include many plants, fungi, nematodes, and\nviruses, including the human pathogens influenza and HIV.\nWe have studied draft in continuously adapting facultatively outcrossing populations using direct computer simulation of a model inspired by intra-patient evolution of HIV. We explain the simulation results by analyzing a\nsimplified branching process model, which is amenable to analytic calculations that elucidate how fixation time, the\nefficiency of selection and allele frequency spectra depend on fundamental parameters of the population dynamics.\nThe simplification that makes these analytic results possible is a \"large number\" limit: Due to the large number\n\n\f12\n\n10\u22121\n\n\u223c w\u22121/2\n10\u22123\n\nw\n\nR\u221e\n\ndw0P (w0)\n\n10\u22122\n\nr/\u03c3 = 0.0\nr/\u03c3 = 0.2\nr/\u03c3 = 0.6\nr/\u03c3 = 1.0\n\n10\u22124\n\nr/\u03c3 = 1.6\nr/\u03c3 = 3.2\n\n\u223c w\u22121\n\nr/\u03c3 = 6.4\n10\u22125 2\n10\n\n103\n\n104\n\n105\n\n106\n\nBubble size w\n\nR\u221e\nFIG. 6 The cumulative distribution of \"bubble sizes\", i.e. the integrated copy number w = 0 dtn(t), of deleterious (s =\n\u22120.005) alleles. The simulated bubble size distributions for r/\u03c3 \u001c 1 agree with the predicted behavior P (w) \u223c w\u22122 , which\ncorresponds to a cumulative distribution \u223c \u03c9 \u22121 . For r \u001d \u03c3 the size of bubbles of deleterious alleles is cut off exponentially.\nWhile small bubbles are rarer at r \u001c \u03c3 compared to r \u001d \u03c3, this relation is reversed for large bubbles when the exponential\ncuts below the power law (N = 16000).\n\nof concurrent sweeps, the distribution of fitness in the population assumes a Gaussian form and translates towards\nhigher fitness with constant velocity. If the outcrossing rate, r, is comparable to or smaller than typical fitness differences, \u03c3, between individuals in the population, clonal expansion of genotypes results in a heavy-tailed distribution of\nrecombinant offspring with dramatic effects. In particular, we find that alleles with selection coefficients smaller than\n|sc | = \u03c3 2 log(r/s)/(r2 Tf ix ) behave quasi-neutrally: Their fate is dominated by fluctuations and is nearly independent\nof the intrinsic allele fitness s. Yet because selection acting on the allele is masked not by random drift, but by draft transient associations with chromosomal \"backgrounds\" with different fitness - the behavior is quantitatively different\nfrom true neutrality. The conventional dynamics dominated by genetic drift is realized only in the limit of no linkage\nor complete neutrality (including the background). To emphasize this distinction we refer to the draft dominated\nregime as quasi-neutrality.\nIn addition to a reduced efficacy of selection, draft reduces fixation and coalescence times, which instead of growing\nlinearly with the population size, increases much more slowly. The probability that a given neutral locus is polymorphic\nwith an allele at intermediate frequency is roughly given by the product of the \u221a\nneutral mutation rate, \u03bc, and the\n\u22121\n2 log \u03c3N\ncoalescence time, TC . Hence we expect the neutral diversity \u0398 \u223c \u03bc\u03c3 2 r\u22123 er\u03c3\n. Details of the expected\nheterozygosity, however, depend on the allele frequency spectrum. The latter is also the most informative quantity\nthat can be evaluated\nfrom a static population snapshot. We have shown that in our model, allele frequency spectra\n\u22121 \u221a\n2 log N \u03bd\u03c3\ndecay as \u03bd \u22122 er\u03c3\n, which is much steeper than \u03bd \u22121 predicted by drift. As a consequence, in contrast to the\nclassic neutral theory (Ewens 2004) one should expect the number of polymorphic loci to increase almost linearly\n(rather than logarithmically) with the sample size as one samples the population deeper and deeper.\n\nWhy draft is different from drift\n\nDraft and hitch-hiking is often accounted for by an effective neutral model with reduced population size Ne (Felsenstein 1974; Hill and Robertson 1966). This is possible if draft does not change the offspring distribution qualitatively but only increases its variance. The Central Limit Theorem then guarantees the existence of a meaningful\ndiffusion limit for the allele frequency dynamics with the diffusion constant that could, if one were so inclined, be interpreted as the inverse effective population size. This diffusion limit, however, is not possible in our case since the number\nof recombinant genotypes, \u03be, that descend from a single clone has a very broad distribution with power-law tails and\ndiverging variance. To see this let's consider a genotype seeded by recombination at fitness x \u001d \u03c3 above the mean,\nwhich establishes with probability x \u2212 r. After establishment, its copy number n(t) initially grows almost deterministically, see Eq. (4). Over time, the mean fitness increases such that the growth rate eventually turns negative and the\nR\u221e\n2\n2\ngenotype goes extinct. During its lifetime, the clone produces \u03be(x) \u2248 r 0 dt n(t) \u223c e(x\u2212r) /2\u03c3 recombinant offspring.\n\n\f13\n2\n2 \u221a\nSince the initial fitness x of the genotype is drawn from a Gaussian distribution P (x) = e\u2212x /2\u03c3 /R 2\u03c0\u03c3 2 , the mean\nand second moment of the distribution of the number of recombinant offspring are given by h\u03bei = dxP (x)\u03be(x) = 1\nR\n2\n2\nand h\u03be 2 i = dxP (x)\u03be 2 (x), respectively. While the mean exists, \u03be 2 (x) \u223c e(x\u2212r) /\u03c3 increases so rapildy with x that the\nsecond moment and hence the variance is divergent. Of course, the finite population cuts off the offspring distribution\nand strictly speaking prevents the divergence of the variance. However, this cut-off is on the order of the population\nsize and is irrelevant for the dynamics of rare alleles and the existence of a diffusion limit. Below this cut-off, one\nfinds that the distribution of \u03be behaves asymptotically as\n\u221a\n\u22121\n2 log \u03ber\u03c3 \u22121\ne\u2212r\u03c3\nP (\u03be) \u223c\n.\n(14)\n\u03be2\n\nThe implications of this heavy-tailed distribution of genotypes that descend from a single clone are best understood by\nslight abstraction of the model. Assume for a moment a population dynamics where clones are seeded simultaneously\nand their recombinant offspring only start growing after the last clone of the previous round has died, as illustrated\nin Fig. 4a. This corresponds to an effective discrete generation scheme, only that one generation corresponds to\nthe rise and fall of a genotype, rather than a single individual. Each clone spawns a Poisson distributed number of\nrecombinant genotypes with mean \u03be, where the \u03be are drawn from the heavy tailed distribution P (\u03be). The\u221agenerating\n\u2212r\u03c3 \u22121\n\n\u22122 log(1\u2212\u03bb)\n\n)\nfunction of the distribution of number of recombinant offspring is found to be P\u0302 (\u03bb) \u2248 e\u2212(1\u2212\u03bb)(1\u2212e\n.\nStarting from a single genotype, we calculate the distribution Pn (m) of the number of genotypes carrying the mutant\nallele after n effective generations, which has the generating function\n\nP\u0302n (\u03bb) = 1 \u2212 \u03c6 \u25e6 \u03c6 * * * \u03c6(\u03bb) = 1 \u2212 \u03a6n (\u03bb) ,\n\n(15)\n\nwhere \u03c6(\u03bb) = 1 \u2212 P\u0302 (\u03bb) and \u25e6 denotes functional composition, i.e. f \u25e6 g(x) = f (g(x)). From this result, we derive a\ndifference equation for \u03a6n (\u03bb)\n\u221a\n\u22121\n\u22122 log(\u03a6n (\u03bb)r\u03c3 \u22121 )\n\u03a6n+1 (\u03bb) \u2212 \u03a6n (\u03bb) = \u2212e\u2212r\u03c3\n\u03a6n (\u03bb) ,\n(16)\nwhere it was assumed that \u03a6n (\u03bb) is small. This difference equation is the discrete analog of Eq. (A6), which is\nderived in the appendix for the continuous time model and from which most of our results follow. Thus the dynamics\nof mutations in a rapidly adapting population can be viewed as population genetics of genotypes, rather than of\nindividuals, with a power-law tailed offspring distribution with diverging variance. This feature makes the description\nby an effective neutral Fisher-Wright model impossible, since no diffusion limit exists when increments have such\nlong-tailed distributions. A similar effect occurs in Gillespie's pseudo-hitch-hiking model (Gillespie 2000), where a\nhitch-hiking event can bring an allele to instantaneous fixation.\nCoalescent processes with broad and skewed offspring distributions are an active field of research, see for example\n(Mohle and Sagitov 2001; Schweinsberg 2003). It is known, that broad offspring distributions can result in\nsimultaneous mergers of multiple lineages and have dramatic effects on the time to the most recent common ancestor,\nwhich can increase sublinearly with the population size. Whether and how our interpretation of the adapting population in terms of a coarse grained coalescent corresponds to a known universality class of coalescent models remains to\nbe shown. Coalescent models with broad offspring distributions have been applied to diversity data of pacific oyster\n(Eldon and Wakeley 2006) and our results suggest that they might apply to a larger class phenomena.\nAdaptation vs purifying selection\n\nDiscussions of Hill-Robertson interference typically focus either on the effect of linked beneficial or deleterious alleles:\nThe former is referred to as \"hitch-hiking\" (Kaplan et al. 1989; Maynard Smith and Haigh 1974), the later as\n\"background selection\" (Charlesworth et al. 1993; Nordborg et al. 1996). Our approach addresses the effect of\nvariation in genetic background fitness independent of its origin. Thus, while our analysis was set up in the context\nof continuous adaptation driven by many simultaneous selective sweeps, it is equally applicable to fitness variation\ndominated by deleterious mutations. The balance between deleterious mutations and selection in large populations\ngives rise to a steady Poisson distribution of fitness (Charlesworth et al. 1993; Haigh 1978). If the deleterious\nmutation rate Ud is much larger than the selection coefficient s0 of mutations, the Poisson distribution is very close\nto Gaussian, as in the case of the adapting populations considered here. While the origin of fitness variation is very\ndifferent in these two cases, the effect on the fate of mutations is similar. In the adaptation scenario, a genotype\ncarrying the mutation in questions stays at a certain point along the fitness axis while the mean fitness is increasing.\nWhen deleterious mutations dominate, the mean fitness is constant and set by a mutation selection balance, while\n\n\f14\nthe fitness of asexual offspring of a particular genotype decreases due to accumulating weakly deleterious mutations.\nSince the dynamics is determined by fitness relative to mean fitness, there is little difference between these scenarios\nfrom the point of view of the focal mutation. We have simulated scenarios where fitness variation is due to purifying\nselection and found that the stochastic dynamics of novel mutations in a purifying selection scenario is very similar to\nthe case where fitness variation is due to sweeping mutations. The analogs of Figs. 2 and 3 for background selection\nare shown in the supplementary Figs. S2 and S3.\nIn the asexual case, the most relevant quantity for background selection is the size of the least loaded class\ngiven by N e\u2212Ud /|s0 | , from which all future individuals descend and within which the dynamics is essentially neutral\n(Charlesworth et al. 1993; Haigh 1978). With recombination, beneficial and deleterious mutations can decouple\nfrom each other and individuals in the bulk of the distribution have a chance of contributing to the future population,\nalbeit with a smaller and smaller chance as the distance from the fittest class increases. In the limit of rapid recombination, this effect can be described by a reduction in the effective population, which has been studied by Hudson\nand Kaplan (1995); Nordborg et al. (1996). Our results imply that background selection changes the population\ngenetics more dramatically when the outcrossing rate is small compared to the standard deviation is fitness.\nIn any real-world scenario, there will be contributions to fitness variation from beneficial as well as deleterious\nmutations. In fact, in HIV the fitness variation due to deleterious mutations is expected to be substantial: With\na mutation rate of roughly 0.2 per genome\nreplication (Mansky and Temin 1995) and an average effect size of a\np\nmutation of s0 = \u22120.01, we have \u03c3 = Ud |s0 | \u2248 0.04. The outcrossing rate is of the same order of magnitude (Neher\nand Leitner 2010), so our results are expected to apply for deleterious mutations alone.\nSequential versus multiple sweeps\n\nTo illustrate the applicability of isolated versus multiple sweep regimes of selection we compare sweep frequencies\nin Drosophila and in HIV. Genetic divergence between different Drosophila species suggests a rate of amino acid\nsubstitution of about one every two hundred generations (see (Sella et al. 2009) for review). While these estimates\ncome with a rather large statistical and methodological uncertainty, they nevertheless indicate that sweeps are frequent,\nbut don't interfere. Each sweep \"occupies\" a stretch of \u223c s/\u03c1 nucleotides (\u03c1 is the recombination rate per nucleotide)\non a chromosome for \u223c s\u22121 generations. Since they come in at a rate of 0.005 per generation spread over the total\nmap length, they should on average be far apart: expect on average less than 1% of genome length to be subject to\ndraft at any given time. However, sites under weak selection might still cause substantial Hill-Robertson interference\n(McVean and Charlesworth 2000).\nOn the other hand, the multiple sweep regime is likely to be relevant to organisms with a facultative sexual life\ncycle. In particular pathogens like HIV are under constant selection pressure resulting in a high rate of selective\nsweeps. Selection in HIV evolution is best characterized in the pol gene, the target of most anti-retroviral drugs, and\nin the env gene, the target of neutralizing antibodies. On the order of 100 codons are implicated in drug resistance\n(Chen et al. 2004; Rhee et al. 2003) and several such mutations compete and sweep during the evolution of drug\nresistance in a single patient. The env gene frequently builds up a nucleotide diversity of 3-4% (Shankarappa\net al. 1999), with frequent adaptive amino-acid substitutions (Neher and Leitner 2010; Williamson 2003). The\neffective recombination rate is about 10\u22125 per base and generation(Levy et al. 2004; Neher and Leitner 2010).\nWith typical selection strength of a few percent per generation, the characteristic length of the segment affected by\nthe sweep is about 1kb, which is comparable to the size of the evolving genes: hence the dynamics is in the multiple\nsweep regime. While pol and env genes constitute only a fraction of the HIV genome, cytotoxic T-lymphocyte (CTL)\nepitopes are found throughout the HIV genome (Korber et al. 2007) so that even more sweeps associated with CTL\nescapes are expected (Asquith et al. 2006). In a recent study, Hedskog et al. (2010) characterized the evolution\nof the pol gene of HIV in 6 longitudinally sampled patients during anti-retroviral treatment. Using their data, we\nmeasured the site frequency spectrum of derived alleles, shown in Figure 7. The allele frequency spectrum is indeed\nmuch steeper than expected for neutral evolution and compatible with \u03bd \u22122 , rather than the neutral expectation of\n\u03bd \u22121 . Furthermore, there is little difference between the spectrum of silent and non-synonymous mutations, consistent\nwith our notion of quasi-neutrality. Note, however, that steep allele frequency spectra proportional to \u03bd \u22122 are also\nexpected in expanding populations. While the sequences used in Figure 7 are from chronically infected patients,\nchanges in drug therapy resulted in shrinking and expanding population sizes and the effects of this expansion and\ndraft cannot be disentangled at present.\nIn a recent study, Rouzine and Coffin (2010) present an analysis of adaptation of HIV using a model similar\nto the one used here and in (Neher et al. 2010). Rouzine and Coffin study the problem of selection on standing\ngenetic variation and in addition to the speed of adaptation, they compute the rate of coalescence, which in their\nmodel is controlled by the probability that two individuals in the population are genetically identical, i.e. are part of\nrxmax\nthe same clone. In agreement with our result Eq. (7), they find that the coalescence rate is \u223c e\u2212 \u03c32 , where xmax is\n\n\f15\n\u221a\nthe fitness of the fittest individuals in the population (relative to x\u0304). The quantity xmax corresponds to \u03c3 2 log \u03c3N\nin our Eq. (7). Furthermore, Rouzine and Coffin (2010) study how benefical alleles at low frequency can be lost\ndue to the lack of recombination. Our work complements Rouzine and Coffin (2010), as we study the stochastic\ndynamics of new alleles arising from mutations, rather than the evolution of the fitness distribution, given standing\nvariation. On the other hand, Rouzine and Coffin (2010) account for correlations between loci by allowing the\ndistribution of recombinants to be broader than the population distribution (Rouzine and Coffin 2005)- an effect\nabsent in our model. In the range of recombination rates where our results apply, the latter deviations are small.\n\n103\n\nFrequency distribution, f (\u03bd)\n\nsubstitutions, n=352\nsilent, n=547\n102\n\n101\n\n\u223c \u03bd \u22121\n\n100\n\n\u223c \u03bd \u22122\n\n10\u22121\n\n10\u22122 \u22123\n10\n\n10\u22122\n\n10\u22121\n\nDerived allele frequency, \u03bd\n\n100\n\nFIG. 7 Derived allele frequency spectrum of silent and non-synonymous mutations in the HIV pol gene, aminoacids 180-220\n(Hedskog et al. 2010). The black lines indicates the expectation f (\u03bd) \u223c \u03bd \u22122 with draft and f (\u03bd) \u223c \u03bd \u22121 in absence of draft.\nThe neutral spectrum \u223c \u03bd \u22121 fails to capture the steep decay at low frequencies and fits the data only in an intermediate\nfrequency range. Note, however, that population expansions can give rise to allele frequency spectra similar to those expected\nunder draft.\n\nOur analytic results are derived using a branching process approximation that assumes that the novel allele is a small\nfraction of the total population and the finiteness of the population does not yet affect its dynamics. The influence\nof the finite population size is apparent in Figure 3b, causing deviations from the branching process predictions\nat large frequencies. The branching process approach can be complemented by an effective theory for macroscopic\nfrequencies, similar in spirit to diffusion theory for random drift. This theory, however, has to account for the\nvery broad distribution of clone sizes. Throughout the manuscript, we have assumed that the speed of adaptation is\nidentical to the variance in fitness, i.e. we have assumed that effects on fitness of different mutations are purely additive.\nIf interactions between mutations contribute to fitness, the variance in fitness tends to be larger than the speed of\nadaptation, since coadapted combinations are destroyed by recombination. Including genetic interactions within our\nframework involves decoupling v and \u03c3, as well as changing the recombination functions. Genetic interaction might\nincrease the importance of draft significantly, as interactions have a tendency to result in clonal population structures\nand couple the loci along the genome beyond physical linkage (Neher and Shraiman 2009). Another simplification\nwe have made is to assume that all loci segregate independently in an outcrossing event. Our analysis can be extended\nto account for linear chromosomes by considering a hierarchy of recombination rates for chromosomal segments at\ndifferent distances. These, and other extension are interesting projects, which we leave for future work.\nSeveral large-scale re-sequencing projects are underway with the goal to characterize genetic diversity in populations\nof humans, Drosophila and Arabidopsis at great depth. This upcoming data will allow us to measure allele frequency\nspectra to much greater depth, similar to the example from HIV shown in Figure 7, and reveal the mechanisms\nshaping genetic diversity in natural populations.\n\nAcknowledgements\n\nThe authors acknowledge stimulating discussions with Daniel Fisher and Michael Lynch, thank Sally Otto and Nick\nBarton for a critical reading of the manuscript and thank Jan Albert for providing the HIV polymorphism data prior\nto publication. This research was supported by the National Science Foundation under Grant No. PHY05-51164\n(RAN and BIS), NIH R01 GM-086793 (BIS) and the Harvey L. Karp Discovery Award to RAN.\n\n\f16\nAppendix A: Appendix: Derivation of the results\n\nPTo nanalyze the dynamics of the probability distribution, it is useful to consider the generating function p\u0302(\u03bb, T, t, x) =\nn \u03bb p(n, T |1, t, x). From Eq. 1, one obtains (see Supplement) the following equation for \u03c6(\u03bb, T, t, x) = 1\u2212p\u0302(\u03bb, T, t, x):\nZ\n\u2212\u2202t \u03c6(\u03bb, T, t, x) = r dx0 Kxx0 \u03c6(\u03bb, T, t, x0 ) + (x \u2212 vt + s \u2212 r)\u03c6(\u03bb, T, t, x) \u2212 \u03c62 (\u03bb, T, t, x)\n(A1)\nwith boundary condition \u03c6(\u03bb, T, T, x) = 1 \u2212 \u03bb. The survival probability is given by evaluating \u03c6(\u03bb, T, t, x) at \u03bb =\n0, while the moments and asymptotic behavior of p(n, T, t) are determined by the behavior of \u03c6(\u03bb, T, t, x) in the\nvicinity of \u03bb = 1. We have to solve for \u03c6(\u03bb, T, t, x) in these two limits, which will show up repeatedly below.\nIt is convenient to remove the explicit dependence on the initial condition and the velocity v = \u03c3 2 by rescaling\n\u03c8(T, t, x) = \u03c6(\u03bb, T, t, x)/(\u03c3\u000f) with \u000f = 1 \u2212 \u03bb. The two limits of interest are now \u000f \u001c 1 (\u03bb \u2248 1) and \u000f \u2248 \u03c3 \u22121 \u001d 1\n(\u03bb \u2248 0). After rescaling r\u0303 = \u03c3 \u22121 r, s\u0303 = \u03c3 \u22121 s, and \u03c7 = \u03c3 \u22121 x \u2212 \u03c3T , and \u03c4 = \u03c3(T \u2212 t), Eq. C6 takes the form\nZ\n\u2202\u03c4 \u03c8(\u03c4, \u03c7) = r\u0303 d\u03c70 K\u03c7\u03c70 \u03c8(\u03c4, \u03c70 ) + (\u03c7 + \u03c4 + s\u0303 \u2212 r\u0303)\u03c8(\u03c4, \u03c7) \u2212 \u000f\u03c8 2 (\u03c4, \u03c7) ,\n(A2)\nwhere \u03c8(\u03c4, \u03c7) is the rescaled generating function of the copy number distribution of a mutation that initially occurred\non genome with rescaled background fitness \u03c7. The distribution of rescaled fitness \u03c7 in the population P (\u03c7, \u03c4 ) =\n2\n\u221a1 e\u2212(\u03c7\u2212\u03c7\u0304(\u03c4 )) /2 is Gaussian around the moving mean fitness \u03c7\u0304(\u03c4 ). Averaging Eq. A2 over P (\u03c7, \u03c4 ) yields an equation\n2\u03c0\nR\nfor the scaled generating function \u03a6(\u03c4 ) = d\u03c7P (\u03c7, \u03c4 )\u03c8(\u03c4, \u03c7).\nZ\nZ\n\u2202\u03c4 \u03a6(\u03c4 ) = \u2202\u03c4 d\u03c7P (\u03c7, \u03c4 )\u03c8(\u03c4, \u03c7) = s\u0303\u03a6(\u03c4 ) \u2212 \u000f d\u03c7P (\u03c4, \u03c7)\u03c8 2 (\u03c4, \u03c7)\n(A3)\nFor beneficial mutations, \u03a6(\u03c4 ) approaches a steady state where the two terms on the right balance each other. This\nlong time limit was used as solvability condition in Neher et al. (2010) to determine the fixation probability of\nbeneficial mutations. The steady state is independent of the initial condition \u000f and therefore equals the rescaled\nsurvival probability. However, if s\u0303 \u2264 0, no such steady state exists, since neutral and deleterious mutations have zero\nchance of fixation in an infinite population. To calculate the probability that a mutation reaches n copies after time\n\u03c4 , we need to find the full time dependent solution of Eq. A3. For simplicity, we will use the communal recombination\nmodel throughout and show that the infinitesimal model yields similar results by simulations of the latter. For the\ncommunal recombination model, the recombination contribution in Eq. A2 reduces to r\u0303\u03a6(\u03c4 ).\nIn analogy to Neher et al. (2010), we solve Eq. A2 in the two asymptotic regimes of large positive and large\nnegative growth rate \u03b8 = \u03c7 + \u03c4 + s\u0303 \u2212 r\u0303. For \u03b8 < 0 the non-linearity in Eq. A2 can be neglected since \u03c8(\u03c4, \u03c7) \u001c \u000f\u22121 .\nConversely, at large \u03b8 the dominant balance in Eq. A2 is \u03b8\u03c8(\u03c4, \u03c7) = \u000f\u03c8 2 (\u03c4, \u03c7). The two asymptotic solution are:\n( 2 R\u03c4\n02\nr\u0303e\u03b8 /2 0 d\u03c4 0 \u03a6(\u03c4 0 )e\u2212\u03b8 /2 \u03b8 < \u0398c\n(A4)\n\u03c8(\u03c4, \u03c7) =\n\u03b8/\u000f\n\u03b8 > \u0398c\nThe crossover between the two solutions occurs in narrow region at \u03b8 = \u0398c (\u03c4 ) where \u0398c (\u03c4 ) is approximately the\npoint where the two solutions cross. The evolution of \u03a6(\u03c4 ) is governed by Eq. A3, which has to be self-consisted with\nEq. A4. We will first solve for \u03a6(\u03c4 ) assuming that \u03c4 is large. In this case the dominant contribution to the integral\nin Eq. A4 will come from a well-defined \u03c4 0 \u001d 0 which is determined by the maximum of exp(\u2212\u03b802 /2 + log \u03a6(\u03c4 0 ))\nat \u03c4 0 = \u03c4 \u2212 \u03b8. \u03a6(\u03c4 ) will turn out to change slowly and its time derivative can be neglected when determining the\nmaximum of the exponent. Hence,\n\u03c8(\u03c4 ) \u2248\n\n\u221a\n\n2\u03c0r\u0303\u03a6(\u03c4 )e\n\n\u03b82\n2\n\n(A5)\n\nThis solution is valid below \u0398c (\u03c4 ), where \u03c8(\u03c4 ) crosses over the linear saturated form \u03b8/\u000f. Substituting this solution\ninto Eq. A3 yields\n\u2202\u03c4 \u03a6(\u03c4 ) = s\u0303\u03a6(\u03c4 ) \u2212 r\u0303\u03a6(\u03c4 )e\u2212r\u0303\u0398c (\u03c4 )\u2212r\u0303\n\n2\n\n/2\n\n,\n\n(A6)\n2\n\nWe will first consider neutral mutations, s\u0303 = 0, in which case \u03a6(\u03c4 )\u22121 \u2202\u03c4 \u03a6(\u03c4 ) = \u2212r\u0303e\u2212r\u0303\u0398c (\u03c4 )\u2212r\u0303 /2 , confirming that\nlog \u03a6(\u03c4 ) changes slowly as long as r\u0303\u0398c \u001d 1 (the limit of r\u0303\u0398c \u001c 1 yields qualitatively different answers). Solving\nEq. (A6) for \u0398c (\u03c4 ) and differentiating with respect to \u03c4 yields an equation for \u2202\u03c4 \u0398c (\u03c4 ), which is readily solved for\n\n\f17\n\u0398c (\u03c4 ) in case r\u0303\u0398c \u001d 1\n\u0398c (\u03c4 ) =\n\nlog(r\u03033 (\u03c4 \u2212 \u03c40 ) + er\u0303\u03980 )\n1 + W (r\u03033 (\u03c4 \u2212 \u03c40 )e\u22121 )\n\u2248\nr\u0303\nr\u0303\n\n(A7)\n\nwhere \u03980 is the initial condition at \u03c4 = \u03c40 and W (x) is Lambert's W , i.e. the solution of W (x)eW (x) = x. The\napproximation of W (x) by a logarithm is only accurate at very large time since there are significant log log x corrections.\nThe solution for the rescaled generating function then reads\n\u03a6(\u03c4 ) =\n\nlog2 (r\u0303 3 (\u03c4 \u2212\u03c40 )+er\u0303\u03980 )\n\u0398c (\u03c4 ) \u2212 \u0398c (\u03c4 )2\n2\n2r\u0303 2\ne\n\u223c e\u2212\n\u000fr\u0303\n\n(A8)\n\nwhere the last terms only include the exponential factors. Apart from the rescaling, this solution is independent of\nthe initial condition \u000f. The dependence on \u000f will reemerge through the matching to the short time solution. Note\nthat \u03a6(\u03c4 ) satisfies asymptotically for large \u03c4 :\n\u2202\u03c4 \u03a6(\u03c4 ) \u2248 \u2212\n\nlog(r\u03033 \u03c4 )\n\u03a6(\u03c4 )\nr\u03032 \u03c4\n\n(A9)\n\nwhich means that the relaxation rate of \u03a6 decreases with time, but more slowly than it does in the case of pure drift\n(in the absence of draft), in which case \u2202\u03c4 log \u03a6(\u03c4 ) = \u22121/\u03c4 .\nThe long time solution in Eq. C12 has to be matched to the solution at small \u03c4 where the initial condition cannot\nbe neglected.\n\n1. Short-time solution\n\nTo analyze the short time behavior, it is useful to split \u03c8(\u03c4, \u03c7) = \u03c8r (\u03c4, \u03c7) + \u03c80 (\u03c4, \u03c7) into a contribution fed\nby recombination \u03c8r (\u03c4, \u03c7) and the contribution originating from the initial condition \u03c80 (\u03c4, \u03c7), where \u03c8r (0, \u03c7) is\ninitially zero and \u03c80 (0, \u03c7) = 1. In the communal recombination model, the term describing the production of novel\nrecombinants reduces to r\u0303\u03a6(\u03c4 ) and the two contributions evolve according to:\n\u2202\u03c4 \u03c80 (\u03c4, \u03c7) = \u03b8\u03c80 \u2212 \u000f\u03c802\n\u2202\u03c4 \u03c8r (\u03c4, \u03c7) = r\u03a6(\u03c4 ) + \u03b8\u03c8r \u2212 \u000f(2\u03c80 \u03c8r + \u03c8r2 ) .\n\n(A10)\n\nRecombination enters the equation for \u03c80 only through a reduction of the growth rate and the solution for \u03c80 (\u03c4, \u03c7)\nis simply\n2\n\ne\u03b8 /2\n\u03c80 (\u03c4, \u03c7) = R \u03c4 0 \u03b802 /2\n\u000f 0 d\u03c4 e\n+ e(\u03b8\u2212\u03c4 )2 /2\n\n(A11)\n\nR\nThe integral \u03a60 (\u03c4 ) = d\u03c7P (\u03c7, \u03c4 )\u03c80 (\u03c4, \u03c7) acts as a source for \u03c8r (\u03c4, \u03c7). The initial behavior of \u03a60 (\u03c4 ) is quite different\nfor \u000f \u001d 1 and \u000f \u001c 1 and we will analyze these cases separately below.\n2. Survival probability of neutral mutations\n\nHere, we present the steps necessary to arrive at the result for the survival probability (Eq. 5). The survival\nprobability is given by the generating function of p(n, \u03c4 ), evaluated at \u03bb = 0. In our rescaled variables, the survival\nprobability therefore corresponds to \u03a6(\u03c4 ) with \u000f = \u03c3 \u22121 \u001d 1. The long time solution for \u03a6(\u03c4 ) given in Eq. C12\ncontains the free parameters \u03c40 and \u03980 , defined by matching with the short time solution which depends explicitly\non the initial condition (see above). To establish the matching, we trace the short time solution for \u000f \u001d 1 through\nseveral regimes until the initial condition is forgotten. At small times \u03c4 \u001c 1, we have\n\u03a6(\u03c4 ) \u2248 \u03a60 (\u03c4 ) =\n\n1\n\u000f\u03c4 + 1\n\n(A12)\n\n\f18\nThis rapid initial decay corresponds to the early loss of the allele due to neutral processes. Selection starts to matter\nonly after \u03c4 \u223c 1 yielding an accelerated decay of \u03a60 (\u03c4 )\n2\n\u03c42\n1\n1\n\u03a60 (\u03c4 ) = \u221a e\u2212 8 \u2212 2 r\u0303\u03c4 \u2212r\u0303 /2\n\u000f 2\u03c0\n\n(A13)\n\nThe Gaussian decay of the survival probability of un-recombined alleles is due to the increasing mean fitness, i.e. the\nadapting population wave moving past the genotype the mutation initially arose on. Hence \u03a60 (\u03c4 ) does not contribute\nto the long time behavior, which is dominated by the part of the solution driven by recombination. We therefore\nhave to calculate how much weight is transferred from \u03c80 to \u03c8r via the term r\u0303\u03a6(\u03c4 ) in Eq. A10. In the case \u000f \u001d 1,\nr\u0303\nthe dominant balance for \u03c8r (\u03c4, \u03c7) is r\u0303\u03a60 (\u03c4 ) \u2248 2\u000f\u03c8r (\u03c4, \u03c7)\u03c80 (\u03c4, \u03c7), resulting in an initially steady \u03a6r (\u03c4 ) = 2\u000f\n. After\nthe initial condition has decayed and \u03a60 (\u03c4 ) \u001c \u03a6r (\u03c4 ) the solution \u03c8r (\u03c4, \u03c7) acquires the form of Eq. A4 with the only\nmemory\ntime is obtained by equating \u03a60 (\u03c4 ) with \u03a6r (\u03c4 ), which yields\np of the initial condition in \u03a6r (\u03c4 ). The crossover\n\u221a\n\u03c40 = 8 log(2/r\u0303) \u2212 2r\u0303. Using this \u03c40 and \u03980 \u2248 \u22124 log r\u0303 (comp. Eq. A4), we can match the short time solution to\nthe long time solution in Eq. C12.\nB\n\n5\n\nr\u0303\nr\u0303\nr\u0303\nr\u0303\n\nC\n\n3.5\n\n3.5\n\n\u22122r\u03032 log \u03a6\n\n\u22122r\u03032 log \u03a6\n\np\n\n2.5\n\n3\n\nCM: r\u0303 = 0.2\nIM: r\u0303 = 0.2\nCM: r\u0303 = 0.4\nIM: r\u0303 = 0.4\nCM: r\u0303 = 0.6\nIM: r\u0303 = 0.6\nCM: r\u0303 = 0.8\nIM: r\u0303 = 0.8\n\n2.0\n1.5\n\n2\n\n1.0\n1\n0.5\n0\n0.0\n\n0.5\n\n1.0\n\n4.5\n4.0\n\n3.0\n\np\n\n4\n\n= 0.2\n= 0.4\n= 0.6\n= 0.8\n\n1.5\n\n2.0\n3\n\nW (r\u0303 \u03c4 e\n\n2.5\n\n\u22121\u2212r\u03032 /2\n\n3.0\n\n3.5\n\n4.0\n\n)\n\n0.0\n0.0\n\n\u221a\nr\u03c3 \u22121 2 log \u03bd\u03c3N\n\nA\n\n0.5\n\n1.0\n\n1.5\n3\n\nW (r\u0303 \u03c4 e\n\n\u22121\u2212r\u03032 /2\n\n2.0\n\n)\n\n3.0\n2.5\n2.0\n1.5\n\nTf p to 0.1N\n\n1.0\n\nTf p to 0.2N\nTf p to 0.5N\n\n0.5\n2.5\n\n0.0\n0.0\n\nBranching process\n0.5\n\n1.0\n3 \u22122\n\nW (r \u03c3 Tf pe\n\n1.5\n\u22121\u2212r2 /2\n\n2.0\n\n2.5\n\n)\n\nFIG. 8 Asymptotic behavior of the survival probability for the communal and infinitesimal recombination model. Panel A:\nThe survival probability \u03a6(\u03c4 ), obtained by numerical solution of Eq. C6 for the communal recombination model, exhibits the\np\n2\npredicted asymptotic behavior \u22122r\u03032 log \u03a6 \u223c W (r\u03033 \u03c4 e\u22121\u2212r\u0303 /2 ) (Eq. (5)). Panel B: The survival probability in the infinitesimal\nmodel (IM) and the communal model (CM), determined by simulating the branching process, exhibit a similar scaling collapse,\nindicating that the dependence on parameters is similar. Panel C: The first passage time, Tf p , to allele copy number \u03bdN ,\nis well described by the branching process approximation for the dynamics of alleles in a finite population as long as the\np\n2\nfrequency \u03bd \u001c 1. This is confirmed here by plotting 2r\u03032 log \u03c3\u03bdN vs. W (r\u03033 \u03c3Tf p e\u22121\u2212r\u0303 /2 ). The collapse of data for different\nr\u0303 and different \u03bd confirms the predicted parameter dependence, Eq. (7), while the concordance with the branching process\nresults confirms the branching process model. Deviation from the branching process prediction are apparent for \u03bd = 0.5.\nRecombination rates in panel C follow the same color code as in panels A&B, while black symbols correspond to r\u0303 = 1.\n\nTo illustrate the validity of the approximations made in the analysis we solved Eq. A2\np numerically. The left panel\nof Fig. 8 shows the square root of the logarithm of the rescaled survival probability, \u22122r\u03032 log \u03a6(\u03c4 ), plotted as a\n2\nfunction of W (r\u03033 \u03c4 e\u22121\u2212r\u0303 /2 ). Data for different outcrossing rates collapse onto the same curve, indicating that the\nexpression in Eq. (C12) captures the dependence on r\u0303.\nThe above analysis assumed the communal recombination model, i.e. a model where the offspring fitness independent of the parental fitness. To demonstrate that the communal recombination model captures the behavior of the\ninfinitesimal model, we compare results obtained from stochastic simulations of the branching process for the two\nmodels in Figure 8. The infinitesimal model exhibits the same scaling collapse, indicating that the dependence on\nthe parameters is similar. The two models do however show quantitative differences, which can be interpreted as less\nefficient recombination in the infinitesimal model. This is expected, as recombination in the infinitesimal model only\nhalves the correlation with either parent, while this correlation is completely destroyed in the communal recombination model. Note, however, that the dependence of PS on r\u0303 is strong, so that a rescaling of r\u0303 substantially changes\nthe absolute numbers.\n3. Beneficial and deleterious mutations\n\nTo analyze the behavior of \u03a6(\u03c4 ) in the case of s\u0303 6= 0, we track back to Eq. A6, focusing on the case where r\u0303\u0398c \u001d 1.\n\u2202\u03c4 \u03a6(\u03c4 ) = (s\u0303 \u2212 r\u0303e\u2212r\u0303\u0398c )\u03a6(\u03c4 )\n\n(A14)\n\n\f19\nThis equation highlights the fact that as long as s\u0303 \u001c r\u0303e\u2212r\u0303\u0398c , the dynamics of \u03a6(\u03c4 ) is dominated by fluctuations and\nis therefore similar to the neutral case. For a negative s\u0303, the decay of \u03a6(\u03c4 ) is accelerated, while a positive s\u0303 slows\ndown and eventually halts the decay of \u03a6(\u03c4 ), see Figure 5. The crossover to the behavior dominated by the intrinsic\nfitness effect occurs when the two terms equal. Comparing with Eq. A9 yields the crossover condition\ns\u0303 \u2248\n\nlog(r\u03033 \u03c4 )\nr\u03032 \u03c4\n\nor \u03c4 \u2248\n\nlog(r\u0303/s\u0303)\nr\u03032 s\u0303\n\n(A15)\n\nBefore this crossover, the effect of selection on s\u0303 is a simple attenuation or amplification of \u03a6(\u03c4 )p= es\u0303\u03c4 \u03a8(\u03c4 ), where \u03a8(\u03c4 )\nis approximately the neutral solution, with the slight difference that the crossover point \u0398c \u2248 \u22122 log(\u000fr\u0303\u03a8(\u03c4 )) \u2212 2s\u0303\u03c4 .\nThe correction to the crossover point is still small when selection on the intrinsic fitness effect s starts to dominate\nthe dynamics of \u03a6(\u03c4 ).\n\n4. Distribution of the allele copy number\n\nThe probability p(n, T ) of finding n copies of the allele after time T can be calculated from the generating function\np\u0302(\u03bb, T ) by contour integration in the complex \u03bb-plane:\nI\np\u0302(\u03bb, T )\n1\nd\u03bb n+1\n(A16)\np(n, \u03c4 ) =\n2\u03c0i C\n\u03bb\nThe contour C has to encircle the origin and no other singularities of p\u0302(\u03bb, T ). For n > 0, we can evaluate the contour\nintegral by deforming the contour to run alongside the singularities away from zero, which are tightly controlled by \u03bb\u2212n\nfor n \u001d 1. To do so, we have to study the analytic properties of p\u0302(\u03bb, T ) or equivalently of \u03a6(\u03c4 ) = \u03c3 \u22121 \u000f\u22121 (1 \u2212 p\u0302(\u03bb, T )),\nwhere \u000f = 1 \u2212 \u03bb. For negative \u000f = 1 \u2212 \u03bb and s \u2265 0, \u03c8(\u03c7, \u03c4 ) has a singularity at \u0398c , the value separating the regime\nof small \u03b8 where the linear equation is valid and the saturated regime where \u03c8(\u03c4 ) = \u03b8/\u000f, comp. Eq. A4. \u03a6(t) is the\nintegral of \u03c8(\u03c4, \u03c7) over \u03c7 and therefore has a branch cut for negative real \u000f. Otherwise, \u03a6(\u03c4 ) is an analytic function\nof \u000f. We can use this branch cut to evaluate the contour integral in Eq. A16. Substituting \u03a6(\u03c4 ) into Eq. A16 in\nchanging the integration variable to \u000f, we have\nI\nI\n\u03c3\n\u000f\u03a6(\u03c4 )\n\u03c3\np(n, \u03c4 ) =\nd\u000f\n\u2248\nd\u000felog \u000f+n\u000f+log \u03a6(\u03c4 )\n(A17)\n2\u03c0i B (1 \u2212 \u000f)n+1\n2\u03c0i B\nwhere B is the contour encircling the branch cut. For large n the dominant contributions to the integral come from\n\u000f \u001c 1 and we have to find a solution for \u03a6(\u03c4 ) for small \u000f.\nTo this end, we back-track to Eq. A11 and integrate the evolution equation for \u03a6(\u03c4 ) for \u000f \u001c 1. We find\n(\n\u221a\ne\u2212r\u0303\u03c4\n\u03c4 < \u22122 log \u000f\n\u221a\n\u03a60 (\u03c4 ) =\n(A18)\n2\n\u03c42\n1\n\u221a 1 e\u2212 8 \u2212 2 r\u0303\u03c4 \u2212r\u0303 /2 \u03c4 >\n\u22122 log \u000f\n\u03c0\u000f\u03c4\n\u221a For intermediate r\u0303, the matching between the short term solution and the long time solution occurs at \u03c40 = \u03980 =\n\u22122 log \u000f, after which we have\n\u03a6(\u03c4 ) =\n\n\u0398c \u2212\u0398c (\u03c4 )2 /2\ne\n\u000fr\u0303\n\nwith \u0398c (\u03c4 ) \u2248 r\u0303\u22121 log(r\u03033 (\u03c4 \u2212 \u03c40 ) + er\u03980 )\n\nFor large \u03980 , \u0398c (\u03c4 ) \u2248 \u03980 + r\u03032 (\u03c4 \u2212 \u03c40 )e\u2212r\u0303\u03980 and the branchcut integral becomes\nI\n\u2212\u03982 /2\n2\n2\n\u2212r\u0303\u03980\n\u03c3\nd\u000f\u03980 ene 0 \u2212\u03980 /2\u2212\u03980 r\u0303 (\u03c4 \u2212\u03c40 )e\np(n, \u03c4 ) \u2248\n2\u03c0r\u0303i B\n\n(A19)\n\n(A20)\n\nThe exponent of the integrant peaks when\n2\n\nn\u03980 e\u2212\u03980 /2 + \u03980 \u2212 r\u03032 (r\u0303\u03980 \u2212 1)(\u03c4 \u2212 \u03c40 )e\u2212r\u0303\u03980 = 0\n\n(A21)\n\nFor large n, the dominant balance is between the first term of Eq. (A21) and the remainder, which requires that\n\n\f20\n2\n\nn \u2248 e\u03980 /2 and hence \u000f \u2248 n\u22121 . Using \u03980 = \u03c40 =\n\n\u221a\n\n2 log n, the asymptotic copy number distribution becomes\n\n(\u03980 +r\u0303\n1\np(n, \u03c4 ) \u223c \u221a\ne\u2212\nn 2 log n\n\n\u22121 log(1+r\u0303 3 (\u03c4 \u2212\u03c4 )e\u2212r\u0303\u03980 ) 2\n0\n\n)\n\n2\n\n.\n\n(A22)\n\nThe leading dependence of p(n,\u221a\u03c4 ) on n is p(n, \u03c4 ) \u223c n\u22122 . Note, however, that the crossterm from the exponent yields\nanother subdominant factor e\u03b1 log n . By contrast, the corresponding expression in the high recombination regime is\np(n, T ) \u223c T \u22122 e\u2212n/T .\nThe allele frequency spectrum, f (n), i.e. the probability to find n copies of a derived allele irrespective of its age,\nis given by the time average of p(n, \u03c4 ) over mutations that arose at different times \u03c4 in the past. It depends on how\nquickly the survival probability decays, as well as on the shape of p(n, \u03c4 ). For large n one can expand the logarithm\nin the exponent of Eq. (A22) and integrate p(n, \u03c4 ) over \u03c4 to obtain\n( r\u0303\u221a2 log n\nZ \u221e\ne\nr\u0303 \u001c 1\n2 log n\nf (n) =\nd\u03c4 p(n, \u03c4 ) \u223c n\u22121\n(A23)\nn\nr\u0303 \u001d 1\n0\nEven though p(n, \u03c4 ) decays much faster for r\u0303 \u001d 1 (exponential) than for r\u0303 \u001c 1 (algebraically), the allele frequency\nspectrum is steeper for r\u0303 \u001c 1 than for r\u0303 \u001d 1. The long tail of the latter is due to the contribution of very old alleles\nwith very flat exponential p(n, \u03c4 ). For r\u0303 \u001c 1, the clonal amplification and rapid extinction of most alleles give rise to\nsteep allele frequency spectra.\n\n5. The double mutation probability: Stochastic tunneling\n\nTo calculate tunneling probabilities (Iwasa et al. 2004; Weissman et al. 2009), we need to know the distribution\nRt\nof w = 0 dt0 n(t0 ) treated as a stochastic variable, i.e. the size of transient \"bubbles\" of mutant individuals in a large\npopulation. In analogy to Eq. 1, the distribution p(w, T |k, t, x) for a mutation being present on background x in k\ncopies obeys the following equation\n\u2212(\u2202t \u2212 k\u2202w )p(w, T |k, t, x) = \u2212 k(B + D + r)p(w, T |k, t, x) + kBp(w, T |k + 1, t, x) + kDp(w, T |k \u2212 1, t, x)\nZ\nZ\n0\n+ rk dw\ndx0 Kxx0 p(w \u2212 w0 , T |k \u2212 1, t, x)p(w0 , T |1, t, x0 )\n\n(A24)\n\nR\nInstead of the generating function, we now consider the Laplace transform p\u0302(z, T |k, t, x) = dze\u2212zw p(w, T |k, t, x).\nThanks to the convolution property of Laplace transforms and the fact that the fate of the k alleles present at time t\nis independent of each other we have: p\u0302(z, T |k, t, x) = p\u0302k (z, T |1, t, x). As before, we scale variables by \u03c3 \u22121 and times\nby \u03c3. The equation for \u03c6(\u03c4, z, x) = \u03c3 \u22121 (1 \u2212 p\u0302(z, T |1, t, x)) then is\n\u2202\u03c4 \u03c6(\u03c4, z, \u03c7) = z + r\u0303\u03a6(\u03c4, z) + \u03b8\u03c6(\u03c4, z, \u03c7) \u2212 \u03c62 (\u03c4, z, \u03c7) ,\n\n(A25)\n\nwhere \u03b8 = \u03c7 + \u03c4 + s\u0303 + z \u2212 r\u0303. At \u03c4 = \u03c3(T \u2212 t) = 0, w = 0 and therefore \u03c6(\u03c4, z, \u03c7) = 0. If tunneling is rare and happens\nonly on time scales longer than the life time of \"bubbles\", we do not need to know the full time-dependent solution\nfor \u03c6(\u03c4, z, \u03c7) but can send \u03c4 to infinity. The above equation can again be solved by matching the asymptotic solutions\nat large negative and positive \u03b8 which in the steady state read\n( 2\n\u03b8\ne 2 [z + r\u0303\u03a6(z)] \u03b8 \u001c \u0398c\n(A26)\n\u03c6(z, \u03c7) \u2248\n\u03b8\n\u03b8 \u001d \u0398c\n\u03982\nc\n\nThe crossover point \u0398c is determined by e 2 [z + r\u0303\u03a6(z)] = \u0398c . The \"solvability condition\" obtained by integrating\nEq. A25 w.r.t. Gaussian distribution of \u03c7 yields:\nZ\n2\nd\u03c7\n\u221a e\u2212\u03c7 /2 \u03c62 (z, \u03c7) ,\n0 = z + s\u0303\u03a6(z) \u2212\n(A27)\n2\u03c0\n\n\f21\nFor small r\u0303, the integral on the right hand side is dominated by the vicinity of the crossover point \u0398c . Combining\nwith the matching condition, one finds for \u03a6(z)\n\u03a6(z) = z\n\n1 \u2212 e\u2212r\u0303\u0398c\nr\u0303e\u2212r\u0303\u0398c \u2212 s\n\n(A28)\n\nSubstituting into the crossover condition we obtain an equation for \u0398c :\nz\n\n\u03982\nr\u0303 \u2212 s\u0303\n\u2212 2c\n=\n\u0398\ne\nc\nr\u0303e\u2212r\u0303\u0398c \u2212 s\u0303\n\n(A29)\n\np\nIn the neutral case (|s\u0303| \u001c r\u0303e\u2212r\u0303\u0398c ), the location of the crossover is at \u0398c = \u22122 log(zer\u0303\u0398c /\u0398c ) which implies for \u03a6(z)\n( \u221a\ner\u0303\u0398c \u2212 1\nz \u22122 log z r\u0303\u0398c \u001c 1\n\u03a6(z) = z\n=\n(A30)\nr\u0303\nzer\u0303\u0398c /r\u0303\nr\u0303\u0398c \u001d 1\nIn case the intrinsic effect of the mutation dominates the denominator of Eq. A29 (|s\u0303| \u001d r\u0303e\u2212r\u0303\u0398c ) one finds\n( \u221a\nzr\u0303 \u22122 log z\nr\u0303\u0398c \u001c 1\nz\n\u03a6(z) =\n(1 \u2212 e\u2212r\u0303\u0398c ) = z |s\u0303|\n|s\u0303|\nr\u0303\u0398c \u001d 1\n|s\u0303|\n\n(A31)\n\nThe result for \u03a6(z) given by Eq. A28 and its different limits is directly relevant to the calculation of the probability\nof secondary events, e.g. an additional mutation as discussed in the earlier in Stochastic tunneling and complex\nadaptations.\nR\u221e\nFor completeness we also calculate the probability distribution of w = 0 dtn(t) which is given by the inverse\nLaplace transform of \u03a6(z):\nI\ndz zw\nP (w) =\ne \u03a6\u0304z\n(A32)\n2\u03c0i\nC\nwhere C is\npthe contour encircling the branch cut. For example in the intermediate asymptotic r\u0303\u0398c \u001c 1 regime when\n\u03a6(z) = z log z \u22122 , we have\np\nH dz zw p\nR\u221e\n\u2212yw\nP (w) = C 2\u03c0i\ne z log z \u22122 = 0 dy\ny Im[ 2 log y \u22121 + i2\u03c0]\n(A33)\n\u03c0 e\nR \u221e dyye\u2212yw\n\u22122\n\u2248 0 \u221a\n\u223c \u221aw 2\n(A34)\n\u22122\nlog y\n\nlog w\n\nwhere we used an approximation valid\n\u221a for w \u001d 1. This can be compared to the \"draft-less\" result, obtained also in\nthe r\u0303 \u001d 1 limit: in that case \u03a6(z) = z, inverse Laplace transform of which gives P (w) \u223c w\u22123/2 (Weissman et al.\n2009).\n\nAppendix B: Computer simulation methods\n\nFisher-Wright simulation. To efficiently simulate the dynamics of large populations, we keep track of classes of\nindividuals with identical genomes, which are encoded by bitstrings. The fitness x of all individuals of a class is simply\nthe sum of the contributions from all loci. In our discrete generation scheme, a pool of gametes is produced to which\neach class contributes a Poisson distributed number of gametes with mean c exp(\u2212(x \u2212 x\u0304 + \u03b1)). Here, c is the size\nof the class, x\u0304 is the mean fitness in the population and \u03b1 = 1 \u2212 N/N\u0304 keeps the population size N approximately\nconstant at N\u0304 . Fitness defined as growth rate in the continuous time model naturally assumes this exponential form\nin a discrete generation model, simply by integration over one generation.\nTo implement facultative mating, a fraction r of the gametes are paired up and from each pair two offspring are\nproduced by assigning at random the genes of the parents to either offspring. The remaining 1 \u2212 r fraction of gametes\nis copied into the next generation without recombination, i.e. they have gone through an asexual reproduction cycle.\nThe genome of each class has a fixed length L = 1024 and new mutations are introduced at a locus whenever this\nlocus is monomorphic, i.e. whenever a previous mutation either went extinct or fixed. For each monomorphic locus,\nan individual is chosen at random and the mutation is introduced in this single individual. This scheme of keeping a\nfixed number of loci polymorphic has the advantage of making optimal use of the computational resources, i.e. keep\n\n\f22\nevery locus polymorphic while maintaining an overall low mutation rate. The mutation rate, however, becomes a\ndependent quantity which fluctuates around a value that depends on other parameters of the population: N Ub is\nsimply the average number of loci that become monomorphic in one generation, see (Neher et al. 2010). For large\nL, the number of mutations introduced in each generation is much greater than one and doesn't fluctuate greatly.\nTo establish a steadily adapting population, 80% of the loci are kept polymorphic with beneficial mutations with\neffect size s0 which each generation is rescaled such that the overall fitness variance is \u03c3 2 = 0.0025. This rescaling is\ndone to be able to specify r/\u03c3 and s/\u03c3 explicitly. Since fluctuations of \u03c3 in large populations with many polymorphic\nloci are small, this does not change the properties of the dynamics and the same results are obtained letting \u03c3 be\nfreely determined by the population. The remaining 20% of the loci are used to study the fate of mutations with\nfixed effect size s. Measurements are performed after an equilibration period of 20000 generations at intervals of one\nhundred generations. The source code is available from the authors on request.\nSimulation of the branching process. The simulation of the population dynamics is complemented by a simulation\nof the branching process which can be directly compared to analytic calculations. We simulate the process described\nby Eq. (1) using an event driven algorithm (Gillespie 1977). The simulation keeps track of all individuals that\ncurrently carry the allele in question. For each individual, the time t + \u2206t of the next event is determined by drawing\na \u2206t from an exponential distribution with parameter B(t) + D + r, where B and D are the birth and death rates,\nrespectively. At time t + \u2206t, a birth, death, or recombination event are performed with probabilities proportional to\nB(t + \u2206t), D, and r, respectively. In case of death, the individual is deleted, in case of birth it is duplicated with the\nexact same fitness, in case of recombination, its fitness is redrawn according to the recombination kernels in Eqs. (2)\nor (3). (Note that the waiting time distribution for the next event is not exactly exponential, since the birth rate is\ntime dependent. This, however, amounts only to a correction of order \u03c3 2 \u001c 1.) For the recombination function of the\ncommunal model, we need not simulate Eq. (1) but can solve numerically for the generating function of the p(n, T, t),\ngiven in Eq. (C6). To this end, we discretize the fitness x and solve for the vector \u03c8(\u03c4, x) using the ODE solver of\nSciPy (Oliphant 2007). The results obtained through stochastic simulation of the communal model agree with the\nnumerical solution for the generating function, as it has to be.\n\nReferences\nAndolfatto, P. and M. Przeworski, 2001 Regions of lower crossing over harbor more rare variants in african populations\nof Drosophila melanogaster. Genetics 158: 657\u201365.\nAsquith, B., C. T. T. Edwards, M. Lipsitch, and A. R. McLean, 2006 Inefficient cytotoxic t lymphocyte-mediated killing\nof HIV-1-infected cells in vivo. PLoS Biol 4: e90.\nBarton, N., 1994 The reduction in fixation probability caused by substitutions at linked loci. Genet Res 64: 199\u2013208.\nBarton, N., 1998 The effect of hitch-hiking on neutral genealogies. Genet Res 72: 123\u2013133.\nBarton, N., 2009 Why sex and recombination? Cold Spring Harb Symp Quant Biol 74: 187\u2013195.\nBarton, N. H., 1995a A general model for the evolution of recombination. Genet Res 65: 123\u201345.\nBarton, N. H., 1995b Linkage and the limits to natural selection. Genetics 140: 821\u201341.\nBarton, N. H. and A. M. Etheridge, 2004 The effect of selection on genealogies. Genetics 166: 1115\u201331.\nBegun, D. J. and C. F. Aquadro, 1992 Levels of naturally occurring dna polymorphism correlate with recombination rates\nin D. melanogaster. Nature 356: 519\u201320.\nBraverman, J. M., R. R. Hudson, N. L. Kaplan, C. H. Langley, and W. Stephan, 1995 The hitchhiking effect on the\nsite frequency spectrum of DNA polymorphisms. Genetics 140: 783\u201396.\nBulmer, M. G., 1980 The Mathematical Theory of Quantitative Genetics. Oxford University Press, Oxford.\nCaicedo, A. L., S. H. Williamson, R. D. Hernandez, A. Boyko, A. Fledel-Alon, T. L. York, N. R. Polato, K. M.\nOlsen, R. Nielsen, S. R. McCouch, C. D. Bustamante, and M. D. Purugganan, 2007 Genome-wide patterns of\nnucleotide polymorphism in domesticated rice. PLoS Genet 3: 1745\u201356.\nCharlesworth, B., M. Morgan, and D. Charlesworth, 1991 Multilocus models of inbreeding depression with synergistic\nselection and partial self-fertilization. Genet Res 57: 177\u2013194.\nCharlesworth, B., M. T. Morgan, and D. Charlesworth, 1993 The effect of deleterious mutations on neutral molecular\nvariation. Genetics 134: 1289\u2013303.\nCharlesworth, D., M. T. Morgan, and B. Charlesworth, 1992 The effect of linkage and population size on inbreeding\ndepression due to mutational load. Genet Res 59: 49\u201361.\nChen, L., A. Perlina, and C. J. Lee, 2004 Positive selection detection in 40,000 human immunodeficiency virus (hiv) type\n1 sequences automatically identifies drug resistance and positive fitness mutations in hiv protease and reverse transcriptase.\nJ Virol 78: 3722\u201332.\nCohen, E., D. A. Kessler, and H. Levine, 2005 Recombination dramatically speeds up evolution of finite populations. Phys\nRev Lett 94: 098102.\nComeron, J. M. and M. Kreitman, 2002 Population, evolutionary and genomic consequences of interference selection.\nGenetics 161: 389\u2013410.\n\n\f23\nComeron, J. M., A. Williford, and R. M. Kliman, 2008 The Hill-Robertson effect: evolutionary consequences of weak\nselection and linkage in finite populations. Heredity 100: 19\u201331.\nDesai, M. M. and D. S. Fisher, 2007 Beneficial mutation selection balance and the effect of linkage on positive selection.\nGenetics 176: 1759\u201398.\nEldon, B. and J. Wakeley, 2006 Coalescent processes when the distribution of offspring number among individuals is highly\nskewed. Genetics 172: 2621\u201333.\nEwens, W. J., 2004 Mathematical Population Genetics. Springer.\nFay, J. C. and C. I. Wu, 2000 Hitchhiking under positive Darwinian selection. Genetics 155: 1405\u201313.\nFelsenstein, J., 1974 The evolutionary advantage of recombination. Genetics 78: 737\u201356.\nGillespie, D. T., 1977 Exact stochastic simulation of coupled chemical reactions. Journal of Physical Chemistry 81: 2340\u2013\n2361.\nGillespie, J. H., 2000 Genetic drift in an infinite population. The pseudohitchhiking model. Genetics 155: 909\u201319.\nGillespie, J. H., 2001 Is the population size of a species relevant to its evolution? Evolution 55: 2161\u20139.\nGriffiths, R. C. and P. Marjoram, 1996 Ancestral inference from samples of DNA sequences with recombination. J Comput\nBiol 3: 479\u2013502.\nHaigh, J., 1978 The accumulation of deleterious genes in a population \u2013 Muller's ratchet. Theoretical Population Biology 14:\n251\u201367.\nHedskog, C., M. Mild, J. Jernberg, E. Sherwood, G. Bratt, T. Leitner, J. Lundeberg, B. Andersson, and\nJ. Albert, 2010 Dynamics of hiv-1 quasispecies during antiviral treatment dissected using ultra-deep pyrosequencing. PLoS\nONE 5: e11345.\nHill, W. G. and A. Robertson, 1966 The effect of linkage on limits to artificial selection. Genet Res 8: 269\u201394.\nHudson, R. R., 1983 Properties of a neutral allele model with intragenic recombination. Theoretical Population Biology 23:\n183\u2013201.\nHudson, R. R. and N. L. Kaplan, 1995 Deleterious background selection with recombination. Genetics 141: 1605\u201317.\nIwasa, Y., F. Michor, and M. A. Nowak, 2004 Stochastic tunnels in evolutionary dynamics. Genetics 166: 1571\u20139.\nJung, A., R. Maier, J.-P. Vartanian, G. Bocharov, V. Jung, U. Fischer, E. Meese, S. Wain-Hobson, and A. Meyerhans, 2002 Multiply infected spleen cells in HIV patients. Nature 418: 144.\nKaplan, N. L., R. R. Hudson, and C. H. Langley, 1989 The \"hitchhiking effect\" revisited. Genetics 123: 887\u201399.\nKarasov, T., P. W. Messer, and D. A. Petrov, 2010 Evidence that adaptation in Drosophila is not limited by mutation\nat single sites. PLoS Genet 6: 1000924.\nKelly, J. K. and S. Williamson, 2000 Predicting response to selection on a quantitative trait: a comparison between models\nfor mixed-mating populations. J Theor Biol 207: 37\u201356.\nKingman, J., 1982 On the genealogy of large populations. Journal of Applied Probability 19 IS -: 27\u201343.\nKorber, B. T. M., C. Brander, B. F. Haynes, R. Koup, J. P. Moore, B. D. Walker, and D. I. Watkins, editors, 2007\nHIV Molecular Immunology 2006/2007 . Los Alamos National Laboratory, Theoretical Biology and Biophysics, Los Alamos,\nNew Mexico.\nKrone, S. and C. Neuhauser, 1997 Ancestral processes with selection. Theoretical population biology 51: 210\u201337.\nLarder, B., G. Darby, and D. Richman, 1989 HIV with reduced sensitivity to zidovudine (AZT) isolated during prolonged\ntherapy. Science 243: 1731.\nLevy, D. N., G. M. Aldrovandi, O. Kutsch, and G. M. Shaw, 2004 Dynamics of HIV-1 recombination in its natural target\ncells. Proc Natl Acad Sci USA 101: 4204\u20139.\nLewontin, R. C., 1974 The genetic basis of evolutionary change. Columbia University Press.\nLynch, M., 2007 The origins of genome architecture. Sinauer Associates.\nLynch, M., 2010 Scaling expectations for the time to establishment of complex adaptations. Proceedings of the National\nAcademy of Sciences of the United States of America 107: 16577\u201382.\nMansky, L. M. and H. M. Temin, 1995 Lower in vivo mutation rate of human immunodeficiency virus type 1 than that\npredicted from the fidelity of purified reverse transcriptase. J Virol 69: 5087\u201394.\nMarkowitz, M., M. Louie, A. Hurley, E. Sun, M. D. Mascio, A. S. Perelson, and D. D. Ho, 2003 A novel antiviral\nintervention results in more accurate assessment of human immunodeficiency virus type 1 replication dynamics and t-cell\ndecay in vivo. J Virol 77: 5037\u20138.\nMaynard Smith, J. and J. Haigh, 1974 The hitch-hiking effect of a favourable gene. Genet Res 23: 23\u201335.\nMcVean, G. A. and B. Charlesworth, 2000 The effects of hill-robertson interference between weakly selected mutations on\npatterns of molecular evolution and variation. Genetics 155: 929\u201344.\nMohle, M. and S. Sagitov, 2001 A classification of coalescent processes for haploid exchangeable population models. Ann.\nProbab. 29: 1547\u20131562.\nMustonen, V. and M. L\u00e4ssig, 2010 Fitness flux and ubiquity of adaptive evolution. Proceedings of the National Academy of\nSciences of the United States of America 107: 4248\u201353.\nNeher, R. A. and T. Leitner, 2010 Recombination rate and selection strength in HIV intra-patient evolution. PLoS Comput\nBiol 6: e1000660.\nNeher, R. A. and B. I. Shraiman, 2009 Competition between recombination and epistasis can cause a transition from allele\nto genotype selection. Proc Natl Acad Sci USA 106: 6866\u20136871.\nNeher, R. A., B. I. Shraiman, and D. S. Fisher, 2010 Rate of adaptation in large sexual populations. Genetics 184:\n467\u2013481.\nNordborg, M., B. Charlesworth, and D. Charlesworth, 1996 The effect of recombination on background selection.\n\n\f24\nGenet Res 67: 159\u201374.\nOliphant, T., 2007 Python for scientific computing. Computing in Science & Engineering 9: 10\u201320.\nPaul, W. E., 2008 Fundamental immunology. Lippincott Williams & Wilkins.\nPerelson, A. S., A. U. Neumann, M. Markowitz, J. M. Leonard, and D. D. Ho, 1996 HIV-1 dynamics in vivo: virion\nclearance rate, infected cell life-span, and viral generation time. Science 271: 1582\u20136.\nRhee, S.-Y., M. J. Gonzales, R. Kantor, B. J. Betts, J. Ravela, and R. W. Shafer, 2003 Human immunodeficiency\nvirus reverse transcriptase and protease sequence database. Nucleic Acids Res 31: 298\u2013303.\nRobertson, A., 1961 Inbreeding in artificial selection programmes. Genet Res 2: 189\u2013194.\nRouzine, I. M. and J. M. Coffin, 2005 Evolution of human immunodeficiency virus under selection and weak recombination.\nGenetics 170: 7\u201318.\nRouzine, I. M. and J. M. Coffin, 2007 Highly fit ancestors of a partly sexual haploid population. Theoretical Population\nBiology 71: 239\u201350.\nRouzine, I. M. and J. M. Coffin, 2010 Multi-site adaptation in the presence of infrequent recombination. Theoretical\nPopulation Biology 77: 189\u2013204.\nRouzine, I. M., J. Wakeley, and J. M. Coffin, 2003 The solitary wave of asexual evolution. Proc Natl Acad Sci USA 100:\n587\u201392.\nSantiago, E. and A. Caballero, 1998 Effective size and polymorphism of linked neutral loci in populations under directional\nselection. Genetics 149: 2105.\nSchweinsberg, J., 2003 Coalescent processes obtained from supercritical galton-watson processes. Stochastic Process. Appl.\n106: 107\u2013139.\nSeger, J., W. Smith, J. Perry, J. Hunn, Z. Kaliszewska, L. Sala, L. Pozzi, V. Rowntree, and F. Adler, 2010 Gene\ngenealogies strongly distorted by weakly interfering mutations in constant environments. Genetics 184: 529.\nSella, G., D. A. Petrov, M. Przeworski, and P. Andolfatto, 2009 Pervasive natural selection in the drosophila genome?\nPLoS Genet 5: e1000495.\nShankarappa, R., J. B. Margolick, S. J. Gange, A. G. Rodrigo, D. Upchurch, H. Farzadegan, P. Gupta, C. R.\nRinaldo, G. H. Learn, X. He, X. L. Huang, and J. I. Mullins, 1999 Consistent viral evolutionary changes associated\nwith the progression of human immunodeficiency virus type 1 infection. J Virol 73: 10489\u2013502.\nStephan, W. and S. J. Mitchell, 1992 Reduced levels of dna polymorphism and fixed between-population differences in the\ncentromeric region of drosophila ananassae. Genetics 132: 1039\u201345.\nTsimring, L., H. Levine, and D. Kessler, 1996 RNA virus evolution via a fitness-space model. Phys Rev Lett 76: 4440\u20134443.\nWeissman, D., M. M. Desai, D. Fisher, and M. Feldman, 2009 The rate at which asexual populations cross fitness valleys.\nTheoretical Population Biology .\nWeissman, D., M. Feldman, and D. Fisher, 2010 The rate of fitness-valley crossing in sexual populations. Genetics p.\ngenetics.110.123240v1.\nWiehe, T. H. and W. Stephan, 1993 Analysis of a genetic hitchhiking model, and its application to DNA polymorphism\ndata from Drosophila melanogaster. Mol Biol Evol 10: 842\u201354.\nWilliamson, S., 2003 Adaptation in the env gene of HIV-1 and evolutionary theories of disease progression. Mol Biol Evol\n20: 1318\u201325.\n\n\f25\nAppendix C: Supplement\nDerivation of the backward Master equation for p(n, T )\n\nThe fundamental quantity of the branching process is the probability distribution, p(n, T ), of observing n copies\nof the allele T generations after it originated. A backward equation for p(n, T ) can be derived by considering the\nprobability p(n, T |k, t, x) of having n copies at time T , given their were k copies on a background with fitness x at\ntime t. p(n, T |k, t \u2212 \u2206t, x) now can be expressed as a sum over possible intermediate states at time t:\np(n, T |k, t \u2212 \u2206t, x) =p(n, T |k, t, x)(1 \u2212 \u2206tk(2 + x \u2212 x\u0304(t) + s + r))\n+ \u2206t [k(1 + x \u2212 x\u0304(t) + s)p(n, T |k + 1, t, x) + kp(n, T |k \u2212 1, t, x)]\nXZ\n+ \u2206trk\nKxx0 p(n \u2212 n0 , T |k \u2212 1, t, x)p(n0 , T |1, t, x0 ) ,\nn0\n\n(C1)\n\nx0\n\nwhere x\u0304(t) is the mean fitness of the population at time t. The different terms have straightforward interpretations:\nThe first term is the probability that nothing happens in the small time interval \u2206t, the second accounts for a division\nof one of k individuals, which happens with rate k(1 + x \u2212 x\u0304(t) + s), the third term accounts for the death of one of\nthe k, while the last term accounts for outcrossing of one of the k, producing a new individual with fitness x0 and\nremoving one with fitness x. The outcrossing term is then summed over all possible ways the k \u2212 1 individuals with\nfitness x and the one with fitness x0 can give rise to n individuals at time T . Sending \u2206t to zero and rearranging\nterms results in an ODE for p(n, T |k, t, x)\n\u2212\u2202t p(n, T |k, t, x) = \u2212 p(n, T |k, t, x)k(2 + x \u2212 x\u0304(t) + s + r)\n+ k(1 + x \u2212 x\u0304(t) + s)p(n, T |k + 1, t, x) + kp(n, T |k \u2212 1, t, x)\nXZ\n+ rk\nKxx0 p(n \u2212 n0 , T |k \u2212 1, t, x)p(n0 , T |1, t, x0 )\nn0\n\n(C2)\n\nx0\n\nThis is equation 1 from the main text.\n\nDerivation of the equation for the generating function\n\nPTo nremove the convolution over n it is convenientn to consider the generating function p\u0302(\u03bb, T |k, t, x) =\nn \u03bb p(n, T |k, t, x). Multiplying the above equation by \u03bb and summing over n yields\n\u2212\u2202t p\u0302(\u03bb, T |k, t, x) = \u2212 k(2 + x \u2212 x\u0304(t) + s + r)p\u0302(\u03bb, T |k, t, x)\n+ k(1 + x \u2212 x\u0304(t) + s)p\u0302(\u03bb, T |k + 1, t, x) + k p\u0302(\u03bb, T |k \u2212 1, t, x)\nZ\n+ rk\nKxx0 p\u0302(\u03bb, T |k \u2212 1, t, x)p\u0302(\u03bb, T |1, t, x)\n\n(C3)\n\nx0\n\nAll k initial individuals are independent, hence p\u0302(\u03bb, T |k, t, x) = p\u0302k (\u03bb, T |t, x) and the right hand side is\n\u2212\u2202t p\u0302k (\u03bb, T |t, x) = \u2212k p\u0302k\u22121 (\u03bb, T |t, x)\u2202t p\u0302(\u03bb, T |t, x). We can therefore divide the equation by p\u0302k\u22121\n(\u03bb, T |t, x) to obtain\nx\nZ\n\u2212\u2202t p\u0302(\u03bb, T, t, x) = \u2212 (2 + x \u2212 x\u0304(t) + s + r)p\u0302(\u03bb, T, t, x) + (1 + x \u2212 x\u0304(t) + s)p\u03022 (\u03bb, T, t, x) + 1 + r\nKxx0 p\u0302(\u03bb, T, t, x)\nx0\n\n(C4)\n\nThe generating function has the boundary condition p\u0302(\u03bb, T |T, x) = \u03bb, which follows from p(n, T |k, T, x) = \u03b4nk .\nSubstituting p\u0302(\u03bb, T |t, x) = 1 \u2212 \u03c6(\u03bb, T, t, x) removes the constant term.\nZ\n\u2202t \u03c6(\u03bb, T, t, x) = \u2212 r\nKxx0 \u03c6(\u03bb, T, t, x0 ) \u2212 (x \u2212 x\u0304(t) + s \u2212 r)\u03c6(\u03bb, T, t, x) + (1 + x \u2212 x\u0304(t) + s)\u03c62 (\u03bb, T, t, x)\n(C5)\nx0\n\n\f26\nwhich now has boundary condition \u03c6(\u03bb, T, T, x) = 1 \u2212 \u03bb. Assuming that selection is weak on the timescale of one\ngeneration (\u03c3 \u001c 1), we can approximate 1 + x \u2212 x\u0304(t) + s by 1 and arrive at Eq. 18 of the main text:\nZ\n\u2212\u2202t \u03c6(\u03bb, T, t, x) = r\nKxx0 \u03c6(\u03bb, T, t, x0 ) + (x \u2212 x\u0304(t) + s \u2212 r)\u03c6(\u03bb, T, t, x) \u2212 \u03c62 (\u03bb, T, t, x)\n(C6)\nx0\n\nSolution for \u03a6(\u03c4 ) at low r\u0303\n\nIn the main text, we presented a solution to the two equations (Eqs. (21) and (23))\n( 2 R\u03c4\n02\nre\u03b8 /2 0 d\u03c4 0 \u03a6(\u03c4 0 )e\u2212\u03b8 /2 \u03b8 < \u0398c\n\u03c8(\u03c4, \u03c7) =\n\u03b8/\u000f\n\u03b8 > \u0398c\n\n(C7)\n\nand\n\u2202\u03c4 \u03a6(\u03c4 ) = s\u0303\u03a6(\u03c4 ) \u2212 \u000f\n\nZ\n\nd\u03c7P (\u03c4, \u03c7)\u03c8 2 (\u03c4, \u03c7)\n\n(C8)\n\n\u221a\nin a regime of intermediate r\u0303 (1/ log N < r\u0303 < 1). An additional solution with qualitatively different properties exists\nat low r\u0303. While the assumption of a Gaussian fitness distribution is questionable in this range of r\u0303, we nevertheless\npresent the solution here for completeness. Proceeding as before, we evaluate the integral in Eq. (C7) by expanding\nexponent around its maximum. The maximum is located at \u03c4 0 = \u03c4 \u2212 \u03b8 \u2212 \u03b1(\u03c4 0 ) where \u03b1(\u03c4 ) = \u2212\u03a6(\u03c4 )\u22121 \u2202\u03c4 \u03a6(\u03c4 ).\nAssuming \u03b1(\u03c4 ) changes slowly with time, we have\n\u03c8(\u03c4 ) \u2248\n\n\u221a\n\n2\u03c0r\u0303\u03a6(\u03c4 )e\n\n(\u03b8+\u03b1)2\n2\n\n(C9)\n\nThis solution is valid below \u0398c , where \u03c8(\u03c4 ) crosses over the linear saturated form \u03b8/\u000f. In addition to the matching\ncondition at \u0398c , we use Eq. C8 for s = 0 to determine \u03b1:\n2\n\n\u2202\u03c4 \u03a6(\u03c4 ) = \u2212\u03b1\u03a6(\u03c4 ) = \u2212r\u0303\u03a6(\u03c4 )e\u0398c (\u03b1\u2212r\u0303)+\u03b1\n\n/2\u2212r\u0303 2 /2\n\n(C10)\n\nr\u0303\nFor r\u0303\u0398c \u001d 1 we recover the solution with small \u03b1 given in the main text. For smaller r\u0303, however, we find \u03b1(\u03c4 ) \u2248 log\n\u0398c .\nSolving the matching condition for \u0398c and differentiating with respect to \u03c4 yields \u2202\u03c4 \u0398c = \u2212 \u03981c \u03b1(\u03c4 ). This is readily\nsolved for this case of \u0398c r\u0303 < 1\n\n\u0398c (\u03c4 ) = (\u22123(\u03c4 \u2212 \u03c40 ) log r\u0303 + \u039830 )1/3 .\n\n(C11)\n\nSubstituting this solution for \u0398c (\u03c4 ) into the expression for the rescaled generating function yields\n3 2/3\n\n\u03a6(\u03c4 ) =\n\n[\u22123(\u03c4 \u2212\u03c40 ) log r\u0303+\u03980 ]\n\u0398c \u2212 (\u0398c +\u03b1)2\n2\n2\ne\n\u223c e\u2212\n\u000fr\u0303\n\n(C12)\n\nHence in this low r\u0303 regime, the decay of the survival probability is qualitatively different from the regime of intermediate\nr\u0303.\nEffective clone-based model\n\nTo rationalize the behavior of the continuous time branching process, we considered the following simplified model\ndiscussed in the main text: Genotypes expand clonally and produce recombinant offspring. The offspring start growing\nsimultaneously in the next \"effective\" generation after all clones from the previous generation have disappeared. The\nrelevant quantity now is the number of clones or distinct genotypes, rather than the number of individuals. To\nunderstand the dynamics of the number of clones, we need to know how many clones a single clone can produce.\nConsider a single genotype with background fitness \u03c7 which\nR \u221eis carrying a mutation of effect size s\u0303. The expected\nnumber of recombinant offspring from this genotype is \u03be = r\u0303 0 dtn\u03c7 (t), where n\u03c7 (t) is the copy number trajectory.\nThe Laplace transform p\u0302(\u03be) of p(\u03be) obeys the equation (\u03c6(z) = 1 \u2212 p\u0302(z))\n\u2202\u03c7 \u03c6(\u03c7, z) = r\u0303z + (\u03c7 + s\u0303 \u2212 r\u0303(1 \u2212 z))\u03c6(\u03c7, z) \u2212 \u03c6(\u03c7, z)2 ,\n\n(C13)\n\n\f27\nwhich is a simpler version of the Eq. (42) (main text) since only one single clone is considered and recombination to\ndaugther clone is ignored. This equation can be solved asymptotically in the regimes of large and small \u03c7 \u2212 r.\n(\nR \u03c7+s\u0303\u2212r\u0303(1\u2212z)\n2\n2\nr\u0303ze(\u03c7+s\u0303\u2212r\u0303(1\u2212z)) /2 \u2212\u221e\ndxe\u2212x /2 \u03c7 \u2212 r\u0303 \u001c \u0398c\n\u03c6(\u03c7, z) =\n(C14)\n(\u03c7 \u2212 r\u0303(1 \u2212 z))\n\u03c7 \u2212 r\u0303 \u001d \u0398c\n\n\u221a\nwhere \u0398c \u2248 \u22122 log r\u0303z. The initial fitness of the genotype, \u03c7, is Gaussian distributed and the Laplace transform has\nto be averaged over \u03c7.\nZ \u221e\n2\nd\u03c7\n\u221a e\u2212\u03c7 /2 \u03c6(\u03c7, z)\n\u03c6(z) =\n(C15)\n2\u03c0\n\u2212\u221e\nLet's look at the mean number h\u03bei of recombinant offspring first, which is given by differentiating with respect to z\nand setting z = 0, which in turn sends \u0398c to infinity. Integration by parts yields\nh\u03bei = \u2202z\n\nZ\n\n\u221e\n\n\u2212\u221e\n\n2\nd\u03c7\n\u221a e\u2212\u03c7 /2 \u03c6(\u03c7) = r\u0303\n2\u03c0\n\nZ\n\n\u221e\n\n\u2212\u221e\n\n2\nd\u03c7\n\u221a e\u2212\u03c7(r\u0303\u2212s\u0303)+r /2\n2\u03c0\n\nZ\n\n\u03c7\u2212r\u0303+s\u0303\n\ndxe\u2212x\n\n2\n\n/2\n\n\u2212\u221e\n\n=\n\nr\u0303\nr\u0303 \u2212 s\u0303\n\n(C16)\n\nHence the mean number of recombinant offspring is 1 for a neutral mutation and approximately 1 + s\u0303/r\u0303 for mutations\nwith small effect.\n\u221a To evaluate the integral in Eq. (C15) at finite z, we have to account for the cross-over of \u03c6(\u03c7, z) at\n\u03c7 \u2212 r\u0303 = \u0398c \u2248 \u22122 log r\u0303z. For small z, the cross-over translates into a cut-off of the integral. Again, the integral can\nbe evaluated by parts:\nZ\n\n\u0398c +r\u0303\u2212s\u0303\n\n2\n2\nd\u03c7\n\u221a r\u0303ze\u2212\u03c7(r\u0303(1\u2212z)\u2212s\u0303)+r\u0303 (1\u2212z) /2\n2\u03c0\n\u2212\u221e\ni\n2\nr\u0303z h\n\u2248\n1 \u2212 e\u2212\u0398c (r\u0303\u2212s\u0303)\u2212r\u0303 /2\nr\u0303 \u2212 s\u0303\n\n\u03c6(z) =\n\nZ\n\n\u03c7\u2212r\u0303(1\u2212z)+s\u0303\n\ndxe\u2212x\n\n\u2212\u221e\n\n2\n\n/2\n\n+\n\nZ\n\n\u221e\n\n\u0398c +r\u0303\u2212s\u0303\n\n2\nd\u03c7\n\u221a e\u2212\u03c7 /2 (\u03c7 \u2212 r\u0303(1 \u2212 z))\n2\u03c0\n(C17)\n\nHence, the generating function of the average number of recombinant offspring generated by a random genotype is\ngiven by\np\u0302(z) = 1 \u2212 \u03c6(z) \u2248 1 \u2212\n\ni\nr\u0303z h\n1 \u2212 e\u2212\u0398c (r\u0303\u2212s\u0303) ,\nr\u0303 \u2212 s\u0303\n\n(C18)\n\nwhere the last expression is valid for z \u001c 1 and r\u0303 \u001c 1.\nThe actual number m of recombinant offspring (novel clones) generated by one clone is Poisson distributed with\nmean \u03be. The generating function of m is therefore\nZ \u221e\nZ \u221e\nm\nX\nX\nm\nm\n\u2212\u03be \u03be\n\u03bb P (m) =\n\u03bb\nd\u03be p(\u03be)e\n=\nd\u03be p(\u03be)e\u2212\u03be(1\u2212\u03bb) = p\u0302(1 \u2212 \u03bb) = 1 \u2212 \u03c6(1 \u2212 \u03bb)\n(C19)\nm!\n0\n0\nm\nm\nWe will now use this result to calculate how the number of clones that descend from a particular genotype evolves\nover time.\n\nThe stochastic dynamics of the number genotypes\n\nAs long as the clones we are tracking constitute a small fraction of the population, different clones are independent.\nThe probability to go from k to m clones in one effective generation has therefore the generating function P\u0302 (\u03bb, k) =\nP\u0302 k (\u03bb, 1) = (1 \u2212 \u03c6(1 \u2212 \u03bb))k . To study the dynamics of the number of clones over many generations, we need to know\nhow this propagator behaves when iterated.\nX\nX\nX\nX\n\u03bbm\nP (m, mn )P (mn , mn\u22121 ) . . . P (m1 , k) =\nP\u0302 mn (1 \u2212 \u03bb)\nP (mn , mn\u22121 ) . . . P (m1 , k)\nm\n\nh\n\nm1 ,...mn\n\nmn\n\nm1 ,...mn\u22121\n\nik\nk\nk\n= P\u0302 (1 \u2212 P\u0302 (1 \u2212 P\u0302 (1 \u2212 . . . P\u0302 (1 \u2212 \u03bb)))) = [1 \u2212 \u03c6 \u25e6 \u03c6 . . . \u25e6 \u03c6(1 \u2212 \u03bb)] = [1 \u2212 \u03a6n (1 \u2212 \u03bb)]\n\n(C20)\n\n\f28\nUsing the result for the Laplace transform in Eq. (C18), we arrive at the difference equation\ni\nh\n\u221a\n\u03a6n+1 \u2212 \u03a6n \u2248 s\u0303/r\u0303 \u2212 e\u2212r\u0303 \u22122 log r\u0303\u03a6n \u03a6n\n\n(C21)\n\nThis is exactly the differential equation we have derived using the continuous time mode when the effective generation\ntime is set to r\u0303\u22121 . The latter is reasonable since the r\u0303\u22121 is the turnover time by recombination.\nSupplementary Figure: Population distribution\n\n100\n\nFitness distribution\n\n10\u22121\n10\u22122\n\nGaussian\nr/\u03c3 = 0.0\n\n10\u22123\n\nr/\u03c3 = 0.1\nr/\u03c3 = 0.2\n\n10\u22124\n\nr/\u03c3 = 0.4\nr/\u03c3 = 0.6\n\n10\u22125\n\nr/\u03c3 = 0.8\nr/\u03c3 = 1.0\n\n10\u22126\n\nr/\u03c3 = 1.6\n10\n\n\u22127\n\n\u22128\n\n\u22126\n\n\u22124\n\n\u22122\n\n0\n\n2\n\n4\n\n6\n\n8\n\nx [\u03c3]\n\nFIG. 9 The fitness distribution of a population adapting at many loci is Gaussian. The figure shows the fitness distribution\nmeasured using our computational model for different ratios r/\u03c3.\n\u221a Only at r/\u03c3 = 0.1 or 0.2, one sees (slight) deviations from\nthe Gaussian. Our analysis applies in the range 1 > r/\u03c3 > 1/ log N , where the fitness distribution is Gaussian all the way\ninto the tails.\n\nSupplementary Figures: Background Selection\n\n\f29\n\n101\n\n102\n\ns/\u03c3 = \u22120.001\n\n0\n\nTf ix/N\n\n10\n\nFixation probability pf ixN\n\ns/\u03c3 = 0.0\n\n10\u22121\n\nN = 4000\nN = 8000\nneutral expectation\n10\u22122 \u22122\n10\n\n10\u22121\n\n100\n\n101\n\ns/\u03c3 = 0.001\n10\n\n1\n\n100\n\n10\u22121 \u22122\n10\n\n10\u22121\n\n100\n\nr/\u03c3\n\n101\n\nr/\u03c3\n\nFIG. 10 Fixation times and fixation probabilities with background selection, in analogy to Fig. 2 of the manuscript. The left\npanel shows the mean fixation time of neutral mutations in populations of different sizes at different ratios of r/\u03c3. Fixation times\nare normalized by N . In contrast to Fig. 2 of the manuscript, the fitness variation here does not result from sweeping beneficial\nmutations but from many deleterious mutations. Comparing Fig. 2 to this figure, one sees that the effect of background selection\non the fixation time of neutral mutations is very similar to that of multiple sweeps in a facultatively sexual population. The\nright panel shows the fixation probability of mutations with different effects on fitness for different ratios r/\u03c3, normalized to\nthe neutral expectation N \u22121 . Again, the fitness variance is due to background selection rather than sweeps, but the effect on\nthe fixation probability is similar. These observations are consistent with the argument that from the perspective of a novel\nmutation, the nature of the fitness variation is irrelevant. What matters is the dynamics of the fitness of individual genotypes\nrelative to the mean: For background selection, the fitness of genotypes declines due to accumulation of deleterious mutations,\nwhile in the case of adaptation the mean increases steadily.\n\n103\n\n102\n\nallele freq spectrum, s0 = \u22120.004\n\nallele freq spectrum, s = 0.0\n\n102\n\n101\n\n10\n\n1\n\n10\u22121\n\n10\u22123\n\nr/\u03c3 = 1.89\n\nr/\u03c3 = 0.09\n\nr/\u03c3 = 3.77\n\nr/\u03c3 = 0.39\n\nr/\u03c3 = 7.54\n\nr/\u03c3 = 0.77\n\n100\n\n100\n\n10\u22122\n\nr/\u03c3 = 0.0\n\n10\u22121\n\nr/\u03c3 = 0.0\n\nr/\u03c3 = 1.89\n\nr/\u03c3 = 0.09\n\nr/\u03c3 = 3.77\n\nr/\u03c3 = 0.39\n\nr/\u03c3 = 7.54\n\n10\u22122\n\nr/\u03c3 = 0.77\n10\u22124 \u22124\n10\n\n10\u22123\n\n10\u22122\n\nallele frequency \u03bd\n\n10\u22121\n\n100\n\n10\u22123\n0.0\n\n0.2\n\n0.4\n\n0.6\n\nallele frequency \u03bd\n\n0.8\n\n1.0\n\nFIG. 11 Allele frequency spectra of neutral (left) and deleterious mutations (right) in a background selection scenario, in\nanalogy to Fig. 3b of the manuscript. At low recombination rates (r/\u03c3 < 1), the frequency spectrum of neutral mutations\nfalls off much more rapidly than expected in a neutral model, very similar to what is observed for the scenario of continuous\nadaptation. The predicted behavior \u223c \u03bd \u22122 is indicated by the steeper black line. Only when r/\u03c3 \u001d 1 does the spectrum agree\nwith the neutral prediction (\u223c \u03bd \u22121 indicated by upper straight black line). The right panel shows the frequency spectrum of\nthe deleterious mutations responsible for the fitness variation with effect size s0 = \u22120.004. At low recombination rates, allele\nfrequencies are close to fixation, either in the bad (\u03bd = 1) or the good (\u03bd = 0) state. At high recombination rates, the allele\nfrequency spectra are distributed around their equilibrium value \u03bd = \u03bc/s0 = 0.0625.\n\n\f"}