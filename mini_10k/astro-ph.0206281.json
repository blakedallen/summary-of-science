{"id": "http://arxiv.org/abs/astro-ph/0206281v1", "guidislink": true, "updated": "2002-06-17T15:08:35Z", "updated_parsed": [2002, 6, 17, 15, 8, 35, 0, 168, 0], "published": "2002-06-17T15:08:35Z", "published_parsed": [2002, 6, 17, 15, 8, 35, 0, 168, 0], "title": "A radiation-hydrodynamics scheme valid from the transport to the\n  diffusion limit", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0206016%2Castro-ph%2F0206009%2Castro-ph%2F0206344%2Castro-ph%2F0206153%2Castro-ph%2F0206232%2Castro-ph%2F0206115%2Castro-ph%2F0206206%2Castro-ph%2F0206112%2Castro-ph%2F0206141%2Castro-ph%2F0206292%2Castro-ph%2F0206464%2Castro-ph%2F0206354%2Castro-ph%2F0206281%2Castro-ph%2F0206146%2Castro-ph%2F0206168%2Castro-ph%2F0206212%2Castro-ph%2F0206294%2Castro-ph%2F0206167%2Castro-ph%2F0206313%2Castro-ph%2F0206429%2Castro-ph%2F0206084%2Castro-ph%2F0206002%2Castro-ph%2F0206325%2Castro-ph%2F0206237%2Castro-ph%2F0206028%2Castro-ph%2F0206001%2Castro-ph%2F0206100%2Castro-ph%2F0206018%2Castro-ph%2F0206150%2Castro-ph%2F0206476%2Castro-ph%2F0206213%2Castro-ph%2F0206050%2Castro-ph%2F0206299%2Castro-ph%2F0206059%2Castro-ph%2F0206272%2Castro-ph%2F0206357%2Castro-ph%2F0206058%2Castro-ph%2F0206045%2Castro-ph%2F0206311%2Castro-ph%2F0206304%2Castro-ph%2F0206170%2Castro-ph%2F0206393%2Castro-ph%2F0206253%2Castro-ph%2F0206192%2Castro-ph%2F0206384%2Castro-ph%2F0206152%2Castro-ph%2F0206435%2Castro-ph%2F0206446%2Castro-ph%2F0206207%2Castro-ph%2F0206063%2Castro-ph%2F0206264%2Castro-ph%2F0206451%2Castro-ph%2F0206509%2Castro-ph%2F0206110%2Castro-ph%2F0206442%2Castro-ph%2F0206488%2Castro-ph%2F0206147%2Castro-ph%2F0206470%2Castro-ph%2F0206178%2Castro-ph%2F0206327%2Castro-ph%2F0206173%2Castro-ph%2F0206072%2Castro-ph%2F0206093%2Castro-ph%2F0206419%2Castro-ph%2F0206510%2Castro-ph%2F0206391%2Castro-ph%2F0206249%2Castro-ph%2F0206351%2Castro-ph%2F0206078%2Castro-ph%2F0206054%2Castro-ph%2F0206130%2Castro-ph%2F0206037%2Castro-ph%2F0206169%2Castro-ph%2F0206224%2Castro-ph%2F0206427%2Castro-ph%2F0206102%2Castro-ph%2F0206085%2Castro-ph%2F0206432%2Castro-ph%2F0206019%2Castro-ph%2F0206163%2Castro-ph%2F0206120%2Castro-ph%2F0206501%2Castro-ph%2F0206039%2Castro-ph%2F0206437%2Castro-ph%2F0206111%2Castro-ph%2F0206060%2Castro-ph%2F0206005%2Castro-ph%2F0206479%2Castro-ph%2F0206290%2Castro-ph%2F0206394%2Castro-ph%2F0206026%2Castro-ph%2F0206199%2Castro-ph%2F0206122%2Castro-ph%2F0206492%2Castro-ph%2F0206030%2Castro-ph%2F0206098%2Castro-ph%2F0206066%2Castro-ph%2F0206268%2Castro-ph%2F0206347%2Castro-ph%2F0206449%2Castro-ph%2F0206416&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A radiation-hydrodynamics scheme valid from the transport to the\n  diffusion limit"}, "summary": "We present in this paper the numerical treatment of the coupling between\nhydrodynamics and radiative transfer. The fluid is modeled by classical\nconservation laws (mass, momentum and energy) and the radiation by the grey\nmoment $M_1$ system. The scheme introduced is able to compute accurate\nnumerical solution over a broad class of regimes from the transport to the\ndiffusive limits. We propose an asymptotic preserving modification of the HLLE\nscheme in order to treat correctly the diffusion limit. Several numerical\nresults are presented, which show that this approach is robust and have the\ncorrect behavior in both the diffusive and free-streaming limits. In the last\nnumerical example we test this approach on a complex physical case by\nconsidering the collapse of a gas cloud leading to a proto-stellar structure\nwhich, among other features, exhibits very steep opacity gradients.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=astro-ph%2F0206016%2Castro-ph%2F0206009%2Castro-ph%2F0206344%2Castro-ph%2F0206153%2Castro-ph%2F0206232%2Castro-ph%2F0206115%2Castro-ph%2F0206206%2Castro-ph%2F0206112%2Castro-ph%2F0206141%2Castro-ph%2F0206292%2Castro-ph%2F0206464%2Castro-ph%2F0206354%2Castro-ph%2F0206281%2Castro-ph%2F0206146%2Castro-ph%2F0206168%2Castro-ph%2F0206212%2Castro-ph%2F0206294%2Castro-ph%2F0206167%2Castro-ph%2F0206313%2Castro-ph%2F0206429%2Castro-ph%2F0206084%2Castro-ph%2F0206002%2Castro-ph%2F0206325%2Castro-ph%2F0206237%2Castro-ph%2F0206028%2Castro-ph%2F0206001%2Castro-ph%2F0206100%2Castro-ph%2F0206018%2Castro-ph%2F0206150%2Castro-ph%2F0206476%2Castro-ph%2F0206213%2Castro-ph%2F0206050%2Castro-ph%2F0206299%2Castro-ph%2F0206059%2Castro-ph%2F0206272%2Castro-ph%2F0206357%2Castro-ph%2F0206058%2Castro-ph%2F0206045%2Castro-ph%2F0206311%2Castro-ph%2F0206304%2Castro-ph%2F0206170%2Castro-ph%2F0206393%2Castro-ph%2F0206253%2Castro-ph%2F0206192%2Castro-ph%2F0206384%2Castro-ph%2F0206152%2Castro-ph%2F0206435%2Castro-ph%2F0206446%2Castro-ph%2F0206207%2Castro-ph%2F0206063%2Castro-ph%2F0206264%2Castro-ph%2F0206451%2Castro-ph%2F0206509%2Castro-ph%2F0206110%2Castro-ph%2F0206442%2Castro-ph%2F0206488%2Castro-ph%2F0206147%2Castro-ph%2F0206470%2Castro-ph%2F0206178%2Castro-ph%2F0206327%2Castro-ph%2F0206173%2Castro-ph%2F0206072%2Castro-ph%2F0206093%2Castro-ph%2F0206419%2Castro-ph%2F0206510%2Castro-ph%2F0206391%2Castro-ph%2F0206249%2Castro-ph%2F0206351%2Castro-ph%2F0206078%2Castro-ph%2F0206054%2Castro-ph%2F0206130%2Castro-ph%2F0206037%2Castro-ph%2F0206169%2Castro-ph%2F0206224%2Castro-ph%2F0206427%2Castro-ph%2F0206102%2Castro-ph%2F0206085%2Castro-ph%2F0206432%2Castro-ph%2F0206019%2Castro-ph%2F0206163%2Castro-ph%2F0206120%2Castro-ph%2F0206501%2Castro-ph%2F0206039%2Castro-ph%2F0206437%2Castro-ph%2F0206111%2Castro-ph%2F0206060%2Castro-ph%2F0206005%2Castro-ph%2F0206479%2Castro-ph%2F0206290%2Castro-ph%2F0206394%2Castro-ph%2F0206026%2Castro-ph%2F0206199%2Castro-ph%2F0206122%2Castro-ph%2F0206492%2Castro-ph%2F0206030%2Castro-ph%2F0206098%2Castro-ph%2F0206066%2Castro-ph%2F0206268%2Castro-ph%2F0206347%2Castro-ph%2F0206449%2Castro-ph%2F0206416&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present in this paper the numerical treatment of the coupling between\nhydrodynamics and radiative transfer. The fluid is modeled by classical\nconservation laws (mass, momentum and energy) and the radiation by the grey\nmoment $M_1$ system. The scheme introduced is able to compute accurate\nnumerical solution over a broad class of regimes from the transport to the\ndiffusive limits. We propose an asymptotic preserving modification of the HLLE\nscheme in order to treat correctly the diffusion limit. Several numerical\nresults are presented, which show that this approach is robust and have the\ncorrect behavior in both the diffusive and free-streaming limits. In the last\nnumerical example we test this approach on a complex physical case by\nconsidering the collapse of a gas cloud leading to a proto-stellar structure\nwhich, among other features, exhibits very steep opacity gradients."}, "authors": ["E. Audit", "P. Charrier", "J. -P. Chi\u00e8ze", "B. Dubroca"], "author_detail": {"name": "B. Dubroca"}, "author": "B. Dubroca", "arxiv_comment": "29 pages, submitted to Journal of Computational physics", "links": [{"href": "http://arxiv.org/abs/astro-ph/0206281v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/astro-ph/0206281v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/astro-ph/0206281v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/astro-ph/0206281v1", "journal_reference": null, "doi": null, "fulltext": "arXiv:astro-ph/0206281v1 17 Jun 2002\n\nA radiation-hydrodynamics scheme valid from the\ntransport to the diffusion limit.\nE. Audit\u2217, P. Charrier\u2020, J.-P. Chi\u00e8ze\u2217 and B. Dubroca\u2021\n\u2217 CEA/DSM/DAPNIA Service d'Astrophysique, CEA/Saclay 91191\nGif-sur-Yvette Cedex, France\n\u2020 Applied Mathematics, UMR-CNRS 5466, LRC-CEA M03, Universit\u00e9 Bordeaux\nI, 33405 Talence\n\u2021 CEA-CESTA, BP2, 33114 Le Barp\nE-mail: Edouard.Audit@cea.fr, Pierre.Charrier@math.u-bordeaux.fr,\njpchieze@cea.fr, Bruno.Dubroca@cea.fr\nVersion: May 7, 2002\nWe present in this paper the numerical treatment of the coupling between hydrodynamics and radiative transfer. The fluid is modeled by classical conservation laws (mass,\nmomentum and energy) and the radiation by the grey moment M1 system [5]. The scheme\nintroduced is able to compute accurate numerical solution over a broad class of regimes\nfrom the transport to the diffusive limits. We propose an asymptotic preserving modification of the HLLE scheme in order to treat correctly the diffusion limit. Several numerical\nresults are presented, which show that this approach is robust and have the correct behavior in both the diffusive and free-streaming limits. In the last numerical example we test\nthis approach on a complex physical case by considering the collapse of a gas cloud leading to a proto-stellar structure which, among other features, exhibits very steep opacity\ngradients.\n\nKey Words:\nRadiative transfer; radiation-hydrodynamics; diffusion limit;\ntransport; hyperbolic system; Godunov-type methods\n1. INTRODUCTION\nRadiation hydrodynamics plays an important role in astrophysics, laser fusion\nand plasma physics. For many years, efforts have been underway to develop mathematical models and numerical schemes to obtain accurate predictions at reasonable\ncomputing cost in this domain.\nOne of the main difficulty is to obtain accurate numerical computations in the\nvarious regimes that can be encountered due to values of material opacities which\ncan vary from several order of magnitude. This can be achieved by using the full\nradiative transfer equation but it is still out of range for complex simulations in\nparticular in two or three spatial dimensions. To overcome this difficulty several\nmodels have been derived. For large values of the material opacity, an asymptotic analysis leads to hyperbolic/parabolic systems of equation refered to as the\nequilibrium-diffusion limit or non equilibrium diffusion approximation ([12],[11],\n[10], [2]). On the other hand, for smaller values of the opacity the streaming limit\ncan be handled by using an hyperbolic system of equations coupling some closure\nof the moment system of the transfer equation with the hydrodynamic system ([12],\n1\n\n\f[11], [10],[1]) . Unfortunately for several real applications, such as radiative shocks\nor star formation, very different regimes are encountered in the same simulation.\nCoupling different models on various zones introduces large drawbacks due to the\ndomain partition and some loss of accuracy in the transitional zone.\nFrom a numerical point of view high-resolution schemes are necessary to take\ninto account the different space and time scales. Godunov-type schemes based on\nexact or approximate Riemann solvers are efficient for shock problems ([7], [14],\n[13]). In radiation hydrodynamics, without source terms, hydrodynamic and radiation equations decouple so that a Riemann solver for the entire system can easily\nbe derived from Riemann solvers for the hydrodynamic subsystem and for the radiation subsystem. Nevertheless, the difficulty of this approach is to obtain the\ncorrect diffusion limit for the scheme and correct behavior in transitional regime.\nLet us notice that the regime at the numerical level depends on the ratio of the\nmean free path of photons and the size of the local cell. An other difficulty is\nrelated to the time scales in the considered problems. In most cases radiation has\nto be treated implicitly since the time step given by usual CFL condition is much\ntoo small. When possible the hydrodynamics may be treated explicitly ([3]), but\nin some problems the time step given by the CFL condition on the hydrodynamic\nsubsystem is still too restrictive and hence a fully implicit approach is necessary.\nIn this paper we propose new model and numerical scheme to describe radiation\nhydrodynamics in a wide range of regimes. The equations for the fluid are the classical conservation laws (mass, momentum and energy). The radiation is described\nby the grey moment system of the transfer equation (radiative energy and radiative\nflux) with the M1 closure introduced in ([5]). This closure, based on the minimum\nentropy principle, is able to describe large anisotropy of the radiation while giving\nalso the correct diffusion limit. The Eddington factor is a non constant function\nof the reduce flux and therefore the radiation subsystem is a nonlinear hyperbolic\nsystem. Here, these equations are written in the comoving frame, introducing some\nnon conservative coupling terms. A Riemann solver is developped by performing a\nwave decomposition neglecting the nonconservative coupling terms and the source\nterms, which is trivial since the two subsystems then decouple. Afterwards the\nnonconservative terms are reintroduced in the scheme, by using in the radiation\nequations the velocity given by the hydrodynamic solver. This approach, natural\nin the streaming regime, can be improved to capture the diffusion limit. For that\npurpose the Riemann solver for the M1 subsystem is modified to take into account\nthe stiff relaxation term along the ideas developped in ([8]). With this modification our approach is able to correctly treat the streaming regime as well as the\ndiffusion regime with the same solver. Finally as radiative shocks or star formation\nsimulations need high resolution and very different time scales we describe the implementation of our radiation hydrodynamics solver in a moving grid-time implicit\nframework.\nThe outline of this paper is as follows. In the second section the equations of\nradiation hydrodynamics with the M1 -closure are given. In section 3 we present\nthe numerical methods for solving these equations. The actual implementation is\ndetailed in section 4. Numerical experiments are shown in section 5, first on radiative shocks to demonstrate the validity of our method in various regime, then on\nthe collapse of a gas cloud leading to a stellar-like structure. The last section is the\nconclusion of the paper.\n2\n\n\f2. THE PHYSICAL MODEL\nThe equations of grey radiative hydrodynamics under the assumption of local\nthermodynamic equilibrium can be found in ([11]). We have choosen in this work\nto use the radiative equation in the fluid (or comoving) frame :\n\u2202t \u03c1 +\n\n\u2207.[\u03c1u]\n\n=\n\n\u2202t \u03c1u +\n\n\u2207.[\u03c1u \u2297 u + P I]\n\n\u2202t E +\n\n\u2207.[u(E + P )]\n\n\u2202t Er + \u2207.[Er u] + \u2207.Fr + Pr : \u2207u\n2\n\n0\n\n(1)\n\n\u03ba\n=\n\u03c1Fr + F\nc\n\u03ba\n= \u2212\u03ba\u03c1c(ar T 4 \u2212 Er ) + ( \u03c1Fr + F ).u\nc\n= \u03ba\u03c1c(ar T 4 \u2212 Er )\n\n\u2202t Fr + \u2207.[Fr u] + c \u2207.Pr + (Fr .\u2207)u = \u2212\u03ba\u03c1cFr\n\n(2)\n(3)\n(4)\n(5)\n\nwhere \u03c1 is the matter density, u the velocity, E the total matter energy density, P\nand T the pressure and the temperature of the material, F the force density, Er\nthe radiative energy density, Fr the radiative flux, Pr the radiative pressure tensor\nand \u03ba the mean grey opacity.\nThe first part of the system (1)-(3) describe the evolution of the matter and the\nsecond one (4)-(5) the evolution of the radiation. These two fluids are coupled by\nthe exchange of energy and momentum through respectively the \u03ba\u03c1c(ar T 4 \u2212 Er )\nand \u03ba\u03c1Fr /c terms.\nIn order to close system (1)-(5) it is necessary to give two equations of state for\nthe flow and for the radiation. For the flow fields we assume a \u03b3-law p = (\u03b3 \u2212 1)\u03c1\u03b5\n(with \u03b3 = 5/3 in our applications). For the radiation fields we need a closure\nrelation giving the radiative pressure Pr in term of the radiative energy Er and\nof the radiative flux Fr . A rather simple closure is to assume that the radiative\nflux is isotrope which leads to the closure Pr = 31 Er . Such an approximation is by\nconstruction not very well suited to model flow containing large anisotropy in the\nradiative flux which is generally the case for radiative shocks. We will therefore\nuse the closure given by the M 1 model [5]. In this model, the radiative pressure is\ngiven by:\nPr = DEr\n\n(6)\n\nwhere the Eddington tensor D is defined by:\n3\u03c7 \u2212 1\n1\u2212\u03c7\nI+\nn\u2297n\n2\n2\n3 + 4|f |2\np\n\u03c7=\n5 + 2 4 \u2212 3|f |2\n\n(7)\n\nD=\n\nI is the identity matrix, \u03c7 the Eddington factor, f =\nn = f /|f | is a unit vector aligned with the radiative flux.\n\n3\n\n(8)\nFr\ncEr\n\nthe reduce flux and\n\n\fLet us remark that we can write the conservation of total (i.e. radiative and\nmaterial) momentum and energy. Neglecting terms in (u/c)2 and terms involving\nthe fluid acceleration this leads to the following equations\n1\nFr\nFr\nFr ) + \u2207.[\u03c1u \u2297 u + P I + Pr + u 2 ] = F \u2212 ( 2 .\u2207)u (9)\n2\nc\nc\nc\nFr\n(10)\n\u2202t (E + Er + u 2 ) + \u2207.[u(E + Er + P + Pr ) + Fr ] = F.u\nc\nSome authors make the choice to discretize directly the total mass, momentum\nand energy conservation equations with either the material or radiative momentum\nand energy equations to close the system. In this paper we prefere to work with the\nsystem (1)-(5) where the flow and the radiation play a more symmetric role. The\ncoupling between the flow and the radiation is done by the relaxation source terms\nand by the terms introduced by the comoving frame. The mathematical analysis\nof the hyperbolicity of this system do not take into account the source terms. The\nJacobian A of the system (1)-(5) can be written\n\u0013\n\u0012\nAhh\nAhr\n(11)\nA=\nArh\nArr\n\u2202t (\u03c1u +\n\nwhere the blocks are associated with the partitioning of unknowns between hydrodynamic variables (denoted h) and radiative variables (denoted r). The hydrodynamic\ndiagonal block Ahh is classical and writes\n\uf8eb\n\uf8f6\n0\n1\n0\nu2\n\uf8ec\n\u2212(\u03b3 \u2212 3)u\n\u03b3 \u2212 1\uf8f7\nAhh = \uf8ed\n(12)\n\uf8f8\n\u0010 (\u03b3 \u2212 3) 2\n\u0011\nu2\n2\n\u2212u H \u2212 (\u03b3 \u2212 1) 2\nH \u2212 (\u03b3 \u2212 1)u\nu\u03b3\nwhere H = \u01eb + p/\u03c1 + u2 /2 is the total enthalpy of the flow. Since the radiative\nvariables do not appear in the left-hand-side of the hydrodynamic equations we\nhave\n\uf8eb\n\uf8f6\n0 0\nAhr = \uf8ed0 0\uf8f8 ,\n(13)\n0 0\n\nThe radiative diagonal block Arr for the M1 subsystem in the comoving frame\ndepends on the velocity of the flow and writes\n\u0012\n\u0013\nu\n1\nArr = 2\n.\n(14)\nc (\u03c7(f ) \u2212 \u03c7\u2032 (f )f ) u + c\u03c7\u2032 (f )\n\nFinally, the off-diagonal block due to the influence of hydrodynamic on the left-hand\nside of the radiative equations can be stated\n\u0012\n\u0013\n1 \u2212u(Er + Pr ) (Er + Pr ) 0\n.\n(15)\nArh =\n\u2212uFr\nFr\n0\n\u03c1\nSince the jacobian matrix A is a block lower triangular matrix its spectrum can\neasily be computed and is composed of the eigenvalues of the hydrodynamic subsystem, i.e. u \u2212 a, u, u + a, where a is the speed of sound and of \u03bb\u2212 + u and\n\u03bb+ + u where \u03bb\u2212 and \u03bb+ are the eigenvalues of the M1-radiation subsystem in the\nlaboratory frame (cf. [5] and section 3.3). We remark that the nonconservative\ncoupling terms (Pr : \u2207u and Fr .\u2207 u) appear only in the off-diagonal block Arh\nand thus do not influence the signal velocities of the whole system.\n4\n\n\f3. NUMERICAL TREATMENT\nThe nonconservative form of the radiation-hydrodynamics system prevents using classical Godunov type scheme without care. In this paper we focus on some\napplications such as radiative shocks or collapse of a gas cloud where various regime\nare encountered in the same simulations.\nOur numerical strategy is the following. The conservative system obtained\nby dropping the nonconservative coupling terms is dicretized by a Godunov-type\nscheme based on a Riemann solver and the nonconservative terms are discretized\nusing the same values as in this Riemann solver at the same time step. As we will\nsee in the next sections the construction of the Riemann solver for the conservative system is quite simplified by the lower triangular structure and merely reduces\nto the construction of two decoupled Riemann solvers for the hydrodynamic and\nradiation subsystems.\nThe relaxation terms introduce an other kind of difficulty. For large value of\nthe opacity they are stiff and an asymptotic analysis shows that the total energy\nis governed by a diffusion equation. This regime is commonly referred to as the\nequilibrium-diffusion limit ([11],[12]). To capture this regime with the above system\nwe must treat carefully the relaxation terms using an asymptotic preserving scheme\nfollowing the ideas introduced in ([8]). This will be detailed in section 3.3.2. Finally\nequations (1), (9) and (10) show that in a stationnary shock between two states\nwhere radiation is in equilibrium with material, the two states satisfy RankineHugoniot relations involving both the radiative and material quantities. We will\nshow in sections 5.1 and 5.2 that our numerical scheme satisfies these relations even\nwhen there is large energy transfer between matter and radiation.\nIn many astrophysical situations physical quantities vary over many orders of\nmagnitude in a very steep way. To deal which such situations, the adaptive grid\ntechnic proposed by Dorfy and Drury [4] (thereafter DD) is very well suited. We\nhave therefore choosen to implement our radiative-hydrodynamical scheme on such\na grid. However, the numerical schemes presented below can also be applied on a\nstatic eulerian grid which would be better suited for multi-dimensionnal simulations.\nLet us first start with some general remarks and notations. Space is discretized\ninto computational zones centered on points ri . The grid interfaces are located at\nri\u00b11/2 . The volume of a zone is given by:\n\u2206vi =\n\n(\n\n4\n3\n3 \u03c0(ri+ 21\n\n3\n\u2212 ri\u2212\n1)\n\nin spherical geometry\n\n2\n\nri+ 21 \u2212 ri\u2212 12 = \u2206ri\n\nin slab geometry (assuming a unit surface)\n\nSubscripts (i, i + 12 , i + 1...) always stand for the space coordinates, while superscipts (n, n + 21 ...) indicate time. Variables at time n + 12 are defined by:\nn+ 21\n\nXi\n\n= (1 \u2212 \u03b1)Xin + \u03b1Xin+1\n\n\u03b1 \u2208 [0, 1]\n\nfor \u03b1 = 0 the scheme will be explicit and for \u03b1 = 1 it will be fully implicit. We also\nintroduce the following notations which are useful to have more compact equations:\nX[i\u00b1 12 ] = (Xi+ 12 \u2212 Xi\u2212 21 )\n\nand\n5\n\nX [n] = (X n+1 \u2212 X n )\n\n\fSubscript and superscript are always distributive:\nn\nn\nn\nn\n(XY )n[i\u00b1 1 ] = Xi+\n1Y\ni+ 1 \u2212 Xi\u2212 1 Yi\u2212 1\n2\n\n2\n\n3.1.\n\n2\n\n2\n\n2\n\nThe grid\n\nIn the following, we briefly summarize the adaptive grid method of DD. The\ngrid concentration is defined by:\nni =\n\nL\nri+ 12 \u2212 ri\u2212 21\n\nwhere L is a typical length. If L is a constant, a uniform concentration corresponds\nto a uniform grid and if L = ri a uniform concentration corresponds to a logarithmic\ngrid. This later case is useful for spherical geometry.\nThe basic idea of DD is to demand that n is proportional to a resolution function R. This means that there will be a large number of gridpoints wherever the\nresolution function is large. The resolution function depends on the nature of the\nproblems being solved, but it is most of the time a function of the magnitude of\nthe gradient of the physical quantities in order to have a large number of gridpoints\nwhere there are steep features in the flow.\nIn order for the grid to be computationally tractable it is also necessary to\nensure that adjacent zones have roughly the same size and that the grid adaptation\ntime is not too small compared to physical time scale. These two conditions are\nfulfilled using the following equation:\nn\u0302i = ni \u2212 \u03b1g (\u03b1g + 1)(ni\u22121 \u2212 2ni + ni+1 )\n\u03c4g n\n\u00f1ni = n\u0302ni +\n(n\u0302 \u2212 n\u0302in\u22121 )\n\u2206t i\n\n(16)\n(17)\n\nwhere \u03b1g is the grid rigidity and \u03c4g the grid time-scale. Equation (16) ensures\nthat the grid concentration does not vary from more than a factor (\u03b1g + 1)/\u03b1g\nbetween to adjacent zones and equation (17) set the time-scale on which the grid\ncan readjust itself.\nThe final form of the grid equation is then:\n\u00f1i+1\n\u00f1i\n=\nRi+1\nRi\n\n(18)\n\nThis equation depends both on the grid coordinates ri and on the physical\nquantities entering the resolution function R.\n3.2.\n\nThe hydrodynamics\n\nIn one dimension and taking into account the moving grid equations (1)-(3) can\nbe written:\n\uf8f1\n\u2202t \u03c1S\n+ \u2202r [\u03c1S(u \u2212 ug )]\n= 0\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2 \u2202 \u03c1Su + \u2202 [\u03c1Su(u \u2212 u ) + P S] = P \u2202 S + S( \u03ba \u03c1F + F )\nr\nt\nr\ng\nr\nc\n(19)\n4\n\uf8f4\n\u2202\nES\n+\n\u2202\n[ES(u\n\u2212\nu\n)\n+\nP\nSu]\n=\n\u2212S\u03ba\u03c1c(a\nT\n\u2212\nEr )\nt\nr\ng\nr\n\uf8f4\n\uf8f4\n\uf8f3\n\u2212S( \u03bac \u03c1Fr + F ).u\n6\n\n\fwhere ug is the grid velocity and the surface S equals 1 in slab geometry and 4\u03c0r2\nin spherical geometry.\nThe left hand side of system (19) is an hyperbolic system for the variables \u03c1S,\n\u03c1Su and SE. Now, by introducing the moment vector U = (\u03c1, \u03c1u, E) and the\nphysical flux vector F (U) = (\u03c1u, p + \u03c1u2 , u(E + P )), the hyperbolic part of system\n(19) can be written under the following form:\n\u2202t (SU) + \u2202r [S(F (U) \u2212 ug SU)] = 0.\n\n(20)\n\nAs the physical flux vector is a degree one homogeneous vector valued function\n(SF (U) = F (SU)), if we set \u00db = SU, the hyperbolic part (20) can be rewritten as:\n\u0011\n\u0010\n(21)\n\u2202t \u00db + \u2202r F (\u00db) \u2212 ug \u00db = 0.\n\nThe system (21) can be solved using an exact Riemann solver (Godunov scheme):\n1\n\n\u0011[n] \u0010\n\u0011n+ 2\n1 \u0010\n\u00db\u2206r\n+ F (\u00db \u2217 ) \u2212 ug \u00db \u2217\n=0\n\u2206t\ni\n[i\u00b1 12 ]\n\n(22)\n\n\u2217\nThe state \u00dbi+\n1 is the solution on the line r/t = 0 of the Riemann problem\n2\nbetween the cell i and i + 1 involving the following initial conditions:\n(\n\u2212\nfor r < 0,\n\u00db (0, r) = Si+ 21 Ui+\n1\n2\n(23)\n+\n\u00db (0, r) = Si+ 12 Ui+ 1 for r > 0,\n2\n\n\u2212\n+\nare\nwhere Si+ 21 is the surface associated with interface i + 21 . Ui+\n1 and U\ni+ 12\n2\nthe trace of U from the cell i and i + 1. For a first order scheme (no Van-Leer\n+\n\u2212\n= Ui+1 . (for details about the solution of the\nextrapolation) Ui+\n1 = Ui and U\ni+ 12\n2\nRiemann problem see [14])\nWe can note that we have used the solution of Riemann problem based on\nF (\u00db ) \u2212 ug \u00db instead of F (\u00db) flux. In fact, by the Galilean invariance of Euler\nequations, the solution of Riemann problem for F (\u00db) \u2212 ug \u00db flux on r/t = 0 is the\nsame as the solution of Riemann problem for F (\u00db) flux on r/t = ug .\nUnfortunately, the uniform flow is not a numerical solution of the scheme (22).\nTo satisfy this property, the mesh geometry must be solution of a balance equation\ncalled geometric conservation law (GCL):\n\n\u0011[n] \u0010\n\u0011n+ 12\n1 \u0010\n\u2212 Sug\nS\u2206r\n= 0.\n\u2206t\n[i\u00b1 21 ]\ni\n\n(24)\n\nOf course, this relation is false for the spherical case. Moreover, if the product\nSi \u2206ri has been replaced by the volume of a cell \u2206vi , a new numerical scheme is\nobtained which satisfies a GCL balance law:\n\u0011n+ 21\n1 \u0010 \u0011[n] \u0010\n= 0,\n(25)\n\u2206v\n\u2212 Sug\n\u2206t\n[i\u00b1 12 ]\ni\n\u0011[n] \u0010\n\u0011n+ 12\n1 \u0010\nU\u2206v\n= 0.\n+ F (\u00db \u2217 ) \u2212 ug \u00db \u2217\n\u2206t\ni\n[i\u00b1 12 ]\n7\n\n(26)\n\n\fThe uniform flows are numerical solutions of the scheme (26). Hence, the whole\nnumerical scheme about system (19) can be written now under the following form:\n\u0011[n]\n\u0001n+ 1\n1 \u0010\n\u03c1\u2206v\n+ \u03c1\u2217 (u\u2217 \u2212 ug ) [i\u00b1 21 ] = 0\n(27)\n2\n\u2206t\ni\n\u0011[n]\n\u0001n+ 1\n1 \u0010\n\u03c1u\u2206v\n+ \u03c1\u2217 u\u2217 (u\u2217 \u2212 ug ) + P \u2217 [i\u00b1 21 ] =\n2\n\u2206t\ni\n\u0011n+ 12\n\u0010\n\u03ba\n\u2202r S P \u2206r + ( \u03c1Fr + F )\u2206v\nc\ni\n\n(28)\n\n\u0011[n]\n\u0001n+ 1\n1 \u0010\nE\u2206v\n+ E \u2217 (u\u2217 \u2212 ug ) + P \u2217 u\u2217 [i\u00b1 21 ] =\n2\n\u2206t\ni\n\u0010\n\u0001 \u0011n+ 21\n\u03ba\n\u03ba\u03c1c(ar T 4 \u2212 Er ) + ( \u03c1Fr + F )u \u2206v\nc\ni\n3.3.\n\n(29)\n\nSolving for the radiative transfer\n\nTo simplify the presentation, we will first study the radiative transfer in a frozen\nmedium and in a slab geometry. In this case, system (4)-(5) gives\n4\n\u2212 Er )\n\u2202t Er + \u2202x Fr = \u03c3c(aTm\n\n(30)\n\n2\n\n\u2202t Fr + c \u2202x Pr = \u2212\u03c3cF r\n\n(31)\n\nwhere we have defined \u03c3 = \u03ba\u03c1. Using the M1 closure, the radiative pressure is\ngiven by :\nPr = \u03c7Er =\n\n3 + 4f 2\np\nEr\n5 + 2 4 \u2212 3f 2\n\nwhere\n\nf=\n\nFr\ncEr\n\n(32)\n\nThe previous sytem is a hyperbolic one which can be writen under the following\nform:\n\u2202t U + \u2202x F (U) = S(U)\n\n(33)\n\nwith\n\u0012 \u0013\nEr\nU=\nFr\n\nF (U) =\n\n\u0012\n\nFr\nc2 \u03c7Er\n\n\u0013\n\n\u0012\n\u0013\n4\n\u03c3c(aTm\n\u2212 Er )\nS(U) =\n\u2212\u03c3cF\n\n(34)\n\nU is the moment vector, F the physical flux vector and S the source term vector.\nThe Jacobian matrix J of this system is a function of f and c and is given by:\n\u0012\n\u0013\n\u2202F (U)\n0\n1\nJ(U) =\n= 2\nc (\u03c7(f ) \u2212 \u03c7\u2032 (f )f ) c\u03c7\u2032 (f )\n\u2202U\nThe eigenvalues, \u03bb\u2212 , \u03bb+ (\u03bb\u2212 < \u03bb+ ) of the matrix J can now be calculated:\np\n\u03c7\u2032 (f ) \u2212 \u03c7\u2032 (f )2 \u2212 4f \u03c7\u2032 (f ) + 4\u03c7(f )\n\u2212\nc,\n(35a)\n\u03bb =\n2\np\n\u03c7\u2032 (f ) + \u03c7\u2032 (f )2 \u2212 4f \u03c7\u2032 (f ) + 4\u03c7(f )\n\u03bb+ =\nc.\n(35b)\n2\n8\n\n\fThe eigenvalues, \u03bb\u2212 and \u03bb+ , of J are plotted in figure\n\u221a [1-A]. At radiative equilibrium (when f = 0), the eigenvalues are equal to \u00b1c/ 3, which is a direct consequence of the isotropy of underlying distribution function of the photons. On\nthe other hand, in the case of extreme non-equilibrium, when f = 1 (resp. f = \u22121\n), the eigenvalues are degenerated and are equals to c (resp. \u2212c). This case corresponds to the free-streaming limit where all the photons move towards the same\ndirection. It is important to note that in the case of a constant\n\u221a Eddington factor\n(\u03c7 = 1/3), the eigenvalues are also constant and equal to \u00b1c/ 3, which means that\na light front can not propagate at the speed of light, as it should.\n\nA\n\nB\n\n+\n\nC\n\nFIG. 1 eigenvalues of M1 , \u03bbc (full line) and \u03bbc (dashed line) according to f =\nthe normalized flux for \u01eb = 1 (A),\u01eb = 0.5 (B) and \u01eb = 0 (C),\n\n3.3.1.\n\n\u2212\n\nFr\ncEr ,\n\nNumerical approximation of P1 and M1 by the HLLE approximate Riemann\nsolver\n\nThe system (30)-(31) can be discretized using a Godunov method based on the\nHLLE approximate Rieamann solver (see [6]). Hence, we need to find an estimation of the largest and smallest physical signal-velocities in the exact solution to\nthe Rieamann problem. This estimation involves the eigenvalues of the Roe's linearization for the M1 model. The M1 Roe's matrix Ji+ 21 between i and i + 1 states\ncan be written as:\n\nJi+ 21 =\n\n\u0012\n\n0\nc2 (\u03c7a \u2212 \u03c7\u2032m fa )\n\n9\n\n\u0013\n1\n,\nc\u03c7\u2032m\n\n\fwhere\nfi + fi+1\nfa =\n,\n2\n\n\u03c7(fi ) + \u03c7(fi+1 )\n\u03c7a =\n,\n2\n\n\u03c7\u2032m\n\n=\n\n( \u03c7(f\n\ni+1 )\u2212\u03c7(fi )\nfi+1 \u2212fi\n\n\u2032\n\n\u03c7 (fi )\n\nif fi 6= fi+1 ,\nelse.\n\n, \u03bb+\n(\u03bb\u2212\n< \u03bb+\n) of the matrix Ji+ 21 can now be calThe eigenvalues, \u03bb\u2212\ni+ 12\ni+ 21\ni+ 12\ni+ 21\nculated:\nq\n\u2032\n\u03c7\u2032m 2 \u2212 4fa \u03c7\u2032m + 4\u03c7a\n\u03c7\n\u2212\nm\n\u2212\n\u03bbi+ 1 =\nc,\n(36a)\n2\n2\nq\n\u03c7\u2032m + \u03c7\u2032m 2 \u2212 4fa \u03c7\u2032m + 4\u03c7a\n\u03bb+\nc.\n(36b)\n1 =\ni+ 2\n2\n, the numerical flux function\nOnce knowing the numerical signal velocities \u03bb\u00b1\ni+ 21\nFi+ 12 between cells i and i + 1 can be written under the following form:\n( +\n+\na = max(\u03bb+\na+ Fi \u2212 a\u2212 Fi+1 + a+ a\u2212 (Ui+1 \u2212 Ui )\ni+1 , \u03bbi+ 1 , 0),\n2\nwhere\nFi+ 12 =\n\u2212\na+ \u2212 a\u2212\na\u2212 = min(\u03bb\u2212\ni , \u03bbi+ 1 , 0).\n2\n\nThe system (30)-(31) can then be discretized in conservative form:\nn+ 1\n\nn+ 1\n\nn+1\nn\nFr,i+21 \u2212 Fr,i\u221221\nEr,i\n\u2212 Er,i\nn+ 1\nn+ 1\n4\n2\n2\n\u2212 Er,i 2 )\n+\n= \u03c3i 2 c(ar Tm\n\u2206t\n\u2206x\nn+ 1\n\nn+ 1\n\nn+1\nn\nPr,i+21 \u2212 Pr,i\u221221\nFr,i\n\u2212 Fr,i\nn+ 1\nn+ 1\n2\n2\n+ c2\n= \u2212\u03c3i 2 cFr,i 2\n\u2206t\n\u2206x\n\n3.3.2.\n\n(37)\n(38)\n\nScheme modification to enforce asymptotic limit\n\nAs we mentionned before, one of the important difficulties of radiative transfer\nis to be able to deal with very different regimes. It is therefore important to ensure\nthat our scheme has the correct limiting behavior both in the free-streaming and\ndiffusive regimes.\nIn order to illustrate these points in a simple maner we will consider wave speeds\nequal to the speed of light (i.e. a+ = \u2212a\u2212 = c) and a constant Eddington factor\n\u03c7 = 1/3 (resp. 1) in the diffusive (resp. free-streaming) regime. The discretized\nequations then take the following form:\nn+ 1\n\nn+ 1\n\nn+1\nn\n2\n2\nFr,i+1\nEr,i\n\u2212 Er,i\n\u2212 Fr,i\u22121\nc\nn+ 1\nn+ 21\nn+ 1\nn+ 1\nn+ 1\n4\n) = \u03c3i 2 c(ar Tm\n\u2212 Er,i 2 )\n+\n\u2212\n(E 2 \u2212 2Ei 2 + Er,i\u22121\n\u2206t\n2\u2206x\n2\u2206x r,i+1\nn+ 1\n\nn+ 1\n\nn+1\nn\n2\n2\nEr,i+1\nFr,i\n\u2212 Fr,i\n\u2212 Er,i\u22121\nc\nn+ 1\nn+ 1\nn+ 12\nn+ 1\nn+ 1\n+ c2 \u03c7\n\u2212\n(Fr,i+12 \u2212 2Fr,i 2 + Fr,i\u22121\n) = \u2212\u03c3i 2 cFr,i 2\n\u2206t\n2\u2206x\n2\u2206x\nthe modified equations actually solved by the numerical scheme are therefore:\n\nc\n4\n\u2212 Er )\n\u2202t Er + \u2202x Fr \u2212 \u2206x\u2202x2 Er = \u03c3c(aTm\n2\nc\u2206x 2\n\u2202 Fr = \u2212\u03c3cFr\n\u2202t Fr + c2 \u03c7\u2202x Er \u2212\n2 x\n10\n\n(39)\n(40)\n\n\fFree-streaming regime\nLet us first consider the case of light freely propagating in vaccum (i.e. \u03c3 = 0.) with\nall the photons going in the same direction (i.e. F = cE). The resulting equation\nfor the energy of the radiation is then:\n\n\u2202t E + c\u2202x Er \u2212\n\nc\u2206x 2\n\u2202 Er = 0.\n2 x\n\n(41)\n\nThis equation is the exact advection equation with an added numerical diffusion\nterm. The single mode solutions of the exact equation are of the form: Er =\nEr,0 cos(2\u03c0/\u03bb(ct \u2212 x)). For this mode and under CFL condition the variation of\nenergy due to the diffusion term can be estimated:\nc\u2206x\n\u2206Er\n4\u03c0 2 c\u2206t\u2206x \u0010 \u2206x \u00112\n4\u03c0 2\n\u2206Er\n=\n\u223c\n=\nEr,0 2 \u21d2\n\u2206t\n2\n\u03bb\nEr,0\n2\n\u03bb2\n\u03bb\nIf the wave-length of the perturbation is properly sampled by the grid the diffusion\nterm will always remain negligible. As could be expected, there will be some diffusion for very sharp energy profiles. In actual simulations, this diffusion will be\nfurther reduced by taking into account the proper waves speed and we will show in\nthe next section that it remains acceptable.\nDiffusive regime\nLet us now examine the diffusive regime. In this case, the temporal variation of\nthe radiative flux can be neglected. Equation (40) then gives at first order:\nFr \u2243 \u2212\n\nc\n\u2202x Er\n3\u03c3\n\n(42)\n\ninserting the previous expression into equation (39) one gets:\n\n\u2202t Er \u2212\n\n3\u03c3\u2206x 2\nc\n4\n(1 +\n)\u2202x Er = \u03c3c(aTm\n\u2212 Er )\n3\u03c3\n2\n\n(43)\n\nThe equation obtained for Er is indeed a diffusion equation. Furthermore, if\nthe grid is sufficiently fine so that \u03c3\u2206x << 1, the diffusion coefficient is the right\none. One the other hand, if the grid does not sample the photon mean free path\n(\u03c3\u2206x >> 1), the diffusion coefficient is then dominated by a purely numerical\nterm and it is therefore much larger than it should. With this simple analysis it is\npossible to explain some of our numerical results. For a coarse grid, the effective\ndiffusion coefficient is too large and the thermal precursor is therefore longer. This\nwrong behavior in the diffusive regime is not a caracteristic of the HLLE scheme\nwe have used. In any Godounov type method the divergence is discretized as the\nsum of a centered term and numerical diffusion term. This last term is absolutly\nnecessary to ensure the stability of the scheme. Generally this term is proportionnal\nto \u2206xn , (n = 1, 2). When the mean free path of photon is much smaller than \u2206x,\nthe numerical diffusion term can become dominant, as we have just seen.\nIn order to have a scheme which reproduces correctly the diffusion limit, it is\ntherefore necessary to explicitly take into account the smallness of the photon mean\nfree path. We present below such a scheme.\n11\n\n\fWe first write the system of equation (30)-(31) in a dimensionless way. For\nthat purpose we consider a characteristic length l and we defined the following\nquantities:\n1\nct\nt\u0303 = 2\n\u03c3l\n\u03c3l\nthe system (30-31) can then be written:\n\u01eb=\n\nx\u0303 =\n\nx\nl\n\nFr\nF \u0303r =\nc\u01eb\n\n4\n(aTm\n\u2212 Er )\n\u01eb2\n1\n1\n\u2202t\u0303 F \u0303r + 2 \u2202x\u0303 \u03c7Er = \u2212 2 F \u0303r\n\u01eb\n\u01eb\n\n\u2202t\u0303 Er + \u2202x\u0303 F \u0303r =\n\n(44)\n(45)\n\nThe difficulty raised by the diffusive limit is highlighted in equation (45). When\n\u01eb is very small, the hyperbolic system (44)-(45) becomes very stiff because of the\nsecond term of equation (45) (the jacobian condition number \u2192 \u221e when \u01eb \u2192 0).\nAn interesting way to overcome this difficulty is to transform the previous system\nin a non-stiff hyperbolic system with stiff source term [8]. Equation (45) can be\nwritten :\n\u2202t\u0303 F \u0303r + \u2202x\u0303 \u03c7Er = \u2212\n\n1\n(F\u0303 + (1 \u2212 \u01eb2 )\u2202x\u0303 \u03c7Er )\n\u01eb2\n\n(46)\n\nThe new system to be integrated is now composed of equations (44) and (46).\nIn order to integrate this system the hyperbolic terms (to the left of the equal sign)\nwill be treated by the Godounov type method presented above, whereas the other\nterms (to the right of the equal sign) will be treated as source terms. Which means\nthat they will be discretized in a purely centered manner. When \u01eb = 1 the sytem\n(44)-(46) is identical to system (30)-(31) and gives the correct transport regime.\nBut when \u01eb \u2192 0, the source term in equation (46) becomes dominant and gives the\ncorrect radiative flux in the diffusion limit. Furthermore, because of the change of\nF into F \u0303r , the numerical diffusion term in equation (30) has been multiplied by \u01eb\nand will therefore always remain small.\nThe hyperbolic system to be solved is now:\n(\n\n\u2202t\u0303 Er + \u2202x\u0303 F \u0303r = 0\n\u2202t\u0303 F \u0303r + \u2202x\u0303 \u03c7Er = 0\n\n(47)\n\nAs previously done, we will integrate the above system using a approximate\nHLLE Riemann solver. The Jacobian of the system (47) is:\n\u0014\n\n0\nJ=\n\u03c7 \u2212 f \u03c7\u2032\n\n1\n\u01eb\u03c7\u2032\n\n\u0015\n\nwith f = Fr /cEr , \u03c7 = \u03c7(f ) and \u03c7\u2032 =\n\nThe eigenvalues, \u03bb\u0303+ and \u03bb\u0303\u2212 (\u03bb\u0303+ > \u03bb\u0303\u2212 ), of the Jacobian are given by:\n\u0010\n\u0011\np\n\u01eb\u03c7\u2032 \u00b1 (\u01eb\u03c7\u2032 )2 + 4(\u03c7 \u2212 f \u03c7\u2032 )\n\u03bb\u0303\u00b1 =\n2\n\n12\n\nd\u03c7(f )\ndf\n\n\fIt is worth noticing that in order to keep the previous eigenvalues real one must\nhave (\u01eb\u03c7\u2032 )2 + 4(\u03c7 \u2212 f \u03c7\u2032 ) \u2265 0. Therefore, for a given value of f there is a minimum\npossible value (\u01ebmin ) for the \u01eb parameter.\n(f \u03c7\u2032 \u2212 \u03c7) is an increasing function of\n\u221a\nf which vanishes for f = f0 = 2 3/5. Thus, if f < f0 there is not constraint on\nthe value of \u01eb (i.e. \u01ebmin = 0) but if f > f0 there is a strictly positive minimum\nvalue for \u01eb. The function \u01ebmin (f ) is plotted on figure (2). These limitations on\n\u01eb eventhough they have a mathematical origin, are physically justified since they\nimply that when the radiative flux is high one can not tend toward the diffusion\nscheme. Futhermore, we can deduce from system (47) and from the fact that the\nM1 model has an intrinsic flux limitation that f \u0303 = F\u0303r /cEr \u2264 1. It is therefore\nimportant to always keep \u01eb > f in order to compute correctly the radiative flux.\nIn this case, we need also to find as in the previous subsection an estimation of\nthe largest and smallest physical signal velocities in the exact solution to the Riemann problem. This estimation involves the eigenvalues of the Roe's linearization\nfor modified M1 model (47). The Roe's matrix Ji+ 12 for this model can be written\nunder the following form:\n\u0012\n\u0013\n0\n1\nJi+ 21 =\n,\n(\u03c7a \u2212 \u03c7\u2032m fa ) \u01eb\u03c7\u2032m\nwhere we have used the same notation as in the previous section. The eigenvalues\nof this matrix are:\n\u03bb\u0303\u00b1\ni+ 1\n2\n\n=\n\u03bb\u0303\u00b1\ni+ 1\n2\n\n\u0010\n\n\u01eb\u03c7\u2032m \u00b1\n\n\u0011\np\n(\u01eb\u03c7\u2032m )2 + 4(\u03c7a \u2212 fa \u03c7\u2032m )\n2\n\n.\n\nAs in the previous case, one can give an estimation of the largest and smallest\nphysical signal velocities:\n+\n\u00e3+ = max(\u03bb\u0303+\ni+1 , \u03bb\u0303i+ 1 , 0),\n2\n\n\u2212\n\u00e3\u2212 = min(\u03bb\u0303\u2212\ni , \u03bb\u0303i+ 1 , 0).\n\n(48)\n\n2\n\nUsing the HLLE solver gives the following expressions for the flux:\nF\u0303r,i+ 12 =\n\n\u00e3+ \u00e3\u2212\n\u00e3+ F\u0303r,i \u2212 \u00e3\u2212 F\u0303r,i+1\n+\n(Er,i+1 \u2212 Er,i )\n\u00e3+ \u2212 \u00e3\u2212\n\u00e3+ \u2212 \u00e3\u2212\n\n(49)\n\nPr,i+ 21 =\n\n\u00e3+ Pr,i \u2212 \u00e3\u2212 Pr,i+1\n\u00e3+ \u00e3\u2212\n+\n(F\u0303r,i+1 \u2212 F\u0303r,i )\n\u00e3+ \u2212 \u00e3\u2212\n\u00e3+ \u2212 \u00e3\u2212\n\n(50)\n\nRewritting the system in the original variables, we get the following discretisation for the M1 model:\n1\n(E n+1 \u2212 Ern )i +\n\u2206t r\n1\n(F n+1 \u2212 Frn )i +\n\u2206t r\n\n1\n1\nn+ 1\n(Fr,i+ 21 \u2212 Fr,i\u2212 12 )n+ 2 = \u03c3c(ar T 4 \u2212 Er )i 2\n\u2206r\nc2\nn+ 1\nn+ 12\n1 \u2212 P\u0302\n= \u2212\u03c3cFr,i 2\n(P\u0302\nr,i\u2212 12 )\n\u2206r r,i+ 2\n\nwhere we have defined:\nP\u0302r,i+ 12 = \u01eb2 Pr,i+ 12 + (1 \u2212 \u01eb2 )(Pr,i+1 + Pr,i )/2\n13\n\nand\n\nFr,i\u00b1 12 = c\u01ebF\u0303r,i\u00b1 21\n\n(51)\n(52)\n\n\fFIG. 2 Minimum value of the \u01eb parameter in order to keep real the eigenvalues \u03bb\u0303+\nand \u03bb\u0303\u2212 plotted as a function of the reduce flux f = Fr /cEr .\nThe method is easily extended to the radiation subsystem written in the comoving frame but where the nonconservative terms are dropped and with a moving\ngrid. The sytem then writes\n4\n\u2212 Er ),\n\u2202t Er + \u2202x ((u \u2212 ug )Er ) + \u2202x Fr = \u03c3c(ar Tm\n2\n\n\u2202t Fr + \u2202x ((u \u2212 ug )Fr ) + c \u2202x Pr = \u2212\u03c3cF r,\n\n(53)\n(54)\n\nThe non-conservative terms are dropped for the present analysis but they must\nnaturally be taken into account as will be detailed in the next section. The previous\nsysteme can be written in a dimensionless way\n4\n(aTm\n\u2212 Er )\n\u0169\n,\n\u2202t\u0303 Er + \u2202x\u0303 ( Er + F \u0303r ) =\n\u01eb\n\u01eb2\n1\n1\n1\n\u2202t\u0303 F \u0303r + 2 \u2202x\u0303 \u03c7Er + \u2202x\u0303 (\u0169F \u0303r ) = \u2212 2 F \u0303r ,\n\u01eb\n\u01eb\n\u01eb\n\n(55)\n(56)\n\nwhere\n\nu \u2212 ug\n*\nc\nAs for the system (44)-(45) we transform the previous system in a non-stiff\nhyperbolic system with stiff source term\n\u0169 =\n\n\u0001\n1\n4\n(aTm\n\u2212 Er ) \u2212 \u01eb(1 \u2212 \u01eb)\u2202x\u0303 (\u0169Er ) ,\n\u01eb2\n\u0011\n1 \u0010\n\u2202t\u0303 F \u0303r + \u2202x\u0303 (\u03c7Er + \u0169F \u0303r ) = \u2212 2 F\u0303 + (1 \u2212 \u01eb2 )\u2202x\u0303 \u03c7Er + \u01eb(1 \u2212 \u01eb)\u2202x\u0303 (\u0169F \u0303r ) ,\n\u01eb\n\u2202t\u0303 Er + \u2202x\u0303 (\u0169Er + F \u0303r ) =\n\nwhose eigenvalues are\n\n\u03bb\u0303\u00b1 =\n\n\u0010\n\u0011\np\n\u01eb\u03c7\u2032 \u00b1 (\u01eb\u03c7\u2032 )2 + 4(\u03c7 \u2212 f \u03c7\u2032 )\n2\n\n14\n\n+ \u0169.\n\n(57)\n(58)\n\n\fThe same analysis as above leads to the following scheme\n1\n(E n+1 \u2212 Ern )i +\n\u2206t r\n1\n(F n+1 \u2212 Frn )i +\n\u2206t r\n\n1\nn+ 1\n\u2217\n\u2217\nn+ 12\n= \u03c3c(ar T 4 \u2212 Er )i 2\n(Fr,i+\n1 \u2212 F\n1)\nr,i\u2212\n2\n2\n\u2206r\nc2\nn+ 1\n\u2217\n\u2217\nn+ 12\n= \u2212\u03c3cFr,i 2\n(Pr,i+\n1 \u2212 P\n1)\nr,i\u2212\n2\n2\n\u2206r\n\n(59)\n(60)\n\nwhere\n\u2217\nFr,i+\n1\n\n=\n\n2\n\n+\n\u2217\nPr,i+\n1\n2\n\n=\n+\n+\n\nFr,i+ 21 + \u01eb\n\n\u00e3+ (ui+ 12 \u2212 ug )Ei \u2212 \u00e3\u2212 (ui+ 21 \u2212 ug )Ei+1\n\u00e3+ \u2212 \u00e3\u2212\n\n(1 \u2212 \u01eb)\n(ui+ 21 \u2212 ug )(Er,i+1 + Er,i )),\n2\n(1 \u2212 \u01eb2 )\n(Pr,i+1 + Pr,i )\n\u01eb2 Pr,i+ 21 +\n2\n\u2212\n+\n\u01eb \u00e3 ((ui+ 21 \u2212 ug ))Fr,i \u2212 \u00e3 ((ui+ 12 \u2212 ug ))Fr,i+1\n\n(61)\n\n(62)\n\nc2\n\u00e3+ \u2212 \u00e3\u2212\n(1 \u2212 \u01eb)\n(ui+ 21 \u2212 ug )(Fr,i+1 + Fr,i ),\n2c2\n\nand\n+\n\u00e3+ = max(\u03bb\u0303+\ni+1 , \u03bb\u0303i+ 1 , 0),\n2\n\n\u2212\n\u00e3\u2212 = min(\u03bb\u0303\u2212\ni , \u03bb\u0303i+ 1 , 0).\n\n(63)\n\n2\n\nIn the previous discretization of the radiation subsystem, one need the value\nof \u01eb at each interface. In practical computations, where the opacity gradient can\nbe large, we compute a value of \u01eb in each cell \u01eb = 1/\u03c3\u2206x. The value of \u01eb at the\ninterface is then taken to be the maximum value in the two adjacent cells. As we\nwill see this method has given very satisfactory results even in the case of radiative\nshock with very strong opacity gradient.\n, then the HLLE solver coincides\nLet us also remark that if we take \u00e3\u00b1 = \u03bb\u0303\u00b1\ni+ 12\nwith the Roe solver for the radiation subsystem. Thus, if we use for the hydrodynamic subsystem a Roe solver, then the above scheme is exactly the Roe scheme\nfor the radiation-hydrodynamics system where the non conservative coupling terms\nare dropped. Nevertheless using HLLE solver for the radiation insures positivity of\nthe scheme.\n\n4. ACTUAL IMPLEMENTATION OF THE METHOD\nWe present in this section how the full radiation-hydrodynamics system is discretized and integrated. As we mentionned before, when using system (1-5) the\ntreatment of hydrodynamics is independant of the radiation (apart form the source\nterms) and has been described in section (3.2). For the radiative transfer in spherical coordinates the equations to be solved are the following:\n\uf8f1\n\u2202t (Er S) + \u2202r (Fr S) + \u2202r ((u \u2212 ug )Er S) + Pr S\u2207.u\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n= \u03ba\u03c1cS(ar T 4 \u2212 Er) + ur S(3Pr \u2212 Er )\n\uf8f2\n\uf8f4\n\uf8f4\n\u2202t (Fr S)\n\uf8f4\n\uf8f4\n\uf8f3\n\n+ c2 \u2202r (Pr S) + \u2202r ((u \u2212 ug )Fr S) + Fr S\u2202r u\n= \u2212\u03ba\u03c1cFr S + c2 Pr \u2202r S \u2212 (3Prr\u2212Er ) c2 S\n15\n\n(64)\n\n\fThe left-hand sides of the previous system contains the M1 -radiation subsystem and coupling terms due to the comoving frame. We treat the conservative\nterms using the Godunov-type method presented in the previous section. The nonconservative coupling terms, which, as we have seen previously, do not modify the\neigenvalues of the physical system, are discretized in the following way: the velocity\ndivergence is discretized using the value of the velocity at the interface given by\nthe hydrodynamic solver. The two terms of the right-hand-side are local and are\ncomputed by integration over the volume of the cell. All the terms of the second\nequation are discretized in the same maner. And finally, all terms (given by the\nhydrodynamic or radiation solver, comoving and source terms) are computed at\nthe same time so that all equations are fully coupled in an implicit scheme. This is\nsummerized in the following tables.\n\u03ba\u03c1cS(ar T 4 \u2212 Er )\n\u0001n+ 1\n\u03ba\u03c1c(ar T 4 \u2212 Er )\u2206v i 2\n\u03ba\u03c1cFr S\nn+ 12\n\n(\u03ba\u03c1cFr \u2206v)i\n\nu\nr S(3Pr\n\nPr S\u2207.u\nn+ 12\n\n(Pr )i\n\nn+ 21\n[i\u00b1 12 ]\n\n(uS)\n\nu\nr (3Pr\n\n(3Pr \u2212Er ) 2\nc S\nr\n\nc2 Pr \u2202r S\n\u0001n+ 1\nc2 Pr S i 2\n\n\u0010\n\n\u0011n+ 12\n(3Pr \u2212Er ) 2\nc \u2206v\nr\ni\n\n\u2212 Er )\n\u0001n+ 1\n\u2212 Er )\u2206v i 2\nFr S\u2202r u\n\nn+ 1\n(Fr )i 2\n\nn+ 1\n\n(uS)[i\u00b1 21 ]\n2\n\nIn order to gain in accuracy, we actually use a classical second order MUSCL\nmethod ([15]) to compute the flux. For the hydrodynamics minmod slopes are\ncomputed for \u03c1, u and P . For the radiative transfer, slopes are computed for Er\nand f in order to always satisfy the constraint |f | \u2264 1. These slopes are then\nused to extrapolate the value of the different fields near the cell interface. These\nextrapolated values are then used as inputs for the Riemann solvers and for the\nupwind flux.\nFinally, as we will show in section 5.4, the CFL condition given by an explicit\ntreatment of hydrodynamics is too much small in some applications and a full\nimplicit treatment is needed. Then the non-linear system of equations (18), (27)(29) and (64) is solved iterativelly using a Raphson-Newton method. The jacobian\nmatrix is computed using numerical derivatives. We use for the implicitation parameter \u03b1 = 0.55.\n5. TEST CASES\nWe present in this section some test cases for the radiation-hydrodynamic scheme\npresented above. We start with some simple shock-tube problems and end with the\ncollapse of a gas cloud leading to a stellar-like structure. All the shock-tube problems are performed using a constant and uniform resolution (i.e. eulerian grid) in\norder to place emphasis on the properties of the radiation-hydrodynamics solver.\n5.1.\n\nRadiative front\n\nWe first look at the propagation of a radiative front in vacuum. In the initial\nconditions the half-space x < 0 is filled with radiation with Tr = 104 and f = 1. For\nthe half-space x > 0 we have Tr = 103 and f = 1/3. The front should propagate at\nthe speed of light and remain sharp. The results are presented on figure (3). We\n\n16\n\n\ffirst see that, thanks to the M1 model, the front propagates at the proper speed.\nAfter a propagation of 1cm (ie 100 cells) we see that the front has suffered from\nsignificant diffusion and is spread among about 20 cells. But, when it propagates\nfurther the spatial extension of the front remains roughly stable. This stability of\nthe front is due to the fact that for f = 1 the wave speed is equal to c while for\nf = 1/3 it is equal to c/3. Therefore, contrary to a contact discontinuity, there is\na slight compression of this radiative front.\n\nFIG. 3 The radiative temperature in the initial conditions (solid line), after a\npropagation of 1cm (ie 100 cells) (black cross), 2cm (dashed line) and 3cm (dotted\nline). Each curve is shifted along the x-axis of \u2212c\u2206t. Which means that since the\nfront propagate at the speed of light the discontinuity should stay at x = 0.\nWe now test our scheme with radiative shocks playing particular attention to\nthe stability of the solution for different sampling of the photon mean free path.\n5.2.\n\nRadiative shock dominated by hydrodynamical pressure\n\nWe examine in this section a stationary strong shock in a gas with unit molecular\nweight and a constant opacity of \u03ba = 4.0 104 cm2 /g. The upstream quantities for\nthe gas are given by:\n\u03c1 = 1.2 10\u22123 g/cm3\n\nT = 10 o K\n\nu = 200 km/s\n\nTr = T\n\nFr = 0. (65)\n\nAs the upstream material is extremely opaque, any radiation incoming from the\nradiative front will be completely reabsorbed at some distance. Far from this area,\nthe flow becomes homogeneous, the radiative flux vanishes (Fr = 0), the radiation\nand the fluid temperatures are in equilibrium (Tr = T ).\nThe downstream quantities are chosen so that the Rankine-Hugoniot jump conditions are satisfied for the mass (1), total momentum (9) and total energy (10).\nLet us notice that in that case the Rankine-Hugoniot jump conditions for the complete coupled fluid radiative system (1 - 5) are not satisfied. As we introduce only\nthree constraints on the downstream state, we need two extra relations to know\nthis state (see Mihalas [11]). The downstream material is also extremely opaque,\nhence, we still have Fr = 0 and Tr = T . In fact, the gas given by the downstream\n17\n\n\for upstream states act as a real non perfect gas where the material pressure P is\nreplaced by the total pressure P + Pr and where the material energy E is replaced\nby the total energy E + Er . In this test, the equation of state is totally dominated\nby the gaz (\u03b3 = 5/3) and radiation is only significant for energy transport.\nThe photon mean free path in the upstream material is given by \u03bb = 1/\u03ba\u03c1 \u2243\n0.02cm. The results of the simulation for a grid with \u2206x = 0.5\u03bb are given in figure\n(4). The hydrodynamical shock is stable and is sampled over 2 cells and there is\na large region in front of the shock where the gas is preheated by radiation. In\nthis thermal precursor the gas is heated and slowed down by the energy released\nin the shock. We have looked at the behavior of this precursor under changes\nin resolution. We can see (figure (5-A)) that even when the mean free path of\nphoton is not sampled, the thermal precusor keeps the proper spatial extension. If\nthe numerical scheme is not modified to take into account the diffusion limit, the\nextension of the precursor is much too large, as was expected from the analysis\nmade in (3.3.2). If the spatial sampling of the simulation is large compared to the\nlength of the precursor, the temperature jump is captured over 2 or 3 cells which\nis roughly as accurate as the treatment of a shock.\n5.3.\n\nShock dominated by radiative pressure\n\nWe now examine the case of a shock where the dynamical influence of radiation\nis not limited to energy transport. In this test case, the energy in the downstream\nregion is dominated by the radiative energy. The upstream conditions are:\n\u03c1 = 10\u22123 g/cm3\n\nT = 105 o K\n\nu = 1000 km/s\n\nTr = T\n\nFr = 0.\n\nand the downstream conditions are given by the Rankine-Hugoniot relations as\ndetailed in the above section. As in the previous test we assume for the radiation\nthat downstream states are at equilibrium, (i.e. Er = ar T 4 and Fr = 0).\nThe gas molecular weight is, as before, set to unity and the opacity is \u03ba =\n1 cm2 /g. The photon mean free path in the upstream region is therefore \u03bb =\n1/\u03ba\u03c1 = 103 cm. The results of this test case for \u2206x = 0.5\u03bb are presented on figure\n(6). As in the previous case, the shock is captured in two cells and there is a large\npreheated region in front of the shock. In this region, energy is transfered from\nthe gas to the radiation and the radiation energy density quickly dominates as the\ntemperature rises. In the upstream region the equation of states is dominated by the\ngaz (\u03b3 = 5/3) and in the downstream region it is dominated by radiation (\u03b3 = 4/3).\nIn this case the effective \u03b3 in the downstream region is 4.2/3. Eventhough we do not\nexplicitly treat the total (gaz and radiation) conservation law this energy transfer\nis treated correctly. As in the previous case, the shock is absolutly stable and the\nRankine-Hugoniot relations are strictly verified. This example illustrates the fact\nthat eventhough our hyperbolic analysis decouples matter and radiation, our scheme\nis valid even when there are large momentum and energy transfer between gas and\nradiation. In figure (7) we have plotted the temperature profile for different grid\nresolutions to illustrate the proper behavior of our scheme in both the streaming\nand diffusion regime.\n5.4.\n\nCollapse of a gas cloud\n\nStar formation is a very challenging problem, where radiation transport plays a\ndominant role. The modeling of the formation of a star introduces a wide range of\n18\n\n\fA\n\nB\n\nC\n\nD\n\nFIG. 4 Profiles of density (A), velocity (B), gas (solid line) and radiation (dashed\nline) temperatures (C) and radiative flux (D) for a strong shock with negligible\nradiative energy density.\nlength and time scales. The mean density contrast between a collapsing cloud and\nthe star reaching main sequence is about 1020 . The initial cloud radius is about\n1018 cm, while the typical radius of a solar-like star is less than 1011 cm. The compactness of the star embryo requires a spatial resolution of at least \u2206r/r \u2243 10\u22124\nin the envelope outer layers, where the pressure gradients are the highests. This\nmeans that the Courant number corresponding to a dynamical time scale td = r/cs ,\nwhere cs is the sound speed, is about C = 104 . If the evolution of the system is\nto be followed over the Kelvin-Helmotz time scale, tK\u2212H = GM 2 /RL \u2243 30M yr\nfor a solar-like star, the Courant numbers we have to deal with is of the order of\n1014 . These rough estimates demonstrate that the spatial resolution required for\nour problem demands an implicit numerical scheme. The process of star formation\nis dominated by the properties of radiative transfer in highly unsteady flows. The\nreason is that self-gravity alone can not lead to the formation of a compact object\nunless the energy released by gravitational contraction beeing radiated away, from\nthe surface of the protostellar core. Energy transport in the core's interior, towards\n19\n\n\fA\n\nB\n\nFIG. 5 Profiles of gas temperature in the upstream flow preheated by the radiation.\nIn plot A the grid spacing was \u2206x = 0.5\u03bb (solid line), 2.5\u03bb (dotted line), 5.5\u03bb\n(dashed line), 11\u03bb (solid line with squares). The solid line with triangle is the results\nof a simuation with \u2206x = 11\u03bb but where \u01eb was kept to unity. For the simulation\nof plot B the grid spacing was 550\u03bb, the thermal precursor is now sampled on 2-3\ngrid points which is almost as accurate as the treatment of a shock.\nthe photosphere, is mainly due to radiative transfer in an optically thick plasma,\nand convection. The photosphere is a narrow layer where the radiation transport\nregime abruptly turns from the diffusion regime to the free streaming regime, by\nwhich energy flowing from the core by diffusion and convection is radiated away.\nFurthermore, during the accretion phase, the photospere is surrounded by supercritical radiating accretion shock, where the kinetic energy of the infalling gas is\nessentially converted into outgoing radiation. Since most of the total luminosity\nof the protostar is produced within this sharp, optically thin accretion shock, the\ncalculation of the structure of the radiative accretion shock is a crucial issue in the\nmodeling of star formation. A correct evaluation of the entropy extracted by escaping radiation from the accreting material, deposited on the protostar surface, is also\nthe key factor which determines the structure of the growing stellar core. First, the\nentropy profile determines the size of the quasistatic core, and hence determines\nthe location of the protostar in the Hertzprung-Russell diagram by the end of the\naccretion phase; second the entropy gradient triggers the highly efficient convective\nenergy transport, in regions where \u2207s < 0, where s is the specific entropy.\nWe present in the following section an example of the calculation of the formation of a primordial star, in a slightly bound region of an overall expanding universe.\nThe simple model presented here includes only hydrodynamics, gravitation and, of\ncourse, radiative transfer. It is nevertheless a very challenging test for radiative\ntransfer. As we will see, the opacity gradients are very large and there is a steep\ntransition from the diffusion to the free-streaming regime.\nWe start with a 106 solar mass gas cloud. The velocities are those of the\nhomogeneous expansion of the universe (i.e. u(r) = H r, where H is the Hubble\nconstant). The average density is the critical density and the density profile is\nsmooth with a small central overdensity. We start our simulation at a redshift of\n100 and the amplitude of the initial perturbation is adjusted so that the central\n20\n\n\fobject forms at a redshift of 30. Initially the radiative energy density is that of\nthe cosmic microwave background and the temperature of the gas is equal to the\ntemperature of the radiation.\nIn a first phase the entire cloud is in expansion. Then, at a redshift of 50 the\ncentral part of the cloud starts to collapse. The central density increases, but the\ntemperature remains almost constant because the energy is evacuated by radiation\nsince the photon mean free path is much larger than the typical scale of the forming\nstructure. Next, at a redshift of about 30, the central region is dense enough to\nbecome opaque to radiation. The temperature and the pressure start to grow and\nbecome large enough to prevent the collapse in the central region. Finally the\ninfalling matter creates an accretion shock on the central core. The structure of\nthe flow when the central density has reached x.10\u22128 g/cm3 is presented in figures\n(8) to (14).\nThe density profile is plotted is figure (8). The center is almost at the hydrostatic\nequilibrium and is surrounded by a slowly contracting envelope. The envelope ends\nat the accretion shock where the density jump is very important (about one order of\nmagnitude) due to the fact that the gas radiates most of its energy, as is illusrated\nby figures (10) and (14). One can notice that the density contrast between the\ncenter and the outer accretion flow is of more than 18 decades and that the length\nscale vary of about 10 decades.\nThe velocity profile (figures (9)) shows that the outer region of the cloud is\nstill expanding, following the global expension of the universe. On the contrary,\nthe inner region is gravitationally bounded and is collapsing. The accretion shock\nis clearly visible and is sampled over only one computational grid point. Due to\nthe moving grid, the central part and the region of the shock have a high spatial\nresolution. The actual resolution profile can be seen on figure (13). In the central\npart of the cloud, the radiation is in the diffusion limit and the luminosity slowly\nincrease (figure (10)). At the shock there is a very sharp increase in luminosity due\nto the fact that the gas is heated at the shock and radiates most of its energy. The\nluminosity is then constant except for the outer region where the luminosity of the\ncosmic microwave background starts to dominate. As is illustrated by figure (11),\nthe radiation is in the diffusion regime in the central part of the cloud where the\nphoton mean free path is much smaller than the radius while it is clearly in the\nfree-streaming regime in the outer part. The transition between these two regimes\noccurs in a very sharp way at the shock. Figure (14) shows a zoom of the gas and\nradiation temperatures profiles near the shock. The spike in the gas temperature\nis a characteristic feature of supercritical radiative shock and a very high spatial\nresolution is needed to resolve it. Finally, the profile of the Eddington factor is\nplotted on figure (12). The Eddington factor is equal to one third in the central\nobject, which confirm the fact that the diffusion regime is valid in this region. Then,\nthere is a small jump at the shock and the Eddington factor grows as one goes away\nfrom the surface of the star. At large distance, the light coming from the star is\nblured into the cosmic microwave background and the Eddington factor decreases\nback to one third. These large variations of both the Eddington factor and the\nopacity illustrate the interest of the M1 model for such radiative shock.\n6. CONCLUSION\nWe have presented in this paper a new numerical model for radiative transfer\nwhich gives satisfactory results in a wide range of physical conditions including both\n21\n\n\fthe diffusion and the free-streaming regimes where the anisotropy of the photons\ndistribution function can be large. This method is therefore well suited to modeled some laser experiments and many astrophysical flows. Works are in progress\nto incorporate in the model a more detailed description of the physical processes\n(multigroup approach, ionization, ....) and to further develop this approach in a\nmultidimensionnal framework.\nREFERENCES\n[1] D. S. Balsara, An Analysis of the Hyperbolic Nature of the Equations of\nRadiation Hydrodynamics, J. Qant. Spectrosc. Radiat. Transfer, 61(5):617-627,\n1999.\n[2] W, Dai and P. Woodward, Numerical Simulations for Radiation Hydrodynamics. I. Diffusion Limit, J. Comput. Phys. 142,182-207, (1998).\n[3] W, Dai and P. Woodward, Numerical Simulations for Radiation Hydrodynamics. II. Transport Limit, J. Comput. Phys. 257,199-233, (2000).\n[4] E.A. Dorfi and L. O'C. Drury, Journal of Computational Physics, 69,\n175-195, 1987\n[5] B. Dubroca and J.-L. Feugeas, CRAS, 329, 915-920, 1999\n[6] B. Einfeldt, C.D. Munz, P.L. Roe and B. Sj\u00f6green On godunov-type\nmethods near low densities, J. Comput. Phys.,92,273, 1991\n[7] E. Godlewski and P.-A. Raviart, Numerical approximation of hyperbolic\nsystems of conservation laws, Springer-Verlag, New-York, 1996\n[8] S. Jin, L. Pareschi et G. Toscani, Uniformly accurate diffusive relaxation\nschemes for multiscale transport equations, SIAM J. Num. Anal., 38, 913, 2000\n[9] E. Larsen, J. Morel, and W. Miller Asympotic Solutions of Numerical\nTransport Problems in Optically Thick, Diffusive Regimes, J. Comput. Phys.\n83 (1):212-236, 1989.\n[10] R. B. Lowrie, J. E. Morel and J. A. Hittinger, The Coupling of Radiation and Hydrodynamics, The Astrophys. J. (521):432-450, 1999.\n[11] D. Mihalas and B. Weibel-Mihalas, Foundation of Radiation Hydrodynamics, Oxford University Press, 1984.\n[12] G. C. Pomraming, The Equations of Radiation Hydrodynamics, Pergamon\nPress, 1973.\n[13] P.L. Roe, Approximate Riemann solvers, parameter vectors, and difference\nschemes, J. Comput. Phys.,43,357, 1981\n[14] E.F. Toro, \"Riemann solvers and numerical methods for fluid dynamics\",\nspringer, 1999\n[15] B. Van Leer, Toward the Ultimate Conservative Difference Scheme. V. A\nSecond Order Sequel to Godunov,s method, J. Comput. Phys. 32 101 (1979).\n\n22\n\n\fA\n\nB\n\nC\n\nD\n\nFIG. 6 Profiles of density (A), gas (solid line) and radiation (dashed line) temperatures (B), radiative flux (in arbitrary units, solid line) and reduce flux (dashed line)\n(C) and gas (solid line) and radiative (dashed line) pressures (D) for a strong shock\nwhere the downstream energy is dominated by radiative pressure. The squares for\nthe gas density and pressure show that eventhough the radiative pressure dominates\nthe hydrodynamical shock is still properly treated.\n\n23\n\n\fFIG. 7 Profiles of temperature in the upstream flow preheated by the radiation.\nThe grid spacing was \u2206x = 0.5\u03bb (solid line), 35\u03bb (dotted line), 200\u03bb (squares).\n\nFIG. 8 Density profile of the forming star.\n\n24\n\n\fFIG. 9 Velocity profile of the forming star.\n\nFIG. 10 luminosity profile of the forming star.\n\n25\n\n\fFIG. 11 This plot represents the ratio of the photon mean free path over the\nradius as a function of the radius. This ratio is very small in the center where the\ncoupling between matter and radiation is very strong, and it is very large in the\nouter region where the gas is transparent. This parameter varies over 10 orders of\nmagnitude, with a sharp discontinuity at the shock, where the transition between\nthe diffusion and the free streaming regime occurs.\n\n26\n\n\fFIG. 12 Profil of the Eddington factor.\n\n27\n\n\fFIG. 13 Profil of the grid resolution. The grid resolution is very high at the\nshock, where all the gradients are very large. With the high resolution it is possible\nto see the temperature spike at the shock (see figure (14)). The resolution is also\nimportant in the center to properly sample the pressure gradient and near the peak\nof the Eddington factor.\n\n28\n\n\fFIG. 14 Temperature profiles at the shock. The gas is heaten by the shock and\nthen very quickly radiates its internal energy. This results in the large spike in the\ngas temperature at the shock which is associated to the jump in luminosity. On\nthe contrary, the radiation temperature varies smoothy through the shock, it only\nchanges its slope.\n\n29\n\n\f"}