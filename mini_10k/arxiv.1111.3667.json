{"id": "http://arxiv.org/abs/1111.3667v1", "guidislink": true, "updated": "2011-11-15T21:43:51Z", "updated_parsed": [2011, 11, 15, 21, 43, 51, 1, 319, 0], "published": "2011-11-15T21:43:51Z", "published_parsed": [2011, 11, 15, 21, 43, 51, 1, 319, 0], "title": "The iterated Carmichael lambda function", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1111.3216%2C1111.3209%2C1111.2268%2C1111.1426%2C1111.6501%2C1111.6871%2C1111.1427%2C1111.7032%2C1111.5019%2C1111.5049%2C1111.0348%2C1111.2926%2C1111.4630%2C1111.1274%2C1111.7065%2C1111.1374%2C1111.1839%2C1111.4062%2C1111.1587%2C1111.2708%2C1111.3642%2C1111.2467%2C1111.1436%2C1111.2122%2C1111.1983%2C1111.6749%2C1111.6432%2C1111.6011%2C1111.3667%2C1111.3688%2C1111.2037%2C1111.0485%2C1111.6003%2C1111.1621%2C1111.5250%2C1111.2479%2C1111.0242%2C1111.6735%2C1111.4217%2C1111.5249%2C1111.0505%2C1111.4556%2C1111.5686%2C1111.5338%2C1111.4030%2C1111.5386%2C1111.0060%2C1111.6993%2C1111.6660%2C1111.5242%2C1111.1402%2C1111.0520%2C1111.5798%2C1111.2544%2C1111.7132%2C1111.3449%2C1111.0549%2C1111.4348%2C1111.1808%2C1111.2710%2C1111.3658%2C1111.4513%2C1111.2417%2C1111.2967%2C1111.3888%2C1111.4282%2C1111.1140%2C1111.0747%2C1111.4048%2C1111.5279%2C1111.6419%2C1111.4302%2C1111.0897%2C1111.6415%2C1111.2363%2C1111.6987%2C1111.2463%2C1111.0270%2C1111.4991%2C1111.5899%2C1111.6701%2C1111.5063%2C1111.3423%2C1111.2895%2C1111.0618%2C1111.4608%2C1111.3306%2C1111.5343%2C1111.6234%2C1111.5342%2C1111.3479%2C1111.0494%2C1111.1085%2C1111.6965%2C1111.5932%2C1111.4223%2C1111.0016%2C1111.5402%2C1111.4324%2C1111.4615%2C1111.3181&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The iterated Carmichael lambda function"}, "summary": "The Carmichael lambda function $\\lambda(n)$ is defined to be the smallest\npositive integer $m$ such that $a^m$ is congruent to 1 modulo $n,$ for all $a$\nand $n$ relatively prime. The function $\\lambda_k(n)$ is defined to be the\n$k$th iterate of $\\lambda(n).$ Previous results show a normal order for\n$n/\\lambda_k(n)$ where $k=1,2.$ We will show a normal order for all $k.$", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1111.3216%2C1111.3209%2C1111.2268%2C1111.1426%2C1111.6501%2C1111.6871%2C1111.1427%2C1111.7032%2C1111.5019%2C1111.5049%2C1111.0348%2C1111.2926%2C1111.4630%2C1111.1274%2C1111.7065%2C1111.1374%2C1111.1839%2C1111.4062%2C1111.1587%2C1111.2708%2C1111.3642%2C1111.2467%2C1111.1436%2C1111.2122%2C1111.1983%2C1111.6749%2C1111.6432%2C1111.6011%2C1111.3667%2C1111.3688%2C1111.2037%2C1111.0485%2C1111.6003%2C1111.1621%2C1111.5250%2C1111.2479%2C1111.0242%2C1111.6735%2C1111.4217%2C1111.5249%2C1111.0505%2C1111.4556%2C1111.5686%2C1111.5338%2C1111.4030%2C1111.5386%2C1111.0060%2C1111.6993%2C1111.6660%2C1111.5242%2C1111.1402%2C1111.0520%2C1111.5798%2C1111.2544%2C1111.7132%2C1111.3449%2C1111.0549%2C1111.4348%2C1111.1808%2C1111.2710%2C1111.3658%2C1111.4513%2C1111.2417%2C1111.2967%2C1111.3888%2C1111.4282%2C1111.1140%2C1111.0747%2C1111.4048%2C1111.5279%2C1111.6419%2C1111.4302%2C1111.0897%2C1111.6415%2C1111.2363%2C1111.6987%2C1111.2463%2C1111.0270%2C1111.4991%2C1111.5899%2C1111.6701%2C1111.5063%2C1111.3423%2C1111.2895%2C1111.0618%2C1111.4608%2C1111.3306%2C1111.5343%2C1111.6234%2C1111.5342%2C1111.3479%2C1111.0494%2C1111.1085%2C1111.6965%2C1111.5932%2C1111.4223%2C1111.0016%2C1111.5402%2C1111.4324%2C1111.4615%2C1111.3181&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Carmichael lambda function $\\lambda(n)$ is defined to be the smallest\npositive integer $m$ such that $a^m$ is congruent to 1 modulo $n,$ for all $a$\nand $n$ relatively prime. The function $\\lambda_k(n)$ is defined to be the\n$k$th iterate of $\\lambda(n).$ Previous results show a normal order for\n$n/\\lambda_k(n)$ where $k=1,2.$ We will show a normal order for all $k.$"}, "authors": ["Nick Harland"], "author_detail": {"name": "Nick Harland"}, "author": "Nick Harland", "links": [{"href": "http://arxiv.org/abs/1111.3667v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1111.3667v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1111.3667v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1111.3667v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "THE ITERATED CARMICHAEL LAMBDA FUNCTION\n\narXiv:1111.3667v1 [math.NT] 15 Nov 2011\n\nNICK HARLAND\n\nAbstract. The Carmichael lambda function \u03bb(n) is defined to be the smallest positive\ninteger m such that am is congruent to 1 modulo n, for all a and n relatively prime. The\nfunction \u03bbk (n) is defined to be the kth iterate of \u03bb(n). Previous results show a normal order\nfor n/\u03bbk (n) where k = 1, 2. We will show a normal order for all k.\n\n1. Introduction\nThe Carmichael lambda function \u03bb(n) is defined to be the order of the largest cyclic\nsubgroup of the multiplicative subgroup (Z/nZ)\u00d7 . It can be computed using the identity\n\u03bb(lcm{a, b}) = lcm{\u03bb(a), \u03bb(b)} and its values at prime powers which are \u03bb(pk ) = \u03c6(pk ) =\npk \u2212 pk\u22121 for odd primes p and \u03bb(2) = 1, \u03bb(4) = 2, and \u03bb(2k ) = \u03c6(2k )/2 = 2k\u22122 for k \u2265 3.\nSeveral properties of \u03bb(n) were studied by Erd\u0151s, Pomerance, and Schmutz in [3]. In particular they showed that \u03bb(n) = n exp(\u2212(1+o(1)) log log n log log log n) as n \u2192 \u221e for almost all\nn. Martin and Pomerance showed in [6] that \u03bb(\u03bb(n)) = n exp(\u2212(1+o(1))(log log n)2 log log log n)\nas n \u2192 \u221e for almost all n. The k\u2013fold iterated Carmichael lambda function is defined recursively to be\n\u03bb1 (n) = \u03bb(n), \u03bbk (n) = \u03bb(\u03bbk\u22121 (n)).\nWe define \u03c6k (n) similarly. In [6] it is conjectured that\n\u0012\n\u0013\n1\nk\n\u03bbk (n) = n exp \u2212\n(1 + ok (1))(log log n) log log log n\n(k \u2212 1)!\nfor almost all n. In this paper we prove that conjecture.\nTheorem 1. For fixed k, the normal order of log \u03bbkn(n) is\n\n1\n(log log n)k\n(k\u22121)!\n\nlog log log n.\n\nWe'll actually prove the theorem in the following slightly stronger form. Given any function\n\u03c8(x) = o(log log log x) and \u03c8(x) \u2192 \u221e as x \u2192 \u221e we have\n\u0012\n\u0013\n\u0012\n\u0013\n\u0001\nn\n1\nk\nlog\n=\n(log log n) log log log n + Ok \u03c8(n)\n\u03bbk (n)\n(k \u2212 1)!\n\nfor all but O(x/\u03c8(x)) integers up to x.\nWe will also turn our attention to finding an asymptotic formula involving iterates involving \u03bb and \u03c6. Banks, Luca, S\u0103id\u0103k, and Stanic in [1] showed that for almost all n,\n\u03bb(\u03c6(n)) = n exp(\u2212(1 + o(1))(log log n)2 log log log n) and\n\u03c6(\u03bb(n)) = n exp(\u2212(1 + o(1))(log log n) log log log n).\nAs a corollary to Theorem 1 we will obtain asymptotic formulas for higher iterates involving\n\u03bb and \u03c6. Specifically we prove the following.\n2010 Mathematics Subject Classification. 11N56 (11N37).\n1\n\n\fTheorem 2. For l \u2265 0 and k \u2265 1, let g(n) = \u03c6l (\u03bb(f (n))), where f (n) is a (k \u2212 1) iterated\narithmetic function consisting of iterates of \u03c6 and \u03bb. Then the normal order of log(n/g(n))\n1\nis (k\u22121)!\n(log log n)k log log log n.\nAn example of the use of this theorem is for \u03c6\u03c6\u03bb\u03c6\u03c6\u03bb\u03bb\u03c6(n). Since l = 2, k = 5, we get that\nn\nis\nthe normal order of log \u03c6\u03c6\u03bb\u03c6\u03c6\u03bb\u03bb\u03c6(n)\n1\n(log log n)5 log log log n.\n4!\nThe proof of Theorem 1 involves breaking down \u03bbkn(n) in terms of the iterated Euler \u03c6\nfunction by using\n\u0013\u0012\n\u0013 \u0012\n\u0013\u0012\n\u0013\n\u0012\nn\n\u03c6(n)\n\u03c6k\u22121(n)\n\u03c6k (n)\nn\n(1)\n...\n=\n\u03bbk (n)\n\u03c6(n)\n\u03c62 (n)\n\u03c6k (n)\n\u03bbk (n)\nof which estimates for all but the last term are known. Hence log \u03bbkn(n) can be written as a sum\nof the logarithms on the right side of (1) and so we'll analyze the term log(\u03c6k (n)/\u03bbk (n)).\nThe following notations and conventions will be used throughout the paper. The letters\np, q, r will always denote primes and k \u2265 2 will be a fixed integer. Note that the theorem\nhas already been proven for k = 1. Let vp (n) be the largest power of p which divides n, so\nthat\nY\nn=\npvp (n) .\np\n\ne\n\nLet the set Pn be {p : p \u2261 1 (mod n)}. Throughout the paper we will assume x > ee and\ny = y(x) = log log x. Also let \u03c8(x) be any function going to \u221e such that \u03c8(x) = o(log y) =\no(log log log x). Whenever we use the phrase \"for almost all n \u2264 x\" in a result, we mean\nthat the result is true for all n \u2264 x except a set of size O(x/\u03c8(x)). Lastly we note that any\nimplicit constant may depend on k.\n2. Required Estimates\nThe following estimates will be used throughout the paper. We use the Chebeshev bound\n(2)\n\nX\n\n\u039b(n) =\n\nn\u2264x\n\nX\n\nlog p \u226a x\n\np\u2264x\n\nwhere \u039b(n) is the von\u2013Mangoldt function. We also require a formula of Mertens (See [7,\nTheorem 2.7(b)])\n(3)\n\nX log q\nq\u2264x\n\nq\n\n= log x + O(1).\n\nUsing partial summation on (2) we can obtain the tail estimates\n(4)\n\nX log q\nq>x\n\nq2\n\nand\n2\n\n\u226a\n\n1\nx\n\n\fX 1\n1\n\u226a\n.\n2\nq\nx log x\nq>x\n\n(5)\n\nGiven m, x, let A be the smallest a for which ma > x. We can then manipulate the sums\nX P (a)\na\u2208N\n\nma\n\n=\n\n\u221e\n\u221e\n\u221e\nX P (a)\n1 X Q(a)\n1 X P (a)\n1 X P (a)\n=\nand\n\u226a\nm a=0 ma\nma\nx a=0 ma\u2212A\nx a=A ma\na\u2208N\nma >x\n\nP\nP (a)\nfor Q(x) = P (x + A). Then by noting that \u221e\na=A ma \u226aP 1 uniformly for m \u2265 2 and A \u2265 0\nwe obtain the estimates\nX P (a)\n1 X P (a)\n1\n(6)\n\u226a\n,\n\u226aP .\nP\na\na\nm\nm a\u2208N m\nx\na\u2208N\nma >x\n\nFrom [7, Corollary 1.15] we get\nX1\n\n(7)\n\ns\u2264x\n\ns\n\n= log x + O(1)\n\nfrom which it easily follows that\nX\n\n(8)\n\nD\u2264s\u2264x\ns\u2261a (mod C)\n\n1\nlog x\n1\n\u226a\n+\n.\ns\nD\nC\n\nWe will also make frequent use of the Brun-Titchmarsh inequality [7, Theorem 3.9]\n(9)\n\n\u03c0(t; n, a) \u226a\n\nt\n.\n\u03c6(n) log(t/n)\n\nBy partial summation on (9) we can obtain\nX 1\nlog log t\n\u226a\n.\n(10)\np\n\u03c6(n)\np\u2264t\np\u2208Pn\n\nWhenever n/\u03c6(n) is bounded, as it will be whenever n is a prime, prime power or a product\nof two prime powers, we can replace this bound with\nX 1\nc log log t\n\u2264\n(11)\np\nn\np\u2264t\np\u2208Pn\n\nfor some absolute constant c. We include the c because occasionally we require an inequality\nas opposed to an estimate. We will also require the following asymptotic from [8, Theorem\n1]\n\u0013\n\u0012\nX 1\nlog log t\nlog n\n(12)\n,\n=\n+O\np\n\u03c6(n)\n\u03c6(n)\np\u2208P\nn\n\np\u2264t\n\n3\n\n\fwhich easily implies that\nX\n\n(13)\n\np\u2208Pn\np\u2264t\n\n\u0013\n\u0012\n1\nlog log t\nlog n\n,\n=\n+O\np\u22121\n\u03c6(n)\n\u03c6(n)\n\nsince the difference is\nX\n\np\u2208Pn\np\u2264t\n\n\u221e\n\u221e\nX\n1\n1 X 1\n1\n1\n\u2264\n< 2\n\u226a\n.\np(p \u2212 1) m=1 mn(mn + 1)\nn m=1 m2\nn2\n\n3. Required Propositions and Proof of Theorem 1\nAs mentioned previously, the main contribution to log(n/\u03bbk (n)) will come from log(\u03c6k (n)/\u03bbk (n)).\nFinding this term will involve a summation over prime powers which divide each of \u03c6k (n)\nand \u03bbk (n). It turns out that the largest contribution to this term will come from small primes\nwhich divide \u03c6k (n). By small, we mean primes q \u2264 (log log x)k = y k . Hence we will split the\nsum into small primes and large primes q > y k . Therefore to prove Theorem 1 we will require\nthe following propositions. The first summations deal with the large primes which divide\n\u03c6k (n) and the second involves the large primes whose prime powers divide \u03c6k (n). We will\nshow that the contribution of these primes to the main sum is small and hence it will end\nup as part of the error term.\nProposition 3.\nX\n\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q \u226a y k \u03c8(x)\n\nq>y k\n\u03bdq (\u03c6k (n))=1\n\nfor almost all n \u2264 x.\nProposition 4.\nX\n\n\u03bdq (\u03c6k (n)) log q \u226a y k \u03c8(x)\n\nq>y k\n\u03bdq (\u03c6k (n))\u22652\n\nfor almost all n \u2264 x.\nSince the main contribution will come from small primes dividing \u03c6k (n), the next propostion will show that the contribution of small primes dividing \u03bbk (n) to the main sum can also\nbe merged into the error term.\nProposition 5.\nX\n\n\u03bdq (\u03bbk (n)) log q \u226a y k \u03c8(x)\n\nq\u2264y k\n\nfor almost all n \u2264 x.\nThat will leave us with the contribution of small primes dividing \u03c6k (n). We will use an\nadditive function to approximate this sum. Let hk (n) be the additive function defined by\nX X\nX X\nhk (n) =\n***\n\u03bdq (pk \u2212 1) log q.\np1 |n p2 |p1 \u22121\n\npk |pk\u22121 \u22121 q\u2264y k\n\n4\n\n\fThe following propostion shows that the difference between the sum involving the small\nprimes dividing \u03c6k (n) and the term hk (n) is small.\nProposition 6.\nX\n\n\u03bdq (\u03c6k (n)) log q = hk (n) + O(y k\u22121 log y * \u03c8(x))\n\nq\u2264y k\n\nfor almost all n \u2264 x,\nThat leaves us with log(\u03c6k (n)/\u03bbk (n)) being approximated by hk (n). The last proposition\nwill obtain an asymptotic formula for hk (n). From there we will have enough armoury to\ntackle Theorem 1.\nProposition 7.\nhk (n) =\n\n1\ny k log y + O(y k )\n(k \u2212 1)!\n\nfor almost all n \u2264 x.\nProof of Theorem 1. We start by breaking down the function log(n/\u03bbk (n)).\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\nn\nn\n\u03c6(n)\n\u03c6k\u22121(n)\n\u03c6k (n)\nlog\n= log\n+ log\n+ * * * + log\n+ log\n.\n\u03bbk (n)\n\u03c6(n)\n\u03c62 (n)\n\u03c6k (n)\n\u03bbk (n)\nUsing the lower bound \u03c6(m) \u226b m/ log log m, see [7, Theorem 2.3] we have that\n\u0013\n\u0012\n\u0013\n\u0012\n\u0013\n\u0012\n\u03c6(n)\n\u03c6k\u22121(n)\nn\n+ log\n+ * * * + log\n\u226a log log log n\nlog\n\u03c6(n)\n\u03c62 (n)\n\u03c6k (n)\nand so\nlog\n\n\u0012\n\nn\n\u03bbk (n)\n\n\u0013\n\n= log\n\n\u0012\n\n\u03c6k (n)\n\u03bbk (n)\n\n\u0013\n\n+ O(log log log n).\n\nIn fact we could have used a more precise estimate for \u03c6i (n)/\u03c6i+1 (n) for i \u2265 1 which can\nbe found in [2] but the one we used is more than good enough. Next we break down the\nremaining term into summations. We will break it up into small primes and large primes.\n\u0012\n\u0013 X\nX\n\u03c6k (n)\nlog\n=\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q +\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q\n\u03bbk (n)\nk\nk\nq>y\nq\u2264y\nX\nX\n=\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q +\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q\nq>y k\n\u03bdq (\u03c6k (n))=1\n\n+\n\nX\n\n\u03bdq (\u03c6k (n)) log q \u2212\n\nq\u2264y k\n\nq>y k\n\u03bdq (\u03c6k (n))\u22652\n\nX\n\n\u03bdq (\u03bbk (n)) log q.\n\nq\u2264y k\n\nNote that if a | b, then \u03bb(a) | \u03c6(b) since \u03bb(a) | \u03c6(a) | \u03c6(ma) for any m. This quickly implies\nthat \u03bbk (n) always divides \u03c6k (n) for all k and so we get\nX\nX\n0\u2264\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q \u2264\n(\u03bdq (\u03c6k (n)) log q.\nq>y k\n\u03bdq (\u03c6k (n))\u22652\n\nq>y k\n\u03bdq (\u03c6k (n))\u22652\n\n5\n\n\fUsing Propositions 3,4,5 and 6 we get\n\u0012\n\u0013\n\u0012\n\u0013\nn\nk\nlog\n= hk (n) + O y \u03c8(x)\n\u03bbk (n)\nfor almost all n \u2264 x. Finally by using Proposition 7 we get\n\u0012\n\u0013\n\u0012\n\u0013\nn\n1\nk\nk\nlog\n=\ny log y + O y \u03c8(x)\n\u03bbk (n)\n(k \u2212 1)!\nfor almost all n \u2264 x, finishing the proof of Theorem 1.\n\n\u0003\n\n4. Prime Power Divisors of \u03c6k (n)\nFor various reasons thoughout this paper, we are concerned with the number of n \u2264 x\nsuch that q a can divide \u03c6k (n). We will analyze a few of those situations here:\nCase 1: q 2 | n. Clearly the number of such n is at most qx2 .\nCase 2: There exists p1 \u2208 Pq2 , p2 \u2208 Pp1 , p3 \u2208 Pp2 , ..., pl \u2208 Ppl\u22121 where pl | n. By using (11)\nrepeatedly we get that the number of such n is\nX\nX X\nX\nX X X\n1\n...\n1=\n...\nn\u2264x p1 \u2208Pq2 p2 \u2208Pp1\n\np1 \u2208Pq2 p2 \u2208Pp1\n\npl \u2208Ppl\u22121\npl |n\n\n\u226a\n\npl \u2208Ppl\u22121\nn\u2264x\npl |n\n\nX\n\nX\n\n...\n\nX\n\nX\n\n...\n\npl \u2208Ppl\u22121\n\np1 \u2208Pq2 p2 \u2208Pp1\n\n\u226a\n\np1 \u2208Pq2 p2 \u2208Pp1\n\n\u226a\n\nX\n\np1 \u2208Pq2\n\n\u226a\n\nX\n\nX\n\nx\npl\n\npl\u22121 \u2208Ppl\u22122\n\nxy\npl\u22121\n\nX xy l\u22122\np2\np \u2208P\n2\n\np1\n\nX xy l\u22121\np1\np \u2208P\n1\n\nq2\n\nxy l\nq2\nNow that we've taken care of any case where p \u2208 Pq2 , we are just left with the possibilities\nnot containing any powers of q. Unfortunately these cases still allow for many possibilities\nwhich we will display in an array. There are lots of ways for a prime power q a to arise in\n\u03c6k (n) we now define various sets of primes that are involved in generating these powers of\nq, and we will eventually sum over all possibilities for these sets of primes. The set Lh,i will\ndenote a finite set of primes. To begin, the set L1,2 will be an arbitrary finite set of primes\nin Pq and let L1,1 be empty. That is:\nCase 3:\n\u226a\n\nLevel (1,2)\nL1,2 \u2286 Pq .\nLevel (2,1) (Obtaining the primes in the previous level)\n6\n\n\fL2,1 is any set of primes with the property that for all p \u2208 L1,1 \u222a L1,2 , there exists a unique\nprime r \u2208 L2,1 such that r \u2208 Pp . In other words p will divide \u03c6(r) and hence the primes in\nL2,1 will create the primes in L1,1 \u222a L1,2 .\nLevel (2,2) (New primes in Pq )\nL2,2 \u2286 Pq .\nIn general for all 1 < h \u2264 k we have for all p \u2208 Lh\u22121,1 \u222a Lh\u22121,2 there exists a unique prime\nr \u2208 Lh,1 such that r \u2208 Pp , Lh,2 is an arbitrary subset of Pq , and\nr \u2208 Lk,1 \u222a Lk,2 \u21d2 r | n.\nSome description of the terms are in order including some helpful definitions.\nDefinition 8. An incarnation I of Case 3 is some specified description of how the primes in\na lower level create the primes in the level directly above.\nFor example, for k = 3, an incarnation I for which q 4 | \u03c63 (n) would be s1 , s2 , s3 , r3 , r4 \u2208 Pq\nwhere r1 \u2208 Ps1 , r2 \u2208 Ps2 s3 , p1 \u2208 Pr1 r2 , p2 \u2208 Pr3 r4 , with p1 p2 | n.\nDefinition 9. An subincarnation of I is an incarnation with added conditions. In other\nwords if J is a subincarnation of I and an integer n satisfies incarnation J, then it will also\nsatisfy incarnation I.\nFor example, I is a subincarnation of the incarnation s1 , s3 , r3 , r4 \u2208 Pq where r1 \u2208 Ps1 , r2 \u2208\nPs3 , p1 \u2208 Pr1 r2 , p2 \u2208 Pr3 r4 , with p1 p2 | n.\nLet p be a prime in Lh,i which we need to divide \u03c6k\u2212h+1(n). The definition of Lh,i ensures\nthat there is a unique prime dividing \u03c6k\u2212h (n) for which p | r \u2212 1. The primes in levels\n(k, 1), (k, 2) dividing n are for the base case of the recursion, so that each prime divides\n\u03c60 (n) = n. When i = 2 we are introducing new primes to get greater powers of q in \u03c6k (n).\nNote that it's not necessary to have any primes on the levels (i, 2). In fact the \"worst case\nscenario\" that we will see has no primes on these except Level (1,2).\nNow that we've described the way to get q a | \u03c6k (n), what is our exponent a? Let mh,i =\n#Lh,i . From the recursion above we can see that q mk,2 | \u03c6(n) and so do the primes in Lk\u22121,1 .\nFor the second iteration of \u03c6, q mk,2 \u22121+mk\u22121,2 | \u03c62 (n) and so do the primes in Lk\u22122,1. Hence\nthe power of q which divides \u03c6k (n) is\nX\n(14)\nmax (m1,1 +\n(mh,2 \u2212 1))\n1\u2264j\u2264k\n\n2\u2264h\u2264j\n\nwhere the sum can be empty if there are no primes inQthe second level (j, 2) or there are not\nenough to survive, i.e. mj,2 < j \u2212 1 and hence q \u2224 \u03c6j ( Lj,2 p). Without loss of generality, we\ncan assume the former, since the later is a subincarnation of the former.\nNow we'll introduce some notation to be used in future propositions. For any single\nincarnation of Case 3, let M be the total number of primes, N be the total new primes\nintroduced at the levels (h, 2) and H be the maximum necessary level (h, 2). Specifically\nX\nX\nmh,2\n(mh,1 + mh,2 ) N =\nM=\nh\u2264H\n\nh\n\nand H yields the maximum value in (14). Note that under this notation, q N \u2212H+1 | \u03c6k (n).\nFor example, in the incarnation I above,\nL1,2 = {s1 , s2 , s3 }, L2,1 = {r1 , r2 }, L2,2 = {r3 , r4 }, L3,1 = {p1 , p2 }, L3,2 = \u2205\n7\n\n\fas well as\nm1,2 = 3, m2,1 = 2, m2,2 = 2, m3,1 = 2, m3,2 = 0.\nHence M = 9, N = 5, H = 2 and so the power of q which divides \u03c63 (n) is 5 \u2212 2 + 1 = 4 as\nexpected.\nNow that we've described Case 3, how many possible n are in that case?\nLemma 10. The number of n \u2264 x satisfying any incarnation of Case 3 is\n\u0013\n\u0012\nM\nM xy\nO c\nqN\nwhere c is the constant from equation (11).\nProof. Let Lh = Lh,1 \u222a Lh,2 . We use Brun-Titchmarsh (11) for all the primes at each level of\nCase 3, so the number of n is\nX X X\n\nX\n\n***\n\nn\u2264x p1 \u2208L1 p2 \u2208L2\n\n1=\n\nX X\n\n***\n\n\u226a\n\nX X\n\n***\n\n1\n\npk \u2208Lk pk |n\nn\u2264x\n\np1 \u2208L1 p2 \u2208L2\n\npk \u2208Lk\n\nX X\n\np1 \u2208L1 p2 \u2208L2\n\nX\n\npk \u2208Lk\n\nx\nQ\n\npk \u2208Lk\n\npk\n\n.\n\nNote that we have repeatedly counted the same primes in the sum as we can reorder the\nprimes in each level. It won't be important here, but will need to be more carefully addressed\nlater. Since the primes in level (k, 1) gave us some pk \u2208 Ppk\u22121 for all the primes in Lk\u22121 , and\nfor p \u2208 Lk,k we have p \u2208 Pq . By Brun\u2013Titchmarsh (11) we get that the above sum is\nX\nX X\nx(cy)mk,1 +mk,2\nQ\n***\n\u226a\n.\nmk,2\npk\u22121 \u2208Lk\u22121 pk\u22121 q\np\n\u2208L\np \u2208L p \u2208L\n1\n\n1\n\n2\n\nk\u22121\n\n2\n\nk\u22121\n\nOnce again we get mk\u22121,1 + mk\u22121,2 new applications of Brun-Titchmarsh giving the new\nprimes in level k \u2212 2 as well as mk\u22121,2 new powers of q. Continuing along in this manner we\nget:\nX x(cy)\n\u226a\nQ\np1 \u2208L1\n\nP\n\nP\n\n2\u2264i\u2264k (mi,1 +mi,2 )\n\np1 \u2208L1 p1 q\n\nP\n\n2\u2264i\u2264k\n\nmi,2\n\nx(cy) 1\u2264i\u2264k (mi,1 +mi,2 )\nx(cy)M\nP\n\u226a\n=\n.\nqN\nq 1\u2264i\u2264k mi,2\n\u0003\nThe last thing we'll consider in this section about the ways to obtain \u03c6k (n) is to determine\nthe number of possible incarnations of Case 3. We note that there are lots of incarnations\nwhich are subincarnations of others. We will develop a concept of minimality.\nDefinition 11. An incarnation of Case 3 is minimal if it does not contain any strings of\np1 \u2208 Pp2 , p2 \u2208 Pp3 . . . pk\u22121 \u2208 Ppk where pk | n.\nNote that any incarnation of Case 3 is a subincarnation of a minimal one. We now use\nthis concept to show the number of necessary incarnations of Case 3 is small.\n8\n\n\f5. Large Primes Dividing \u03c6k (n)\nIn this section we will prove the two propostions dealing with q being large. We'll start\nwith the propostion where \u03bdq (\u03c6k (n)) = 1.\nProof of Proposition 3. It suffices to show\nX X\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q \u226a xy k\nn\u2264x\n\nq>y k\n\u03bdq (\u03c6k (n))=1\n\n\u0001\nk \u0001\nx\nas then there are at most O ykxy\n= O \u03c8(x)\nsuch n where the bound for the sum in\n\u03c8(x)\nProposition 3 fails to hold. We examine the cases where \u03bdq (\u03c6k (n)) = 1. Using the notation\nin Lemma 10 we have two subcases for Case 3, whether N = 1 or N > 1.\nSuppose N = 1, then H = 1, m1,2 = 1 and mh,2 = 0 for 1 < h \u2264 k. Since mh,1 \u2264\nmh\u22121,1 + mh\u22121,2 we get mh,1 \u2264 1 for all 1 \u2264 h \u2264 k. Hence mh,1 = 1 for all h \u2264 k and so we\nget the case:\np1 \u2208 Pq , p2 \u2208 Pp1 , p3 \u2208 Pp2 , . . . , pk \u2208 Ppk\u22121\nwhere pk | n. However in this case we also get \u03bdq (\u03bbk (n))) = 1 giving us no additions to our\nsum.\nP\nP\nSuppose N > 1, then M = h (mh,1 + mh,2 ) \u2264 k h mh,2 = kN so the number of cases\nwe get are\n\u0013\n\u0012\nM\ncM xy kN\ncM xy 2k\nM xy\n\u226a\n\u226a\nO c\nqN\nqN\nq2\nsince y > q k . Since vq (\u03c6k (n)) = N \u2212 H + 1 and H \u2264 k, N \u2264 k implying that M \u2264 k 2 .Hence\ncM is bounded as a function of k. Also since M is bounded in terms of k, there are Ok (1)\npossible incarnations of Case 3, and the bound already absorbs the possiblities from Cases\n1 and 2. Hence we have\nX\n\nq>y k\n\nX\n\n(\u03bdq (\u03c6k (n)) \u2212 \u03bdq (\u03bbk (n))) log q \u2264\n\nn\u2264x\n\u03bdq (\u03c6k (n))=1\n\nX\n\nlog q\n\nn\u2264x\n\u03bdq (\u03c6k (n))=1\nN >1\nX 2k\n\nq>y k\n\n\u226a\n\nX\n\nq>y k\n\nxy log q\nq2\n\n\u226a xy k\nby (4).\n\n\u0003\n\nWe turn our attention to vq (\u03c6k (n)) > 1. We have to be more careful here since we can't\nguarantee that the number of incarnations of Case 3 is Ok (1). We'll start by proving a lemma\nwhich can eliminate a lot of those cases.\n9\n\n\fLemma 12. Let q > y k and Sq = Sq (x) consist of all n \u2264 x such that Case 1,2 or Case 3\nwhere M \u2264 k(N \u2212 1) occurs. Then\nxy k\n#Sq \u226a 2\nq\nProof. There are clearly Ok (1) incarnations of Cases 1 and 2 and each yield at most O(xy k /q 2 )\nsuch n. By Lemma 10 for each incarnation of Case 3, we get at most\n\u0012 M M\u0013\nc y\ncM y k\nO\n\u226a\nqN\nq2\nsuch n since M \u2264 k(N \u22121) and q > y k . It remains to show we only require Ok (1) such incarnations. Suppose n satisfies an incarnation with M \u2264 k(N \u22121). Then it also satisfies a minimal\nincarnation with M \u2264 k(N \u2212 1) since removing a string of p1 \u2208 Pp2 , p2 \u2208 Pp3 . . . pk\u22121 \u2208 Ppk ,\nwould decrease N by 1 and M by k leaving the inequality unchanged. Secondly we can assume that n also satisfies an incarnation where k(N \u2212 2) < M \u2264 k(N \u2212 1) since we can keep\neliminating primes in the Li,2 , which decrease N by 1, but M by at most k. This must eventually produce an incarnation where k(N \u2212 2) < M \u2264 k(N \u2212 1) since if we eliminate all primes\nin the Li,2 but 1, then M > k(N \u2212 1). Also note that the condition mh,1 \u2264 mh\u22121,1 + mh\u22121,2\nforces M \u2264 kN. If M is bounded between k(N \u2212 2) and kN and the incarnation is minimal,\nwe get that N is bounded by 2k since eliminating a prime in Li,2 can only shrink M by at\nmost k \u2212 1 since our incarnation is minimal.\nTherefore n satisifies an incarnation where N and hence M are bounded functions of\nk. Since there are only Ok (1) such incarnations, we get our result, noting that cM can be\nabsorbed into the constant as well.\n\u0003\nS\nProof of Proposition 4. Let S = S(x) = q>yk Sq . Using Lemma 12 we have\n#S \u2264\n\nX\n\nq>y k\n\n#Sq \u226a\n\nX xy k\nX 1\nxy k\nx\nk\n\u226a\nxy\n\u226a\n\u226a\nq2\nq2\nlog(y k )y k\n\u03c8(x)\nk\nk\n\nq>y\n\nq>y\n\nby (5). As for the n with n \u2208\n/ S and a = \u03bdq (\u03c6k (n)) > 1, the only remaining case is that\nM > k(N \u2212 1). Recall that a = N + H \u2212 1. If H = 1, then N = m1,2 = a, and so m2,1 = a \u2212 1\nor a. Otherwise for k \u2265 2,\nM=\n\nX\n\nmh,1 \u2264 a + (k \u2212 1)m2,1 \u2264 a + (k \u2212 1)(a \u2212 2) = k(a \u2212 1) \u2212 k + 2 \u2264 (k \u2212 1)N\n\nh\n\nleading to a contradiction. If H > 1, then we again wish to show that m2,1 \u2265 a \u2212 k.\nX\nM=\n(mh,1 + mh,2 )\nh\n\n\u2264 km1,2 + (k \u2212 1)\n\nX\n\nmh,2\n\nh>1\n\n= m1,2 + (k \u2212 1)N\n= k(N \u2212 1) \u2212 N + k + m1,2\n10\n\n\fwhich implies m1,2 > N \u2212 k and so\nthen\nX\nM=\n(mh,1 + mh,2 )\n\nP\n\nh>1 mh,2\n\n= N \u2212 m1,1 < k. Therefore if m2,1 < a \u2212 k,\n\nh\n\n\u2264 m1,2 + (k \u2212 1)m2,1 + (k \u2212 1)\n\nX\n\nmh,2 \u2264 a + (k \u2212 1)(a \u2212 k \u2212 1) + (k \u2212 1)(k \u2212 1)\n\nh>1\n\n= ak \u2212 2k\n\u2264 k(N \u2212 1)\nas N > a again leading to a contradiction. Hence m2,1 \u2265 a \u2212 k and so we can get\nX\n\nX\n\n(\u03bdq (\u03c6k (n)) log q \u2264 2\n\nq>y k\n\nX\n\nX\n\n(\u03bdq (\u03c6k (n)) \u2212 1) log q\n\nq>y k\n\nn\u2208S\n/\nn\u2264x \u03bdq (\u03c6 (n))>1\nk\n\nn\u2208S\n/\nn\u2264x \u03bdq (\u03c6 (n))>1\nk\n\n\u226a\n\nX\n\nlog q\n\nq>y k\n\nX\n\na\n\na\u22652\n\nX\n\n1.\n\nn\u2264x\nn\u2208S\n/\n\u03bdq (\u03c6k (n))=a\n\nUnfortunately, just blindly using the Brun-Titchmarsh inequality in (11) won't be good\nenough as we must sum over all a. Let g(a, k) = (a \u2212 k)! if a \u2265 k or 1 otherwise and note\nthat since we have m1,2 \u2265 a \u2212 k, we have at least g(a, k) permutations of the same primes.\nThen by using Lemma 10 we get\n\na\n\nX\n\nlog q\n\nq>y k\n\nX\n\n1\u226aa\n\nn\u2264x\nn\u2208S\n/\n\u03bdq (\u03c6k (n))=a\n\nx(cy)M\nack(a+k\u22121) xy 2k\n\u226a\nq N g(a, k)\nq 2 g(a, k)\n\nusing the assumption that q > y k and M \u2264 kN \u2264 k(a + k \u2212 1). Hence we get our sum is\nX\n\nX\n\n(\u03bdq (\u03c6k (n)) log q \u226a\n\nn\u2208S\n/\nq>y k\nn\u2264x \u03bdq (\u03c6 (n))>1\n\nX\n\nlog q\n\nX ack(a+k\u22121) xy 2k\na\u22652\n\nq>y k\n\nq 2 g(a, k)\n\nk\n\n= xy 2k\n\nX log q X ack(a+k\u22121)\nq 2 a\u22652 g(a, k)\nk\n\nq>y\n\nHowever the latter sum converges to some function depending on k, and so we get\n\u226a xy 2k\n\nX log q\n\u226a xy k\n2\nq\nk\n\nq>y\n\nby (4).\n\n\u0003\n11\n\n\f6. Small Primes Dividing \u03bbk (n)\nWe now turn our attention to the bound involving \u03bbk (n) in the summand. Just like when\nwe were dealing with the number of cases where q a | \u03c6k (n), we will need a lemma to deal\nwith the number of cases where q a | \u03bbk (n). Fortunately this case is much simpler as the only\ntwo ways for q a | \u03bb(n) is for q a+1 | n or for there to exist p | n with p \u2208 Pqa . Note that these\nconditions aren't sufficient, but are necessary when q = 2.\nk\n\nLemma 13. The number of positive integers n \u2264 x for which q a | \u03bbk (n) is O( xy\n).\nqa\nProof. We'll proceed by induction on k. If k = 1, then q a | \u03bb(n) if q a+1 | n or p \u2208 Pqa with\np | n. The number of such n is at most\nX x\nX\nX\nx\nxy\nxy\nx\n\u226a a+1 + a \u226a a .\n1+\n1 \u226a a+1 +\nq\np\nq\nq\nq\nn\u2264x\nn\u2264x\np\u2208P a\nq a+1 |n\n\nq\n\np\u2208Pqa\np|n\n\nk\u22121\n\nusing (11). Suppose the number of n \u2264 x for which q a | \u03bbk\u22121 (n) is O( xyqa ). If q a | \u03bbk (n),\nthen either q a+1 | \u03bbk\u22121 (n) or p \u2208 Pqa with p | \u03bbk\u22121 (n). Hence the number of such n is\nbounded by\nX\n\nX\n\n1+\n\nn\u2264x\nq a+1 |\u03bbk\u22121 (n)\n\n1\u226a\n\nn\u2264x\np\u2208Pqa\np|\u03bbk\u22121 (n)\n\nX xy k\u22121\nxy k\u22121 xy k\nxy k\nxy k\u22121\n+\n\u226a\n+\n\u226a\nq a+1\np\nq a+1\nqa\nqa\np\u2208P a\nq\n\nas needed.\n\n\u0003\n\nProof of Proposition 5. Like in the proof of previous propositions, we'll show\nXX\n\u03bdq (\u03bbk (n)) log q \u226a xy k .\nn\u2264x q\u2264y k\n\nThe left hand side is equal to\nXX\nXX\nX\n1\n\u03bdq (\u03bbk (n)) log q =\nlog q\nn\u2264x q\u2264y k\n\nn\u2264x q\u2264y k\n\n\u2264\n\nXX\n\na\u2208N\nq a |\u03bbk (n)\n\nlog q\n\nn\u2264x q\u2264y k\n\nX\n\n1+\n\na\u2208N\nq a \u2264y k\n\nXX\n\nn\u2264x q\u2264y k\n\nlog q\n\nX\n\n1.\n\na\u2208N\nq a |\u03bbk (n)\nq a >y k\n\nThe first sum is\nXX\n\nlog q\n\nn\u2264x q\u2264y k\n\nX\n\n1=\n\nX X\n\n\u039b(m) \u226a\n\nn\u2264x m\u2264y k\n\na\u2208N\nq a \u2264y k\n\nX\n\ny k \u226a xy k ,\n\nn\u2264x\n\nand by Lemma 13 and using the geometric estimate in (6) the second sum becomes\nXX\n\nn\u2264x q\u2264y k\n\nlog q\n\nX\n\na\u2208N\nq a |\u03bbk (n)\nq a >y k\n\n1\u226a\n\nX\n\nq\u2264y k\n\nlog q\n\nX xy k\nX\nxy k\n\u226a\n\u226a xy k .\nlog\nq\na\nk\nq\ny\nk\na\u2208N\n\nq a >y k\n\n12\n\nq\u2264y\n\n\f\u0003\n7. Reduction To hk (n) For Small Primes\nThe small primes dividing \u03c6k (n) are what contributes to the asymptotic term of log(n/\u03bbk (n)).\nIn this section we show that the important case is the supersquarefree case of p dividing \u03c6k (n)\nwhich is when\np \u2208 Pp1 , p1 \u2208 Pp2 . . . pk\u22121 \u2208 Ppk , pk | n.\nP\nFor this reason we will approximate the sum q\u2264yk vq (\u03c6k (n)) log q with\nX X\nX X\n(15)\nhk (n) =\n***\n\u03bdq (pk \u2212 1) log q.\npk |pk\u22121 \u22121 q\u2264y k\n\np1 |n p2 |p1 \u22121\n\nProof of Proposition 6. For any fixed prime q, we know that\nX\nvq (\u03c6(m)) = max{0, vq (m) \u2212 1} +\nvq (p \u2212 1),\np|m\n\nwhich implies\nX\n\nvq (p \u2212 1) \u2264 vq (\u03c6(m)) \u2264 vq (m) +\n\np|m\n\nX\n\nvq (p \u2212 1).\n\np|m\n\nRepeated use of this inequality for m = \u03c6l (n) where l ranges from k \u2212 1 to 0 yields\nX\n\nvq (p \u2212 1) \u2264 vq (\u03c6k (n))\n\np|\u03c6k\u22121 (n)\n\nX\n\n\u2264\n\n(16)\n\nX\n\nvq (p \u2212 1) +\n\np|\u03c6k\u22121 (n)\n\nvq (p \u2212 1)\n\np|\u03c6k\u22122 (n)\n\n+***+\n\nX\n\nvq (p \u2212 1) + vq (n).\n\np|\u03c6(n)\n\nA prime p divides \u03c6k\u22121(n) either in the supersquarefree case (ssf), or not in the supersquarefree case (nssf), yielding\nX\n\nvq (p \u2212 1) \u2264\n\nssf\n\nX\n\nvq (p \u2212 1)\n\np|\u03c6k\u22121 (n)\n\n\u2264\n\nX\n\nvq (p \u2212 1) +\n\nssf\n\nX\n\nvq (p \u2212 1).\n\nnssf\n\nCombining this inequality with (16) yields\nX\nvq (p \u2212 1) \u2264 vq (\u03c6k (n))\nssf\n\n\u2264\n\nX\nssf\n\nvq (p \u2212 1) +\n\nX\n\nnssf\n\nvq (p \u2212 1) +\n\nX\n\np|\u03c6k\u22122 (n)\n\nvq (p \u2212 1) + * * * +\n\nX\n\nvq (p \u2212 1) + vq (n).\n\np|\u03c6(n)\n\nSubtracting the sum over the supersquarefree case, multiplying through by log q and summing over q \u2264 y k we get\n13\n\n\f0\u2264\n\nX\n\n\u03bdq (\u03c6k (n)) log q \u2212 hk (n)\n\nq\u2264y k\n\n\u2264\n\nXX\n\nq\u2264y k\n\nvq (p \u2212 1) log q +\n\nnssf\n\nX\n\nq\u2264y k\n\nX\n\nvq (p \u2212 1) log q + * * * +\n\nXX\n\nq\u2264y k\n\np|\u03c6k\u22122 (n)\n\nvq (p \u2212 1) log q\n\np|n\n\nwhere we get hk (n) from (15). Hence it suffices to show that the sum on the right side\nbecomes our error term. For the sum\n\nXX X\nn\u2264x\n\nq\u2264y k\n\nvq (p \u2212 1) log q =\n\nXX X\nn\u2264x\n\np|\u03c6m (n)\n\n=\n\nq\u2264y k\n\nXX\n\nX\n\nlog q\n\np|\u03c6m (n) a\u2208N\nq a |p\u22121\n\nlog q\n\nn\u2264x q\u2264y k\n\nX X\n\n1,\n\na\u2208N p\u2208Pqa\np|\u03c6m (n)\n\nwe'll split the sum over values of p \u2264 y k\u22121 and p > y k\u22121. For p \u2264 y k\u22121 we uniformly get for\nall n that\n\nX\n\nq\u2264y k\n\nlog q\n\nX X\n\n1\u2264\n\na\u2208N p\u2208Pqa\np\u2264y k\u22121\np|\u03c6m (n)\n\nX\n\nlog q\n\nX\n\nlog q\n\n\u03c0(y k\u22121; q a , 1)\n\na\u2208N\n\nq\u2264y k\n\n\u226a\n\nX\n\nq\u2264y k\n\n\u226a y k\u22121\n\nX y k\u22121\n\u03c6(q a )\na\u2208N\n\nX log q\nq\nk\n\nq\u2264y\n\n\u226ay\n\nk\u22121\n\nlog y\n\nusing the geometric estimate (6) and the prime number theorem for arithmetic progressions.\nAs for p > y k\u22121 we fix an M and N from case 3 for which p | \u03c6m (n), of which there are at\nmost Ok (1) such M, N since vp (\u03c6(m)) = 1. Therefore\n14\n\n\fXX\n\nlog q\n\nn\u2264x q\u2264y k\n\nX X\n\n1\u226a\n\na\u2208N p>y k\u22121\np\u2208Pqa\np|\u03c6m (n)\n\nX\n\nlog q\n\nq\u2264y k\n\nX X xy M\npN\na\u2208N p\u2208P a\nq\n\np>y k\u22121\n\nX\n\n\u2264\n\nlog q\n\nq\u2264y k\n\n\u226a\n\nX\n\nX X xy M \u2212(k\u22121)(N \u22121)\np\na\u2208N p\u2208P a\nq\n\nlog q\n\na\u2208N\n\nq\u2264y k\n\n\u226a\n\nX xy M \u2212(k\u22121)(N \u22121)+1\nqa\n\nX xy M \u2212(k\u22121)(N \u22121)+1 log q\nq\nk\n\nq\u2264y\n\n\u226a xy M \u2212(k\u22121)(N \u22121)+1 log y k\n\u226a xy M \u2212(k\u22121)(N \u22121)+1 log y.\nSince the M, N were chosen for \u03c6m (n) we know that M \u2264 mN where equality holds if and\nonly if we are in the supersquarefree case. Now either m \u2264 k \u2212 2 or m = k \u2212 1 and we are\nnot in the supersquarefreecase. In the former case we have an error of\nO(xy (k\u22122)N \u2212(k\u22121)(N \u22121)+1 log y) = O(xy k\u2212N log y) = O(xy k\u22121 log y)\nsince N \u2265 1, or in the latter case\nO(xy (k\u22121)N \u22121\u2212(k\u22121)(N \u22121)+1 log y) = O(xy k\u22121 log y).\nThus we get\nX\u0012 X X\nn\u2264x\n\nvq (p \u2212 1) log q +\n\nq\u2264y k nssf\n\nX\n\nX\n\nvq (p \u2212 1) log q + . . .\n\nq\u2264y k p|\u03c6k\u22122 (n)\n\n+\n\nXX\n\nq\u2264y k p|n\n\nvq (p \u2212 1) log q\n\n\u0013\n\n\u226a xy k\u22121 log y\n\nand so\nXX\n\nvq (p \u2212 1) log q +\n\nq\u2264y k nssf\n\nX\n\nX\n\nvq (p \u2212 1) log q + . . .\n\nq\u2264y k p|\u03c6k\u22122 (n)\n\n+\n\nXX\n\nvq (p \u2212 1) log q \u226a y k\u22121 log y * \u03c8(x)\n\nq\u2264y k p|n\n\nas required.\n\n\u0003\n15\n\n\f8. Reduction to the First and Second Moments\nThe Tur\u00e1n-Kubilius inequality [5, Lemma 3.1] asserts that if f (n) is a complex additive\nfunction, then there exists an absolute constant C such that\n(17)\n\nX\n\n|f (n) \u2212 M1 (x)|2 \u2264 CxM2 (x)\n\nn\u2264x\n\nP\nP\nwhere M1 (x) = p\u2264x |f (p)|/p and M2 (x) = p\u2264x |f (p)|2/p. Since hk (n) is additive we can\nP\nP\napply this inequality where M1 (x) = p\u2264x hk (p)/p, M2 (x) = p\u2264x hk (p)2 /p. We will need\nto find bounds on M1 and M2 therefore it's our goal to prove the following two propositions:\ne\n\nProposition 14. For all x > ee ,\nM1 (x) =\n\n1\ny k log y + O(y k )\n(k \u2212 1)!\n\ne\n\nProposition 15. For all x > ee ,\nM2 (x) \u226a y 2k\u22121 logk\u22121 y.\nThese will lead to a proof of Proposition 7.\nProof of Proposition 7. Let N denote the number of n \u2264 x for which |hk (n) \u2212 M1 (x)| > y k .\nThe contribution of such n to the sum in (17) is at least Ny 2k . Thus Propostion 15 implies\n1\ny k log y + O(y k ) except\nN \u226a x logk\u22121 y/y and so Proposition 14 implies that hk (n) = (k\u22121)!\nfor a set of size O(x(log y)k\u22121/y).\n\u0003\n\n9. Lots of Summations\nIn our proofs of Propositions 14 and 15 we will see that M1 (x) and M2 (x) will reduce to\nsummations involving \u03c0(x; p, 1). We will be using some sieve techniques to bound these sums\nand those will require some bounds on sums on multiplicative functions involving \u03c6(m). This\nsection will involve the estimation of the latter sums.\nLemma 16. For any non-negative integer L we have\n(18)\n\nmL\n\u226aL log t.\nL+1\n\u03c6(m)\nm\u2264t\n\nX\n\nProof. If f (n) is a non-negative multiplicative function, we know that\n(19)\n\nX\nn\u2264t\n\nf (n) \u2264\n\n\u221e\nYX\np\u2264t r=0\n\n16\n\nf (pr ).\n\n\fApplying (19) with\n\nmL\n\u03c6(m)L+1\n\nyields\n\n\u0013\n\u221e\nY\u0012\nX\nmL\nprL\n\u2264\n1+\n\u03c6(m)L+1\n(pr \u2212 pr\u22121 )L+1\nr=1\nm\u2264t\np\u2264t\n\u0013\n\u221e\nY\u0012\nX\npL\u2212r+1\n=\n1+\n(p \u2212 1)L+1\nr=1\np\u2264t\n\u0013\nY\u0012\n1\npL\n=\n1+\n(p \u2212 1)L+1 1 \u2212 p1\np\u2264t\n\u0013\nY\u0012\npL+1\n=\n1+\n(p \u2212 1)L+2\np\u2264t\n\u0012X\n\u0013\u0013\n\u0012\npL+1\n\u2264 exp\nlog 1 +\n(p \u2212 1)L+2\np\u2264t\n\u0012X\u0012\n\u0012 \u0013\u0013\u0013\n1\npL+1\n= exp\n+ OL 2\nL+2\n(p \u2212 1)\np\np\u2264t\n\u0012X\u0012\n\u0012 \u0013\u0013\u0013\n1\n1\n= exp\n+ OL 2\np\np\np\u2264t\nX\n\n\u226aL log t\nusing (3).\n\n\u0003\n\nLemma 17. Given a positive integer C \u2264 t\u03b3 and non-negative integer L we have\nX\n(Cm + 1)L\n\u226aL,\u03b3 log t.\n(20)\nL \u03c6(m)\n\u03c6(Cm\n+\n1)\nm\u2264t\nProof. It will suffice to show\nX (Cm + 1)2L\u22121\nm\u2264t\n\n\u03c6(Cm +\n\n1)2L\n\n\u226aL\n\nlog t\nC\n\nas then by Cauchy\u2013Schwarz we can get that\n\u00132 X\n\u0012X\n(Cm + 1)2L\u22121 X (Cm + 1)\n(Cm + 1)L\n\u2264\n\u03c6(Cm + 1)L \u03c6(m)\n\u03c6(Cm + 1)2L m\u2264t \u03c6(m)2\nm\u2264t\nm\u2264t\n\u0013\n\u0012\nlog t\nC log t\n\u226aL\nC\n\u226aL log2 t\nby using (18). Using Mobius inversion, let s(n) be the multiplicative function defined by\nX\nn2L\n=\n1\n\u2217\ns\n=\ns(d).\n\u03c6(n)2L\nd|n\n\n17\n\n\fTesting at prime powers, we can easily see that\n\u0012\n\u0013\u22122L\n1\ns(1) = 1, s(p) = 1 \u2212\n\u2212 1 and s(pk ) = 0 for all k \u2265 2.\np\nHence\nX (Cm + 1)2L\u22121\nm\u2264t\n\n\u03c6(Cm + 1)2L\n\n=\n\nX\n\nn2L\u22121\n\u03c6(n)2L\n\nX\n\n1 n2L\nn \u03c6(n)2L\n\nX\n\n1X\ns(d)\nn\n\nC<n\u2264Ct+1\nn\u22611 (mod C)\n\n=\n\nC<n\u2264Ct+1\nn\u22611 (mod C)\n\n=\n\nC<n\u2264Ct+1\nn\u22611 (mod C)\n\n=\n\nX\n\nd\u2264Ct+1\n\ns(d)\n\nd|n\n\nX\n\nC<n\u2264Ct+1\nd|n\nn\u22611 (mod C)\n\n1\n.\nn\n\nBy (8) and noticing that C and d are relatively prime we get\nX\n\nC<n\u2264Ct+1\nd|n\nn\u22611 (mod C)\n\n1\nlog t\n1\n\u226a\n+\nn\nC +1\ndC\n\nwhere the first term occurs only if d | C + 1. We require some estimates on s(d).\n\u0013\nX s(d)\nY \u0012\n(1 \u2212 1/p)\u22122L \u2212 1\n1+\n\u2264\nd\np\nd\u2264Ct+1\np\u2264Ct+1\n\u0013\n\u0012\nY\nCL\n\u2264\n1+ 2\np\np\u2264Ct+1\n\u0012 X\n\u0012\n\u0013\u0013\nCL\n= exp\nlog 1 + 2\np\np\u2264Ct+1\n\u0012 X\n\u0012 \u0013\u0013\n1\n= exp\nOL 2\np\np\u2264Ct+1\n= exp(OL (1))\n\u226aL 1\n18\n\n\fand\nX\n\ns(d) \u2264\n\nd\u2264Ct+1\nd|C+1\n\nX\n\ns(d)\n\nd|C+1\n\n= (1 \u2217 s)(C + 1)\n\u0012\n\u00132L\nC +1\n=\n\u03c6(C + 1)\n\u226a (log log C)2L\n\u226a\u03b3 (log log t)2L\n\u226aL,\u03b3 log t.\nTherefore\nX (Cm + 1)2L\u22121\nm\u2264t\n\n\u03c6(Cm + 1)2L\n\n\u226a\n\nX s(d) log t\ns(d)\nlog t\n+\n\u226aL,\u03b3\nC + 1 d\u2264t\nCd\nC\nd\u2264Ct+1\nX\n\nd|C+1\n\nas needed.\n\n\u0003\n\nLemma 18. For positive integers C1 , C2 , . . . , Cr \u2264 t\u03b3 and non-negative integers L1 , L2 , . . . , Lr\nwe have\nX\n(C1 m + 1)L1 (C2 m + 1)L2 . . . (Cr m + 1)Lr\n\u226aL1 ,...,Lr ,\u03b3 log t.\n(21)\nL1 \u03c6(C m + 1)L2 . . . \u03c6(C m + 1)Lr \u03c6(m)\n\u03c6(C\nm\n+\n1)\n1\n2\nr\nm\u2264t\nProof. We proceed by induction. The case r = 1 is covered by Lemma 17. Suppose\n(C1 m + 1)L1 (C2 m + 1)L2 ...(Cr m + 1)Lr\n\u226aL1 ,...,Lr ,\u03b3 log t.\n\u03c6(C1 m + 1)L1 \u03c6(C2 m + 1)L2 . . . \u03c6(Cr m + 1)Lr \u03c6(m)\nm\u2264t\nX\n\nBy Cauchy\u2013Schwarz, we get that\n\u0012X\n\u00132\n(C1 m + 1)L1 (C2 m + 1)L2 . . . (Cr+1 m + 1)Lr+1\n\u03c6(C1 m + 1)L1 \u03c6(C2 m + 1)L2 . . . \u03c6(Cr+1 m + 1)Lr+1 \u03c6(m)\nm\u2264t\n\u2264\n\nX\n(Cr+1 m + 1)2Lr+1\n(C1 m + 1)2L1 (C2 m + 1)2L2 . . . (Cr m + 1)2Lr\n\u03c6(C1 m + 1)2L1 \u03c6(C2 m + 1)2L2 . . . \u03c6(Cr m + 1)2Lr \u03c6(m) m\u2264t \u03c6(Cr+1m + 1)2Lr+1 \u03c6(m)\nm\u2264t\nX\n\n\u226aL1 ,...,Lr+1,\u03b3 log2 t\nby Lemma 17, completing the proof.\n\n\u0003\n\nLemma 19. For positive integers C1 , C2 , ..., Cr \u2264 t\u03b3 and non-negative integers L1 , L2 , ..., Lr , L\nwe have\nX\n(C1 m + 1)L1 (C2 m + 1)L2 ...(Cr m + 1)Lr mL\u22121\n(22)\n\u226aL1 ,...,Lr ,L,\u03b3 log t.\nL1 \u03c6(C m + 1)L2 . . . \u03c6(C m + 1)Lr \u03c6(m)L\n\u03c6(C\nm\n+\n1)\n1\n2\nr\nm\u2264t\n19\n\n\fProof. Once again we'll use Cauchy\u2013Schwarz and the previous lemmas.\n(C1 m + 1)L1 (C2 m + 1)L2 . . . (Cr m + 1)Lr mL\u22121\n\u03c6(C1 m + 1)L1 \u03c6(C2 m + 1)L2 . . . \u03c6(Cr m + 1)Lr \u03c6(m)L\nm\u2264t\n\n\u0012X\n\n\u2264\n\n\u00132\n\nX m2L\u22122\n(C1 m + 1)2L1 (C2 m + 1)2L2 . . . (Cr m + 1)2Lr\n\u03c6(C1m + 1)2L1 \u03c6(C2 m + 1)2L2 . . . \u03c6(Cr m + 1)2Lr \u03c6(m) m\u2264t \u03c6(m)2L\u22121\nm\u2264t\n\nX\n\n\u226aL1 ,...,Lr ,L,\u03b3 log2 t\nby Lemmas 16 and 18.\n\n\u0003\n\n10. More Summations involving \u03c0(t, p, 1)\nThe previous section involved lemmas required to prove summations including terms such\nas \u03c0(t, p, 1). A lot of these summations will involve sieving techniques. This section will be\nsplit into proofs of two lemmas involving the summations required for the sums arising from\nthe Propositions 14 and 15.\nLemma 20. Let b, k, l be positive integers with 2 \u2264 l \u2264 k. Let t > ee be a real number and\nlet constants \u03b1, \u03b11 , \u03b12 satisfy 0 < \u03b1 < 1/2 and 0 < \u03b11 < \u03b12 < 1/2.\n(a) If b > t\u03b1 , then\n\n(23)\n\nX\n\nX\n\n***\n\npk \u2208Pb pk\u22121 \u2208Ppk\n\nX\n\n\u03c0(t; p2 , 1) \u226a\n\np2 \u2208Pp3\n\nt log t(log log t)k\u22122\n.\nb\n\n(b) If b \u2264 t\u03b11 , then\nX\n\n(24)\n\nX\n\n***\n\npl \u2208Pb pl\u22121 \u2208Ppl\npl >t\u03b12\n\nX\n\n\u03c0(t; p2 , 1) \u226a\n\np2 \u2208Pp3\n\nbl\u22121 t\n.\n\u03c6(b)l log t\n\n(c) If b \u2264 t\u03b11 , then\n\n(25)\n\nX\n\nX\n\npl \u2208Pb pl\u22121 \u2208Ppl\n\n***\n\nX\n\n\u03c0(t; p2 , 1) \u226a\n\np2 \u2208Pp3\n\nt(log log t)l\u22121\n.\n\u03c6(b) log t\n\nThe implicit constants in (a) \u2212 (c) depend on the choices of the \u03b1.\n20\n\n\fProof. For (23) we just use the trivial estimate \u03c0(t; p2 , 1) \u2264 t/p2 and several uses of BrunTitchmarsh (11) to get\nX\n\nX\n\n***\n\nX\n\n\u03c0(t; p2 , 1) \u2264\n\n***\n\npk \u2208Pb pk\u22121 \u2208Pk\n\np2 \u2208P3\n\npk \u2208Pb pk\u22121 \u2208Pk\n\nX\n\nX\n\n\u226at\n\nX\n\nX\n\npk \u2208Pb pk\u22121 \u2208Pk\n\n\u226at\n\n2\n\n\u2264t\n\n3\n\nX log log t\n***\np3\np \u2208P\n\nX (log log t)\npk\np \u2208P\nk\n\n3\n\n4\n\nk\u22122\n\nb\n\nX\n\nm\u22611 (mod b)\nt\u03b1 \u2264m\u2264t\n\n\u2264\n\nX t\np2\np \u2208P\n\n(log log t)k\u22122\nm\n\nt log t(log log t)k\u22122\nb\n\nwhere m > 1 and m \u2261 1 (mod b) imply that m > b and by using (7). As for (24) we get\nX X\n\n***\n\npl \u2208Pb pl\u22121 \u2208Pl\nl>t\u03b12\n\n=\n\nX\n\n\u03c0(t; p2 , 1)\n\np2 \u2208P3\n\nX X\n\n***\n\nX X\n\n***\n\n#{(m1 , p2 ) : p2 = 1 (mod p3 ), p2 > t\u03b12 , m1 p2 + 1 \u2264 t, p2 , m1 p2 + 1 prime}\n\nX\n\n#{(m1 , m2 , p3 ) : p3 = 1 (mod p4 ), p3 > t\u03b12 , m1 (m2 p3 + 1) + 1 \u2264 t,\n\np3 \u2208P4\n\npl \u2208Pb pl\u22121 \u2208Pl\nl>t\u03b12\n\n=\n\nX\n\npl \u2208Pb pl\u22121 \u2208Pl\nl>t\u03b12\n\np4 \u2208P5\n\n{p3 , m2 p3 + 1, m1 (m2 p3 + 1) + 1} prime}\n= #{(m1 , m2 , . . . , ml\u22121 , pl ) : pl = 1 (mod b), pl > t\u03b12 , m1 (m2 . . . (ml\u22122 (ml\u22121 pl + 1) + 1) + . . .\n+ 1 \u2264 t, {pl , ml\u22121 pl + 1, ml\u22122 (ml\u22121 pl + 1) + 1, . . . , m1 (m2 . . . (ml\u22122 (ml\u22121 pl + 1) + 1)\n+ * * * + 1} prime}\nX\n\n\u2264\n\n#{pl < t/m1 . . . ml\u22121 : pl = 1 (mod b),\n\nm1 ***l\u22121 \u2264t1\u2212\u03b12\n\n{pl , ml\u22121 pl + 1, ml\u22122 (ml\u22121 pl + 1) + 1, . . . , m1 (m2 ...(ml\u22122 (ml\u22121 pl + 1) + 1) + * * * + 1} prime}.\nFrom here will need to use Brun's Sieve method (see [4, Theorem 2.4]) to get that\n\n#{pl <t/m1 . . . ml\u22121 : pl = 1 (mod b),\n{pl , ml\u22121 pl + 1, ml\u22122 (ml\u22121 pl + 1) + 1, . . . , m1 (m2 . . . (ml\u22122 (ml\u22121 pl + 1) + 1) + * * * + 1} prime}\n\u226a\n\nE l\u22121\nt/m1 . . . ml\u22121 b\nbl\u22121\nbc1 . . . cl\u22121\nl\u22121\nl\u22121\n\u03c6(E) \u03c6(b) \u03c6(bc1 . . . cl\u22121 ) (log t/m1 . . . ml\u22121 b)l\n21\n\n\fwhere the ci and E are\n\u0012Y\n\u0013\nl\u22121\ni(i+1)/2\nE=\nmi\n(1 + m1 + m1 m2 + * * * + m1 . . . ml\u22123 )(1 + m2 + m2 m3 + * * * + m2 . . . ml\u22123 )\ni=1\n\n. . . (1 + ml\u22123 )(1 + m1 + m1 m2 + * * * + m1 . . . ml\u22124 )(1 + m2 + m2 m3 + * * * + m2 . . . ml\u22124 )\n. . . (1 + ml\u22124 ) . . . (1 + m1 )\nand for 1 \u2264 i \u2264 l \u2212 1,\nci = 1 + mi + mi mi+1 + * * * + mi . . . ml\u22122 , cl\u22121 = 1.\nNow using \u03c6(mn) \u2264 \u03c6(m)\u03c6(n) and m1 . . . ml\u22121 b \u2264 t1+\u03b11 \u2212\u03b12 where 1 + \u03b11 \u2212 \u03b12 < 1 we get\n\u226a\n\nE l\u22121 bl\u22121 c1\ncl\u22121\nt\n...\n.\nl\u22121\nl\n\u03c6(E) \u03c6(b) \u03c6(c1 )\n\u03c6(cl\u22121 ) m1 . . . ml\u22121 (log t)l\n\nUsing\nm\nmL\n=\n,\nL\n\u03c6(m )\n\u03c6(m)\nwe get the sum\nX\nE l\u22121\ncl\u22121\n1\nc1\n...\n=\nl\u22121\n\u03c6(E) \u03c6(c1 )\n\u03c6(cl\u22121 ) m1 . . . ml\u22121\n1\u2212\u03b1\nm1 ...ml\u22121 \u2264t\n\n2\n\nX\n\nm1 ...ml\u22121 \u2264t1\u2212\u03b12\n\ncl\u22121\n(E \u2217 )l\u22121 c1\n1\n...\n\u2217\nl\u22121\n\u03c6(E ) \u03c6(c1 )\n\u03c6(cl\u22121 ) m1 . . . ml\u22121\n\nwhere\nE \u2217 =(1 + m1 + m1 m2 + * * * + m1 . . . ml\u22123 )(1 + m2 + m2 m3 + * * * + m2 . . . ml\u22123 )\n. . . (1 + ml\u22123 )(1 + m1 + m1 m2 + * * * + m1 . . . ml\u22124 )(1 + m2 + m2 m3 + * * * + m2 . . . ml\u22124 )\n. . . (1 + ml\u22124 ) . . . (1 + m1 ).\nWe have that every factor in E \u2217 as well as the ci are of the form 1 + Cmi for some i or of the\nform mLi . Hence using l \u2212 1 applications of Lemmas 16, 18 or 19 we can pick off the factors\nof the form (1 + Cmi ) one at a time.\nX\n\nm1 ...ml\u22121 \u2264t1\u2212\u03b12\n\ncl\u22121\n1\nc1\nE l\u22121\n...\nl\u22121\n\u03c6(E) \u03c6(c1 ) \u03c6(cl\u22121 ) m1 . . . ml\u22121\n\u226a\n\nX\n\nc\u2032l\u22121\n(E \u2032 )l\u22121 c\u20321\n1\n.\n.\n.\n(log t)\n\u2032\n\u2032\n\u03c6(E \u2032 )l\u22121 \u03c6(c1 )\n\u03c6(cl\u22121) m2 . . . ml\u22121\n\nX\n\nc\u2032\u2032l\u22121\n(E \u2032\u2032 )l\u22121 c\u2032\u20321\n1\n(log2 t)\n...\n\u2032\u2032\n\u2032\u2032\n\u2032\u2032\nl\u22121\n\u03c6(E ) \u03c6(c1 )\n\u03c6(cl\u22121 ) m3 . . . ml\u22121\n\nm2 ...ml\u22121 \u2264t1\u2212\u03b12\n\n\u226a\n\nm3 ...ml\u22121 \u2264t1\u2212\u03b12\n\n\u226a * * * \u226a (log t)l\u22121 .\n(e)\n\nwhere the E (e) , ci denote the E \u2217 and ci terms with the factors of the form 1 + Cm1 through\n1 + Cme removed. Note that the C are at most 1 + t + t2 + * * * + tk\u22123 \u2264 tk\u22122 and l \u2264 k so\n22\n\n\fthe implied constant only depends on k. Therefore\nX\nX X\ntbl\u22121\ntbl\u22121\nl\u22121\n\u03c0(t; p2 , 1) \u226a\n***\n(log\nt)\n=\n.\n\u03c6(b)l (log t)l\n\u03c6(b)l log t\np \u2208P\n\u2208P\np \u2208P p\nl\n\nb\n\nl>t\u03b12\n\nl\u22121\n\nl\n\n2\n\n3\n\nAs for part (c), first note that b/\u03c6(b) \u226a log log b, so for pl > t\u03b12 , we get that part (b) implies\nour bound. As for pl \u2264 t\u03b12 we'll split it into cases where p3 is less than or greater than t\u03b12 .\nIf p3 \u2264 t\u03b12 , then\nX\n\nX\n\n***\n\npl \u2208Pb pl\u22121 \u2208Pl\npl \u2264t\u03b12\n\nX\n\n\u03c0(t; p2 , 1) \u226a\n\nX\n\nX\n\n***\n\n\u226a\n\nX\n\nX\n\n***\n\nt\np2 log t\n\nX t(log log t)l\u22122\npl log t\np \u2208P\nl\n\n\u226a\n\nX\n\np2 \u2208P3\np2 \u2264t\u03b12\n\npl \u2208Pb pl\u22121 \u2208Pl\npl \u2264t\u03b12\n\n\u226a\n\nt\n\u03c6(p2 ) log t/p2\n\np2 \u2208P3\np2 \u2264t\u03b12\n\npl \u2208Pb pl\u22121 \u2208Pl\npl \u2264t\u03b12\n\np2 \u2208P3\np2 \u2264t\u03b12\n\nX\n\nb\n\nt(log log t)l\u22121\n\u03c6(b) log t\n\nIf p3 > t\u03b12 , then since b \u2264 t\u03b12 there is a minimum m such that pm \u2264 t\u03b12 . So using part (b)\nwith l = m we get\nX\n\nX\n\npl \u2208Pb pl\u22121 \u2208Pl\npl \u2264t\u03b12\n\n***\n\nX\n\n\u03c0(t; p2 , 1) \u226a\n\nX\n\nX\n\n***\n\nX\n\nX\n\n***\n\npm+1 \u2208Pm+2\n\npl \u2208Pb pl\u22121 \u2208Pl\npl \u2264t\u03b12\n\np2 \u2208P3\np2 >t\u03b12\n\n\u226a\n\nX\n\npl \u2208Pb pl\u22121 \u2208Pl\npl \u2264t\u03b12\n\nX\n\npm+1 \u2208Pm+2\n\n(pm\u22121 )m\u22121 t\n\u03c6(pm\u22121 )m log t\nt\npm\u22121 log t\n\nt(log log t)l\u2212m\n\u03c6(b) log t\nt(log log t)l\u22121\n\u226a\n\u03c6(b) log t\n\n\u226a\n\nsince m \u2265 2 and by using Brun-Titchmarsh (11) which finishes part (c) and the lemma. \u0003\nAs for the summations requires for the second moment, we'll note that we need twice as\nmany sums due to hk (p)2 . However the techniques required are similar.\nLemma 21. Let t > ee and 0 < 2\u03b11 < \u03b12 < 1/2. Then\n(a) If b1 > t\u03b11 or b2 > t\u03b11 then\nX\nt log2 t\n.\n\u03c0(t; p2 r2 , 1) \u226a\n(26)\nb\n1 b2\np \u2208P\n2\n\nb1\n\nr2 \u2208Pb2\n\n23\n\n\f(b) If neither b1 nor b2 exceeds t\u03b11 , then\nX\nX\nt(log log t)k\u22121 b2k\u22121 t(log log t)k\u22121 b1k\u22121\n\u03c0(t; p2 r2 , 1) \u226a\n...\n(27)\n+\n.\n\u03c6(b1 )\u03c6(b2 )k log t\n\u03c6(b2 )\u03c6(b1 )k log t\np \u2208P\np \u2208P\nk\n\nb1\n\n2\n\np3\n\nr2 \u2208Pr3\n\nrk \u2208Pb2\npk rk >t\u03b12\n\n(c) If neither b1 nor b2 exceeds t\u03b11 , then\nX\nX\nt(log log t)2k\u22122\n.\n...\n\u03c0(t; p2 r2 , 1) \u226a\n(28)\n\u03c6(b\n1 )\u03c6(b2 ) log t\np \u2208P\np \u2208P\nk\n\nb1\n\n2\n\np3\n\nr2 \u2208Pr3\n\nrk \u2208Pb2\n\n(d) If neither b1 nor b2 exceeds t\u03b11 , then\nX\nX\nX\nt(log log t)2k\u22122\n\u03c0(t; s, 1) \u226a\n...\n(29)\n.\n\u03c6(b1 )\u03c6(b2 ) log t\np \u2208P s\u2208P \u2229P\np \u2208P\nk\n\nb1\n\nrk \u2208Pb2\n\n3\n\np4\n\nr3 \u2208Pr4\n\np3\n\nr3\n\nAgain the implicit constants depend on our choice of the \u03b1.\nProof. (a) is similar to part (a) of Lemma 20. For part (b) we first assume that pk \u2264 rk ,\nthen\nX\nX\n...\n\u03c0(t; p2 r2 , 1)\npk \u2208Pb1\nrk \u2208Pb2\npk \u2264rk\npk rk >t\u03b12\n\np2 \u2208Pp3\nr2 \u2208Pr3\n\n=\n\nX\n\n***\n\nX\n\n#{(m1 , p2 , r2 ) : p2 = 1 (mod p3 ), r2 = 1 (mod r3 ), r2 p2 > t\u03b12 ,\n\np3 \u2208Pp4\nr3 \u2208Pr4\n\npk \u2208Pb1\nrk \u2208Pb2\npk rk >t\u03b12\n\nm1 r2 p2 + 1 \u2264 t, p2 , m1 r2 p2 + 1 prime}\nX\nX\nX X\nX X\n#{(m1 , m2 , r3 ) : r3 = 1 (mod r4 ),\n***\n***\n=\nr4 \u2208Pr5\np2 \u2208P3 rk \u2208Pb2 rk\u22121 \u2208Prk\npk \u2208Pb1 pk\u22121 \u2208Pk\npk \u2264rk\npk rk >t\u03b12\nr3 p2 > t\u03b12 , m1 p2 (m2 r3 + 1) + 1 \u2264 t, {r3 , m2 r3\n\n=\n\nX\n\nX\n\npk \u2208Pb1 pk\u22121 \u2208Pk\npk \u2264rk\n\n***\n\nX\n\n+ 1, m1 p2 (m2 r3 + 1) + 1} prime}\n\n#{(m1 , m2 , . . . , ml\u22121 , rl ) : rl = 1 (mod b2 ), p2 rk > t\u03b12 ,\n\np2 \u2208P3\n\nm1 p2 (m2 . . . (mk\u22122 (mk\u22121 rk + 1) + 1) + * * * + 1 \u2264 t, {rk , mk\u22121 rk + 1,\nmk\u22122 (mk\u22121 rk + 1) + 1, . . . ,\n\u2264\n\nX\n\nm1 p2 (m2 . . . (mk\u22122 (mk\u22121 rk + 1) + 1) + * * * + 1} prime}\nX\nX X\n#{rk < t/p2 m1 ...mk\u22121 : rk = 1 (mod b2 ),\n***\n\nm1 ...ml\u22121 \u2264t1\u2212\u03b12 pk \u2208Pb1 pk\u22121 \u2208Pk\npk \u2264rk\n\np2 \u2208P3\n\n{rk , mk\u22121 rk + 1, mk\u22122(mk\u22121 rk + 1) + 1, . . . ,\np2 m1 (m2 . . . (mk\u22122 (mk\u22121 rk + 1) + 1) + * * * + 1} prime}\n24\n\n\fJust like in Lemma 20 we use Brun's Sieve. However, notice that we have almost the same\nset, except with m1 replaced with m1 p2 . Hence we have\n\n#{rk < t/p2 m1 * * *k\u22121 : rk = 1 (mod b1 ), {rk , mk\u22121 rk + 1, mk\u22122 (mk\u22121 rk + 1) + 1,\n. . . , p2 m1 (m2 . . . (mk\u22122 (mk\u22121 rk + 1) + 1) + * * * + 1} prime}\nE k\u22121\nt/p2 m1 . . . mk\u22121 b2\nb2k\u22121\nb2 c1 . . . ck\u22121\n\u226a\n\u03c6(E)k\u22121 \u03c6(b2 )k\u22121 \u03c6(b2 c1 . . . ck\u22121 ) (log t/p2 m1 . . . mk\u22121 b2 )k\nwhere the ci and E are\n\nE =p2\n\n\u0012Y\nl\u22121\n\ni(i+1)/2\nmi\n\ni=1\n\n\u0013\n(1 + p2 m1 + p2 m1 m2 + ... + p2 m1 . . . mk\u22123 )(1 + m2 + m2 m3 + . . .\n\n+ m2 . . . mk\u22123 ) . . . (1 + mk\u22123 )(1 + p2 m1 + p2 m1 m2 + * * * + p2 m1 . . . mk\u22124 )\n(1 + m2 + m2 m3 + * * * + m2 . . . mk\u22124 ) . . . (1 + mk\u22124 ) . . . (1 + p2 m1 )\nand for 2 \u2264 i \u2264 k \u2212 1,\nc1 = 1 + p2 m1 + p2 m1 m2 + * * * + p2 m1 . . . mk\u22122 ,\nci = 1 + mi + mi mi+1 + * * * + mi . . . mk\u22122 , ck\u22121 = 1.\nBy the same methods as Lemma 20 and using that p2 /\u03c6(p2) is bounded and noting that\nt\nrk\n>\n> t\u03b12 /2\u2212\u03b11 = t\u01eb\np2 m1 ...mk\u22121 b2\nb1\nfor some \u01eb > 0 since \u03b12 > 2\u03b11 , we get that\n\nX\n\npk \u2208Pb1\nrk \u2208Pb2\npk rk >t\u03b12\n\n***\n\nX\n\np2 \u2208Pp3\nr2 \u2208Pr3\n\nX\ntb2k\u22121\n\u03c0(t; p2 r2 , 1) \u226a\n\u03c6(b2 )k log t p \u2208P\nk\n\n\u226a\n\npk\u22121 \u2208Pk\n\n***\n\nX 1\np2\np \u2208P\n2\n\nX (log log t)k\u22122\ntb2k\u22121\n\u03c6(b2 )k log t p \u2208P\npk\nk\n\n\u226a\n\nb1\n\nX\n\nb1\n\nt(log log t)k\u22121 b2k\u22121\n.\n\u03c6(b1 )\u03c6(b2 )k log t\n25\n\n3\n\n\fThe case for rk \u2264 pk is similar. As for part (c), first note that bi /\u03c6(bi ) \u226a log log bi for\ni \u2208 {1, 2}. taking care of the case where pk rk > t\u03b12 . As for pk rk \u2264 t\u03b12 we get\nX\n\n***\n\npk \u2208Pb1\nrk \u2208Pb2\npk rk \u2264t\u03b12\n\nX\n\n\u03c0(t; p2 r2 , 1) \u226a\n\n\u226a\n\nt\np2 r2 log t\n\n***\n\nX\n\nt(log log t)2k\u22124\npk rk log t\n\npk \u2208Pb1\nrk \u2208Pb2\npk rk \u2264t\u03b12\n\n\u226a\n\nX\n\nX\n\npk \u2208Pb1\nrk \u2208Pb2\npk rk \u2264t\u03b12\n\n\u226a\n\nt\n\u03c6(p2 r2 ) log t/p2 r2\n\n***\n\np2 \u2208Pp3\nr2 \u2208Pr3\n\npk \u2208Pb1\nrk \u2208Pb2\npk rk \u2264t\u03b12\n\np2 \u2208Pp3\nr2 \u2208Pr3\n\nX\n\nX\n\np2 \u2208Pp3\nr2 \u2208Pr3\n\nt(log log t)2k\u22122\n\u03c6(b1 )\u03c6(b2 ) log t\n\nusing Brun-Titchmarsh, (11) finishing part (c). As for part (d) we note that\nX\n\nX\n\n\u03c0(t; s, 1)\n\np3 \u2208Pp4 s\u2208Pp3 \u2229Pr3\nr3 \u2208Pr4\n\n=\n\nX\n\n#{(m1 , s) : s = 1 (mod p3 r3 ), m1 s + 1 \u2264 t, s, m1 s + 1 prime}\n\nX\n\n#{(m1 , m2 , r3 ) : r3 = 1 (mod r4 ), m1 (m2 p3 r3 + 1) + 1 \u2264 t,\n\np3 \u2208Pp4\nr3 \u2208Pr4\n\n=\n\np3 \u2208Pp4\n\n{m2 p3 r3 + 1, m1 (m2 p3 r3 + 1) + 1 prime}\n\nand so on, yielding a similar sieve as part (b).\n\n11. Reduction of\n\nP\n\n\u0003\n\nhk (p) to small values of pk\nP\nWe will be using Euler Summation on the sum p\u2264t hk (p) in our efforts to find our estimate\nfor M1 (x). It will turn out that the large primes do not contribute much to the some. The\nsum will involve estimating \u03c0(t; p, 1) by li(t)/p \u2212 1. The following lemma will deal with those\nerrors and will involve the Bombieri\u2013Vinogradov Theorem.\n26\n\n\fe\n\nLemma 22. For all 2 \u2264 l \u2264 k, x > ee and v > ee ,\nX\nX\nX\nX X\n***\nlog q\na\u2208N\n\nq\u2264y k\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\n\npk\n\nl\u22121\n\u2264v1/3\n\npk\u22121\n\nProof. Let E(t; r, 1) = \u03c0(t; r, 1) \u2212\nlog q\n\nX\n\nl\u22121\n\n=\n\nlog q\n\nThen we have\n***\n\nX\n\nli(v)\n\u03c0(v, pk\u2212l+2, 1) \u2212\npk\u2212l+2 \u2212 1\n\npk\u22121 \u2208Ppk\n\n\u0013\n\nX\n\nl\u22121\n\nE(v; pk\u2212l+2, 1)\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\npk \u2208Pqa\npk \u2264v1/3\n\nX\n\n***\n\npk\u2212l+2 \u2264v1/3\n\npk\u22121 \u2264v1/3\n\nX\n\na\u2208N\n\nq\u2264y k\n\nX\n\npk \u2208Pqa\n\nX\n\n\u0012\n\npk\u2212l+2 \u2264v1/3\n\nX\n\nl\u22121\n\nlog q\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\npk \u2264v1/3\n\nX\n\nX\n\npk\u22121 \u2264v1/3\n\na\u2208N\n\nq\u2264y k\n\n\u226a\n\n\u0013\n\npk\u2212l+2 \u2264v1/3\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\npk \u2264v1/3\n\nX\n\nli(t)\n.\nr\u22121\n\nX\n\nX\n\na\u2208N\n\nq\u2264y k\n\nli(v)\n\u03c0(v, pk\u2212l+2, 1) \u2212\npk\u2212l+2\n\nv log y\n+ li(v)(log log v)l\u22122 .\nlog v\n\n\u226a\n\nX\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\u2264v1/3\n\n\u0012\n\nX\n\n***\n\npk\u22121 \u2208Ppk\n\n|E(v; pk\u2212l+2, 1)|.\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\npk\u2212l+2 \u2264v1/3\n\npk\u22121 \u2264v1/3\n\nLet \u03a9(m) denote the number of divisors of m which are primes or prime powers. We use the\nestimate \u03a9(m) \u226a log m to get\nX\n\nq\u2264y k\n\nlog q\n\nX\n\nX\n\nX\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\n\na\u2208N\n\nl\u22121\n\npk \u2264v1/3\n\nl\u22122\n\npk\u22121 \u2264v1/3\n\nX\n\n\u2264 log(y k )\n\nX\n\n***\n\npk\u2212l+2 \u2208Ppk\u2212l+3\npk\u2212l+2 \u2264v1/3\n\n|E(v; pk\u2212l+2, 1)|\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nX\n\n|E(v; pk\u2212l+2, 1)|\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nX\n\nX\n\nX\n\n***\n\nX\n\npk\u2212l+3|pk\u2212l+2 \u22121 pk\u2212l+4 |pk\u2212l+3 \u22121\np3 \u2264v1/9\npk\u2212l+4 \u2264v1/27\n\npk\u2212l+2 \u2264v1/3\n\nContinuing in this manner we obtain\nX\nX\nX X\nlog q\na\u2208N\n\n***\n\nX\n\n|E(v; pk\u2212l+2, 1)|\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nq\u2264y k\n\nX\n\npk \u2208Pqa\n\nl\u22121\n\npk \u2264v1/3\n\npk\u22121 \u2208Ppk\n\nX\n\npk\u2212l+2 \u2208Ppk\u2212l+3\npk\u2212l+2 \u2264v1/3\n\n27\n\n\u03a9(pk \u2212 1)\n\nk\u22121\n\u2264v1/3\n\npk\npk |pk\u22121 \u22121\n\n***\n\nX\n\nk\u22121\n\u2264v1/3\n\npk\npk |pk\u22121 \u22121\n\n|E(v; pk\u2212l+2, 1)|\n\npk\u2212l+2 \u2264v1/3\n\nX\n\n1\n\na\u2208N\nq a |pk \u22121\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\npk\u22121 \u2264v1/3\n\n\u226a log y(log v)l\u22121\n\nX\n\n***\n\nX X\n\nq\u2264y k\n\npk\u2212l+3|pk\u2212l+2 \u22121 pk\u2212l+4 |pk\u2212l+3 \u22121\np3 \u2264v1/9\npk\u2212l+4 \u2264v1/27\n\npk\u2212l+2 \u2264v1/3\n\n\u226a log y\n\nX\n\npk\u2212l+3|pk\u2212l+2 \u22121 pk\u2212l+4 |pk\u2212l+3 \u22121\np3 \u2264v1/9\npk\u2212l+4 \u2264v1/27\n\npk\u2212l+2 \u2264v1/3\n\n\u2264 log(y k )\n\n|E(v; pk\u2212l+2, 1)|\n\n|E(v; pk\u2212l+2, 1)| \u226a\n\nv log y\nlog t\n\nlog t.\n\n\fusing Bombieri\u2013Vinogradov. As for the difference between\nX\n\nlog q\n\nX\n\nl\u22121\n\npk \u2264v1/3\n\nX\n\n***\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\n\na\u2208N\n\nq\u2264y k\n\nX\n\nX\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\nli(v)\npk\u2212l+2 \u2212 1\n\npk\u2212l+2 \u2264v1/3\n\npk\u22121 \u2264v1/3\n\nand\nX\n\n(30)\n\nlog q\n\nX\n\npk\n\nl\u22121\n\u2264v1/3\n\npk\u22121\n\nX\n\n***\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\n\na\u2208N\n\nq\u2264y k\n\nX\n\nX\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\u2264v1/3\n\nli(v)\npk\u2212l+2\n\npk\u2212l+2 \u2264v1/3\n\nwe get that it is\nX\n\nq\u2264y k\n\nlog q\n\nX\na\u2208N\n\nl\u22121\n\u2264v1/3\n\nX\n\nlog q\n\npk\u22121\n\nX\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\u2264v1/3\n\nX\n\npk \u2208Pqa\nl\u22121\n\npk \u2264v1/3\n\n\u226a\n\nX\n\nlog q\n\nX\na\u2208N\n\nq\u2264y k\n\n\u226a\n\nX\n\nlog q\n\nX\na\u2208N\n\nq\u2264y k\n\n\u226a\n\nX\n\nlog q\n\n\u226a\n\ni=1\n\npk\u22121\n\nli(v)\np2k\u2212l+3\n\npk\u2212l+3 \u2264v1/9\n\nX\n\n***\n\npk\u22121 \u2208Ppk\npk\u22121\n\nX\n\npk\u2212l+3 \u2208Ppk\u2212l+4\n\nl\u22122\n\u2264v1/3\n\nX\n\npk \u2208Pqa\n\nli(v)\n(ipk\u2212l+3 + 1)(ipk\u2212l+3 )\n\n***\n\npk\u22121 \u2208Ppk\n\nX\n\nl\u22121\n\u2264v1/3\n\n\u221e\nX\n\nl\u22122\n\u2264v1/3\n\nX\n\nl\u22121\n\u2264v1/3\n\nl\u22122\n\u2264v1/3\n\npk\u2212l+3 \u2208Ppk\u2212l+4\n\nli(v)\npk\u2212l+3q a\n\npk\u2212l+3 \u2264v1/9\n\nX li(v)(log log v)l\u22122\nq 2a\n\na\u2208N\n\nq\u2264y k\n\npk\u22121\n\npk \u2208Pqa\n\npk\n\n***\n\npk\u22121 \u2208Ppk\n\nX\n\npk\n\nli(v)\npk\u2212l+2(pk\u2212l+2 \u2212 1)\n\npk\u2212l+2 \u2264v1/3\n\nX\n\na\u2208N\n\nq\u2264y k\n\nX\n\n***\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\npk\n\n\u2264\n\nX\n\nX\n\nX li(v)(log log v)l\u22122 log q\nq2\nk\n\nq\u2264y\n\n\u226a li(v)(log log v)l\u22122\nusing the Brun\u2013Titchmarsh inequality (11), the inequality pk\u2212l+3 \u2265 q a and noting that the\nsum over q converges.\n\u0003\ne\n\nLemma 23. For all x > ee and t > ee ,\nX\nX\nX X\nhk (p) =\nlog q\np\u2264t\n\nq\u2264y k\n\na\u2208N\n\npk \u2208Pqa\n\nk\u22121\n\npk \u2264t1/3\n\nX\n\n***\n\npk\u22121 \u2208Ppk\n\nk\u22122\n\npk\u22121 \u2264t1/3\n\nX\n\n\u03c0(t; p2 , 1)\n\np2 \u2208Pp3\np2 \u2264t1/3\n\n\u0012\n\u0013\nt(log log t)k\u22122 log y\n1\u22121/3k\nk\u22122 k\n+O t\nlog t(log log t) y +\n.\nlog t\n28\n\n\fProof. For a prime p,\nhk (p) =\n\nX X\nX\n\nX\n\n***\n\nX\n\n\u03bdq (pk \u2212 1) log q\n\npk |pk\u22121 \u22121 q\u2264y k\n\np1 |p p2 |p1 \u22121\n\n=\n\nX\n\n***\n\nX\n\n\u03bdq (pk \u2212 1) log q\n\npk |pk\u22121 \u22121 q\u2264y k\n\np2 |p\u22121\n\nsince the only prime which can divide p is p itself. Hence\nX\n\nhk (p) =\n\np\u2264t\n\nX X\n\np\u2264t p2 |p\u22121\n\n=\n\nX X\n\npk |pk\u22121 \u22121\n\nX\n\nlog q\n\nX\n\nlog q\n\n\u03bdq (pk \u2212 1) log q\n\nq\u2264y k\n\nlog q\n\nX X\n\nX\n\n***\n\nX X\n\nX X\n\nX\n\n***\n\npk |pk\u22121 \u22121\n\nq\u2264y k\n\npk \u2208Pqa\na\u2208N\n\np2 \u2208Pp3\n\na\u2208N pk \u2208Pqa pk\u22121 \u2208Ppk\n\nq\u2264y k\n\n=\n\nX\n\nX\n\nX X\n\n***\n\np\u2264t p2 |p1 \u22121\n\n=\n\nX\n\n***\n\na\u2208N pk \u2208Pqa pk\u22121 \u2208Ppk\n\nq\u2264y k\n\nX\n\n1\n\np\u2264t\np\u2208Pp2\n\n\u03c0(t; p2 , 1).\n\np2 \u2208Pp3\n\nWe wish to approximate \u03c0(t; p2 , 1) by pli(t)\nand use the Bombieri-Vinogradov Theorem to\n2 \u22121\ndeal with the error. However this approximation only allows primes up to say t1/3 . So we use\nthe estimations in Lemma 20 to bound these errors. We will see that the main contribution\ni\u22121\nk\ncomes from pi \u2264 t1/3 and q a \u2264 t1/3 .\nUsing Lemma 20, we get for large q a\nX\n\nq\u2264y k\n\nlog q\n\nX\n\nX\n\nX\n\n***\n\nX\n\n\u03c0(t; p2 , 1) \u226a\n\np3 \u2208Pp2\n\na\u2208N pk \u2208Pqa pk\u22121 \u2208Ppk\nk\nq a >t1/3\n\nX t log t(log log t)k\u22122\nlog q\n.\nqa\nk\na\u2208N\n\nX\n\nq\u2264y\n\nk\n\nq a >t1/3\nk\n\nBy geometric estimates, if a\u2217 is the smallest a where q a > t1/3 , then we get that the above\nis\nX log q\nq a\u2217\nq\u2264y k\nX\nk\n\u2264 t1\u22121/3 log t(log log t)k\u22122\nlog q\n\u226a t log t(log log t)k\u22122\n\nq\u2264y k\n\n1\u22121/3k\n\n\u226at\n\nlog t(log log t)k\u22122 y k .\n\nk\n\ni\u22121\n\nNow suppose q a \u2264 t1/3 . Let l be the last index (supposing one exists) where pi > t1/3\nusing (24) where l ranges from 2 to k, we can bound the large values of the pi .\n29\n\nBy\n\n\fX\n\nq\u2264y k\n\nX\n\nX\n\nlog q\n\nX\n\n\u226a\n\nX\n\nX\n\nX\n\npl+2 \u2208Ppl+3 pl+1 \u2208Ppl+2\nl+1\n\npl+1 >t1/3\n\nX\n\n***\n\n(pl )l\u22121 t\n\u03c6(pl )l log t\n\nl\n\npl+2 \u2264t1/3\n\nX\n\npl+2 \u2208Ppl+3 pl+1 \u2208Ppl+2\n\npk \u2208Pqa\na\u2208N\nk\nq a \u2264t1/3 pk \u2264t1/3k\u22121\n\nq\u2264y k\n\nX\n\n***\n\nX\n\nX\n\nlog q\n\n\u03c0(t; p2 , 1)\n\np2 \u2208Pp3\n\nl\u22121\n\nl\n\npk \u2208Pqa\na\u2208N\nk\nq a \u2264t1/3 pk \u2264t1/3k\u22121\n\nq\u2264y k\n\nX\n\npl+1 \u2264t1/3 pl >t1/3\n\nX\n\nlog q\n\n***\n\npl+1 \u2208Ppl+2 pl \u2208Ppl+1 pl\u22121 \u2208Ppl\n\npk \u2208Pqa\na\u2208N\nk\nq a \u2264t1/3 pk \u2264t1/3k\u22121\n\n\u226a\n\nX\n\nX\n\nX\n\n***\n\nl+1\n\nt\npl+1 log t\n\nl\n\npl+2 \u2264t1/3\n\npl+1 >t1/3\n\nsince pl is prime and l \u2264 k. By Brun-Titchmarsh (11) we get\n\u226a\n\nX\n\nX t(log log t)k\u2212l\nq a log t\na\u2208N\n\nlog q\n\nq\u2264y k\n\nk\n\nq a \u2264t1/3\n\nX t(log log t)k\u2212l log q\n\u226a\nq log t\nk\nq\u2264y\n\n\u226a\n\nt(log log t)k\u22122 log y\nlog t\n\nby (3) and since l \u2265 2. Hence we get\nX\nX\nX\nX\nhk (p) =\nlog q\np\u2264t\n\nq\u2264y k\n\nX\n\n***\n\npk\u22121 \u2208Ppk\npk \u2208Pqa\na\u2208N\nk\nq a \u2264t1/3 pk \u2264t1/3k\u22121 pk\u22121 \u2264t1/3k\u22122\n\nX\n\n\u03c0(t, p2 , 1)\n\np2 \u2208Pp3\np2 \u2264t1/3\n\n\u0012\n\u0013\nt(log log t)k\u22122 log y\n1\u22121/3k\nk\u22122 k\nlog t(log log t) y +\n+O t\nlog t\nfinishing the lemma.\n\n\u0003\n12. Evaluation of the Main Term\n\nNow we'll deal with the main term from Lemma 23. We will deal with estimating the\nindividual sums recursively. Hence we wish to make the following definition.\nDefinition 24. Let 2 \u2264 l \u2264 k and 2 \u2264 u \u2264 t. Then define\nX\nX\nX X\nX\ngk,l (u) =\nlog q\n***\nq\u2264y k\n\na\u2208N\n\npk \u2208Pqa\n\nl\u22121\n\npk \u2264u1/3\n\npk\u22121 \u2208Ppk\n\nl\u22122\n\npk\u22121 \u2264u1/3\n\n\u03c0(u; pk\u2212l+2, 1).\n\npk\u2212l+2 \u2208Ppk\u2212l+3\npk\u2212l+2 \u2264u1/3\n\nNote that gk,k (t) is the summation in Lemma 23. Next we'll exhibit the recursive formula\nsatisfied by the gk,l.\n30\n\n\fLemma 25. Let 3 \u2264 l \u2264 k, then\n\u0013\n\u0012\nZ v1/3\n1\nv(log log v)l\u22122 log y\n(31)\ngk,l (v) = li(v)\n.\ngk,l\u22121(u)du + O\nu2\nlog v\n2\nProof. We'll proceed by approximating \u03c0 by li and then use partial summation to recover \u03c0.\nUsing Lemma 22 we get\nX\nX\nX X\nX\ngk,l (v) =\n\u03c0(v; pk\u2212l+2, 1)\nlog q\n***\na\u2208N\n\nq\u2264y k\n\npk\n\n\u226a\n\nX\n\nX\n\nlog q\n\na\u2208N\n\nq\u2264y k\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\n\nl\u22121\n\u2264v1/3\n\npk\u22121\n\nX\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\u2264v1/3\n\npk\u2212l+2 \u2264v1/3\n\nX\n\npk \u2208Pqa\nl\u22121\n\npk \u2264v1/3\n\nX\n\n***\n\npk\u22121 \u2208Ppk\n\npk\u2212l+2 \u2208Ppk\u2212l+3\n\nl\u22122\n\n\u0012\n\u0013\nv log y\nli(v)\nl\u22122\n+O\n.\n+ li(v)(log log v)\npk\u2212l+2\nlog v\n\npk\u2212l+2 \u2264v1/3\n\npk\u22121 \u2264v1/3\n\nWe use Euler summation on the inner sum to get\n\npk\u2212l+2 \u2208Ppk\u2212l+3\npk\u2212l+2\n\n\u03c0(v 1/3 ; pk\u2212l+3, 1)\n=\n+\nv 1/3\n\n1\n\nX\n\npk\u2212l+2\n\nZ\n\nv1/3\n\n\u03c0(u; pk\u2212l+3, 1)\ndu\nu2\n\n2\n\n\u2264v1/3\n\nand so we get that\ngk,l (v) = li(v)\n\nX\n\nX\n\nlog q\n\na\u2208N\n\nq\u2264y k\n\n+\n\nv1/3\n2\n\nl\u22121\n\u2264v1/3\n\npk\u22121\n\nX\n\n***\n\npk\u22121 \u2208Ppk\n\npk \u2208Pqa\npk\n\nZ\n\nX\n\nX\n\npk\u2212l+3 \u2208Ppk\u2212l+4\n\nl\u22122\n\u2264v1/3\n\n\u0012\n\n\u03c0(v 1/3 ; pk\u2212l+3, 1)\nv 1/3\n\npk\u2212l+3 \u2264v1/3\n\n\u0013\n\u0013\n\u0012\nv log y\n\u03c0(u; pk\u2212l+3, 1)\nl\u22122\n.\ndu + O\n+ li(v)(log log v)\nu2\nlog v\n\nInside the sum by trivially estimating \u03c0(x; q, 1) by x/q inside the sum and using Brun\u2013\nTitchmarsh (11) we get\nX\nX\nX X\nX\n\u03c0(v 1/3 ; pk\u2212l+3 , 1)\nlog q\n***\nv 1/3\nk\np\n\u2208P\np\n\u2208P\na\u2208N p \u2208P a\nq\u2264y\n\npk\n\n\u226a\n\nX\n\nq\nl\u22121\n\u2264v1/3\n\nlog q\n\nX\na\u2208N\n\nq\u2264y k\n\npk\u22121\n\nX\n\npk \u2208Pqa\npk\n\n\u226a\n\nX\n\nlog q\n\nX\n\nlog q\n\nq\u2264y k\n\nl\u22121\n\u2264v1/3\n\nk\u2212l+3\n\nX\n\npk\u22121 \u2208Ppk\npk\u22121\n\npk\u2212l+4\n\npk\u2212l+3 \u2264v1/3\n\nl\u22122\n\u2264v1/3\n\n***\n\nX\n\npk\u2212l+3 \u2208Ppk\u2212l+4\npk\u2212l+3\n\n1\npk\u2212l+3\n\n\u2264v1/3\n\nX (log log v)l\u22122\na\u2208N\n\nq\u2264y k\n\n\u226a\n\npk\nl\u22122\n1/3\n\u2264v\n\nk\u22121\n\nk\n\nqa\n\n(log log v)l\u22122\nq\n\n\u226a (log log v)l\u22122 log y.\nMultiplying through by li(v) finishes the lemma.\n31\n\n\u0003\n\n\fWe now require a lemma to find the asymptotic formula for hk using the previous recurrence relation\nLemma 26. Let 2 \u2264 l \u2264 k.\n\u0013\n\u0012\nku(log log u)l\u22121 log y\nu(log log u)l\u22121 u(log log u)l\u22122 log2 y\ngk,l (u) =\n+O\n+\n(l \u2212 1)! log u\nlog u\nlog u\nwhich implies\n\u0012\nkt(log log t)k\u22121 log y\nt(log log t)k\u22121\nhk (p) =\n+O\n(k \u2212 1)! log t\nlog t\np\u2264t\n\nX\n\n\u0013\nt(log log t)k\u22122 log2 y\n1\u22121/3k\nk\u22122 k\n+\n+t\nlog t(log log t) y .\nlog t\nProof. The second formula is derived from the first by setting l = k, u = t and using Lemma\n23. We'll proceed with the first formula by induction on l. Using the estimates we obtained\nvia Bombieri\u2013Vinogradov in Lemma 22, we have for l = 2\ngk,2(u) =\n\nX\n\nlog q\n\n\u03c0(u; pk , 1)\n\na\u2208N pk \u2208Pqa\npk \u2264u1/3\n\nq\u2264y k\n\n= li(u)\n\nX X\n\nX\n\nq\u2264y k\n\nlog q\n\nX X\n\na\u2208N pk \u2208Pqa\npk \u2264u1/3\n\n\u0013\n\u0012\nu log y\n1\n.\n+ O li(u) +\npk\nlog u\n\nWe then use (13) and\nlog log(u1/3 ) = log log u + O(1)\nto get\nX \u0012 log log u1/3\n\n\u0013\u0013\n\u0012\n\u0013\nu log y\nlog(q a )\ngk,2(u) = li(u)\nlog q\n+O\n+O\n\u03c6(q a )\n\u03c6(q a )\nlog u\nk\na\u2208N\nq\u2264y\n\u0013\u0013\n\u0012\n\u0012\nX\nX\nX\u0012 1\nX a\u0013\n1\n2\n= li(u)(log log u + O(1))\n+ O li(u)\n+ O a+1\nlog q\nlog q\nqa\nq\nqa\nk\nk\na\u2208N\na\u2208N\nq\u2264y\nq\u2264y\n\u0013\n\u0012\nu log y\n+O\nlog u\n\u0012\n\u0013\u0013\n\u0012\nX \u0012 log q\nX log2 q u log y \u0013\nlog q\n= li(u)(log log u + O(1))\n+O\n+ O li(u)\n+\nq\nq2\nq\nlog u\nk\nk\nq\u2264y\nq\u2264y\n\u0013\n\u0012\nu log y\n2\nk\n= li(u) log log u log(y ) + O li(u)(log y + log log u + log y) +\nlog u\n\u0012\n2 \u0013\nu log log u u log y\nku log log u log y\n,\n+O\n+\n=\nlog u\nlog u\nlog u\nX\n\n\u0012\n\n32\n\n\fcompleting the base case. Now using Lemma 25 we get\n\u0013\n\u0012\nZ v1/3\n1\nv(log log v)l\u22122 log y\ngk,l (v) = li(v)\ngk,l\u22121(u)du + O\nu2\nlog v\n2\n\u0012\nZ v1/3 \u0012\n1 ku(log log u)l\u22122 log y\nu(log log u)l\u22122\n= li(v)\n+\nO\n+\nu2\n(l \u2212 2)! log u\nlog u\n2\n\u0013\u0013\n\u0012\n\u0013\nv(log log v)l\u22122 log y\nu(log log u)l\u22123 log2 y\ndu + O\nlog u\nlog v\n\u0013\u0013\n\u0012\nZ v1/3 \u0012\nk(log log u)l\u22122 log y\n(log log u)l\u22122 (log log u)l\u22123 log2 y\n= li(v)\ndu\n+O\n+\n(l \u2212 2)!u log u\nu log u\nu log u\n2\n\u0013\n\u0012\nv(log log v)l\u22122 log y\n+O\nlog v\n\u0012\n1/3 l\u22121\nk li(v)(log log v ) log y\n=\n+ O li(v)(log log v 1/3 )l\u22121 + li(v)(log log v 1/3 )l\u22122 log2 y\n(l \u2212 1)!\n\u0013\nv(log log v)l\u22122 log y\n+\n.\nlog v\nOnce again by using\nlog log v 1/3 = log log v + O(1)\nwe get\n\u0013\n\u0012\nv(log log v)l\u22121 v(log log v)l\u22122 log2 y v(log log v)l\u22122 log y\nkv(log log v)l\u22121 log y\n+O\n+\n+\n(l \u2212 1)! log v\nlog v\nlog v\nlog v\n\u0012\n2 \u0013\nl\u22121\nl\u22122\nl\u22121\nkv(log log v) log y\nv(log log v) log y\nv(log log v)\n=\n,\n+O\n+\n(l \u2212 1)! log v\nlog v\nlog v\ncompleting the induction.\n\n\u0003\n\n13. The Proof of the First Moment\nWe now are in a position to prove the propostion for the first moment.\nProof of Proposition 14.\nM1 (x) =\n\nX hk (p)\np\u2264x\n\np\n\nX hk (p)\nX hk (p)\n+\np\np\nee <p\u2264x\np\u2264ee\n\u0012\nZ x \u0013\nX\n1\ndt\n= O(1) +\nhk (p)\n+\n2\nx\np t\nee <p\u2264x\nZ x\ndt X\n1 X\nhk (p) +\nhk (p).\n= O(1) +\n2\nx ee <p\u2264x\nee t ee <p\u2264t\n=\n\n33\n\n\fUsing t = x in Lemma 26 we get that\nX\n\nhk (p) \u226a\n\nee <p\u2264x\n\nxy k\u22121 log y\nlog x\n\nand since\nX\n\nhk (p)\n\nee <p\u2264t\n\ndiffers from\nX\n\nhk (p)\n\np\u2264t\n\nby a constant, we get that\n\u0013 Z x \u0012\n\u0012 k\u22121\n\u0012\n1\ndt kt(log log t)k\u22121 log y\nxy\nlog y\nt(log log t)k\u22121\nM1 (x) = O(1) + O\n+\n+\nO\n2\nx\nlog x\n(k \u2212 1)! log t\nlog t\nee t\n\u0013\u0013\nt(log log t)k\u22122 log2 y\nk\n+\n+ t1\u22121/3 log t(log log t)k\u22122 y k\nlog t\nusing Lemma 26. Noting that\nZ\n\nx\n\nee\n\ndt 1\u22121/3k\nt\nlog t(log log t)k\u22122 y k\nt2\nZ x k\ny dt\n=\n1+\u01eb\nee t\n\u226a yk\n\nyields\n\u0013 Z x \u0012\n\u0012\ndt kt(log log t)k\u22121 log y\ny k\u22121 log y\nt(log log t)k\u22121\nO(y ) + O\n+\n+\nO\n2\nlog x\n(k \u2212 1)! log t\nlog t\nee t\n\u0013\u0013\nt(log log t)k\u22122 log2 y\n+\nlog t\n\u0012\n\u0013\nk(log log x)k log y\n2\nk\nk\nk\u22121\n= O(y ) +\n+ O (log log x) + (log log x)\nlog y\nk(k \u2212 1)!\ny k log y\n=\n+ O(y k )\n(k \u2212 1)!\nk\n\n\u0012\n\nas needed.\n\n\u0003\n14. The Proof of the Second Moment\n\nWe now turn our attention to the second moment. Our first lemma will bound the case\nwhere p3 = r3 and then we'll use the summations from Lemma 21 to take care of the rest.\n34\n\n\fLemma 27.\nX\n\nq1 ,q2\n\nlog q1 log q2\n\nX\n\nX\n\nX\n\n***\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n1\nr \u2208P a rk\u22121 \u2208Prk\n\n\u2264y k\n\nk\n\nq 2\n2\n\n\u226a t1\u2212\u01eb y k log y +\n\nX\n\nX\n\nX\n\n1\n\np3 \u2208Pp4 s\u2208Pp3 \u2229Pr3 p\u2264t\np\u2208Ps\nr3 \u2208Pr4\n\nt(log log t)2k\u22122\nlog2 y\nlog t\n\nfor some \u01eb > 0.\nProof. Our sum is\nX\nX\nlog q1 log q2\n\nX\n\nX\n\nk\n\n=\n\nX\n\nq2 2\n\nlog q1 log q2\n\nX\n\nX\n\nX\n\nk\n\nX\n\n***\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n1\nr \u2208P a rk\u22121 \u2208Prk\n\nq1 ,q2 \u2264y k\n\nX\n\nX\n\n1\n\np3 \u2208Pp4 s\u2208Pp3 \u2229Pr3 p\u2264t\np\u2208Ps\nr3 \u2208Pr4\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n1\nr \u2208P a rk\u22121 \u2208Prk\n\nq1 ,q2 \u2264y k\n\nX\n\n***\n\nq 2\n2\n\nX\n\n\u03c0(t; s, 1).\n\np3 \u2208Pp4 s\u2208Pp3 r3\nr3 \u2208Pr4\n\nWe split up into two cases. If q1a1 q2a2 > t\u03b1 , then suppose q1a1 > t\u03b1/2 . (the other case is\nanalogous) We get from the trivial bound on \u03c0(t; s, 1) that\nX\nX X\nX\nX X\n\u03c0(t; s, 1)\n***\nlog q1 log q2\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n\u03b1\n1\na\nq1 1 >t 2 rk \u2208P a2 rk\u22121 \u2208Prk\n\nq1 ,q2 \u2264y k\n\nq2\n\n=\n\nX\n\nlog q1 log q2\n\nX\n\nX\n\nX\n\nX\n\np3 \u2208Pp4 s\u2208Pp3 r3\nr3 \u2208Pr4\n\nX\n\n***\n\nX\n\n***\n\np3 \u2208Pp4\nr3 \u2208Pr4\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n\u03b1\n1\na\nq1 1 >t 2 rk \u2208P a2 rk\u22121 \u2208Prk\n\nq1 ,q2 \u2264y k\n\nq\n2\n\n=\n\nX\n\nlog q1 log q2\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n\u03b1\n1\na\nq1 1 >t 2 rk \u2208P a2 rk\u22121 \u2208Prk\n\nq1 ,q2 \u2264y k\n\nX\n\nlog q1 log q2\n\nq1 ,q2 \u2264y k\n\nX t log t\ns\ns\u2208P\n\n3\n\np4\n\nX t log t(log log t)2k\u22123\n.\nq1\u03b11 q2\u03b12\na ,a \u2208N\n1\na\n\n2\n\n\u03b1\n\nq1 1 >t 2\n\u03b1\n\nBy letting A = min{a|q1a1 > t 2 } we get\nX\n\n\u226a\n\nq1 ,q2 \u2264y\n\nt log t(log log t)k\u22121\nlog q1 log q2\nq1A q2\nk\n\n\u03b1\n\n\u2264 t1\u2212 2 log t(log log t)2k\u22123\n\nX\n\nq1 \u2264y k\n1\u2212\u01eb k\n\n\u226at\n\ny log y.\n35\n\nlog q1\n\np3 r 3\n\nX t log t log log t\np 3 r3\np \u2208P\nr3 \u2208Pr4\n\nq\n2\n\n=\n\nX\n\nX log q2\nq\nk\n\nq2 \u2264y\n\n\fIf q1a1 q2a2 > t\u03b1 , then by Lemma 21 part (d) we get\nX\nX\nX\nX\nlog q1 log q2\nq1 ,q2\n\nX\n\n\u03c0(t; s, 1)\n\np3 \u2208Pp4 s\u2208Pp3 r3\nr3 \u2208Pr4\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\na a\nq1 1 q2 2 \u2264t\u03b1 r \u2208P 1a rk\u22121 \u2208Prk\nk\nq 2\n\n\u2264y k\n\nX\n\n***\n\n2\n\nX\n\n\u226a\n\nX\n\nlog q1 log q2\n\na1 ,a2 \u2208N\na a\nq1 1 q2 2 \u2264t\u03b1\n\nq1 ,q2 \u2264y k\n\nt(log log t)2k\u22122\nq1a1 q2a2 log t\n\nt(log log t)2k\u22122\nq1 q2 log t\nq1 ,q2 \u2264y k\n\u0012\n\u00132\nt(log log t)2k\u22122 X log q\n=\nlog t\nq\nk\nX\n\n\u226a\n\nlog q1 log q2\n\nq\u2264y\n\n\u226a\n\nt(log log t)\nlog t\n\n2k\u22122\n\nlog2 y\n\nby (3), completing the lemma.\n\u0003\nWe now have enough to finish the second moment which is the final piece of the puzzle.\nProof of Proposition 15.\nX\n\n2\n\nhk (p) =\n\np\u2264t\n\nX\u0012X X\np\u2264x\n\n=\n\nq1 ,q2\n\n***\n\nX\n\n\u03bdq (pk \u2212 1) log q\n\npk |pk\u22121 \u22121 q\u2264y k\n\np1 |p p2 |p1 \u22121\n\nX\n\nX\n\nlog q1 log q2\n\nX\n\nX\n\nX\n\n***\n\nk\n\nX X\n\n1\n\np2 \u2208Pp3 p\u2264t\nr2 \u2208Pr3 p\u2208Pp2\np\u2208Pr2\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n1\nr \u2208P a rk\u22121 \u2208Prk\n\n\u2264y k\n\n\u00132\n\nq2 2\n\nsince the condition p1 | p only occurs if p1 = p. We then split up the sum according to\nwhether or not p2 = r2 . Lemma 27 deals with the part where s = p2 = r2 leaving us with\nX\n\nlog q1 log q2\n\nX\n\nX\n\nX\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n1\nr \u2208P a rk\u22121 \u2208Prk\n\nq1 ,q2 \u2264y k\n\nk\n\nq 2\n2\n\n...\n\nX X\n\n1\n\np2 \u2208Pp3 p\u2264t\nr2 \u2208Pr3 p\u2208Pp2\np2 6=r2 p\u2208Pr2\n\n\u0013\n\u0012\nt(log log t)2k\u22122\n2\n1\u2212\u01eb k\nlog y .\n+ O t y log y +\nlog t\nThe sum becomes\nX\n\nq1 ,q2 \u2264y k\n\nlog q1 log q2\n\nX\n\nX\n\nX\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\n1\nr \u2208P a rk\u22121 \u2208Prk\nk\n\nq 2\n2\n\nIf q1a1 > t\u03b11 , then so is p2 , and hence by (26) we get\n36\n\n***\n\nX\n\np2 \u2208Pp3\nr2 \u2208Pr3\n\n\u03c0(t; p2 r2 , 1).\n\n\fX\n\nlog q1 log q2\n\nX\n\nX\n\nX\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\na\nq1 1 >t\u03b11 r \u2208P 1a rk\u22121 \u2208Prk\nk\nq 2\n\nq1 ,q2 \u2264y k\n\n***\n\nX t log2 t\np 3 r3\np \u2208P\n3\n\np4\n\nr3 \u2208Pr4\n\n2\n\nX\n\n\u226a\n\nq1 ,q2 \u2264y\n\nX t log2 t(log log t)2k\u22124\nlog q1 log q2\nq1a1 q2a2\nk\na ,a \u2208N\n1\na\n\n2\n\nq1 1 >t\u03b11\n\nX\n\n\u226a t1\u2212\u03b11 log2 t(log log t)2k\u22124\n\nlog q1 log q2\n\nq1 ,q2 \u2264y k\n\nX 1\nq a2\na \u2208N 2\n2\n\nX log q1 log q2\nq2\nk\n\n\u226a t1\u2212\u03b11 log2 t(log log t)2k\u22124\n\nq1 ,q2 \u2264y\n1\u2212\u03b11\n\n\u226at\n\n2\n\nlog t(log log t)\n\n2k\u22124\n\n(y k log y).\n\nWe similarly get the same bound if q2a2 > t\u03b11 . If neither of q1a1 , q2a2 exceed t\u03b11 , then by (28)\nand using that for bi = qiai\n1\n1\nbi\n\u226a 1,\n\u226a ,\n\u03c6(bi )\n\u03c6(bi )\nbi\nwe get\nX\n\nq1 ,q2\n\nX\n\nX\n\nlog q1 log q2\n\nX\n\n***\n\na1 ,a2 \u2208N pk \u2208Pqa1 pk\u22121 \u2208Ppk\na\na\nq1 1 ,q2 2 \u2264t\u03b11 r \u2208P 1a rk\u22121 \u2208Prk\nk\nq 2\n\n\u2264y k\n\nX\n\nX\n\npi \u2208Ppi+1 pi\u22121 \u2208Ppi\nri \u2208Pri+1 ri\u22121 \u2208Pri\n\n***\n\np2 \u2208Pp3\nr2 \u2208Pr3\n\n2\n\n\u226a\n\nX\n\nlog q1 log q2\n\na1 ,a2 \u2208N\na\na\nq1 1 ,q2 2 \u2264t\u03b11\n\nq1 ,q2 \u2264y k\n\n\u226a\n\nt(log log t)2k\u22122\nlog t\n2k\u22122\n\n\u226a\n\nX\n\nt(log log t)\nlog t\n\nt(log log t)2k\u22122\nq1a1 q2a2 log t\n\nX log q1 log q2\nq1 q2\nk\n\nq1 ,q2 \u2264y\n\nlog2 y\n\n.\n\nHence the above gives us that\nX\n\nhk (p)2 \u226a t1\u2212\u01eb y k log y +\n\np\u2264t\n\n37\n\nX\n\nt(log log t)2k\u22122 log2 y\n.\nlog t\n\n\u03c0(t; p2 r2 , 1)\n\n\fUsing partial summation we have\nZ x\nX hk (p)2\nX hk (p)2 1 X\ndt X\n2\nM2 (x) =\nhk (p) +\nhk (p)2\n=\n+\n2\np\np\nx\nt\ne\ne\np\u2264x\nee \u2264p\u2264x\nee \u2264p\u2264t\np\u2264ee\n\u0012\n\u0013\nx(log log x)2k\u22122 log2 y\n1 1\u2212\u01eb k\nx y log y +\n\u226a1+\nx\nlog x\n\u0013\nZ x\u0012\n(log log t)2k\u22122 log2 y\n\u22121\u2212\u01eb k\ndt\n+\nt\ny log y +\nt log t\nee\ny 2k\u22122 log2 y\n+ x\u2212\u01eb y k log y + (log log x)2k\u22121 log2 y\nlog x\n\u226a y 2k\u22121 log2 y\n\n\u226a\n\ncompleting the proof of Proposition 15 and hence Theorem 1.\n\n\u0003\n\n15. Theorem 2\nWe now turn our attention to the proof of Theorem 2. It will be necessary to use the\nfollowing upper bound for the Carmichael function of a product.\nLemma 28. Let a, b be natural numbers, then\n\u03bb(ab) \u2264 b\u03bb(a).\n\n(32)\n\nProof. We first note that it suffices to show the inequality whenever b is prime, because if\nb = p1 . . . pk\nwhere the pi are not necessarily distinct, then repeated use of the theorem where b is prime\nyields\n\u03bb(ab) = \u03bb(ap1 . . . pk ) \u2264 p1 \u03bb(ap2 . . . pk ) \u2264 * * * \u2264 p1 . . . pk \u03bb(a) = b\u03bb(a).\nIf b is a prime which divides a, then\na = be pe11 . . . pekk and ab = be+1 pe11 . . . pekk .\nTherefore\n\u0013\n\u0012\nek\ne1\ne+1\n\u03bb(ab) = lcm \u03bb(b ), \u03bb(p1 ), . . . , \u03bb(pk )\n\u0012\n\u0013\nek\ne1\ne\n\u2264 lcm b\u03bb(b ), \u03bb(p1 ), . . . , \u03bb(pk )\n\u0013\n\u0012\nek\ne1\ne\n\u2264 b \u2217 lcm \u03bb(b ), \u03bb(p1 ), . . . , \u03bb(pk )\n= b\u03bb(a)\nwhere the first inequality is in fact an equality if be = 4. Also note that in this case, it would\nnot be hard to show that \u03bb(ab) | b\u03bb(a). If (a, b) = 1, then\n38\n\n\f\u0013\n\u0012\nek\ne1\n\u03bb(ab) = lcm b \u2212 1, \u03bb(p1 ), . . . , \u03bb(pk )\n\u0012\n\u0013\nek\ne1\n\u2264 (b \u2212 1) lcm \u03bb(p1 ), . . . , \u03bb(pk )\n< b\u03bb(a),\nending the proposition.\n\n\u0003\n\nSuppose that g(n) is an arithmetic function of the form \u03c6(h(n)) where h(n) is a (k\u22121)\u2013fold\niterate involving \u03c6 and \u03bb. Then we can use equation (32) to get\n\u0012\n\u0013\ng(n)\ng(n)\n\u03bbl+k (n) \u2264 \u03bbl (g(n)) \u2264 \u03bbl\n\u03bbk (n) \u2264 \u03bbl+k (n)\n.\n\u03bbk (n)\n\u03bbk (n)\nSince g(n) \u2264 n we have that\n\u0012\n\u0013\nn\n1\ng(n)\nk\n\u2264\n= exp\n(1 + ok (1))(log log n) log log log n\n\u03bbk (n)\n\u03bbk (n)\n(k \u2212 1)!\nby Theorem 1 and hence\n\u03bbl+k (n) \u2264 \u03bbl (g(n)) \u2264 \u03bbl\n\n\u0012\n\ng(n)\n\u03bbk (n)\n\u03bbk (n)\n\n\u0013\n\n\u2264 \u03bbl+k (n) exp\n\n\u0012\n\n\u0013\n1\nk\n(log log n) (1+ok (1)) log log log n .\n(k \u2212 1)!\n\nFrom the fact that\n\u03bbl+k (n) = n exp\n\n\u0012\n\n\u0013\n1\nk+l\n(1 + ol,k (1))(log log n) log log log n\n\u2212\n(k + l \u2212 1)!\n\nwe get\n\u0012\n\n\u0013\n1\nk+l\n\u03bbl (g(n)) = n exp \u2212\n(1 + ol,k (1))(log log n) log log log n .\n(k + l \u2212 1)!\nAs for \u03c6(g(n)) we note that unless g(n) = \u03c6k (n), g(n) can be writen as \u03c6l (h(n)) where h(n)\nis a (k \u2212 l)\u2013fold iterate beginning with a \u03bb. From above we can see that\n\u0012\n\u0013\n1\nk\u2212l\nh(n) = n exp \u2212\n(1 + ok (1))(log log n) log log log n\n(k \u2212 l \u2212 1)!\nand so \u03c6(h(n)) is bounded above by h(n) and below by\ne\u03b3\n\nh(n)\nlog log h(n) +\n\n3\nlog log h(n)\n\n=\n=\n\ne\u03b3\n\nlog log n \u2212\n\n1\n(1\n(k\u2212l\u22121)!\n\ne\u03b3 log log n \u2212 O\n\nh(n)\n\u0001\n+ ok (1))(log log n)k\u2212l log log log n\n\n1\n(1\n(k\u2212l\u22121)! log n\n\n= h(n) exp O(log log log n)\n\n\u0001\n\nh(n)\n\u0001\n+ ok (1))(log log n)k\u2212l log log log n\n\nwhich is within the error of h(n). Hence any string of \u03c6 will not change our estimate.\nTherefore if g(n) is a k\u2013fold iteration of \u03c6 and \u03bb which is not \u03c6k (n), but which begins with\nl copies of \u03c6, then\n39\n\n\fg(n) = n exp\n\n\u0012\n\n\u0013\n1\nk\u2212l\n(1 + ok (1))(log log n) log log log n\n\u2212\n(k \u2212 l \u2212 1)!\n\nyielding our theorem.\nAcknowledgements\nThe author would like to thank Greg Martin for his assistance and guidance.\nReferences\n[1] W.D. Banks, F. Luca, F. Saidak and P. St\u0103nic\u0103. Compositions with the Euler and Carmichael Functions,\nAbh. Math. Sem. Univ. Hamburg., 75 (2005), 215\u2013244.\n[2] P. Erd\u0151s, A. Granville, C. Pomerance, and C. Spiro, On the Normal Behavior of the Iterates of some\nArithmetic Functions, in Analytic number theory (Allerton Park, IL, 1989), Progr. Math., 85 Birkh\u00e4user\nBoston, Boston, MA, (1990), 165\u2013204.\n[3] P. Erd\u0151s, C. Pomerance, and E. Schmutz, Carmichael's Lambda Function, Acta Arith., 58 (1991),\n363\u2013385.\n[4] H. Halberstam and H. Richert Sieve Methods, Academic Press [A subsidiary of Harcourt Brace Jovanovich, Publishers], London-New York (2004) London Mathematical Society Monographs, No.4.\n[5] J.P. Kubilius, Probabilistic Methods in the Theory of Numbers, Translations of Mathetical Monographs,\nVol. 11, American Math. Soc., Providence (1964)\n[6] G.Martin and C. Pomerance, The Iterated Carmichael \u03bb\u2013Function and the Number of Cycles of the\nPower Generator, Acta Arith., 118 (2005), no. 4, 305\u2013335.\n[7] H. Montgomery and R. Vaughan, Multiplicative Number Theory I. Classical Theory, Cambridge University Press, New York (2007)\n[8] C. Pomerance, On the Distribution of Amicable Numbers, J. Reine Angew. Math., 293/294 (1977),\n217\u2013222.\nDepartment of Mathematics, University of British Columbia, Room 121, 1984 Mathematics\nRoad, Vancouver, BC, V6T 1Z2, Canada\nE-mail address: harlandn@math.ubc.ca\n\n40\n\n\f"}