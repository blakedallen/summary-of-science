{"id": "http://arxiv.org/abs/0811.2765v2", "guidislink": true, "updated": "2009-04-01T15:02:18Z", "updated_parsed": [2009, 4, 1, 15, 2, 18, 2, 91, 0], "published": "2008-11-17T18:05:57Z", "published_parsed": [2008, 11, 17, 18, 5, 57, 0, 322, 0], "title": "Two-particle irreducible effective action approach to nonlinear current\n  conserving approximations in driven systems", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0811.0246%2C0811.4593%2C0811.0103%2C0811.3371%2C0811.3088%2C0811.2528%2C0811.3411%2C0811.3786%2C0811.2599%2C0811.4610%2C0811.3304%2C0811.2128%2C0811.3278%2C0811.0042%2C0811.0092%2C0811.2538%2C0811.2344%2C0811.1186%2C0811.3288%2C0811.3300%2C0811.2635%2C0811.1777%2C0811.1574%2C0811.2495%2C0811.1797%2C0811.1185%2C0811.1633%2C0811.3615%2C0811.1590%2C0811.3866%2C0811.1866%2C0811.2310%2C0811.1666%2C0811.1672%2C0811.3770%2C0811.0806%2C0811.2912%2C0811.3937%2C0811.3400%2C0811.2657%2C0811.2334%2C0811.1442%2C0811.2601%2C0811.2964%2C0811.4687%2C0811.4497%2C0811.1722%2C0811.2536%2C0811.1603%2C0811.1441%2C0811.0833%2C0811.0587%2C0811.2030%2C0811.0414%2C0811.2102%2C0811.2656%2C0811.3153%2C0811.1933%2C0811.1787%2C0811.4184%2C0811.1869%2C0811.0994%2C0811.1929%2C0811.1084%2C0811.2254%2C0811.3137%2C0811.0631%2C0811.3939%2C0811.1746%2C0811.4548%2C0811.0288%2C0811.2765%2C0811.2630%2C0811.2114%2C0811.1313%2C0811.3281%2C0811.3934%2C0811.2033%2C0811.1181%2C0811.1663%2C0811.3685%2C0811.4516%2C0811.1664%2C0811.4675%2C0811.3744%2C0811.2696%2C0811.2902%2C0811.2921%2C0811.2911%2C0811.3326%2C0811.4116%2C0811.2970%2C0811.2315%2C0811.0915%2C0811.3099%2C0811.3311%2C0811.3344%2C0811.2081%2C0811.2844%2C0811.1128%2C0811.2353&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Two-particle irreducible effective action approach to nonlinear current\n  conserving approximations in driven systems"}, "summary": "Using closed-time path two-particle irreducible coarse-grained effective\naction (CTP 2PI CGEA) techniques, we study the response of an open interacting\nelectronic system to time-dependent external electromagnetic fields. We show\nthat the CTP 2PI CGEA is invariant under a simultaneous gauge transformation of\nthe external field and the full Schwinger-Keldysh propagator, and that this\nproperty holds even when the loop expansion of the CTP 2PI CGEA is truncated at\narbitrary order. The effective action approach provides a systematic way of\ncalculating the propagator and response functions of the system, via the\nSchwinger-Dyson equation and the Bethe-Salpeter equations, respectively. We\nshow that, due to the invariance of the CTP 2PI CGEA under external gauge\ntransformations, the response functions calculated from it satisfy the\nWard-Takahashi hierarchy, thus warranting the conservation of the electronic\ncurrent beyond the expectation value level. We also clarify the connection\nbetween nonlinear response theory and the WT hierarchy, and discuss an example\nof an ad hoc approximation that violate it. These findings may be useful in the\nstudy of current fluctuations in correlated electronic pumping devices.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0811.0246%2C0811.4593%2C0811.0103%2C0811.3371%2C0811.3088%2C0811.2528%2C0811.3411%2C0811.3786%2C0811.2599%2C0811.4610%2C0811.3304%2C0811.2128%2C0811.3278%2C0811.0042%2C0811.0092%2C0811.2538%2C0811.2344%2C0811.1186%2C0811.3288%2C0811.3300%2C0811.2635%2C0811.1777%2C0811.1574%2C0811.2495%2C0811.1797%2C0811.1185%2C0811.1633%2C0811.3615%2C0811.1590%2C0811.3866%2C0811.1866%2C0811.2310%2C0811.1666%2C0811.1672%2C0811.3770%2C0811.0806%2C0811.2912%2C0811.3937%2C0811.3400%2C0811.2657%2C0811.2334%2C0811.1442%2C0811.2601%2C0811.2964%2C0811.4687%2C0811.4497%2C0811.1722%2C0811.2536%2C0811.1603%2C0811.1441%2C0811.0833%2C0811.0587%2C0811.2030%2C0811.0414%2C0811.2102%2C0811.2656%2C0811.3153%2C0811.1933%2C0811.1787%2C0811.4184%2C0811.1869%2C0811.0994%2C0811.1929%2C0811.1084%2C0811.2254%2C0811.3137%2C0811.0631%2C0811.3939%2C0811.1746%2C0811.4548%2C0811.0288%2C0811.2765%2C0811.2630%2C0811.2114%2C0811.1313%2C0811.3281%2C0811.3934%2C0811.2033%2C0811.1181%2C0811.1663%2C0811.3685%2C0811.4516%2C0811.1664%2C0811.4675%2C0811.3744%2C0811.2696%2C0811.2902%2C0811.2921%2C0811.2911%2C0811.3326%2C0811.4116%2C0811.2970%2C0811.2315%2C0811.0915%2C0811.3099%2C0811.3311%2C0811.3344%2C0811.2081%2C0811.2844%2C0811.1128%2C0811.2353&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Using closed-time path two-particle irreducible coarse-grained effective\naction (CTP 2PI CGEA) techniques, we study the response of an open interacting\nelectronic system to time-dependent external electromagnetic fields. We show\nthat the CTP 2PI CGEA is invariant under a simultaneous gauge transformation of\nthe external field and the full Schwinger-Keldysh propagator, and that this\nproperty holds even when the loop expansion of the CTP 2PI CGEA is truncated at\narbitrary order. The effective action approach provides a systematic way of\ncalculating the propagator and response functions of the system, via the\nSchwinger-Dyson equation and the Bethe-Salpeter equations, respectively. We\nshow that, due to the invariance of the CTP 2PI CGEA under external gauge\ntransformations, the response functions calculated from it satisfy the\nWard-Takahashi hierarchy, thus warranting the conservation of the electronic\ncurrent beyond the expectation value level. We also clarify the connection\nbetween nonlinear response theory and the WT hierarchy, and discuss an example\nof an ad hoc approximation that violate it. These findings may be useful in the\nstudy of current fluctuations in correlated electronic pumping devices."}, "authors": ["J. Peralta-Ramos", "E. Calzetta"], "author_detail": {"name": "E. Calzetta"}, "author": "E. Calzetta", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1088/0953-8984/21/21/215601", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0811.2765v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0811.2765v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "30 pages. Accepted for publication in JPCM", "arxiv_primary_category": {"term": "cond-mat.str-el", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.str-el", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0811.2765v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0811.2765v2", "journal_reference": "J. Phys.: Condens. Matter 21, 215601 (2009)", "doi": "10.1088/0953-8984/21/21/215601", "fulltext": "Two-particle irreducible effective action approach to nonlinear\ncurrent conserving approximations in driven systems\nJ. Peralta-Ramos1, \u2217 and E. Calzetta1, \u2020\n\narXiv:0811.2765v2 [cond-mat.str-el] 1 Apr 2009\n\n1\n\nCONICET and Departamento de F\u0131\u0301sica,\n\nFacultad de Ciencias Exactas y Naturales,\nUniversidad de Buenos Aires-Ciudad Universitaria,\nPabell\u00f3n I, 1428 Buenos Aires, Argentina\n(Dated: November 3, 2018)\n\nAbstract\nUsing closed-time path two-particle irreducible coarse-grained effective action (CTP 2PI CGEA)\ntechniques, we study the response of an open interacting electronic system to time-dependent\nexternal electromagnetic fields. We show that the CTP 2PI CGEA is invariant under a simultaneous\ngauge transformation of the external field and the full Schwinger-Keldysh propagator, and that this\nproperty holds even when the loop expansion of the CTP 2PI CGEA is truncated at arbitrary order.\nThe effective action approach provides a systematic way of calculating the propagator and response\nfunctions of the system, via the Schwinger-Dyson equation and the Bethe-Salpeter equations,\nrespectively. We show that, due to the invariance of the CTP 2PI CGEA under external gauge\ntransformations, the response functions calculated from it satisfy the Ward-Takahashi hierarchy,\nthus warranting the conservation of the electronic current beyond the expectation value level. We\nalso clarify the connection between nonlinear response theory and the WT hierarchy, and discuss\nan example of an ad hoc approximation that violate it. These findings may be useful in the study\nof current fluctuations in correlated electronic pumping devices.\nPACS numbers: 05.30.-d, 05.60.Gg, 72.10.-d, 72.10.Bg, 73.23.-b\nKeywords: 2PI effective action, nonlinear driven transport, generalized Ward-Takahashi identities, external\nfield\n\n1\n\n\fI.\n\nINTRODUCTION\n\nIn this paper, we are interested in the response of an open electronic system to timedependent external electromagnetic fields. Although our analysis is quite general and can\nbe applied to a variety of condensed matter systems, we have in mind a system of strongly\ninteracting electrons subjected to external driving fields and in contact with two ideal reservoirs of noninteracting electrons. This could be a picture of the so-called interacting electron pumping devices, which are currently attracting much interest both experimentally\nand theoretically1 . In these devices, a direct current can be generated by applying slowlyoscillating external fields to the central electrons, even in the absence of a bias voltage\ndifference between reservoirs. These are very interesting systems to study from the theoretical point of view, since they represent a unique and challenging combination of strongly\ncorrelated particles and quantum transport, and for which the study of current conservation\nbeyond the expectation value level is nontrivial. A typical situation where one needs to go\nbeyond the expectation value of the current is when dealing with current fluctuations. It is\nwith these applications in mind that the following considerations were developed.\nThe main purpose of this work is to determine the basic requirements that a fieldtheoretical approach to open driven systems must satisfy in order to produce current conserving results (in the sense of the WT hierarchy developed in Sec. II), in transport calculations\ngoing beyond linear response. Another aim we have in mind is to clarify the close relation\nthat exists between current conservation and response theory, especially in the nonlinear\nregime. In order to analyze these issues, we combine the so-called external gauge invariance\nmethod with the closed-time path 2PI coarse-grained effective action (CTP 2PI CGEA),\nsuitable for the description of strongly interacting quantum open systems both in and out\nof equilibrium2,3,4,5,6 .\nThe area of nonequilibrium physics in interacting systems is gaining increasing interest\nnowadays, particularly time-dependent quantum transport in correlated systems7,8,9,10,11 .\nThe so-called time propagation method7 constitues a significant advance in this area. It consists in first determining the (interacting) equilibrium Green function and then propagating\nit by using the Kadanoff-Baym equations. This is equivalent7,8 to solving the Bethe-Salpeter\nequation for the particle-hole propagator (which is related to the first order response function\nof the system), but numerically much less expensive. This is a powerful method in which\n2\n\n\fexternal fields are treated exactly to all orders while many-body interactions are treated\nperturbatively. In this paper, we adopt another method to study nonequilibrium transport\nthrough correlated systems, in which both the external fields and the many-body interactions are treated perturbatively. Since it is based on an expansion of the Green function in\npowers of the external fields, it is only valid for weak external fields. On the other hand, it\nallows us to focus on current conservation beyond the expectation value level (i.e. conservation of current fluctuations). In this aspect the present work goes beyond previous analysis\nsuch as those described in Refs. 7,8,9,10,11.\nThe paper is organized as follows. In Sec. II we present the Ward-Takahashi (WT)\nhierarchy, which is the most general form of current conservation beyond the expectation\nvalue level, for a system driven by external fields. We discuss two possible ways (based on\neffective action techniques) of generating approximations to the non-equilibrium many-body\nproblem that satisfy the WT hierarchy. One of such methods, relying on the external gauge\ninvariance of the effective action, is used throughout the paper. In Sec. III we introduce\nthe 2PI CGEA of the system, closely following Ref. 2. In Sec. IV we prove that the exact\nand truncated effective actions are external gauge invariant. Using these theoretical tools,\nwe show in Sec. V that for any approximation to the Schwinger-Dyson equation (obtained\nfrom a truncation of the loop expansion of the 2PI CGEA) there exists a corresponding\napproximation to the Bethe-Salpeter equations (which give the vertex functions), such that\nthe WT hierarchy holds. The WT identities are systematically obtained from the external\ngauge symmetry of the 2PI CGEA. In this section we also clarify the relation between\nthe WT hierarchy and current-conserving nonlinear response theory. In Sec. VI we show,\nusing a simple example, how ad hoc approximations to the 2PI CGEA (not resulting from\na truncation of its loop expansion) violate the WT hierarchy. A brief summary is given in\nSec. VII.\n\nII.\n\nWARD-TAKAHASHI HIERARCHY AND CURRENT CONSERVATION\n\nIn many-particle systems and particularly in quantum transport theories, n-point vertex\nfunctions play a fundamental role, since they represent generalized currents which satisfy\nthe hierarchy of Ward-Takahashi identities12 . This hierarchy is satisfied to all orders in the\nexact theory, thus guaranteeing local gauge invariance and the conservation of the associated\n3\n\n\fcharges.\nThere are two equivalent ways of obtaining the WT identities. The first one, due to\nRivier and Pelka12 (See also Ref. 13), relies on the equation of motion of the n-particle\nGreen's function (GF). In the second one, due to Kadanoff and Baym14,15 , the two-point\nGF is expanded in powers of a fictitious non-local external field (for a recent development\nsee Ref. 10). To zeroth order in the expansion, the classical continuity equation is recovered\n(i.e. the mean current is divergenceless); to first order in the external field, the usual WT\nidentity relating the three-point vertex to the two-point propagator is obtained. Higher\norder terms in the expansion reproduce the hierarchy of WT identities obtained by the first\nmethod. We note that the second approach is not directly related to Baym's \u03a6\u2212derivable\napproximation2,14,16 , because in principle no approximation is involved. It is just an equivalent way of deriving the WT hierarchy which is based on a functional approach and not on\nthe equations of motion for the propagators.\nIn its most general form, the generalized continuity equation (WT hierarchy) can be\nwritten as (we use the simplified notation 1 = (t1 , r1 ) and employ Schwinger-Keldysh nonequilibrium formalism2,3,4,5,17,18,19,20 ):\n\u2202\u03bcz \u039b\u03bc(n) (1 . . . n, 1\u2032 . . . n\u2032 ; z) =\nin e{\u2212\u03b4(z \u2212 n\u2032 )Gn (1 . . . n, 1\u2032 . . . (n \u2212 1\u2032 )z) + . . .\n+ (\u22121)n \u03b4(z \u2212 1\u2032 )Gn (1 . . . n, 2\u2032 . . . z) + . . .\n\n(1)\n\n+ \u03b4(z \u2212 n)Gn (1 . . . (n \u2212 1)z, 1\u2032 . . . n\u2032 ) \u2212 . . .\n\u2212 (\u22121)n \u03b4(z \u2212 1)Gn (2 . . . z, 1\u2032 . . . n\u2032 )}\nwhere\n\u039b\u03bc(n) (12 . . . n, 1\u2032 2\u2032 . . . n\u2032 ; z) =\n\n(2)\n\n< Tc j \u03bc (z)\u03c8(1)\u03c8(2) . . . \u03c8(n)\u03c8 \u2020 (n\u2032 ) . . . \u03c8 \u2020 (2\u2032 )\u03c8 \u2020 (1\u2032 ) >\nis the (n + 1)-point vertex function with current insertion at z = (tz , rz ),\nj \u03bc (z) = \u2212e lim\nD \u03bc (z, z \u2032 )\u03c8 \u2020 (z \u2032 )\u03c8(z)\n\u2032\nz \u2192z\n\nD i (z, z \u2032 ) = (2i)\u22121 (\u2207iz \u2212 \u2207iz \u2032 )\nD 0 (z, z \u2032 ) = 1\n\n;\n\u03bc = i = 1, 2, 3\n\u03bc=0\n\n4\n\n,\n\n(3)\n\n\fand Gn are real-time propagators defined as usual\nGn (1 . . . n, 1\u2032 . . . n\u2032 ) =\ni\u2212(n) < Tc \u03c8(1) . . . \u03c8(n)\u03c8 \u2020 (n\u2032 ) . . . \u03c8 \u2020 (1\u2032 ) >\n\n(4)\n.\n\nNote that \u039b\u03bc(n=0) (z) =< j \u03bc (z) >, and that\nD i (z, z \u2032 )[A] = \u2212i{\u2207iz \u2212 \u2207iz \u2032 \u2212 ie[Ai (z) + Ai (z \u2032 )]}/2\n\n(5)\n\nin the presence of external fields.\nIn Eqs. (2) and (4), Tc is the closed-time path time ordering operator, \u03c8 and \u03c8 \u2020 are field\noperators in the Heisenberg representation, and < . . . > stands for an average taken with\nrespect to the density matrix of the system in the remote past. The classical continuity\nequation and the usual WT identity21 correspond to the cases n=0 and n=1 of Eq. (1),\nrespectively:\n\u2202\u03bcz < j \u03bc (z) >= 0\n\n(6)\n\nand\n\u2202\u03bcz \u039b\u03bc(1) (1, 1\u2032; z) = ie[\u2212\u03b4(z, 1\u2032 )G(1, z) + \u03b4(z, 1)G(z, 1\u2032 )]\n\n,\n\n(7)\n\nbeing G(1, 1\u2032) the single-particle propagator.\nAs already mentioned, in the exact theory Eq. (1) holds for arbitrary n. The hierarchy of n-particle propagators take into account that field excitations can be created and\nannihilated in the second-quantization formalism, thus acting as source terms for the generalized currents represented by the vertex functions. In other words, in the exact theory,\nparticle number is strongly conserved, not only in the mean. This fact has an important\nconsequence in quantum transport theories based on response theory to an external field,\nwhich is the main subject of this work. For a many-particle system in the presence of an\nexternal field, the hierarchy for the exact propagators implies that the current, as defined by\nEq. (3), is conserved to all orders in the external perturbation, with linear response theory\ncorresponding to the special case n=1.\nIt is impossible, in general, to obtain the propagators of an interacting field theory exactly,\nand some approximations must be made. In the weak-coupling regime, no conflict arises between conservation laws and perturbative expansions based on Feynman diagrams, because\nconserved quantities are conserved order by order in the expansion34 . On the other hand,\nfor a strong coupled theory re-summation concepts are usually needed2,16 , and warranting\n5\n\n\fconservation laws then becomes a nontrivial issue. Symmetries satisfied at the exact level\nmay not be satisfied by approximate propagators, thereby violating (generalized) current\nconservation dictated by the hierarchy in Eq. (1).\nA systematic way of generating conserving approximations (at the classical level, i.e.\nn=0) was given by Baym14 and corresponds to his well-known \u03a6-derivable scheme. The\nself-energy is obtained from a functional \u03a6 consisting of an infinite series of two-particle\nirreducible (2PI) closed diagrams, constructed from full propagators and bare vertices16 .\nThe solutions obtained from truncating the \u03a6 functional are such that, if \u03a6 is invariant\nunder a simultaneous symmetry transformation of the classical field and propagator, the\nexpectation values of the respective Noether currents are conserved2,14,23 . We emphasize that\nthis situation corresponds to the case n=0 of the WT hierarchy, given by Eq. (6). Therefore,\nthe conservation of generalized currents encoded in the WT hierarchy is not automatically\nwarranted in this approach. Moreover, in certain situations (e.g. in theories exhibiting\nspontaneous symmetry breaking) the hierarchy is already violated at the level of the selfenergy (corresponding to n =1) which does not satisfy the Nambu-Goldstone theorem2,24,25 .\nThe reason is simple: the n-point functions obtained by functional differentiation in a \u03a6derivable approximation may not be equal to the one-particle irreducible2 (1PI) functions\nthat satisfy the WT hierarchy.\nTo our knowledge, there are two possible approaches to overcome this problem present\nin \u03a6-derivable approaches35 . In the one put forward by van Hees and Knoll24 , a nonperturbative approximation for the 1PI quantum effective action is obtained on top of a\nself-consistent solution to Schwinger-Dyson equations (SDE) derived from the truncated\n2PI effective action. The vertex functions obtained in the usual way from this 1PI effective\naction fulfill the WT identities. The extra terms not accounted for in the \u03a6-derivable\napproximation and required to satisfy the identities are encoded in a Bethe-Salpeter equation\n(BSE) and higher vertex equations (see Ref. 27 for a calculation of conductivity in QED).\nThe second approach28,29 is based on the concept of external gauge invariance, and provides\na systematic way of generating consistent SDE and BSEs that automatically satisfy WT\nidentities. Most importantly in the context of transport theories of strongly interacting\nsystems, the derivation of the SDE and the BSEs can be done, in principle, to any order\nin the external field coupled to the system. Therefore, the latter is especially suited for the\nstudy of response theory beyond first order and its relation to current conservation beyond\n6\n\n\fthe expectation value level, and will be employed here.\n\nIII.\n\nCTP 2PI COARSE-GRAINED EFFECTIVE ACTION\n\nIn this section, we introduce the closed-time path 2PI effective action2,3,4,5,6,19 for a specific fermionic system open to an environment. A detailed presentation of effective action\ntechiques and the CTP formalism can be found in Ref. 2.\nThe system we are interested in consists of a central region with interacting electrons\ndescribed by fields (\u03c8 \u2020 , \u03c8) and coupled to an external field. This central region is connected\nto two ideal reservoirs of noninteracting electrons described by fields (\u03c6\u2020\u03b1 , \u03c6\u03b1 ), with \u03b1 =\n(L, R) denoting left or right reservoir. The reservoirs are assumed to remain in equilibrium\nat all times.\nThe CTP classical action of the system is S[\u03c8\u0304, \u03c8, \u03c6\u0304, \u03c6] = S\u03c8 + S\u03c6 + Sc , with:\n\u22121 B\nS\u03c8 = cAB \u03c8\u0304 A CAB\n\u03c8 + Sint [\u03c8\u0304, \u03c8]\n\u22121 B\nS\u03c6 = cAB \u03c6\u0304A BAB\n\u03c6\n\n(8)\n\nSc = cAB \u03c8\u0304 A TAB \u03c6B + h. c.\nwhere\n1\nUABCD \u03c8\u0304 A \u03c8 B \u03c8\u0304 C \u03c8 D\n(9)\n24\nthe completely antisymmetrized bare interaction local vertex. For the moment,\nSint [\u03c8\u0304, \u03c8] =\n\nbeing UABCD\n\nwe shall not specify the structure of the four-fermion vertex UABCD since its precise form\nwill not be needed until Sec. VI. TAB is a local coupling parameter between the central\nregion and the reservoirs.\nWe are using a DeWitt notation2,30 with A = (x, a), x = (tx , rx , \u03c3) and a = (1, 2) [or\n(+, \u2212)] being CTP indices indicating the branch within the closed-time contour. For the\nfields describing electrons inside the reservoirs, an additional index \u03b1 must be included in the\nCTP indices (A, B), but for simplicity we leave it implicit. Repeated indices are assumed to\nbe integrated or summed. (\u03c8\u0304, \u03c8) and (\u03c6\u0304, \u03c6) are Grassmann variables and cab is a CTP metric\ncab = diag(1, \u22121), while cAB = cab \u03b4(xA , xB ). CAB and BAB are the free CTP propagators\ncorresponding to S\u03c8 and S\u03c6 . They satisfy (we set ~, m, c = 1 in what follows)\ncAB \u0003BBC = i\u03b4AC\n \u0303 BC = i\u03b4AC\ncAB \u0003C\n7\n\n(10)\n\n\f \u0303\nwhere \u0003(1) = i\u2202t1 \u2212 h0 (1) while \u0003(1)\n= i\u2202t1 \u2212 h\u03030 (1), being h0 and h\u03030 single-particle Hamiltonians corresponding to the reservoirs and the central region, respectively. Explicitly, they\nread\n1\nand\nh0 (1) = \u2212 \u220721\n2\n1\nh\u03030 (1) = [\u2212i\u22071 + eAi (1)]2 + eA0 (1)\n2\n\n(11)\n\nwhere A\u03bc (z) is the external classical field and i = (1, 2, 3). Note that it is not necessary to\nadd CTP indices to the external field, since this is a physical source, and in any case we\nwould obtain A\u03bc,1 = A\u03bc,2 . It is important to remark that, since A\u03bc is external, it is not\ntreated as a dynamical field.\nFrom the classical action of Eq. (8), we form the CTP generating functional ZCT P with\nlocal and bi-local external sources JA and KAB , respectively. Since we are interested in the\ndynamics inside the central region coupled to reservoirs, only the fields (\u03c8\u0304, \u03c8) describing\nthe \"system\" will be coupled to the external sources. ZCT P contains all the information\nabout the non-equilibrium many-body system since all closed-time path correlators can be\ncalculated from it2 . When written as a path integral over field configurations it reads\n\nZCT P [J, K] =\n\nZ\n\n1\n[D \u03c6\u0304][D\u03c6][D \u03c8\u0304][D\u03c8] exp i(S[\u03c8\u0304, \u03c8, \u03c6\u0304, \u03c6] + J \u0304A \u03c8 A + \u03c8\u0304 A JA + KAB \u03c8\u0304 A \u03c8 B )\n2\n(12)\n\nwhere (J \u0304A , JA ) and KAB are fermionic and bosonic sources, respectively. The measure corresponding to each field, for example \u03c8, actually stands for [D\u03c8a ] with a = (1, 2) the branch\nindex. The CTP boundary condition of the path integral giving ZCT P , namely the continuity of field histories in the remote future, is implicit. We assume that the initial state is\nprepared in the remote past, corresponding to the in-vacuum2,3 . Note that (J \u0304A , JA ) act as\nLagrange multipliers constraining the deviations of (\u03c8\u0304, \u03c8) from their mean values, while KAB\nconstrains their fluctuations5 . This is the main idea behind nPI effective action techniques,\nnamely, to treat 1 . . . n\u2212point correlators on the same footing2,5,26 . By using the 2PI CGEA,\nonly the one and two-point correlators are treated as dynamical variables and therefore obtained variationally; higher correlations (with n > 2) are calculated from them. Note that\nthe use of the 2PI CGEA to obtain equations of motion for mean fields and propagators\nrepresents an enormous simplification of the usual perturbation expansion. Moreover, non8\n\n\fperturbative approximation schemes based on expansions of the 2PI EA provide powerful\ncalculational tools where standard expansion schemes break down2,6 .\nAny correlation function of the many-body system can be obtained from ZCT P by functional differentiation with respect to (J \u0304A , JA ) and then setting all sources to zero. For\nexample, the CTP two-point propagator of the central region is\n\u03b4 2 ZCT P [J, K]\n=\n< Tc \u03c8 A (\u03c8 B )\u2020 >=\n \u0304A i\u03b4L JB [J,J,K]=0\n \u0304\ni\u03b4\nJ\nR\nZ\n[D \u03c6\u0304][D\u03c6][D \u03c8\u0304][D\u03c8]\u03c8 A \u03c8\u0304 B exp i(S[\u03c8\u0304, \u03c8, \u03c6\u0304, \u03c6])\n\n(13)\n,\n\nwith \u03b4R,L denoting right and left differentiation, respectively. Note that there is no need\nto use contour-ordering operators in the second line of Eq. (13), since the path integral\nautomatically arranges operators in the correct order.\nSince the reservoirs' fields enter the action quadratically, we can integrate them out\nexactly in ZCT P , thus defining a new generating functional for CTP propagators belonging\nto the system. This coarse-grained generating functional reads:\nZ\nZ\u0303CT P [J, K] = [D \u03c8\u0304][D\u03c8] exp i(S\u0303[\u03c8\u0304, \u03c8] + sources)\n\n(14)\n\nwhere the effective classical action is given by\n\u22121 B\nS\u0303[\u03c8\u0304, \u03c8] = S\u0303\u03c8 = cAB \u03c8\u0304 A DAB\n\u03c8 + Sint [\u03c8\u0304, \u03c8]\n\n(15)\n\nwith\n\u22121\n\u22121\nDAB\n= CAB\n+ i\u03a3\u03c6,AB\n\n.\n\n(16)\n\nThe self-energy \u03a3\u03c6 describes the influence of the reservoirs on the particles' dynamics inside\nthe system, and it is given explicitly by\n\u2217\n\u03a3\u03c6,AD = TAB\nBBC TCD\n\n(17)\n\nwhere B is the given by Eq. (10). It is a complex quantity whose imaginary part represents\nthe tunneling rate of particles from the central region to the reservoirs. Note that \u03a3\u03c6 can\nbe easily calculated since it depends on the equilibrium CTP propagators of the reservoir\ncomposed of non-interacting electrons. The CTP propagators corresponding to the system\nare calculated from Z\u0303CT P using the analog of Eq. (13) with the replacement S \u2192 S\u0303.\nFrom Z\u0303CT P we define the CTP generating functional of connected propagators WCT P in\nthe usual way, i.e. Z\u0303CT P = exp iW , and then apply a double Legendre transform to obtain\n9\n\n\fthe 2PI-CTP effective action of the system. The sources (J, K) are connected to the mean\nfield and full propagators (denoted by G) through\n\u03b4W\n= \u03c8\u0302 A = 0\n\u03b4 J \u0304A\n\u03b4W\n= \u03c8\u0304\u02c6A = 0\n\u03b4JA\n1\n\u03b4W\n= GAB\n\u03b4KAB\n2\n\n(18)\n\nwhere we have used that the fermionic mean-fields (\u03c8\u0302, \u03c8\u0304\u02c6) = 0 since no symmetry breaking\noccurs. By performing the double Legendre transform on W and then using the background\nfield method we can write the CTP 2PI CGEA of the system as2 (Tr and ln operations are\nunderstood in a functional sense)\n\u22121 AB\n\u0393[G, A] = iTr lnG \u2212 iDAB\nG + \u03932 [G]\n\n(19)\n\nwhere A is the external classical field introduced before. We note that the CTP 2PI CGEA\ndepends explicitly on the external field only through D \u22121 [A]; this will be important in what\nfollows.\nIn Eq. (19), \u03932 [G] encodes all quantum corrections and consists of vacuum 2PI closed\ndiagrams with full propagators in internal lines and vertices corresponding to a theory with\nshifted classical action S[\u03c8\u0304\u02c6 + \u03c8\u0304, \u03c8\u0302 + \u03c8] (neglecting constant and linear terms), where (\u03c8\u0304, \u03c8)\ndenote fluctuations. The diagrams are vacuum because the mean value of the fluctuation\nfields is zero by construction. Note that because of the vanishing of the mean fields, the\nshifted classical action vanishes when evaluated at (\u03c8\u0304\u02c6, \u03c8\u0302). Therefore, the vertices contributing to \u03932 are identical to those of the original classical action, namely, the quartic one with\nU as coupling parameter. The case of noninteracting electrons corresponds in this scheme\nto \u03932 = 0.\nThe Schwinger-Dyson equations for the CTP propagators follow directly from \u0393[G, A]\n1\n\u03b4\u0393\n= \u2212 KAB\n\u03b4GAB\n2\n\n(20)\n\nwhere the physical case corresponds to vanishing external sources K = 0. Defining the\nself-energy\n\u03a3AB = \u22122\u03b4\u03932 /\u03b4GAB\n10\n\n(21)\n\n\fwe can rewrite the SDE in the usual way\n\u22121\nG\u22121\nAB = DAB + i\u03a3AB\n\n,\n\n(22)\n\nbeing \u03a3AB one-particle irreducible by construction.\nIn this paper, we shall not go beyond second order in the interaction parameter U,\ncorresponding in this theory to a three-loop expansion. To this order, \u03932 reads in our\ncompact notation:\n1\n\u03932 = \u2212 UABCD GAB GCD\n+\n8\n1\ni UABCD UEF GH GAE GBF GCG GDH\n48\n\n(23)\n.\n\nThe first term corresponds to the so-called double-bubble diagram and the second term to\nthe basketball diagram. In the SDE, the first term yields the time-dependent Hartree-Fock\napproximation, while the second is non-local and complex (therefore including fluctuation\ndamping)2,3,5 . We will return to these approximations when proving the external gauge\ninvariance of the CTP 2PI CGEA, in Sec. IV, and also in Sec. VI.\n\nIV.\n\nEXTERNAL GAUGE INVARIANCE OF THE CTP 2PI EA\n\nThe crucial observation that allows us to relate the CTP 2PI CGEA of the open system\nto nonlinear transport through it is that \u0393[G, A] is invariant under a gauge transformation\nof the external field A\u03bc . Following Bando, Harada and Kugo (Ref. 28), we will call this\nexternal gauge invariance (EGI) of the 2PI EA. We will first give a brief proof of the EGI of\nthe exact 2PI CGEA, where exact means that \u03932 is expanded to all loop orders in Eq. (19).\nThen, we will prove that even when the loop expansion of \u03932 is truncated at certain order,\nthe truncated 2PI EA still remains EGI.\nUnder a local transformation U(1) = exp ie\u03c6(1), the external field and the full propagator\ntransform as25,29 (we omit the CTP indices for the moment)\nA\u03bc \u2192 A\u2032\u03bc = UA\u03bc U \u22121 \u2212 i(\u2202\u03bc U)U \u22121\n\u2032\n\nG(1, 2) \u2192 G (1, 2) = U(1)G(1, 2)U\n\n\u22121\n\n(24)\n(2)\n\n.\n\nIt is rather straightforward to prove that, if we retain all terms in the loop expansion of \u03932 ,\nthen the 2PI CGEA is EGI2,6,25 . This can be simply understood recalling that the exact\n11\n\n\f2PI CGEA is precisely the generating functional of 1PI propagators. The proof of the EGI\nof the exact 2PI CGEA is based on the fact that, under a gauge transformation of the fields\n(A\u03bc , \u03c8\u0304, \u03c8), the CTP generating functional Z\u0303CT P [J, K] as given in Eq. (14) is invariant. This\nis because the transformation is equivalent to a change of integration variables in the path\nintegral, whose Jacobian is trivial due to the unitarity of the transformation (det U = 1).\nSince the classical (effective) action S\u0303[\u03c8\u0304, \u03c8] is external gauge invariant, only the source\nterms are transformed. For a local infinitesimal variation of the fields \u03b6 = (A\u03bc , \u03c8\u0304, \u03c8), given\nin compact notation by\n\u03b4\u03b6 = e(0, \u2212i\u03c6\u03c8\u0304, i\u03c6\u03c8) + (\u2202\u03bc \u03c6, 0, 0)\n\n(25)\n\nwe obtain from Eq. (14)\n\u03b4 Z\u0303CT P = 0 =< J \u0304A \u03b4\u03c8 A + \u03b4 \u03c8\u0304 A JA +\n(26)\n\n1\n1\nKAB \u03b4 \u03c8\u0304 A \u03c8 B + KAB \u03c8\u0304 A \u03b4\u03c8 B > ,\n2\n2\nwith\n< . . . >=\n\nZ\n\n[D \u03c8\u0304][D\u03c8](. . .) exp i(S\u0303[\u03c8\u0304, \u03c8] + sources)\n\n.\n\n(27)\n\nUsing that\n\u03b4\u0393\n1\n= \u2212JA + KAB \u03c8 B\nA\n2\n\u03b4 \u03c8\u0304\n\u03b4\u0393\n1\n= J \u0304A \u2212 KAB \u03c8\u0304 B\nA\n\u03b4\u03c8\n2\n\u03b4\u0393\n1\n= \u2212 KAB\n,\n\u03b4GAB\n2\n\n(28)\n\nwhich follows since W and \u0393 are Legendre transforms of each other, we can turn Eq. (26)\ninto an equation for \u0393:\nX\n\n\u03b1=2,3\n\n\u03b4\u03b6\u03b1\n\n\u03b4\u0393\n\u03b4\u0393\n+\n\u03b4GAB = 0\n\u03b1\n\u03b4\u03b6\n\u03b4GAB\n\n(29)\n\nwhere the variation of the full propagator is given by\n\u03b4GAB = \u03b4 < \u03c8 A \u03c8\u0304 B >=< \u03b4\u03c8 A \u03c8\u0304 B + \u03c8 A \u03b4 \u03c8\u0304 B >\n\n.\n\n(30)\n\nAccording to Eq. (25), Eq. (30) is the infinitesimal version of the transformation rule for G\ngiven in Eq. (24). Therefore, Eq. (29) shows that the exact 2PI CGEA is gauge invariant\nunder Eq. (24).\n\n12\n\n\fWe turn now to the invariance of the 2PI effective action which results from a truncation\nin the loop expansion of the quantum correction \u03932 . For completeness, we will also show\nexplicitly that the first two terms in Eq. (19), the one-loop terms, are EGI. We start with\nthe first term of \u0393[G, A], which is clearly EGI:\nTr lnG \u2192 Tr ln(UGU \u22121 ) = Tr[U(lnG)U \u22121 ] = Tr lnG.\n\n(31)\n\nThe EGI of the second term of Eq. (19) is proved by noting that D \u22121 transforms as G\nunder Eq. (24). This follows directly from the equation of motion for the system's free\npropagator C, given in Eq. (10), and the fact that \u03a3\u03c6 is invariant under the external gauge\ntransformation. The latter is a consequence of the equation of motion satisfied by B, the\nreservoir's free propagator, and the dependence of \u03a3\u03c6 on this propagator, given in Eq. (17).\nThe third term contributing to \u0393[G, A] is \u03932 [G], the sum of 2PI vacuum diagrams with\nG in internal lines. The proof of external gauge invariance proceeds as before, and relies on\nthe transformation law for propagators and the structure of the 2PI EA. To be explicit, we\nrewrite the first term of Eq. (23) taking into account that the interaction vertex UABCD is\nlocal. Using the locality of the bare vertex we obtain for the double-bubble diagram\n\u0168\n(1)\n\u03932 = \u2212 GAB GBA\n8\n\n(32)\n\nwhich shows that, as already mentioned, the self-energy derived from it is local. It is clear\nfrom the above expression that, under the external gauge transformation given in Eq. (24),\n(1)\n\n\u03932 is invariant. The structure of higher terms in the loop expansion of \u03932 is such that the\nEGI holds to arbitrary order.\nThe main conclusion of this discussion is that, even though the system is open to reservoirs, its 2PI coarse-grained effective action is, order by order in the loop expansion, invariant\nunder the gauge transformation given in Eq. (24). As we shall see, this makes the combination of the CTP 2PI-CG effective action approach and the external gauge invariance a\npowerful technique to study strongly interacting driven systems beyond linear response. We\nshould remark that in the presence of non-vanishing mean fields, the 2PI CGEA may not\nbe EGI order by order in a loop expansion2,6,25 .\n\n13\n\n\fV.\n\nWT HIERARCHY FROM EXTERNAL GAUGE INVARIANCE\n\nWe have seen that the CTP 2PI CGEA describing the system is left invariant under\nan external gauge transformation, and that this property holds to all orders in the (loop)\nexpansion of the quantum corrections given by \u03932 . This implies that the SDE derived\nfunctionally from the 2PI effective action is automatically external gauge covariant. Most\nimportantly, this is true for an arbitrary external classical field. This will be the key property\nto relate this symmetry with nonlinear response, thus generating approximations which\nsatisfy the WT hierarchy to arbitrary order. We will show that the external gauge covariance\nis also inherited by the BSE for vertex functions, which as a consequence of EGI will satisfy\nthe Ward-Takahashi hierarchy.\nGauge invariance of the effective action \u0393[G, A] implies\n\u0393[G, A] = \u0393[G\u2032 , A\u2032 ]\n\n(33)\n\nwhere a prime denotes external gauge transformated quantities according to Eq. (24). The\nSDE for the CTP propagators is given by \u03b4\u0393/\u03b4GAB = 0, and due to the EGI of the 2PI\nCGEA, it is (external) gauge covariant:\n\u03b4\u0393[G\u2032 , A\u2032 ]\n\u03b4\u0393[G, A]\n= U \u22121\nU\n\u03b4GAB\n\u03b4G\u2032AB\n\n.\n\n(34)\n\nThis property of the 2PI CGEA has an important consequence. It implies that the\nvariational procedure by which one obtains the SDE from the 2PI CGEA is independent of\nthe external gauge. That is to say, if GAB [A] is a solution of the SDE in the background\nclassical field A, i.e.\n\u03b4\u0393[G, A]\n=0\n,\n(35)\n\u03b4GAB GAB =GAB [A]\nthen the solution corresponding to a transformed external field A\u2032 = UAU \u22121 \u2212 i(\u2202U)U \u22121 is\nprecisely G\u2032 = UGU \u22121 :\n\n\u03b4\u0393[G\u2032 , A\u2032 ]\n=0\n\u03b4G\u2032AB G\u2032AB =U GAB [A]U \u22121\nMore explicitly, EGI of the 2PI CGEA implies\nG[A\u2032 ] = UG[A]U \u22121\n\n.\n\n.\n\n(36)\n\n(37)\n\nWe will now make a connection between EGI and nonlinear response. For notational\nsimplicity, CTP indices are omitted in the following. The solution G[A] to the SDE can be\nexpanded in powers of the external field A\u03bc (see Refs. 18,20,31):\n14\n\n\fi3\ni2\nA\u03bc A\u03bd A\u03c1 \u03a0\u03bc\u03bd\u03c1\n...\nG[A](X, Y ) = G[0](X, Y ) + iA\u03bc \u03a0\u03bc3 + A\u03bc A\u03bd \u03a0\u03bc\u03bd\n4 +\n5\n2\n3\nZ\nX in\n\u03bc1 ...\u03bcn\nd1 . . . dnA\u03bc1 (1) . . . A\u03bcn (n)\u03a0(n+2)\n(1, . . . , n; X, Y )\n=\nn!\nn=0\n\n(38)\n,\n\nwhere in the second line we have made explicit the internal (integration) (1, . . . , n) and the\nexternal (X, Y ) variables. The dummy indices \u03bc, \u03bd, \u03c1, etc. of the first line are denoted by\n\u03bc1 , . . . , \u03bcn in the second.\nThe \"response\" functions \u03a0(n+2) encode the variation of the full propagator with the external field. We note that it is possible18,31 , in principle, to expand higher order correlation\nfunctions similarly to the two-point function as given in Eq. (38), but in this paper we shall\nonly deal with G[A](X, Y ). Eq. (38) is given in the so-called18,31 single-time representation\nof CTP correlators, which is simpler for calculations than the \"physical\" or r/a representation. Both representations are related by a similarity transformation characterized by an\n\u221a\northogonal matrix17,18 Q = (1\u0302 \u2212 i\u03c32 )/ 2 with\n\uf8eb\n\uf8f6\n\uf8eb\n\uf8f6\n0 \u2212i\n1 0\n\uf8f8 ; 1\u0302 = \uf8ed\n\uf8f8\n\u03c32 = \uf8ed\n,\n(39)\ni 0\n0 1\nand are completely equivalent to each other:\nEi1 ...in (1 . . . n) = 2n/2\u22121 Qi1 \u03b11 . . . Qin \u03b1n E\u03b11 ...\u03b1n (1 . . . n)\nE\u03b11 ...\u03b1n (1 . . . n) = 2\n\n1\u2212n/2\n\nQT\u03b11 i1\n\n. . . QT\u03b1n in Ei1 ...in (1 . . . n)\n\n(40)\n\nwhere E(1 . . . n) denotes a n\u2212point CTP function, \u03b1j (ij ) corresponds to the single-time\n(physical) representation and repeated indices are assumed to be summed. To give an\nexample of Eq. (40), for the propagators in the physical\n\uf8f6\n\uf8eb\n0 Ga\n\uf8f8\nG\u0303 = \uf8ed\nGr Gc\n\n(41)\n\nand in the single-time\n\uf8eb\n\nG\u0303 = \uf8ed\n\nG++ G+\u2212\nG\u2212+ G\u2212\u2212\n\n15\n\n\uf8f6\n\uf8f8\n\n(42)\n\n\frepresentations we have2 :\n1\nG\u030311 = (G++ + G\u2212\u2212 \u2212 G+\u2212 \u2212 G\u2212+ ) = 0\n2\n1\nG\u030312 = Ga = (G++ \u2212 G\u2212+ + G+\u2212 \u2212 G\u2212\u2212 )\n2\n1\nG\u030321 = Gr = (G++ \u2212 G+\u2212 + G\u2212+ \u2212 G\u2212\u2212 )\n2\n1\nG\u030322 = Gc = (G++ + G\u2212\u2212 + G+\u2212 + G\u2212+ )\n2\n= G+\u2212 + G\u2212+ = G++ + G\u2212\u2212\n\n(43)\n\n.\n\nThe first equality in Eq. (43) is valid in general: any CTP function in the physical representation with all its indices set to \"1\" satisfies G\u030311...1 = 0. The last line results from\nthe identity G+\u2212 + G\u2212+ = G++ + G\u2212\u2212 , which follows from the normalization of the step\nfunction \u03b8(1, 2) + \u03b8(2, 1) = 1. In these expressions, Gr , Ga and Gc are retarded, advanced\nand correlation functions, respectively:\nGr (1, 2) = \u2212i\u03b8(1, 2) < {\u03c8(1), \u03c8 \u2020 (2)} >\nGa (1, 2) = \u2212i\u03b8(2, 1) < {\u03c8(1), \u03c8 \u2020 (2)} >\n\n(44)\n\nGc (1, 2) = \u2212i < {\u03c8(1), \u03c8 \u2020(2)} >\nwhere {, } is the anticonmutator and \u03b8 the step function, while G++,\u2212\u2212,+\u2212,\u2212+ are the chronological (Feynman), antichronological (Dyson), lesser and greater correlations:\nG++ (1, 2) = \u2212i < T \u03c8(1)\u03c8 \u2020 (2) >\nG+\u2212 (1, 2) = i < \u03c8 \u2020 (2)\u03c8(1) >\n\n(45)\n\nG\u2212+ (1, 2) = \u2212i < \u03c8(1)\u03c8 \u2020 (2) >\nG\u2212\u2212 (1, 2) = \u2212i < T\u0303 \u03c8(1)\u03c8 \u2020 (2) >\n\n,\n\nwith (T, T\u0303 ) denoting the chronological and antichronological time ordering operator. Using\nthis transformation rule, it is a simple matter to re-express Eq. (38) (and what follows from\nit) in the physical representation (see Refs. 18 and 20), but for clarity we will continue\nemploying the single-time representation.\nWe note that, as discussed in Ref. 18, in the physical representation the observables\nare given by retaining only the \"2\" component of the n\u2212point function G\u0303(1 . . . n), i.e. by\nthe correlation functions G\u03032...2 . For example, the two-point observable (n = 2) is the fully\nsymmetrized correlation function G\u030322 (X, Y ) = Gc (X, Y ), given in Eq. (43). Using the\n16\n\n\frelation between the physical and single-time representations, the response of the correlation\ntwo-point function G\u030322 is immediately obtained\nG\u030322 [A](X, Y ) =G\u030322 [0](X, Y ) +\ni\u03a0\u0303\u03bc221 (X, Y\n\n(46)\n\n; 1)A\u03bc (1) + . . .\n\nIt is worth remarking that the use of the closed-time path method automatically ensures\nthat the response functions are causal (see, for instance, Refs. 2 and 18)36 .\nReturning now to Eq. (38), the response functions are given by\n\u03bc1 ...\u03bcn\n\u03a0(n+2)\n(1, . . . , n; X, Y ) =\n\u2212n\n\ni\n\n\u03b4G(X, Y ; A)\n\u03b4A\u03bc1 (1) . . . \u03b4A\u03bcn (n)\n\n(47)\n[A\u03bc1 ...A\u03bcn ]=0\n\nand correspond to (n + 2)\u2212point functions with n current vertices inserted at locations\n(1, . . . , n) where interactions between the current and the external classical field take place.\nIn more detail, the response functions for n = 1, 2 read\n\u03a0\u03bc3 (X, Y ; z) = \u2212i < Tc j \u03bc (z)\u03c8(X)\u03c8 \u2020 (Y ) >\n\nand\n\n(48)\n\n\u03bc\n\u03bd\n\u2020\n\u03a0\u03bc\u03bd\n4 (X, Y ; z, w) = \u2212 < Tc j (z)j (w)\u03c8(X)\u03c8 (Y ) >\n\nNote that \u2212i\u03a02 (X, Y ) corresponds to the propagator in the absence of the external field,\nwhich can be written as G[0](Xi , Yi ; X0 \u2212Y0 ) due to time-translation invariance of the system\nin equilibrium.\nThe structure of \u03a0(n+2) as given in Eq. (48) follows because functional differentiation with\nrespect to A\u03bc yields a current insertion to which the external field couples. In functional\nlanguage we have that\n\n\u03b4G(X, Y ; A)\n=\n\u03b4A\u03bc1 (1) . . . \u03b4A\u03bcn (n) [A\u03bc1 ...A\u03bcn ]=0\nZ\n\u03b4\n[D\u03c8][d\u03c8\u0304]\u03c8(X)\u03c8\u0304(Y )\n\u03b4A\u03bc1 (1) . . . \u03b4A\u03bcn (n)\n\n(49)\n[A\u03bc1 ...A\u03bcn ]=0\n\nexp i(S\u0303[\u03c8\u0304, \u03c8] + sources)\n\n.\n\nEq. (49) automatically leads to Eq. (48) since\n\u03b4\n\u03b4A\u03bc1 (1) . . . \u03b4A\u03bcn (n)\n\n[A\u03bc1 ...A\u03bcn ]=0\n\nn\n\nexp i(S\u0303[\u03c8\u0304, \u03c8] + sources)\n\n= (\u2212i) j\u03bc1 (1) . . . j\u03bcn (n) exp i(S\u0303[\u03c8\u0304, \u03c8, A = 0] + sources)\n17\n\n(50)\n.\n\n\fThe functions \u03a0(n+2) are obtained from the SDE by functional differentiation with respect\nto A\u03bc (and then setting A = 0). This results in the BSEs for the response functions. For\nexample, the BSE that determines \u03a03 reads\n\u03b4G\u22121\n\u03b4D \u22121\n\u03b4\u03a3\n=\n+i\n\u03b4A\u03bc\n\u03b4A\u03bc\n\u03b4A\u03bc\n\n(51)\n\nwhere both sides of the equation are evaluated at A\u03bc = 0. Using that G(1, 2)G\u22121(2, 1\u2032 ) =\n\u03b4(1, 1\u2032) (where the coordinate 2 is integrated), which implies\nZ\n\u03b4G\u22121 (1, 2)\n\u03b4G(4, 5) \u22121\n= \u2212 d4d5G\u22121(1, 4)\nG (5, 2)\n\u03b4A\u03bc (3)\n\u03b4A\u03bc (3)\n\n(52)\n\nand defining\n\u03bc1 ...\u03bcn\n\u03bc1 ...\u03bcn \u22121\n\u03a0\u0303(n+2)\n= G\u22121 \u03a0(n+2)\nG\n\n,\n\n(53)\n\nthe BSE for \u03a03 can be written as\n\u03a0\u0303\u03bc3 = \u2212\n\n\u03b4\u03a3\n\u03b4D \u22121\n\u2212i\n\u03b4A\u03bc\n\u03b4A\u03bc\n\n.\n\n(54)\n\nSince the self-energy \u03a3 is defined through \u03932 , it is a functional of the full propagator G and\ntherefore the last term in Eq. (54) involves \u03a03 . Namely,\n\u03b4\u03a3 \u03b4G\n\u03b4D \u22121\n\u2212i\n=\n\u03b4A\u03bc\n\u03b4G \u03b4A\u03bc\n\u03b4D \u22121 (X, Y )\n\u03b4\u03a3(X, Y ) \u03b4G(V, W )\n\u2212\n\u2212i\n=\n\u03b4A\u03bc (z)\n\u03b4G(V, W ) \u03b4A\u03bc (z)\n\u03b4D \u22121 (X, Y )\n\u03b4\u03a3(X, Y ) \u03bc\n\u2212\n\u2212i\n\u03a0 (V, W ; z)\n\u03b4A\u03bc (z)\n\u03b4G(V, W ) 3\n\n\u03a0\u0303\u03bc3 (X, Y ; z) = \u2212\n\n(55)\n,\n\nwhere in the last two lines the coordinates are shown explicitly (V and W are integrated).\nThis is an integral equation that determines \u03a03 once the quantity \u03b4\u03a3/\u03b4G is known. Taking\nfurther functional derivatives of the SDE with respect to A\u03bc (and setting A = 0) results in\na set of integral equations for n > 1 response functions. Note that \u03a3 is directly obtained\nfrom \u0393[G, A], so the SD and BS equations are fully consistent with each other.\nAs we have seen, the combination of the SDE and the BSEs completely determine the full\npropagator and the response functions \u03a0(n+2) . The SDE is obtained from the 2PI CGEA,\nwhile the BSEs are obtained from the SDE by differentiation with respect to the external\nfield. The important point is that, because the 2PI CGEA is invariant under external\ngauge transformations, both the full propagator and response functions obtained this way\n18\n\n\fare external gauge covariant. As we will show below, the EGI property of the 2PI CGEA\nimplies that G and \u03a0(n+2) , as obtained from \u0393[G, A], satisfy the WT hierarchy. This provides\nthe required link between current conservation in nonlinear response and the external gauge\ninvariance of the 2PI CGEA, and also a powerful and systematic way of studying nonlinear\nresponse in strongly interacting systems coupled to ideal reservoirs.\nTo see the connection between EGI and the WT hierarchy, recall that external gauge\ninvariance of the effective action means G[A\u2032 ] = UG[A]U \u22121 . Inserting the expansion in\npowers of the external field given in Eq. (38) into both sides of this identity we get\ni2\nG[0] + iA\u2032\u03bc \u03a0\u03bc3 + A\u2032\u03bc A\u2032\u03bd \u03a0\u03bc\u03bd\n4 + ...\n2\nZ\nX in\n\u03bc1 ...\u03bcn\n=\nd1 . . . dnA\u2032\u03bc1 (1) . . . A\u2032\u03bcn (n)\u03a0(n+2)\n(1, . . . , n; X, Y )\nn!\nn=0\n\u22121\n\niA\u03bc U\u03a0\u03bc3 U \u22121\n\ni2\n\u22121\n+ ...\n+ A\u03bc A\u03bd U\u03a0\u03bc\u03bd\n4 U\n2\n\n(56)\n\n= UG[0]U +\nX in Z\n\u03bc1 ...\u03bcn\nd1 . . . dnA\u03bc1 (1) . . . A\u03bcn (n)[U(X)\u03a0(n+2)\n(1, . . . , n; X, Y )U \u22121 (Y )] .\n=\nn!\nn=0\nNote that Eq. (56) explicitly shows that the response functions \u03a0(n+2) are external gauge\ncovariant. In particular, for an infinitesimal external gauge transformation U(X) \u2248 1 +\nie\u03c6(X) the transformed external field is\nA\u2032\u03bc (X) = A\u03bc (X) + \u2202\u03bc \u03c6(X)\n\n,\n\n(57)\n\nso Eq. (56) becomes\nX in Z\nn=0\n\nn!\n\nX in Z\nn=0\n\nn!\n\n[dn]\n\nn\nY\n\u03bc1 ...\u03bcn\n{A\u03bci (i) + \u2202\u03bci \u03c6(i)}\u03a0(n+2)\n=\n\n[dn]\n\nn\nY\n\ni=1\n\ni=1\n\n(58)\n\n\u03bc1 ...\u03bcn\n\u03bc1 ...\u03bcn\n\u03bc1 ...\u03bcn\nA\u03bci (i){\u03a0(n+2)\n+ ie[\u03c6(X)\u03a0(n+2)\n\u2212 \u03a0(n+2)\n\u03c6(Y )]}\n\n\u03bc1 ...\u03bcn\nwhere we have suppressed the arguments of \u03a0(n+2)\n(1 . . . n; X, Y ) and defined [dn] = d1 . . . dn\n\nfor brevity. Comparing terms of the same order in A\u03bc on both sides of this expression we\nget\n\u03a02 (X, Y ) + i\n\nZ\n\nd1[\u2202\u03bc1 \u03c6(1)]\u03a0\u03bc3 (X, Y ; 1) =\n\n\u03a02 (X, Y ) + ie[\u03c6(X)\u03a02 (X, Y ) \u2212 \u03a02 (X, Y )\u03c6(Y )]\n19\n\n(59)\n\n\ffor the zeroth order term, and\nZ\nd1d2[\u2202\u03bd2 \u03c6(2)]\u03a0\u03bc\u03bd\n4 (X, Y ; 1, 2)A\u03bc (1) =\nZ\nd1e[\u03c6(X)\u03a0\u03bc3 (X, Y ; 1) \u2212 \u03a0\u03bc3 (X, Y ; 1)\u03c6(Y )]A\u03bc (1)\n\n(60)\n\nfor the linear term. Higher order terms have a similar structure but can become quite involved. The main point to emphasize is that the EGI of the 2PI CGEA implies relationships\namong the response functions, shown explicitly in Eq. (58).\nAssuming that \u03c6 vanishes at infinity, we can integrate by parts the second term in Eq.\n(59) (zeroth order in A\u03bc ) to obtain\nZ\ni d1\u03c6(1)\u2202\u03bc1 \u03a0\u03bc3 (X, Y ; 1) =\n\n(61)\n\n\u2212 ie[\u03c6(X)\u03a02 (X, Y ) \u2212 \u03a02 (X, Y )\u03c6(Y )]\nwhich implies\n\u2202\u03bcz \u03a0\u03bc3 (X, Y ; z) = \u2212e\u03a02 (X, Y )[\u03b4(X \u2212 z) \u2212 \u03b4(Y \u2212 z)]\n\n(62)\n\nor, in more detail,\n\u2202\u03bcz < Tc j \u03bc (z)\u03c8(X)\u03c8\u0304(Y ) >=\n\n(63)\n\ne < Tc \u03c8(X)\u03c8\u0304(Y ) > [\u03b4(Y \u2212 z) \u2212 \u03b4(X \u2212 z)]\n\n.\n\nThis is precisely the identity corresponding to n = 1 in the WT hierarchy given by Eq. (1),\nthat is, Eq. (7). We see that, even at zeroth order in the external field, the relation between\nthe three-point vertex and the two-point function, Eq. (63), is satisfied due to the EGI of\nthe 2PI EA.\nSimilarly, for the linear term, Eq. (60) implies the following identity\nZ\n\u2212 d2\u2202\u03bd2 \u03a0\u03bc\u03bd\n4 (X, Y ; 1, 2)\u03c6(2) =\ne[\u03c6(X)\u03a0\u03bc3 (X, Y\n\n; 1) \u2212\n\n\u03a0\u03bc3 (X, Y\n\n(64)\n\n; 1)\u03c6(Y )]\n\nwhich leads by the same calculation as in the zeroth order case to a WT identity between\nthe three- and four-point response functions (equivalent to Eq. (1) for n = 2):\n\u2202\u03bdz \u03a0\u03bc\u03bd\n4 (X, Y ; 1, z) =\ne[\u03b4(Y \u2212 z) \u2212 \u03b4(X \u2212 z)]\u03a0\u03bc3 (X, Y ; 1)\n20\n\n(65)\n.\n\n\fIt is clear that this procedure could be continued to higher order terms in A\u03bc , thus\ngenerating higher order WT identities. We note that the hierarchy obtained for the response\nfunctions \u03a0(n+2) is completely equivalent to that involving \u039b(n) , given in Eq. (1), as expected\nsince, ultimately, they both enforce current conservation. As it can be seen from their\ndefinitions, Eqs. (2) and (47), the relation between vertex and response functions can be\ncompactly written as\n\n\u03bc1 ...\u03bcn\n\u03a0(n+2)\n(X, Y\n\n; z1 . . . zn ) = (\u2212e)\n\n(n\u22121)\n\nn\nY\n\n\u03b1=2\n\n1\nlim D \u03bc\u03b1 (z\u03b1\u2032 , z\u03b1 )\u039b\u03bc(n)\n(Xz2 . . . zn , Y z2\u2032 . . . zn\u2032 ; z1 ) (66)\n\n\u2032 \u2192z\nz\u03b1\n\u03b1\n\nfor n \u2265 2, and\n\u03a0\u03bc(3) (X, Y ; z) = \u039b\u03bc(1) (X, Y ; z)\n\u03a0(2) (X, Y ) = iG[0](X, Y )\n\nfor\nfor\n\nn = 1,\n\n(67)\n\nn = 0,\n\nwhere the operator D \u03bc\u03b1 (z\u03b1\u2032 , z\u03b1 ) is defined in Eq. (3). Defining the operator (with n \u2265 2 and\n2 \u2264 \u03b1 \u2264 n)\nFn\u03bc2 ...\u03bcn ({z\u03b1\u2032 , z\u03b1 }) = (\u2212e)(n\u22121)\nthat appears in Eq. (66) acting on\n\n1\n\u039b\u03bc(n)\n,\n\nn\nY\n\n\u03b1=2\n\nlim D \u03bc\u03b1 (z\u03b1\u2032 , z\u03b1 )\n\n\u2032 \u2192z\nz\u03b1\n\u03b1\n\n(68)\n\nnoting that this operator does not depend on z1\n\n(the \"external\" coordinate in \u039b(n) ), and using the property of the Green's function Gn\nFn\u03bc2 ...\u03bcn ({z\u03b1\u2032 , z\u03b1 })Gn (1 . . . z\u03b1 . . . n, 1\u2032 . . . z\u03b1\u2032 . . . n\u2032 ) =\nFn < Tc \u03c8(1) . . . \u03c8(z\u03b1 ) . . . \u03c8(n)\u03c8\u0304(n\u2032 ) . . . \u03c8\u0304(z\u03b1\u2032 ) . . . \u03c8\u0304(1\u2032 ) >\n=< Tc j \u03bc2 (z2 ) . . . j \u03bcn (zn )\u03c8(1)\u03c8\u0304(1\u2032 ) >=\n\n(69)\n\n\u03bc2 ...\u03bcn\n(1, 1\u2032 ; z2 . . . zn )\n\u03a0(n+2)\n\nthe equivalence between WT hierarchies can be proven using Eq. (66) (the calculation is\ntedious but rather straightforward).\nTherefore, the external gauge invariance of the 2PI CGEA enforces the WT hierarchy\nnecessary for current conservation beyond the expectation value level. By expanding the full\npropagator (solution to the SDE) in powers of the external field, we can calculate currentconserving response functions as solutions to the BSEs obtained from the SDE. The key\npoint is that the EGI of the 2PI CGEA implies the covariance of the full propagator and\nthe response vertex functions, and this results in the WT relationships among them. We\n21\n\n\femphasize that such a procedure relies on an expansion of G[A] in powers of the external\nfield A, so it is valid only for weak external fields.\nWe end up this section by indicating how to calculate the current induced by the external\nclassical field. The average current which evolves by the action of the external field is given\nby Eq. (3), which can be re-expressed in terms of the lesser Green function G+\u2212 :\n< j \u03bc (z) > = \u2212e lim\nD \u03bc (z, z \u2032 )[A] < \u03c8 \u2020 (z \u2032 )\u03c8(z) >=\n\u2032\nz \u2192z\n\nie lim\nD \u03bc (z, z \u2032 )[A]G+\u2212 (z, z \u2032 )\n\u2032\n\n(70)\n\nz \u2192z\n\n\u03bc\n\nwhere D [A] is given in Eq. (5) and one should recall that G+\u2212 must be calculated in the\npresence of the external field22 . The lesser Green function appearing in the expression for\nthe current can be calculated directly from the expansion given in Eq. (38). In this way, the\ninduced average current can be systematically calculated to arbitrary order in the external\nclassical field. The approach based on the 2PI EA and its loop truncation, adopted here,\nguarantees that the WT hierarchy is fulfilled.\n\nVI.\n\nAPPROXIMATE 2PI EFFECTIVE ACTIONS AND CURRENT CONSERVA-\n\nTION\n\nAs shown in Sec. III, the virtue of the 2PI CGEA method is that it provides a systematic\nway of encompassing interacting fields and current-conserving nonlinear response theory in\na unified way. In particular, truncations to the loop expansion of the 2PI CGEA are, to\narbitrary order, external gauge invariant. Therefore, any such approximation will preserve\nthe WT hierarchy. In this section, we give a concrete example of an ad hoc approximation\nto the 2PI CGEA, i.e. not obtained from a truncation in the loop expansion, and analyze\nthe consequences for current conservation.\nTo be specific, we consider the following bare interaction vertex in Sint as appearing in\nEq. (9):\nUABCD = cabcd \u03b4\u0304t,r \u03b4\u0304\u03c3 \u0168\nwhere\ncabcd\n\n\uf8f1\n\uf8f4\n\uf8f4\n1\n\uf8f4\n\uf8f4\n\uf8f2\n= \u22121\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f30\n\n(71)\n\nif a, b, c, d = +\nif a, b, c, d = \u2212\notherwise\n22\n\n(72)\n\n\fis a CTP tensor. In Eq. (71) we have grouped delta functions as follows\n\u03b4\u0304t,r = \u03b4(tA \u2212 tB )\u03b4(tA \u2212 tC )\u03b4(tA \u2212 tD )\u00d7\n\u03b4(rA \u2212 rB )\u03b4(rA \u2212 rC )\u03b4(rA \u2212 rD )\n\n(73)\n\n= \u03b4(XA \u2212 XB )\u03b4(XA \u2212 XC )\u03b4(XA \u2212 XD )\nand (\u03c3 stands for spin projection)\n\u03b4\u0304\u03c3 = \u03b4\u03c3A ,\u03c3B \u03b4\u03c3C ,\u03c3D\n\n.\n\n(74)\n\nThis vertex describes a \"Hubbard-like\" local interaction n\u2191 (r)n\u2193 (r), where n\u03c3 (r) is the electron number operator at position r.\nIt will be convenient for what follows to write the quantum correction to the 2PI EA as\n\u03932 [G] =\n\n\u221e\nX\n\n(i)\n\n\u03932\n\n(75)\n\ni=1\n\n(i)\n\nwhere \u03932 is of order \u0168 i . We note that, due to the fact that fermion mean fields vanish,\nan expansion of \u03932 in powers of U is equivalent to a loop expansion (this is no longer true\nwhen symmetry breaking occurs, see e.g. Ref. 2). The O(U) diagram corresponds to the\ndouble-bubble, which is two-loop, while the O(U 2 ) one corresponds to the basketball, which\nis three-loop. Both diagrams are given in Eq. (23). Since the CTP self-energy is obtained\nby functionally differentiating \u03932 with respect to the full propagator, the contributions to\nthe self-energy can also be classified according to Eq. (75). According to Eq. (71), for i = 1\nwe have\n1\n(1)\n(1)\n\u03a3AB =\u03a3ab (XA , XB ) = UABCD GCD\n4\nX Z\n1\n= \u0168cabcd\ndXC dXD \u03b4(XA \u2212 XB )\u03b4(XA \u2212 XC )\u03b4(XA \u2212 XD )\u00d7\n4\n\u03c3 ,\u03c3\nC\n\nD\n\n(76)\n\n\u03b4\u03c3A \u03c3B \u03b4\u03c3C \u03c3D Gcd (XC , XD )\n1\n= \u0168cabcd \u03b4(XA \u2212 XB )\u03b4\u03c3A \u03c3B Gcd (XA , XB )\n2\n\n.\n\nWe note that the exchange part of \u03a3AB is absent because the interaction occurs between\nparticles with opposite spin projection.\n\n23\n\n\fFrom this equation, the (+, \u2212) components of the CTP self-energy are immediately obtained:\n(1)\n\n\u03a3++ (XA , XB ) = \u0168 \u03b4(XA \u2212 XB )\u03b4\u03c3A \u03c3B G++ (XA , XB )\n(1)\n\n\u03a3\u2212\u2212 (XA , XB ) = \u2212\u0168 \u03b4(XA \u2212 XB )\u03b4\u03c3A \u03c3B G\u2212\u2212 (XA , XB )\n(1)\n\n(77)\n\n(1)\n\n\u03a3+\u2212 = \u03a3\u2212+ = 0\nwhere the last line follows from the definition of the CTP tensor cabcd , and shows the wellknown fact that the quasiparticle life-time is infinite in the Hartree approximation.\nOne can proceed similarly for i = 2 to obtain (we omit the calculation since it is completely analogous to the i = 1 case)\n(2)\n\n\u03a3++ (XA , XB ) = \u2212i\u0168 2 \u03b4(XA \u2212 XB )\u03b4\u03c3A \u03c3B [G++ (XA , XB )]3\n(2)\n\n\u03a3\u2212\u2212 (XA , XB ) = \u2212i\u0168 2 \u03b4(XA \u2212 XB )\u03b4\u03c3A \u03c3B [G\u2212\u2212 (XA , XB )]3\n(2)\n\n\u03a3+\u2212 (XA , XB ) = i\u0168 2 \u03b4(XA \u2212 XB )\u03b4\u03c3A \u03c3B [G+\u2212 (XA , XB )]3\n\n(78)\n\n(2)\n\n\u03a3\u2212+ (XA , XB ) = i\u0168 2 \u03b4(XA \u2212 XB )\u03b4\u03c3A \u03c3B [G\u2212+ (XA , XB )]3\nshowing that this approximation includes fluctuation damping since the lesser and greater\ncomponents of the self-energy are nonzero. The full CTP self-energy to order U 2 is then\ngiven by \u03a3(1) + \u03a3(2) .\nAs we have shown in previous sections, the truncation of the loop (U) expansion of\n\u03932 [G] does not violate the external gauge invariance of the full 2PI EA, therefore providing approximate propagator and vertex functions that satisfy the WT hierarchy. We will\nnow discuss, in the context of the 2PI EA description presented in this work, an ad hoc\napproximation known in non-equilibrium perturbation theory applied to transport through\nquantum dots (see Refs. 1,32 and references therein), and show why it does not preserve\ncurrent conservation.\nIn the language of the 2PI EA formalism, the approximation involves two separate steps.\nIn the first one, the quantum correction \u03932 is approximated by the two-loop (O(U)) contri(1)\n\nbution, \u03932 . The O(U 2 ) self-energy is calculated self-consistently either from32 the Hartree\nG+\u2212 (lesser correlation) or by requiring1,33 that the occupation of the central region evaluated with a renormalized \u03a3(1) (but not the Hartree one) equals the one calculated (in the\nnext step) from the propagator dressed with \u03a3(2) . In the second step, \u03a3(2) is calculated from\nEq. (78) but with the full propagator GAB replaced by that calculated from \u03a3(1) in the\n24\n\n\ffirst step. In simpler terms, in this approximation the internal lines in \u03a3(2) are not the full\npropagator, as they are in the 2PI EA approach, but are either the Hartree or a similarly\ncalculated propagator. It is easy to recognize that such approach can not, as it is, produce\ncurrent conserving results in general, since it breaks the variational procedure by which the\nfull propagator is obtained from a single (truncated) functional.\nThe difference between the approximations to the 2PI EA based on a loop truncation and\nthe ad hoc one can be best appreciated by comparing their SD equations. For the truncation\nto three loops we have\n(1)\n\n(2)\n\n\u22121\nG\u22121\nAB = DAB + i\u03a3AB [G] + i\u03a3AB [G]\n\n(79)\n\nwhere we have made explicit that \u03a3(1,2) are functionals of the full CTP propagator GAB ,\ngiven by Eqs. (77) and (78) respectively. For the ad hoc approximation we have instead the\nfollowing system of self-consistent equations:\n(1)\n\n\u22121\n\u22121\ngAB\n= DAB\n+ i\u03a3AB [g] + K\n(1)\n\n(2)\n\n\u22121\n\u22121\ng\u0303AB\n= DAB\n+ i\u03a3AB [g] + i\u03a3AB [g]\n\n(80)\n\ng\u0303+\u2212 (r, t; r, t) = g+\u2212 (r, t; r, t)\nwhere g\u0303 is the O(U 2 ) propagator in this approximation scheme, and K is a source added\nin the calculation of g to enforce the condition expressed in the third line. This condition\ncorresponds to requiring that the level occupation of the central region calculated from g\nand from g\u0303 be equal. Note that if K = 0 then the O(U) propagator, g, becomes the usual\nHartree propagator. The equation of motion for g\u0303 can be cast in a more familiar form1,17\nusing the properties of CTP propagators described in Sec. V. The result is (1 = (r1 , t1 ))\n\ng\u0303+\u2212 (1, 2) =\n\nZ\n\ng\u0303\u2212+ (1, 2) =\n\nZ\n\n(2)\n\nd3d4 g\u0303r (1, 3){\u03a3\u03c6,+\u2212 (3, 4) + \u03a3+\u2212 [g](3, 4)}g\u0303a(4, 2)\n(2)\n\n(81)\n\n(2)\n\n(82)\n\nd3d4 g\u0303r (1, 3){\u03a3\u03c6,\u2212+ (3, 4) + \u03a3\u2212+ [g](3, 4)}g\u0303a(4, 2)\nZ\n,\ng\u0303r (1, 2) = gr (1, 2) + d3d4 gr (1, 3)\u03a3(2)\nr [g](3, 4)g\u0303r (4, 2)\nwhere the retarded O(U 2 ) self-energy is\n(2)\n\n\u03a3(2)\nr (1, 2) = \u03b8(1, 2)[\u03a3+\u2212 (1, 2) \u2212 \u03a3+\u2212 (1, 2)]\n\nand \u03a3\u03c6 is given in Eq. (17). Using that the reservoirs are in equilibrium and non-interacting,\nand that the coupling matrix does not mix CTP branches, i.e. TAB = diag(T, T ), the\n25\n\n\fcomponents of \u03a3\u03c6 in energy-momentum space can be written as\n\u03a3\u03c6,+\u2212 (p) = |T |2 B+\u2212 (p) =\n\nX\nj\n\n2\u03c0i|T |2n(p)\u03b4(p0 \u2212 p2j /2)\n\n\u03a3\u03c6,\u2212+ (p) = |T |2 B\u2212+ (p)\nX\n=\u2212\n2\u03c0i|T |2 [1 \u2212 n(p)]\u03b4(p0 \u2212 p2j /2)\n\n(83)\n\nj\n\nwhere n(p) is Fermi-Dirac function, the momentum index j denote single-particle energy\nlevels, and we have assumed that T (p) = T , independent of p. We note that the term\ndescribing the evolution of initial correlations is absent from Eq. (81), since we are assuming\nthat the system is in a non-equilibrium stationary (or periodic) state mantained by the\nexternal classical field.\nThe equation of motion for the full propagator G has the same structure as the one for\ng\u0303, with the following replacements\ng\u0303+\u2212 , g\u0303\u2212+ , g\u0303r \u2192 G+\u2212 , G\u2212+ , Gr\n(2)\n\n(2)\n\n\u03a3+\u2212 [g], \u03a3\u2212+ [g], \u03a3(2)\nr [g] \u2192 \u03a3+\u2212 [G], \u03a3\u2212+ [G], \u03a3r [G]\ng r \u2192 Dr\n\n(84)\n\n.\n\nWe will now consider the expectation value of the electronic current in the ad hoc approximation discussed so far. As emphasized in Sec. II, the WT hierarchy given in Eq. (1)\nis a direct consequence of the equations of motion satisfied by the exact propagators. This\ncan be shown quite simply by noting that the (n + 1)\u2212point vertex function \u039b\u03bc(n) , defined\nin Eq. (2), can be rewritten in terms of the operator D \u03bc (z, z \u2032 ), defined in Eq. (5):\n\u039b\u03bc(n) (1 . . . n, 1\u2032 . . . n\u2032 ; z) =\n\u2212 ei(n+1) lim\nD \u03bc (z, z \u2032 )G(n+1) (1 . . . nz, 1\u2032 . . . n\u2032 z \u2032 )\n\u2032\nz \u2192z\n\n.\n\n(85)\n\nThe divergence of \u039b\u03bc(n) will therefore be given by the divergence of the operator D \u03bc (z, z \u2032 ),\nwhich follows immedeately from its definition. The result is\n\n\u2202\u03bc \u039b\u03bc(n) (1 . . . n, 1\u2032 . . . n\u2032 ; z) =\n\b\n1 2\n(\u2207 \u2212 \u22072z \u2032 ) \u2212 Ai (z) + Ai (z \u2032 )]G(n+1) (1 . . . z; 1\u2032 . . . z \u2032 ) =\n)\n+\n+\n\u2202\n[i(\u2202\nin e lim\nt\nt\n\u2032\nz\nz\nz \u2032 \u2192z\n2 z\n\nin e lim\n\u03b6(z, z \u2032 )G(n+1) (1 . . . z; 1\u2032 . . . z \u2032 )\n\u2032\nz \u2192z\n\n.\n26\n\n(86)\n\n\fThis equation shows that the divergence of the expectation value of the four-current j \u03bc (z),\nthat corresponds to n = 0, is directly given by the action of the differential operator \u03b6(z, z \u2032 )\nacting on G(1) (z, z \u2032 ) = G(z, z \u2032 ). Using Heisenberg's equation of motion for the field operators\n\u03c8, \u03c8 \u2020 it is easy to show12,15 that the exact propagator satisfy two differential equations\n\n[i\u2202tz +\n[\u2212i\u2202tz\u2032 +\n\n\u22072z\n\n\u22072z \u2032\n\n\u2032\n\n\u2032\n\nZ\n\n\u2032\n\n\u2032\n\nZ\n\n\u2212 Ai (z)]G(z, z ) = \u03b4(z, z ) \u2212 i\n\u2032\n\n\u2212 Ai (z )]G(z, z ) = \u03b4(z, z ) \u2212 i\n\nd1 U(z, 1)G2 (z1, z \u2032 1+ )\n(87)\n\u2032\n\n\u2212\n\n\u2032\n\nd1 U(1, z )G2 (z1 , z 1)\n\nthat, when substracted, result in\nlim \u03b6(z, z \u2032 )G(1 . . . z; 1\u2032 . . . z \u2032 ) = 0\n\nz \u2032 \u2192z\n\n,\n\n(88)\n\nwhereby \u2202\u03bc < j \u03bc (z) >= 0 in the exact theory.\nIn an approximate theory, the quantity \u2212iUG2 appearing in Eq. (87) is replaced by the\nproduct \u03a3G, and so the conservation of current at the expectation value is not immedeately\nguaranteed. It is well-known2,14,16,23 that \u03a6\u2212derivable approximations are such that \u2202\u03bc <\nj \u03bc (z) >= 0. As we have shown in previous sections, the approximations to the 2PI EA\nbased on truncations of the loop expansion guarantee not only this condition but the entire\nWT hierarchy (order by order in the expansion of G with respect to the external driving\nfield).\nThe approximation defined by Eq. (80) can not be derived from a loop-truncated effective\naction, and hence Eq. (88) is not expected to hold. To end up this section, we will briefly\nshow how large is the divergence of the current expectation value in the ad hoc approximation. From Eq. (87) we have that, for an approximation based on a truncation of the loop\nexpansion of the 2PI EA, the following identity holds:\nlim \u03b6(z, z \u2032 )G(z, z \u2032 ) =\nZ\nd1 {G(z, 1)\u03a3(2) [G](1, z) \u2212 \u03a3(2) [G](z, 1)G(1, z)} = 0\nz \u2032 \u2192z\n\n(89)\n\nwhere we note that the Hartree part of the self-energy, \u03a3(1) [G], can be included in the left\nhand side of Eq. (87) as an extra single-particle term, and, being local, its difference vanishes\nwhen z \u2032 \u2192 z. Therefore, in Eq. (89) we only need to consider \u03a3(2) . Putting G = g\u0303 + G\u0303\nand \u03a3(2) [G] = \u03a3(2) [g] + \u039e in Eq. (89), and neglecting terms proportional to G\u0303 and \u039e, we\n27\n\n\fimmedeately obtain\n\u2202\u03bc < j\u0303 \u03bc (z) >=\nZ\ne d1 {g\u0303(z, 1)\u03a3(2) [g](1, z) \u2212 \u03a3(2) [g](z, 1)g\u0303(1, z)}\n\n(90)\n\nwhere j\u0303 denotes the current calculated in the ad hoc approximation. Since g\u0303, \u03a3(2) [g] \u223c O(U 2 ),\nwe conclude that the violation of current conservation in the mean is O(U 4 ) or higher.\n\nTo conclude, we note that the combination of Eqs. (86) and (89) constitute a useful way\nof checking that a given approximation is conserving in the mean, and may provide some\ninsight in the search of conserving approximations not based on loop-truncations. As we\nhave shown, it also provides a way of calculating an upper bound to the violation of mean\ncurrent conservation.\n\nVII.\n\nCONCLUSIONS\n\nIn this work, we have determined the basic requirements that an approximation to a\nnon-equilibrium many-body problem in an open and driven fermionic system must satisfy in\norder to achieve current conservation beyond the expectation value level. One of the most\nimportant results of this work is the close relation found between nonlinear response theory\nand the Ward-Takahashi hierarchy, necessary for current conservation. This connection,\nalthough already known7,8,9,10,11,14,15 , was clearly displayed by using the closed-time path twoparticle irreducible coarse-grained effective action to describe the central electrons coupled\nto ideal reservoirs.\nWe have shown that the gauge invariance of the 2PI effective action with respect to transformations of the external classical field driving the system automatically implies the WT\nhierarchy among the propagator and vertex functions calculated from the effective action.\nMore importantly for practical calculations, for every approximation to the 2PI effective\naction that results from truncating its loop expansion, the closed-time path propagator (obtained from the Schwinger-Dyson equation) and the the vertex functions (obtained from the\nBethe-Salpeter equations) are such that the WT hierarchy holds.\nUsing a simple example, we have also discussed, in the context of the 2PI effective action\nformalism, the relation between ad hoc approximations (not obtained from a truncation of\nthe loop expansion) and current conservation. Using a general expression for the divergence\n28\n\n\fof the mean current, we have shown that in the ad hoc approximation considered current\nconservation at the expectation value level is violated at O(U 4 ) or even at higher order.\nIn summary, we hope to have shown that closed-time path 2PI effective action techniques\nare a powerful and systematic method to study the nonlinear response in strongly correlated\nopen systems in weak external fields, in a current-conserving way. We also hope to have\nshown the necessity, within the EA approach, of using loop-truncated approximations to\nthe 2PI EA when going beyond the linear response regime. Our results may be of use in\nthe theoretical study of quantum transport through interacting electronic pumping devices,\nwhich are nowadays receiving much attention.\n\nAcknowledgments\n\nWe acknowledge Liliana Arrachea, Carlos Na\u00f3n, Alfredo Levy Yeyati and Sergio Ulloa\nfor useful discussions. This work has been supported in part by ANPCyT, CONICET and\nUBA (Argentina).\n\n\u2217\n\nElectronic address: jperalta@df.uba.ar\n\n\u2020\n\nElectronic address: calzetta@df.uba.ar\n\n1\n\nL. Arrachea, A. L. Yeyati, and A. Martin-Rodero, Phys. Rev. B 77, 165326 (2008); D. Fioretto,\nand A. Silva, Phys. Rev. Lett. 100, 236803 (2008).\n\n2\n\nE. Calzetta and B.-L. Hu, Nonequilibrium Quantum Field Theory (Cambridge University Press,\nCambridge, 2008) and references therein.\n\n3\n\nE. Calzetta, and B.-L. Hu, Phys. Rev. D 37, 2878 (1988).\n\n4\n\nE. Calzetta, arXiv: 0810.3239 [hep-ph] (unpublished).\n\n5\n\nE. Calzetta, and B.-L. Hu, Correlations, decoherence, dissipation and noise in quantum field\ntheory, in Heat Kernel Techniques and Quantum Gravity, edited by S. Fulling (Texas A&M\nPress, College Station, 1995).\n\n6\n\nE. Calzetta, Int. J. Theor. Phys. 43, 767 (2004).\n\n7\n\nN. E. Dahlen, and R. van Leeuwen, Phys. Rev. Lett. 98, 153004 (2007).\n\n8\n\nN.-H. Kwong, and M. Bonitz, Phys. Rev. Lett. 84, 1768 (2000).\n\n29\n\n\f9\n\nP. My\u00f6h\u00e4nen, A. Stan, G. Stefanucci, and R. van Leeuwen, Europhys. Lett. 84, 67001 (2008).\n\n10\n\nB. Velick\u00fd, A. Kalvov\u00e1, and V. Spicka, Phys. Rev. B 77, 041201 (2008).\n\n11\n\nK. S. Thygesen, and A. Rubio, Phys. Rev. B 77, 115333 (2008).\n\n12\n\nN. Rivier, and D. G. Pelka, Il Nuovo Cimento 7B, 1 (1972).\n\n13\n\nM. Revzen, T. Toyoda, Y. Takahashi, and F. C. Khanna, Phys. Rev. B 40, 769.\n\n14\n\nG. Baym, Phys. Rev. 127, 1391 (1962).\n\n15\n\nG. Baym, and L. P. Kadanoff, Phys. Rev. 124, 287 (1961); L. Kadanoff, G. Baym, Quantum\nStatistical Mechanics (Benjamin, California, 1962).\n\n16\n\nJ. M. Luttinger, and J. C. Ward, Phys. Rev. 118, 1417 (1960); C. De Dominicis, and P. C.\nMartin, J. Math. Phys. 5, 14 and 31 (1964).\n\n17\n\nJ. Schwinger, J. Math. Phys. 2, 407 (1961); L. V. Keldysh, Soviet Physics JETP 20, 1018\n(1965).\n\n18\n\nK.-C. Chou, Z.-B. Su, B.-L. Hao, and L. Yu, Phys. Rep. 118, 1 (1985).\n\n19\n\nJ. Rammer, Quantum Field Theory of Non-equilibrium States (Cambridge University Press,\nCambridge, 2007).\n\n20\n\nR. Kobes, Phys. Rev. B 45, 3230 (1992).\n\n21\n\nJ. C. Ward, Phys. Rev. 78, 182 (1950); Y. Takahashi, Il Nuovo Cimento 6, 371 (1957).\n\n22\n\nN. J. Morgenstern Horing, and H.-L. Cui, Phys. Rev. B 38, 10907 (1988).\n\n23\n\nY. B. Ivanov, J. Knoll, and D. N. Voskresensky, Nucl. Phys. A 657, 413 (1999).\n\n24\n\nH. van Hees, and J. Knoll, Phys. Rev. D 66, 025028 (2002).\n\n25\n\nU. Reinosa, and J. Serreau, arXiv: 0810.4883 [hep-th] (unpublished); U. Reinosa, and J. Serreau,\nJ. High Energy Phys. 11, 97 (2007).\n\n26\n\nJ. Berges, Phys. Rev. D 70, 105010 (2004).\n\n27\n\nM. Carrington, and E. Kovalchuk, Phys. Rev. D 76, 045019 (2007).\n\n28\n\nM. Bando, M. Harada, and T. Kugo, Prog. Theor. Phys. 91, 927 (1994).\n\n29\n\nY. Zhang, and Q. Wang, Chin. Phys. Lett. 25, 1227 (2008).\n\n30\n\nB. DeWitt, Dynamical theory of groups and fields, in Relativity, Groups and Topology, edited\nby C. DeWitt and B. DeWitt (Gordon and Breach, New York, 1964).\n\n31\n\nE. Wang, and U. Heinz, Phys. Rev. D 66, 025008 (2002).\n\n32\n\nS. Hershfield, J. H. Davies, and J. W. Wilkins, Phys. Rev. B 46, 7046 (1992).\n\n33\n\nA. L. Yeyati, A. Martin-Rodero, and F. Flores, Phys. Rev. Lett. 71, 2991 (1993).\n\n30\n\n\f34\n\nOf course, no conflict arises for non-interacting particles, since in that case the lifetime of field\nexcitations is infinite. See Ref. 22 for a discussion of second order response theory in noninteracting systems.\n\n35\n\nWe refer to approaches to solve the problem that still belong to the two-particle irreducible\nclass. Of course, one could in principle solve the problem of local symmetries (WT identities)\nby treating the dynamics of higher order correlations. This would require n-particle irreducible\neffective actions, with n > 2 (see Refs. 4 and 26). However, we think that the relation between\nnonlinear response and current conservation is clearly appreciated in the 2PI formalism, which\nis also technically feasible as compared to n > 2 effective actions. It remains to be investigated\nthe possibility of relating higher order response functions (and the response of higher order\ncorrelations) to higher order effective actions in the n-particle hierarchy.\n\n36\n\nThe causality of the response functions is easily proved in the physical representation, and\nfollows directly from the structure of the generating functional of CTP correlation functions.\n\n31\n\n\f"}