{"id": "http://arxiv.org/abs/1003.3576v2", "guidislink": true, "updated": "2011-02-18T11:43:57Z", "updated_parsed": [2011, 2, 18, 11, 43, 57, 4, 49, 0], "published": "2010-03-18T13:07:46Z", "published_parsed": [2010, 3, 18, 13, 7, 46, 3, 77, 0], "title": "Combinatorial problems in finite fields and Sidon sets", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1003.1933%2C1003.0302%2C1003.3321%2C1003.2696%2C1003.4291%2C1003.1482%2C1003.6052%2C1003.2118%2C1003.3963%2C1003.1460%2C1003.1675%2C1003.5427%2C1003.3809%2C1003.5134%2C1003.3145%2C1003.1806%2C1003.6041%2C1003.2671%2C1003.1100%2C1003.3214%2C1003.6045%2C1003.1844%2C1003.2736%2C1003.6132%2C1003.0072%2C1003.0481%2C1003.2938%2C1003.5701%2C1003.2334%2C1003.3526%2C1003.4099%2C1003.3141%2C1003.1916%2C1003.4607%2C1003.3574%2C1003.4514%2C1003.1028%2C1003.5082%2C1003.5177%2C1003.1415%2C1003.2867%2C1003.4380%2C1003.4616%2C1003.2552%2C1003.3876%2C1003.4998%2C1003.5378%2C1003.5492%2C1003.4166%2C1003.3572%2C1003.3086%2C1003.1425%2C1003.3378%2C1003.6126%2C1003.1032%2C1003.2062%2C1003.3156%2C1003.3631%2C1003.3891%2C1003.5152%2C1003.3237%2C1003.5740%2C1003.5693%2C1003.1140%2C1003.0086%2C1003.2283%2C1003.5336%2C1003.5197%2C1003.3530%2C1003.1324%2C1003.3576%2C1003.0873%2C1003.0068%2C1003.0057%2C1003.1006%2C1003.2172%2C1003.4883%2C1003.0829%2C1003.0752%2C1003.2734%2C1003.5892%2C1003.5180%2C1003.2002%2C1003.1594%2C1003.4845%2C1003.4444%2C1003.2471%2C1003.1303%2C1003.3343%2C1003.2622%2C1003.2217%2C1003.0479%2C1003.0424%2C1003.0608%2C1003.1193%2C1003.5636%2C1003.0344%2C1003.0681%2C1003.1912%2C1003.4126%2C1003.5155&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Combinatorial problems in finite fields and Sidon sets"}, "summary": "We use Sidon sets to present an elementary method to study some combinatorial\nproblems in finite fields, such as sum product estimates, solubility of some\nequations and distribution of sequences in small intervals. We obtain classic\nand more recent results avoiding the use of exponential sums, the usual tool to\ndeal with these problems.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1003.1933%2C1003.0302%2C1003.3321%2C1003.2696%2C1003.4291%2C1003.1482%2C1003.6052%2C1003.2118%2C1003.3963%2C1003.1460%2C1003.1675%2C1003.5427%2C1003.3809%2C1003.5134%2C1003.3145%2C1003.1806%2C1003.6041%2C1003.2671%2C1003.1100%2C1003.3214%2C1003.6045%2C1003.1844%2C1003.2736%2C1003.6132%2C1003.0072%2C1003.0481%2C1003.2938%2C1003.5701%2C1003.2334%2C1003.3526%2C1003.4099%2C1003.3141%2C1003.1916%2C1003.4607%2C1003.3574%2C1003.4514%2C1003.1028%2C1003.5082%2C1003.5177%2C1003.1415%2C1003.2867%2C1003.4380%2C1003.4616%2C1003.2552%2C1003.3876%2C1003.4998%2C1003.5378%2C1003.5492%2C1003.4166%2C1003.3572%2C1003.3086%2C1003.1425%2C1003.3378%2C1003.6126%2C1003.1032%2C1003.2062%2C1003.3156%2C1003.3631%2C1003.3891%2C1003.5152%2C1003.3237%2C1003.5740%2C1003.5693%2C1003.1140%2C1003.0086%2C1003.2283%2C1003.5336%2C1003.5197%2C1003.3530%2C1003.1324%2C1003.3576%2C1003.0873%2C1003.0068%2C1003.0057%2C1003.1006%2C1003.2172%2C1003.4883%2C1003.0829%2C1003.0752%2C1003.2734%2C1003.5892%2C1003.5180%2C1003.2002%2C1003.1594%2C1003.4845%2C1003.4444%2C1003.2471%2C1003.1303%2C1003.3343%2C1003.2622%2C1003.2217%2C1003.0479%2C1003.0424%2C1003.0608%2C1003.1193%2C1003.5636%2C1003.0344%2C1003.0681%2C1003.1912%2C1003.4126%2C1003.5155&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We use Sidon sets to present an elementary method to study some combinatorial\nproblems in finite fields, such as sum product estimates, solubility of some\nequations and distribution of sequences in small intervals. We obtain classic\nand more recent results avoiding the use of exponential sums, the usual tool to\ndeal with these problems."}, "authors": ["Javier Cilleruelo"], "author_detail": {"name": "Javier Cilleruelo"}, "author": "Javier Cilleruelo", "arxiv_comment": "13 pages", "links": [{"href": "http://arxiv.org/abs/1003.3576v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1003.3576v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11B30", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1003.3576v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1003.3576v2", "journal_reference": null, "doi": null, "fulltext": "COMBINATORIAL PROBLEMS IN FINITE FIELDS AND\nSIDON SETS\n\narXiv:1003.3576v2 [math.NT] 18 Feb 2011\n\nJAVIER CILLERUELO\nAbstract. We use Sidon sets to present an elementary method to study some\ncombinatorial problems in finite fields, such as sum product estimates, solubility of some equations and distribution of sequences in small intervals. We\nobtain classic and more recent results avoiding the use of exponential sums,\nthe usual tool to deal with these problems.\n\n1. Introduction\nThe aim of the present work is to introduce a new elementary method to\nstudy a class of combinatorial problems in finite fields: incidence problems, sumproduct estimates, solubility of some equations, distribution of sequences in small\nintervals, etc.\nThe main tool in our approach are Sidon sets, which are important objects in\ncombinatorial number theory.\nIn Section \u00a72 we present Theorem 2.1, which is a new result about Sidon sets\nand the main tool in our method. To illustrate how this method works, we include\nin this section two easy application of this theorem. The first one recovers a result\nof Vinh [15] about the number of incidences between P points\n\u221a and L lines in a\nfield Fq . The second one proves that if A = {g x : 0 \u2264 x \u2264 ( 2 + o(1))p3/4 } and\ng is a primitive root modulo p, then A \u2212 A = Zp . This improves previous results\nobtained by Garaev-Kueh[4], Konyagin[9] and Garc\u0131\u0301a[6].\nSection \u00a73 is devoted to sum-product estimates. Garaev [2] used\npcharacter2 sums\n\u221a\nto give the nontrivial lower estimate max(|A+A|, |AA|) \u226b min( |A|q, |A| / q).\nTheorem 3.1, which is an easy consequence of Theorem 2.1, gives a nontrivial\nupper bound for the number of elements of a dense Sidon set in an arbitrary\nset B when |B + B| is small. We use this upper bound to give a quick proof of\nGaraev's estimate and related results.\nS\u00e1rk\u0151zy [11, 12] proved the solubility of the equations x1 x2 + x3 x4 = 1 and\nx1 x2 = x3 + x4 , xi \u2208 Ai for arbitrary sets Ai \u2282 Fp when |A1 ||A2||A3 ||A4 | \u226b p3 .\nThis result was extended to any field Fq in [7]. The proof is based in estimates\nof exponential sums and they asked for an elementary algebraic proof of the\nsolubility of these equations (problem 3 of [1]). Our method provides a proof\n1\n\n\f2\n\nJAVIER CILLERUELO\n\nof this kind. Actually, Sark\u0151zy's equations are special cases of more general\nequations which we study in section \u00a74.\nIn section \u00a75, we apply our method to study the distribution of some sequences\nin Zp . As an example we prove that if g is a primitive root modulo p, then for\nany intervals I, J and any positive integer r we have\n\u0010\u0010 |I||J| \u00111/r\n\u0011\u221a\n|I||J|\nx\ny\n|{(x, y) \u2208 I \u00d7 J : g \u2212 g \u2261 1 (mod p)}| =\n+ \u03b8r\n+ 1 p,\np\np3/2\n\nwith |\u03b8r | \u2264 4r . The error term is smaller than the error term obtained by Garaev\n[3].\n2. Sidon sets\nLet G be a finite abelian group. For any sets A, B \u2282 G and x \u2208 G, we write\nrA\u2212B (x) for the number of representations of x = a \u2212 b, a \u2208 A, b \u2208 B. We have\nthe well known identities\nX\n(2.1)\nrA\u2212B (x) = |A||B|,\nx\u2208G\n\nX\n\n(2.2)\n\n2\nrA\u2212B\n(x) =\n\nx\u2208G\n\nX\n\nrA\u2212A (x)rB\u2212B (x).\n\nx\u2208G\n\nDefinition 1. We say that a set A \u2282 G is a Sidon set if rA\u2212A (x) \u2264 1 whenever\nx 6= 0.\n\u2032\nBy counting the\np number of differences a \u2212 a , we can see that if A is a Sidon\nset, then |A| < |G| + 1/2. The most\np interesting Sidon sets are those which\nhave large cardinality, that is, |A| = |G| \u2212 \u03b4 where \u03b4 is a small number. We\nstate our main theorem.\n\nTheorem\n2.1. Let A be a Sidon set in a finite abelian group G with |A| =\np\n|G| \u2212 \u03b4. Then, for all B, B \u2032 \u2282 G we have\n|{(b, b\u2032 ) \u2208 B \u00d7 B \u2032 , b + b\u2032 \u2208 A}| =\n\nwith |\u03b8| < 1 +\n\n|B|\n|G|\n\n|A|\n|B||B \u2032 | + \u03b8(|B||B \u2032 |)1/2 |G|1/4 ,\n|G|\n\nmax(0, \u03b4).\n\nProof. Since A is a Sidon set,\nX\nX\nrB\u2212B (x)rA\u2212A (x) = |A||B| +\nrB\u2212B (x)rA\u2212A (x)\nx\u2208G\n\nx6=0\n\n\u2264 |A||B| +\n\nX\nx6=0\n\nrB\u2212B (x) = |A||B| + |B|2 \u2212 |B|.\n\n\fCOMBINATORIAL PROBLEMS IN FINITE FIELDS AND SIDON SETS\n\n3\n\nUsing this inequality and identities (2.1) and (2.2) we have\n\u00132 X\nX\u0012\n|A|2 |B|2\n|A||B|\n(2.3)\n=\nrB\u2212B (x)rA\u2212A (x) \u2212\nrA\u2212B (x) \u2212\n|G|\n|G|\nx\u2208G\nx\u2208G\n\u2264 |B|(|A| \u2212 1) + |B|2\nWe observe that\n\n|G| \u2212 |A|2\n.\n|G|\n\n\u0013\nX\u0012\n|B||B \u2032 ||A|\n|A||B|\n\u2032\n|{(b, b ) \u2208 B \u00d7 B , b + b \u2208 A}| \u2212\n.\n=\nrA\u2212B (b ) \u2212\n|G|\n|G|\n\u2032\n\u2032\n\u2032\n\n\u2032\n\n\u2032\n\nb \u2208B\n\nApplying the Cauchy-Schwarz inequality, taking (2.3) and |A| = |G|1/2 \u2212 \u03b4 into\naccount we obtain\n\u00132\n\u0012\n\u0013\n2\nX\u0012\n|A||B|\n\u2032\n\u2032\n2 |G| \u2212 |A|\nrA\u2212B (b ) \u2212\n\u2264 |B | |B|(|A| \u2212 1) + |B|\n|G|\n|G|\n\u2032\n\u2032\nb \u2208B\n\u0013\n\u0012\n\u03b4(2|G|1/2 \u2212 \u03b4)\n\u2032\n1/2\n= |B ||B| |G| \u2212 \u03b4 \u2212 1 + |B|\n|G|\n\u0012\n\u0013\n|B|\n< |B||B \u2032 ||G|1/2 1 + 2 max(0, \u03b4)\n.\n|G|\n\u0003\nThe Sidon sets we will consider in applications satisfy \u03b4 \u2264 1 and |B| = o(|G|).\nIn these cases we have |\u03b8| \u2264 1 + o(1).\n2.1. Examples of dense Sidon sets. The three families of Sidon sets we will\ndescribe next, have maximal cardinality in their ambient group G. Let g be a\ngenerator of F\u2217q .\nExample 1. Let p(x), r(x) \u2208 Fq [X] be polynomials of degree \u2264 2 such that p(x)\u2212\n\u03bcr(x) is not a constant for any \u03bc \u2208 Fq . The set\nA = {(p(x), r(x)) : x \u2208 Fq }\n\nis a Sidon set in Fq \u00d7 Fq . In particular, the set A = {(x, x2 ) : x \u2208 Fq } is a Sidon\nset.\nWe have to check that when (e1 , e2 ) 6= (0, 0) the relation (p(x1 ), r(x1 )) \u2212\n(p(x2 ), r(x2 )) = (e1 , e2 ) uniquely determines x1 and x2 . If p(x) is linear then from\np(x1 ) \u2212 p(x2 ) = e1 we obtain x1 = x2 + \u03bb for some \u03bb. Thus, r(x2 + \u03bb) \u2212 r(x2 ) = e2\nis a linear equation and we obtain x2 and then x1 . If p(x) is quadratic we consider\n\u03bc such that p(x) \u2212 \u03bcr(x) is a linear polynomial and we proceed as above.\n\n\f4\n\nJAVIER CILLERUELO\n\nExample 2. For any generator g of F\u2217q , the set\nA = {(x, g x ) : x \u2208 Zq\u22121 }\n\n(2.4)\n\nis a Sidon set in Zq\u22121 \u00d7 Fq .\n\nSometimes we will describe this set as A = {(log x, x) : x \u2208 F\u2217q } where log x =\nlogg x is the discrete logarithm.\n\nFrom (x1 , g x1 ) \u2212 (x2 , g x2 ) = (e1 , e2 ) 6= (0, 0) we have x1 \u2212 x2 \u2261 e1 (mod q \u2212 1)\nand hence g x1 = g e1+x2 . Putting this in g x1 \u2212 g x2 = e2 we get g x2 (g e1 \u2212 1) = e2 .\n\nIf e1 = 0 then e2 = 0, but we have assumed that (e1 , e2 ) 6= (0, 0). If e1 6= 0 the\nlast equality determines x2 , and then x1 .\nExample 3. For any pair of generators g1 , g2 of F\u2217q , the set\nA = {(x, y) \u2208 Zq\u22121 \u00d7 Zq\u22121 : g1x + g2y = 1}\n\n(2.5)\n\nis a Sidon set in Zq\u22121 \u00d7 Zq\u22121 . Since translations preserve Sidoness property, for\nany \u03bb 6= 0, the sets A = {(x, y) : g1x + g2y = \u03bb} and A = {(x, y) : g1x \u2212 g2y = \u03bb}\nare also Sidon sets.\nTo see that A is a Sidon set we have to prove that if (e1 , e2 ) 6= (0, 0) then\nthe equation (x1 , y1) \u2212 (x2 , y2 ) = (e1 , e2 ) determines x1 , x2 under the conditions\ng1x1 + g2y1 = g1x2 + g2y2 = 1 in Fq . We observe that x1 \u2212 x2 \u2261 e1 (mod (q \u2212 1)) and\ny1 \u2212 y2 \u2261 e2 (mod (q \u2212 1)) imply that g1x1 = g1x2 +e1 and g2y1 = g2y2+e2 in Fq and\nwe obtain g1x2+e1 + g2y2+e2 = g1x2 + g2y2 = 1 in Fq . Thus g2y2 (g2e2 \u2212 g1e1 ) = 1 \u2212 g1e1 . If\ne1 6= 0 and g2e2 6= g1e1 we obtain y2 and then x2 , x1 and y1 . If e1 = 0 or g2e2 = g1e1 ,\nthe equation has not solutions unless (e1 , e2 ) = (0, 0).\nWhen q = p is a prime number we can identify Fp with Zp . We ilustrate in the\npictures below the three examples of Sidon sets described above.\nr\n\nr\n\nr\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nrr\n\nr\n\nr\nr\n\nr\nr\n\nr\nr r\n\nZp\n\nr r\n\nr\n\nr r\n\nZp\n\nr\nr\nr\n\nZp\u22121 r\n\nr\nrr\n\nr\nr\n\nr\n\nr\n\nr\n\nr\nr\n\nr\n\nr\n\nrr\n\nr\n\nZp\nExample 1\n\nr\nr\n\nr\n\nZp\u22121\nExample 2\n\nZp\u22121\nExample 3\n\nThe Sidon sets given in examples, with q, q \u2212 1 and q \u2212 2 elements respectively,\nhave maximal cardinality in their ambient groups. The values of \u03b4 = |G|1/2 \u2212 |A|\nare \u03b4 = 0, 1/2 \u2212 o(1) and 1 respectively. We finish this section with two easy\napplications of Theorem 2.1.\n\n\fCOMBINATORIAL PROBLEMS IN FINITE FIELDS AND SIDON SETS\n\n5\n\n2.2. Incidence of lines and points in Fq \u00d7 Fq . Let I(P, L) = |{(p, l) \u2208 P \u00d7 L :\np \u2208 L}| be the number of incidences between a set P of points and set L of lines\nin Fq \u00d7 Fq , that is\n\nI(P, L) = |{(p, l) \u2208 P \u00d7 L : p \u2208 l}| .\np\nVinh [15] proved that I(P, L) \u2264 |P p||L| + O( |P ||L|p). We recover this result as a\nstraightforward consequence of Theorem 2.1.\n\nTheorem 2.2. Let L be a set of lines and let P be a set of points in Fq \u00d7 Fq .\nThe following asymptotic formula holds:\np\n|P ||L|\n(2.6)\nI(P, L) =\n+ O( |P ||L|q).\nq\n\nProof. Let L = {y = \u03bbi x + \u03bci : 1 \u2264 i \u2264 |L|} and P = {(pj , qj ) : 1 \u2264 j \u2264 |P |}.\nWe consider the set A = {(log x, x)} described in (2) and the sets\nB = {(log \u03bbi , \u2212\u03bci ) : 1 \u2264 i \u2264 |L|},\n\nB \u2032 = {(log pj , qj ) : 1 \u2264 j \u2264 |P |}.\n\nWe observe that each incidence corresponds to a solution of \u03bbi pj = qj \u2212 \u03bci and\nthe number of solutions of this equation is |{(b, b\u2032 ) \u2208 B \u00d7 B \u2032 : b + b\u2032 \u2208 A}|. The\nresult follows in view of Theorem 2.1.\n\u0003\n2.3. The difference set {g x \u2212 g y : 0, \u2264 x, y \u2264 L}. Let g be a primite root\nmodulo p. Many authors have studied the problem of determining the smallest\nnumber M such that {g x \u2212 g y : 0 \u2264 x, y \u2264 M} = Zp .\n\nFrom the result of Rudnick and Zaharescu [10] it follows that one can take any\ninteger M \u2265 c0 p3/4 log p where c0 is a suitable constant. This range has been\nimproved to M > cp3/4 by Garaev and Kueh [4] and independently by Konyagin\n[9]. The best known admissible value for the constant c has been c = 25/4 due to\nGarc\u0131\u0301a [6]. Our approach improves this further to the following statement.\nTheorem 2.3. Let g be a generator of F\u2217p . For any \u01eb > 0 and p > p(\u01eb) we have\nn\no\n\u221a\ng x \u2212 g y : 0 \u2264 x, y < ( 2 + \u01eb)p3/4 = Fp .\n\nProof. Suppose \u03bb 6\u2208 {g x \u2212 g y : 0 \u2264 x, y \u2264 L} and consider in G = Zp\u22121 \u00d7 Zp\u22121\nthe Sidon set A = {(x, y) : g x \u2212 g y = \u03bb}. We observe that\np\u22121 p\u22121\n(x, y) \u2208 A \u21d0\u21d2 (y, x) + (\n,\n) \u2208 A.\n2\n2\n\u0001\n\b\n, p\u22121\nthen b + b\u2032 6\u2208 A.\nThus, it is clear that if b, b\u2032 \u2208 B = [0, L/2]2 + (0, 0), p\u22121\n2\n2\nIn other words, |{(b, b\u2032 ) \u2208 B \u00d7 B, b + b\u2032 \u2208 A}| = 0.\nOn the other hand, Theorem 2.1 implies that\n|B| \u0011\n|A||B|2 \u0010\n|B||G|1/4 .\n\u2212 1+\n0 = |{(b, b\u2032 ) \u2208 B \u00d7 B, b + b\u2032 \u2208 A}| \u2265\n|G|\n|G|\n\n\f6\n\nJAVIER CILLERUELO\n\nThus\n\n|G|5/4\n(p \u2212 1)5/2\n=\n< p3/2 (1 + o(1))\n|A| \u2212 |G|1/4\np \u2212 2 \u2212 (p \u2212 1)1/2\nand the theorem follows in view of |B| = 2(1 + [L/2])2 .\n|B| \u2264\n\n\u0003\n\n3. Sum-product estimates\nWe will deduce some sum-product estimates form the following lemma.\nLemma 3.1. Let A be a Sidon set in G with |A| = |G|1/2 \u2212 \u03b4. For any subsets\nB, B \u2032 \u2282 G we have\n\u00131/2\n\u0012\n|B + B \u2032 ||A|\n|B + B \u2032 |\n|A \u2229 B| \u2264\n|G|1/4 ,\n+\u03b8\n|G|\n|B \u2032 |\n\u2032\n\n|\n.\nfor some \u03b8 with |\u03b8| \u2264 1 + max(0, \u03b4) |B\n|G|\n\nProof. Indeed, by Theorem 2.1,\n|B \u2032 ||A \u2229 B| = |{(\u2212b\u2032 , b + b\u2032 ) : b \u2208 B,\n\nb\u2032 \u2208 B \u2032 , \u2212b\u2032 + (b + b\u2032 ) \u2208 A}|\n\n\u2264 {(b\u2032 , b\u2032\u2032 ) : b\u2032 \u2208 (\u2212B \u2032 ) \u00d7 (B + B \u2032 ), b\u2032 + b\u2032\u2032 \u2208 A}|\np\n|A||B \u2032||B + B \u2032 |\n+ \u03b8 |B \u2032 ||B + B \u2032 ||G|1/4\n\u2264\n|G|\n\u2032\n\n|\nwhere |\u03b8| \u2264 1 + max(0, \u03b4) |B\n. The lemma follows.\n|G|\n\n\u0003\n\nTheorem 3.1 (Garaev [2]). Let A1 , A2 \u2282 F\u2217q and A3 \u2282 Fq . We have\n\u0011\n\u0010p\np\n2\n|A1 |q, |A1 | |A2 ||A3 |/q .\n(3.1)\nmax(|A1 A2 |, |A1 + A3 |) \u226b min\n\nProof. We consider the Sidon set A = {(log x, x) : x \u2208 F\u2217q } described in example\n2 and the sets B = (log A1 ) \u00d7 A1 and B \u2032 = (log A2 ) \u00d7 A3 . Since all the elements\n(log a1 , a1 ) are in A we have that |A \u2229 B| = |A1 |. On the other hand we observe\nthat |B + B \u2032 | = |A1 A2 ||A1 + A3 |. Lemma 3.1 implies the inequality\ns\n|A1 A2 ||A1 + A3 |\n|A1 A1 ||A1 + A3 |\n|A1 | \u2264\n+\u03b8 q\n,\n|\u03b8| \u2264 1,\nq\n|A2 ||A3 |\n\nwhich in turn implies (3.1).\nWe can mimic this proof to get the following sum-product estimates.\nTheorem 3.2 (Garaev-Shen [5]). Let A1 , A2 , A3 \u2282 F\u2217q . We have\n\u0010p\n\u0011\np\nmax(|(A1 + 1)A2 |, |A1 A3 |) \u226b min\n|A1 |q, |A1 |2 |A2 ||A3 |/q .\n\n\u0003\n\n\fCOMBINATORIAL PROBLEMS IN FINITE FIELDS AND SIDON SETS\n\n7\n\nProof. We consider the Sidon set A = {(x, y) : g x \u2212 g y = 1}, the sets B =\nlog(A1 + 1) \u00d7 log A1 and B \u2032 = log A2 \u00d7 log A3 and proceed as in the proof of\nTheorem 3.1.\n\u0003\nTheorem 3.3 (Solymosi [14], Hart-Li-Shen [8]). Let p(x), q(x) \u2208 Fq [X] be polynomials of degree \u2264 2 such that p(x) \u2212 \u03bcq(x) is not a constant for any \u03bc \u2208 Fq .\nFor any A1 , A2 , A3 \u2282 Fq we have\n\u0010p\n\u0011\np\nmax(|p(A1 ) + A2 |, |q(A1) + A3 |) \u226b min\n|A1 |q, |A1 |2 |A2 ||A3 |/q .\n\nProof. We consider the Sidon set A = {(p(x), q(x)) : x \u2208 Fq }, the sets B =\np(A1 ) \u00d7 q(A1 ) and B \u2032 = A2 \u00d7 A3 and proceed as in the proof of Theorem 3.1. \u0003\nSolymosi [14] proved that if {(x, f (x))\nq } \u2282 Fq \u00d7 Fq is a Sidon set then\np : x\u2208F\n2 \u221a\nmax(|A + A|, |f (A) + f (A)|) \u226b min( |A|q, |A| / q).\n4. Equations in Fq\n\nWe start with the easiest example which, however, we have not seen in the\nliterature.\nTheorem\n4.1. For \u0011\u0010\nany x \u2208 Fq , let\n\u0010P\n\u0011 X(x), Y (x) be any pair of subsets of Fq and\nP\nput T =\nx |X(x)|\nx |Y (x)| . Then, the number of solutions S of\nx\u2032 + y \u2032 = (x + y)2,\n\nis\nS=\nfor some \u03b8 with |\u03b8| \u2264 1.\n\nx\u2032 \u2208 X(x), y \u2032 \u2208 Y (y)\n\np\nT\n+ \u03b8 qT\nq\n\nProof. We consider the Sidon set A = {(x, x2 ) : x \u2208 Fq } and the sets\nB = {(x, x\u2032 ) : x\u2032 \u2208 X(x)},\n\nB \u2032 = {(y, y \u2032) : y \u2032 \u2208 Y (y)}.\n\nFrom the definition, (x, x\u2032 ) + (y, y \u2032) \u2208 A \u21d0\u21d2 x\u2032 + y \u2032 = (x + y)2. Thus\nS = |{(b, b\u2032 ) \u2208 B \u00d7 B \u2032 : b + b\u2032 \u2208 A}| and we apply Theorem 2.1.\n\u0003\nCorollary 4.1. Let A1 , A2 , A3 , A4 \u2282 Fq . Then, the number of solutions of the\nequation\nx1 + x2 = (x3 + x4 )2 ,\n\n(4.1)\nis\n\nxi \u2208 Ai\n\np\n|A1 ||A2 ||A3 ||A4 |\n+ \u03b8 q|A1 ||A2||A3 ||A4 |,\nq\nIn particular, the number of solutions of\nS=\n\n(4.2)\n\nx1 + x2 = z 2 ,\n\nx1 \u2208 A1 , x2 \u2208 A2 , z \u2208 Fq\n\n|\u03b8| \u2264 1.\n\n\f8\n\nJAVIER CILLERUELO\n\nis\nfor some \u03b8 with |\u03b8| \u2264 1.\n\n|A1 ||A2 | + \u03b8\n\np\n\n|A1 ||A2 |q,\n\nProof. The first part of the statement follows from Theorem 4.1 by taking\n(\n(\nA1 , x \u2208 A3\nA2 , x \u2208 A4\nX(x) =\nand\nY (x) =\n\u2205 otherwise\n\u2205 otherwise.\nThe second part of the statement follows from the fact that if A3 = A4 = Fq then\neach solution of (4.2) corresponds to exactly q solutions of (4.1).\n\u0003\nShkredov [13] used Weil's bound for exponential sums with multiplicative\ncharacters to prove the following result for q = p prime and the condition\n|X1 ||X2 | > 20p.\nCorollary 4.2. Let X1 , X2 \u2282 Fq , |X1 ||X2 | > 2q. Then there exist x, y \u2208 Fq such\nthat x + y \u2208 X1 and xy \u2208 X2 .\nProof. The number of such that pairs (x, y) is equal to the number of solutions\nof the equation\n(x1 /2 \u2212 z)(x1 /2 + z) = x2 ,\n\nx1 \u2208 X1 , x2 \u2208 X2 , z \u2208 Fq .\n\nWe observe that this equation is equivalent to the equation (x1 /2)2 \u2212 x2 = z 2 .\nIn order to apply (4.2) we split X1 = X11 \u222a X12 in such a way that the squares\nin each set are all distinct. Then we apply (4.1) separately to A1 = {x21 /2 : xi \u2208\nX11 }, A2 = \u2212X2 and to A1 = {x21 /2 : xi \u2208 X12 }, A2 = \u2212X2 . It follows that the\nnumber of solutions of the equation (x1 /2)2 \u2212x2 = z 2 , x1 \u2208 X1 , x2 \u2208 X2 , z \u2208 Fq\nis positive in view of\np\np\np\n|X11 ||X2 |\u2212 |X11 ||X2|q+|X12 ||X2 |\u2212 |X12 ||X2|q \u2265 |X1 ||X2 |\u2212 2|X1 ||X2|q > 0.\n\n\u0003\n\nS\u00e1rk\u00f6zy [11, 12] using exponential sums, obtained asymptotic formula for the\nnumber of solutions of the congruences x1 x2 \u2212 x3 x4 \u2261 \u03bb (mod p) and x1 x2 \u2212 x3 \u2212\nx4 \u2261 \u03bb (mod p), xi \u2208 Xi . In [7] these results have been proved in any finite\nfields. We derive Sark\u0151zy's results directly from our Theorem 2.1.\nTheorem 4.2. For x \u2208 F\u2217q , y \u2208 F\u2217q let X(x), Y (y) be any subsets of Fq . Then\nfor the number S of solutions of the equation\nx\u2032 + y \u2032 = xy,\nwe have\nS=\n\nx\u2032 \u2208 X(x), y \u2032 \u2208 Y (y)\n\np\nT\n+ \u03b8 qT ,\nq\n\n|\u03b8| \u2264 1 + o(1),\n\n\fCOMBINATORIAL PROBLEMS IN FINITE FIELDS AND SIDON SETS\n\nwhere T =\n\n\u0010P\n\nx |X(x)|\n\n9\n\n\u0011\u0010P\n\n\u0011\n|Y\n(x)|\n.\nx\n\nProof. We consider the Sidon set A = {(x, g x ) : x \u2208 Zq\u22121 } and the sets\nB = {(log x, x\u2032 ) : x\u2032 \u2208 X(x)},\n\nB \u2032 = {(log y, y \u2032) : y \u2032 \u2208 Y (y)}.\n\nWe observe that\n(log x, x\u2032 ) + (log y, y \u2032) \u2208 A \u21d0\u21d2 x\u2032 + y \u2032 = g log x+log y = xy.\n\nThus S = |{(b, b\u2032 ) \u2208 B \u00d7 B \u2032 : b + b\u2032 \u2208 A}| and then we apply Theorem 2.1.\n\n\u0003\n\nCorollary 4.3. Let X1 , X2 \u2282 F\u2217q and X3 , X4 \u2282 Fq . The number S of solutions\nof the equation\nx1 x2 = x3 + x4 , xi \u2208 Xi ,\nis\n\nS=\n\np\n|X1 ||X2 ||X3||X4 |\n+ \u03b8 |X1 ||X2||X3 ||X4 |q,\nq\n\n|\u03b8| \u2264 1 + o(1).\n\nProof. We take X(x) and Y (y) as in Corollary 4.1 and use Theorem 4.2.\n\n\u0003\n\nCorollary 4.4. Let X1 , X2 \u2282 F\u2217q and X3 , X4 \u2282 Fq . The number S of solutions\nof the equation\nx2 x3 \u2212 x1 x4 = 1, xi \u2208 Xi ,\nis\n\nS=\n\np\n|X1 ||X2 ||X3||X4 |\n+ \u03b8 |X1 ||X2||X3 ||X4 |q,\nq\n\nProof. In Theorem 4.2 we take\n(\nxX3 , x \u2208 X1\u22121\nX(x) =\n\u2205 otherwise\n\nand\n\n|\u03b8| \u2264 1 + o(1).\n\n(\n\u2212yX4 , y \u2208 X2\u22121\nY (y) =\n\u2205 otherwise\n\n.\n\n\u22121\n\u22121\n\u22121\nIn this way we arrive at the equation x\u22121\n1 x2 = x1 x3 \u2212x2 x4 , which is equivalent\nto the equation of the corollary.\n\u0003\n\nTheorem 4.3. For x \u2208 F\u2217q , y \u2208 F\u2217q , let X(x), Y (y) be any subsets of F\u2217q . The\nnumber S of solutions of the equation\nxy \u2212 x\u2032 y \u2032 = 1,\n\nx, y \u2208 F\u2217q , x\u2032 \u2208 X(x), y \u2032 \u2208 Y (y),\n\nis\n\np\nT\nS = + \u03b8 T q,\nq\n\u0010P\n\u0011\u0010P\n\u0011\nwhere T =\n|X(x)|\n|Y\n(x)|\n.\nx\nx\n\n|\u03b8| \u2264 1 + o(1),\n\n\f10\n\nJAVIER CILLERUELO\n\nProof. We consider the Sidon set A = {(x, y) : g x \u2212 g y = 1} \u2282 Zq\u22121 \u00d7 Zq\u22121 and\nthe sets B = {(log x, log x\u2032 ) : x\u2032 \u2208 X(x)} and B \u2032 = {(log y, log y \u2032) : y \u2032 \u2208 Y (y)}.\nIt is clear that S = |{(b, b\u2032 ) \u2208 B \u00d7 B \u2032 : b + b\u2032 \u2208 A}|. Now we apply Theorem\n2.1.\n\u0003\nWe observe that this theorem also gives an alternative proof of Corollary 4.4\nby taking X(x) and Y (y) as in Corollary 4.1.\n5. Distribution of Sidon sets and applications\nLet A be a Sidon set in G. For any set B \u2282 G we write EA (B) = |A\u2229B|\u2212 |B||A|\n.\n|G|\nThe following lemma and Lemma 3.1 will be the main tools to prove asymptotic\nestimates for |A \u2229 B| in a class of problems. For simplicity we restrict ourselves\nto the cases when A is one of the three Sidon sets described in Section 2.\nLemma 5.1. Let A be one of the three Sidon sets described in section \u00a72 and\nB \u2282 G. For any set C \u2282 G, there exists c \u2208 C such that\n\u0010 |B| \u00111/2\n|EA (B)| \u2264 2 q\n+ |EA (B c )| + |EA (Bc )|\n|C|\n\nwhere B c = B \\ (B + c) and Bc = (B + c) \\ B.\nProof. We have\n\n(5.1)\n\n|A||B| \u0011\n1 X\u0010\n|A||B|\n|A \u2229 (B + c)| \u2212\n=\nEA (B) = |A \u2229 B| \u2212\n|G|\n|C| c\u2208C\n|G|\n\u0010\n\u0011\n1 X\n+\n|A \u2229 B| \u2212 |A \u2229 (B + c)| .\n|C| c\u2208C\n\nWe observe that\nX\u0010\n|A||B| \u0011\n|A||B||C|\n(5.2)\n|A \u2229 (B + c)| \u2212\n= |{(b, c) \u2208 B \u00d7 C : b + c \u2208 A}| \u2212\n.\n|G|\n|G|\nc\u2208C\n\u0010\n\u00111/2\nHence, by Theorem 2.1, the absolute value of this sum is bounded by 2 q|B||C|\n.\nSince |Bc | = |B c |, for the second sum in (5.1) we have\n\n|A \u2229 B| \u2212 |A \u2229 (B + c)| = |A \u2229 Bc | \u2212 |A \u2229 B c |\n\u0013 \u0012\n\u0013\n\u0012\n|A||B c|\n|A||Bc|\nc\n\u2212 |A \u2229 B | \u2212\n= |A \u2229 Bc | \u2212\n|G|\n|G|\nc\n= EA (Bc ) \u2212 EA (B ).\n\n\fCOMBINATORIAL PROBLEMS IN FINITE FIELDS AND SIDON SETS\n\n11\n\nThus\n\u0010\n\u0011\n\u0011\n1 X\u0010\n|A \u2229 B| \u2212 |A \u2229 (B + c)| \u2264 max |EA (Bc )| + |EA (B c )| .\nc\u2208C\n|C| c\u2208C\n\n\u0003\n\nIn the special case when B is a subgroup we can take C = B and then B c =\nBc = \u2205 for any c \u2208 C. Thus, in this case we have\n|EA (B)| \u226a q 1/2 .\n\nAs a corollary we obtain a well known result on the Fermat equation in finite\nfields.\nCorollary 5.1. Let Q, Q\u2032 be subgroups of F\u2217q . We have\n|Q||Q\u2032 |\n\u221a\n+ O( q).\nq\nIn particular, if p \u226b (rs)2 the Fermat congruence xr + y s \u2261 1 (mod p) has\nnontrivial solutions.\n|{(x, y) \u2208 Q \u00d7 Q\u2032 : x + y = 1}| =\n\nProof. Consider the Sidon set A = {(x, y) : g x + g y = 1} and take B = C =\nQ \u00d7 Q\u2032 .\n\u0003\nIn applications, the strategy is to take a large set C such that |B c | and |Bc | are\nsmall compared with |B|. This is possible when B has some specific regularity\nproperties (subgroups, cartesian product of arithmetic progressions, convex sets,\netc.) We illustrate our method with an example.\nTheorem 5.1. Let I, J \u2282 Zp\u22121 be intervals. For any positive integer r we have\n\u0010\u0010 |I||J| \u00111/r\n\u0011\u221a\n|I||J|\nx\ny\nr\n{(x, y) \u2208 I \u00d7 J : g \u2212 g \u2261 \u03bb (mod p)} =\n+4 \u03b8\n+ 1 p,\np\np3/2\nwith |\u03b8| \u2264 1.\nProof. We proceed by induction on r. We consider the Sidon set A = {(x, y) :\ng x \u2212 g y = \u03bb} \u2282 Zp\u22121 \u00d7 Zp\u22121 and the set B = I \u00d7 J. Then, applying Lemma 3.1,\nwe get\ns\n4|I||J|\n\u221a\n|B + B|\n|B + B|\n+2 p\n\u2264\n+ 4 p.\n|A \u2229 B| \u2264\np\n|B|\np\n\u221a\nSince |EA (B)| \u2264 max( |B||A|\n, |A \u2229B|), we have that |EA (B)| \u2264 4|I||J|\n+ 4 p, which\n|G|\np\nproves Theorem 5.1 for r = 1. Now we assume that Theorem 5.1 is true for some\nr and we proved it for r + 1.\nWe consider the auxiliar set C = I \u2032 \u00d7 J \u2032 where I \u2032 = {0, . . . , \u230a\u03b1|I|\u230b} and J \u2032 =\n{0, . . . , \u230a\u03b1|J|\u230b} for a suitable \u03b1. We observe that |C| \u2265 \u03b12 |I||J|. Lemma 5.1\n\n\f12\n\nJAVIER CILLERUELO\n1/2\n\ngives |EA (B)| \u2264 2 p \u03b1 + |EA (B c )| + |EA (Bc )|. Now we observe that B + c is a\nsmall translation of the rectangle B = I \u00d7 J. Thus we can write B c = B1 \u222a B2\nand Bc = B3 \u222a B4 where the sets Bi are rectangles with |Bi | \u2264 \u03b1|I||J|.\n1/2\n\nThus, |EA (B)| \u2264 2 p \u03b1 + |EA (B1 )| + |EA (B2 )| + |EA (B3 )| + |EA (B4 )|.\n\nTaking into account the induction hypothesis for each Bi we have\n\u0010\u0010 \u03b1|I||J| \u00111/r\n\u0011\u221a\np1/2\n+ 4\u03b8r\n|EA (B)| \u2264 2\n+\n1\np.\n\u03b1\np3/2\n\u0010 3/2 \u00111/(r+1)\np\nTaking \u03b1 = 41r |I||J|\nwe obtain the required estimate.\n\n\u0003\n\nIt should be mentioned that, for the particular case |I| = |J|, Garaev obtained the error term O(|I|2/3 log2/3 (|I|p\u22123/4 + 2) + p1/2 ). We note that the error\nterm in Theorem 5.1 is smaller than Garaev's error term. Furthermore, in the\nrange p3/2 \u226a |I||J| \u226a p3/2 (log p)log log p our error term is smaller than the error\nterm O(p1/2 log2 p) established in [10]. For arbitrary intervals, Theorem 5.1 gives\nO\u01eb (p1/2+\u01eb ) for any \u01eb > 0, which is only slightly weaker than O(p1/2 log2 p).\nFinally, we remark that the analogy of Theorem 5.1 also holds for some other\nproblems of similar flavor, like estimating {x \u2208 I : x2 \u2208 J} or {x \u2208 I : g x \u2208 J}.\nThese are achieved by employing suitable Sidon sets.\nAcknowledgments: Parts of this work have been presented in several places:\nConference on Arithmetic Combinatorics (IAS Princeton 2007), Primera Reuni\u00f3n\nConjunta Sociedad Matem\u00e1tica Mexicana-Real Sociedad Matem\u00e1tica Espa\u00f1ola\n(Oaxaca, M\u00e9xico, 2009) and Discrete Analysis Seminar (University of Cambridge,\n2010). I would like to thank these institutions for their hospitality. Also I want to\nthank Igor Shparlinsky and M. Garaev for useful conversations about this work.\nReferences\n[1] P. Csikv\u00e1ri, K. Gyarmati and A. S\u00e1rk\u00f6zy, Density and Ramsey type results on algebraic\nequations with restricted solution sets, Combinatorica, to appear.\n[2] M. Z. Garaev, The sum-product estimate for large subsets of prime fields. Proc. Amer.\nMath. Soc. 136 (2008) n.8, 2735-2739.\n[3] M. Z. Garaev, On the logarithmic factor in error term estimates in certain additive\ncongruence problems, Acta Arithmetica 124 (2006) n.1, 33-40.\n[4] M. Z. Garaev and Ka-Lam Kueh, Distribution of special sequences modulo a large prime,\nInternational Journal of Mathematics and Mathematical Sciences, 50 (2003) n.50, 31893194.\n[5] M. Z. Garaev and C. Shen, On the size of the set A(A + 1), Mathematische Zeitschrift,\n265 (2010) n.1, 125-132.\n[6] V. C. Garc\u0131\u0301a, A note on an additive problem with powers of a primitive root. Bol. Soc.\nMat. Mexicana (3) 11 (2005) n.1, 1-4.\n\n\fCOMBINATORIAL PROBLEMS IN FINITE FIELDS AND SIDON SETS\n\n13\n\n[7] K. Gyarmati and A. S\u00e1rk\u00f6zy, Equations in finite fields with restricted solution sets, II.\n(Algebraic equations.), Acta Math. Hungar. 119 (2008) n.3, 259-280.\n[8] Derrick Hart, Liangpan Li, Chun-Yen Shen, Fourier analysis and expanding phenomena\nin finite fields. arXiv:0909.5471\n[9] S. V. Konyagin, Bounds of exponential sums over subgroups and Gauss sums, Proc 4th Intern. Conf. Modern Problems of Number Theory and Its Applications, Moscow Lomonosov\nState Univ., Moscow, (2002) 86-114 (in Russian)\n[10] Z. Rudnik and A. Zaharescu, The distribution of spacing between small powers of a\nprimitive root, Israel Journal of Mathematics 120 (2000), 271-287.\n[11] A. S\u00e1rk\u00f6zy, On sums and products on residues modulo p. Acta Arithmetica 118 (2005),\nn.4, 403-409.\n[12] A. S\u00e1rk\u00f6zy, On products and shifted products of residues modulo p. Proceedings of CANT\n2005. Integers 8(2), (2008)\n[13] I. D. Shkredov, On monochromatic solutions of some nonlinear equations in Z/Zp ,\narXiv:0909.3269\n[14] J. Solymosi, Incidences and the spectra of graphs, Combinatorial Number Theory and\nAdditive Group Theory, Advanced Courses in Mathematics - CRM Barcelona Birkh\u00e4user\nBasel (2009), 299-314.\n[15] Vinh. Szemeredi-Trotter type theorem and sum-product estimate in finite fields,\narXiv:0711.4427v1 [math.CO]\nInstituto de Ciencias Matem\u00e1ticas (CSIC-UAM-UC3M-UCM) and Departamento\nde Matem\u00e1ticas, Universidad Aut\u00f3noma de Madrid, 28049, Madrid, Espa\u00f1a\nE-mail address: franciscojavier.cilleruelo@uam.es\n\n\f"}