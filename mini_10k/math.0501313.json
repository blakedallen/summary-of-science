{"id": "http://arxiv.org/abs/math/0501313v2", "guidislink": true, "updated": "2008-08-06T18:47:59Z", "updated_parsed": [2008, 8, 6, 18, 47, 59, 2, 219, 0], "published": "2005-01-20T03:46:21Z", "published_parsed": [2005, 1, 20, 3, 46, 21, 3, 20, 0], "title": "On the singularity probability of random Bernoulli matrices", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0501386%2Cmath%2F0501255%2Cmath%2F0501201%2Cmath%2F0501108%2Cmath%2F0501263%2Cmath%2F0501480%2Cmath%2F0501197%2Cmath%2F0501207%2Cmath%2F0501537%2Cmath%2F0501152%2Cmath%2F0501171%2Cmath%2F0501184%2Cmath%2F0501086%2Cmath%2F0501072%2Cmath%2F0501156%2Cmath%2F0501484%2Cmath%2F0501436%2Cmath%2F0501318%2Cmath%2F0501192%2Cmath%2F0501338%2Cmath%2F0501265%2Cmath%2F0501189%2Cmath%2F0501264%2Cmath%2F0501529%2Cmath%2F0501528%2Cmath%2F0501131%2Cmath%2F0501462%2Cmath%2F0501530%2Cmath%2F0501068%2Cmath%2F0501094%2Cmath%2F0501319%2Cmath%2F0501036%2Cmath%2F0501177%2Cmath%2F0501551%2Cmath%2F0501493%2Cmath%2F0501556%2Cmath%2F0501446%2Cmath%2F0501316%2Cmath%2F0501292%2Cmath%2F0501033%2Cmath%2F0501313%2Cmath%2F0501368%2Cmath%2F0501027%2Cmath%2F0501146%2Cmath%2F0501443%2Cmath%2F0501109%2Cmath%2F0501175%2Cmath%2F0501455%2Cmath%2F0501379%2Cmath%2F0501006%2Cmath%2F0501150%2Cmath%2F0501040%2Cmath%2F0501326%2Cmath%2F0501499%2Cmath%2F0501258%2Cmath%2F0501138%2Cmath%2F0501034%2Cmath%2F0501331%2Cmath%2F0501544%2Cmath%2F0501358%2Cmath%2F0501186%2Cmath%2F0501224%2Cmath%2F0501361%2Cmath%2F0501388%2Cmath%2F0501390%2Cmath%2F0501004%2Cmath%2F0501164%2Cmath%2F0501229%2Cmath%2F0501385%2Cmath%2F0501312%2Cmath%2F0501259%2Cmath%2F0501359%2Cmath%2F0501321%2Cmath%2F0501398%2Cmath%2F0501538%2Cmath%2F0501291%2Cmath%2F0501217%2Cmath%2F0501135%2Cmath%2F0501373%2Cmath%2F0501333%2Cmath%2F0501506%2Cmath%2F0501402%2Cmath%2F0501126%2Cmath%2F0501248%2Cmath%2F0501116%2Cmath%2F0501155%2Cmath%2F0501279%2Cmath%2F0501543%2Cmath%2F0501099%2Cmath%2F0501269%2Cmath%2F0501073%2Cmath%2F0501237%2Cmath%2F0501381%2Cmath%2F0501407%2Cmath%2F0501121%2Cmath%2F0501343%2Cmath%2F0501253%2Cmath%2F0501282%2Cmath%2F0501227%2Cmath%2F0501347%2Cmath%2F0501477&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On the singularity probability of random Bernoulli matrices"}, "summary": "Let $n$ be a large integer and $M_n$ be a random $n$ by $n$ matrix whose\nentries are i.i.d. Bernoulli random variables (each entry is $\\pm 1$ with\nprobability 1/2). We show that the probability that $M_n$ is singular is at\nmost $(3/4 +o(1))^n$, improving an earlier estimate of Kahn, Koml\\'os and\nSzemer\\'edi, as well as earlier work by the authors. The key new ingredient is\nthe applications of Freiman type inverse theorems and other tools from additive\ncombinatorics.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0501386%2Cmath%2F0501255%2Cmath%2F0501201%2Cmath%2F0501108%2Cmath%2F0501263%2Cmath%2F0501480%2Cmath%2F0501197%2Cmath%2F0501207%2Cmath%2F0501537%2Cmath%2F0501152%2Cmath%2F0501171%2Cmath%2F0501184%2Cmath%2F0501086%2Cmath%2F0501072%2Cmath%2F0501156%2Cmath%2F0501484%2Cmath%2F0501436%2Cmath%2F0501318%2Cmath%2F0501192%2Cmath%2F0501338%2Cmath%2F0501265%2Cmath%2F0501189%2Cmath%2F0501264%2Cmath%2F0501529%2Cmath%2F0501528%2Cmath%2F0501131%2Cmath%2F0501462%2Cmath%2F0501530%2Cmath%2F0501068%2Cmath%2F0501094%2Cmath%2F0501319%2Cmath%2F0501036%2Cmath%2F0501177%2Cmath%2F0501551%2Cmath%2F0501493%2Cmath%2F0501556%2Cmath%2F0501446%2Cmath%2F0501316%2Cmath%2F0501292%2Cmath%2F0501033%2Cmath%2F0501313%2Cmath%2F0501368%2Cmath%2F0501027%2Cmath%2F0501146%2Cmath%2F0501443%2Cmath%2F0501109%2Cmath%2F0501175%2Cmath%2F0501455%2Cmath%2F0501379%2Cmath%2F0501006%2Cmath%2F0501150%2Cmath%2F0501040%2Cmath%2F0501326%2Cmath%2F0501499%2Cmath%2F0501258%2Cmath%2F0501138%2Cmath%2F0501034%2Cmath%2F0501331%2Cmath%2F0501544%2Cmath%2F0501358%2Cmath%2F0501186%2Cmath%2F0501224%2Cmath%2F0501361%2Cmath%2F0501388%2Cmath%2F0501390%2Cmath%2F0501004%2Cmath%2F0501164%2Cmath%2F0501229%2Cmath%2F0501385%2Cmath%2F0501312%2Cmath%2F0501259%2Cmath%2F0501359%2Cmath%2F0501321%2Cmath%2F0501398%2Cmath%2F0501538%2Cmath%2F0501291%2Cmath%2F0501217%2Cmath%2F0501135%2Cmath%2F0501373%2Cmath%2F0501333%2Cmath%2F0501506%2Cmath%2F0501402%2Cmath%2F0501126%2Cmath%2F0501248%2Cmath%2F0501116%2Cmath%2F0501155%2Cmath%2F0501279%2Cmath%2F0501543%2Cmath%2F0501099%2Cmath%2F0501269%2Cmath%2F0501073%2Cmath%2F0501237%2Cmath%2F0501381%2Cmath%2F0501407%2Cmath%2F0501121%2Cmath%2F0501343%2Cmath%2F0501253%2Cmath%2F0501282%2Cmath%2F0501227%2Cmath%2F0501347%2Cmath%2F0501477&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let $n$ be a large integer and $M_n$ be a random $n$ by $n$ matrix whose\nentries are i.i.d. Bernoulli random variables (each entry is $\\pm 1$ with\nprobability 1/2). We show that the probability that $M_n$ is singular is at\nmost $(3/4 +o(1))^n$, improving an earlier estimate of Kahn, Koml\\'os and\nSzemer\\'edi, as well as earlier work by the authors. The key new ingredient is\nthe applications of Freiman type inverse theorems and other tools from additive\ncombinatorics."}, "authors": ["Terence Tao", "Van Vu"], "author_detail": {"name": "Van Vu"}, "author": "Van Vu", "arxiv_comment": "30 pages, no figures. This is the final version", "links": [{"href": "http://arxiv.org/abs/math/0501313v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0501313v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "15A52", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0501313v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0501313v2", "journal_reference": "J. Amer. Math. Soc. 20 (2007), 603-628", "doi": null, "fulltext": "arXiv:math/0501313v2 [math.CO] 6 Aug 2008\n\nJOURNAL OF THE\nAMERICAN MATHEMATICAL SOCIETY\nVolume 00, Number 0, Pages 000\u2013000\nS 0894-0347(XX)0000-0\n\nON THE SINGULARITY PROBABILITY OF RANDOM\nBERNOULLI MATRICES\nTERENCE TAO AND VAN VU\n\n1. Introduction\nLet n be a large integer, and Mn be a random n by n matrix whose entries are\ni.i.d. Bernoulli random variables (each entry is \u00b11 with probability 1/2). In this\npaper we consider the well known question of estimating Pn := P(det(Mn ) = 0),\nthe probability that Mn is singular.\nBy considering the event that two columns or two rows of Mn are equal (up to\nsign), it is clear that\n\nPn \u2265 (1 + o(1))n2 21\u2212n .\n\nHere and in the sequel we use the asymptotic notation under the assumption that\nn tends to infinity. It has been conjectured by many researchers that in fact\nConjecture 1.1.\n1\nPn = (1 + o(1))n2 21\u2212n = ( + o(1))n .\n2\nIn a breakthrough paper [11], Kahn, Koml\u00f3s and Szemer\u00e9di proved that\n\n(1.1)\n\nPn = O(.999n ).\n\nIn a recent paper [17] we improved this bound slightly to O(.958n ). The main result\nof this paper is the following more noticeable improvement.\nTheorem 1.2.\n\n3\nPn \u2264 ( + o(1))n .\n4\n\n2000 Mathematics Subject Classification. 15A52.\nT. Tao is a Clay Prize Fellow and is supported by a grant from the Packard Foundation.\nV. Vu is an A. Sloan Fellow and is supported by an NSF Career Grant.\nc 1997 American Mathematical Society\n\n1\n\n\f2\n\nTERENCE TAO AND VAN VU\n\nThe proof of this theorem uses several ideas from [11, 17]. The key new ingredient\nis the applications of Freiman type inverse theorems and other tools from additive\ncombinatorics.\nIn the next section, we present the initial steps of the proof of Theorem 1.2. These\nsteps will reveal the origin of the bound ( 34 + o(1))n and also provide an approach\nto the conjectured bound (1 + o(1))n2 21\u2212n .\n\n2. Reduction to medium combinatorial dimension\nWe begin the proof of Theorem 1.2. We first make a convenient (though somewhat\nartificial) finite field reduction. Observe that any n \u00d7 n matrix with entries \u00b11\ncan have determinant at most nn/2 (since the magnitude of the determinant equals\n\u221a\nthe volume of a n-dimensional parallelopiped, all of whose edges have length n);\nthis is also known as Hadamard's inequality. Thus if we introduce a finite field\nF := Z/pZ of prime order\n|F | = p > nn/2 ,\n\n(2.1)\n\nthen Pn is also the probability that a random n \u00d7 n matrix with entries \u00b11 (now\nthought of as elements of F ) is singular in the finite field F . Henceforth we fix the\nfinite field F , and shall work over the finite field F instead of over R. In particular,\nlinear algebra terminology such as \"dimension\", \"rank\", \"linearly independent\",\n\"subspace\", \"span\", etc. will now be with respect to the field F . One advantage\nof this discretized setting is that all collections of objects under consideration will\nnow automatically be finite, and one can perform linear change of variables over\nF without having to worry about Jacobian factors. Note that while one could use\nBertrand's postulate to fix |F | to be comparable to nn/2 , we will not need to do so\nin this paper. Indeed it will be more convenient to take |F | to be extremely large\n(e.g. larger than exp(exp(Cn))) to avoid any \"torsion\" issues.\nNow let {\u22121, 1}n \u2282 F n be the discrete unit cube in F n . We let X be the random\nvariable taking values in {\u22121, 1}n which is distributed uniformly on this cube (thus\neach element of {\u22121, 1}n is attained with probability 2\u2212n ). Let X1 , . . . , Xn \u2208\n{\u22121, 1} be n independent samples of X. Then\nPn := P(X1 , . . . , Xn linearly dependent).\nFor each linear subspace V of F n , let AV denote the event that X1 , . . . , Xn span\nV . Let us call a space V non-trivial if it is spanned by the set V \u2229 {\u22121, 1}n. Note\nthat P(AV ) 6= 0 if and only if V is non-trivial. Since every collection of n linearly\ndependent vectors in F n will span exactly one proper subspace V of F n , we have\n(2.2)\n\nPn =\nV\n\nX\n\na proper non-trivial subspace of\n\nP(AV ).\nFn\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n3\n\nIn [17, Lemma 5.1] (see also [11]), we showed that the dominant contribution to\nthis sum came from the hyperplanes:\nX\nP(AV ).\nPn = 2o(n)\nV a non-trivial hyperplane in F n\nThus it will suffice to show that\nX\nV\n\na non-trivial hyperplane in\n\nFn\n\nP(AV ) \u2264 (3/4 + o(1))n .\n\nWe remark that the arguments below also extend to control the lower-dimensional\nspaces directly, but it will be somewhat simpler technically to work just with hyperplanes.\nAs in [11], the next step is to partition the non-trivial hyperplanes V into a number\nof classes, depending on a quantity which we shall call the combinatorial dimension.\nDefinition 2.1 (Combinatorial dimension). Let D := {d\u00b1 \u2208 Z/n : 1 \u2264 d\u00b1 \u2264 n}.\nFor any d\u00b1 \u2208 D, we define the combinatorial Grassmannian Gr(d\u00b1 ) to be the set\nof all non-trivial hyperplanes V in F n with\n(2.3)\n\n2d\u00b1 \u22121/n < |V \u2229 {\u22121, 1}n| \u2264 2d\u00b1 .\n\nWe will refer to d\u00b1 as the combinatorial dimension of V .\nRemark 2.2. Following [11], we have gradated the combinatorial dimension in steps\nof 1/n rather than steps of 1. This is because we will need to raise probabilities\nsuch as P(X \u2208 V ) to the power n, and thus errors of 2O(1/n) in will be acceptable\nwhile errors of 2O(1) can be more problematic. This of course increases the number\nof possible combinatorial dimensions from O(n) to O(n2 ), but this will have a\nnegligible impact on our analysis.\nIt thus suffices to show that\nX\n(2.4)\n\nX\n\nd\u00b1 \u2208D V \u2208Gr(d\u00b1 )\n\n3\nP(AV ) \u2264 ( + o(1))n .\n4\n\nIt is therefore of interest to understand the size of the combinatorial Grassmannians Gr(d\u00b1 ) and of the probability of the events AV for hyperplanes V in those\nGrassmannians.\nThere are two easy cases, one when d\u00b1 is fairly small and one where d\u00b1 is fairly\nlarge, both of which were treated in [11], and which we present below.\nLemma 2.3 (Small combinatorial dimension estimate). [11] Let 0 < \u03b1 < 1 be\narbitrary. Then\nX\nX\nP(AV ) \u2264 n\u03b1n .\nd\u00b1 \u2212n\nd\u00b1 \u2208D:2\n\u2264\u03b1n V \u2208Gr(d\u00b1 )\nProof. Observe that if X1 , . . . , Xn span V , then there are n \u2212 1 vectors among the\nXi which already span V . By symmetry, we thus have\n\n\f4\n\n(2.5)\n\nTERENCE TAO AND VAN VU\n\nP(AV ) = P(X1 , . . . , Xn span V ) \u2264 nP(X1 , . . . , Xn\u22121 span V )P(X \u2208 V ).\n\nOn the other hand, if V \u2208 Gr(d\u00b1 ) and 2d\u00b1 \u2212n \u2264 \u03b1n , then P(X \u2208 V ) \u2264 \u03b1n thanks\nto (2.3). Thus we have\nP(AV ) \u2264 n\u03b1n P(X1 , . . . , Xn\u22121 span V ).\nSince X1 , . . . , Xn\u22121 can span at most one space V , the claim follows.\n\n\u0003\n\nLemma 2.4 (Large combinatorial dimension estimate). [11] We have\nX\nX\nP(AV ) \u2264 (1 + o(1))n2 2\u2212n .\n\u221a\nd\u00b1 \u2208D:2d\u00b1 \u2212n \u2265100/ n V \u2208Gr(d\u00b1 )\nProof. (Sketch) For this proof it is convenient to work back in Euclidean space\nRn instead of in the finite field model F n ; observe that one can identify nontrivial hyperplanes in F n with non-trivial hyperplanes in Rn without affecting the\ncombinatorial dimension. Let V \u2282 Rn be a hyperplane in Gr(d\u00b1 ) with 2d\u00b1 \u2212n \u2265\n100\n\u221a . Then by (2.3) we have\nn\n\u221a\nP(X \u2208 V ) \u2265 50/ n\n\n(say). Since V is spanned by elements V \u2229 {\u22121, 1}n which lie in the integer lattice\nZn , the orthogonal complement V \u22a5 \u2282 Rn contains at least one integer vector\na = (a1 , . . . , an ) \u2208 Zn \\{0} which is not identically zero. In particular we see that\n\u221a\nP(a1 X1 + . . . + an Xn ) \u2265 50/ n.\nBut by Erd\u00f6s's Littlewood-Offord inequality (see [5]) this forces at most n/2 (say)\nof the coefficients a1 , . . . , an to be non-zero, if n is sufficiently large. Thus\nX\nX\nP(AV )\n\u221a\nd\u00b1 \u2208D:2d\u00b1 \u2212n \u2265 100\nV\n\u2208\nGr\n(d\n)\n\u00b1\nn\n\u2264 P(a * X1 = . . . = a * Xn = 0 for some a \u2208 \u03a9)\n\nwhere \u03a9 is the set of those vectors a = (a1 , . . . , an ) \u2208 Zn \\{0} which have at most\nn/2 non-zero entries. But in [11, Section 3.1] it is shown that\nP(a * X1 = . . . = a * Xn = 0 for some a \u2208 \u03a9) \u2264 (1 + o(1))n2 2\u2212n\nand the claim follows. (In fact, in the estimate in [11] one can permit as many as\nn \u2212 3 log2 n of the co-efficients a1 , . . . , an to be non-zero).\n\u0003\nWe will supplement these two easy lemmas with the following, somewhat more\ndifficult, result.\nProposition 2.5 (Medium combinatorial dimension estimate). Let 0 < \u01eb0 \u226a 1,\n\u221a . Then we have\nand let d\u00b1 \u2208 D be such that ( 34 + 2\u01eb0 )n < 2d\u00b1 \u2212n < 100\nn\nX\nn\nP(AV ) \u2264 o(1) ,\nV \u2208Gr(d\u00b1 )\nwhere the rate of decay in the o(1) quantity depends on \u01eb0 (but not on d\u00b1 ).\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n5\n\nNote that D has cardinality |D| = O(n2 ). Thus if we combine this proposition\nwith Lemma 2.3 (with \u03b1 := 34 + 2\u01eb0 ) and Lemma 2.4, we see that we can bound\nthe left-hand side of (2.4) by\n3\n3\nn( + 2\u01eb0 )n + n2 o(1)n + (1 + o(1))n2 2\u2212n = ( + 2\u01eb0 + o(1))n .\n4\n4\nSince \u01eb0 is arbitrary, Theorem 1.2 follows.\nIt thus suffices to prove Proposition 2.5. This we shall do in later sections, but\nfor now let us just remark that this argument suggests a way to obtain Conjecture\n1.1 in full. A comparison of the three bounds in Lemma 2.3, Lemma 2.4, and\nProposition 2.5 reveals that it is the estimate in Lemma 2.3 which is by far the\nmost inefficient. Indeed, from the other two lemmas we now see that the conjecture\nPn = ( 21 + o(1))n is equivalent to proving that\nX\nX\n1\nP(AV ) \u2264 ( + o(1))n\n2\nd\u00b1 \u2208D:2d\u00b1 \u2212n \u2264( 43 +2\u01eb0 )n V \u2208Gr(d\u00b1 )\nfor at least one value of \u01eb0 > 0. This bound is sharp (except for the o(1) factor) as\ncan be seen by considering the event that two of the Xi are equal up to sign. On\nthe other hand, if we let B denote the event that a1 X1 + . . . + an Xn = 0 for some\na1 , . . . , an \u2208 Zn \\{0} with at most n \u2212 3 log2 n non-zero entries, it is shown in [11,\nSection 3.1] that P(B) = (1 + o(1))n2 2\u2212n (this is basically the transpose of Lemma\n2.4). Thus it would suffice to show\nX\nX\n1\nP(AV \\B) = ( + o(1))n .\n2\nd\u00b1 \u2208D:2d\u00b1 \u2212n \u2264( 43 +2\u01eb0 )n V \u2208Gr(d\u00b1 )\nBased on Proposition 2.5, we may tentatively conjecture that in fact we have the\nstronger statement\nX\nX\n(2.6)\nP(AV \\B) = o(1)n ;\nd\u00b1 \u2212n\n3\nd\u00b1 \u2208D:2\n\u2264( 4 +2\u01eb0 )n V \u2208Gr(d\u00b1 )\nthis for instance would even imply the stronger conjecture in Conjecture 1.1. But\nour Fourier-based methods seem to hit a natural limit at 2d\u00b1 \u2212n \u223c (3/4)n and so\nare unable to obtain any further progress towards (2.6).\n3. The general approach\nWe now informally discuss the proof of Proposition 2.5; the rigorous proof will\nbegin in Section 4. We start with the trivial bound\nX\n(3.1)\nP(AV ) \u2264 1\nV \u2208Gr(d\u00b1 )\nthat arises simply because any vectors X1 , . . . , Xn can span at most one space V .\nTo improve upon this trivial bound, the key innovation in [11] is to replace X by\nanother random variable Y which tends to be more concentrated on subspaces V\nthan X is. Roughly speaking, one seeks the property\n(3.2)\n\nP(X \u2208 V ) \u2264 cP(Y \u2208 V )\n\n\f6\n\nTERENCE TAO AND VAN VU\n\nfor some absolute constant 0 < c < 1 and for all (or almost all) subspaces V \u2208\nGr(d\u00b1 ). From this property, one expects (heuristically, at least)\n(3.3)\n\nP(AV ) = P(X1 , . . . , Xn span V ) \u2264 cn P(Y1 , . . . , Yn span V ),\n\nwhere Y1 , . . . , Yn are iid samples of Y , and then by applying the\nPtrivial bound (3.1)\nwith Y instead of X, we would then obtain a bound of the form V \u2208Gr(d\u00b1 ) P(AV ) \u2264\ncn , at least in principle. Clearly, it will be desirable to make c as small as possible;\nif we can make c arbitrarily small, we will have established Proposition 2.5.\nThe random variable Y can be described as follows. Let 0 \u2264 \u03bc \u2264 1 be a small\n1 \u22121/108\nabsolute constant (in [11] the value \u03bc = 108\ne\nwas chosen), and let \u03b7 (\u03bc) be a\nrandom variable taking values in {\u22121, 0, 1} \u2282 F which equals 0 with probability 1\u2212\n(\u03bc)\n(\u03bc)\n\u03bc and equals +1 or \u22121 with probability \u03bc/2 each. Then let Y := (\u03b71 , . . . , \u03b7n ) \u2208\n(\u03bc)\n(\u03bc)\nF n , where \u03b71 , . . . , \u03b7n are iid samples of \u03b7 (\u03bc) . By using some Fourier-analytic\narguments of Hal\u00e1sz, a bound of the form\n\u221a\nP(X \u2208 V ) \u2264 C \u03bcP(Y \u2208 V )\nwas shown in [11], where C was an absolute constant (independent of \u03bc), and V\nwas a hyperplane which was non-degenerate in the sense that its combinatorial\ndimension was not too close to n. For \u03bc sufficiently small, one then obtains (3.2)\nfor some 0 < c < 1, although one cannot make c arbitrarily small without shrinking\n\u03bc also.\nThere are however some technical difficulties with this approach, arising when one\ntries to pass from (3.2) to (3.3). The first problem is that the random variable Y ,\nwhen conditioned on the event Y \u2208 V , may concentrate on a lower dimensional\nsubspace on V , making it unlikely that Y1 , . . . , Yn will span V . In particular, Y\nhas a probability of (1 \u2212 \u03bc)n of being the zero vector, which basically means that\none cannot hope to exploit (3.2) in any non-trivial way once P(X \u2208 V ) \u2264 (1 \u2212 \u03bc)n .\nHowever, in this case V has very low combinatorial dimension and Lemma 2.3\nalready gives an exponential gain.\nEven when (1 \u2212 \u03bc)n < P(X \u2208 V ) \u2264 1, it turns out that it is still not particularly\neasy to obtain (3.3), but one can obtain an acceptable substitute for this estimate\nby only replacing some of the Xj by Yj . Specifically, one can try to obtain an\nestimate roughly of the form\n(3.4)\n\nP(X1 , . . . , Xn span V ) \u2264 cm P(Y1 , . . . , Ym , X1 , . . . , Xn\u2212m span V )\n\nwhere m is equal to a suitably small multiple of n (we will eventually take m \u2248\nn/100).\n\u0001 Strictly speaking, we will also have to absorb an additional \"entropy\" loss\nn\nof m\nfor technical reasons, though as we will be taking c arbitrarily small, this\nloss will ultimately be irrelevant.\nThe above approach (with some minor modifications) was carried out rigorously in\n[11] to give the bound Pn = O(.999n ) which has been improved slightly to O(.939n )\nin [17]. There are two main reasons why the final gain in the base was relatively\nsmall. Firstly, the chosen value of \u03bc was small (so the n(1 \u2212 \u03bc)n error was sizeable),\nand secondly the value of c obtained was relatively large (so the gain of cn or c(1\u2212\u03b3)n\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n7\n\nwas relatively weak). Unfortunately, increasing \u03bc also causes c to increase, and so\neven after optimizing \u03bc and c one falls well short of the conjectured bound.\nIn this paper we partially resolve this problem as follows. To reduce all the other\nlosses to ( 34 + 2\u01eb0 )n for some small \u03b50 , we increase \u03bc up to 1/4 \u2212 \u01eb0 /100, at which\npoint the arguments of Hal\u00e1sz and [11], [17] give (3.2) with c = 1. The value 1/4\nfor \u03bc is optimal as it is the largest number satisfying the pointwise inequality\n| cos(x)| \u2264 (1 \u2212 \u03bc) + \u03bc cos(2x) for all x \u2208 R,\n\nwhich is the Fourier-analytic analogue of (3.2) (with c = 1). At first glance, the\nfact that c = 1 seems to remove any utility to (3.2), as the above argument relied\non obtaining gains of the form cn or c(1\u2212\u03b3)n . However, we can proceed further\nby subdividing the collection of hyperplanes Gr(d\u00b1 ) into two classes, namely the\nunexceptional spaces V for which\nP(X \u2208 V ) < \u03b51 P(Y \u2208 V )\n\nfor some small constant 0 < \u03b51 \u226a 1 to be chosen later (it will be much smaller than\n\u03b50 ), and the exceptional spaces for which\n(3.5)\n\n\u03b51 P(Y \u2208 V ) \u2264 P(X \u2208 V ) \u2264 P(Y \u2208 V ).\n\nThe contribution of the unexceptional spaces can be dealt with by the preceding\narguments to obtain a very small contribution (at most \u03b4 n for any fixed \u03b4 > 0 given\nthat we set \u03b51 = \u03b51 (\u03b3, \u03b4) suitably small), so it remains to consider the exceptional\nspaces V . The key new observation (which uses the Fourier analytic methods of\nHal\u00e1sz and [11]) is that the condition (3.5) can be viewed as a statement that\nthe \"spectrum\" of V (which we will define later) has \"small doubling constant\".\nOnce one sees this, one can apply theorems from inverse additive number theory (in\nparticular a variant Freiman's theorem) to obtain some strong structural control on\nV (indeed, we obtain what is essentially a complete description of the exceptional\nspaces V , up to constants depending on \u03b50 and \u03b51 ). This then allows us to obtain\na fairly accurate bound for the total number of exceptional spaces V , which can\nthen be used to estimate their contribution to (2.2) satisfactorily.\n4. Reduction to exceptional spaces\nWe now rigorously carry out the strategy outlined in Section 3. We first pick the\nparameter \u03bc as\n\u03b50\n1\n,\n(4.1)\n\u03bc := \u2212\n4 100\nand let Y \u2208 {\u22121, 0, 1}n \u2282 F n be the random variables defined in Section 3 using\nusing this value of \u03bc. We let Y1 , . . . , Yn be iid samples of Y , independent of the\nprevious samples X1 , . . . , Xn of X. Thus we may write\nn\nn\nX\nX\n(\u03bc)\n(1)\n\u03b7j ej\n\u03b7j ej ; Y =\n(4.2)\nX=\nj=1\n\n(\u03bc)\n\nwhere the \u03b7j\n(1)\n\nsection, \u03b7j\n\nj=1\n\nare iid samples of the random variable \u03b7 (\u03bc) introduced in the previous\n\nare iid random signs, and e1 , . . . , en is the standard basis of F n .\n\n\f8\n\nTERENCE TAO AND VAN VU\n\nNext, we introduce a small parameter \u01eb1 > 0 (which will be much smaller than \u01eb0 ).\nLet us call a space V \u2208 Gr(d\u00b1 ) exceptional if\n(4.3)\n\nP(X \u2208 V ) \u2265 \u03b51 P(Y \u2208 V )\n\nand unexceptional if\n(4.4)\n\nP(X \u2208 V ) < \u03b51 P(Y \u2208 V ).\n\nAs the terminology suggests, the exceptional spaces will turn out to be relatively\nrare compared to the unexceptional spaces, as will be seen by comparing Lemma\n4.1 and Lemma 4.2 below.\nProposition 2.5 is now a consequence of the following two sub-lemmas.\nLemma 4.1 (Unexceptional space estimate). We have\nX\n\u03b5 n/100\n(4.5)\nP(AV ) \u2264 2o(n) 2n \u03b510\n.\nV \u2208Gr(d\u00b1 ):V unexceptional\nwhere the decay rate in the o(n) term can depend on \u01eb0 , \u01eb1 .\nLemma 4.2 (Exceptional space estimate). We have\nX\nn\nP(AV ) \u2264 n\u2212 2 +o(n)\nV \u2208Gr(d\u00b1 ):V exceptional\nwhere the decay rate in the o(n) term can depend on \u01eb0 , \u01eb1 .\nIndeed, upon combining Lemma 4.1 and Lemma 4.2 we obtain\nX\n\u03b5 n/100\nP(AV ) \u2264 2o(n) 2n \u03b510\n+ n\u2212n/2+o(n) ,\nV \u2208Gr(d\u00b1 )\nwhich implies Proposition 2.5 since \u03b51 can be chosen arbitrarily small.\nIt remains to prove Lemma 4.1 and Lemma 4.2. We prove Lemma 4.1, which is\nsimpler in this section, and leave the more difficult Lemma 4.2 to later sections.\nProof of Lemma 4.1. We adapt some arguments form [11], [17]; the estimates here\nare somewhat cruder (and simpler) than in those papers, because we have the additional factor of \u03b51 which can absorb several losses which can arise in this argument.\nWe begin with a lemma.\nLemma 4.3 (Weighted Odlyzko lemma). [11] Let 0 \u2264 d \u2264 n. If W is any ddimensional subspace of F n , then\nP(Y \u2208 W ) \u2264 (1 \u2212 \u03bc)n\u2212d .\nProof. Write Y = (\u03b71 , . . . , \u03b7n ). Then there exists some d-tuple (j1 , . . . , jd ) of coordinates which determine the element of W ; this means that once \u03b7j1 , . . . , \u03b7jd are\nselected, there is only one possible choice for each of the remaining n\u2212d independent\nrandom variables \u03b7i if one wishes Y to lie in W . Since any given value is attained\nby an \u03b7i with probability at most 1 \u2212 \u03bc, the claim follows.\n\u0003\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n9\n\nLet m be the nearest integer to \u03b50 n/100. In addition to the random variables\nX1 , . . . , Xn , we create more random variables Y1 , . . . , Ym which have the same distribution as Y , and which are independent of each other and of X1 , . . . , Xn .\nUsing Lemma 4.3, we have\nLemma 4.4. Let V \u2208 Gr(d\u00b1 ) be unexceptional, and let BV,m denote the event that\nY1 , . . . , Ym are linearly independent and lie in V . Then\nP(BV,m ) \u2265 2\u2212o(n) (2d\u00b1 \u2212n /\u03b51 )m .\nProof. Using Bayes' identity, we can factorize\nm\nY\nP(BV,i |BV,i\u22121 )\nP(BV,m ) =\ni=1\n\nwhere BV,i is the event that Y1 , . . . , Yi are linearly independent and lie in V . Let\nWi be the linear subspace of F n spanned by Y1 , . . . , Yi . Then conditioning on any\nfixed value of Y1 , . . . , Yi\u22121 in the event BV,i\u22121 , we have\nP(BV,i |BV,i\u22121 ) = P(Y \u2208 V ) \u2212 P(Y \u2208 Wi ),\n\nsince Yi is independent of Y1 , . . . , Yi\u22121 and has the same distribution as i. By (4.4),\n(2.3) we have\n1\n1\nP(Y \u2208 V ) \u2265 P(X \u2208 V ) \u2265 2\u22121/n 2d\u00b1 \u2212n .\n\u03b51\n\u03b51\nOn the other hand, since Wi has dimension at most m, we see from Lemma 4.3,\n(4.1) that\n3\n\u03b50 n\u2212m\nP(Y \u2208 Wi ) \u2264 (1 \u2212 \u03bc)n\u2212m = ( +\n)\n.\n4 100\nSince m = \u03b50 n/100 + O(1), and ( 34 + 2\u01eb0)n < 2d\u00b1 \u2212n by hypothesis, we thus see that\nP(Y \u2208 Wi ) = O(1/n)P(Y \u2208 V )\n\n(for instance) if n is sufficiently large depending on \u03b50 . Thus we have\nP(BV,i |BV,i\u22121 ) \u2265 (1 \u2212 O(1/n))2d\u00b1 \u2212n /\u03b51 .\n\nMultiplying this together for all 1 \u2264 i \u2264 m, the claim follows.\n\n\u0003\n\nTo apply this lemma, observe that AV and BV,m are clearly independent, as they\ninvolve independent sets of random variables. Thus we have\nP(AV ) \u2264 2o(n) (2d\u00b1 \u2212n /\u03b51 )\u2212m P(AV \u2227 BV ).\n\nNow let X1 , . . . , Xn , Y1 , . . . , Ym be in the event AV \u2227 BV . Since Y1 , . . . , Ym are\nlinearly independent in V , and X1 , . . . , Xn span V , we see that there exist n \u2212 m\nvectors in X1 , . . . , Xn which, together\u0001 with Y1 , . . . , Ym , span V . The number of\nn\npossibilities for such vectors is n\u2212m\n, which we can crudely bound by 2n . By\nsymmetry we thus have\nP(AV ) \u2264 2o(n) (2d\u00b1 \u2212n /\u03b51 )\u2212m 2n P(CV ),\n\nwhere CV is the event that Y1 , . . . , Ym , X1 , . . . , Xn\u2212m span V , and that Xn\u2212m+1 , . . . , Xn\nlie in V . By independence we then have\nP(AV ) \u2264 2o(n) (2d\u00b1 \u2212n /\u03b51 )\u2212m 2n P(Y1 , . . . , Ym , X1 , . . . , Xn\u2212m spanV )P(X \u2208 V )m .\n\n\f10\n\nTERENCE TAO AND VAN VU\n\nApplying (2.3) we conclude\nP(AV ) \u2264 2o(n) (2d\u00b1 \u2212n /\u03b51 )\u2212m 2n P(Y1 , . . . , Ym , X1 , . . . , Xn\u2212m spanV )(2d\u00b1 \u2212n )m .\nSumming this over V , and observing that each collection of vectors Y1 , . . . , Ym , X1 , . . . , Xn\u2212m\ncan only span a single space V , we conclude\nX\nP(AV ) \u2264 2o(n) (2d\u00b1 \u2212n /\u03b51 )\u2212m 2n (2d\u00b1 \u2212n )m\nV \u2208Gr(d\u00b1 ):V unexceptional\nand the claim follows from the choice of m.\n\n\u0003\n\n5. Structure of exceptional subspaces\nTo conclude the proof of Theorem 1.2, the only remaining task is to prove Lemma\n4.2. Observe from (2.3) that\nP(AV ) \u2264 P(X \u2208 V )n \u2264 2\u2212n(n\u2212d\u00b1 )\nfor all V \u2208 Gr(d\u00b1 ). Thus it will suffice to show that\n(5.1)\n\nn\n\n|{V \u2208 Gr(d\u00b1 ) : V exceptional}| \u2264 n\u2212 2 +o(n) 2n(n\u2212d\u00b1 ) .\n\nTo do this we require a certain structural theorem about exceptional subspaces,\nwhich is the main novelty in our argument, and the one which requires tools from\ninverse additive number theory such as Freiman's theorem.\nWe need some notation before we can describe the structure theorem.\nDefinition 5.1 (Progressions). Let M1 , . . . , Mr be integers and let a, v1 , . . . , vr be\nnon-zero elements of F . The set\nP := {a + m1 v1 + . . . + mr vr : \u2212Mj /2 < mj < Mj /2 for all 1 \u2264 j \u2264 r}\nis called a generalized arithmetic progression of rank r; we say that the progression\nis symmetric if a = 0. We say that P is proper if the map\n(m1 , . . . , mr ) 7\u2192 m1 v1 + . . . + mr vr\nis injective when \u2212Mj /2 < mj < Mj /2. If P is proper and symmetric, we define\nthe P -norm kvkP of a point v = m1 v1 + . . . + mr vr in P by the formula\n!1/2\nr\nX\n|mi | 2\nkm1 v1 + . . . + mr vr kP :=\n(\n)\n.\nMi\ni=1\nLet V \u2208 Gr(d\u00b1 ) be an exceptional space, with a representation of the form\n(5.2)\n\nV = {(x1 , . . . , xn ) \u2208 F n : x1 a1 + . . . + xn an = 0}\n\nfor some elements a1 , . . . , an \u2208 F . We shall refer to a1 , . . . , an as the defining\nco-ordinates for V .\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n11\n\nTheorem 5.2 (Structure theorem). There is a constant C = C(\u01eb0 , \u01eb1 ) such that\nthe following holds. Let V be an exceptional hyperplane in Gr(d\u00b1 ) and a1 , . . . , an\nbe its defining co-ordinates. Then there exist integers\n\n(5.3)\n\n1\u2264r\u2264C\n\nand M1 , . . . , Mr \u2265 1 with the volume bound\n(5.4)\n\nM1 . . . Mr \u2264 C2n\u2212d\u00b1\n\nand non-zero elements v1 , . . . , vr \u2208 F such that the following holds.\n\u2022 (i) (Defining coordinates lie in a progression) The symmetric generalized\narithmetic progression\nP := {m1 v1 + . . . + mr vr : \u2212Mj /2 < mj < Mj /2 for all 1 \u2264 j \u2264 r}\nis proper and contains all the ai .\n\u2022 (ii) (Bounded norm) The ai have small P -norm:\n(5.5)\n\nn\nX\nj=1\n\nkaj k2P \u2264 C\n\n\u2022 (iii) (Rational commensurability) The set {v1 , . . . , vr } \u222a{a1 , . . . , an } is contained in the set\np\n(5.6)\n{ v1 : p, q \u2208 Z; q 6= 0; |p|, |q| \u2264 no(n) }.\nq\nRemark 5.3. The condition (i) asserts that the defining co-ordinates a1 , . . . , an of V\nlie in a fairly small generalized arithmetic progression with bounded rank O(1). The\ncondition (5.6) asserts, furthermore, that this progression is contained in a (rank\none) arithmetic progression of length no(n) . Thus we have placed {a1 , . . . , an } inside\ntwo progressions, one of small size but moderately large rank, and one of rank one\nbut of fairly huge size (but the dimensions are still smaller than nn/2 or |F |).\nRemark 5.4. The structure theorem is fairly efficient; if a1 , . . . , an obey the conclusions of the theorem, then from (5.5) and the theory of random walks (taking\nadvantage of the boundedness of r, which will play the role of dimension) we ex(1)\n(1)\n(\u03bc)\n(\u03bc)\npect the random variables \u03b71 a1 + . . . + \u03b71 an and \u03b71 a1 + . . . + \u03b71 an to be\ndistributed fairly uniformly on P and decay rapidly away from P , and so we expect\nthe probabilities P(X \u2208 V ) and P(Y \u2208 V ) to be comparable (up to a constant).\nWe shall prove the structure theorem in later sections. For the remainder of this\nsection, we show how the structure theorem can be used to prove Lemma 4.2. In\nthe sequel all of the o() factors are allowed to depend on \u01eb0 , \u01eb1 .\nLet V \u2208 Gr(d\u00b1 ) be an exceptional hyperplane. Then V has |F | \u2212 1 representations\nof the form (5.2), one for each non-zero normal vector of V . Let us call an n-tuple\n\n\f12\n\nTERENCE TAO AND VAN VU\n\n(a1 , . . . , an ) of elements in F exceptional if it obeys the conclusions of the structure\ntheorem for at least one progression P , thus we have\n1\n|F | \u2212 1\n|{(a1 , . . . , an ) \u2208F n : (a1 , . . . , an ) exceptional}|,\n\n|{V \u2208 Gr(d\u00b1 ) : V exceptional}| =\n\nand so it now suffices to show\n\n|{(a1 , . . . , an ) \u2208 F n : (a1 , . . . , an ) exceptional}|\n\n\u2264 no(n) n\u2212n/2 2n(n\u2212d\u00b1 ) |F |.\n\nWe now need to count the number of exceptional (a1 , . . . , an ). We first observe\nthat we may fix the parameter r in the conclusion of the structure theorem, since\nthe number of r is at most C = no(n) . Similarly we may fix each M1 , . . . , Mr , since\nthe total number of choices here is at most (C2n\u2212d\u00b1 )r = no(n) .\nThe number of possible choices for v1 is at most |F |. Once this vector is selected, we\nsee from (5.6) that there are at most no(n) possible choices for each of the remaining\nr\u22121 = O(1) vectors. Putting the estimates together, we can conclude that the total\nnumber of possible vectors (v1 , . . . , vr ) which could be chosen is at most no(n) |F |.\nIt now suffices to show that, for each fixed choice of r, M1 , . . . , Mr , v1 , . . . , vr (which\nin particular fixes P ), that the number of possible exceptional (a1 , . . . , an ) is at most\nno(n) n\u2212n/2 2n(n\u2212d\u00b1 ) . We are going to use the bound on the P -norms of the ai . Our\ntask is to show that for any constant C\n\n(5.7)\n\n{(a1 , . . . , an ) \u2208 P n :\n\nn\nX\nj=1\n\nkaj k2P \u2264 C} \u2264 no(n) n\u2212n/2 2n(n\u2212d\u00b1 ) .\n\nWe shall use Gaussian-type methods. To start, notice that\n\n{(a1 , . . . , an ) \u2208 P n :\n\nn\nX\nj=1\n\nkaj k2P \u2264 C} \u2264 no(n)\n\nX\n\nexp(\u2212n\n\nX\n\ne\u2212nmj /Mj\n\nn\nX\nj=1\n\n(a1 ,...,an )\u2208P n\n\nThe right hand side can be rewritten as\n\nno(n)\n\n\u0010X\na\u2208P\n\nr\n\u0010Y\n\u0011n\nexp(\u2212nkak2P ) = no(n)\n\nj=1 |mj |\u2264Mj\n\n2\n\n2\n\n\u0011n\n\n.\n\nkaj k2P ).\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\nUsing the elementary bound\nX\n\ne\u2212nm\n\n2\n\n/M 2\n\n13\n\n= O(1 + M n\u22121/2 )\n\n|m|\u2264M\n\nwe can bound the right hand side from above by\n\nno(n)\n\nY\n\n1\u2264j\u2264r\n\nMj \u0001n\n(1 + \u221a ) .\nn\n\nSince r = O(1) and M1 , . . . , Mr \u2265 1, the product\n\n(rather crudely) by O(1 + n\n\n\u22121/2\n\nQ\n\n1\u2264j\u2264r (1 +\n\nM\n\u221aj )\nn\n\ncan be bounded\n\nM1 . . . Mr ). This leads us to the following bound\n\nno(n) (1 + n\u22121/2 M1 . . . Mr )n .\nNow we use the information (see (5.4) in Structure Theorem) that M1 . . . Mr is at\nmost C2n\u2212d\u00b1 . The bound becomes\nno(n) (1 + n\u22121/2 C2n\u2212d\u00b1 )n = n\u2212n/2+o(n) 2n(n\u2212d\u00b1 )\n\u221a\nas desired, thanks to the hypothesis 2d\u00b1 \u2212n \u2264 100/ n.\nThis concludes the proof of Theorem 1.2 except for the Structure Theorem, which\nwe turn to next. This proof requires a heavy use of tools from additive combinatorics. We are going to introduce these tools in the next section.\n\n6. Generalized arithmetic progressions and inverse theorems\nIn this section we review some notation and results from additive combinatorics,\nand briefly sketch how they will be used to prove Theorem 5.2. The rigorous proof\nof this theorem will begin in Section 7.\nLet A and B be finite subsets of G. By A + B := {a + b : a \u2208 A, b \u2208 B} we denote\nthe set of all elements of G which can be represented as the sum of an element from\nA and an element from B; A \u2212 B := {a \u2212 b : a \u2208 A, b \u2208 B} is defined similarly.\nMoreover, for any positive integer l, we recursively define lA := (l \u2212 1)A + A, thus\nlA is the set of l-fold sums in A (allowing repetition).\nThe doubling constant of a finite non-empty set A \u2286 F is defined to be the the ratio\n|A + A|/|A|. It is easy to see that if A is a dense subset (with constant density \u03b4) of\na proper generalized arithmetic progression of constant rank r, then the doubling\nnumber of A is bounded from above by a constant depending on \u03b4 and r (in fact it\nis bounded by \u03b4 \u22121 2r ).\n\n\f14\n\nTERENCE TAO AND VAN VU\n\nIn the mid 1970s, Freiman [6] proved a remarkable result in the converse direction,\nwhich asserts that being a dense subset of a proper arithmetic progression of constant rank r is the only reason for a finite set A of integers to have small doubling\nconstant:\nTheorem 6.1 (Freiman's theorem). [6] For any constant C there are constant\nr and \u03b4 such that the following holds. For any finite set A of integers such that\n|A + A| \u2264 C|A|, there is a proper arithmetic progression P of rank r such that\nA \u2286 P and |A|/|P | \u2265 \u03b4.\nFreiman's proof was rather complex. A cleaner proof, based on Freiman's ideas, is\npresented by Bilu in [1]. Ruzsa [15] gave a different and quite short proof; this was\nthen refined by Chang [4]. There are explicit bounds known on the values of r and\n\u03b4 in terms of C, but for our application these bounds will only influence the o(1)\nterm in our final result and so we will not keep track of them here.\nFreiman's theorem was initially phrased in the integers Z, but it can easily be\ntransferred to a finite field F of prime order if F is sufficiently large:\nTheorem 6.2. For any constant C there are constant r and \u03b4 such that the following holds. Let F be a finite field of prime order, and let A be a non-empty subset\nof F such that |A + A| \u2264 C|A|. Then, if |F | is sufficiently large depending on\n|A|, there is a generalized arithmetic progression P of rank r such that A \u2282 P and\n|A|/|P | \u2265 \u03b4.\nThis theorem follows from Freiman's original theorem and \"rectification\" theorems\nsuch as [2, Theorem 3.1] (see also [7]) to map A via a Freiman isomorphism to\nthe the integers Z (using the hypothesis that F is large depending on A; |F | \u2265\nexp(C|A|) would do). It is also a special case of the version of Freiman's theorem\nestablished in [8] for an arbitrary abelian group. In fact, that result allows one to\nremove the hypothesis that |F | is sufficiently large depending on |A|.\nA generalized arithmetic progression is not always proper. We can, however, make\nthis assumption whenever we like (at the cost of a constant factor) thanks to the\nfollowing lemma.\nLemma 6.3 (Progressions lie inside proper progressions). There is a constant C\nsuch that the following holds. Let P be a generalized arithmetic progression of rank\nr in an abelian group G. Suppose that every non-zero element of G has order at\n3\nleast rCr |P |. Then there exists a proper arithmetic progression Q of rank at most\nr containing P and\n3\n\n|Q| \u2264 rCr |P |.\nThe proof of this lemma arises purely from the geometry of numbers (in particular,\nMinkowski's second theorem) and is independent from the rest of this paper. In\norder not to distract the reader, we defer this rather technical proof in the Appendix.\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n15\n\nFinally, we are going to need the following lemma, based on a covering argument\nof Ruzsa [16]. We say that a set A is symmetric if the set \u2212A := {\u2212a, a \u2208 A} is\nequal to A.\nLemma 6.4 (Sum set estimates). Let A be a symmetric finite subset of an abelian\ngroup G such that |4A| \u2264 C|A| for some C \u2265 1. Then for any k \u2265 4\n\u0012\n\u0013\nC +k\u22123\n|kA| \u2264\nC|A|.\nk\u22122\nProof. We can assume that k \u2265 4. Consider the sets \u03b7 + A as \u03b7 ranges inside\n3A. Each set has cardinality |A|, and is contained inside 4A. Thus we may find\na maximal disjoint collection {\u03be + A : \u03b7 \u2208 X} where X \u2286 3A has cardinality\n|X| \u2264 |4A|/|A| \u2264 C. Then for any \u03be \u2208 3A there exists \u03b7 \u2208 X such that \u03b7 + \u039b\nintersects \u03be + A, otherwise this would contradict maximality. But this implies that\n\u03be \u2208 X + A \u2212 A = 2A + X. Thus we have\nA + 2A = 3A \u2286 2A + X.\nIterating this we obtain\nfor all k \u2265 2. Thus\n\nkA \u2282 2A + (k \u2212 2)X\n\n|kA| \u2264 |2A||(k \u2212 2)X| \u2264 C|A|(k \u2212 2)X|.\nTo conclude the proof, notice that for any l\n\n|lX| \u2264\n\n\u0012\n\n\u0013\n|X| + l \u2212 1\n.\nl\n\u0003\n\nIn fact one can replace the condition |4A| \u2264 C|A| by a weaker condition |3A| \u2264\nC|A|.\nWe are going to use Theorem 6.2 to derive a structural property of the defining\nvectors {a1 , . . . , an } of V in Structure Theorem. To be more precise, we are going\nto apply Theorem 6.2 to a set A with small doubling constant which contains\nthe majority of the defining vectors {a1 , . . . , an }. Thus we obtain a generalized\narithmetic progression P containing A (and with it most of the ai ). It will be easy\nto extend P to contain all ai without violating the properties we care about.\nThe application of Theorem 6.2 is not immediate. In the next section, we shall\nprovide a Fourier-analytic argument which leads to the definition of A. The starting\npoint of this argument is based on the method [11], which is motivated by an\nobservation of Hal\u00e1sz [9]; this method shall be the focus of the next section.\n\n\f16\n\nTERENCE TAO AND VAN VU\n\n7. Hal\u00e1sz-type arguments\nLet V \u2208 Gr(d\u00b1 ) be an exceptional space with the representation (5.2). In order\nto obtain the desired structural control on the defining co-ordinates a1 , . . . , an , we\nshall first use Fourier analysis to first gain some strong control on the \"spectrum\"\n\u039b of a1 , . . . , an (which we will define in (7.4)), and then apply the inverse Fourier\ntransform to recover information about a1 , . . . , an .\nWe turn to the details. By Fourier expansion we have\n1 X\n1(x1 ,...,xn )\u2208V =\nep (x1 a1 \u03be + . . . + xn an \u03be)\n|F |\n\u03be\u2208F\n\nn\n\nfor all (x1 , . . . , xn ) \u2208 F , where p = |F | and ep is the primitive character ep (x) :=\ne2\u03c0ix/p . By (4.2) we thus have (by linearity of expectation and by independence)\nP(X \u2208 V ) = E(1X\u2208V )\n1 X\n(1)\nE(ep (\u03b71 a1 \u03be + . . . + \u03b7n(1) an \u03be))\n=\n|F |\n\u03be\u2208F\n\n=\n\nn\n1 XY\n(1)\nE(ep (\u03b7j aj \u03be))\n|F |\nj=1\n\u03be\u2208F\n\n=\n\nn\n1 XY\ncos(2\u03c0aj \u03be/p).\n|F |\nj=1\n\u03be\u2208F\n\nIn particular we have\nP(X \u2208 V ) \u2264\n=\n\nn\n1 XY\n| cos(2\u03c0aj \u03be/p)|\n|F |\nj=1\n\u03be\u2208F\n\nn\n1 XY\n| cos(\u03c0aj \u03be/p)|\n|F |\nj=1\n\u03be\u2208F\n\n=\n\nn\n1 XY 1 1\n( + cos(2\u03c0aj \u03be/p))1/2\n|F |\n2 2\nj=1\n\u03be\u2208F\n\nwhere the first identity follows from the substitution \u03be 7\u2192 \u03be/2 on F , noting that the\nquantity | cos(\u03c0aj \u03be/p)| is still periodic in \u03be with period p. Arguing similarly with\nY , we have\nP(Y \u2208 V ) =\n=\n\nn\n1 XY\n(\u03bc)\nE(ep (\u03b7j aj \u03be))\n|F |\nj=1\n\u03be\u2208F\n\nn\n1 XY\n((1 \u2212 \u03bc) + \u03bc cos(2\u03c0aj \u03be/p)).\n|F |\nj=1\n\u03be\u2208F\n\nTo summarize, if we introduce the non-negative quantities\n(7.1) f (\u03be) :=\n\nn\nY\n1 1\n( + cos(2\u03c0aj \u03be/p))1/2 ;\n2\n2\nj=1\n\ng(\u03be) :=\n\nn\nY\n\nj=1\n\n((1 \u2212 \u03bc) + \u03bc cos(2\u03c0aj \u03be/p))\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n17\n\nthen we have\n(7.2)\n\nP(X \u2208 V ) \u2264\n\n1 X\nf (\u03be);\n|F |\n\u03be\u2208F\n\nP(Y \u2208 V ) =\n\n1 X\ng(\u03be).\n|F |\n\u03be\u2208F\n\nWe now give a crucial comparison estimate between f and g.\nLemma 7.1. For all \u03be \u2208 F , we have f (\u03be) \u2264 g(\u03be)1/4\u03bc .\nProof. By (7.1) suffices to show that\n1 1\n( + cos \u03b8)1/2 \u2264 ((1 \u2212 \u03bc) + \u03bc cos \u03b8)1/4\u03bc\n2 2\nfor any \u03b8. Writing cos \u03b8 = 1 \u2212 2x for some 0 < x \u2264 1 (the x = 0 case being trivial),\nthis can be rearranged to become\nlog(1 \u2212 x) \u2212 log(1 \u2212 0)\nlog(1 \u2212 2\u03bcx) \u2212 log(1 \u2212 0)\n\u2264\n.\nx\n2\u03bcx\nBut this follows from the concavity of the function log(1 \u2212 x) on 0 \u2264 x \u2264 1 and the\nfact (from (4.1)) that 0 < 2\u03bc < 1.\n\u0003\nSince g(\u03be) is clearly bounded by 1, and since \u03bc < 1/4 by (4.1), it follows that for\nevery \u03be\n(7.3)\n\nf (\u03be) \u2264 g(\u03be),\n\nwhich when combined with (7.2) gives\nP(X \u2208 V ) \u2264 P(Y \u2208 V ).\nWe now refine this argument to exploit the additional (and critical) hypothesis (4.3)\nthat\nP(X \u2208 V ) \u2265 \u03b51 P(Y \u2208 V ).\nLet \u01eb2 > 0 be a sufficiently small positive constant (compared to \u01eb1 ). Define the\nspectrum \u039b \u2286 F of {a1 , . . . , an } to be the set\n(7.4)\n\n\u039b := {\u03be \u2208 F : f (\u03be) \u2265 \u03b52 }\n\nNote that \u039b is symmetric around the origin: \u039b = \u2212\u039b. Next we make the elementary\nobservation that\n1\nkxk2\n(7.5)\n1 \u2212 100kxk2 \u2264 cos(2\u03c0x) \u2264 1 \u2212\n100\n(say), where kxk is the distance of x to the nearest integer. From (7.1) we thus\nhave (with room to spare)\nn\n\nf (\u03be) \u2264 exp(\u2212\n\n1 X\nkaj * \u03be/pk2 )\n1000 j=1\n\nand hence there is a constant C(\u01eb2 ) depending on \u01eb2 such that\n\n\f18\n\nTERENCE TAO AND VAN VU\n\nn\nX\nkaj * \u03be/pk2 )1/2 \u2264 C(\u03b52 )\n(\n\n(7.6)\n\nj=1\n\nfor all \u03be \u2208 \u039b.\n\nWe now obtain some cardinality bounds on \u039b and of the iterated sumsets k\u039b.\nLemma 7.2. There is a constant C depending on \u01eb0 , \u01eb1 , \u01eb2 such that\nC \u22121 2\u2212(n\u2212d\u00b1 ) |F | \u2264 |\u039b| \u2264 C2\u2212(n\u2212d\u00b1 ) |F |\n\n(7.7)\n\nFurthermore, for every integer k \u2265 4\n\u0012\n\u0013\nC+k\u22123\n(7.8)\n|k\u039b| \u2264\nC2\u2212(n\u2212d\u00b1 ) |F |.\nk\u22122\nRemark 7.3. The lemma implies that \u039b has a small doubling constant. At this\npoint one could apply Theorem 6.2 to gain further control on \u039b. While this can be\ndone, it is more convenient for us to apply the inverse Fourier transform and work\non a certain \"dual\" set to \u039b, which then contains most of the aj . A key point in\n(7.8), which we will exploit in the proof of Lemma 7.4 below, is that the growth of\nconstants is only polynomial in k rather than exponential.\nSince \u01ebi depends on \u01eb0 , . . . , \u01ebi\u22121 , it would suffice to say that C depends only on \u01eb0 .\nProof. From (4.3), (7.2) we have\n1 X\n|F |\n\n\u03be\u2208F\n\nf (\u03be) \u2265 \u03b51\n\n1 X\ng(\u03be).\n|F |\n\u03be\u2208F\n\nBut from Lemma 7.1, the definition of \u039b, and the crucial fact that \u03bc < 1/4, we\nknow that\n1 X 4\u03bc\n1 X\nf (\u03be) \u2264 \u03b521\u22124\u03bc\nf (\u03be)\n|F |\n|F |\n\u03be6\u2208\u039b\n\n\u03be6\u2208\u039b\n\n1 X\n\u2264 \u03b521\u22124\u03bc\ng(\u03be).\n|F |\n\u03be\u2208F\n\nNow we are going to make an essential use of the assumption that \u03bc is less than\n1/4. Given this assumption, we can guarantee that the contribution of \u03be outside\nthe spectrum is negligible, by choosing \u03b52 sufficiently compared to \u03b51 . This results\nin the following equalities\n\nX\n\n\u03be\u2208\u039b\n\nf (\u03be) = \u0398(\n\nX\n\n\u03be\u2208F\n\nf (\u03be)) = \u0398(\n\nX\n\n\u03be\u2208F\n\ng(\u03be)) = \u0398(|F |P(X \u2208 V )) = \u0398(2d\u00b1 \u2212n |F |),\n\nwhere the constants in the \u0398() notation depend on \u01eb0 , \u01eb1 , \u01eb2 . The bounds on |\u039b|\nnow follows directly from the fact that for any \u03be \u2208 \u039b, \u01eb2 \u2264 f (\u03be) \u2264 1.\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n19\n\nIt remains to prove (7.8). In view of Lemma 6.4, it suffices to show that there is a\nconstant C such that\n\n|4\u039b| \u2264 C|\u039b|.\nNotice that if \u03be \u2208 4\u039b, then by (7.6) and the triangle inequality we have\nn\nX\nkaj * \u03be/pk2 )1/2 \u2264 C(\u03b52 ),\n(\nj=1\n\nfor some constant C(\u01eb2 ) depending on \u01eb2 (we abuse the notation a little bit, as the\ntwo C(\u01eb2 ) are not necessarily the same). From (7.5), (7.1) we conclude a bound of\nthe form\n\nf (\u03be) \u2265 c(\u03b52 ) > 0.\nThus\n\n|4\u039b| \u2264 c(\u03b52 )\u22121\n\nX\n\n\u03be\u2208G\n\nf (\u03be) \u2264 c(\u03b52 )\u22121\n\nX\n\n\u03be\u2208F\n\ng(\u03be) = \u0398(2d\u00b1 \u2212n |F |) = \u0398(|\u039b|)\n\nconcluding the proof.\n\u0003\nWe now pass from control of the spectrum back to control on {a1 , . . . , an }, using\nthe inverse Fourier transform. For any x \u2208 F , define the norm kxk\u039b by\n\u00111/2\n\u0010 1 X\n.\nkx(\u03be \u2212 \u03be \u2032 )/pk2\nkxk\u039b :=\n2\n|\u039b|\n\u2032\n\u03be,\u03be \u2208\u039b\n\nIt is easy to see that this is a quantity between 0 and 1 which obeys the triangle\ninequality kx + yk\u039b \u2264 kxk\u039b + kyk\u039b . From the triangle inequality again we have\n1 X\n1 X\nkxk\u039b \u2264 ( 2\nkx\u03be/pk2 )1/2 + ( 2\nkx\u03be \u2032 /pk2 )1/2\n|\u039b|\n|\u039b|\n\u2032\n\u2032\n\u03be,\u03be \u2208\u039b\n\n1 X\nkx\u03be/pk2 )1/2 .\n= 2(\n|\u039b|\n\n\u03be,\u03be \u2208\u039b\n\n\u03be\n\nThus by square-summing (7.6) for all \u03be \u2208 \u039b, we obtain\n(7.9)\n\nn\nX\nj=1\n\nkaj k2\u039b \u2264 C(\u03b52 ).\n\n\f20\n\nTERENCE TAO AND VAN VU\n\nThus we expect many of the aj to have small \u039b norm. On the other hand, we are\ngoing to show that the set of elements with small \u039b norm has constant doubling\nnumber, thanks to the following lemma.\nLemma 7.4. There is a constant C such that the following holds. Let A \u2286 F\ndenote the \"Bohr set\"\n1\nA := |{x \u2208 F : kxk\u039b \u2264\n}|.\n100\nThen we have\nC \u22121 2n\u2212d\u00b1 \u2264 |A| \u2264 |A + A| \u2264 C2n\u2212d\u00b1 .\nProof. Let us first establish the upper bound. We introduce the normalized Fourier\ntransform of \u039b:\n1 X\nh(x) :=\nep (x\u03be).\n|\u039b|\n\u03be\u2208\u039b\n\nIf x \u2208 A + A, then we have kxk\u039b \u2264\nconclude\n\n1\n50\n\nby the triangle inequality. Using (7.5), we\n\n|h(x)|2 = Rh(x)h(x)\n1 X\n=R 2\nep (x(\u03be \u2212 \u03be \u2032 ))\n|\u039b|\n\u2032\n=\n\n1\n|\u039b|2\n\n\u03be,\u03be \u2208\u039b\n\nX\n\n\u03be,\u03be \u2032 \u2208\u039b\n\ncos(2\u03c0x(\u03be \u2212 \u03be \u2032 )/p)\n\n1 X\n\u2265\n1 \u2212 100kx(\u03be \u2212 \u03be \u2032 )/pk2\n|\u039b|2 \u2032\n\u03be,\u03be \u2208\u039b\n\n= 1 \u2212 100kxk2\u039b .\n\nAs kxk\u039b \u2264\n\n1\n50 ,\n\nit follows that\n\n|h(x)| \u2265\n\np\n1 \u2212 100(1/50)2 > 1/2.\n\nOn the other hand, from the Parseval identity we have\nX\n(7.10)\n|h(x)|2 = |F |/|\u039b|;\nx\u2208F\n\ncombining these two estimates we obtain\n\n|A + A| \u2264 4|F |/|\u039b|\nand the claim now follows from (7.7).\nSince the bound |A| \u2264 |A + A| is trivial, it now suffices to prove the lower bound\non A. This proof has two parts. First we show that if |h(x)| is large (close to 1),\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n21\n\nthen kxk\u039b is small (close to zero). Next, we prove that there are many x such that\n|h(x)| is large.\nThe first part is simple and similar to the above argument. Using the fact that\n1\nkxk\u039b \u2264 50\nand (7.5), we have\n|h(x)|2 = Rh(x)h(x)\n1 X\n=R 2\nep (x(\u03be \u2212 \u03be \u2032 ))\n|\u039b|\n\u2032\n\u03be,\u03be \u2208\u039b\n\n1 X\ncos(2\u03c0x(\u03be \u2212 \u03be \u2032 )/p)\n=\n|\u039b|2 \u2032\n\u03be,\u03be \u2208\u039b\n\n\u2264\n\n1 X\n1\nkx(\u03be \u2212 \u03be \u2032 )/pk2\n1\u2212\n|\u039b|2 \u2032\n100\n\u03be,\u03be \u2208\u039b\n\n1\nkxk2\u039b .\n100\nIt follows that if |h(x)| \u2265 1 \u2212 10\u22124 then x \u2208 A.\n=1\u2212\n\nNow we are going to show that the set of those x such that |h(x)| \u2265 1 \u2212 10\u22124 has\ncardinality \u0398(2n\u2212d\u00b1 ). This proof is trickier and we need to adapt an argument from\n[7] (see also [8]), which requires the full strength of (7.8). Let k be a large integer\nto be chosen later, and for each \u03be \u2208 F , let rk (\u03be) be the number of representations\nof the form \u03be = \u03be1 + . . . + \u03bek where \u03be1 , . . . , \u03bek \u2208 \u039b. Clearly we have\nX\nrk (\u03be) = |\u039b|k\n\u03be\u2208k\u039b\n\nand so by Cauchy-Schwarz\nX\n\n\u03be\u2208F\n\nBy Plancherel we have\nX\n\u03be\u2208F\n\n|rk (\u03be)|2 \u2265 |\u039b|2k /|k\u039b|.\n\n|rk (\u03be)|2 =\n\n1 X X\n|\nrk (\u03be)ep (x\u03be)|2 .\n|F |\nx\u2208F\n\n\u03be\u2208F\n\nBut we have\n|\n\nX\n\n\u03be\u2208F\n\nrk (\u03be)ep (x\u03be)| = |\n\nX\n\nep (x(\u03be1 + . . . + \u03bek )|\n\n\u03be1 ,...,\u03bek \u2208\u039b\n\n= |\u039b|k |h(x)|k\n\nand hence\nX\n\nx\u2208F\n\n|h(x)|2k \u2265 |F |/|k\u039b|.\n\nCombining this with (7.10) we obtain\nX\n\nx\u2208F :|h(x)|\u2265(|\u039b|/2|k\u039b|)1/(2k\u22122)\n\n|h(x)|2k \u2265 |F |/2|k\u039b|;\n\n\f22\n\nTERENCE TAO AND VAN VU\n\nsince h(x) is trivially bounded by 1, we thus conclude\n|{x \u2208 F : |h(x)| \u2265 (|\u039b|/2|k\u039b|)1/(2k\u22122) }| \u2265 |F |/2|k\u039b|.\nInserting the bounds (7.7), (7.8) we have\n\n1/(2k\u22122)\n\n(|\u039b|/2|k\u039b|)\n\n\u0012\n\u0013\nC +k\u22123\n\u2265[\nC]1/(2k\u22122)\nk\u22122\n\nfor some constant C. Choose k sufficiently large (say k = C 2 + 1010 ) we can\nguarantee that the right hand side is at least 1 \u2212 10\u22124 . On the other hand k is still\na constant, so |k\u039b| = O(2d\u00b1 \u2212n |F |). It follows that\n|{x \u2208 F : |h(x)| \u2265 1 \u2212 10\u22124 }| = \u0398(2n\u2212d\u00b1 ),\nproving the lower bound on A.\n\n\u0003\n\n8. Proof of Structure Theorem\nWe are now in position to prove the Structure Theorem. In this section we allow the\nconstants in the O() notation to depend on \u01eb0 , \u01eb1 , \u01eb2 . From Lemma 7.4 we already\nknow that A has doubling constant O(1). Furthermore, it is easy to show that A\ncontains most of the ai . Indeed, if ai is not in A then its \u039b-norm is at least 1/100;\n(7.9) then shows that\n|{1 \u2264 i \u2264 n : ai 6\u2208 A}| = O(1).\nWe now apply Theorem 6.2 to A, to conclude that there is a generalized arithmetic\nprogression P of rank O(1) containing A and with |A| = \u0398(|P |) = \u0398(2n\u2212d\u00b1 ). By\nLemma 6.3 we can assume that P is proper (note that every non-zero element of\nF has order |F | = p \u2265 nn/2 , which is certainly much larger than |A|).\nThis progression P is close to, but not quite, what we need for the structure theorem. Thus we shall now perform a number of minor alterations to P in order\nto make it exactly match the conclusions of the structure theorem. Each of our\nalterations will preserve the following properties claimed in the structure theorem,\nnamely\n(8.1)\n\nrank(P ) = O(1) and\n\n(8.2)\n\n|P | = M1 . . . Mr = O(2n\u2212d\u00b1 ),\n\nthough of course the O() constants may worsen with each of the alterations.\nFirst, we can include the elements of {a1 , . . . , an }\\A in P simply by adding each\nexceptional aj as a new basis vector vj\u2032 (with the corresponding length Mj\u2032 set equal\nto 3). This enlargement of P (which by abuse of notation we shall continue to call\nP ) now contains A and all of the aj , and obeys the bounds (8.1), (8.2) with slightly\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n23\n\nworse constants. Notice that by Lemma 6.3 we can always assume P is proper,\nwithout affecting the validity of (8.1) and (8.2) other than in the constants.\nIt now remains to verify the estimate (5.5) on the P -norm, as well as the rational\ncommensurability claim.\nP\nTo verify (5.5), consider the sum j kaj k2P . For the exceptional aj (which were\nadded to P afterwards) kaj kP = O(1). However, the number of these aj is O(1).\n1\n. Thus, (5.5)\nFor the remaining aj , notice that P contains kaj for all k < 100ka\nj k\u039b\nP\n2\nfollows from (7.9) which asserts that j kaj k\u039b = O(1). This leaves the verification\nof the rational commensurability as the only remaining task.\nLet us, as usual, write\nP = {m1 v1 + * * * + mr vr | \u2212 Mj /2 \u2264 mj \u2264 Mj /2}.\nWe consider P together with the map \u03a6 : P \u2192 Rr which maps m1 v1 +* * *+mr vr to\n(m1 , . . . , mr ). Since P is proper, this map is bijective. We set U := {a1 , . . . , an } \u2286\nP.\nWe know that the progression P contains U , but we do not know yet that U \"spans\"\nP in the sense that the set \u03a6(U ) has full rank (i.e., it spans Rr ). However, this\nis easily rectified by a rank reduction argument. Suppose that \u03a6(U ) did not have\nfull rank, we are going to produce a new proper generalized arithmetic progression\nP \u2032 which still contains U and satisfies (8.2) but has rank strictly smaller than the\nrank of P . Since the rank of P is O(1), the process must terminate after at most\nO(1) iterations.\nWe are going to produce P \u2032 as follows. If \u03a6(U ) does not have full rank, then it is contained in a hyperplane of Rr . In other words, there exist integers \u03b11 , . . . , \u03b1r whose\ngreatest common divisor is one and \u03b11 m1 + . . . + \u03b1r mr = 0 for all (m1 , . . . , mr ) \u2208\n\u03a6(U ). Let w be an arbitrary element of F and replace the each basis vector vj in\nP by vj \u2212 \u03b1j w. The new progression P \u2032 will continue to contain U , since we have\nm1 (v1 \u2212 \u03b11 w) + . . . + mr (vr \u2212 \u03b1r vr ) = m1 v1 + . . . + mr vr\nfor all (m1 , . . . , mr ) \u2208 \u03a6(U ). We can assume, without loss of generality, that \u03b1r is\nnot divisible by p, the characteristic of F (at least one of the \u03b1j must be so). Select\nw so that\n\nvr \u2212 \u03b1r w = 0.\nThis shows that P \u2032 has rank r \u2212 1. Moreover, its volume is M1 , . . . Mr\u22121 which is\nat most the volume of P . We can use Lemma 6.3 to guarantee that P \u2032 is proper\nwithout increasing the rank. Furthermore, it is easy to see that (5.5) is still valid\nwith respect to P \u2032 . The argument is completed. Thus, from now on we can assume\nthat \u03a6(U ) spans Rr . This information will be useful later on.\n\n\f24\n\nTERENCE TAO AND VAN VU\n\nDefine a highly rational number to be a number (in Q or F ) which is of the form\na/b where a, b are integers such that a, b = no(n) and b 6= 0. Define a highly\nrational linear combination of vectors w1 , . . . , wk to be any expression of the form\nq1 w1 + . . . + qk wk where q1 , . . . , qk are highly rational.\nWe say that a set W (of vectors) economically spans a set U (of vectors) if there are\nnumbers a, b = no(n) such that each u \u2208 U can be represented as a highly rational\nlinear combination of vectors in W where the numerators and denominators of the\ncoefficient are uniformly bounded from above by a and b, respectively.\nThe moral of our arguments below is the following: with respect to a bounded\nnumber of operations, any linear algebraic statement which holds for \"span\" also\nholds for \"economically span\". This relies on the fact that any algebraic expression\ninvolving at most O(1) highly rational numbers will again produce a highly rational\nnumber. In other words, the highly rational numbers behave heuristically like a\nsubfield of F .\nLet us now turn to the details. First we make some simple remarks about the notion\nof economically spanning. It is a transitive in the sense that if W economically\nspans U and U economically span T , then W economically spans T (but with\nslightly worse o(n) constants). Furthermore, it is closed under union, in the sense\nthat if W economically spans X and Y , then it economically spans the union of X\nand Y . Of course we are going to use these rules only a bounded number O(1) of\ntimes.\nConsider the set of vectors U := {a1 , . . . , an }. We know that there is a set of\nvectors of cardinality r which economically span U , namely {v1 , . . . , vr }. Now we\nare going to make use of the fact that \u03a6(U ) spans Rr . Since each vector in \u03a6(U )\nhas coordinates at most max1\u2264i\u2264n Mi \u2264 2n = no(n) and r = O(1), it follows from\nCramer's rule that \u03a6(U ) economically spans the basic vectors {e1 , . . . , er }. As the\nmap \u03a6 is bijective (P is proper), this means U economically spans {v1 , . . . , vr }.\nWe now claim that in fact there is a single element v1 which economically spans U .\nThis clearly implies rational commensurability.\nLet s be the smallest number such that there is a subset of size s of v1 , ...vr economically spanning U . Without loss of generality, we assume that v1 , ..., vs spans\nU and write\n\n(8.3)\n\nai =\n\ns\nX\n\ncij vj ,\n\nj=1\n\nwhere cij are highly rational. Let us now consider two cases:\n\u2022 The matrix C = (cij ) has rank one. In this case the numbers ai /aj are\nhighly rational (as all the cij are). But \u03a6(U ) has full rank in Rr and\neconomically spans v1 , .., vr , so vi /vj are also highly rational. This means\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n25\n\nthat v1 (or any of the vi , for that matter) economically spans v1 , . . . , vr ,\nand hence also U by transitivity.\n\u2022 The matrix C has rank larger than one. Recall that (a1 , .., an ) is the normal\nvector of a hyperplane spanned by \u00b11 vectors. Thus, there is a \u00b11 vector w\nwhich is orthogonal to a = (a1 , ...an ), but not orthogonal to C. Express the\ninner product of a and w as a linear combination of v1 , . . . , vs using (8.3).\nObserve that all of the coefficients are highly rational. Moreover, the value\nof the combination is 0, but there is at least one non-zero coefficient. This\nimplies that we can express one of v1 , . . . , vs as a linear combination of the\nothers with highly rational coefficients and this contradicts the minimality\nof s.\nThe proof of the structure theorem is complete.\n\n9. Appendix: Proof of Lemma 6.3\nIn this section we give a proof of Lemma 6.3. This result appears to be \"folklore\",\nbeing discovered independently by Gowers and Walters (private communication)\nand Ruzsa (private communication), but does not appear to be explicitly in the\nliterature.\nWe first need some notation and tools from the geometry of numbers. The first\ntool is the following theorem of Mahler on bases of lattices, which is a variant of\nMinkowski's second theorem (and is in fact proven using this theorem).\nLemma 9.1. Let \u0393 be a lattice of full rank in Rd (i.e. a discrete additive subgroup of Rd with d linearly independent generators). Then there exists linearly\nindependent vectors w1 , . . . , wd \u2208 \u0393 which generate \u0393, and such that\n(9.1)\n\n|w1 | . . . |wd | \u2264 (Cd)Cd mes(Rd /\u0393)\n\nwhere mes(Rd /\u0393) is the volume of a fundamental domain of \u0393 and C > 0 is an\nabsolute constant.\nProof. (Sketch) Note that the standard Minkowski basis v1 , . . . , vd of \u0393 (with respect to the unit ball Bd ) will obey (9.1) but need not generate \u0393 (consider for\ninstance the lattice generated by Zd and ( 12 , . . . , 21 ) for dimensions d \u2265 5). However, a simple algorithm of Mahler gives a genuine basis w1 , . . . , wd of \u0393 such that\nwj = tj,1 v1 + . . . + tj,j vj for some real scalars |tj,i | \u2264 1, which thus also obeys (9.1)\nwith some degradation in the (Cd)Cd factor. See, for instance [3, Chapter 8] for\nmore details.\n\u0003\nIf d \u2265 1 is an integer, and M = (M1 , . . . , Md ) and N = (N1 , . . . , Nd ) are elements\nof Rd such that Mi \u2264 Ni for all 1 \u2264 i \u2264 d, we use [M, N ] to denote the discrete\nbox\n[M, N ] := {(n1 , . . . , nd ) \u2208 Zd : Mi \u2264 ni \u2264 Ni for all 1 \u2264 i \u2264 d}.\n\n\f26\n\nTERENCE TAO AND VAN VU\n\nAlso, if G is an additive group, n = (n1 , . . . , nd ) \u2208 Zd , and v = (v1 , . . . , vd ) \u2208 Gd ,\nwe use n * v \u2208 G to denote the quantity n * v = n1 v1 + . . . + nd vd , where of course we\nuse nx := x + . . . + x to denote the n-fold sum of x (with the obvious modification\nif n is negative). We also use [M, N ] * v \u2286 G to denote the set [M, N ] * v := {n * v :\nn \u2208 [M, N ]}. Note that a progression of rank d in G is nothing more than a set of\nthe form a + [0, N ] * v for some a \u2208 G, some d-tuple N = (N1 , . . . , Nd ) \u2208 Zd+ , some\nother d-tuple v = (v1 , . . . , vd ) \u2208 Gd .\nWe now give a \"discrete John's theorem\" which shows that the intersection of a\nconvex symmetric body (i.e. a bounded open convex symmetric subset of Rd ) and\na lattice of full rank is essentially equivalent to a progression.\nLemma 9.2 (Discrete John's theorem). Let B be a convex symmetric body in Rd ,\nand let \u0393 be a lattice in Rd of full rank. Then there exists a d-tuple\nw = (w1 , . . . , wd ) \u2208 \u0393d\nof linearly independent vectors in \u0393 and and a d-tuple N = (N1 , . . . , Nd ) of positive\nintegers such that\n(\u2212N, N ) * w \u2286 B \u2229 \u0393 \u2286 (\u2212dCd N, dCd N ) * w\nwhere C is an absolute constant.\nProof. We first observe using John's theorem [10] and an invertible linear transformation that we may assume without loss of generality that Bd \u2286 B \u2286 d * Bd , where\nBd is the unit ball in Rd . We may assume d \u2265 2 since the claim is easy otherwise.\nNow let w = (w1 , . . . , wd ) be as in Lemma 9.1. For each j, let Nj be the least\ninteger greater than 1/d|wj |. Then from the triangle inequality we see that |n1 w1 +\n. . . + nd wd | < 1 whenever |nj | < Nj , and hence (\u2212N, N ) * w is contained in Bd and\nhence in B.\nNow let x \u2208 B \u2229 \u0393. Since w generates \u0393, we have x = n1 w1 + . . . + nd wd for some\nintegers n1 , . . . , nd ; since B \u2286 d * Bd , we have |x| \u2264 d. Applying Cramer's rule to\nsolve for n1 , . . . , nd and (9.1), we have\n|x \u2227 w1 . . . wj\u22121 \u2227 wj+1 \u2227 wd |\n|w1 \u2227 . . . \u2227 wd |\n|x||w1 | . . . |wd |\n\u2264\n|wj ||w1 \u2227 . . . \u2227 wd |\n\n|nj | =\n\n\u2264 ddCd /|wj |\n\u2032\n\n\u2264 dC d Nj ,\n\nand hence x \u2208 (\u2212dCd N, dCd N ) * w as desired.\n\n\u0003\n\nWe can now prove Lemma 6.3, which we restate here with slightly different notation.\nLemma 9.3. There is a constant C0 such that the following holds. Let P be a\nsymmetric progression of rank d in a abelian group G, such that every non-zero\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n27\n\n3\n\nelement of G has order at least dC0 d |P |. Then there exists a symmetric proper\nprogression Q of rank at most d containing P and\n3\n\n|Q| \u2264 dC0 d |P |.\nProof. This claim is analogous to the basic linear algebra statement that every\nlinear space spanned by d vectors is equal to a linear space with a basis of at most\nd vectors. Recall that the proof of that linear algebra fact proceeds by a descent\nargument, showing that if the d spanning vectors were linearly dependent, then one\ncould exploit that dependence to \"drop rank\" and span the same linear space with\nd \u2212 1 vectors.\nWe may assume that P has the form P = [\u2212N/2, N/2]*v for some N = (N1 , . . . , Nd )\nand v = (v1 , . . . , vd ). We induct on d. The case d = 1 is easy. Now suppose\ninductively that d \u2265 2, and the claim has already been proven for d\u22121 (for arbitrary\ngroups G and arbitrary progressions P ). Thanks to the induction hypothesis, we\ncan assume that P is non-proper and all Ni are at least one. As P is not proper,\nthere is n 6= n\u2032 \u2208 [\u2212N/2, N/2] such that\nn * v = n\u2032 * v.\n\nLet \u03930 \u2286 Zd denote the lattice {m \u2208 Zd : m*v = 0}, then it follows that \u03930 \u2229[\u2212N, N ]\ncontains at least one non-zero element, namely n\u2032 \u2212 n.\nLet m = (m1 , . . . , md ) be a non-zero irreducible element of \u03930 \u2229 [\u2212N, N ] (i.e.\nm/n 6\u2208 \u03930 for any integer n > 1). By definition\n(9.2)\n\nm * v = m1 * v1 + . . . + md * vd = 0.\n\nWe now claim that m is irreducible in Zd (i.e. that m1 , . . . , md have no common\ndivisor). Indeed, if m factored as m = nm\u0303 for some n > 1 and m\u0303 \u2208 Zd , then m\u0303 * v\nwould be a non-zero element of G of order n \u2264 |P |, contradicting the hypothesis.\nOur plan is to contain P inside a symmetric progression Q of rank d \u2212 1 and\ncardinality\n(9.3)\n\n2\n\n|Q| \u2264 dCd |P |.\n\nIf we can achieve this, then by the induction hypothesis we can contain Q inside a\nproper symmetric progression R of rank at most d \u2212 1 and cardinality\n3\n\n2\n\n|R| \u2264 (d \u2212 1)C0 (d\u22121) (Cd)Cd |P |.\nIf C0 is sufficiently large (but still independent of d) , then the right-hand side is\n3\nat most dC0 d |P |, and we have closed the induction hypothesis.\nIt remains to cover P by a symmetric progression of rank at most d \u2212 1 with the\nbound (9.3). Observe that m lies in [\u2212N, N ], so the rational numbers\nm1 /N1 , . . . , md /Nd\n\n\f28\n\nTERENCE TAO AND VAN VU\n\nlie between \u22121 and 1. Without loss of generality we may assume that md /Nd has\nthe largest magnitude, namely\n(9.4)\n\n|md |/Nd \u2265 |mi |/Ni\n\nfor all 1 \u2264 i \u2264 d. By replacing vd with \u2212vd if necessary, we may also assume that\nmd is positive.\nTo exploit the cancellation in (9.2) we introduce the rational vector q \u2208\nby the formula\nm1\nmd\u22121\nq := (\u2212\n,...,\u2212\n).\nmd\nmd\n\n1\nmd\n\n* Zd\u22121\n\nSince gcd(m1 , . . . , md ) = 1, we see that for any integer n, that n * q lies in Zd\u22121 if\nand only if n is a multiple of md .\nNext, let \u0393 \u2282 Rd\u22121 denote the lattice \u0393 := Zd\u22121 + Z * q. Since q is rational, this is\nindeed a full rank lattice. We define the homomorphism f : \u0393 \u2192 Z by the formula\nf ((n1 , . . . , nd\u22121 ) + nd q) := (n1 , . . . , nd ) * v.\nthe condition (9.2) ensures that this homomorphism is indeed well defined, in the\nsense that different representations w = (n1 , . . . , nd\u22121 ) + nd q of the same vector\nw \u2208 \u0393 give the same value of f (w). We also let B \u2286 Rd\u22121 denote the convex\nsymmetric body\nB := {(t1 , . . . , td\u22121 ) \u2208 Rd\u22121 : \u22123Nj < tj < 3Nj for all 1 \u2264 j \u2264 d \u2212 1}.\nWe now claim the inclusions\nP \u2286 f (B \u2229 \u0393) \u2286 5P \u2212 5P.\nTo see the first inclusion, let n * v \u2208 P for some n \u2208 [0, N ], then we have n * v =\nf ((n1 , . . . , nd\u22121 )+nd q). From (9.4) we see that the j th co-efficient of (n1 , . . . , nd\u22121 )+\nnd q has magnitude at most 3Nj , and thus n*v lies in f (B \u2229\u0393) as claimed. To see the\nsecond inclusion, let (n1 , . . . , nd\u22121 ) + nd q be an element of B \u2229 \u0393. By subtracting\nan integer multiple of md from nd if necessary (and thus adding integer multiples\nof m1 , . . . , md\u22121 to n1 , . . . , nd\u22121 ) we may assume that |nd | \u2264 |md |/2. By (9.4) and\nthe definition of B, this forces |nj | \u2264 5Nj for all 1 \u2264 j \u2264 d, and hence\nf ((n1 , . . . , nd\u22121 ) + nd q) = (n1 , . . . , nd ) * v \u2286 [\u22125N, 5N ] * v = 5P \u2212 5P.\nNext, we apply Theorem 9.2 to find vectors w1 , . . . , wd\u22121 \u2208 \u0393 and M1 , . . . , Md\u22121\nsuch that\n(\u2212M, M ) * w \u2286 B \u2229 \u0393 \u2286 (\u2212dCd M, dCd M ) * w.\nApplying the homomorphism f , we obtain\n(\u2212M, M ) * f (w) \u2286 f (B \u2229 \u0393) \u2286 (\u2212dCd M, dCd M ) * f (w)\nwhere f (w) := (f (w1 ), . . . , f (wd\u22121 ). Observe that (\u2212dCd M, dCd M ) * f (w) is a\nsymmetric progression of rank d \u2212 1 which contains f (B \u2229 \u0393) and hence contains\n2\nP . Also, since (\u2212dCd M, dCd M ) * f (w) can be covered by O((Cd)Cd ) translates of\n\n\fON THE SINGULARITY PROBABILITY OF RANDOM BERNOULLI MATRICES\n\n29\n\n(\u2212M, M ) * f (w), and similarly 5P \u2212 5P can be covered by O(C d ) translates of P ,\nwe have\n2\n\n|(\u2212dCd M, dCd M ) * f (w)| \u2264 (Cd)Cd |f (B \u2229 \u0393)|\n2\n\n\u2264 (Cd)Cd |5P \u2212 5P |\n2\n\n\u2264 (Cd)Cd ) C d |P |\n\nwhich proves (9.3). This completes the induction and proves the theorem.\n\n\u0003\n\nRemark 9.4. It is not hard to remove the hypothesis that G is \"nearly torsion free\"\nin the sense that the order of every non-zero element is much larger than P , however\none must then drop the conclusion that Q is symmetric (this can be seen simply\nby considering the case G = Z/2Z).\n\nReferences\n[1] Y. Bilu, Structure of sets with small sumset. Structure theory of set addition. Astrisque No.\n258 (1999), xi, 77\u2013108.\n[2] Y. Bilu, V. Lev, I. Ruzsa, Rectification principles in additive number theory, Discrete Comput.\nGeom. 19 (1998), 343\u2013353.\n[3] J. W.S. Cassels, An introduction to the geometry of numbers, Springer, Berlin, 1959.\n[4] M. Chang, A polynomial bound in Freiman's theorem, Duke Math. J. 113 (2002), no. 3,\n399\u2013419.\n[5] P. Erd\u00f6s, On a lemma of Littlewood and Offord, Bull. Amer. Math. Soc. 51 (1945), 898\u2013902.\n[6] G. Freiman, Foundations of a structural theory of set addition. Translated from the Russian. Translations of Mathematical Monographs, Vol 37. American Mathematical Society,\nProvidence, R. I., 1973. vii+108 pp.\n[7] B. Green, I. Ruzsa, Sets with small sumset and rectification, preprint.\n[8] B. Green, I. Ruzsa, Freiman's theorem in an arbitrary abelian group, preprint.\n[9] G. Hal\u00e1sz, Estimates for the concentration function of combinatorial number theory and\nprobability, Period. Math. Hungar. 8 (1977), no. 3-4, 197\u2013211.\n[10] F. John, Extremum problems with inequalities as subsidiary conditions, Studies and Essays\npresented to R. Courant on his 60th birthday, Jan 8. 1948, Interscience Publishers Inc., New\nYork, NY 1948, 187\u2013204.\n[11] J. Kahn, J. Koml\u00f3s, E. Szemer\u00e9di, On the probability that a random \u00b11 matrix is singular,\nJ. Amer. Math. Soc. 8 (1995), 223\u2013240.\n[12] J. Koml\u00f3s, On the determinant of (0, 1) matrices, Studia Sci. Math. Hungar. 2 (1967) 7-22.\n[13] J. Koml\u00f3s, On the determinant of random matrices, Studia Sci. Math. Hungar. 3 (1968)\n387\u2013399.\n[14] A. Odlyzko, On subspaces spanned by random selections of \u00b11 vectors, J. Combin. Theory\nSer. A 47 (1988), no. 1, 124\u2013133.\n[15] I. Ruzsa, Generalized arithmetical progressions and sumsets, Acta Math. Hungar. 65 (1994),\nno. 4, 379\u2013388.\n[16] I. Ruzsa, An analog of Freiman's theorem in groups, Structure theory of set addition,\nAst\u00e9risque No. 258 (1999), 323\u2013326.\n[17] T. Tao and V. Vu, On random \u00b11 matrices: Singularity and Determinant, Random Structures\nand Algorithms 28 (2006), no 1, 1-23.\n\n\f30\n\nTERENCE TAO AND VAN VU\n\nAbstract. Let n be a large integer and Mn be a random n by n matrix whose\nentries are i.i.d. Bernoulli random variables (each entry is \u00b11 with probability\n1/2). We show that the probability that Mn is singular is at most (3/4+o(1))n ,\nimproving an earlier estimate of Kahn, Koml\u00f3s and Szemer\u00e9di [11], as well as\nearlier work by the authors [17]. The key new ingredient is the applications of\nFreiman type inverse theorems and other tools from additive combinatorics.\n\n\f"}