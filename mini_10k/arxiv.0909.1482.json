{"id": "http://arxiv.org/abs/0909.1482v1", "guidislink": true, "updated": "2009-09-08T13:06:00Z", "updated_parsed": [2009, 9, 8, 13, 6, 0, 1, 251, 0], "published": "2009-09-08T13:06:00Z", "published_parsed": [2009, 9, 8, 13, 6, 0, 1, 251, 0], "title": "On positive Matrices which have a Positive Smith Normal Form", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.2611%2C0909.0799%2C0909.3172%2C0909.1511%2C0909.0729%2C0909.1391%2C0909.0311%2C0909.1140%2C0909.5114%2C0909.4184%2C0909.2171%2C0909.0690%2C0909.4626%2C0909.0836%2C0909.4550%2C0909.2458%2C0909.4146%2C0909.3776%2C0909.3870%2C0909.3446%2C0909.5222%2C0909.4906%2C0909.3490%2C0909.0741%2C0909.0552%2C0909.0601%2C0909.2895%2C0909.4330%2C0909.0774%2C0909.0938%2C0909.3031%2C0909.5032%2C0909.0703%2C0909.4195%2C0909.0820%2C0909.2696%2C0909.3794%2C0909.4994%2C0909.4773%2C0909.1979%2C0909.3724%2C0909.1678%2C0909.0374%2C0909.0758%2C0909.4327%2C0909.3554%2C0909.2155%2C0909.2969%2C0909.4109%2C0909.1108%2C0909.4672%2C0909.5431%2C0909.1780%2C0909.0031%2C0909.1482%2C0909.0720%2C0909.4830%2C0909.3762%2C0909.3267%2C0909.4214%2C0909.2026%2C0909.0454%2C0909.0894%2C0909.4834%2C0909.1868%2C0909.2814%2C0909.0491%2C0909.3134%2C0909.2789%2C0909.2706%2C0909.1902%2C0909.4572%2C0909.4875%2C0909.4965%2C0909.4489%2C0909.3537%2C0909.1340%2C0909.5137%2C0909.3989%2C0909.4741%2C0909.0860%2C0909.3699%2C0909.2188%2C0909.3878%2C0909.3660%2C0909.4273%2C0909.2091%2C0909.3922%2C0909.2923%2C0909.2023%2C0909.4231%2C0909.3823%2C0909.0990%2C0909.3884%2C0909.3632%2C0909.2882%2C0909.1157%2C0909.0250%2C0909.1270%2C0909.1547%2C0909.0077&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "On positive Matrices which have a Positive Smith Normal Form"}, "summary": "It is known that any symmetric matrix $M$ with entries in $\\R[x]$ and which\nis positive semi-definite for any substitution of $x\\in\\R$, has a Smith normal\nform whose diagonal coefficients are constant sign polynomials in $\\R[x]$. We\ngeneralize this result by considering a symmetric matrix $M$ with entries in a\nformally real principal domain $A$, we assume that $M$ is positive\nsemi-definite for any ordering on $A$ and, under one additionnal hypothesis\nconcerning non-real primes, we show that the Smith normal of $M$ is positive,\nup to association. Counterexamples are given when this last hypothesis is not\nsatisfied. We give also a partial extension of our results to the case of\nDedekind domains.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0909.2611%2C0909.0799%2C0909.3172%2C0909.1511%2C0909.0729%2C0909.1391%2C0909.0311%2C0909.1140%2C0909.5114%2C0909.4184%2C0909.2171%2C0909.0690%2C0909.4626%2C0909.0836%2C0909.4550%2C0909.2458%2C0909.4146%2C0909.3776%2C0909.3870%2C0909.3446%2C0909.5222%2C0909.4906%2C0909.3490%2C0909.0741%2C0909.0552%2C0909.0601%2C0909.2895%2C0909.4330%2C0909.0774%2C0909.0938%2C0909.3031%2C0909.5032%2C0909.0703%2C0909.4195%2C0909.0820%2C0909.2696%2C0909.3794%2C0909.4994%2C0909.4773%2C0909.1979%2C0909.3724%2C0909.1678%2C0909.0374%2C0909.0758%2C0909.4327%2C0909.3554%2C0909.2155%2C0909.2969%2C0909.4109%2C0909.1108%2C0909.4672%2C0909.5431%2C0909.1780%2C0909.0031%2C0909.1482%2C0909.0720%2C0909.4830%2C0909.3762%2C0909.3267%2C0909.4214%2C0909.2026%2C0909.0454%2C0909.0894%2C0909.4834%2C0909.1868%2C0909.2814%2C0909.0491%2C0909.3134%2C0909.2789%2C0909.2706%2C0909.1902%2C0909.4572%2C0909.4875%2C0909.4965%2C0909.4489%2C0909.3537%2C0909.1340%2C0909.5137%2C0909.3989%2C0909.4741%2C0909.0860%2C0909.3699%2C0909.2188%2C0909.3878%2C0909.3660%2C0909.4273%2C0909.2091%2C0909.3922%2C0909.2923%2C0909.2023%2C0909.4231%2C0909.3823%2C0909.0990%2C0909.3884%2C0909.3632%2C0909.2882%2C0909.1157%2C0909.0250%2C0909.1270%2C0909.1547%2C0909.0077&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "It is known that any symmetric matrix $M$ with entries in $\\R[x]$ and which\nis positive semi-definite for any substitution of $x\\in\\R$, has a Smith normal\nform whose diagonal coefficients are constant sign polynomials in $\\R[x]$. We\ngeneralize this result by considering a symmetric matrix $M$ with entries in a\nformally real principal domain $A$, we assume that $M$ is positive\nsemi-definite for any ordering on $A$ and, under one additionnal hypothesis\nconcerning non-real primes, we show that the Smith normal of $M$ is positive,\nup to association. Counterexamples are given when this last hypothesis is not\nsatisfied. We give also a partial extension of our results to the case of\nDedekind domains."}, "authors": ["Ronan Quarez"], "author_detail": {"name": "Ronan Quarez"}, "author": "Ronan Quarez", "links": [{"href": "http://arxiv.org/abs/0909.1482v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0909.1482v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.RA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.RA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "15-16", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0909.1482v1", "affiliation": "IRMAR", "arxiv_url": "http://arxiv.org/abs/0909.1482v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:0909.1482v1 [math.RA] 8 Sep 2009\n\nON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH\nNORMAL FORM\nRONAN QUAREZ\n\nAbstract. It is known that any symmetric matrix M with entries in R[x]\nand which is positive semi-definite for any substitution of x \u2208 R, has a Smith\nnormal form whose diagonal coefficients are constant sign polynomials in R[x].\nWe generalize this result by considering a symmetric matrix M with entries in a formally real principal domain A, we assume that M is positive\nsemi-definite for any ordering on A and, under one additionnal hypothesis\nconcerning non-real primes, we show that the Smith normal of M is positive,\nup to association. Counterexamples are given when this last hypothesis is not\nsatisfied.\nWe give also a partial extension of our results to the case of Dedekind\ndomains.\n\n1. Introduction\nArising in various areas in Mathematics, there is a seminal result (we refer to\n[5]) which says that any n \u00d7 n-symmetric matrix M with entries in R[x] which\nis positive for any substitution of x \u2208 R is a matricial sum of squares (it can be\nP2\nwritten M = i=1 Ni NiT where Ni is a n \u00d7 n-matrice with entries in R[x]). The\nproof of this result as given in [5] uses, as a prerequisite, that M has a smith normal\nform whose diagonal coefficients are polynomials in R[x] of constant sign. In this\narticle we are concern with this last property.\nSince any matrix with entries in a Principal Ideal Domain (PID in short) admits\na Smith Normal Form, we consider the following :\nQuestion 1.1. Let M be a symmetric square matrix with entries in a principal\nring A. Assume that M is positive semi-definite. Are all the diagonal elements of\nits Smith Normal Form positive semi-definite up to association ?\nBefore giving a precise meaning to this question in an abstract setting, we may\nnote that the answer to this question should clearly be positive whenever the matrix\nM is diagonal, i.e. when M is already given in its Smith Normal Form.\nIf A = R[x] the ring of all polynomials in one variable over the reals, then\nthe positivity of a matrix M in An\u00d7n can be understood as the positivity when\nevaluated at any point x \u2208 R, i.e. \u03c6y (M ) is positive-semi-definite (psd in short) for\nany evaluation ring-homomorphism \u03c6y : R[x] \u2192 R which maps p(x) onto p(y). The\nnatural extension is to consider what happens if we change A = R[x] with A = k[x]\nwhere k is any field. And more generally, when A is an abstract principal ring ?\nDate: November 21, 2018.\n1\n\n\f2\n\nRONAN QUAREZ\n\nIt appears to be quite natural to introduce the real spectrum of the ring A, which\nis the set of all couples (p, \u2264) where p is a prime ideal of A and \u2264 is an ordering onto\nthe field of fractions of A/p. The real spectrum of A can be described equivalently\nas the set of all ring-morphisms of A into a real closed field. See Section 2.1 for\nprecise definitions and properties.\nThen, saying that the matrix M is positive semi-definite will mean that it is\npositive semi-definite with respect to any point \u03b1 of Specr A, the real spectrum of\nA, i.e. the matrix \u03c6(M ) is positive semi-definite for any ring-morphism \u03c6 : A \u2192 R\nwhere R is a real closed field. This notion obviously coincides with the common\nnotion of positivity in the case A = R[x].\nFollowing the proof of [5], we answer Question 1.1 by the affirmative for all\nprincipal rings A such that any non-real irreducible can be associated to a positive\nnon-real irreducible, a condition called (PNRI) in the following. For instance,\n(PNRI) is satisfied when the real spectrum Specr A is a connected topological\nspace.\nThe first example of principal domains are rings of number fields : they are\ntreated in Section 6. The other wide class of rings with interesting arithmetic properties are rings of coordinates of affine irreducible non-singular curves. Althought\nonly few of them are principal, they all are Dedekind domains so, in secton 7 we\ngive some partial extensions of our framework to Dedekind domains.\n2. Preliminaries\nThe basic facts of this section are taken from [2] and for some others we will\nrefer to [1].\n2.1. The real spectrum of a ring. The ring A admits an ordering if and only if\n\u22121 is not sum of squares in A, we say then that A is formally real. A prime ideal p\nof A will be called real if the quotient ring A/p is formally real. For example, in an\nUnique Factorization Domain (UFD in short), an irreducible p will be called real if\nit generates a real prime ideal.\nThe real spectrum Specr A of a ring A is defined to be the set of all couples\n\u03b1 = (p, \u2264\u03b1 ) where p is a real prime ideal of A and \u2264\u03b1 is an ordering on A/p. We\nsay that p is the support of \u03b1 and denote it by p = supp(\u03b1). Equivalently, an\nelement \u03b1 \u2208 Specr A is given by of a morphism \u03c6 : A \u2192 R where R is a real closed\nfield. Given such a data, \u03c6\u22121 (0) = p is a real prime ideal and the unique ordering\non R induces an ordering \u2264\u03b1 onto A/p.\nIt is then clear that Specr K can be seen as a subset of Specr A where K stands\nfor the fraction field of a domain A.\nFor a given a \u2208 A, we say that a > 0 (resp. a \u2265 0) if for all \u03b1 \u2208 Specr A, a >\u03b1 0\n(resp. a \u2265\u03b1 0). Moreover, we note sgn[a](\u03b1) = +1 (respectively sgn[a](\u03b1) = \u22121,\nsgn[a](\u03b1) = 0) if a >\u03b1 0 (respectively a <\u03b1 0, a \u2208 supp(\u03b1)).\nNow, if M \u2208 An\u00d7n is a symmetric matrix with entries in A, we say that M is\npositive-semi-definite (psd in short) if for any morphism \u03c6 : A \u2192 R with R a real\nclosed field, the matrix \u03c6(M ) is psd.\nThe real spectrum of A has a natural topology admitting as a basis of open\nsubsets all the sets ({\u03b1 \u2208 Specr A | a >\u03b1 0})a\u2208A .\n\n\fON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH NORMAL FORM\n\n3\n\n2.2. Generizations. We say that \u03b2 is a generization of \u03b1 and we denote it by\n\u03b2 \u2192 \u03b1 if \u03b1 belongs to the closure of \u03b2. It is equivalent to saying that for all a \u2208 A,\nif a(\u03b2) \u2265 0, then a(\u03b1) \u2265 0.\nWe begin with an easy observation that will be used several time in the sequel.\nLemma 2.1. Let A be a UFD. Let also a = ps a\u2032 where s is an odd integer, p is a\nreal irreducible and p \u2224 a\u2032 (which means that p does not divide a\u2032 ). Let \u03b1 \u2208 Specr A\nand assume that there are two generizations \u03b1+ and \u03b1\u2212 of \u03b1 such that p >\u03b1+ 0\nand p <\u03b1\u2212 0. Then,\nsgn[a](\u03b1+ ) * sgn[a](\u03b1\u2212 ) = \u22121.\nProof. Indeed, by assumption sgn[p](\u03b1+ ) * sgn[p](\u03b1\u2212 ) = \u22121 and, since p \u2224 a\u2032 , we\nhave sgn[a\u2032 ](\u03b1+ ) = sgn[a\u2032 ](\u03b1\u2212 ) = sgn[a\u2032 ](\u03b1). Note also that (p) is prime since A is\nUFD, and so a\u2032 \u2208\n/ supp(\u03b1) = (p).\n\u0003\nWe will need also the following :\nLemma 2.2. Let p be an irreducible of a formally real domain A such that (p) is\na real prime ideal of A. Assume that A/(p) is regular. Then, for any \u03b1 \u2208 Specr A\nwhose support is (p) there are two generizations \u03b1+ , \u03b1\u2212 \u2208 Specr (K) where K is the\nfraction field of A. Moreover, we may take \u03b1+ , \u03b1\u2212 such that p >\u03b1+ 0 and p <\u03b1\u2212 0.\nProof. The ring A(p) is a discrete valuation ring of rank 1. Its fraction field is\nK and its residual field is k the fraction field of the ring A/(p). According to [1,\nII.Proposition 3.3], any ordering \u03b1 \u2208 Specr k admits at least two generizations in\nSpecr K as wanted.\n\u0003\n3. Unicity of the Smith Normal Form\nLet A be a domain, and consider the usual equivalence relation on the set of all\nmatrices in An\u00d7n : M \u223c N if there are two matrices P, Q \u2208 An\u00d7n invertibles in A\n(det P and det Q are units in A) such that M = P N Q.\nLet diag(a1 , . . . , an ) be the diagonal matrix in An\u00d7n whose coefficients onto the\ndiagonal are (a1 , . . . , an ).\nAbout the equivalence class of diagonal matrices, recall the well known result\nover a PID :\nTheorem 3.1. Let A be a PID. Then, any matrix M \u2208 An\u00d7n is equivalent to a\ndiagonal matrix D = diag(d1 , . . . , dr , 0, . . . , 0) with dk | dk+1 for all k = 1 . . . r \u2212 1.\nMoreover the dk 's are unique up to association.\nWe say then that D is the Smith Normal Form of the matrix M .\nIn fact, in this result the PID hypothesis is essential for the existence of the\nmatrix D. Although, the unicity can be obtained for any domain :\nProposition 3.2. Let A be a domain. Assume that D \u223c D\u2032 where D, D\u2032 \u2208 An\u00d7n\nare diagonal matrices : D = diag(d1 , . . . , dr , 0, . . . , 0) with dk | dk+1 for all k =\n1 . . . r \u2212 1 and D\u2032 = diag(d\u20321 , . . . , d\u2032s , 0, . . . , 0) with d\u2032k | d\u2032k+1 for all k = 1 . . . s \u2212 1.\nThen, we have r = s and (dk ) = (d\u2032k ) for all k.\nWe will include the proof for the convenience of the reader :\n\n\f4\n\nRONAN QUAREZ\n\nProof. Let K be the field of fractions of the domain A. Looking at the rank of the\nmatrices D and D\u2032 viewed in K n\u00d7n , we get r = rkK (D) = rkK (D\u2032 ) = s.\nFor any matrix M \u2208 An\u00d7n , let us introduce dk (M ) the ideal in A generated by\nall minors of order k of M .\nLemma 3.3. Let M = N P where M, N, P \u2208 An\u00d7n . Then, dk (M ) \u2282 dk (N ).\nProof. Let \u2206 be a k \u00d7 k minor of M = N P , say the minor of the first k rows and\ncolumns (to fix an example). Let Cik be the truncated columns of N of size k. Then\n\u2206 = det (p1,1 C1k + . . . + pn,1 Cnk , . . . , p1,k C1k + . . . + pn,k Cnk )\nwhere P = (pi,j ). Here \u2206 appears as a linear combination of minors of order\nk extracted from the first k lines of N . This implies that \u2206 is an element of\ndk (N ).\n\u0003\nSince the matrices P and Q are invertibles, by Lemma 3.3, we have dk (D) =\ndk (D\u2032 ) for all k. Now, since the matrices D and D\u2032 are diagonal it is easy to see\nthat these last two ideals are in fact principal and more precisely :\ndk (M ) = (d1 . . . dk ) and dk (N ) = (d\u20321 . . . d\u2032k )\nHence, we get (dk ) = (d\u2032k ) for all k.\n\n\u0003\n\n4. The main results\nAfter setting an abstract background, we will be able to settle our result, following the main steps of the proof given by Djokovic in [5].\nIn a given ring A that we may think at as a UFD, let us introduce two conditions.\nThe first one concerns the Positivity of Non-Real Irreducibles :\n(PNRI) Any non-real irreducible q in A can be associated to a non-real irreducible which is strictly positive on all Specr A.\nNext, we come to the second condition, relative to the Generization of a given\nReal Irreducible p such that (p) is prime :\n(GRI) There is \u03b1 \u2208 Specr A whose support is supp(\u03b1) = (p) and \u03b2 \u2208 Specr A\nwith support (0), such that \u03b2 is a generization of \u03b1.\nNote that the condition (GRI)is true with respect to any real prime (p) whenenever A/(p) is regular (confer the proof of Lemma 2.2 for this fact). For instance,\nthis condition will be automatically satisfied if A is a PID, since A/(p) is a field in\nthis case.\nNow, if A is a UFD, then for any irreducible p \u2208 A, we may define as usually\n\u03bdp (a) to be the p-valuation of an element a \u2208 A to be the maximal integer k such\nthat pk divides a.\nHere is the main result :\nTheorem 4.1. Let A be a regular UFD, M be a symmetric matrix in An\u00d7n which\nis positive semi-definite on Specr A. Assume that M admits a Smith Normal form,\ni.e. there are d1 | . . . |dr in A, such that M \u223c D = diag(d1 , . . . , dr , 0 . . . , 0).\n\n\fON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH NORMAL FORM\n\n5\n\nAssume furthermore that the ring A satisfies the condition (PNRI) and the\ncondition (GRI) with respect to any real-irreducible p dividing some dk and which\ndoes change of sign on Specr A.\nThen, for all k = 1 . . . r, the element dk \u2208 A can be associated to an element\nd\u2032k \u2208 A which is such that d\u2032k > 0 everywhere on Specr A.\nProof. We proceed by several reductions :\n\u2022 We may assume that A is formally real (Specr A 6= \u2205), otherwise there is nothing\nto do.\n\u2022 Because of Property (PNRI) , we may assume that for all k, dk = ek fk where\nek is a product of real irreducibles and fk > 0 on all Specr A.\n\u2022 If M = P DQ where P, Q are invertible, we may reduce to the case where P is\nthe identity. Indeed, let M \u2032 = DQ\u2032 where Q\u2032 = Q(P \u22121 )T is invertible in An\u00d7n and\nM \u2032 = P \u22121 M (P \u22121 )T remains symmetric and psd on Specr A. Of course, M and M \u2032\nhave same Smith Normal Form.\n\u2022 We may reduce to the case where r\u0012= n. Indeed,\n\u0013 Q is\n\u0013 let M\u0012= DQ where\nQ1 Q2\nM1 M2\n, D =\n, Q =\ninvertible, D diagonal, and write M =\nQ3 Q4\nM3 M4\n\u0012\n\u0013\nD1 0\nwith M1 , Q1 , D1 = diag(d1 , . . . , dr ) \u2208 Ar\u00d7r ; M2 , Q2 \u2208 Ar\u00d7(n\u2212r) ;\n0 0\nM3 , Q3 \u2208 A(n\u2212r)\u00d7r ; M4 , Q4 \u2208 A(n\u2212r)\u00d7(n\u2212r) . We get then\n\u0013\n\u0012\nD1 Q1 D1 Q2\n,\nM=\n0\n0\nhence M3 = M4 = 0 and by symmetry M2 = 0. So, we are reduce to M1 = D1 Q1 .\nNext, remark that Q1 is necessarily invertible. Indeed, by the proof of Proposition\n3.2, we have\n(dr (M )) = dr (D) = dr (D1 ) = d1 . . . dr = (det (M1 )),\nwhich shows that det (Q1 ) is invertible.\n\u2022 Assume that the Theorem is not true. So there is an integer m such that dm is\nnot associated to a positive element on all Specr A. Hence, there is a real irreducible\np which changes of sign on Specr A and such that \u03bdp (dm ) is odd. We will assume\nmoreover that \u03bdp (di ) is even for all i \u2264 m and \u03bdp (d1 ) \u2264 . . . \u2264 \u03bdp (dm ) \u2264 . . . \u2264 \u03bdp (dn ).\nWe claim now that, for all 1 \u2264 i \u2264 m and m \u2264 j \u2264 n, the entry qi,j of the matrix\nQ is divisible by p.\na) For i = j = m this follows from the fact that dm qm,m \u2265 0 on all Specr A\n(dm qm,m is a 1 \u00d7 1-minor of the positive matrix DQ). By condition (GRI)\nrelative to p, there is \u03b1 \u2208 Specr A with support (p) and \u03b1+ , \u03b1\u2212 \u2208 Specr A\ntwo generizations of \u03b1 with support (0), such that p >\u03b1+ 0 and p <\u03b1\u2212 0.\nThus, \u03bdp (qm,m ) shall be odd in order to have dm qm,m \u2265\u03b1\u2212 0.\n\n\f6\n\nRONAN QUAREZ\n\nb) For i = m and j > m, we check that p|qi,j is a consequence of the positivity\nof the following symmetric 2 \u00d7 2-minor of DQ :\n\u0013\n\u0012\ndm qm,m dm qm,j\ndj qj,m\ndj qj,j\nIndeed, we have the inequality on all Specr A :\n\n(1)\n\n(dm dj )(qm,m qj,j ) \u2212 (dm qm,j )2 \u2265 0\nAt this point, we use the result\nLemma 4.2. Let A be a formally real UFD which is also a regular domain,\nand a, b \u2208 A. Assume that a \u2212 b2 \u2265\u03b1 0 for all \u03b1 \u2208 Specr A. Then, for all\nreal irreducible p, we have\n\u03bdp (a) \u2264 \u03bdp (b2 )\nProof. Assume that there exists p \u2208 A a real irreducible such that\n2r + s = \u03bdp (a) > \u03bdp (b2 ) = 2r\n\nwith r, s \u2208 N. We write a \u2212 b2 = p2r (ps a\u2032 \u2212 b\u20322 ) with a\u2032 , b\u2032 \u2208 A such that\np \u2224 a\u2032 and p \u2224 b\u2032 . By assumption, p2r (ps a\u2032 \u2212 b\u20322 ) \u2265\u03b1 0 for all \u03b1 \u2208 Specr A.\nTake \u03b1 \u2208 Specr A such that supp(\u03b1) = p. By 2.2, there is a generization\n\u03b2 of \u03b1 in Specr A such that supp(\u03b2) = (0).\nBy assumption, p2r (ps a\u2032 \u2212 b\u20322 ) \u2265\u03b2 0, which yields ps a\u2032 \u2212 b\u20322 \u2265\u03b2 0 since\np\u2208\n/ supp(\u03b2) = (0). By specialization, we get ps a\u2032 \u2212 b\u20322 \u2265\u03b1 0, and hence\n\u2212b\u20322 \u2265\u03b1 0. Necessarily, b\u2032 \u2208 supp(\u03b1), namely p | b\u2032 : a contradiction.\n\u0003\nUsing Lemma 4.2, from Equation (1) we get\n\u03bdp (dm ) + 2\u03bdp (qm,j ) \u2265 \u03bdp (dj ) + \u03bdp (qm,m ) + \u03bdp (qj,j )\nSince \u03bdp (dj ) \u2265 \u03bdp (dm ) for j > m, it shows that\n2\u03bdp (qm,j ) \u2265 \u03bdp (qj,j ) + \u03bdp (qm,m )\nSince \u03bdp (qm,m ) \u2265 1, we obtain \u03bdp (qm,j ) \u2265 1, namely p|qm,j .\nc) For i < m and j \u2265 m, we use the equality di qi,j = qj,i dj and the fact that\n\u03bdp (dj ) \u2265 \u03bdp (dm ) > \u03bdp (di ), to conclude that p|qi,j too.\nTo end, we use the elementary\nLemma 4.3. Let P = (pi,j ) \u2208 An\u00d7n be a matrix with entries in a domain A.\nAssume that there is an irreducible p such that p divides mi,j for all 1 \u2264 i \u2264 r and\nr \u2264 j \u2264 n, with r \u2208 N.\nThen, p divides det (P ).\nProof. We proceed by induction on r. If r = 1, then the result is obvious.\nNext, if r > 1, we developp according to the last row and we find that det (P ) is\na linear combination of determinants which are all divisible by p by the induction\nhypothesis.\n\u0003\n\n\fON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH NORMAL FORM\n\n7\n\nBy Lemma 4.3, the irreducible p divides det (Q) although Q is supposed to be\ninvertible in A : a contradiction which concludes the proof.\n\u0003\nOf course, when A is a Principal Ideal Domain, then A is an UFD and moreover\nsatisfies condition (GRI). Moreover, the Smith Normal form of a matrix always exists, so we are able to present a shorter version of Theorem 4.1 under the assumption\nthat the ring is principal.\nTheorem 4.4. Let A be a PID and M be a symmetric matrix in An\u00d7n which\nis positive semi-definite on Specr A. Let M \u223c D = diag(d1 , . . . , dr , 0 . . . , 0) with\nd1 | . . . |dr in A be the Smith Normal Form of M . We assume furthermore that the\nring A satisfies the condition (PNRI) .\nThen, up to association, all the dk 's are positive on Specr A.\nRemark 4.5. According to the proof of Theorem 4.1, if we search for a counterexample to Question 1.1, we may focus on the case n = 2. Namely, take\n\u0013\u0012\n\u0012\n\u0013 \u0012\n\u0013\na be1\nad1 bd1 e1\nd1\n0\nM=\n=\n0 d1 e1\nb\nc\nbd1 e1 cd1 e1\nWhere\n\nac \u2212 b2 e1 = \u01eb, \u01eb \u2208 A\u2217\nThe symmetric matrix M will be positive semi-definite if and ony if we have on\nall Specr A :\n\uf8f1\n\uf8f2 ad1 \u2265 0\ncd1 e1 \u2265 0\n\uf8f3 2\nd1 e1 \u2265 0\nSo, to get a couterexample we will search for an element d1 \u2208 A which change of\nsign on Specr A and compatible with all the previous conditions.\n\n5. On the conditions (GRI) and (PNRI)\n5.1. Condition (GRI). We will not discuss very much this rather technical condition because it will be automatically satisfied for the class of rings we are mainly\ninterested in. Indeed, if A is principal, for any irreducible p, the ring A/p is regular.\nThe analogeous observation will be also valid when A is a Dedekind domain (confer\nsection 7).\n5.2. Condition (PNRI) . We may note first that if the ring A is not formally real\nthen the condition is obviously satisfied, but Theorem 4.1 has not any interest !\nThe next class of rings for which the condition is easily seen to be true is given\nby the following :\nProposition 5.1. Condition (PNRI) is satisfied whenever the invertibles of A separate the closed opens of Specr A.\nProof. Let Specr A = \u222ai\u2208I Wi be the decomposition of Specr A into its connected\ncomponents. Let q be a non-real irreducible whose sign is sgn[q](Wj ) = \u01ebj = +1\nfor any j \u2208 J and \u01ebj = \u22121 for j \u2208 I \\ J. Set P = \u222ai\u2208J Wi and N = \u222ai\u2208I\\J Wi ,\nthen Specr A = N \u222a P is a partition of Specr A into two closed opens. Thus, by\nassumption there is an invertible u \u2208 A such that u > 0 on P and u < 0 on N ,\nhence uq > 0 on all Specr A.\n\u0003\n\n\f8\n\nRONAN QUAREZ\n\nAs an esay corollary, (PNRI) appears to be true for any ring whose real spectrum Specr A is connected, since in this case a non-real irreducible does not change\nof sign.\nNote moreover that\nProposition 5.2. The condition (PNRI) is stable under localization.\nProof. It suffices to see that the non-real irreducibles of S \u22121 A are in one-to-one\ncorrespondance with the product of non-real irreducibles by some element of S,\nand that the correspondance which associates \u03b1 \u2208 Specr (S \u22121 A) to \u03b1 \u2208 Specr A\nsuch that supp(\u03b1) \u2229 S = \u2205 is also one-to-one.\n\u0003\nFor instance, the coordinate ring of the real hyperbola R[x, y]/(xy \u2212 1) satisfies\n(PNRI) .\nRemark 5.3. Let A be a principal ring. It follows from Proposition 5.2 that if A\nsatisfies condition (PNRI) , then Ap satisfies condition (PNRI) for all prime p\nin A. Beware that the converse is false. For intance, 6.4 gives a counterexample.\nRemark 5.4. The condition (PNRI) is closely related to the so-called change of\nsign criterion (see for instance [2, Th\u00e9or\u00e8me 4.5.1]) which says the following :\nLet R be a real closed field and f an irreducible polynomial in R[x1 , . . . , xn ].\nThen, the ideal (f ) is real if and only if the polynomial f changes of sign in Rn :\n(\u2203x, y \u2208 Rn f (x)f (y) < 0).\nIndeed, the obvious implication of the equivalence gives condition (PNRI) for\nthe ring R[x1 , . . . , xn ] : if f is a non-real irreducible, then f does not change of sign\n(here the invertibles are elements in R\u2217 , of constant sign).\nWe may naturally extend this last property to any ring of polynomials over a\nnon-necessarily real-closed field.\nProposition 5.5. Let A = k[x1 , . . . , xn ] where k is a formally real field. Then, the\nring A satisfies condition (PNRI) .\nProof. Start with the case of a single variable : A = k[x], where k is a formally\nreal field. Let p(x) be an irreducible polynomial in k[x] which is non real. Up to\nassociation, we may assume that p is monic. Let \u03c6 : A \u2192 R be a ring-morphism\ninto a real closed field R. Since R is real closed, p cannot change of sign in R,\notherwise by continuity it would vanish on R : a contradiction with the fact that p\nis non real. Since limx\u2192+\u221e \u03c6(p(x)) = +\u221e, we get for all all morphism \u03c6 : A \u2192 R\ninto a real closed field R and all x \u2208 R, \u03c6(p(x)) > 0. In other words, p > 0 on all\nSpecr A.\nTo generalize the argument to A = k[x1 , . . . , xn ], let us order all the monomials\n\u03b1n\n1\nwith respect to the lexicographic ordering. Let m(x) = \u03bbx\u03b1\n1 . . . xn be the higher\nmonomial appearing in the polynomial p(x). Up to association, we may assume\nthat \u03bb = 1. Then, we look at the element \u03c6(p(x)) for a ring-morphism A \u2192 R with\nR real closed. If we make all xi 's tend to +\u221e such that all successive quotients\nxi\nxi+1 tend also to +\u221e (i.e. x1 \u226b x2 \u226b . . . \u226b xn ), the we get\n\u03c6(p(x1 , . . . , xn )) \u223c \u03c6(m(x1 , . . . , xn )).\n\nThen, we conclude as previousy that \u03c6(p(x1 , . . . , xn )) > 0 for any substitution\n(x1 , . . . , xn ) \u2208 Rn . In other words, p(x) > 0 on all Specr A.\n\u0003\n\n\fON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH NORMAL FORM\n\n9\n\nFor instance the property (PNRI) is satisfied in Q[x1 , . . . , xn ] although the\ninvertibles do not separate the closed opens of Specr A.\nRemark 5.6. We shall mention also the link of this section with the content of [8].\nRoughly speaking, Marshall generalizes a separation result due to Schwartz in the\ngeometric case, introducing a condition involving local 4-elements fans. This last\ncondition is empty in the one-dimentional geometric case, namely when A = R[V ]\nis the ring of coordinates of an real affine plane curve. So it is possible to separate\nthe connected components of Specr A (or equivalently those of V as a variety) by\npolynomials.\nBut, for our purpose, it does not say whether the polynomials can be taken\ninvertible.\nIn the next section, we study for which rings of number fields the condition\n(PNRI) is satisfied.\n\n6. Rings of integers of number fields\nLet K be a finite extension of Q of degree n. Write K = Q[x]/m(x) where m(x)\nis an irreducible polynomial of degree n over Q. Denote by a1 , . . . , an all the roots\nof m(x) in C. We say that K is totally real if all the roots of m(x) are real. A\nnumber field is totally real if and only if it can be embedded into R.\nLet A be the ring of integers of K over\nQ Z. We define N (a), the norm of an\nelement in A, to be the integer N (a) = \u03c6 \u03c6(a), where \u03c6 runs the set of all the\nring-homomorphisms \u03c6 : K \u2192 C.\nProposition 6.1. Let A be the ring of integers of a degree n number field K =\nQ[x]/m(x). Then, Specr A = Specr K and, as a set, it consists in r points, where r\nis the number of real roots of m(x).\nProof. A point of Specr A is given by a morphism \u03c6 : A \u2192 R into a real closed field\nR. In order to describe Specr A, we need as a prerequisite the classical description\nof the ideals in Z[x] :\nLemma 6.2. Any prime ideal p of Z[x] has the form p = (p, f (x)) where p is a prime\nnumber in Z and f (x) a polynomial in Z[x] whose reduction modulo p is irreducible\nin Z/pZ[x].\nNow let p be a prime ideal in A, viewed as an ideal of Z[x] containing m(x). If\np \u2208 p for a prime number p \u2208 Z, then \u22121 = p\u2212 1 in A/p and \u22121 is a sum of squares,\nin other word A/p is not formally real. As a consequence, any \u03b1 \u2208 Specr A has\nsupport supp(\u03b1) = (0) since by 6.2 the ideal p shall be generated by an irreducible\npolynomial in Z[x] which have to divide m(x). Hence Specr A = Specr K.\nMoreover, an element of Specr K is determined by a morphism \u03c6 : K \u2192 R where\nR is a real closed field, hence can be identified with one root of m(x).\n\u0003\nWe shall note that if K is Galois of degree n over Q, then Specr A consists in n\npoints in case A is totally real, otherwise Specr A = \u2205.\nStart with the simplest examples of number fields :\n\n\f10\n\nRONAN QUAREZ\n\n6.1.\u221a Quadratic number fields. A quadratic number field has the form K =\nQ( d), where d is square free in Z. Recall that if d 6\u2261 1 mod 4, then the ring\n\u221a\nof integers\nofi K is A = Z[ q] = Z[x]/(x2 \u2212 d), whereas if d \u2261 1 mod 4, then\nh\nA=Z\n\n\u221a\n1+ q\n2\n\n.\n\nAs an application to Proposition 6.1, Specr A 6= \u2205 if and only if d \u2265 0 and, we\nsay in this case that K is a real quadratic number field.\nIn summary, the real spectrum of A = Z[x]/(x2 \u2212 d) consists into two different\npoints which can be seen\u221a\nas the two possible embeddings of A into R :\u221athe first one\ngiven by sending x onto d and the second one by sending x onto \u2212 d.\nAbout the units of a number quadratic field, it is well known (see for instance\n[7]) that the group of units A\u2217 is isomorphic to Z/2Z \u00d7 Z. We call u a fondamental\nunit in A if its image by the previous isomorphism can be written (\u00b11, \u00b11).\nProposition 6.3. Let A be the ring of integers of a real quadratic number field. We\nassume that A is principal. Then, A satisfies conditon (PNRI) if and only if\nN (u) = \u22121, where u is a fondamental unit in A.\n2\nProof. Assume that d\u221a6\u2261 1 mod 4. We have\n\u221a A \u2243 Z[x]/(x \u2212 d), and Specr A can be\ndescribed by \u03c6 : x 7\u2192 d and \u03c6 : x 7\u2192 \u2212 d. Assume that N (u) = \u03c6(u) * \u03c6(u) = \u22121.\nThen, the unit u changes of sign onto Specr A, and hence separates the two points\nof Specr A. Otherwise, it does not separate.\nIf d \u2261 1 mod 4, then A \u2243 Z[x]/(4x2 \u2212 4x + 1 \u2212 d). We repeat the same argument\n\u221a\nas in the previous case, this time Specr A being described by \u03c6 : x 7\u2192 1+2 d and\n\n\u03c6 : x 7\u2192\n\n\u221a\n1\u2212 d\n2 .\n\n\u0003\n\nAs examples, mention that N (u) = +1 for d = 3, 7, 6, 11, 23, . . . whereas N (u) =\n\u22121 for d = 2, 10, 26, . . .\n\n\u221a\n\u221a\n\u221a\nIn view of applying Theorem 4.4, we recall that the rings Z[ 2], Z[ 3] and Z[ 7]\nare principal. And moreover, it is conjectured that there are infinitly many rings\nof quadratic numbers fields which are principal.\n\u221a\nSince condition (PNRI) is not satisfied by A = Z[ 3] (according to 6.3), the\nfirst counterexample we give to Question 1.1 will be the following one :\n\u221a\n\u221a\nCounter-example 6.4. In the ring A = Z[ 3], u = 2 + 3 is a fondamental unit\nwhich satisfies N\u221a\n(u) = +1, hence u remains always positif on Specr A. Consider the\nelement q = 1 + 3 which obviously changes of sign on Specr A. The equality\n\u221a\n\u221a\n\u22122 = N (q) = (1 + 3)(1 \u2212 3)\nshows that q is irreducible and moreover that it is non-real since we have\n\u221a\n\u22121 \u2261 12 mod (1 + 3).\nWe have futhermore the identity :\n\u221a\n1\n(1 + 3)2 = +\n2\n\n\u221a !2\n\u0013\n\u0012 4\n3\n7\nr +3\n+ \u2212\nr+\nr\n2\nr2\n\n\fON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH NORMAL FORM\n\n11\n\n\u221a\n4\nwhere\n\u0010 r4 is\u0011a rational number chosed \"close enough\" to 3 (i.e. in order that\nr +3\n7\nis a positive rational number, and hence a sum of at most 4 squares\n2 \u2212\nr2\nof rational numbers). This last identity will furnish a counterexample to Question\n1.1.\nIndeed, following Remark 4.5, it suffices to set \u01eb \u2208 A\u2217+ , b = 1, d1 = a = c = q =\n\u0010\n\u0010 4 \u0011\n\u221a \u00112\n\u221a\n. So we have e1 \u2265 0 on all Specr A (it is even\n1 + 3, e1 = r + r3 + 27 \u2212 r r+3\n2\n\na sum of squares) and q 2 = \u01eb + e1 with \u01eb = 21 invertible in A.\nWe get the matricial equality :\n\u0013\n\u0013\u0012\n\u0012\nq e1\nq 0\nM=\n1 q\n0 qe1\nAnd q is a non-real irreducible whose all associates always change of sign in Specr A.\n\nWe may generalize all this section to any totally real number field.\nQ\n6.2. Totaly real number fields. Recall that N (u) = \u03c3 \u03c3(u), where \u03c3 runs the\nset of all (real) embeddings A \u2192 R.\nWe recall also some well known result about units of rings of integers of number\nfields (see for instance [7]) :\nTheorem 6.5. Let K be a totally real number field of degree n over Q. Denote by\nA the ring of integers of K and A\u2217 the set of all units in A. Then,\na) The element x is in A\u2217 if and only if N (x) = \u00b11 where N (x) is the norm\nof x.\nb) We have the isomorphism A/Ators \u2243 Z/2Z (which is isomorphic to the\ngroup of all roots of unity in K).\nc) The group Ators is free of rank n \u2212 1.\nAs a consequence, A\u2217 \u2243 Z/2Z \u00d7 Zn\u22121 .\nRecall that Specr A consists in n distincts points which we denotes by \u03b11 , . . . , \u03b1n .\nLet A(Specr A, {\u22121, +1}) be the set of all maps from Specr A into {\u22121, +1}\nand in order to identify the maps f and \u2212f we introduce the quotient A =\nA(Specr A, {\u22121, +1})/{\u22121, +1}. Consider the map :\nSgn :\n\nAtors\nu\n\n\u2192\nA\n7\n\u2192\n(\u03b1 \u2208 Specr A 7\u2192 sgn[u](\u03b1)\n\nAn equivalent point of view would be to take for A the set of all functions f\nsatisfying f (\u03b1n ) = +1). Then, in place of the previous application Sgn, we would\nconsider the following :\nSgn : Ators\nu\n\n\u2192 A(Specr A \\ {\u03b1n }, {\u22121, +1})\n7\u2192\n(\u03b1 \u2208 Specr A 7\u2192 sgn[u](\u03b1)\n\nHere is the generalization of 6.3 :\n\nProposition 6.6. Let A be the ring of integers of a totaly real number field of degree\nn over Q. We assume that A is principal. Then, the ring A satisfies the condition\n(PNRI) if and only if the application Sgn is an isomorphism of Z-modules. i.e.\nwe may choose a basis (u1 , . . . , un\u22121 ) of Ators such that sgn[uj ](\u03b1i ) = \u22121 if and\nonly if i = j.\n\n\f12\n\nRONAN QUAREZ\n\nProof. The ring A satisfies the condition (PNRI) if and only if for all subset S \u2282\nSpecr A = {\u03b11 , . . . , \u03b1n } there exists an invertible u such that u > 0 on S and u < 0\non Specr A \\ S. This is equivalent to saying that the application Sgn is surjective.\nSince the free Z-modules Ators and A have same rank equal to n \u2212 1, it is an\nisomorphism.\n\u0003\nIn Theorem 4.4, we use the assumption that A is principal. This hypothesis\nseems to be too restrictive : indeed not all number fields are principal, neither\nthe coordinate rings of real affine irreducible non-singular varieties. But, these two\nclasses of rings appear to be Dedekind domains. It gives a motivation to search for\nan extension of Theorem 4.1 to the class of Dedekind domains.\n7. Dedekind domains\nDefinition 7.1. A domain A is called Dedekind if it is noetherian, integrally closed,\nand if any non zero prime ideal is maximal.\nRoughly speaking, we may find in a Dedekind domain, the counterpart of all the\narithmetic properties (for instance the existence of gcd) we have in a PID. We just\nhave to replace the product of elements with the product of ideals. For instance, the\ndecomposition of an element into a product of irreducible element will be replaced,\nin a Dedekind domain, with the decompositon of an ideal into a product of prime\nideals.\nNote that any Dedekind domain A satisfies condition (GRI) since A/(p) is a\nfield and hence regular for any irreducible p.\nSince all the ideals in a Dedekind domain A are not necessarily principal, we\nshall give a counterpart for the definition of condition (PNRI) :\n(PNRI) Let I = (f ) be a principal ideal which is non real in A (each associated minimal prime ideal is non-real). Then, f is associated in A to an element\nwhich is positive everywhere on Specr A.\nWe may also note that the notion of Smith Normal form still exists in Dedekind\ndomain. Although, in general this form is not as simple as the one we have in\nthe case of a principal ring. For instance, we may have to change the format of\nthe matrice (see for instance [6]). But for our purpose, we will limit oursevles to\nmatrices which admits a diagonal Smith Normal Form. If we denote by dk (M ) the\nideal in A generated by the k \u00d7 k minors of the matrix M , the following results\n(which can be deduced from [4] for instance) give a criterion for a matrix to have\na diagonal Smith Normal Form :\nTheorem 7.2. Let A be a Dedekind domain. Let M and N be two matrices in An\u00d7n\nsuch that det(M ) 6= 0 and det(N ) 6= 0. Then, there is P, Q \u2208 GLn (A) such that\nM = P N Q if and only if dk (M ) = dk (N ) for all k = 1 . . . n.\nIf we erase the assumtion det (M ) * det (N ) 6= 0, then the result is still valid with\nthe additional condition C(M ) = C(N ) (where C(*) denotes the column ideal class\nof a matrice).\nAs a consequence,\n\n\fON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH NORMAL FORM\n\n13\n\nCorollary 7.3. A matrix M in An\u00d7n such that det (M ) 6= 0 admits a Smith Normal\nForm : M \u223c diag(d1 , . . . , dn ) with d1 | . . . |dn , dn 6= 0, if and only if all the ideals\nd1 (M ), . . . , dn (M ) are principal.\nWe now are able to formulate the counterpart of Question 1.1 for Dedekind\nDomains :\nQuestion 7.4. Let M be a symmetric square matrix with entries in a formally\nreal Dedekind Domain A. Assume that M is positive semi-definite and admits a\ndiagonal Smith Normal Form. Are all the diagonal elements of the Smith Normal\nForm positive semi-definite up to association ?\nHere is a possible extension of Theorem 4.4 which can be seen as an answer to\nQuestion 7.4, despite the non satisfactory hypothesis about the decomposition into\nprincipal prime ideals :\nTheorem 7.5. Let A be a Dedekind domain which satisfies the property (PNRI) .\nLet M be a symmetric matrix in An\u00d7n which we suppose te be positive semi-definite\non Specr A. Suppose that for all k = 1 . . . n, the ideal dk (M ) is principal, namely\ndk (M ) = (dk ), with dk \u2208 A. Suppose morever that all the primes appearing in the\ndecomposition of dk (M ) are principals.\nThen, for all k = 1 . . . r, the element dk \u2208 A can be associated to an element\nd\u2032k \u2208 A such that d\u2032k is positive everywhere on Specr A.\n\nProof. Note first that the reduction to the case r = n enables us to apply Theorem\n7.2.\nWe follow the proof of Theorem 4.1, replacing irreducibles by prime ideals. The\ndecomposition of (dk ) into the product of its associated prime ideals (which all are\nprincipal) looks very much like the decomposition in a UFD.\nSo dk = ek fk where ek is a product of some elements lying in some real prime\nideals and fk is a product of some elements lying in some non-real prime ideals.\nThanks to property (PNRI) we may assume that fk > 0 on all Specr A.\nValuations relative to irreducibles in an UFD are replaced with valuations relative\nto prime ideals in a Dedekind domain.\nNote also that we have a version of Lemma 2.2 in the Dedekind domain A : if\np is real prime ideal different from (0), then p is maximal and A/p is regular. The\nrest of the proof follows.\n\u0003\nAnother solution, if we want to get rid off the unsatisfactory assumption of the\nprevious Theorem, is to restrict the conclusion by localization :\nTheorem 7.6. Let A be a Dedekind domain which satisfies the property (PNRI) .\nLet M be a symmetric matrix in An\u00d7n which we suppose te be positive semi-definite\non Specr A. Suppose that for all k = 1 . . . n, the ideal dk (M ) is principal, namely\ndk (M ) = (dk ) with dk \u2208 A.\nThen, for all prime ideal p in A and all k = 1 . . . r, the element dk can be\nassociated in Ap to an element d\u2032k \u2208 Ap such that d\u2032k is positive everywhere on\nSpecr A.\nProof. Since the ring A satisfies condition (PNRI) , then by localization, all the\nrings Ap satisfies the condition (PNRI) too. Moreover Ap is a PID (confer [3,\nParagrahe 2, Th\u00e9or\u00e8me 1]), so we may directly use Theorem 4.4, to get d\u2032k > 0 on\nall Specr Ap . By specilization, we get also d\u2032k > 0 on all Specr A.\n\u0003\n\n\f14\n\nRONAN QUAREZ\n\nFor instance, Theorems 7.5 and 7.6 are true for the ring A = R[x, y]/(x2 +y 2 \u22121).\n\nRemark 7.7. By, [3, Paragraphe 3, Exemple 1)], if a Dedekind domain is UFD, then\nit is principal.\n\n7.1. Another counterexamples. We state some counterexamples to Question\n7.4, all coming from the class of hyperelliptic curves. So we need to precise what\nthe units look like in these rings :\nLemma 7.8. Let A be the coordinate ring of the real affine hyperelliptic plane curve\nof equation y 2 \u2212 p(x) = 0, were p(x) \u2208 R[x] has only single and real roots. If we\nassume that deg p is odd or if the leading coefficient of p(x) is negative, then the\nset of units in A is R\u2217 .\nProof. Any element f of A admits a unique representation of the form a(x)y + b(x)\nwhere a, b \u2208 R[x]. Then, f is invertible in A if and only if there is g = c(x)y + d(x)\nsuch that in R[x], we have\n\u001a\nb(x)d(x) + p(x)a(x)c(x) = 1\na(x)d(x) + b(x)c(x) = 0\n\nThe first equation shows that a and b are coprime, so by the second we deduce that\nb|d and a|c. Likewise, we get the reverve divisibility property, so c = \u03b1a and d = \u03b2b\nwith \u03b1, \u03b2 \u2208 R\u2217 .\nThe previous system becomes\n\u001a\n\u03b2(b(x)2 \u2212 p(x)a(x)2 ) = 1\n(\u03b2 + \u03b1)a(x)b(x) = 0\n\nThe case b(x) = 0 is impossible because of the first equality, whereas the case\na(x) = 0 yields b(x) \u2208 R\u2217 as wanted.\nIt remains the treat the case a(x)b(x) 6= 0. Then, \u03b1 = \u2212\u03b2 and we just note that\nthe polynomial b(x)2 \u2212 p(x)a(x)2 cannot be a constant if deg p(x) is odd or if the\nleading coefficient of p(x) is negative.\n\u0003\nNote that if none of the conditions 7.8 are satisfied, then it may exist in A other\n2\n2\n2\ninvertibles than R\u2217 , as it is the case\n\u0001 when A = R[x, y]/(y \u2212 (x \u2212 1)(x 2\u2212 2)).\n\u0001\u0001 For\n3\n2\ninstance, the element y + x \u2212 2 is invertible with inverse \u22124 y \u2212 x \u2212 23 .\n\nCounter-example 7.9. Consider the cubic of coordinate ring A = R[x, y]/(y 2 \u2212x(x2 \u2212\n1)). It has two connected components which can be separated by the polynomial\nq = x \u2212 21 . Note that (q) is a non-real prime ideal such that q 2 = 41 + x2 \u2212 x.\nAs in Remark 4.5, to produce a counterexample, it suffices to take \u01eb = 41 , b = 1,\nd1 = a = c = q, e1 = x2 \u2212 x which is such that e1 \u2265 0 on Specr A.\nAs another example, we may also consider the ring B = R[x, y]/(y 2 +(x2 \u22121)(x2 \u2212\n2)), where the prime ideal (x) in B separates the two connected components of the\nvariety. And we produce a counterexample based upon the identity\n\u0001\n1\n2 + x4 + y 2\nx2 =\n3\n\u0001\nHence, we have e1 = 31 x4 + y 2 which is not only positive, but also a sum of\nsquares in B.\nThis last argument could be repeated to any affine irreducible non-singular real\nplane curve which is is compact and has several connected components.\n\n\fON POSITIVE MATRICES WHICH HAVE A POSITIVE SMITH NORMAL FORM\n\n15\n\nProposition 7.10. Let A = R[V ] be the coordinate ring of an affine non-singular\nirreducible and compact curve V . We assume moreover that the only units of A are\nconstants.\nThen, Question 1.1 admits a negative answer for the ring A if V (R) has at least\ntwo connected components.\nProof. Assume that Specr A has at least two connected components, say C1 and\nC2 . According to [8], we may find a \u2208 A which separates C1 and C2 . Necessarily\n(a) is non-real since it does not vanish on Specr A. Since V (R) is compact, there\nis a rationnal number r \u2265 0 such that a2 \u2212 r > 0 on V (R). By Schm\u00fcdgen\nPositivestellensatz [9], we get that a2 \u2212 r is a sum of squares in A. Thus, as in\nRemark 4.5, we are able to produce a counterexample to Question 7.4.\n\u0003\nReferences\n[1]\n[2]\n[3]\n[4]\n[5]\n[6]\n[7]\n[8]\n[9]\n\nC. Andradas, L. Brocker, J. M. Ruiz Constructible sets in Real Gometry, Springer 1996\nJ. Bochnak, M. Coste, M-F. Roy, G\u00e9om\u00e9trie Alg\u00e9brique R\u00e9elle, Springer Verlag, 1986\nN. Bourbaki Alg\u00e8bre commutative, Chapitre 7, Masson 1982\nC. Curtis, I. Reiner, Representation theory of Finite Groups and Associative Algebras,\nWiley, New York, 1972\nD. Z. Djokovic, Hermitian Matrices over Polynomial Rings, Journal of Algebra, 359-374,\n1976\nH. Cohen, Hermite and Smith Normal Form Algorithms over Dedekind Domains, Math.\nof Comp. Vol 65, 216, 1681-1689 (1996)\nH. Cohen, A Course in Computational Algebraic Number Theory, Graduate Texts in Mathematics, 138. Springer-Verlag, Berlin, 1993.\nMarshall, Spaces of orderings and separation of connected components of Real Varieties\nby Polynomials, Journal of Algebra 176, 271-287 (1995)\nK. Schmudgen, The K-moment problem for compact semi-algebraic sets, Mathematische\nAnnalen, vol. 289, pp. 203?206, 1991\n\nIRMAR (CNRS, URA 305), Universit\u00e9 de Rennes 1, Campus de Beaulieu, 35042 Rennes\nCedex, France\nE-mail address: e-mail : ronan.quarez@univ-rennes1.fr\n\n\f"}