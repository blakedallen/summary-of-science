{"id": "http://arxiv.org/abs/1203.2223v1", "guidislink": true, "updated": "2012-03-10T02:42:49Z", "updated_parsed": [2012, 3, 10, 2, 42, 49, 5, 70, 0], "published": "2012-03-10T02:42:49Z", "published_parsed": [2012, 3, 10, 2, 42, 49, 5, 70, 0], "title": "Non-adiabatic molecular dynamics simulation for carrier transport in a\n  molecular monolayer", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1203.4398%2C1203.4619%2C1203.2167%2C1203.2961%2C1203.6737%2C1203.5509%2C1203.3971%2C1203.3014%2C1203.3141%2C1203.4736%2C1203.1851%2C1203.1083%2C1203.2223%2C1203.4394%2C1203.3000%2C1203.1100%2C1203.0828%2C1203.4811%2C1203.1899%2C1203.6391%2C1203.2041%2C1203.3687%2C1203.2800%2C1203.0321%2C1203.4063%2C1203.2078%2C1203.1766%2C1203.4874%2C1203.5256%2C1203.1858%2C1203.6541%2C1203.6471%2C1203.0571%2C1203.1839%2C1203.4430%2C1203.5684%2C1203.6875%2C1203.0476%2C1203.1254%2C1203.2603%2C1203.3145%2C1203.3557%2C1203.1317%2C1203.6165%2C1203.0393%2C1203.6756%2C1203.0491%2C1203.1138%2C1203.0824%2C1203.2287%2C1203.5584%2C1203.2491%2C1203.3900%2C1203.3214%2C1203.5163%2C1203.5593%2C1203.1287%2C1203.5860%2C1203.1298%2C1203.2474%2C1203.1661%2C1203.2693%2C1203.6130%2C1203.4969%2C1203.6060%2C1203.2614%2C1203.2908%2C1203.3329%2C1203.3743%2C1203.3004%2C1203.0155%2C1203.0739%2C1203.1945%2C1203.2741%2C1203.4053%2C1203.2809%2C1203.1892%2C1203.1799%2C1203.2569%2C1203.6174%2C1203.5801%2C1203.5934%2C1203.2129%2C1203.6218%2C1203.6003%2C1203.3725%2C1203.6504%2C1203.0532%2C1203.3396%2C1203.1355%2C1203.2699%2C1203.2870%2C1203.6740%2C1203.6399%2C1203.5278%2C1203.4163%2C1203.4492%2C1203.0931%2C1203.4670%2C1203.5113%2C1203.3304&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Non-adiabatic molecular dynamics simulation for carrier transport in a\n  molecular monolayer"}, "summary": "We present a new approach to carry out non-adiabatic molecular dynamics to\nstudy the carrier mobility in an organic monolayer. This approach allows the\ncalculation of a 4802 atom system for 825 fs in about three hours using 51,744\ncomputer cores while maintaining a plane wave pseudopotential density\nfunctional theory level accuracy for the Hamiltonian. Our simulation on a\npentathiophene butyric acid monolayer reveals a previously unknown new\nmechanism for the carrier transport in such systems: the hole wave functions\nare localized by thermo fluctuation induced disorder, while its transport is\nvia charge transfer during state energy crossing. The simulation also shows\nthat the system is not in thermo dynamic equilibrium in terms of adiabatic\nstate populations according to Boltzmann distribution. Our simulation is\nachieved by introducing a linear time dependence approximation of the\nHamiltonian within a fs time interval, and by using the charge patching method\nto yield the Hamiltonian, and overlapping fragment method to diagonalize the\nHamiltonian matrix.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1203.4398%2C1203.4619%2C1203.2167%2C1203.2961%2C1203.6737%2C1203.5509%2C1203.3971%2C1203.3014%2C1203.3141%2C1203.4736%2C1203.1851%2C1203.1083%2C1203.2223%2C1203.4394%2C1203.3000%2C1203.1100%2C1203.0828%2C1203.4811%2C1203.1899%2C1203.6391%2C1203.2041%2C1203.3687%2C1203.2800%2C1203.0321%2C1203.4063%2C1203.2078%2C1203.1766%2C1203.4874%2C1203.5256%2C1203.1858%2C1203.6541%2C1203.6471%2C1203.0571%2C1203.1839%2C1203.4430%2C1203.5684%2C1203.6875%2C1203.0476%2C1203.1254%2C1203.2603%2C1203.3145%2C1203.3557%2C1203.1317%2C1203.6165%2C1203.0393%2C1203.6756%2C1203.0491%2C1203.1138%2C1203.0824%2C1203.2287%2C1203.5584%2C1203.2491%2C1203.3900%2C1203.3214%2C1203.5163%2C1203.5593%2C1203.1287%2C1203.5860%2C1203.1298%2C1203.2474%2C1203.1661%2C1203.2693%2C1203.6130%2C1203.4969%2C1203.6060%2C1203.2614%2C1203.2908%2C1203.3329%2C1203.3743%2C1203.3004%2C1203.0155%2C1203.0739%2C1203.1945%2C1203.2741%2C1203.4053%2C1203.2809%2C1203.1892%2C1203.1799%2C1203.2569%2C1203.6174%2C1203.5801%2C1203.5934%2C1203.2129%2C1203.6218%2C1203.6003%2C1203.3725%2C1203.6504%2C1203.0532%2C1203.3396%2C1203.1355%2C1203.2699%2C1203.2870%2C1203.6740%2C1203.6399%2C1203.5278%2C1203.4163%2C1203.4492%2C1203.0931%2C1203.4670%2C1203.5113%2C1203.3304&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We present a new approach to carry out non-adiabatic molecular dynamics to\nstudy the carrier mobility in an organic monolayer. This approach allows the\ncalculation of a 4802 atom system for 825 fs in about three hours using 51,744\ncomputer cores while maintaining a plane wave pseudopotential density\nfunctional theory level accuracy for the Hamiltonian. Our simulation on a\npentathiophene butyric acid monolayer reveals a previously unknown new\nmechanism for the carrier transport in such systems: the hole wave functions\nare localized by thermo fluctuation induced disorder, while its transport is\nvia charge transfer during state energy crossing. The simulation also shows\nthat the system is not in thermo dynamic equilibrium in terms of adiabatic\nstate populations according to Boltzmann distribution. Our simulation is\nachieved by introducing a linear time dependence approximation of the\nHamiltonian within a fs time interval, and by using the charge patching method\nto yield the Hamiltonian, and overlapping fragment method to diagonalize the\nHamiltonian matrix."}, "authors": ["Junfeng Ren", "Nenad Vukmirovic", "Lin-Wang Wang"], "author_detail": {"name": "Lin-Wang Wang"}, "author": "Lin-Wang Wang", "arxiv_comment": "26 pages, 10 figures", "links": [{"href": "http://arxiv.org/abs/1203.2223v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1203.2223v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cond-mat.mtrl-sci", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.mtrl-sci", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1203.2223v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1203.2223v1", "journal_reference": null, "doi": null, "fulltext": "Non-adiabatic Molecular Dynamics Simulation for Carrier Transport\nin a Molecular Monolayer\nJunfeng Ren(1,2), Nenad Vukmirovi\u0107(3), Lin-Wang Wang(1)*\n(1) Material Science Division, Lawrence Berkeley National Laboratory, One Cyclotron Road, Mail Stop\n66, Berkeley, CA 94720\n(2) College of Physics and Electronics, Shandong Normal University, Jinan 250014, China\n(3) Scientific Computing Laboratory, Institute of Physics Belgrade, University of Belgrade, Pregrevica\n118, 11080 Belgrade, Serbia\n(*) Email: lwwang@lbl.gov\n\nABSTRACT: We present a new approach to carry out non-adiabatic molecular dynamics to study the\ncarrier mobility in an organic monolayer. This approach allows the calculation of a 4802 atom system\nfor 825 fs in about three hours using 51,744 computer cores while maintaining a plane wave\npseudopotential density functional theory level accuracy for the Hamiltonian. Our simulation on a\npentathiophene butyric acid monolayer reveals a previously unknown new mechanism for the carrier\ntransport in such systems: the hole wave functions are localized by thermo fluctuation induced disorder,\nwhile its transport is via charge transfer during state energy crossing. The simulation also shows that the\nsystem is not in thermo dynamic equilibrium in terms of adiabatic state populations according to\nBoltzmann distribution. Our simulation is achieved by introducing a linear time dependence\napproximation of the Hamiltonian within a fs time interval, and by using the charge patching method to\nyield the Hamiltonian, and overlapping fragment method to diagonalize the Hamiltonian matrix.\n\nKEYWORDS: charge transport, charge patching method, surface hopping, nonadiabatic molecular\ndynamics.\n\n1\n\n\fMANUSCRIPT TEXT\n1. Introduction\nCarrier transport in an organic system is a complex phenomenon which can involve different\nunderlying mechanisms [1,2]. These include: delocalized bulk band structure transport [3,4], localized\nstate single phonon absorption/emission hopping [5], atomic relaxation induced localized polaron state\nhopping [6,7], polaron band structure [8], thermo fluctuation induced dynamic disorder transport [9,10],\nand coherent electron transport (which also includes the band structure transport and tunneling\ntransport) [11,12]. These different mechanisms give rise to rich features in terms of the temperature,\ncarrier density and electric field dependences of the carrier mobility [2,13,14]. Most of the above\nunderlying mechanisms involve electron-phonon coupling, some strongly coupled, some weakly\ncoupled, some related to the diagonal (same electron state) coupling [6], some off diagonal coupling [5].\nTraditionally, different models with different approximations are used to describe different carrier\ntransport phenomena. Unfortunately, it is often not known a priori which mechanism is involved for a\ngiven system. Furthermore, it is possible that several mechanisms are all at play in the same time, or\nthey dominate at different temperature regimes for the same system. Thus, it will be helpful to treat all\nthese mechanisms under an uniform framework. One such approach is the non-adiabatic molecular\ndynamics (NAMD) [15,16,17].\nIn the NAMD, the electron and the nuclei are moving at the same time. While the nuclei are moving\nfollowing their classical Newton's law, the electron wave functions are evolving following the time\ndependent Schrodinger's equation. By moving both electron and nuclei, and including their interaction\nthrough the Hamiltonian, all the aforementioned mechanisms can be described by NAMD. In the\nconventional ab initio molecular dynamics (ABMD) [18], at any given time t, the electrons will occupy\nthe electronic ground state for the atomic configuration at that time (the Born-Oppenheimer\napproximation). In NAMD, this is no longer true. The electronic state at time t will depend on its\nhistory, and it is described by the time dependent Schrodinger's equation.\nThe applicable scope of NAMD is far beyond the carrier dynamics in organic systems. For example,\nit can be used to study the carrier cooling from high excited states [19], charge transfer between organic\nand inorganic systems [20,21], and coherent or semicoherent processes [11]. It can also be used to\n\n2\n\n\fdescribe the effects of charge transfer to the ionic movements in a catalytic process [22], or charge\ntransfer in a solvent [23]. It has also been used to study the dynamic behavior in multi-electron systems\n[24].\nIn recent years, we saw a surge of NAMD studies [25,26,27,28,29], from organic systems to\nnanostructures, showing the promise and people's interest of this approach. Unfortunately, the NAMD\nsimulation can be extremely expensive. Due to the small mass of the electron (equivalently, the large\nenergy spectrum of its movement), the time step one can use to evolve the Schrodinger's equation is\ntypically 10-3 fs. This is a thousand times shorter than the traditional ABMD step. As a result, the\ncurrent NAMD calculations are either for relatively small systems (e.g., less than 200 atoms) [19,20,21],\nor for tight-binding [25] and other simplified model Hamiltonians [30,31].\nIn the current paper, we present a few new techniques which significantly accelerate the speed of the\nNAMD simulation. Using these techniques, for the first time, a NAMD simulation has been carried out\nfor a 4802 atom system for about 1 ps using an ab initio Hamiltonian. The Hamiltonian is described\nusing the plane wave pseudopotential (PWP) method at the density functional theory (DFT) level. We\nhave used this simulation to study the carrier transport mechanism for a monolayer of five thiophene\nring oligomer 5TBA (pentathiophene butyric acid), which demonstrates a herringbone 2D crystal\nstructure. Our simulation reveals a previously unknown new mechanism for carrier transport in the\nsystem: a thermo fluctuation induced wave function localization, and the charge transfer during state\nenergy crossing. We expect similar mechanism can be applied to some other organic crystals.\nThe highlights of our study can be summarized as the following: (i) a linear change approximation for\nthe electron Hamiltonian is used within a time interval of 0.5 fs. This allows the time step for the\ncomputationally most expensive part to be 0.5 fs, instead of 10-3 fs, thus increases the speed of the\nsimulation by hundreds of times. (ii) a modified Ehrenfest dynamics is introduced, which can be used as\nan alternative method to Tully's energy surface hopping algorithm. (iii) in the current work, we have\nignored the feedback from the electron movement to the nuclei movement, thus the nuclei movement is\ndetached from the electronic state description and can be described by a classical force field. This\napproximation is often used to treat the carrier dynamic in a large system and when the polaronic effect\nis relatively small. (iv) the charge patching method (CPM) is used to describe the Hamiltonian, while an\noverlapping fragment method (OFM) is used to diagonalize the Hamiltonian matrix. Although these are\napproximations, we show that the errors they introduced are rather small. (v) we found that the main\nmechanism for the carrier transport in the 5TBA thin film is by the state crossing, while the state\nlocalizations are induced by thermo fluctuation (dynamic disorder), rather than polaronic atomic\n3\n\n\frelaxation. This is a new mechanism which has not been discussed before. It is different from the\npolaronic state crossing (Marcus theory [32]), and also different in some degree from the pure dynamic\ndisorder picture proposed by Troisi et.al. [9].\n2. The formalism and the approximations\nHere we describe the basic formalism for a NAMD simulation. If we use {R(t)} to denote the nuclei\npositions, which are changing as functions of time t, then the electron Hamiltonian H, which depends on\nR(t), is also a function of time. As a result, we have a time dependent Schrodinger's equation (the KohnSham equation in DFT) as:\n\ni\n\n\u2202\u03c8\n= H (t )\u03c8\n\u2202t\n\n(1)\n\nHere we have used \u03c8 to denote a single electron wave function. Meanwhile, the molecular dynamics\n(MD) movement of {R(t)} is described by the classical Newton's equation:\nMi\n\nd 2 Ri (t )\n= Fi\ndt 2\n\n(2)\n\nHere M i is the mass of atom i, Ri(t) is its position and Fi is the force acting on atom i. The force can be\ncalculated ab initio from DFT method based on H(t). In that case, the forces depend on the single\nelectron wave functions \u03c8, thus equations (1) and (2) are fully coupled. As we mentioned in the\nintroduction, in the current work, we will use classical force field (CFF) method to describe the nuclei\ndynamic of the organic system. As a result, Fi only depends on the atomic configuration {R(t)}, thus\nwhile Eq.(1) depends on Eq.(2), Eq.(2) no longer depends on Eq.(1). This detachment has been used, for\nexample, to study the carrier cooling in a quantum dot [19]. There are some consequences of this\napproximation. First, the total energy of the electron+nuclei system is no longer conserved. For\nexample, the nuclei system can continuously pump energy into the electron system, while the energy of\nthe nuclei system itself remains conserved. However, this problem can be partially solved by the Tully's\nalgorithm with some modifications. In this paper, we also introduce an alternative method (to be called\nmodified Ehrenfest dynamics) which introduces a Boltzmann factor in the state-to-state transition rate.\nAlthough we still cannot define a conserved total energy after these treatments, they will prevent the\nsystem from divergence in total energy, and help it to reach some quasi steady state. That is sufficient\nfor the purpose of charge transfer calculations. The second problem is that the detachment will ignore\nthe polaronic atomic relaxation. In this effect, the occupation of one localized electron state will induce\natomic relaxations near that state, which further localizes the electron wave function. We have tested\nthat in our current system, such polaronic effect is relatively small. Nevertheless, for general problems,\n4\n\n\fwe do plan to include such polaronic effects in the future work with some approximated methods.\nTo solve Eq.(1), one can just apply H directly to wave function \u03c8 at every time step. But that can\nbe quite time consuming. Furthermore, as we will show later, it is necessary to introduce energy surface\nhopping, or other state transition analysis. This requires us to analyze the wave function in terms of the\nadiabatic states {\u03c6i(t)}, which are eigen states of H(t) at any given time t:\n\nH (t )\u03c6i (t ) = \u03b5 i (t )\u03c6i (t )\n\n(3)\n\nThus a common practice is to expand the wave function \u03c8(t) using these adiabatic states:\n\n\u03c8 (t ) = \u2211 Ci (t )\u03c6i (t )\n\n(4)\n\ni\n\nThen the solution of Eq.(1) becomes the solution of coefficients {Ci(t)}. One can plug Eq.(4) back to\nEq.(1), then we have:\nC& i (t ) = \u2212i\u03b5 i (t )Ci (t ) \u2212 \u2211k C k (t )Vik (t )\n\n(5)\n\nand here Vik is a transition rate between adiabatic states \"i\" and \"k\", which can be calculated as:\n\nVik (t ) = [ \u03c6i (t ) | \u03c6k (t + \u03b4t ) \u2212 \u03b4 i ,k ]/ \u03b4t\n\n(6)\n\nThe Hamiltonian in Eq.(1) depends on atomic positions {R(t)}, but it also depend on the electron wave\nfunctions \u03c8. In the current study, we will only consider the situation where only one carrier (in our case,\na hole in the valence band) exists, which is not in its ground state (e.g., the valence band maximum\n(VBM) state for the hole), and all the other valence electrons are in their ground state. Thus, the total\ncharge density of the system at t equals the ground state charge density \u03c10(t) of the neutral system plus\n(or minus in our case of hole) |\u03c8(t)|2. However, if the carrier wave function \u03c8(t) is not very localized, for\nthe same reason that we have ignored the effect of \u03c8(t) to the nuclei force F, here we can also ignore the\ncontribution of \u03c8(t) to the Hamiltonian H(t). Note, as we are using H to describe other electron's\ninteraction to the carrier wave function \u03c8 in Eq.(1), ignoring the effect of |\u03c8(t)|2 to the Hamiltonian can\nalso help us to avoid the self-interaction error [33] in the local density approximation (LDA).\nThus, we will use the ground state (Born-Oppenheimer energy surface) charge density to describe H,\nwhich then depends only on {R(t)}. One can occupy all the valence adiabatic states {\u03c6i(t)} from Eq.(3)\nand solve the Hamiltonian H self consistently as in a traditional ABMD to get H(t). Here we will use the\ncharge patching method (CPM) [34,34] to get \u03c10(t) for a given atomic configuration {R(t)}. The CPM\n[34,35] is a well tested method to provide the ground state electronic charge density without going\nthrough a self consistent calculation. It generates atomic charge density motifs from small system\ncalculations, then patches these motifs together to get the charge density of a large system. After \u03c10(t) is\nobtained, it is used with the DFT formalism (e.g., LDA) to get the single particle Hamiltonian (the total\npotential V(r)). The resulting eigen energy error of a CPM is typically 20-30 meV compared with the\n5\n\n\fdirect LDA calculation [35]. Figure 1 shows the comparison between the CPM and the direct self\nconsistent field (SCF) LDA ground state result for one snapshot {R(t)} of a 2x2 5TBA monolayer\nsupercell (each unit cell has 2 5TBA oligomers, thus there are 392 atoms in the supercell) with room\ntemperature random thermo atomic displacements. Table.I also lists the first few hole eigen energies of\na few snapshots for the 2x2 system comparing the SCF LDA results with the CPM results. From both\nFig.1 and Table.I, we see that the CPM eigen energies are close to the SCF LDA eigen energies. This\nestablishes the CPM as a good method to describe the ground states of our system.\n\nFig.1, comparison of the eigen energies between SCF DFT, the CPM, and the CPM solved with OFM. Note the folded\nspectrum method (FSM) is an exact method involves no approximation for solving the electron eigen states for a given H.\nMethod\n\nVBM (eV)\n\nVBM-1 (eV)\n\nVBM-2 (eV)\n\nT=0 K\n\nSCF DFT\n\n0.095\n\n-0.066\n\n-0.148\n\nRelaxed\n\nCPM\n\n0.092\n\n-0.068\n\n-0.150\n\nT=300K\n\nSCF DFT\n\n0.153\n\n0.008\n\n-0.056\n\nSnapshot 1\n\nCPM\n\n0.174\n\n0.023\n\n-0.008\n\nT=300K\n\nSCF DFT\n\n0.143\n\n0.008\n\n-0.046\n\nSnapshot 2\n\nCPM\n\n0.158\n\n0.034\n\n-0.047\n\nTable I, the eigen energies comparison between the selfconsistent DFT calculations (SCF DFT) and the charge patching\nmethod calculations (CPM) for different atomic configurations of a 2x2 herringbone structure supercell.\n\nUsing CPM, at any given time t, with {R(t)} provided by the CFF MD simulation, we can construct the\nHamiltonian H(t) relatively easily. Now, the task is to integrate Eq.(5). To do that, one needs a small\ntime step of 10-3 fs. This requires the evaluation of \u03b5i and Vik at every 10-3 fs interval. If they are\ncalculated by directly solving the Schrodinger's equation (3) for every 10-3 fs, it will be prohibitively\nexpensive in computation. Here, we have adopted a linear approximation for H(t). According to this\n6\n\n\fapproximation, within a time interval [t1, t2] (here \u2206t=t2-t1is of the order of fs), the Hamiltonian H(t) will\nhave the following linear dependence on time t:\nH (t ) = H (t1 ) + (t \u2212 t1 )( H (t 2 ) \u2212 H (t1 )) /(t 2 \u2212 t1 )\n\n(7)\n\nTo test this approximation, we have represented H(t) in the basis of the adiabatic eigen states at t1:\n{\u03c6i(t1)}. Some of the typical matrix elements: \u03c6 i (t1 ) H (t ) \u03c6 j (t1 ) are shown in Fig.2. As we can see,\nthese matrix elements are approximately linear within a 0.5 fs time interval. Note, although the\nHamiltonian H(t) changes linearly within this interval, the adiabatic eigen states \u03c6i(t) do not, for\nexample due to rapid state energy crossing. Now, we first solve Eq.(3) for every \u2206t (0.5 fs). From that,\nwe have {\u03b5i(t1),\u03c6i(t1)} and {\u03b5i(t2),\u03c6i(t2)}. In our cases, we have solved 50 top valence band states near\nthe band edge for the 7x7 supercell system. These 50 states span an eigen energy window of about 0.35\neV. We expect that this set of adiabatic eigen state is large enough for Eq.(5); as we will show later, the\naverage energy of \u03c8(t) is typically only about 0.05 eV away from the VBM energy, and the coefficient\nC50(t) in Eq.(5) is extremely small (in the order of 10-11 to 10-15).\n\nFig.2, the matrix elements of H(t) under the basis set of {\u03c6i(t1)}. Here the number in the Dirac bracket is the index \"i\" of the\nbasis function. The +200, +113, +80, +190 in (a) are the amount of shifts in meV in order to bring these curves together for\nviewing. This is for the 7x7 supercell system.\n\nNow, we will use \u03c6i(t1) i=1,N (N=50) as the basis set to diagonalize H(t). To do that, we need the\n\n7\n\n\fmatrix elements \u03c6i (t1 ) H (t ) \u03c6 j (t1 ) . Obviously we have \u03c6 i (t1 ) H (t1 ) \u03c6 j (t1 ) = \u03b5 i (t1 )\u03b4 i , j . Therefore, all\nwe need is to get the matrix element\n\n\u03c6i (t1 ) H (t 2 ) \u03c6 j (t1 )\n\nin order to use Eq.(7) to\n\nget \u03c6i (t1 ) H (t ) \u03c6 j (t1 ) . However, we know \u03c6 i (t 2 ) H (t 2 ) \u03c6 j (t 2 ) = \u03b5 i (t 2 )\u03b4 i , j Let's now assume {\u03c6i(t1)}\ncan be expanded by {\u03c6i(t2)} as: \u03c6 i (t1 ) = \u2211 j =1, N \u03c6 j (t 2 ) \u03c6 i (t1 ) \u03c6 j (t 2 ) , then \u03c6i (t1 ) H (t 2 ) \u03c6 j (t1 ) can be\nobtained from \u03c6 i (t 2 ) H (t 2 ) \u03c6 j (t 2 ) = \u03b5 i (t 2 )\u03b4 i , j by a simple unitary transformation. In reality, the\ntransformation \u03c6 i (t1 ) = \u2211 j =1, N \u03c6 j (t 2 ) \u03c6 i (t1 ) \u03c6 j (t 2 ) might not be unitary due to the lack of completeness\nof the basis set. We have carried out a Gram-Schmidt orthonormalization to make the matrix\n\n\u03c6 j (t 2 ) \u03c6 i (t1 ) unitary. However, most of the modifications happen to high eigen states i (when i is close\nto N). Because their coefficients Ci(t) in Eq.(4) are very small, the overall effect of this procedure on\n\u03c8(t) is very small.\nNow, we can integrate Eq.(5) within the interval [t1,t2]. This time, a very small time step dt (~10-3 fs)\ncan be used. At every small time step dt, the small NxN matrix \u03c6i (t1 ) H (t ) \u03c6 j (t1 ) is diagonalized. This\ngives us {\u03b5i(t),\u03c6i(t)}, which can be used to evaluate Eq.(6) and integrate Eq.(5). It is interesting to\ncomment that, we believe the similar linear approximation on H can be used for real time simulations of\ntime-dependent DFT (TDDFT) [36]. There, the time dependent wave functions for all the occupied\nstates need to be calculated. Nevertheless, depending on the situations, the related N can still be much\nsmaller than the dimension of the original Hamiltonian, thus significant saving becomes possible.\nBy using the linear approximation of H(t) in Eq.(7), we have increased the time step for solving the\nexpensive Schrodinger's equation (3) from dt (10-3 fs) to \u2206t (0.5 fs). Thus, the new computational cost is\nsimilar to that of a conventional ABMD. Furthermore, we have used the CPM to construct H(t),\ntherefore avoiding the need to do SCF DFT calculations at every step of \u2206t. This allows us to carry out\nthe NAMD simulation for a 4802 atom system (a 7x7 5TBA thin film supercell) for a long time (~1 ps).\nWe can solve Eq.(3) using the folded spectrum method (FSM) [37], which is exact, and does not\nintroduce any additional approximation. However, we found that it is faster to use the overlapping\nfragment method (OFM) [38] to diagonalize Eq.(3) especially because we need to solve N=50 eigen\nstates. The OFM method has been used to solve the eigen states of organic polymers, and yielded good\nresults compared with the direct FSM calculations [38]. In our case, in the OFM calculation, each 5 ring\n5TBA oligomer has been cut into three mutually overlapping fragments. Each fragment contains three\nthiophene rings, with the cut off bond passivated by additional H atoms. The eigen states of each\nfragment are solved separately (with its charge density calculated by the CPM). Then, the top of the\nvalence band state of each fragment is used as the basis set to diagonalize the original full system\n\n8\n\n\fHamiltonian H(t). The detail procedure of the OFM is described in Ref.[38]. In Fig.1, we also show the\nOFM results for the 2x2 supercell system. We can see that, although there is a 150 meV overall shift for\nthe \u03b5i curve, the overall shape of this curve agrees quite well with the original CPM+FSM result, and the\nSCF DFT result. Large errors only occur when the eigen energy is 1.5 eV away from the band edge\n(where the adiabatic eigen states are no longer included in the \u03c6i(t) of Eq.(4). The N=50 eigen states\n\u03c6i(t) in a 7x7 system only span a 0.35 eV energy window). We have also tested the 7x7 supercell system\nused for our final study. There are 294 fragment basis functions in the OFM. The OFM and FSM solved\neigen states look similar for their spatial localizations. The eigen energy changes with time are also\nsimilar for these two methods. For example, we have taken two snapshots in the MD trajectory, the\nVBM eigen energy difference between these two snapshots is -0.12 eV using FSM, while it is -0.14 eV\nusing OFM. Thus, we believe the OFM can quantitatively describe the eigen states of the system, and\ncan be used for our NAMD simulation.\n\n3. The physical systems, surface hopping and modified Ehrenfest procedures\n\nWe have used the formalism described in section 2 to calculate a 7x7 supercell of a 5TBA monolayer\nthin film. The structures of the thin film at room temperature and the single 5TBA oligomer are shown\nin Fig.3. This is a system similar to a previous tetradecyl pentathiophene butyric acid (TD5TBA)\nmonolayer [39] system studied by atomic force microscopy. The 5TBA monolayer has also been made\nexperimentally, and its p-type carrier lateral mobility is planned to be measured using micro-electrodes\n[40]. Both TD5TBA and 5TBA monolayer exhibit a herringbone packing pattern viewed from the top\nas shown in Fig.3. 5TBA oligomer differs from TD5TBA by missing the alkane chain on the top of the\nmolecule. As a result, the 5TBA oligomers tend to stand up vertically within the monolayer, instead of\nleaning towards one side as in the TD5TBA case [39]. The force field calculated 5TBA lattice constant\nin the x and y directions (Fig.3) are 7.6 and 5.7 \u00c5 respectively, which agree well with the experiments\n[40].\n\nFig.3, top view of the herringbone pattern (a) of the 5TBA oligomer (b) (side view). A 7x7 supercell with 4802 atoms is used\nin our study. In (b), the yellow indicates the S atom, green the C atom, white the H atom and red the O atom. The classical\n\n9\n\n\fforce field is used in a MD simulation to provide the thermo fluctuation of the molecules at room temperature. The\nhorizontal direction is defined as the x direction while the vertical direction is defined as the y direction. The dimensions for\nthese two directions for the 7x7 supercell are 53.20, 39.90 \u00c5 respectively.\n\nThe system in Fig.3 is simulated using CFF91 [41] force fields with some parameters modified to\nmake the relaxed 5TBA molecule structure agrees with the DFT result. Verlet algorithm is used to carry\nout the molecular dynamics using the code LAMMPS [42]. The simulation is done for several ps at the\nroom temperature [T=300K], while the last ps is used in our NAMD calculation.\nUsing the R(t) obtained from the classical MD, we then performed the NAMD calculation according\nto Eqs.(3)-(7) and the procedure described in section 2. Fig.4 shows the first few adiabatic eigen state\nenergies changing with time t, and the isosurface plots of the corresponding eigen states. From Fig.4, we\ncan see that there are a lot of state energy crossings, especially for the lower energy valence states.\nSometime, one can trace one eigen state, seeing that its location does not change much although its\nenergy can go up and down over 0.1 eV (e.g., the second valence band (VB) state at t=0, the pink state,\nwhich is the same state as the third VB state at t=12 fs, the golden state. Here, when we trace on \"one\nstate\", we are not referring to one \"i\" in \u03c6i, instead, we are connecting the states after a state crossing by\ntheir wave function similarity).\n\nFig.4, the adiabatic state eigen energies (center) and the eigen state isosurface plots (two sides). Each colored curve in the\ncenter panel represents one \u03b5i for one \"i\". The isosurface contains 98% of the charge density in |\u03c6i(t)|2.\n\nThe adiabatic eigen states and eigen energies {\u03c6i(t),\u03b5i(t)} are calculated for 825 fs. The calculation is\ncarried out on the Jaguarpf machine at national center of computational science (NCCS) in Oak Ridge\nNational Lab. The main task is to calculate {\u03c6i(t),\u03b5i(t)} from Eq.(3) with an interval of 0.5 fs (thus there\nare 1651 snapshots for the 825 fs). In our case, we have the benefit that all the {R(t)} are known before\nthe calculation of {\u03c6i(t),\u03b5i(t)} for this 825 fs. Thus, the calculations for different snapshots can be carried\nout in a parallel fashion. Typically, we carried out 22 snapshot groups at the same time. We use 2352\ncomputer cores for each snapshot group. Thus, in total, we have used 51,744 computer cores. In the\nOFM calculation, the 2352 cores for each snapshot groups are further divided into 294 groups, each\ngroup with 8 cores. In this way, one computer core group (with 8 cores) will calculate one fragment in\n10\n\n\fOFM. Each snapshot group will typically have 25 (due to memory limitation) snapshots consecutively\nin time. In this way, one snapshot's calculation can start with the fragment wave functions of the\nprevious snapshot, thus saving time for the iterative convergence. One such calculation takes about 1\nhour of wall clock time and we can get 550 snapshots (275fs). Thus the total calculation takes about 3\nhours. A plane wave kinetic energy cut off of 50 Ryd is used in the calculation, norm conservation\nnonlocal pseudopotentials are used, and the x, y, z real space grid points of the 7x7 supercell are 336,\n252, 224 respectively.\nAfter all the {\u03c6i(t),\u03b5i(t)} are obtained, the \u03c8(t) is integrated starting from the adiabatic VBM state at\nt=0. This integration part doesn't take much time. The average energy of \u03c8(t) is shown in Fig.5(b) as the\npink line. As we can see from Fig.5(b), despite the fact that at t=0, the \u03c8(0) equals \u03c61(0), the \u03c8(t)\nquickly evolves into some kind of quasi-steady state in a very short time, around 15 fs. Unfortunately,\nthis quasi-steady state is rather unphysical. It is about 0.2 eV below the VBM, and seems to be in the\nmiddle of the 50 \u03c6i(t) states chosen to be included in Eq.(4). Thus, this behavior is an artifact. This\nartifact is a consequence of the Ehrenfest approximation [43]. Note that so far, we have only followed\nthe Eqs.(1) and (2), without introducing any energy surface hopping. This is an Ehrenfest dynamics. In\nsuch a dynamics, in Eq.(5), the transition from state i to state k is treated the same as the transition from\nstate k to state i regardless of the low/high order of their eigen energies (\u03b5i, \u03b5k). As a result, the electron\nstate \u03c8 will quickly reach an equilibrium among all the adiabatic states {\u03c6i} in Eq.(4). This process and\nits transition rates between the adiabatic states violate the detailed balance (which states that the ratio of\nthe averaged transition rate from i to k and the transition rate from k to i should be equal to exp(-(\u03b5i\u03b5k)/kT)). This problem of Ehrenfest dynamics has been discussed in Ref.[25], although the solution of\nthis problem given in that work is different from the one we will provide below.\n\n11\n\n\fFig.5, the adiabatic eigen energies and the averaged \u03c8(t) energy. (a) is the enlarged view for only 100 fs, the thin lines are\nadiabatic eigen energies, and the thick red line is the averaged \u03c8(t) of the modified Ehrenfest (ME) method using Eq.(8). (b)\nis for the full simulation plotting out only \u03b51(t) and \u03b550(t). The red line is the same as the thick red line in (a), while the pink\nline is original Ehrenfest method without the Boltzmann factor in Eq.(8), and green line is the average energy calculated\nusing Boltzmann distribution from all the adiabatic eigen energies {\u03b5i(t)}.\n\nNote that, our approximation which detaches the nuclei dynamic of Eq.(2) from the electronic\nmovement of Eq.(1) (as a result, the total energy is not conserved) is not the source of this problem. To\ntest this, we have taken a simple 1D model Hamiltonian from Ref.[30] which includes both the\nelectronic and nuclei dynamics. We have performed an Ehrenfest dynamics of this system which\nconserves the total energy. The result also shows similar behavior as in the dynamics shown in Fig.5(b).\nThis problem is a consequence of the classical treatment of the nuclei dynamics using Newton's law. In\na quantum mechanical treatment of the nuclei movement, even at zero temperature (no atomic\nmovement in the classical treatment), there is a zero phonon mode, which can still induce transition\nfrom i to k as long as \u03b5i < \u03b5k (for hole state energy, this means the hole loses energy in the transition),\nbut the transition from k to i cannot happen. In the quantum mechanical picture, it is this difference\nwhich maintains the detailed balance between the transition rate from i to k, and the transition rate from\nk to i (e.g., in a simple Fermi golden rule formalism of a single phonon emission/absorption transition\nprocess, the i to k transition rate has a prefactor (n\u03bd+1), the k to i transition rate has a prefactor n\u03bd, here\n12\n\n\fn\u03bd is the Bose-Einstein distribution of the phonon mode \u03bd with an energy \u03b5k-\u03b5i ). All these are missing in\nthe classical treatment of the nuclei movement.\n\nIn Tully's algorithm [44], this detailed balance is restored by checking the possibility of each energy\nsurface hopping. In Tully's algorithm and the related picture, although the \u03c8(t) is calculated, the actual\nelectronic system always resides on one adiabatic state \u03c6i(t) (thus on an adiabatic energy surface) at a\ngiven time t and its trajectory keeps hopping (switching) among the different i's (hence the name:\nenergy surface hopping). Thus the electronic property of the system at time t should be calculated based\non \u03c6i(t) (although the index i can suddenly change with time), but not on \u03c8(t). The surface hopping from\ni to k is sudden (instantaneous), but the \u03c8(t) will not change after the hopping, only the nuclei\nmovement will be rescaled, and follow a different energy surface (adiabatic state). In a way, the \u03c8(t) is\njust an auxiliary function to help us to determine how does the system hop from one adiabatic state i to\nanother adiabatic state k. In the mean time, between two hoppings when the system resides on an\nadiabatic state i, the nuclei movement follows the energy surface of this adiabatic state i (just as in a\nBorn-Oppenheimer approximation, although here i might not be the ground state), thus the total energy\nis also conserved. Note, this is a very different picture than the picture in Ehrenfest dynamic, where the\nreal electronic system is described by \u03c8(t), not just on one adiabatic state, and the electronic properties\nshould be calculated based on \u03c8(t).\nIn Tully's algorithm, when a state hopping from i to k is proposed to happen, a related transition\ndegree of freedom in the nuclei system is calculated, then the kinetic energy on this degree of freedom is\nchecked. If \u03b5i < \u03b5k, then the hopping will always be allowed, and the velocity on the transition degree of\nfreedom will be rescaled so its kinetic energy will increase by \u03b5k-\u03b5i after the hopping. If \u03b5i > \u03b5k, and the\nrelated kinetic energy is smaller than \u03b5i-\u03b5k, then the hopping will be forbidden (not happen). If the\nkinetic energy is larger than \u03b5i-\u03b5k, then the hopping will happen, but the velocity will be rescaled so its\nkinetic energy will be reduced by \u03b5i-\u03b5k. This procedure ensures that the total energy is conserved during\nthe transition, and it treats the transition from i to k differently from the transition from k to i depending\non their relative energies. This different treatment restores the detailed balance.\nIn our detached treatment between the electron and nuclei movements, although the total energy\nconservation as the sum of the electron and nuclei systems is no longer held, we can still use the nuclei\nkinetic energy on the transition degree of freedom to determine whether an energy surface hopping is\nallowed or forbidden following Tully's algorithm (we might choose not to rescale the nuclei kinetic\nenergy after the transition). Since the kinetic energy on any degree of freedom follows the Boltzmann\ndistribution, thus statistically, it is equivalent to say when \u03b5i < \u03b5k, the transition is always allowed, and\nwhen \u03b5i > \u03b5k, the transition only has a probability of exp(-(\u03b5i-\u03b5k)/kT) for it to happen. This procedure has\n13\n\n\fbeen used by Prezhdo et.al [19] to study the carrier cooling in a quantum dot. Here, we will follow the\nsame procedure. Note that, in this case, all the effects of surface hopping can be described by a master\nequation on the populations Pi(t) on each \u03c6i(t) state, while the transition rate from Pi(t) to Pk(t) is\ndescribed by Tully's formula [44]: R'i,k(t)=Re[Ck(t)Ci*(t)Vik(t)]/|Ci(t)|2 with an additional prefactor 1 for\n\u03b5i < \u03b5k or exp(-(\u03b5i-\u03b5k)/kT) for \u03b5i > \u03b5k.\nBefore showing the result of Tully's algorithm, we would first like to introduce an alternative\napproach. In this approach, we follow the physical picture of Ehrenfest approximation, e.g., the\nelectronic system is described by \u03c8(t), and there is no energy surface hopping. However, in order to\ndescribe the effect of the quantum mechanical zero phonon mode, we will introduce a factor in Eq.(5),\nthus we have:\nC& i (t ) = \u2212i\u03b5 i (t )Ci (t ) \u2212 \u2211k C k (t )Vik (t ) f (\u03b5 i \u2212 \u03b5 k , t )\n\n(8)\n\nHere, if Ri,k\u2261Re[Ck(t)Ci*(t)Vik(t)]>0 (the weight transition is from i to k), then f(x,t)=1 for x<0 (energy\nof state i is larger than the energy of state k) and f(x,t)=exp(-x/kT) for x>0 (energy of state i is smaller\nthan the energy of state k). Similarly, if Ri,k<0 (the weight transition is from k to i), then\nf(x,t)=exp(x/kT) if x<0 and f(x,t)=1 if x>0. We will call the algorithm of Eq.(8) as the modified\nEhrenfest (ME) algorithm. Note the \u03c8(t) in this algorithm will be different from the \u03c8(t) in Tully's\nalgorithm which follows Eq.(5). One might worry that the change of f(x,t) might interrupt the coherence\nof the wave function evolution. Such coherence of wave function change (e.g., the coherent\naccumulation of the wave function weight from one adiabatic state to another adiabatic state) is\nimportant, for example to describe a single phonon absorption/emission induced transition in the weak\ncoupling case. More in-depth analysis can show that such concerns are not warranted. For example, in a\nstate energy crossing case, where the weight transition from one state to another can be large and rapid,\nthe |\u03b5i-\u03b5k| usually is very small, thus the effects of the factor f(x,t) is small. In the case of one phonon\nabsorption (or emission) induced transition, usually the sign of Re[Ck(t)Ci*(t)Vik(t)] does not change in\nthe whole transition period (where coherent weight accumulation happens), thus the f(x,t) also does not\nchange during this period, so the coherence of the wave function change will not be interrupted. We do\nnote that, there are other intrinsic shortcomings of the Ehrenfest algorithm [43,44,45]. Most notably the\nspreading of \u03c8(t) overall several \u03c6i(t) which are physically separated. That will affect the amplitudes of\nthe polaronic atomic relaxations. In our current work, we have ignored such polaronic effect from the\nbeginning, thus the corresponding shortcoming is not an issue here.\nThe result of this modified Ehrenfest (ME) algorithm is shown in Fig.5(a) and (b) as the red lines.\nWe see that, this time, the average energy of \u03c8(t) is much closer to the VBM energy as expected. In\nFig.6, we also show the comparison between the ME result and the Tully's algorithm result [note, in\n14\n\n\fTully's algorithm, the \u03c8(t) is still described by Eq.(5) and the average energy of \u03c8(t) is the pink line in\nFig.5(b), but the populations on the adiabatic states have a much higher average energy]. From the plot,\nwe see that although ME algorithm and Tully's algorithm give different results, they are close to each\nother, and behave qualitatively in a similar way.\n\nFig.6, the comparison between the ME algorithm result and the Tully's algorithm result.\n\nAt this time, it is interesting to introduce the Boltzmann average energy. This is the average energy at\ntime\n\nt\n\naccording\n\n\u03b5 ave = \u2211i\u03b5 i exp(\u03b5 i / kT )\n\nto\n\na\n\n\u2211 exp(\u03b5\ni\n\ni\n\nBoltzmann\n/ kT )\n\ndistribution\n\nof\n\nthe\n\nadiabatic\n\nstates\n\n\u03b5i:\n\n. This energy is shown in Fig.5(b) and Fig.6. We can see that the\n\nBoltzmann average energy is higher than the two NAMD results, and it is much closer to the VBM. This\nis an important conclusion because in many phenomenological treatments, the Boltzmann distribution\namong the adiabatic electron states is always assumed. Here the reason for the NAMD results (either the\nME algorithm or Tully algorithm) to fail to reach the Boltzmann distribution is due to the rapid eigen\nenergy changes of the adiabatic states, especially for the band edge VBM state. The system does not\nhave enough time to respond to this change, hence to reach the equilibrium, thus it is always in a\nnonequilibrium situation.\nTo further illustrate the difference between the ME and Tully algorithms, we have shown in Fig.7\nthe population Pi(t) on the adiabatic state i in the Tully's algorithm, and the |Ci(t)|2 of Eq.(4) in the ME\nalgorithm. We see that, the Pi(t) and |Ci(t)|2 can change suddenly, but that is due to the state crossing,\nwhere the indexes of the two crossing states exchanged. At the beginning, when |Ci(t)|2 and Pi(t) started\nfrom the same occupation (e.g., VBM), the first few states in ME and Tully's algorithm look similar.\nBut when their amplitudes become small, their behaviors are quite different. This means the Pi(t) in\nTully's algorithm and |Ci(t)|2 in ME algorithm can be very different when both of them are very small.\nNote, both Pi(t) in Tully algorithm and |Ci(t)|2 in ME algorithm are mainly distributed among 4-7 states\nnear the top of the valence band. Given these differences, at this stage, it is still difficult to judge which\n15\n\n\falgorithm is better, making more physical sense.\n\nFig.7, |Ci(t)|2 in the ME algorithm (a), and Pi(t) in Tully's algorithm (b). A sudden change in these quantities usually means a\nstate crossing (as a result, the identity of the states exchanges).\n\n4. The simulation results and the carrier transport mechanisms\n\nThe main purpose of our study is to reveal the underlying mechanism of the carrier transport in the\nmonolayer thin film of 5TBA. Due to its molecular crystal structure, this system can be used as an\nexample for other organic molecular crystals. We do have to keep in mind that the relative strength\nbetween the inter-molecular coupling, the molecule reorganization energy, and thermo fluctuation effect\ncan divide the organic molecular crystals into different regimes. Our case might belong to relatively\nlarge thermo fluctuation and inter-molecular coupling. Prior to the calculation, one can hypothesize\ndifferent possible mechanisms for the carrier transport: (i) band structure transport by extended bulk\nBloch states [3]; (ii) polaron hopping, where the polaron localization is induced by atomic relaxation\ndue to the existence of the hole state [6]. Furthermore, many of the literature for such molecular crystals\nassume the polaron is one hole at one molecule (in our case one 5TBA oligomer) [46]; (iii) localized\nstate drifting, where the localization is induced by molecule thermo fluctuation, and the same fluctuation\ncan cause the localized states to change their positions with time. Thus the carrier mobility is produced\nby the state shifting (while the hole is residing on the same state without any state transition); (iv)\n\n16\n\n\flocalized state transitions by absorption/emission of a single phonon as described by a simple Fermi\ngolden rule [5]; (v) localized state energy crossing, while they cross each other in energy, the carrier\nresiding on one state can jump to another state.\nWe see many band structure calculations for organic periodic structures. The underline assumption\ncould be that the band structure and the effective mass can be relevant to the carrier transport through a\nbulk transport picture. Our calculation shows that at room temperature, the adiabatic states are localized\namong 10-20 5TBA oligomers as shown in Fig.4. Thus the wave function is not extended, and the\nhypothesis (i) is invalid. Another common picture is that the wave function will localize in a single unit\n(e.g., a molecule, or the oligomer in our case) of the structure and form a polaron. Then it will hop from\none unit to another. In such a polaron picture, the localization is induced by atomic relaxation due to\nstrong electron-phonon coupling (not by thermo fluctuation), thus it will form even at zero temperature.\nWe have performed DFT/LDA calculations with the 2x2 supercell (which contains 8 5TBA oligomers)\ncontaining one hole at zero temperature. Despite initial distortion to the atomic positions and initial hole\nwave function localizations, after SCF iterations and atomic relaxation, the hole wave function is\nextended uniformly in the 2x2 supercell and there is no localization. This means that at zero\ntemperature, there is no polaron, at least no polaron with wave functions localizations smaller than 8\n5TBA oligomers. If there is a polaron, the size of the polaron must be larger than 8 5TBA oligomers,\nhence larger than the thermo fluctuation induced localization as shown in Fig.4. Thus the hypothesis (ii)\ndoes not hold, and the main reason for localization is the thermo fluctuation (dynamic disorder), not the\nhole induced atomic relaxation and the reorganization energy. From the 2x2 supercell DFT calculation,\nwe get a reorganization energy of 20 meV (the reorganization energy is the energy drop of the system\nwith a hole from the initial neutral system (without hole) relaxed atomic positions to the final relaxed\natomic positions with the hole). Since the thermo fluctuation induced wave function localizations shown\nin Fig.4 are similar to the 2x2 supercell size, we expect that the atomic relaxation energies of these\nlocalized states should also be around 20 meV. Such atomic relaxation energy, e.g. the electron wave\nfunction feedback to nuclei movement, is ignored in our current detached treatment, thus we don't have\nthis 20 meV relaxation energy. Nevertheless, this energy is much smaller than the ~100 meV energy\nfluctuations of VBM shown in Figs.5, 6, which is induced by thermo fluctuation. Once again, this shows\nthat the polaron effect is much weaker than the thermo fluctuation effect in our system. Nevertheless the\ninclusion of such \"polaron\" relaxation effect in the future might modify the results quantitatively to\nsome degree, although we do not expect it to change the qualitative picture. In the following, we will\naddress the points (iii), (iv) and (v).\nFigure 8 shows the diffusion distance square as a function of time t. Note, although this is done with t=0\n17\n\n\fnot in the steady state (e.g., \u03c8(t=0)=\u03c6VBM(t=0)), recalculating this diffusion distance starting from a\nsteady state (e.g., after 10 fs) snapshot doesn't change the result very much, probably due to the fast\nrealization of the steady state near t=0. Note, the 7x7 supercell is still relatively small. To calculate the\ndiffusion distance, we have repeated the system a few times in its x and y directions, and treat the image\nstates of an adiabatic state \u03c6i(t) as different states (e.g., with different coefficient Ci(t) in Eq.(4) and (7),\nand different Pi(t) in Tully's algorithm). This allows us to have larger diffusion distance than the box\nsize of the 7x7 supercell. Nevertheless, there are some limitations of this technique, as a result the\ndiffusion distance is saturated both for the ME algorithm and the Tully's algorithm. Thus we should\nonly judge the carrier mobility from the time period before the saturation.\n\nFig.8, the diffusion distance square as a function of the simulated time t.\n\nFrom Fig.8, we see that initially, the ME and Tully's algorithms get similar results. However, after some\ntime (50 fs), the Tully's algorithm yields a bigger diffusion distance. It is interesting to speculate\nwhether the slowdown in the ME algorithm is related to the weak localization phenomenon in a\ndisordered system, where coherently constructive back scattering can slow down the carrier diffusion\n[47]. Further analysis for this point will be done in the future. From the slop of the line in Fig.7 (taken\nfrom the Tully algorithm result), if we use a 2D diffusion formula of d2=4Dt, and \u03bc=eD/kT, we get a\nhole mobility \u03bc as 44cm2/Vs. This is a little bit large considered that most organic crystals have\nmobilities between 1-10cm2/Vs. But we have to keep in mind that this is a 2D system. We are still\nwaiting for experimental confirmation for this result. Another possibility is that, the polaronic atom\nrelaxation effect discussed above might be able to induce some additional self trapping for the thermo\nfluctuation induced localized states. Such deeper trapping can reduce the mobility. Further investigation\nis needed to know how large is such effect. We have also investigated the x and y direction diffusions,\nand found that the x direction is diffusing faster than the y direction [see Fig.1S].\nNow, to answer whether the diffusion is caused by state position drifting, we have plotted the\ncenter of the mass position of the first adiabatic state (VBM) in Fig.9 as a function of the time. We see\nthat when there is no state crossing, the position of the state does not change, despite of the fact, the\n18\n\n\fenergy of the state can change by as much as 0.1 eV during the same period. The same is confirmed by\nlooking at the states in Fig.4 (e.g., the second state at t=0, and the third state at t=12 fs in Fig.4). In\nFig.9, when the VBM and VBM-1 states cross, the identities of the states switch, which can cause a\nsudden change of the VBM position in the plot. Nevertheless, from the flat plateau in the state position\nbetween the state crosses, we can conclude that the state position drifting effect proposed in hypothesis\n(iii) should be small.\n\nFig.9, the center of mass position of the VBM state. Also shown are the eigen energies of the first two adiabatic states, and\nthe total transition rate R1(t) (defined as Ri \u2261\n\n\u2211 |R\nk\n\ni ,k\n\n| / | Ci |2 ) from the VBM state. When there is a peak in the transition\n\nrate R1(t), there is a state crossing between the VBM and VBM-1 states. Also, at such crossing, the VBM state position\nsuddenly changes, which is due to the change of identity between the VBM and VBM-1 state (the highest adiabatic state is\ncalled VBM), rather than a genuine shift of the state position.\n\nNext, we have investigated the state transition by absorbing or emitting a single phonon. Such transition\nis used to explain the carrier mobility in a disordered polymer system [5]. But here, the adiabatic state\nlocalizations are caused by thermo fluctuations, not by the disorder tangling/arrangement of polymer\nchains. Thus the state here can change more rapidly than in the disordered polymer system. In the Tully\nalgorithm (similar things can be done for the ME algorithm), we can turn off any energy surface\nhopping between states i and k, when |\u03b5i-\u03b5k|>5meV. Since most phonon modes have a phonon energy\nlarger than 5 meV, this will effectively turn off all the single phonon absorption/emission effects. The\nresulting diffusion distance square is very similar as the original result as shown in Fig.10. This means\nthe effect of single phonon absorption/emission transition as described in hypothesis (iv) is rather small,\nand can be ignored. Thus, finally, we can conclude that all the transitions happen when two states cross\neach other in their energies. When that happens, there is a fast transition of the wave function weight\nfrom one state to another state. That causes the position of the carrier to suddenly jump, and this jump\n(as described in hypothesis (v)) is the real cause for carrier mobility in our system.\n\n19\n\n\fFig.10, the diffusion distance with and without the |\u03b5i-\u03b5j|>5meV transitions.\n\nIt is interesting to comment on the difference and similarity of the state crossing observed in our\nsimulation and the state crossing in Marcus theory [32]. In both pictures, the state crossing plays an\nimportant role, and the transition happens when there is a state crossing. But in Marcus theory, the\natomic relaxation related reorganization energy plays an important role. The localization is either\nformed by a geometric confinement (e.g., within a molecule, or inside a quantum dot), or it is due to this\nreorganization (e.g., in a polaron). The reorganization energy is also the parameter to gauge the energy\nfluctuation which causes the state crossing. On the other hand, in our current problem, the localization\nof the state and the state energy fluctuation are caused by dynamic disorder induce by thermo\nfluctuation (not by reorganization energy). The fact that we get such state crossing while ignoring the\nhole induced atomic relaxation indicates that there are fundamental differences between these two\npictures. We also expect very different temperature dependence on the mobility (in our case, the state\nlocalization, not just the state energy fluctuation, also depends on the temperature).\nIt is also interesting to discuss the relationship between our picture and the dynamic disorder picture\nproposed by Troisi, et.al [19,30]. In their simulations, a model Hamiltonian is used which includes the\nfluctuation of the inter-molecule coupling. They have used pure Ehrenfest dynamics to monitor the\ndiffusion of the electron wave function. Both in their picture and our picture, the carrier mobility is\ndriven by this thermo fluctuation (dynamic disorder). However, in our simulation, we have included the\nsurface hopping in Tully's algorithm, or the additional Boltzmann factor in the ME. All these rely on the\nrepresentation of the wave function \u03c8(t) in terms of adiabatic states {\u03c6i(t)}. As a result, we can\nintroduce the concept of state crossing, and point out that the state crossing is the main underlying\nmechanism for the diffusion. This is absent from a pure Ehrenfest dynamics treatment. We have also\nused a realistic DFT Hamiltonian, which includes both intra and inter molecular fluctuations, and point\nout the described phenomenon happens in real systems.\n20\n\n\f5. Conclusion\n\nIn conclusion, we have presented several techniques to carry out a large scale simulation for nonadiabatic molecular dynamics (NAMD). These techniques and supercomputer facilities allow us to do\nNAMD in ab initio level for a 4802 atom system for about 1 ps in a few hours. More specifically, (i) a\nlinear approximation of the Hamiltonian dependence on time t is introduced, which increases the time\nstep of the computationally most expensive part, from 10-3 fs to 0.5 fs, thus reduces the computational\ncost by hundreds of times. Similar techniques can probably be used in simulations like real time\nTDDFT; (ii) a modified Ehrenfest dynamics is proposed, which restores the detail balance but without\nthe energy surface hopping. It can be used as an alternative approach to the Tully's algorithm; (iii) the\nnuclei movement and the electronic movement are detached, and classical force field is used for the\nnuclei movement. The charge patching method is used to construct the Hamiltonian, while the\noverlapping fragment method is used to diagonalize the Hamiltonian matrix; (iv) the whole approach\ncan be carried out using massively parallel computers, and can be scaled to 50,000 cores. As a result, the\nwhole calculation takes only a few hours.\nWe have used this approach to study the carrier transport of a 5TBA monolayer thin film. Such thin film\nhas been synthesized experimentally, and its transport property is planned to be measured\nexperimentally. Our main task is to reveal the underlying mechanism of hole transport in such a system.\nThis system demonstrates a herringbone 2D crystal structure, it thus can be used as one prototype for a\nclass of organic molecular crystals. Through our calculations, we found a new mechanism for carrier\ntransport. The carrier transport is mostly induced by state crossing between localized states. The\nlocalizations of the states are caused by the dynamic disorder induced by thermo fluctuation of the\nmolecules, rather than by polaronic atomic relaxation induced by the existence of the hole. Thus the\nstate crossing mechanism is very different from the ones described by Marcus theory. The state\nlocalization size is about 10-20 5TBA oligomers, instead of one 5TBA oligomer. In our simulation, we\nalso found that the occupations of the adiabatic states are often in a non-equilibrium situation. The\naverage energy calculated by the Boltzmann distribution using the adiabatic state eigen energies is much\ncloser to the VBM energy than the NAMD simulated result. The reason for this is the rapid fluctuations\nof the adiabatic state eigen energies induced by thermo fluctuation. The electronic state weight\nredistribution cannot respond to this eigen energy change fast enough to reach the equilibrium. Finally,\nour calculated hole mobility is 44 cm2/Vs, which is awaiting for experimental confirmation.\n\n21\n\n\fACKNOWLEDGMENT\n\nWe like to thank Dr. Martin, Hendriksen, and Salmeron for stimulating discussion. This work was\nsupported by SC/BES/MSED of the U.S. Department of Energy under the Contract No. DE-AC0205CH11231. This research used resources of the Oak Ridge Leadership Computing Facility, located in\nthe National Center for Computational Sciences at Oak Ridge National Laboratory, which is supported\nby the Office of Science of the Department of Energy under Contract DE-AC05-00OR22725. The\ncomputer time was allocated by the Department of Energy's Innovative and Novel Computational\nImpact on Theory and Experiment (INCITE) program. Vukmirovic is supported by European\nCommunity FP7 Marie Curie Career Integration Grant (ELECTROMAT), Serbian Ministry of Science\n(ON171017) and FP7 projects PRACE-1IP, PRACE-2IP, HP-SEE and EGI-InSPIRE\n\nREFERENCES\n\n[1] Coropceanu, V.; Cornil J.; ADa Silva Filho, D.; Olivier, Y.; Silbey, R.; Bredas, J.-L. Chem. Rev.\n2007, 107, 926.\n\n[2] Karl, N. Synthetic Metals 2003, 133-134, 649.\n[3] Giuggioli, L.; Andersen, J.D.; Kenkre, V.M. Phys. Rev. B 2003, 67, 045110.\n[4] Cheng, Y.C.; Silbey, R.J.; da Silva Filho, D.A.; Calbert, J.P.; Cornil, J.; Bredas, J.L. J. Chem. Phys.\n2003, 118, 3764.\n\n[5] Vukmirovic, N.; Wang, L.W. Nano Lett. 2009, 9, 3996.\n[6] Sokolov, A.N.; Atahan-Evrenk, S.; Mondal, R.; Akkerman, H.B.; Sanchez-Carrera, R.; GranadosFocil, S.; Schrier, J.; Mannsfeld, S. C.B.; Zoombelt, A.P.; Bao, Z.; Aspuru-Guzik, A. Nature\nCommun. 2011, 2, 437.\n[7] Shuai, Z.; Wang, L.; Li, Q. Adv. Mat. 2011, 23, 1145.\n[8] Hannewald, K.; Stojanovic, V.M.; Schellekens, J.M.; Bobbert, P.A.; Kresse, G.; Hafner, J. Phys.\nRev. B 2004, 69, 075211.\n[9] Troisi, A. J. Chem. Phys. 2011, 134, 034702\n[10] Picon, J.-D.; Bussac, M.N.; Zuppiroli, L. Phys. Rev. B 2007, 75, 235106.\n[11] Engel, G.S.; Calhoun, T.R.; Read, E.L.; Ahn, T.-K.; Mancal, T.; Cheng, Y.-C.; Blankenship, R.E.;\nFleming, G.R. Nature 2007, 44, 782.\n22\n\n\f[12] Rochefort A.; Boyer, P.; Nacer, B. Organic Elect. 2007, 8, 1.\n[13] Li, L.; Meller, G.; Kosina, H. Microelec. J. 2007, 38, 47.\n[14] Vukmirovic, N.; Wang, L.W. Phys. Rev. B 2010, 81, 035210.\n[15] Barbatti, M. Adv. Rev. 2011, 1, 620.\n[16] Dotsinis, N.L; Marx D. Phys. Rev. Lett. 2002, 88, 166402.\n[17] Horsfield, A. P.; Bowler, D.R.; Fisher, A.J., Todorov, T.N.; Sanchez, C. G. J. Phys.: Cond. Matt.\n2004, 16, 8251.\n\n[18] Tse, J. S., Annu. Rev. Phys. Chem. 2002, 53, 249.\n[19] Kilina, S. V.; Kilin, D. S.; Prezhdo, O. V. ACS Nano 2009, 3, 93.\n[20] Craig, C.F.; Duncan, W.R.; Prezhdo, O.V. Phys. Rev. Lett. 2005, 95, 163001.\n[21] Fischer, S.A.; Duncan, W.R.; Prezhdo, O.V. J. Am. Chem. Soc. 2009, 131, 15483.\n[22] Kiwi, J.; Morrison, C. J. Phys. Chem. 1984, 88, 6146.\n[23] Smallwood, C.J.; Bosma, W.B.; Larsen, R.E.; Schwartz, B.J. J. Chem. Phys. 2003, 119, 11263.\n[24] Larsen, R. E.; Schwartz, B.J. J. Chem. Phys. 2003, 119, 7672.\n[25] McEniry, E.J., et.al. Eur. Phys. J. B 2010, 77, 305.\n[26] Pittner, J.; Pederzoli, M. J. Phys. Chem. A 2011, 115, 11136.\n[27] Nelson, T.; Fernandez-Alberti, S.; Chernyak V.; Roitberg, A.E., Tretiak S. J. Phys. Chem. B 2011,\n115, 5402.\n[28] Zanuttini, D., Douady, J.; Jacquet, E.; Giglio, E.; Gervais, B. J. Chem. Phys. 2011, 134, 044308.\n[29] Tavernelli, I.; Curchod, B.F.E.; Roethlisberger, U. Chem. Phys. 2011, 391, 101.\n[30] Troisi, A.; Orlandi, G. Phys. Rev. Lett. 2006, 96, 086601.\n[31] Hultell, M.; Stafstrom, S. Chem. Phys. Lett. 2006, 428, 446.\n[32] Marcus, R.A. Rev. Mod. Phys. 1993, 65, 599.\n[33] Lundberg, M.; Siegbahn, P.E.M. J. Chem. Phys. 2005, 122, 224103.\n[34] Li, J.; Wang, L.W. Phys. Rev. B 2005, 72, 125325.\n[35] Vukmirovic, N.; Wang, L.W. J. Phys. Chem. B 2009, 113, 409.\n[36] Runge, E.; Gross, E.K.U. Phys. Rev. Lett. 1984, 52, 997.\n[37] Wang, L.W.; Zunger, A. J. Chem. Phys. 1994, 100, 2394.\n[38] Vukmirovic, N.; Wang, L.W. J. Chem. Phys. 2011, 134, 094119.\n[39] Hendriksen, B. L. M.; Martin, F.; Qi, Y.; Mauldin, C.; Vukmirovic, N.; Ren, J.F.; Katan, A. J.;\nAltoe, V.; Aloni, S.; Frechet J.M.J.; Wang, L.W.; Salmeron, M. Nano Lett. 2011, 11, 4107.\n[40] Martin, F.; Hendriksen, B. L. M.; Salmeron, M. (unpublished).\n[41] Maple, J.R.; Thacher, T.S.; Dinur, U.; Hagler, A.T. Chemical Design Automation News 1990, 5, 5.\n[42] LAMMPS: http://lammps.sandia.gov/\n23\n\n\f[43] Delos, J.B.; Thorson, W.R.; Knudson, S.K. Phys. Rev. A 1972, 6, 709.\n[44] Tully J.C. J. Chem. Phys. 1990, 93, 1061.\n[45] Delos, J.B.; Thorson, W.R. Phys. Rev. A 1972, 6, 720.\n[46] Holstein, T. Ann. Phys. 1959, 8, 725.\n[47] Kramer, B.; MacKinnon, A. Rep. Prog. Phys. 1993, 56, 1469.\n\n24\n\n\fSupplementary information for: Non-adiabatic Molecular Dynamics\nSimulation for Carrier Transport in a Molecular Monolayer\nJunfeng Ren(1,2), Nenad Vukmirovi\u0107(3), Lin-Wang Wang(1)*\n(1) Material Science Division, Lawrence Berkeley National Laboratory, One Cyclotron Road,\nMail Stop 66, Berkeley, CA 94720\n(2) College of Physics and Electronics, Shandong Normal University, Jinan 250014, China\n(3) Scientific Computing Laboratory, Institute of Physics Belgrade, University of Belgrade,\nPregrevica 118, 11080 Belgrade, Serbia\n(*) Email: lwwang@lbl.gov\n\nFig.1s shows the diffusion distance squares in x and y directions defined in Fig.1. These are calculated by\nthe modified Ehrenfest dynamics. The results from Tully's algorithm are similar. Note that the ratio of\nthe diffusion distance squares (hence the mobility) in the x and y directions is the opposite as reported\nin Ref.[1]. This is because in Ref.[1], the oligomer is TD5TBA (tetradecyl pentathiophene butyric acid),\nwhile in the current work, the oligomer is 5TBA (pentathiophene butyric acid) without the top alkane\nchain. Due to this difference, the packing lattice constants are different for these two oligomers. In 5TBA,\nthe packing in x direction is closer, resulted in stronger electron coupling and higher mobility in this\ndirection.\n\nFig.1S, the diffusion distance squares in the x and y directions calculated by the modified Ehrenfest algorithm.\n\n\fReferences\n[1] Hendriksen, B. L. M.; Martin, F.; Qi, Y.; Mauldin, C.; Vukmirovic, N.; Ren, J.F.; Katan, A. J.; Altoe, V.;\nAloni, S.; Frechet J.M.J.; Wang, L.W.; Salmeron, M. Nano Lett. 2011, 11, 4107.\n\n\f"}