{"id": "http://arxiv.org/abs/math/0306301v2", "guidislink": true, "updated": "2008-07-24T03:23:47Z", "updated_parsed": [2008, 7, 24, 3, 23, 47, 3, 206, 0], "published": "2003-06-19T22:26:08Z", "published_parsed": [2003, 6, 19, 22, 26, 8, 3, 170, 0], "title": "Leonard pairs and the q-Racah polynomials", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0306091%2Cmath%2F0306085%2Cmath%2F0306118%2Cmath%2F0306031%2Cmath%2F0306196%2Cmath%2F0306233%2Cmath%2F0306237%2Cmath%2F0306029%2Cmath%2F0306148%2Cmath%2F0306160%2Cmath%2F0306353%2Cmath%2F0306206%2Cmath%2F0306243%2Cmath%2F0306274%2Cmath%2F0306394%2Cmath%2F0306330%2Cmath%2F0306348%2Cmath%2F0306224%2Cmath%2F0306057%2Cmath%2F0306280%2Cmath%2F0306096%2Cmath%2F0306102%2Cmath%2F0306075%2Cmath%2F0306184%2Cmath%2F0306373%2Cmath%2F0306073%2Cmath%2F0306369%2Cmath%2F0306251%2Cmath%2F0306067%2Cmath%2F0306273%2Cmath%2F0306081%2Cmath%2F0306307%2Cmath%2F0306200%2Cmath%2F0306214%2Cmath%2F0306388%2Cmath%2F0306327%2Cmath%2F0306122%2Cmath%2F0306315%2Cmath%2F0306070%2Cmath%2F0306337%2Cmath%2F0306025%2Cmath%2F0306244%2Cmath%2F0306055%2Cmath%2F0306053%2Cmath%2F0306153%2Cmath%2F0306256%2Cmath%2F0306046%2Cmath%2F0306324%2Cmath%2F0306179%2Cmath%2F0306239%2Cmath%2F0306401%2Cmath%2F0306054%2Cmath%2F0306205%2Cmath%2F0306039%2Cmath%2F0306225%2Cmath%2F0306078%2Cmath%2F0306014%2Cmath%2F0306201%2Cmath%2F0306199%2Cmath%2F0306190%2Cmath%2F0306127%2Cmath%2F0306301%2Cmath%2F0306329%2Cmath%2F0306412%2Cmath%2F0306410%2Cmath%2F0306347%2Cmath%2F0306423%2Cmath%2F0306131%2Cmath%2F0306015%2Cmath%2F0306105%2Cmath%2F0607457%2Cmath%2F0607106%2Cmath%2F0607101%2Cmath%2F0607123%2Cmath%2F0607527%2Cmath%2F0607224%2Cmath%2F0607495%2Cmath%2F0607105%2Cmath%2F0607576%2Cmath%2F0607531%2Cmath%2F0607370%2Cmath%2F0607526%2Cmath%2F0607614%2Cmath%2F0607063%2Cmath%2F0607281%2Cmath%2F0607136%2Cmath%2F0607417%2Cmath%2F0607730%2Cmath%2F0607331%2Cmath%2F0607567%2Cmath%2F0607382%2Cmath%2F0607739%2Cmath%2F0607114%2Cmath%2F0607227%2Cmath%2F0607388%2Cmath%2F0607578%2Cmath%2F0607438%2Cmath%2F0607467%2Cmath%2F0607252%2Cmath%2F0607535%2Cmath%2F0607024&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Leonard pairs and the q-Racah polynomials"}, "summary": "Let $K$ denote a field and let $V$ denote a vector space over $K$ with finite\npositive dimension. We consider an ordered pair of linear transformations\n$A:V\\to V$ and $A^*:V\\to V$ that satisfy conditions (i), (ii) below.\n  (i) There exists a basis for $V$ with respect to which the matrix\nrepresenting $A$ is irreducible tridiagonal and the matrix representing $A^*$\nis diagonal.\n  (ii) There exists a basis for $V$ with respect to which the matrix\nrepresenting $A$ is diagonal and the matrix representing $A^*$ is irreducible\ntridiagonal.\n  We call such a pair a {\\it Leonard pair} on $V$. We discuss a correspondence\nbetween Leonard pairs and a class of orthogonal polynomials consisting of the\n$q$-Racah polynomials and some related polynomials of the Askey scheme. For the\npolynomials in this class we obtain the 3-term recurrence, difference equation,\nAskey-Wilson duality, and orthogonality in a uniform manner using the\ncorresponding Leonard pair.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0306091%2Cmath%2F0306085%2Cmath%2F0306118%2Cmath%2F0306031%2Cmath%2F0306196%2Cmath%2F0306233%2Cmath%2F0306237%2Cmath%2F0306029%2Cmath%2F0306148%2Cmath%2F0306160%2Cmath%2F0306353%2Cmath%2F0306206%2Cmath%2F0306243%2Cmath%2F0306274%2Cmath%2F0306394%2Cmath%2F0306330%2Cmath%2F0306348%2Cmath%2F0306224%2Cmath%2F0306057%2Cmath%2F0306280%2Cmath%2F0306096%2Cmath%2F0306102%2Cmath%2F0306075%2Cmath%2F0306184%2Cmath%2F0306373%2Cmath%2F0306073%2Cmath%2F0306369%2Cmath%2F0306251%2Cmath%2F0306067%2Cmath%2F0306273%2Cmath%2F0306081%2Cmath%2F0306307%2Cmath%2F0306200%2Cmath%2F0306214%2Cmath%2F0306388%2Cmath%2F0306327%2Cmath%2F0306122%2Cmath%2F0306315%2Cmath%2F0306070%2Cmath%2F0306337%2Cmath%2F0306025%2Cmath%2F0306244%2Cmath%2F0306055%2Cmath%2F0306053%2Cmath%2F0306153%2Cmath%2F0306256%2Cmath%2F0306046%2Cmath%2F0306324%2Cmath%2F0306179%2Cmath%2F0306239%2Cmath%2F0306401%2Cmath%2F0306054%2Cmath%2F0306205%2Cmath%2F0306039%2Cmath%2F0306225%2Cmath%2F0306078%2Cmath%2F0306014%2Cmath%2F0306201%2Cmath%2F0306199%2Cmath%2F0306190%2Cmath%2F0306127%2Cmath%2F0306301%2Cmath%2F0306329%2Cmath%2F0306412%2Cmath%2F0306410%2Cmath%2F0306347%2Cmath%2F0306423%2Cmath%2F0306131%2Cmath%2F0306015%2Cmath%2F0306105%2Cmath%2F0607457%2Cmath%2F0607106%2Cmath%2F0607101%2Cmath%2F0607123%2Cmath%2F0607527%2Cmath%2F0607224%2Cmath%2F0607495%2Cmath%2F0607105%2Cmath%2F0607576%2Cmath%2F0607531%2Cmath%2F0607370%2Cmath%2F0607526%2Cmath%2F0607614%2Cmath%2F0607063%2Cmath%2F0607281%2Cmath%2F0607136%2Cmath%2F0607417%2Cmath%2F0607730%2Cmath%2F0607331%2Cmath%2F0607567%2Cmath%2F0607382%2Cmath%2F0607739%2Cmath%2F0607114%2Cmath%2F0607227%2Cmath%2F0607388%2Cmath%2F0607578%2Cmath%2F0607438%2Cmath%2F0607467%2Cmath%2F0607252%2Cmath%2F0607535%2Cmath%2F0607024&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let $K$ denote a field and let $V$ denote a vector space over $K$ with finite\npositive dimension. We consider an ordered pair of linear transformations\n$A:V\\to V$ and $A^*:V\\to V$ that satisfy conditions (i), (ii) below.\n  (i) There exists a basis for $V$ with respect to which the matrix\nrepresenting $A$ is irreducible tridiagonal and the matrix representing $A^*$\nis diagonal.\n  (ii) There exists a basis for $V$ with respect to which the matrix\nrepresenting $A$ is diagonal and the matrix representing $A^*$ is irreducible\ntridiagonal.\n  We call such a pair a {\\it Leonard pair} on $V$. We discuss a correspondence\nbetween Leonard pairs and a class of orthogonal polynomials consisting of the\n$q$-Racah polynomials and some related polynomials of the Askey scheme. For the\npolynomials in this class we obtain the 3-term recurrence, difference equation,\nAskey-Wilson duality, and orthogonality in a uniform manner using the\ncorresponding Leonard pair."}, "authors": ["Paul Terwilliger"], "author_detail": {"name": "Paul Terwilliger"}, "author": "Paul Terwilliger", "arxiv_comment": "44 pages. Revised version with organization adjusted", "links": [{"href": "http://arxiv.org/abs/math/0306301v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0306301v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.QA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.QA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.MP", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05E35; 05E30, 33C45,33D45", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0306301v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0306301v2", "journal_reference": null, "doi": null, "fulltext": "Leonard pairs and the q-Racah polynomials\u2217\n\narXiv:math/0306301v2 [math.QA] 24 Jul 2008\n\nPaul Terwilliger\n\nAbstract\nLet K denote a field, and let V denote a vector space over K with finite positive\ndimension. We consider a pair of linear transformations A : V \u2192 V and A\u2217 : V \u2192 V\nthat satisfy the following two conditions:\n(i) There exists a basis for V with respect to which the matrix representing A is\nirreducible tridiagonal and the matrix representing A\u2217 is diagonal.\n(ii) There exists a basis for V with respect to which the matrix representing A is\ndiagonal and the matrix representing A\u2217 is irreducible tridiagonal.\nWe call such a pair a Leonard pair on V . In the appendix to [9] we outlined a correspondence between Leonard pairs and a class of orthogonal polynomials consisting of\nthe q-Racah polynomials and some related polynomials of the Askey scheme. We also\noutlined how, for the polynomials in this class, the 3-term recurrence, difference equation, Askey-Wilson duality, and orthogonality can be obtained in a uniform manner\nfrom the corresponding Leonard pair. The purpose of this paper is to provide proofs\nfor the assertions which we made in that appendix.\n\n1\n\nLeonard pairs\n\nWe begin by recalling the notion of a Leonard pair [5], [9], [10], [11], [12], [13], [14], [15],\n[16]. We will use the following terms. Let X denote a square matrix. Then X is called\ntridiagonal whenever each nonzero entry lies on either the diagonal, the subdiagonal, or the\nsuperdiagonal. Assume X is tridiagonal. Then X is called irreducible whenever each entry\non the subdiagonal is nonzero and each entry on the superdiagonal is nonzero.\nWe now define a Leonard pair. For the rest of this paper K will denote a field.\nDefinition 1.1 [9] Let V denote a vector space over K with finite positive dimension. By\na Leonard pair on V , we mean an ordered pair of linear transformations A : V \u2192 V and\nA\u2217 : V \u2192 V that satisfy both (i), (ii) below.\n(i) There exists a basis for V with respect to which the matrix representing A is irreducible\ntridiagonal and the matrix representing A\u2217 is diagonal.\nKeywords. q-Racah polynomial, Leonard pair, Tridiagonal pair, Askey scheme, Askey-Wilson polynomials.\n2000 Mathematics Subject Classification. 05E30, 05E35, 33C45, 33D45.\n\u2217\n\n1\n\n\f(ii) There exists a basis for V with respect to which the matrix representing A is diagonal\nand the matrix representing A\u2217 is irreducible tridiagonal.\nNote 1.2 According to a common notational convention A\u2217 denotes the conjugate-transpose\nof A. We are not using this convention. In a Leonard pair A, A\u2217 , the linear transformations\nA and A\u2217 are arbitrary subject to (i), (ii) above.\n\n2\n\nAn example\n\nHere is an example of a Leonard\n\uf8eb\n0 3 0\n\uf8ec 1 0 2\nA=\uf8ec\n\uf8ed 0 2 0\n0 0 3\n\npair. Set V = K4 (column vectors), set\n\uf8f6\n\uf8eb\n\uf8f6\n3 0 0\n0\n0\n\uf8ec 0 1 0\n0 \uf8f7\n0 \uf8f7\n\uf8f7,\n\uf8f7,\nA\u2217 = \uf8ec\n\uf8ed\n\uf8f8\n0 0 \u22121 0 \uf8f8\n1\n0 0 0 \u22123\n0\n\nand view A and A\u2217 as linear transformations from V to V . We assume the characteristic\nof K is not 2 or 3, to ensure A is irreducible. Then A, A\u2217 is a Leonard pair on V . Indeed,\ncondition (i) in Definition 1.1 is satisfied by the basis for V consisting of the columns of the\n4 by 4 identity matrix. To verify condition (ii), we display an invertible matrix P such that\nP \u22121 AP is diagonal and P \u22121 A\u2217 P is irreducible tridiagonal. Set\n\uf8f6\n\uf8eb\n1 3\n3\n1\n\uf8ec 1 1 \u22121 \u22121 \uf8f7\n\uf8f7\nP =\uf8ec\n\uf8ed 1 \u22121 \u22121 1 \uf8f8 .\n1 \u22123 3 \u22121\nBy matrix multiplication P 2 = 8I, where I denotes the identity, so P \u22121 exists. Also by\nmatrix multiplication,\nAP = P A\u2217 .\n(1)\nApparently P \u22121 AP is equal to A\u2217 and is therefore diagonal. By (1) and since P \u22121 is a scalar\nmultiple of P , we find P \u22121 A\u2217 P is equal to A and is therefore irreducible tridiagonal. Now\ncondition (ii) of Definition 1.1 is satisfied by the basis for V consisting of the columns of P .\nThe above example\nnonnegative integer\n\uf8eb\n0\n\uf8ec 1\n\uf8ec\n\uf8ec\nA=\uf8ec\n\uf8ec\n\uf8ec\n\uf8ed\n0\n\nis a member of the following infinite family of Leonard pairs. For any\nd the pair\n\uf8f6\nd\n0\n\uf8f7\n0 d\u22121\n\uf8f7\n\uf8f7\n2\n*\n*\n\uf8f7,\nA\u2217 = diag(d, d \u2212 2, d \u2212 4, . . . , \u2212d)\n(2)\n\uf8f7\n*\n* *\n\uf8f7\n* * 1 \uf8f8\nd 0\n\n2\n\n\fis a Leonard pair on the vector space Kd+1 , provided the characteristic of K is zero or an\nodd prime greater than d. This can be proved by modifying the proof for d = 3 given above.\nOne shows P 2 = 2d I and AP = P A\u2217 , where P denotes the matrix with ij entry\n\u0013\n\u0012 \u0013 \u0012\n\u2212i, \u2212j\nd\n2\n(0 \u2264 i, j \u2264 d)\n(3)\nPij =\n2 F1\n\u2212d\nj\n[11, Section 16]. We follow the standard notation for hypergeometric series [4, p. 3].\n\n3\n\nLeonard systems\n\nWhen working with a Leonard pair, it is often convenient to consider a closely related and\nsomewhat more abstract object called a Leonard system. In order to define this we first make\nan observation about Leonard pairs.\nLemma 3.1 [9, Lemma 1.3] Let V denote a vector space over K with finite positive dimension and let A, A\u2217 denote a Leonard pair on V . Then the eigenvalues of A are mutually\ndistinct and contained in K. Moreover, the eigenvalues of A\u2217 are mutually distinct and\ncontained in K.\nTo prepare for our definition of a Leonard system, we recall a few concepts from linear algebra.\nLet d denote a nonnegative integer and let Matd+1 (K) denote the K-algebra consisting of\nall d + 1 by d + 1 matrices that have entries in K. We index the rows and columns by\n0, 1, . . . , d. We let Kd+1 denote the K-vector space consisting of all d + 1 by 1 matrices\nthat have entries in K. We index the rows by 0, 1, . . . , d. We view Kd+1 as a left module\nfor Matd+1 (K). We observe this module is irreducible. For the rest of this paper we let A\ndenote a K-algebra isomorphic to Matd+1 (K). When we refer to an A-module we mean a\nleft A-module. Let V denote an irreducible A-module. We remark that V is unique up to\nisomorphism of A-modules, and that V has dimension d + 1. Let v0 , v1 , . . . , vd denote a basis\nfor V . For X \u2208 AP\nand Y \u2208 Matd+1 (K), we say Y represents X with respect to v0 , v1 , . . . , vd\nwhenever Xvj = di=0 Yij vi for 0 \u2264 j \u2264 d. Let A denote an element of A. We say A is\nmultiplicity-free whenever it has d + 1 mutually distinct eigenvalues in K. Let A denote a\nmultiplicity-free element of A. Let \u03b80 , \u03b81 , . . . , \u03b8d denote an ordering of the eigenvalues of A,\nand for 0 \u2264 i \u2264 d put\nY A \u2212 \u03b8j I\nEi =\n,\n(4)\n\u03b8i \u2212 \u03b8j\n0\u2264j\u2264d\nj6=i\n\nwhere I denotes the identity of A. We observe (i) AEi = \u03b8i Ei (0 \u2264 i \u2264 d); (ii) Ei Ej =\nP\nP\n\u03b4ij Ei (0 \u2264 i, j \u2264 d); (iii) di=0 Ei = I; (iv) A = di=0 \u03b8i Ei . Let D denote the subalgebra\nof A generated by A. Using (i)\u2013(iv) we find the sequence E0 , E1 , . . . , Ed is a basis for the\nK-vector space D. We call Ei the primitive idempotent of A associated with \u03b8i . It is helpful\nto think of these primitive idempotents as follows. Observe\nV = E0 V + E1 V + * * * + Ed V\n3\n\n(direct sum).\n\n\fFor 0 \u2264 i \u2264 d, Ei V is the (one dimensional) eigenspace of A in V associated with the\neigenvalue \u03b8i , and Ei acts on V as the projection onto this eigenspace.\nWe remark that\nQ\n{Ai |0 \u2264 i \u2264 d} is a basis for the K-vector space D and that di=0 (A \u2212 \u03b8i I) = 0. By a\nLeonard pair in A we mean an ordered pair of elements taken from A that act on V as a\nLeonard pair in the sense of Definition 1.1. We call A the ambient algebra of the pair and\nsay the pair is over K. We refer to d as the diameter of the pair. We now define a Leonard\nsystem.\nDefinition 3.2 [9] By a Leonard system in A we mean a sequence \u03a6 := (A; A\u2217 ; {Ei }di=0 ;\n{Ei\u2217 }di=0 ) that satisfies (i)\u2013(v) below.\n(i) Each of A, A\u2217 is a multiplicity-free element in A.\n(ii) E0 , E1 , . . . , Ed is an ordering of the primitive idempotents of A.\n(iii) E0\u2217 , E1\u2217 , . . . , Ed\u2217 is an ordering of the primitive idempotents of A\u2217 .\n\u001a\n0,\nif |i \u2212 j| > 1;\n\u2217\n(iv) Ei A Ej =\n(0 \u2264 i, j \u2264 d).\n6= 0, if |i \u2212 j| = 1\n\u001a\n0,\nif |i \u2212 j| > 1;\n\u2217\n\u2217\n(v) Ei AEj =\n(0 \u2264 i, j \u2264 d).\n6= 0, if |i \u2212 j| = 1\nWe refer to d as the diameter of \u03a6 and say \u03a6 is over K. We call A the ambient algebra of\n\u03a6.\nWe comment on how Leonard pairs and Leonard systems are related. In the following discussion V denotes an irreducible A-module. Let (A; A\u2217 ; {Ei }di=0 ; {Ei\u2217 }di=0 ) denote a Leonard\nsystem in A. For 0 \u2264 i \u2264 d let vi denote a nonzero vector in Ei V . Then the sequence\nv0 , v1 , . . . , vd is a basis for V that satisfies Definition 1.1(ii). For 0 \u2264 i \u2264 d let vi\u2217 denote\na nonzero vector in Ei\u2217 V . Then the sequence v0\u2217 , v1\u2217, . . . , vd\u2217 is a basis for V which satisfies\nDefinition 1.1(i). By these comments the pair A, A\u2217 is a Leonard pair in A. Conversely let\nA, A\u2217 denote a Leonard pair in A. Then each of A, A\u2217 is multiplicity-free by Lemma 3.1.\nLet v0 , v1 , . . . , vd denote a basis for V that satisfies Definition 1.1(ii). For 0 \u2264 i \u2264 d the\nvector vi is an eigenvector for A; let Ei denote the corresponding primitive idempotent. Let\nv0\u2217 , v1\u2217 , . . . , vd\u2217 denote a basis for V that satisfies Definition 1.1(i). For 0 \u2264 i \u2264 d the vector\nvi\u2217 is an eigenvector for A\u2217 ; let Ei\u2217 denote the corresponding primitive idempotent. Then\n(A; A\u2217 ; {Ei }di=0 ; {Ei\u2217 }di=0 ) is a Leonard system in A. In summary we have the following.\nLemma 3.3 Let A and A\u2217 denote elements of A. Then the pair A, A\u2217 is a Leonard pair in\nA if and only if the following (i), (ii) hold.\n(i) Each of A, A\u2217 is multiplicity-free.\n(ii) There exists an ordering E0 , E1 , . . . , Ed of the primitive idempotents of A and there\nexists an ordering E0\u2217 , E1\u2217 , . . . , Ed\u2217 of the primitive idempotents of A\u2217 such that (A; A\u2217 ;\n{Ei }di=0 ; {Ei\u2217 }di=0 ) is a Leonard system in A.\n4\n\n\fWe recall the notion of isomorphism for Leonard pairs and Leonard systems.\nDefinition 3.4 Let A, A\u2217 and B, B \u2217 denote Leonard pairs over K. By an isomorphism\nof Leonard pairs from A, A\u2217 to B, B \u2217 we mean an isomorphism of K-algebras from the\nambient algebra of A, A\u2217 to the ambient algebra of B, B \u2217 that sends A to B and A\u2217 to\nB \u2217 . The Leonard pairs A, A\u2217 and B, B \u2217 are said to be isomorphic whenever there exists an\nisomorphism of Leonard pairs from A, A\u2217 to B, B \u2217 .\nLet \u03a6 denote the Leonard system from Definition 3.2 and let \u03c3 : A \u2192 A\u2032 denote an isomorphism of K-algebras. We write \u03a6\u03c3 := (A\u03c3 ; A\u2217\u03c3 ; {Ei\u03c3 }di=0 ; {Ei\u2217\u03c3 }di=0 ) and observe \u03a6\u03c3 is a\nLeonard system in A\u2032 .\nDefinition 3.5 Let \u03a6 and \u03a6\u2032 denote Leonard systems over K. By an isomorphism of\nLeonard systems from \u03a6 to \u03a6\u2032 we mean an isomorphism of K-algebras \u03c3 from the ambient algebra of \u03a6 to the ambient algebra of \u03a6\u2032 such that \u03a6\u03c3 = \u03a6\u2032 . The Leonard systems \u03a6,\n\u03a6\u2032 are said to be isomorphic whenever there exists an isomorphism of Leonard systems from\n\u03a6 to \u03a6\u2032 .\nWe have a remark. Let \u03c3 : A \u2192 A denote any map. By the Skolem-Noether theorem [8,\nCorollary 9.122], \u03c3 is an isomorphism of K-algebras if and only if there exists an invertible\nS \u2208 A such that X \u03c3 = SXS \u22121 for all X \u2208 A.\n\n4\n\nThe D4 action\n\nA given Leonard system can be modified in several ways to get a new Leonard system. For\ninstance, let \u03a6 denote the Leonard system from Definition 3.2. Then each of the following\nthree sequences is a Leonard system in A.\n\u03a6\u2217 := (A\u2217 ; A; {Ei\u2217 }di=0 ; {Ei }di=0 ),\n\u2217\n}di=0 ),\n\u03a6\u2193 := (A; A\u2217 ; {Ei }di=0 ; {Ed\u2212i\n\u03a6\u21d3 := (A; A\u2217 ; {Ed\u2212i }di=0 ; {Ei\u2217 }di=0 ).\nViewing \u2217, \u2193, \u21d3 as permutations on the set of all Leonard systems,\n\u21d3 \u2217 = \u2217 \u2193,\n\n\u22172 = \u21932 = \u21d32 = 1,\n\u2193 \u2217 = \u2217 \u21d3,\n\n\u2193\u21d3 = \u21d3\u2193 .\n\n(5)\n(6)\n\nThe group generated by symbols \u2217, \u2193, \u21d3 subject to the relations (5), (6) is the dihedral group\nD4 . We recall D4 is the group of symmetries of a square, and has 8 elements. Apparently\n\u2217, \u2193, \u21d3 induce an action of D4 on the set of all Leonard systems.\nFor the rest of this paper we will use the following notational convention.\nDefinition 4.1 Let \u03a6 denote a Leonard system. For any element g in the group D4 and\nfor any object f that we associate with \u03a6, we let f g denote the corresponding object for\n\u22121\nthe Leonard system \u03a6g . We have been using this convention all along; an example is\nEi\u2217 (\u03a6) = Ei (\u03a6\u2217 ).\n5\n\n\f5\n\nThe structure of a Leonard system\n\nIn this section we establish a few basic facts concerning Leonard systems. We begin with a\ndefinition and two routine lemmas.\nDefinition 5.1 Let \u03a6 denote the Leonard system from Definition 3.2. For 0 \u2264 i \u2264 d, we\nlet \u03b8i (resp. \u03b8i\u2217 ) denote the eigenvalue of A (resp. A\u2217 ) associated with Ei (resp. Ei\u2217 ). We\nrefer to \u03b80 , \u03b81 , . . . , \u03b8d as the eigenvalue sequence of \u03a6. We refer to \u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 as the dual\neigenvalue sequence of \u03a6. We observe \u03b80 , \u03b81 , . . . , \u03b8d are mutually distinct and contained in\nK. Similarly \u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 are mutually distinct and contained in K.\nLemma 5.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let V denote an\nirreducible A-module. For 0 \u2264 i \u2264 d let vi denote a nonzero vector in Ei\u2217 V and observe\nv0 , v1 , . . . , vd is a basis for V . Then (i), (ii) hold below.\n(i) For 0 \u2264 i \u2264 d the matrix in Matd+1 (K) that represents Ei\u2217 with respect to v0 , v1 , . . . , vd\nhas ii entry 1 and all other entries 0.\n(ii) The matrix in Matd+1 (K) that represents A\u2217 with respect to v0 , v1 , . . . , vd is equal to\ndiag(\u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 ).\nLemma 5.3 Let A denote an irreducible tridiagonal matrix in Matd+1 (K). Pick any integers\ni, j (0 \u2264 i, j \u2264 d). Then (i)\u2013(iii) hold below.\n(i) The entry (Ar )ij = 0 if r < |i \u2212 j|,\n\n(0 \u2264 r \u2264 d).\n\n(ii) Suppose i \u2264 j. Then the entry (Aj\u2212i )ij =\n(iii) Suppose i \u2265 j. Then the entry (Ai\u2212j )ij =\n\nQj\u22121\nh=i\n\nQi\u22121\n\nh=j\n\nAh,h+1. Moreover (Aj\u2212i )ij 6= 0.\nAh+1,h . Moreover (Ai\u2212j )ij 6= 0.\n\nTheorem 5.4 Let \u03a6 denote the Leonard system from Definition 3.2. Then the elements\nAr E0\u2217 As\n\n(0 \u2264 r, s \u2264 d)\n\n(7)\n\nform a basis for the K-vector space A.\nProof: The number of elements in (7) is equal to (d + 1)2 , and this number is the dimension\nof A. Therefore it suffices to show the elements in (7) are linearly independent. To do this,\nwe represent the elements in (7) by matrices. Let V denote an irreducible A-module. For\n0 \u2264 i \u2264 d let vi denote a nonzero vector in Ei\u2217 V , and observe v0 , v1 , . . . , vd is a basis for V .\nFor the purpose of this proof, let us identify each element of A with the matrix in Matd+1 (K)\nthat represents it with respect to the basis v0 , v1 , . . . , vd . Adopting this point of view we find\nA is irreducible tridiagonal and A\u2217 is diagonal. For 0 \u2264 r, s \u2264 d we show the entries of\nAr E0\u2217 As satisfy\n\u001a\n0,\nif i > r or j > s ;\nr \u2217 s\n(A E0 A )ij =\n(0 \u2264 i, j \u2264 d).\n(8)\n6= 0,\nif i = r and j = s\n6\n\n\fBy Lemma 5.2(i) the matrix E0\u2217 has 00 entry 1 and all other entries 0. Therefore\n(Ar E0\u2217 As )ij = (Ar )i0 (As )0j\n\n(0 \u2264 i, j \u2264 d).\n\n(9)\n\nWe mentioned A is irreducible tridiagonal. Applying Lemma 5.3 we find that for 0 \u2264 i \u2264 d\nthe entry (Ar )i0 is zero if i > r, and nonzero if i = r. Similarly for 0 \u2264 j \u2264 d the entry\n(As )0j is zero if j > s, and nonzero if j = s. Combining these facts with (9) we routinely\nobtain (8) and it follows the elements (7) are linearly independent. Apparently the elements\n(7) form a basis for A, as desired.\n\u0003\nCorollary 5.5 Let \u03a6 denote the Leonard system from Definition 3.2. Then the elements\nA, E0\u2217 together generate A. Moreover the elements A, A\u2217 together generate A.\nProof: The first assertion is immediate from Theorem 5.4. The second assertion follows from\nthe first assertion and the observation that E0\u2217 is a polynomial in A\u2217 .\n\u0003\nThe following is immediate from Corollary 5.5.\nCorollary 5.6 Let A, A\u2217 denote a Leonard pair in A. Then the elements A, A\u2217 together\ngenerate A.\nWe mention a few implications of Theorem 5.4 that will be useful later in the paper.\nLemma 5.7 Let \u03a6 denote the Leonard system from Definition 3.2. Let D denote the subalgebra of A generated by A. Let X0 , X1 , . . . , Xd denote a basis for the K-vector space D.\nThen the elements\nXr E0\u2217 Xs\n(0 \u2264 r, s \u2264 d)\n(10)\nform a basis for the K-vector space A.\nProof: The number of elements in (10) is equal to (d + 1)2 , and this number is the dimension\nof A. Therefore it suffices to show the elements (10) span A. But this is immediate from\nTheorem 5.4, and since each element in (7) is contained in the span of the elements (10). \u0003\nCorollary 5.8 Let \u03a6 denote the Leonard system from Definition 3.2. Then the elements\nEr E0\u2217 Es\n\n(0 \u2264 r, s \u2264 d)\n\n(11)\n\nform a basis for the K-vector space A.\nProof: Immediate from Lemma 5.7, with Xi = Ei for 0 \u2264 i \u2264 d.\n\n\u0003\n\nLemma 5.9 Let \u03a6 denote the Leonard system from Definition 3.2. Let D denote the subalgebra of A generated by A. Let X and Y denote elements in D and assume XE0\u2217 Y = 0.\nThen X = 0 or Y = 0.\n7\n\n\fProof: Let X0 , X1 , . . . , Xd denote a basis for the\nPd K-vector space D. Since X \u2208 D there\nexists \u03b1i \u2208 K (0 \u2264 i \u2264 d) such that X =\ni=0 \u03b1i Xi . Similarly there exists \u03b2i \u2208 K\nPd\n(0 \u2264 i \u2264 d) such that Y = i=0 \u03b2i Xi . Evaluating 0 = XE0\u2217 Y using these equations we get\nP P\n0 = di=0 dj=0 \u03b1i \u03b2j Xi E0\u2217 Xj . From this and Lemma 5.7 we find \u03b1i \u03b2j = 0 for 0 \u2264 i, j \u2264 d.\nWe assume X 6= 0 and show Y = 0. Since X 6= 0 there exists an integer i (0 \u2264 i \u2264 d) such\nthat \u03b1i 6= 0. Now for 0 \u2264 j \u2264 d we have \u03b1i \u03b2j = 0 so \u03b2j = 0. It follows Y = 0.\n\u0003\nWe finish this section with a comment.\nLemma 5.10 Let \u03a6 denote the Leonard system from Definition 3.2. Pick any integers i, j\n(0 \u2264 i, j \u2264 d). Then (i)\u2013(iv) hold below.\n(i) Ei\u2217 Ar Ej\u2217 = 0\n\nif\n\nr < |i \u2212 j|,\n\n(0 \u2264 r \u2264 d).\n\n(ii) Suppose i \u2264 j. Then\n\u2217\n\u2217\nEi\u2217 Aj\u2212i Ej\u2217 = Ei\u2217 AEi+1\nA * * * Ej\u22121\nAEj\u2217 .\n\n(12)\n\nMoreover Ei\u2217 Aj\u2212i Ej\u2217 6= 0.\n(iii) Suppose i \u2265 j. Then\n\u2217\n\u2217\nEi\u2217 Ai\u2212j Ej\u2217 = Ei\u2217 AEi\u22121\nA * * * Ej+1\nAEj\u2217 .\n\n(13)\n\nMoroever Ei\u2217 Ai\u2212j Ej\u2217 6= 0.\n(iv) Abbreviate r = |i \u2212 j|. Then Ei\u2217 Ar Ej\u2217 is a basis for the K-vector space Ei\u2217 AEj\u2217 .\nProof: Represent the elements of \u03a6 by matrices as in the proof of Theorem 5.4, and use\nLemma 5.3.\n\u0003\n\n6\n\nThe antiautomorphism \u2020\n\nWe recall the notion of an antiautomorphism of A. Let \u03b3 : A \u2192 A denote any map. We\ncall \u03b3 an antiautomorphism of A whenever \u03b3 is an isomorphism of K-vector spaces and\n(XY )\u03b3 = Y \u03b3 X \u03b3 for all X, Y \u2208 A. For example assume A = Matd+1 (K). Then \u03b3 is an\nantiautomorphism of A if and only if there exists an invertible element R in A such that\nX \u03b3 = R\u22121 X t R for all X \u2208 A, where t denotes transpose. This follows from the SkolemNoether theorem [8, Corollary 9.122].\nTheorem 6.1 Let A, A\u2217 denote a Leonard pair in A. Then there exists a unique antiautomorphism \u2020 of A such that A\u2020 = A and A\u2217\u2020 = A\u2217 . Moreover X \u2020\u2020 = X for all X \u2208 A.\n\n8\n\n\fProof: Concerning existence, let V denote an irreducible A-module. By Definition 1.1(i)\nthere exists a basis for V with respect to which the matrix representing A is irreducible tridiagonal and the matrix representing A\u2217 is diagonal. Let us denote this basis by v0 , v1 , . . . , vd .\nFor X \u2208 A let X \u03c3 denote the matrix in Matd+1 (K) that represents X with respect to the\nbasis v0 , v1 , . . . , vd . We observe \u03c3 : A \u2192 Matd+1 (K) is an isomorphism of K-algebras. We\nabbreviate B = A\u03c3 and observe B is irreducible tridiagonal. We abbreviate B \u2217 = A\u2217\u03c3 and\nobserve B \u2217 is diagonal. Let D denote the diagonal matrix in Matd+1 (K) that has ii entry\nDii =\n\nB01 B12 * * * Bi\u22121,i\nB10 B21 * * * Bi,i\u22121\n\n(0 \u2264 i \u2264 d).\n\nIt is routine to verify D \u22121 B t D = B. Each of D, B \u2217 is diagonal so DB \u2217 = B \u2217 D; also\nB \u2217t = B \u2217 so D \u22121 B \u2217t D = B \u2217 . Let \u03b3 : Matd+1 (K) \u2192 Matd+1 (K) denote the map that satisfies\nX \u03b3 = D \u22121 X t D for all X \u2208 Matd+1 (K). We observe \u03b3 is an antiautomorphism of Matd+1 (K)\nsuch that B \u03b3 = B and B \u2217\u03b3 = B \u2217 . We define the map \u2020 : A \u2192 A to be the composition\n\u2020 = \u03c3\u03b3\u03c3 \u22121 . We observe \u2020 is an antiautomorphism of A such that A\u2020 = A and A\u2217\u2020 = A\u2217 . We\nhave now shown there exists an antiautomorphism \u2020 of A such that A\u2020 = A and A\u2217\u2020 = A\u2217 .\nThis antiautomorphism is unique since A, A\u2217 together generate A. The map X \u2192 X \u2020\u2020 is an\nisomorphism of K-algebras from A to itself. This isomorphism is the identity since A\u2020\u2020 = A,\nA\u2217\u2020\u2020 = A\u2217 , and since A, A\u2217 together generate A.\n\u0003\nDefinition 6.2 Let A, A\u2217 denote a Leonard pair in A. By the antiautomorphism which corresponds to A, A\u2217 we mean the map \u2020 : A \u2192 A from Theorem 6.1. Let \u03a6 = (A; A\u2217 ; {Ei }di=0 ;\n{Ei\u2217 }di=0 ) denote a Leonard system in A. By the antiautomorphism which corresponds to \u03a6\nwe mean the antiautomorphism which corresponds to the Leonard pair A, A\u2217 .\nLemma 6.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let \u2020 denote the\ncorresponding antiautomorphism. Then the following (i), (ii) hold.\n(i) Let D denote the subalgebra of A generated by A. Then X \u2020 = X for all X \u2208 D; in\nparticular Ei\u2020 = Ei for 0 \u2264 i \u2264 d.\n(ii) Let D \u2217 denote the subalgebra of A generated by A\u2217 . Then X \u2020 = X for all X \u2208 D \u2217 ; in\nparticular Ei\u2217\u2020 = Ei\u2217 for 0 \u2264 i \u2264 d.\nProof: (i) The sequence Ai (0 \u2264 i \u2264 d) is a basis for the K-vector space D. Observe \u2020\nstabilizes Ai for 0 \u2264 i \u2264 d. The result follows.\n(ii) Similar to the proof of (i) above.\n\u0003\n\n7\n\nThe scalars ai, xi\n\nIn this section we introduce some scalars that will help us describe Leonard systems.\n\n9\n\n\fDefinition 7.1 Let \u03a6 denote the Leonard system from Definition 3.2. We define\nai = tr(Ei\u2217 A)\n(0 \u2264 i \u2264 d),\n\u2217\n\u2217\nxi = tr(Ei AEi\u22121 A)\n(1 \u2264 i \u2264 d),\n\n(14)\n(15)\n\nwhere tr denotes trace. For notational convenience we define x0 = 0.\nWe have a comment.\nLemma 7.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let V denote an\nirreducible A-module. For 0 \u2264 i \u2264 d let vi denote a nonzero vector in Ei\u2217 V and observe\nv0 , v1 , . . . , vd is a basis for V . Let B denote the matrix in Matd+1 (K) that represents A with\nrespect to v0 , v1 , . . . , vd . We observe B is irreducible tridiagonal. The following (i)\u2013(iii) hold.\n(i) Bii = ai (0 \u2264 i \u2264 d).\n(ii) Bi,i\u22121 Bi\u22121,i = xi (1 \u2264 i \u2264 d).\n(iii) xi 6= 0 (1 \u2264 i \u2264 d).\nProof: (i), (ii) For 0 \u2264 i \u2264 d the matrix in Matd+1 (K) that represents Ei\u2217 with respect to\nv0 , v1 , . . . , vd has ii entry 1 and all other entries 0. The result follows in view of Definition\n7.1.\n(iii) Immediate from (ii) and since B is irreducible.\n\u0003\nTheorem 7.3 Let \u03a6 denote the Leonard system from Definition 3.2. Let V denote an\nirreducible A-module and let v denote a nonzero vector in E0\u2217 V . Then for 0 \u2264 i \u2264 d the\nvector Ei\u2217 Ai v is nonzero and hence a basis for Ei\u2217 V . Moreover the sequence\nEi\u2217 Ai v\n\n(0 \u2264 i \u2264 d)\n\n(16)\n\nis a basis for V .\nProof: We show Ei\u2217 Ai v 6= 0 for 0 \u2264 i \u2264 d. Let i be given. Setting j = 0 in Lemma 5.10(iii)\nwe find Ei\u2217 Ai E0\u2217 6= 0. Therefore Ei\u2217 Ai E0\u2217 V 6= 0. The space E0\u2217 V is spanned by v so Ei\u2217 Ai v 6= 0\nas desired. The remaining claims follow.\n\u0003\nTheorem 7.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars ai , xi\nbe as in Definition 7.1. Let V denote an irreducible A-module. With respect to the basis for\nV given in (16) the matrix that represents A is equal to\n\uf8f6\n\uf8eb\na0 x1\n0\n\uf8f7\n\uf8ec 1 a1 x2\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n1 * *\n\uf8f7.\n\uf8ec\n(17)\n\uf8f7\n\uf8ec\n*\n*\n*\n\uf8f7\n\uf8ec\n\uf8ed\n* * xd \uf8f8\n0\n1 ad\n10\n\n\fProof: With reference to (16) abbreviate vi = Ei\u2217 Ai v for 0 \u2264 i \u2264 d. Let B denote the\nmatrix in Matd+1 (K) that represents A with respect to v0 , v1 , . . . , vd . We show B is equal\nto (17). In view of Lemma 7.2 it suffices to show Bi,i\u22121 = 1 for 1 \u2264 i \u2264 d. For 0 \u2264 i \u2264 d\nP\nthe matrix B i represents Ai with respect to v0 , v1 , . . . , vd ; therefore Ai v0 = dj=0(B i )j0 vj .\nApplying Ei\u2217 and using v0 = v we find vi = (B i )i0 vi so (B i )i0 = 1. By Lemma 5.3 we have\n(B i )i0 = Bi,i\u22121 * * * B21 B10 so Bi,i\u22121 * * * B21 B10 = 1. We now have Bi,i\u22121 * * * B21 B10 = 1 for\n1 \u2264 i \u2264 d so Bi,i\u22121 = 1 for 1 \u2264 i \u2264 d. We now see B is equal to (17).\n\u0003\nLemma 7.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars ai , xi\nbe as in Definition 7.1. Then the following (i)\u2013(iii) hold.\n(i) Ei\u2217 AEi\u2217 = ai Ei\u2217\n\n(0 \u2264 i \u2264 d).\n\n\u2217\n(ii) Ei\u2217 AEi\u22121\nAEi\u2217 = xi Ei\u2217\n\n(1 \u2264 i \u2264 d).\n\n\u2217\n\u2217\n\u2217\n(iii) Ei\u22121\nAEi\u2217 AEi\u22121\n= xi Ei\u22121\n\n(1 \u2264 i \u2264 d).\n\nProof: (i) Setting i = j and r = 0 in Lemma 5.10(iv) we find Ei\u2217 is a basis for Ei\u2217 AEi\u2217 .\nBy this and since Ei\u2217 AEi\u2217 is contained in Ei\u2217 AEi\u2217 we find there exists \u03b1i \u2208 K such that\nEi\u2217 AEi\u2217 = \u03b1i Ei\u2217 . Taking the trace of both sides and using tr(XY ) = tr(Y X), tr(Ei\u2217 ) = 1 we\nfind ai = \u03b1i .\n\u2217\n(ii) We mentioned above that Ei\u2217 is a basis for Ei\u2217 AEi\u2217 . By this and since Ei\u2217 AEi\u22121\nAEi\u2217 is\n\u2217\ncontained in Ei\u2217 AEi\u2217 we find there exists \u03b2i \u2208 K such that Ei\u2217 AEi\u22121\nAEi\u2217 = \u03b2i Ei\u2217 . Taking the\ntrace of both sides we find xi = \u03b2i .\n(iii) Similar to the proof of (ii) above.\n\u0003\nLemma 7.6 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars xi be\nas in Definition 7.1. Then the following (i), (ii) hold.\n(i) Ej\u2217 Aj\u2212i Ei\u2217 Aj\u2212i Ej\u2217 = xi+1 xi+2 * * * xj Ej\u2217\n\n(0 \u2264 i \u2264 j \u2264 d).\n\n(ii) Ei\u2217 Aj\u2212i Ej\u2217 Aj\u2212i Ei\u2217 = xi+1 xi+2 * * * xj Ei\u2217\n\n(0 \u2264 i \u2264 j \u2264 d).\n\nProof: (i) Evaluate the expression on the left using Lemma 5.10(ii), (iii) and Lemma 7.5(ii).\n(ii) Evaluate the expression on the left using Lemma 5.10(ii), (iii) and Lemma 7.5(iii). \u0003\n\n8\n\nThe polynomials pi\n\nIn this section we begin our discussion of polynomials. We will use the following notation. Let\n\u03bb denote an indeterminate. We let K[\u03bb] denote the K-algebra consisting of all polynomials\nin \u03bb that have coefficients in K. For the rest of this paper all polynomials that we discuss\nare assumed to lie in K[\u03bb].\n11\n\n\fDefinition 8.1 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars\nai , xi be as in Definition 7.1. We define a sequence of polynomials p0 , p1 , . . . , pd+1 by\np0 = 1,\n\u03bbpi = pi+1 + ai pi + xi pi\u22121\n\n(0 \u2264 i \u2264 d),\n\n(18)\n(19)\n\nwhere p\u22121 = 0. We observe pi is monic with degree exactly i for 0 \u2264 i \u2264 d + 1.\nLemma 8.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Let V denote an irreducible A-module and let v denote a nonzero\nvector in E0\u2217 V . Then pi (A)v = Ei\u2217 Ai v for 0 \u2264 i \u2264 d and pd+1 (A)v = 0.\nProof: We abbreviate vi = pi (A)v for 0 \u2264 i \u2264 d + 1. We define vi\u2032 = Ei\u2217 Ai v for 0 \u2264 i \u2264 d\n\u2032\nand vd+1\n= 0. We show vi = vi\u2032 for 0 \u2264 i \u2264 d + 1. From the construction v0 = v and v0\u2032 = v\n\u2032\nso v0 = v0 . From (19) we obtain\nAvi = vi+1 + ai vi + xi vi\u22121\n\n(0 \u2264 i \u2264 d)\n\n(20)\n\n(0 \u2264 i \u2264 d)\n\n(21)\n\nwhere v\u22121 = 0. From Theorem 7.4 we find\n\u2032\n\u2032\nAvi\u2032 = vi+1\n+ ai vi\u2032 + xi vi\u22121\n\n\u2032\n= 0. Comparing (20), (21) and using v0 = v0\u2032 we find vi = vi\u2032 for 0 \u2264 i \u2264 d + 1.\nwhere v\u22121\nThe result follows.\n\u0003\n\nWe mention a few consequences of Lemma 8.2.\nTheorem 8.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Let V denote an irreducible A-module. Then\npi (A)E0\u2217 V = Ei\u2217 V\n\n(0 \u2264 i \u2264 d).\n\nProof: Let v denote a nonzero vector in E0\u2217 V . Then pi (A)v = Ei\u2217 Ai v by Lemma 8.2. Observe\nv is a basis for E0\u2217 V . By Theorem 7.3 we find Ei\u2217 Ai v is a basis for Ei\u2217 V . Combining these\nfacts we find pi (A)E0\u2217 V = Ei\u2217 V .\n\u0003\nTheorem 8.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Then\npi (A)E0\u2217 = Ei\u2217 Ai E0\u2217\n\n(0 \u2264 i \u2264 d).\n\n(22)\n\nProof: Let the integer i be given and abbreviate \u2206 = pi (A) \u2212 Ei\u2217 Ai . We show \u2206E0\u2217 = 0.\nIn order to do this we show \u2206E0\u2217 V = 0, where V denotes an irreducible A-module. Let v\ndenote a nonzero vector in E0\u2217 V and recall v is a basis for E0\u2217 V . By Lemma 8.2 we have\n\u2206v = 0 so \u2206E0\u2217 V = 0. Now \u2206E0\u2217 = 0 so pi (A)E0\u2217 = Ei\u2217 Ai E0\u2217 .\n\u0003\n\n12\n\n\fTheorem 8.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomial\npd+1 be as in Definition 8.1. Then the following (i), (ii) hold.\n(i) pd+1 is both the minimal polynomial and the characteristic polynomial of A.\nQ\n(ii) pd+1 = di=0 (\u03bb \u2212 \u03b8i ).\n\nProof: (i) We first show pd+1 is equal to the minimal polynomial of A. Recall I, A, . . . , Ad\nare linearly independent and that pd+1 is monic with degree d + 1. We show pd+1 (A) = 0.\nLet V denote an irreducible A-module. Let v denote a nonzero vector in E0\u2217 V and recall v\nis a basis for E0\u2217 V . From Lemma 8.2 we find pd+1 (A)v = 0. It follows pd+1 (A)E0\u2217 V = 0 so\npd+1 (A)E0\u2217 = 0. Applying Lemma 5.9 (with X = pd+1 (A) and Y = I) we find pd+1 (A) = 0.\nWe have now shown pd+1 is the minimal polynomial of A. By definition the characteristic\npolynomial of A is equal to det(\u03bbI \u2212 A). This polynomial is monic with degree d + 1 and\nhas pd+1 as a factor; therefore it is equal to pd+1 .\n(ii) For 0 \u2264 i \u2264 d the scalar \u03b8i is an eigenvalue of A and therefore a root of the characteristic\npolynomial of A.\n\u0003\nTheorem 8.6 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Let the scalars xi be as in Definition 7.1. Then\nEi\u2217\n\npi (A)E0\u2217 pi (A)\n=\nx1 x2 * * * xi\n\n(0 \u2264 i \u2264 d).\n\n(23)\n\nProof: Let \u2020 : A \u2192 A denote the antiautomorphism which corresponds to \u03a6. From Theorem\n8.4 we have pi (A)E0\u2217 = Ei\u2217 Ai E0\u2217 . Applying \u2020 we find E0\u2217 pi (A) = E0\u2217 Ai Ei\u2217 . From these\ncomments we find\npi (A)E0\u2217 pi (A) = Ei\u2217 Ai E0\u2217 Ai Ei\u2217\n= x1 x2 * * * xi Ei\u2217\nin view of Lemma 7.6(i). The result follows.\n\n\u0003\n\nWe finish this section with a comment.\nLemma 8.7 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Let the scalars\nPi ai be as in Definition 7.1. Then for 0 \u2264 i \u2264 d the\ni\ncoefficient of \u03bb in pi+1 is equal to \u2212 j=0 aj .\n\nProof: Let \u03b1i denote the coefficient of \u03bbi in pi+1 . Computing the coefficient\nof \u03bbi in (19) we\nPi\nfind \u03b1i\u22121 = \u03b1i + ai for 0 \u2264 i \u2264 d, where \u03b1\u22121 = 0. It follows \u03b1i = \u2212 j=0 aj for 0 \u2264 i \u2264 d. \u0003\n\n13\n\n\f9\n\nThe scalars \u03bd, mi\n\nIn this section we introduce some more scalars that will help us describe Leonard systems.\nDefinition 9.1 Let \u03a6 denote the Leonard system from Definition 3.2. We define\nmi = tr(Ei E0\u2217 )\n\n(0 \u2264 i \u2264 d).\n\n(24)\n\nLemma 9.2 Let \u03a6 denote the Leonard system from Definition 3.2. Then (i)\u2013(v) hold below.\n(i) Ei E0\u2217 Ei = mi Ei\n(ii) E0\u2217 Ei E0\u2217 = mi E0\u2217\n\n(0 \u2264 i \u2264 d).\n(0 \u2264 i \u2264 d).\n\n(iii) mi 6= 0\n(0 \u2264 i \u2264 d).\nPd\n(iv)\ni=0 mi = 1.\n(v) m0 = m\u22170 .\n\nProof: (i) Observe Ei is a basis for Ei AEi . By this and since Ei E0\u2217 Ei is contained in Ei AEi ,\nthere exists \u03b1i \u2208 K such that Ei E0\u2217 Ei = \u03b1i Ei . Taking the trace of both sides in this equation\nand using tr(XY ) = tr(Y X), tr(Ei ) = 1 we find \u03b1i = mi .\n(ii) Similar to the proof of (i).\n(iii) Observe mi Ei is equal to Ei E0\u2217 Ei by part (i) above and Ei E0\u2217 Ei is nonzero by Corollary\n5.8. It follows mi Ei 6= 0 so mi 6= 0.\nP\n(iv) Multiply each term in the equation di=0 Ei = I on the right by E0\u2217 , and then take the\ntrace. Evaluate the result using Definition 9.1.\n\u0003\n(v) The elements E0 E0\u2217 and E0\u2217 E0 have the same trace.\nDefinition 9.3 Let \u03a6 denote the Leonard system from Definition 3.2. Recall m0 = m\u22170 by\nLemma 9.2(v); we let \u03bd denote the multiplicative inverse of this common value. We observe\n\u03bd = \u03bd \u2217 . We emphasize\ntr(E0 E0\u2217 ) = \u03bd \u22121 .\n(25)\nLemma 9.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalar \u03bd be as\nin Definition 9.3. Then the following (i), (ii) hold.\n(i) \u03bdE0 E0\u2217 E0 = E0 .\n(ii) \u03bdE0\u2217 E0 E0\u2217 = E0\u2217 .\nProof: (i) Set i = 0 in Lemma 9.2(i) and recall m0 = \u03bd \u22121 .\n(ii) Set i = 0 in Lemma 9.2(ii) and recall m0 = \u03bd \u22121 .\n\n14\n\n\u0003\n\n\fTheorem 9.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Let the scalars \u03b8i be as in Definition 5.1 and let the scalars mi be\nas in Definition 9.1. Then\n\u2217 i \u2217\npi (\u03b8j ) = m\u22121\nj tr(Ej Ei A E0 )\n\n(0 \u2264 i, j \u2264 d).\n\n(26)\n\nProof: Using Theorem 8.4 we find\ntr(Ej Ei\u2217 Ai E0\u2217 ) = tr(Ej pi (A)E0\u2217 )\n= pi (\u03b8j )tr(Ej E0\u2217 )\n= pi (\u03b8j )mj .\nThe result follows.\n\n10\n\n\u0003\n\nThe standard basis\n\nIn this section we discuss the notion of a standard basis. We begin with a comment.\nLemma 10.1 Let \u03a6 denote the Leonard system from Definition 3.2 and let V denote an\nirreducible A-module. Then\nEi\u2217 V = Ei\u2217 E0 V\n\n(0 \u2264 i \u2264 d).\n\n(27)\n\nProof: The space Ei\u2217 V has dimension 1 and contains Ei\u2217 E0 V . We show Ei\u2217 E0 V 6= 0. Applying\nCorollary 5.8 to \u03a6\u2217 we find Ei\u2217 E0 6= 0. It follows Ei\u2217 E0 V 6= 0. We conclude Ei\u2217 V = Ei\u2217 E0 V . \u0003\nLemma 10.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let V denote an\nirreducible A-module. Let u denote a nonzero vector in E0 V . Then for 0 \u2264 i \u2264 d the vector\nEi\u2217 u is nonzero and hence a basis for Ei\u2217 V . Moreover the sequence\nE0\u2217 u, E1\u2217 u, . . . , Ed\u2217 u\n\n(28)\n\nis a basis for V .\nProof: Let the integer i be given. We show Ei\u2217 u 6= 0. Recall E0 V has dimension 1 and u is a\nnonzero vector in E0 V so u spans E0 V . Applying Ei\u2217 we find Ei\u2217 u spans Ei\u2217 E0 V . The space\nEi\u2217 E0 V is nonzero by Lemma 10.1 so Ei\u2217 u is nonzero. The remaining assertions are clear. \u0003\nDefinition 10.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let V denote an\nirreducible A-module. By a \u03a6-standard basis for V , we mean a sequence\nE0\u2217 u, E1\u2217 u, . . . , Ed\u2217 u,\nwhere u is a nonzero vector in E0 V .\n15\n\n\fWe give a few characterizations of the standard basis.\nLemma 10.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let V denote an\nirreducible A-module. Let v0 , v1 , . . . , vd denote a sequence of vectors in V , not all 0. Then\nthis sequence is a \u03a6-standard basis for V if and only if both (i), (ii) hold below.\n(i) vi \u2208 Ei\u2217 V for 0 \u2264 i \u2264 d.\nPd\n(ii)\ni=0 vi \u2208 E0 V .\n\nProof: To prove the lemma in one direction, assume v0 , v1 , . . . , vd is a \u03a6-standard basis for\nV . By Definition 10.3 there exists a nonzero u \u2208 E0 V such that vi = Ei\u2217 u for 0 \u2264 i \u2264 d.\n\u2217\nApparently vi \u2208\ndenote the identity element of A\ni V for 0 \u2264 i \u2264 d so (i) holds. Let I P\nPE\nd\nand recall I = i=0 Ei\u2217 . Applying this to u we find u = di=0 vi and (ii) follows. We have\nnow proved the lemma in one direction. To prove the\nP lemma in the other direction, assume\nv0 , v1 , . . . , vd satisfy (i), (ii) above. We define u = di=0 vi and observe u \u2208 E0 V . Using (i)\nwe find Ei\u2217 vj = \u03b4ij vj for 0 \u2264 i, j \u2264 d; it follows vi = Ei\u2217 u for 0 \u2264 i \u2264 d. Observe u 6= 0\nsince at least one of v0 , v1 , . . . , vd is nonzero. Now v0 , v1 , . . . , vd is a \u03a6-standard basis for V\nby Definition 10.3.\n\u0003\nWe recall some notation. Let d denote a nonnegative integer and let B denote a matrix in\nMatd+1 (K). Let \u03b1 denote a scalar in K. Then B is said to have constant row sum \u03b1 whenever\nBi0 + Bi1 + * * * + Bid = \u03b1 for 0 \u2264 i \u2264 d.\nLemma 10.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars \u03b8i , \u03b8i\u2217\nbe as in Definition 5.1. Let V denote an irreducible A-module and let v0 , v1 , . . . , vd denote a\nbasis for V . Let B (resp. B \u2217 ) denote the matrix in Matd+1 (K) that represents A (resp. A\u2217 )\nwith respect to this basis. Then v0 , v1 , . . . , vd is a \u03a6-standard basis for V if and only if both\n(i), (ii) hold below.\n(i) B has constant row sum \u03b80 .\n(ii) B \u2217 = diag(\u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 ).\nP\nP\nProof: Observe A dj=0 vj = di=0 vi (Bi0 + Bi1 + * * * Bid ). Recall E0 V is the eigenspace for\nP\nA and eigenvalue \u03b80 . Apparently B has constant row sum \u03b80 if and only if di=0 vi \u2208 E0 V .\nRecall that for 0 \u2264 i \u2264 d, Ei\u2217 V is the eigenspace for A\u2217 and eigenvalue \u03b8i\u2217 . Apparently\nB \u2217 = diag(\u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 ) if and only if vi \u2208 Ei\u2217 V for 0 \u2264 i \u2264 d. The result follows in view of\nLemma 10.4.\n\u0003\nDefinition 10.6 Let \u03a6 denote the Leonard system from Definition 3.2. We define a map\n\u266d : A \u2192 Matd+1 (K) as follows. Let V denote an irreducible A-module. For all X \u2208 A we let\nX \u266d denote the matrix in Matd+1 (K) that represents X with respect to a \u03a6-standard basis\nfor V . We observe \u266d : A \u2192 Matd+1 (K) is an isomorphism of K-algebras.\n\n16\n\n\fLemma 10.7 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars \u03b8i , \u03b8i\u2217\nbe as in Definition 5.1. Let the map \u266d : A \u2192 Matd+1 (K) be as in Definition 10.6. Then\n(i)\u2013(iii) hold below.\n(i) A\u266d has constant row sum \u03b80 .\n(ii) A\u2217\u266d = diag(\u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 ).\n(iii) For 0 \u2264 i \u2264 d the matrix Ei\u2217\u266d has ii entry 1 and all other entries 0.\nProof: (i), (ii) Combine Lemma 10.5 and Definition 10.6.\n(iii) Immediate from Lemma 5.2(i).\n\n\u0003\n\nLet \u03a6 denote the Leonard system from Definition 3.2 and let the map \u266d : A \u2192 Matd+1 (K)\nbe as in Definition 10.6. Let X denote an element of A. In Theorem 10.9 below we give the\nentries of X \u266d in terms of the trace function. To prepare for this we need a lemma.\nLemma 10.8 Let \u03a6 denote the Leonard system from Definition 3.2 and let the map \u266d : A \u2192\nMatd+1 (K) be as in Definition 10.6. Then for X \u2208 A the entries of X \u266d satisfy\nEi\u2217 XEj\u2217 E0 = (X \u266d )ij Ei\u2217 E0\n\n(0 \u2264 i, j \u2264 d).\n\n(29)\n\nProof: Let the integers i, j be given and abbreviate \u2206 = Ei\u2217 XEj\u2217 \u2212 (X \u266d )ij Ei\u2217 . We show\n\u2206E0 = 0. In order to do this we show \u2206E0 V = 0, where V denotes an irreducible A-module.\nLet u denote a nonzero vector in E0 V . By Definition 10.3 the sequence E0\u2217 u, E1\u2217 u, . . . , Ed\u2217 u\nis a \u03a6-standard basis for V . Recall X \u266d is the matrix in Mat\nPd+1 (K) that represents X with\nrespect to this basis. Applying X to Ej\u2217 u we find XEj\u2217 u = dr=0 (X \u266d )rj Er\u2217 u. Applying Ei\u2217 we\nobtain Ei\u2217 XEj\u2217 u = (X \u266d )ij Ei\u2217 u. By this and since u spans E0 V we find \u2206E0 V = 0. Therefore\n\u2206E0 = 0 and the result follows.\n\u0003\nTheorem 10.9 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars m\u2217i\nbe as in Definition 9.1. Let the map \u266d : A \u2192 Matd+1 (K) be as in Definition 10.6. Then for\nX \u2208 A the entries of X \u266d are given as follows.\n(X \u266d )ij = m\u2217\u22121\ntr(Ei\u2217 XEj\u2217 E0 )\ni\n\n(0 \u2264 i, j \u2264 d).\n\n(30)\n\nProof: In equation (29), take the trace of both sides and observe m\u2217i = tr(Ei\u2217 E0 ) in view of\nDefinition 9.1.\n\u0003\nReferring to Theorem 10.9 we consider the case X = E0 .\nLemma 10.10 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars m\u2217i\nbe as in Definition 9.1. Let the map \u266d : A \u2192 Matd+1 (K) be as in Definition 10.6. Then for\n0 \u2264 i, j \u2264 d the ij entry of E0\u266d is m\u2217j .\nProof: Set X = E0 in (30). Simplify the result using E0 Ej\u2217 E0 = m\u2217j E0 and m\u2217i = tr(Ei\u2217 E0 ). \u0003\n\n17\n\n\fTheorem 10.11 Let \u03a6 denote the Leonard system from Definition 3.2, and let the map\n\u266d : A \u2192 Matd+1 (K) be as in Definition 10.6. For 0 \u2264 i, j \u2264 d define \u03a8ij = m\u2217\u22121\nEi\u2217 E0 Ej\u2217 ,\nj\nwhere m\u2217j is from Definition 9.1. Then the matrix \u03a8\u266dij has ij entry 1 and all other entries 0.\nProof: Immediate from Lemma 10.7(iii), Lemma 10.10, and since \u266d is an isomorphism of\nK-algebras.\n\u0003\n\n11\n\nThe scalars bi, ci\n\nIn this section we consider some scalars that arise naturally in the context of the standard\nbasis.\nDefinition 11.1 Let \u03a6 denote the Leonard system from Definition 3.2 and let the map\n\u266d : A \u2192 Matd+1 (K) be as in Definition 10.6. For 0 \u2264 i \u2264 d \u2212 1 we let bi denote the i, i + 1\nentry of A\u266d . For 1 \u2264 i \u2264 d we let ci denote the i, i \u2212 1 entry of A\u266d . We observe\n\uf8f6\n\uf8eb\na0 b0\n0\n\uf8f7\n\uf8ec c1 a1 b1\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\nc2 * *\n\u266d\n\uf8f7,\n\uf8ec\n(31)\nA =\uf8ec\n\uf8f7\n*\n*\n*\n\uf8f7\n\uf8ec\n\uf8ed\n* * bd\u22121 \uf8f8\n0\ncd ad\nwhere the ai are from Definition 7.1. For notational convenience we define bd = 0 and c0 = 0.\nLemma 11.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars bi , ci\nbe as in Definition 11.1. Then with reference to Definition 5.1 and Definition 7.1 the following (i), (ii) hold.\n(i) bi\u22121 ci = xi\n\n(1 \u2264 i \u2264 d).\n\n(ii) ci + ai + bi = \u03b80\n\n(0 \u2264 i \u2264 d).\n\nProof: (i) Apply Lemma 7.2(ii) with B = A\u266d .\n(ii) Combine (31) and Lemma 10.7(i).\n\n\u0003\n\nLemma 11.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars bi , ci\nbe as in Definition 11.1. Let the polynomials pi be as in Definition 8.1 and let the scalar \u03b80\nbe as in Definition 5.1. Then the following (i)\u2013(iii) hold.\n(i) bi 6= 0\n(ii) ci 6= 0\n\n(0 \u2264 i \u2264 d \u2212 1).\n(1 \u2264 i \u2264 d).\n\n(iii) b0 b1 * * * bi\u22121 = pi (\u03b80 )\n\n(0 \u2264 i \u2264 d + 1).\n18\n\n\fProof: (i), (ii) Immediate from Lemma 11.2(i) and since each of x1 , x2 , . . . , xd is nonzero.\n(iii) Assume 0 \u2264 i \u2264 d; otherwise each side is zero. Let \u2020 : A \u2192 A denote the antiautomorphism which corresponds to \u03a6. Applying \u2020 to both sides of (22) we get E0\u2217 pi (A) = E0\u2217 Ai Ei\u2217 .\nWe may now argue\nb0 b1 . . . bi\u22121 =\n=\n=\n=\n=\n\n(Ai\u266d )0i\n\u2217 i \u2217\nm\u2217\u22121\n0 tr(E0 A Ei E0 )\n\u2217\nm\u2217\u22121\n0 tr(E0 pi (A)E0 )\n\u2217\nm\u2217\u22121\n0 pi (\u03b80 )tr(E0 E0 )\npi (\u03b80 )\n\n(by (31))\n(by Theorem 10.9)\n\n(by Definition 9.1).\n\u0003\n\nTheorem 11.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Let the scalar \u03b80 be as in Definition 5.1. Then pi (\u03b80 ) 6= 0 for\n0 \u2264 i \u2264 d. Let the scalars bi , ci be as in Definition 11.1. Then\nbi =\n\npi+1 (\u03b80 )\npi (\u03b80 )\n\n(0 \u2264 i \u2264 d)\n\n(32)\n\n(1 \u2264 i \u2264 d).\n\n(33)\n\nand\nci =\n\nxi pi\u22121 (\u03b80 )\npi (\u03b80 )\n\nProof: Observe pi (\u03b80 ) 6= 0 for 0 \u2264 i \u2264 d by Lemma 11.3(i), (iii). Line (32) is immediate from\nLemma 11.3(iii). To get (33) combine (32) and Lemma 11.2(i).\n\u0003\nLemma 11.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars bi , ci\nbe as in Definition 11.1. Then the following (i), (ii) hold.\n\u2217\n(i) Ei\u2217 AEi+1\nE0 = bi Ei\u2217 E0\n\u2217\n(ii) Ei\u2217 AEi\u22121\nE0 = ci Ei\u2217 E0\n\n(0 \u2264 i \u2264 d \u2212 1).\n(1 \u2264 i \u2264 d).\n\nProof: (i) This is (29) with X = A and j = i + 1.\n(ii) This is (29) with X = A and j = i \u2212 1.\n\n\u0003\n\nTheorem 11.6 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars\nbi , ci be as in Definition 11.1. Let the scalars m\u2217i be as in Definition 9.1. Then the following\n(i), (ii) hold.\n\u2217\nE0 )\n(i) bi = m\u2217\u22121\ntr(Ei\u2217 AEi+1\ni\n\u2217\n(ii) ci = m\u2217\u22121\ntr(Ei\u2217 AEi\u22121\nE0 )\ni\n\n(0 \u2264 i \u2264 d \u2212 1).\n(1 \u2264 i \u2264 d).\n19\n\n\fProof: (i) This is (30) with X = A and j = i + 1.\n(ii) This is (30) with X = A and j = i \u2212 1.\n\n\u0003\n\nWe finish this section with a comment.\nTheorem 11.7 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars ci\nbe as in Definition 11.1. Let the scalars \u03b8i be as in Definition 5.1 and let the scalar \u03bd be as\nin Definition 9.3. Then\n(\u03b80 \u2212 \u03b81 )(\u03b80 \u2212 \u03b82 ) * * * (\u03b80 \u2212 \u03b8d ) = \u03bdc1 c2 * * * cd .\n\n(34)\n\nProof: Let \u03b4Qdenote the expression on the left-hand side of (34). Setting i = 0 in (4) we\nfind \u03b4E0 = dj=1 (A \u2212 \u03b8j I). We multiply both sides of this equation on the left by Ed\u2217 and\non the right by E0\u2217 . We evaluate the resulting equation using Lemma 5.10(i) to obtain\n\u03b4Ed\u2217 E0 E0\u2217 = Ed\u2217 Ad E0\u2217 . We multiply both sides of this equation on the right by E0 to obtain\n\u03b4Ed\u2217 E0 E0\u2217 E0 = Ed\u2217 Ad E0\u2217 E0 .\n\n(35)\n\nWe evaluate each side of (35). The left-hand side of (35) is equal to \u03b4\u03bd \u22121 Ed\u2217 E0 in view of\n\u2217\nLemma 9.4(i). We now consider the right-hand side of (35). Observe Ed\u2217 Ad E0\u2217 = Ed\u2217 AEd\u22121\nA\n\u2217\n\u2217\n* * * E1 AE0 by (13). Evaluating the right-hand side of (35) using this and Theorem 11.5(ii)\nwe find it is equal to c1 c2 * * * cd Ed\u2217 E0 . From our above comments we find \u03b4\u03bd \u22121 Ed\u2217 E0 =\nc1 c2 * * * cd Ed\u2217 E0 . Observe Ed\u2217 E0 6= 0 by Lemma 10.1 so \u03b4\u03bd \u22121 = c1 c2 * * * cd . The result follows.\n\u0003\n\n12\n\nThe scalars ki\n\nIn this section we consider some scalars that are closely related to the scalars from Definition\n9.1.\nDefinition 12.1 Let \u03a6 denote the Leonard system from Definition 3.2. We define\nki = m\u2217i \u03bd\n\n(0 \u2264 i \u2264 d),\n\n(36)\n\nwhere the m\u2217i are from Definition 9.1 and \u03bd is from Definition 9.3.\nLemma 12.2 Let \u03a6 denote the Leonard system from Definition 3.2 and\nPdlet the scalars ki be\nas in Definition 12.1. Then (i) k0 = 1; (ii) ki 6= 0 for 0 \u2264 i \u2264 d; (iii) i=0 ki = \u03bd.\n\nProof: (i) Set i = 0 in (36) and recall m\u22170 = \u03bd \u22121 .\n(ii) Applying Lemma 9.2(iii) to \u03a6\u2217 we find m\u2217i 6= 0 for 0 \u2264 i \u2264 d. We have \u03bd 6= 0 by\nDefinition 9.3. The result follows in view of\nP(36).\n\u2217\n(iii) Applying Lemma 9.2(iv) to \u03a6 we find di=0 m\u2217i = 1. The result follows in view of (36). \u0003\n20\n\n\fLemma 12.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars ki be\nas in Definition 12.1. Then with reference to Definition 5.1, Definition 7.1, and Definition\n8.1,\nki =\n\npi (\u03b80 )2\nx1 x2 * * * xi\n\n(0 \u2264 i \u2264 d).\n\n(37)\n\nProof: We show that each side of (37) is equal to \u03bdtr(Ei\u2217 E0 ). Using (24) and (36) we find\n\u03bdtr(Ei\u2217 E0 ) is equal to the left-hand side of (37). Using Theorem 8.6 we find \u03bdtr(Ei\u2217 E0 ) is\nequal to the right-hand side of (37).\n\u0003\nTheorem 12.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let the scalars ki\nbe as in Definition 12.1. Let the scalars bi , ci be as in Definition 11.1. Then\nki =\n\nb0 b1 * * * bi\u22121\nc1 c2 * * * ci\n\n(0 \u2264 i \u2264 d).\n\n(38)\n\nProof: Evaluate the expression on the right in (37) using Lemma 11.2(i) and Lemma 11.3(iii).\n\u0003\n\n13\n\nThe polynomials vi\n\nLet \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials pi be as in\nDefinition 8.1. The pi have two normalizations of interest; we call these the ui and the vi .\nIn this section we discuss the vi . In the next section we will discuss the ui .\nDefinition 13.1 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials pi be as in Definition 8.1. For 0 \u2264 i \u2264 d we define the polynomial vi by\nvi =\n\npi\n,\nc1 c2 * * * ci\n\n(39)\n\nwhere the cj are from Definition 11.1. We observe v0 = 1.\nLemma 13.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nvi be as in Definition 13.1. Let the scalar \u03b80 be as in Definition 5.1 and let the scalars ki be\nas in Definition 12.1. Then\nvi (\u03b80 ) = ki\n\n(0 \u2264 i \u2264 d).\n\nProof: Use Lemma 11.3(iii), Theorem 12.4, and (39).\n\n21\n\n(40)\n\u0003\n\n\fLemma 13.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nvi be as in Definition 13.1. Let the scalars ai , bi , ci be as in Definition 7.1 and Definition\n11.1. Then\n\u03bbvi = ci+1 vi+1 + ai vi + bi\u22121 vi\u22121\n\n(0 \u2264 i \u2264 d \u2212 1),\n\n(41)\n\nwhere b\u22121 = 0 and v\u22121 = 0. Moroever\n\u03bbvd \u2212 ad vd \u2212 bd\u22121 vd\u22121 = (c1 c2 * * * cd )\u22121 pd+1 .\n\n(42)\n\nProof: In (19), divide both sides by c1 c2 * * * ci . Evaluate the result using Lemma 11.2(i) and\n(39).\n\u0003\nTheorem 13.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nvi be as in Definition 13.1. Let V denote an irreducible A-module and let u denote a nonzero\nvector in E0 V . Then\nvi (A)E0\u2217 u = Ei\u2217 u\n(0 \u2264 i \u2264 d).\n(43)\nProof: For 0 \u2264 i \u2264 d we define wi = vi (A)E0\u2217 u and wi\u2032 = Ei\u2217 u. We show wi = wi\u2032 . Each of\nw0 , w0\u2032 is equal to E0\u2217 u so w0 = w0\u2032 . Using Lemma 13.3 we obtain\nAwi = ci+1 wi+1 + ai wi + bi\u22121 wi\u22121\n\n(0 \u2264 i \u2264 d \u2212 1)\n\n(44)\n\nwhere w\u22121 = 0 and b\u22121 = 0. By Definition 10.6, Definition 11.1, and since w0\u2032 , w1\u2032 , . . . , wd\u2032 is\na \u03a6-standard basis,\n\u2032\n\u2032\nAwi\u2032 = ci+1 wi+1\n+ ai wi\u2032 + bi\u22121 wi\u22121\n\n(0 \u2264 i \u2264 d \u2212 1)\n\n(45)\n\n\u2032\nwhere w\u22121\n= 0. Comparing (44), (45) and using w0 = w0\u2032 we find wi = wi\u2032 for 0 \u2264 i \u2264 d.\nThe result follows.\n\u0003\n\nWe finish this section with a comment.\nLemma 13.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nvi be as in Definition 13.1. Let the scalar \u03bd be as in Definition 9.3. Then the following (i),\n(ii) hold.\n(i) vi (A)E0\u2217 E0 = Ei\u2217 E0\n(ii) vi (A)E0\u2217 = \u03bdEi\u2217 E0 E0\u2217\n\n(0 \u2264 i \u2264 d).\n(0 \u2264 i \u2264 d).\n\nProof: (i) Let the integer i be given and abbreviate \u2206 = vi (A)E0\u2217 \u2212 Ei\u2217 . We show \u2206E0 = 0.\nIn order to to do this we show \u2206E0 V = 0, where V denotes an irreducible A-module. Let u\ndenote a nonzero vector in E0 V and recall u spans E0 V . Observe \u2206u = 0 by Theorem 13.4\nso \u2206E0 V = 0. Now \u2206E0 = 0 so vi (A)E0\u2217 E0 = Ei\u2217 E0 .\n(ii) In the equation of (i) above, multiply both sides on the right by E0\u2217 and simplify the\nresult using Lemma 9.4(ii).\n\u0003\n\n22\n\n\f14\n\nThe polynomials ui\n\nLet \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials pi be as in\nDefinition 8.1. In the previous section we gave a normalization of the pi that we called the\nvi . In this section we give a second normalization for the pi that we call the ui .\nDefinition 14.1 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials pi be as in Definition 8.1. For 0 \u2264 i \u2264 d we define the polynomial ui by\nui =\n\npi\n,\npi (\u03b80 )\n\n(46)\n\nwhere \u03b80 is from Definition 5.1. We observe u0 = 1. Moreover\nui (\u03b80 ) = 1\n\n(0 \u2264 i \u2264 d).\n\n(47)\n\nLemma 14.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nui be as in Definition 14.1. Let the scalars ai , bi , ci be as in Definition 7.1 and Definition\n11.1. Then\n\u03bbui = bi ui+1 + ai ui + ci ui\u22121\n\n(0 \u2264 i \u2264 d \u2212 1),\n\n(48)\n\nwhere u\u22121 = 0. Moreover\n\u03bbud \u2212 cd ud\u22121 \u2212 ad ud = pd (\u03b80 )\u22121 pd+1 ,\n\n(49)\n\nwhere \u03b80 is from Definition 5.1.\nProof: In (19), divide both sides by pi (\u03b80 ) and evaluate the result using Lemma 11.2(i), (32),\nand (46).\n\u0003\nThe above 3-term recurrence is often expressed as follows.\nCorollary 14.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials ui be as in Definition 14.1. Let the scalars \u03b8i be as in Definition 5.1. Then for 0 \u2264 i, j \u2264 d\nwe have\n\u03b8j ui (\u03b8j ) = bi ui+1 (\u03b8j ) + ai ui (\u03b8j ) + ci ui\u22121 (\u03b8j ),\n\n(50)\n\nwhere u\u22121 = 0 and ud+1 = 0.\nProof: Apply Lemma 14.2 (with \u03bb = \u03b8j ) and observe pd+1 (\u03b8j ) = 0 by Theorem 8.5(ii).\n\n\u0003\n\nLemma 14.4 Let \u03a6 denote the Leonard system from Definition 3.2. Let the polynomials\nui , vi be as in Definition 14.1 and Definition 13.1 respectively. Then\nvi = ki ui\n\n(0 \u2264 i \u2264 d),\n\nwhere the ki are from Definition 12.1.\n23\n\n(51)\n\n\fProof: Compare (39) and (46) in light of Lemma 11.3(iii) and Theorem 12.4.\n\n\u0003\n\nLet \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials ui be as in\nDefinition 14.1. Let \u03b80 , \u03b81 , . . . , \u03b8d denote the eigenvalue sequence of \u03a6. Our next goal is to\ncompute the ui (\u03b8j ) in terms of the trace function. To prepare for this we give a lemma.\nLemma 14.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nvi be as in Definition 13.1. Let the scalars \u03b8i be as in Definition 5.1 and let the scalars mi\nbe as in Definition 9.1. Then\nE0 Ei\u2217 Ej E0\u2217 = vi (\u03b8j )mj E0 E0\u2217\n\n(0 \u2264 i, j \u2264 d).\n\n(52)\n\nProof: Let \u2020 : A \u2192 A denote the antiautomorphism which corresponds to \u03a6. Applying \u2020 to\nthe equation in Lemma 13.5(i) we find E0 E0\u2217 vi (A) = E0 Ei\u2217 . Using this and Lemma 9.2(ii)\nwe find\nE0 Ei\u2217 Ej E0\u2217 = E0 E0\u2217 vi (A)Ej E0\u2217\n= vi (\u03b8j )E0 E0\u2217 Ej E0\u2217\n= vi (\u03b8j )mj E0 E0\u2217 .\n\u0003\nTheorem 14.6 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nui be as in Definition 14.1. Let the scalars \u03b8i be as in Definition 5.1 and let the scalars mi , m\u2217i\nbe as in Definition 9.1. Then\n\u2217\n\u2217\nui (\u03b8j ) = m\u2217\u22121\nm\u22121\ni\nj tr(E0 Ei Ej E0 )\n\n(0 \u2264 i, j \u2264 d).\n\n(53)\n\nProof: In (52), take the trace of both sides and simplify the result using (25), (36), (51). \u0003\nTheorem 14.7 Let \u03a6 denote the Leonard system from Definition 3.2. Let the polynomials\nui be as in Definition 14.1 and recall the u\u2217i are the corresponding polynomials for \u03a6\u2217 . Let\nthe scalars \u03b8i , \u03b8i\u2217 be as in Definition 5.1. Then\nui (\u03b8j ) = u\u2217j (\u03b8i\u2217 )\n\n(0 \u2264 i, j \u2264 d).\n\n(54)\n\n\u2217\u22121\ntr(E0\u2217 Ei Ej\u2217 E0 ).\nu\u2217i (\u03b8j\u2217 ) = m\u22121\ni mj\n\n(55)\n\nProof: Applying Theorem 14.6 to \u03a6\u2217 we find\n\nInterchanging the roles of i, j in (55) we obtain\n\u2217\n\u2217\nm\u22121\nu\u2217j (\u03b8i\u2217 ) = m\u2217\u22121\ni\nj tr(E0 Ej Ei E0 ).\n\n(56)\n\nLet \u2020 : A \u2192 A denote the antiautomorphism which corresponds to \u03a6. Observe\n(E0 Ei\u2217 Ej E0\u2217 )\u2020 = E0\u2217 Ej Ei\u2217 E0\n24\n\n(57)\n\n\fin view of Lemma 6.3. The trace function is invariant under \u2020 so\ntr(E0 Ei\u2217 Ej E0\u2217 ) = tr(E0\u2217 Ej Ei\u2217 E0 ).\nCombining (53), (56), (58) we obtain (54).\n\n(58)\n\u0003\n\nIn the following two theorems we show how (54) looks in terms of the polynomials vi and pi .\nTheorem 14.8 Let \u03a6 denote the Leonard system from Definition 3.2. With reference to\nDefinition 5.1, Definition 4.1 and Definition 13.1,\nvi (\u03b8j )/ki = vj\u2217 (\u03b8i\u2217 )/kj\u2217\n\n(0 \u2264 i, j \u2264 d).\n\nProof: Evaluate (54) using Lemma 14.4.\n\n(59)\n\u0003\n\nTheorem 14.9 Let \u03a6 denote the Leonard system from Definition 3.2. With reference to\nDefinition 5.1, Definition 4.1, and Definition 8.1,\np\u2217j (\u03b8i\u2217 )\npi (\u03b8j )\n= \u2217 \u2217\npi (\u03b80 )\npj (\u03b80 )\n\n(0 \u2264 i, j \u2264 d).\n\nProof: Evaluate (54) using Definition 14.1.\n\n(60)\n\u0003\n\nThe equations (54), (59), (60) are often referred to as Askey-Wilson duality.\nWe finish this section with a few comments.\nLemma 14.10 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nui be as in Definition 14.1. Then for 0 \u2264 i, j \u2264 d we have\n\u03b8i\u2217 ui (\u03b8j ) = b\u2217j ui (\u03b8j+1 ) + a\u2217j ui (\u03b8j ) + c\u2217j ui (\u03b8j\u22121 ),\n\n(61)\n\nwhere \u03b8\u22121 , \u03b8d+1 denote indeterminates.\nProof: Apply Corollary 14.3 to \u03a6\u2217 and evaluate the result using Theorem 14.7.\n\n\u0003\n\nWe refer to (61) as the difference equation satisfied by the ui .\nLemma 14.11 Let \u03a6 denote the Leonard system from Definition 3.2 and assume d \u2265 1.\nLet the polynomials ui be as in Definition 14.1. Then\nui (\u03b81 ) =\n\n\u03b8i\u2217 \u2212 a\u22170\n\u03b80\u2217 \u2212 a\u22170\n\n(0 \u2264 i \u2264 d).\n\n(62)\n\nProof: Setting j = 1 in (54) we find ui (\u03b81 ) = u\u22171 (\u03b8i\u2217 ). Applying (46) to \u03a6\u2217 we find u\u22171 =\np\u22171 /p\u22171 (\u03b80\u2217 ). Applying Definition 8.1 to \u03a6\u2217 we find p\u22171 = \u03bb \u2212 a\u22170 . Combining these facts we get\nthe result.\n\u0003\n\n25\n\n\fLemma 14.12 Let \u03a6 denote the Leonard system from Definition 3.2 and assume d \u2265 1.\nThen\n\u2217\n\u2217\nbi \u03b8i+1\n+ ai \u03b8i\u2217 + ci \u03b8i\u22121\n= \u03b81 \u03b8i\u2217 + a\u22170 (\u03b80 \u2212 \u03b81 )\n\n(0 \u2264 i \u2264 d),\n\n\u2217\n\u2217\nwhere \u03b8\u22121\n, \u03b8d+1\ndenote indeterminates.\n\nProof: Set j = 1 in (50). Evaluate the result using Lemma 11.2(ii) and (62).\n\n15\n\n\u0003\n\nA bilinear form\n\nIn this section we associate with each Leonard pair a certain bilinear form. To prepare for\nthis we recall a few concepts from linear algebra.\nLet V denote a finite dimensional vector space over K. By a bilinear form on V we mean a\nmap h , i : V \u00d7V \u2192 K that satisfies the following four conditions for all u, v, w \u2208 V and for all\n\u03b1 \u2208 K: (i) hu + v, wi = hu, wi + hv, wi; (ii) h\u03b1u, vi = \u03b1hu, vi; (iii) hu, v + wi = hu, vi + hu, wi;\n(iv) hu, \u03b1vi = \u03b1hu, vi. We observe that a scalar multiple of a bilinear form on V is a bilinear\nform on V . Let h , i denote a bilinear form on V . This form is said to be symmetric whenever\nhu, vi = hv, ui for all u, v \u2208 V . Let h , i denote a bilinear form on V . Then the following\nare equivalent: (i) there exists a nonzero u \u2208 V such that hu, vi = 0 for all v \u2208 V ; (ii)\nthere exists a nonzero v \u2208 V such that hu, vi = 0 for all u \u2208 V . The form h , i is said to be\ndegenerate whenever (i), (ii) hold and nondegenerate otherwise. Let \u03b3 : A \u2192 A denote an\nantiautomorphism and let V denote an irreducible A-module. Then there exists a nonzero\nbilinear form h , i on V such that hXu, vi = hu, X \u03b3 vi for all u, v \u2208 V and for all X \u2208 A. The\nform is unique up to multiplication by a nonzero scalar in K. The form in nondegenerate.\nWe refer to this form as the bilinear form on V associated with \u03b3. This form is not symmetric\nin general.\nWe now return our attention to Leonard pairs.\nDefinition 15.1 Let \u03a6 = (A; A\u2217 ; {Ei }di=0 ; {Ei\u2217 }di=0 ) denote a Leonard system in A. Let\n\u2020 : A \u2192 A denote the corresponding antiautomorphism from Definition 6.2. Let V denote\nan irreducible A-module. For the rest of this paper we let h , i denote the bilinear form on\nV associated with \u2020. We abbreviate kuk2 = hu, ui for all u \u2208 V . By the construction, for\nX \u2208 A we have\nhXu, vi = hu, X \u2020 vi\n\n(\u2200u \u2208 V, \u2200v \u2208 V ).\n\n(63)\n\nWe make an observation.\nLemma 15.2 With reference to Definition 15.1, let D (resp. D \u2217 ) denote the subalgebra of\nA generated by A (resp. A\u2217 .) Then for X \u2208 D \u222a D \u2217 we have\nhXu, vi = hu, Xvi\n\n(\u2200u \u2208 V, \u2200v \u2208 V ).\n26\n\n(64)\n\n\fProof: Combine (63) and Lemma 6.3.\n\n\u0003\n\nWith reference to Definition 15.1, our next goal is to show h , i is symmetric. We will use\nthe following lemma.\nTheorem 15.3 With reference to Definition 15.1, let u denote a nonzero vector in E0 V and\nrecall E0\u2217 u, E1\u2217u, . . . , Ed\u2217 u is a \u03a6-standard basis for V . We have\nhEi\u2217 u, Ej\u2217 ui = \u03b4ij ki \u03bd \u22121 kuk2\n\n(0 \u2264 i, j \u2264 d),\n\n(65)\n\nwhere the ki are from Definition 12.1 and \u03bd is from Definition 9.3.\nProof: By (64) and since E0 u = u we find hEi\u2217 u, Ej\u2217 ui = hu, E0 Ei\u2217 Ej\u2217 E0 ui. Using Lemma\n9.2(ii) and (36) we find hu, E0Ei\u2217 Ej\u2217 E0 ui = \u03b4ij ki \u03bd \u22121 kuk2.\n\u0003\nCorollary 15.4 With reference to Definition 15.1, the bilinear form h , i is symmetric.\nProof: Let u denote a nonzero vector in E0 V and abbreviate vi = Ei\u2217 u for 0 \u2264 i \u2264 d. From\nTheorem 15.3 we find hvi , vj i = hvj , vi i for 0 \u2264 i, j \u2264 d. The result follows since v0 , v1 , . . . , vd\nis a basis for V .\n\u0003\nWe have a comment.\nLemma 15.5 With reference to Definition 15.1, let u denote a nonzero vector in E0 V and\nlet v denote a nonzero vector in E0\u2217 V . Then the following (i)\u2013(iv) hold.\n(i) Each of kuk2, kvk2 , hu, vi is nonzero.\n(ii) E0\u2217 u = hu, vikvk\u22122v.\n(iii) E0 v = hu, vikuk\u22122u.\n(iv) \u03bdhu, vi2 = kuk2 kvk2 .\nProof: (i) Observe kuk2 6= 0 by Theorem 15.3 and since h , i is not 0. Similarly kvk2 6= 0.\nTo see that hu, vi =\n6 0, observe that v is a basis for E0\u2217 V so there exists \u03b1 \u2208 K such that\nE0\u2217 u = \u03b1v. Recall E0\u2217 u 6= 0 by Lemma 10.2 so \u03b1 6= 0. Using (64) and E0\u2217 v = v we routinely\nfind hu, vi = \u03b1kvk2 and it follows hu, vi =\n6 0.\n\u2217\n(ii) In the proof of part (i) we found E0 u = \u03b1v where hu, vi = \u03b1kvk2 . The result follows.\n(iii) Similar to the proof of (ii) above.\n(iv) Using u = E0 u and \u03bdE0 E0\u2217 E0 = E0 we find \u03bd \u22121 u = E0 E0\u2217 u. To finish the proof, evaluate\nE0 E0\u2217 u using (ii) above and then (iii) above.\n\u0003\nTheorem 15.6 With reference to Definition 15.1, let u denote a nonzero vector in E0 V and\nlet v denote a nonzero vector in E0\u2217 V . Then\nhEi\u2217 u, Ej vi = \u03bd \u22121 ki kj\u2217 ui (\u03b8j )hu, vi\n27\n\n(0 \u2264 i, j \u2264 d).\n\n(66)\n\n\fProof: Using Theorem 13.4 we find\nhEi\u2217 u, Ej vi =\n=\n=\n=\n=\n=\n\nhvi (A)E0\u2217 u, Ej vi\nhE0\u2217 u, vi (A)Ej vi\nvi (\u03b8j )hE0\u2217 u, Ej vi\nvi (\u03b8j )hE0\u2217 u, vj\u2217(A\u2217 )E0 vi\nvi (\u03b8j )hvj\u2217 (A\u2217 )E0\u2217 u, E0vi\nvi (\u03b8j )vj\u2217 (\u03b80\u2217 )hE0\u2217 u, E0vi.\n\n(67)\n\nUsing Lemma 15.5(ii)\u2013(iv) we find hE0\u2217 u, E0 vi = \u03bd \u22121 hu, vi. Observe vi (\u03b8j ) = ui (\u03b8j )ki by (51).\nApplying Lemma 13.2 to \u03a6\u2217 we find vj\u2217 (\u03b80\u2217 ) = kj\u2217 . Evaluating (67) using these comments we\nobtain (66).\n\u0003\nRemark 15.7 Using Theorem 15.6 and the symmetry of h , i we get an alternate proof of\nTheorem 14.7.\nTheorem 15.8 With reference to Definition 15.1, let u denote a nonzero vector in E0 V and\nlet v denote a nonzero vector in E0\u2217 V . Then for 0 \u2264 i \u2264 d, both\nd\n\nEi\u2217 u =\n\nhu, vi X\nvi (\u03b8j )Ej v,\nkvk2 j=0\n\n(68)\n\nd\n\nhu, vi X \u2217 \u2217 \u2217\nv (\u03b8 )E u.\nEi v =\nkuk2 j=0 i j j\n\n(69)\n\nProof: We first show (68). To do this we show each side of (68) is equal to vi (A)E0\u2217 u. By\nTheorem 13.4 we find vi (A)E0\u2217 u is equal to the left-hand side of (68). To see that vi (A)E0\u2217 u is\nequal to thePright-hand side of (68), multiply vi (A)E0\u2217 u on the left by the identity I, expand\nusing I = dj=0 Ej , and simplify the result using Ej A = \u03b8j Ej (0 \u2264 j \u2264 d) and Lemma\n15.5(ii). We have now proved (68). Applying (68) to \u03a6\u2217 we obtain (69).\n\u0003\nDefinition 15.9 Let \u03a6 denote the Leonard system from Definition 3.2. We define a matrix\nP \u2208 Matd+1 (K) as follows. For 0 \u2264 i, j \u2264 d the entry Pij = vj (\u03b8i ), where \u03b8i is from Definition\n5.1 and vj is from Definition 13.1.\nTheorem 15.10 Let \u03a6 denote the Leonard system from Definition 3.2. Let the matrix P\nbe as in Definition 15.9 and recall P \u2217 is the corresponding matrix for \u03a6\u2217 . Then P \u2217 P = \u03bdI,\nwhere \u03bd is from Definition 9.3.\nProof: Compare (68), (69) and use Lemma 15.5(iv).\n\n28\n\n\u0003\n\n\fTheorem 15.11 Let \u03a6 denote the Leonard system from Definition 3.2 and let the matrix\nP be as in Definition 15.9. Let the map \u266d : A \u2192 Matd+1 (K) be as in Definition 10.6 and let\n\u266f : A \u2192 Matd+1 (K) denote the corresponding map for \u03a6\u2217 . Then for all X \u2208 A we have\nX \u266fP = P X \u266d.\n\n(70)\n\nProof: Let V denote an irreducible A-module. Let u denote a nonzero vector in E0 V and\nrecall E0\u2217 u, E1\u2217 u, . . . , Ed\u2217 u is a \u03a6-standard basis for V . By Definition 10.6, X \u266d is the matrix\nin Matd+1 (K) that represents X with respect to E0\u2217 u, E1\u2217 u, . . . , Ed\u2217 u. Similarly for a nonzero\nv \u2208 E0\u2217 V , X \u266f is the matrix in Matd+1 (K) that represents X with respect to E0 v, E1 v, . . . , Ed v.\nIn view of (68), the transition matrix from E0 v, E1 v, . . . , Ed v to E0\u2217 u, E1\u2217 u, . . . , Ed\u2217 u is a scalar\nmultiple of P . The result follows from these comments and elementary linear algebra.\n\u0003\n\n16\n\nThe orthogonality relations\n\nIn this section we show that each of the polynomial sequences pi , ui , vi satisfy an orthogonality\nrelation. We begin with the vi .\nTheorem 16.1 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nvi be as in Definition 13.1. Then both\nd\nX\n\nvi (\u03b8r )vj (\u03b8r )kr\u2217 = \u03b4ij \u03bdki\n\nr=0\nd\nX\n\nvi (\u03b8r )vi (\u03b8s )ki\u22121 = \u03b4rs \u03bdkr\u2217\u22121\n\n(0 \u2264 i, j \u2264 d),\n(0 \u2264 r, s \u2264 d).\n\n(71)\n(72)\n\ni=0\n\nProof: We refer to Theorem 15.10. To obtain (71) compute the ij entry in P \u2217 P = \u03bdI using\nmatrix multiplication and evaluate the result using Theorem 14.8. To obtain (72) compute\nthe ij entry of P P \u2217 = \u03bdI using matrix multiplication and evaluate the result using Theorem\n14.8.\n\u0003\nWe now turn to the polynomials ui .\nTheorem 16.2 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\nui be as in Definition 14.1. Then both\nd\nX\n\nui (\u03b8r )uj (\u03b8r )kr\u2217 = \u03b4ij \u03bdki\u22121\n\nr=0\nd\nX\n\nui (\u03b8r )ui (\u03b8s )ki = \u03b4rs \u03bdkr\u2217\u22121\n\ni=0\n\n29\n\n(0 \u2264 i, j \u2264 d),\n(0 \u2264 r, s \u2264 d).\n\n\fProof: Evaluate each of (71), (72) using Lemma 14.4.\n\n\u0003\n\nWe now turn to the polynomials pi .\nTheorem 16.3 Let \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials\npi be as in Definition 8.1. Then both\nd\nX\n\npi (\u03b8r )pj (\u03b8r )mr = \u03b4ij x1 x2 * * * xi\n\n(0 \u2264 i, j \u2264 d),\n\nr=0\n\nd\nX\npi (\u03b8r )pi (\u03b8s )\ni=0\n\nx1 x2 * * * xi\n\n= \u03b4rs m\u22121\nr\n\n(0 \u2264 r, s \u2264 d).\n\nProof: Applying Definition 12.1 to \u03a6\u2217 we find kr\u2217 = mr \u03bd for 0 \u2264 r \u2264 d. Evaluate each of\n(71), (72) using this and Definition 13.1, Lemma 11.2(i), (38).\n\u0003\n\n17\n\nEverything in terms of the parameter array\n\nIn this section we express all the polynomials and scalars that came up so far in the paper,\nin terms of a short list of parameters called the parameter array. The parameter array of\na Leonard system consists of its eigenvalue sequence, its dual eigenvalue sequence, and two\nadditional sequences called the first split sequence and the second split sequence. The first\nsplit sequence is defined as follows. Let \u03a6 denote the Leonard system from Definition 3.2.\nWe showed in [9, Theorem 3.2] that there exists nonzero scalars \u03c61 , \u03c62 , . . . , \u03c6d in K and there\nexists an isomorphism of K-algebras \u266e : A \u2192 Matd+1 (K) such that\n\uf8f6\n\uf8eb \u2217\n\uf8f6\n\uf8eb\n\u03b80 \u03c61\n0\n\u03b80\n0\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec 1 \u03b81\n\u03b81\u2217 \u03c62\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n\u2217\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n\u03b8\n*\n1\n\u03b8\n2\n\u2217\u266e\n\u266e\n2\n\uf8f7,\n\uf8ec\n\uf8f7,\n(73)\nA\n=\nA =\uf8ec\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n* *\n* *\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n\uf8ed\n\uf8f8\n\uf8ed\n* \u03c6d \uf8f8\n* *\n0\n\u03b8d\u2217\n0\n1 \u03b8d\nwhere the \u03b8i , \u03b8i\u2217 are from Definition 5.1. The sequence \u266e, \u03c61 , \u03c62 , . . . , \u03c6d is uniquely determined\nby \u03a6. We call the sequence \u03c61 , \u03c62 , . . . , \u03c6d the first split sequence of \u03a6. We let \u03c61 , \u03c62 , . . . , \u03c6d\ndenote the first split sequence of \u03a6\u21d3 and call this the second split sequence of \u03a6. For notational\nconvenience we define \u03c60 = 0, \u03c6d+1 = 0, \u03c60 = 0, \u03c6d+1 = 0.\nDefinition 17.1 Let \u03a6 denote the Leonard system from Definition 3.2. By the parameter array of \u03a6 we mean the sequence (\u03b8i , \u03b8i\u2217 , i = 0..d; \u03c6j , \u03c6j , j = 1..d), where \u03b80 , \u03b81 , . . . , \u03b8d\n(resp. \u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 ) is the eigenvalue sequence (resp. dual eigenvalue sequence) of \u03a6 and\n\u03c61 , \u03c62 , . . . , \u03c6d (resp. \u03c61 , \u03c62, . . . , \u03c6d ) is the first split sequence (resp. second split sequence) of\n\u03a6.\n\n30\n\n\fWe remark that two Leonard systems over K are isomorphic if and only if they have the\nsame parameter array [9, Theorem 1.9].\nThe following result shows that the parameter array behaves nicely with respect to the D4\naction given in Section 4.\nTheorem 17.2 [9, Theorem 1.11] Let \u03a6 denote a Leonard system with parameter array\n(\u03b8i , \u03b8i\u2217 , i = 0..d; \u03c6j , \u03c6j , j = 1..d). Then (i)\u2013(iii) hold below.\n(i) The parameter array of \u03a6\u2217 is (\u03b8i\u2217 , \u03b8i , i = 0..d; \u03c6j , \u03c6d\u2212j+1 , j = 1..d).\n\u2217\n(ii) The parameter array of \u03a6\u2193 is (\u03b8i , \u03b8d\u2212i\n, i = 0..d; \u03c6d\u2212j+1, \u03c6d\u2212j+1, j = 1..d).\n\n(iii) The parameter array of \u03a6\u21d3 is (\u03b8d\u2212i , \u03b8i\u2217 , i = 0..d; \u03c6j , \u03c6j , j = 1..d).\nFor the rest of this paper we will use the following notation.\nDefinition 17.3 Suppose we are given an integer d \u2265 0 and two sequences of scalars\n\u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217\n\n\u03b80 , \u03b81 , . . . , \u03b8d ;\n\ntaken from K. Then for 0 \u2264 i \u2264 d + 1 we let \u03c4i , \u03c4i\u2217 , \u03b7i , \u03b7i\u2217 denote the following polynomials\nin K[\u03bb].\n\u03c4i =\n\u03b7i =\n\ni\u22121\nY\n\n\u03c4i\u2217\n\n(\u03bb \u2212 \u03b8h ),\n\nh=0\ni\u22121\nY\n\n=\n\ni\u22121\nY\n\n(\u03bb \u2212 \u03b8h\u2217 ),\n\nh=0\ni\u22121\nY\n\n\u03b7i\u2217 =\n\n(\u03bb \u2212 \u03b8d\u2212h ),\n\n\u2217\n(\u03bb \u2212 \u03b8d\u2212h\n).\n\n(74)\n(75)\n\nh=0\n\nh=0\n\nWe observe that each of \u03c4i , \u03c4i\u2217 , \u03b7i , \u03b7i\u2217 is monic with degree i.\nTheorem 17.4 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the polynomials ui be as\nin Definition 14.1. Then\nui =\n\ni\nX\nh=0\n\n\u03c4h\u2217 (\u03b8i\u2217 )\n\u03c4h\n\u03c61 \u03c62 * * * \u03c6h\n\n(0 \u2264 i \u2264 d).\n\n(76)\n\nWe are using the notation (74).\nProof: Let the integer i be given. The polynomial ui has degree i so there exists scalars\n\u03b10 , \u03b11 , . . . , \u03b1i in K such that\nui =\n\ni\nX\n\n\u03b1h \u03c4h .\n\nh=0\n\n31\n\n(77)\n\n\fWe show\n\u03c4h\u2217 (\u03b8i\u2217 )\n\u03b1h =\n\u03c61 \u03c62 * * * \u03c6h\n\n(0 \u2264 h \u2264 i).\n\n(78)\n\n\u2217\nIn order to do this we show \u03b10 = 1 and \u03b1h+1 \u03c6h+1 = \u03b1h (\u03b8i\u2217 \u2212\nP\u03b8i h ) for 0 \u2264 h \u2264 i \u2212 1. We now\nshow \u03b10 = 1. We evaluate (77) at \u03bb = \u03b80 and find ui (\u03b80 ) = h=0 \u03b1h \u03c4h (\u03b80 ). Recall ui (\u03b80 ) = 1\nby (47). Using (74) we find \u03c4h (\u03b80 ) = 1 for h = 0 and \u03c4h (\u03b80 ) = 0 for 1 \u2264 h \u2264 i. From these\ncomments we find \u03b10 = 1. We now show \u03b1h+1 \u03c6h+1 = \u03b1h (\u03b8i\u2217 \u2212 \u03b8h\u2217 ) for 0 \u2264 h \u2264 i \u2212 1. Let\nV denote an irreducible A-module. From (73) there exists a basis e0 , e1 , . . . , ed for V that\nsatisfies (A \u2212 \u03b8j I)ej = ej+1 (0 \u2264 j \u2264 d \u2212 1), (A \u2212 \u03b8d I)ed = 0 and (A\u2217 \u2212 \u03b8j\u2217 I)ej = \u03c6j ej\u22121\n(1 \u2264 j \u2264 d), (A\u2217 \u2212 \u03b80\u2217 I)e0 = 0. From the action of A on e0 , e1 , . . . , ed we find ej = \u03c4j (A)e0\nfor 0 \u2264 j \u2264 d. Observe A\u2217 e0 = \u03b80\u2217 e0 so e0 \u2208 E0\u2217 V . Combining Theorem 8.3 and (46) we find\nui (A)E0\u2217 V = Ei\u2217 V . By this and since e0 \u2208 E0\u2217 V we find ui (A)e0 \u2208 Ei\u2217 V . Apparently ui (A)e0\nis an eigenvector for A\u2217 with eigenvalue \u03b8i\u2217 . We may now argue\n\n0 = (A\u2217 \u2212 \u03b8i\u2217 I)ui (A)e0\ni\nX\n\u2217\n\u2217\n\u03b1h \u03c4h (A)e0\n= (A \u2212 \u03b8i I)\n= (A\u2217 \u2212 \u03b8i\u2217 I)\n\nh=0\ni\nX\n\n\u03b1h eh\n\nh=0\n\n=\n\ni\u22121\nX\n\neh (\u03b1h+1 \u03c6h+1 \u2212 \u03b1h (\u03b8i\u2217 \u2212 \u03b8h\u2217 )).\n\nh=0\n\nBy this and since e0 , e1 , . . . , ed are linearly independent we find \u03b1h+1 \u03c6h+1 = \u03b1h (\u03b8i\u2217 \u2212 \u03b8h\u2217 ) for\n0 \u2264 h \u2264 i \u2212 1. Line (78) follows and the theorem is proved.\n\u0003\nLemma 17.5 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the polynomials pi be as\nin Definition 8.1. With reference to Definition 17.3 we have\n\u03c61 \u03c62 * * * \u03c6i\npi (\u03b80 ) =\n(0 \u2264 i \u2264 d).\n(79)\n\u03c4i\u2217 (\u03b8i\u2217 )\nProof: In equation (76), each side is a polynomial of degree i in \u03bb. For the polynomial on the\nleft in (76) the coefficient of \u03bbi is pi (\u03b80 )\u22121 by (46) and since pi is monic. For the polynomial\non the right in (76) the coefficient of \u03bbi is \u03c4i\u2217 (\u03b8i\u2217 )(\u03c61 \u03c62 * * * \u03c6i )\u22121 . Comparing these coefficients\nwe obtain the result.\n\u0003\nTheorem 17.6 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the polynomials pi be as\nin Definition 8.1. Then with reference to Definition 17.3,\npi =\n\ni\nX\n\u03c61 \u03c62 * * * \u03c6i \u03c4h\u2217 (\u03b8i\u2217 )\n\u03c4\n\u2217 \u2217 h\n\u03c6\n1 \u03c62 * * * \u03c6h \u03c4i (\u03b8i )\nh=0\n\n32\n\n(0 \u2264 i \u2264 d).\n\n\fProof: Observe pi = pi (\u03b80 )ui by (46). In this equation we evaluate pi (\u03b80 ) using (79) and we\nevaluate ui using (76). The result follows.\n\u0003\nTheorem 17.7 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the scalars bi , ci be as in\nDefinition 11.1. Then with reference to Definition 17.3 the following (i), (ii) hold.\n(i) bi = \u03c6i+1\n(ii) ci = \u03c6i\n\n\u03c4i\u2217 (\u03b8i\u2217 )\n\u2217\n\u2217\n\u03c4i+1\n(\u03b8i+1\n)\n\n\u2217\n\u03b7d\u2212i\n(\u03b8i\u2217 )\n\u2217\n\u2217\n(\u03b8i\u22121\n)\n\u03b7d\u2212i+1\n\n(0 \u2264 i \u2264 d \u2212 1).\n(1 \u2264 i \u2264 d).\n\nProof: (i) Evaluate (32) using Lemma 17.5.\n(ii) Comparing the formulae for bi , ci given in Theorem 11.6 we find, with reference to Definition 4.1, that ci = b\u2193d\u2212i . Applying part (i) above to \u03a6\u2193 and using Theorem 17.2(ii) we\nroutinely obtain the result.\n\u0003\nLet \u03a6 denote the Leonard system from Definition 3.2 and let the scalars ai be as in Definition\n7.1. We mention two formulae that give ai in terms of the parameter array of \u03a6. The first\nformula is obtained using Lemma 11.2(ii) and Theorem 17.7. The second formula is given\nin the following theorem. This theorem was proven in [9, Lemma 5.1]; however we give an\nalternate proof that we find illuminating.\nTheorem 17.8 [9, Lemma 5.1] Let \u03a6 denote the Leonard system from Definition 3.2 and\nlet (\u03b8i , \u03b8i\u2217 , i = 0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the scalars\nai be as in Definition 7.1. Then\n\u03c6i\n\u03c6i+1\nai = \u03b8i + \u2217\n+ \u2217\n(0 \u2264 i \u2264 d),\n(80)\n\u2217\n\u2217\n\u03b8i \u2212 \u03b8i\u22121 \u03b8i \u2212 \u03b8i+1\n\u2217\n\u2217\nwhere we recall \u03c60 = 0, \u03c6d+1 = 0, and where \u03b8\u22121\n, \u03b8d+1\ndenote indeterminates.\n\nProof: Let the polynomials p0 , p1 , . . . , pd+1 be as in Definition 8.1 and recall these polynomials\nare monic. Let i be given and consider the polynomial\n\u03bbpi \u2212 pi+1 .\n\n(81)\n\nFrom (19) we find the polynomial (81) is equal to ai pi + xi pi\u22121 . Therefore the polynomial\n(81) has degree i and leading coefficient ai . In order to compute this leading coefficient, in\n(81) we evaluate each of pi , pi+1 using Theorem 8.5(ii) and Theorem 17.6. By this method\nwe routinely obtain (80).\n\u0003\nTheorem 17.9 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the scalars xi be as in\nDefinition 7.1. Then with reference to Definition 17.3,\nxi = \u03c6i \u03c6i\n\n\u2217\n\u2217\n\u2217\n\u03c4i\u22121\n(\u03b8i\u22121\n)\u03b7d\u2212i\n(\u03b8i\u2217 )\n\u2217\n\u2217\n\u03c4i\u2217 (\u03b8i\u2217 )\u03b7d\u2212i+1\n(\u03b8i\u22121\n)\n\n33\n\n(1 \u2264 i \u2264 d).\n\n(82)\n\n\fProof: Use xi = bi\u22121 ci and Theorem 17.7.\n\n\u0003\n\nTheorem 17.10 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the scalar \u03bd be as in\nDefinition 9.3. Then with reference to Definition 17.3,\n\u03bd=\n\n\u03b7d (\u03b80 )\u03b7d\u2217 (\u03b80\u2217 )\n.\n\u03c61 \u03c62 * * * \u03c6d\n\n(83)\n\nProof: Evaluate (34) using Theorem 17.7(ii).\n\n\u0003\n\nTheorem 17.11 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the scalars ki be as in\nDefinition 12.1. Then with reference to Definition 17.3,\nki =\n\n\u03b7d\u2217 (\u03b80\u2217 )\n\u03c61 \u03c62 * * * \u03c6i\n\u2217\n\u03c61 \u03c62 * * * \u03c6i \u03c4i\u2217 (\u03b8i\u2217 )\u03b7d\u2212i\n(\u03b8i\u2217 )\n\n(0 \u2264 i \u2264 d).\n\nProof: Evaluate (38) using Theorem 17.7.\n\n(84)\n\u0003\n\nTheorem 17.12 Let \u03a6 denote the Leonard system from Definition 3.2 and let (\u03b8i , \u03b8i\u2217 , i =\n0..d; \u03c6j , \u03c6j , j = 1..d) denote the corresponding parameter array. Let the scalars mi be as in\nDefinition 9.1. Then with reference to Definition 17.3,\nmi =\n\n\u03c61 \u03c62 * * * \u03c6i \u03c61 \u03c62 * * * \u03c6d\u2212i\n\u03b7d\u2217 (\u03b80\u2217 )\u03c4i (\u03b8i )\u03b7d\u2212i (\u03b8i )\n\n(0 \u2264 i \u2264 d).\n\n(85)\n\nProof: Applying Definition 12.1 to \u03a6\u2217 we find mi = ki\u2217 \u03bd \u22121 . We compute ki\u2217 using Theorem\n17.11 and Theorem 17.2(i). We compute \u03bd using Theorem 17.10. The result follows.\n\u0003\n\n18\n\nSome polynomials from the Askey scheme\n\nLet \u03a6 denote the Leonard system from Definition 3.2 and let the polynomials ui be as in\nDefinition 14.1. In this section we discuss how the ui fit into the Askey scheme [6], [3,\np260]. Our argument is summarized as follows. In [16] we displayed 13 families of parameter\narrays. By [16, Theorem 5.16] every parameter array is contained in at least one of these\nfamilies. In (76) the ui are expressed as a sum involving the parameter array of \u03a6. In\n[16, Examples 5.3-5.15] we evaluated this sum for the 13 families of parameter arrays. We\nfound the corresponding ui form a class consisting of the q-Racah, q-Hahn, dual q-Hahn,\nq-Krawtchouk, dual q-Krawtchouk, quantum q-Krawtchouk, affine q-Krawtchouk, Racah,\nHahn, dual Hahn, Krawtchouk, Bannai/Ito, and orphan polynomials. This class coincides\nwith the terminating branch of the Askey scheme. We remark the Bannai/Ito polynomials\n34\n\n\fcan be obtained from the q-Racah polynomials by letting q tend to \u22121 [3, p260]. The orphan\npolynomials exist for diameter d = 3 and Char(K) = 2 only [16, Example 5.15]. We will not\nreproduce all the details of our calculations here; instead we illustrate what is going on with\nsome examples. We will consider two families of parameter arrays. For the first family the\ncorresponding ui will turn out to be some Krawtchouk polynomials. For the second family\nthe corresponding ui will turn out to be the q-Racah polynomials.\nOur first example is associated with the Leonard pair (2). Let d denote a nonnegative integer\nand consider the following elements of K.\n\u03b8i = d \u2212 2i,\n\u03b8i\u2217 = d \u2212 2i\n(0 \u2264 i \u2264 d),\n\u03c6i = \u22122i(d \u2212 i + 1),\n\u03c6i = 2i(d \u2212 i + 1)\n\n(1 \u2264 i \u2264 d).\n\n(86)\n(87)\n\nIn order to avoid degenerate situations we assume the characteristic of K is zero or an odd\nprime greater than d. By [9, Theorem 1.9] we find there exists a Leonard system \u03a6 over K\nthat has parameter array (\u03b8i , \u03b8i\u2217 , i = 0..d; \u03c6j , \u03c6j , j = 1..d). Let the scalars ai for \u03a6 be as in\n(14). Applying Theorem 17.8 to \u03a6 we find\nai = 0\n\n(0 \u2264 i \u2264 d).\n\n(88)\n\nLet the scalars bi , ci for \u03a6 be as in Definition 11.1. Applying Theorem 17.7 to \u03a6 we find\nbi = d \u2212 i,\n\nci = i\n\n(0 \u2264 i \u2264 d).\n\n(89)\n\nPick any integers i, j (0 \u2264 i, j \u2264 d). Applying Theorem 17.4 to \u03a6 we find\nui (\u03b8j ) =\n\nd\nX\n(\u2212i)n (\u2212j)n 2n\nn=0\n\n(\u2212d)n n!\n\n,\n\n(90)\n\nwhere\n(a)n := a(a + 1)(a + 2) * * * (a + n \u2212 1)\n\nn = 0, 1, 2, . . .\n\nHypergeometric series are defined in [4, p. 3]. From this definition we find the sum on the\nright in (90) is the hypergeometric series\n\u0013\n\u0012\n\u2212i, \u2212j\n2 .\n(91)\n2 F1\n\u2212d\nA definition of the Krawtchouk polynomials can be found in [1] or [6]. Comparing this\ndefinition with (90), (91) we find the ui are Krawtchouk polynomials but not the most\ngeneral ones. Let the scalar \u03bd for \u03a6 be as in Definition 9.3. Applying Theorem 17.10 to \u03a6\nwe find \u03bd = 2d . Let the scalars ki for \u03a6 be as in Definition 12.1. Applying Theorem 17.11 to\n\u03a6 we obtain a binomial coefficent\n\u0012 \u0013\nd\n(0 \u2264 i \u2264 d).\nki =\ni\n35\n\n\fLet the scalars mi for \u03a6 be as in Definition 9.1. Applying Theorem 17.12 to \u03a6 we find\n\u0012 \u0013\nd \u2212d\n2\n(0 \u2264 i \u2264 d).\nmi =\ni\nWe now give our second example. For this example the polynomials ui will turn out to be\nthe q-Racah polynomials. To begin, let d denote a nonnegative integer and consider the\nfollowing elements in K.\n\u03b8i = \u03b80 + h(1 \u2212 q i )(1 \u2212 sq i+1 )/q i ,\n\u03b8i\u2217 = \u03b80\u2217 + h\u2217 (1 \u2212 q i )(1 \u2212 s\u2217 q i+1 )/q i\n\n(92)\n(93)\n\n\u03c6i = hh\u2217 q 1\u22122i (1 \u2212 q i )(1 \u2212 q i\u2212d\u22121 )(1 \u2212 r1 q i )(1 \u2212 r2 q i ),\n\u03c6i = hh\u2217 q 1\u22122i (1 \u2212 q i )(1 \u2212 q i\u2212d\u22121 )(r1 \u2212 s\u2217 q i )(r2 \u2212 s\u2217 q i )/s\u2217\n\n(94)\n(95)\n\nfor 0 \u2264 i \u2264 d, and\n\nfor 1 \u2264 i \u2264 d. We assume q, h, h\u2217 , s, s\u2217 , r1 , r2 are nonzero scalars in the algebraic closure of K, and that r1 r2 = ss\u2217 q d+1 . To avoid degenerate situations we assume none of\nq i , r1 q i , r2 q i , s\u2217 q i /r1 , s\u2217 q i /r2 is equal to 1 for 1 \u2264 i \u2264 d and neither of sq i , s\u2217 q i is equal to 1\nfor 2 \u2264 i \u2264 2d. By [9, Theorem 1.9] there exists a Leonard system \u03a6 over K that has parameter array (\u03b8i , \u03b8i\u2217 , i = 0..d; \u03c6j , \u03c6j , j = 1..d). Let the scalars bi , ci for \u03a6 be as in Definition\n11.1. Applying Theorem 17.7 to \u03a6 we find\nh(1 \u2212 q \u2212d )(1 \u2212 r1 q)(1 \u2212 r2 q)\n,\n1 \u2212 s\u2217 q 2\nh(1 \u2212 q i\u2212d )(1 \u2212 s\u2217 q i+1 )(1 \u2212 r1 q i+1 )(1 \u2212 r2 q i+1 )\n(1 \u2264 i \u2264 d \u2212 1),\n=\n(1 \u2212 s\u2217 q 2i+1 )(1 \u2212 s\u2217 q 2i+2 )\nh(1 \u2212 q i )(1 \u2212 s\u2217 q i+d+1 )(r1 \u2212 s\u2217 q i )(r2 \u2212 s\u2217 q i )\n=\n(1 \u2264 i \u2264 d \u2212 1),\ns\u2217 q d (1 \u2212 s\u2217 q 2i )(1 \u2212 s\u2217 q 2i+1 )\nh(1 \u2212 q d )(r1 \u2212 s\u2217 q d )(r2 \u2212 s\u2217 q d )\n=\n.\ns\u2217 q d (1 \u2212 s\u2217 q 2d )\n\nb0 =\nbi\nci\ncd\n\nPick integers i, j (0 \u2264 i, j \u2264 d). Applying Theorem 17.4 to \u03a6 we find\nui (\u03b8j ) =\n\nd\nX\n(q \u2212i ; q)n (s\u2217 q i+1 ; q)n (q \u2212j ; q)n (sq j+1 ; q)n q n\nn=0\n\n(r1 q; q)n (r2 q; q)n (q \u2212d ; q)n (q; q)n\n\n,\n\n(96)\n\nwhere\n(a; q)n := (1 \u2212 a)(1 \u2212 aq)(1 \u2212 aq 2 ) * * * (1 \u2212 aq n\u22121 )\n\nn = 0, 1, 2 . . .\n\nBasic hypergeometric series are defined in [4, p. 4]. From that definition we find the sum on\nthe right in (96) is the basic hypergeometric series\n\u0013\n\u0012 \u2212i \u2217 i+1 \u2212j\nq , s q , q , sq j+1\nq, q .\n(97)\n4 \u03c63\nr1 q, r2 q, q \u2212d\n36\n\n\fA definition of the q-Racah polynomials can be found in [2] or [6]. Comparing this definition\nwith (96), (97) and recalling r1 r2 = ss\u2217 q d+1 , we find the ui are the q-Racah polynomials. Let\nthe scalar \u03bd for \u03a6 be as in Definition 9.3. Applying Theorem 17.10 to \u03a6 we find\n\u03bd=\n\n(sq 2 ; q)d (s\u2217 q 2 ; q)d\n.\nr1d q d (sq/r1 ; q)d (s\u2217 q/r1 ; q)d\n\nLet the scalars ki for \u03a6 be as in Definition 12.1. Applying Theorem 17.11 to \u03a6 we obtain\nki =\n\n(r1 q; q)i (r2 q; q)i (q \u2212d ; q)i (s\u2217 q; q)i (1 \u2212 s\u2217 q 2i+1 )\nsi q i (q; q)i (s\u2217 q/r1 ; q)i (s\u2217 q/r2 ; q)i (s\u2217 q d+2 ; q)i (1 \u2212 s\u2217 q)\n\n(0 \u2264 i \u2264 d).\n\nLet the scalars mi for \u03a6 be as in Definition 9.1. Applying Theorem 17.12 to \u03a6 we find\n(r1 q; q)i (r2 q; q)i (q \u2212d ; q)i (sq; q)i (1 \u2212 sq 2i+1 )\nmi = \u2217i i\ns q (q; q)i (sq/r1 ; q)i (sq/r2 ; q)i (sq d+2 ; q)i (1 \u2212 sq)\u03bd\n\n19\n\n(0 \u2264 i \u2264 d).\n\nA characterization of Leonard systems\n\nIn [9, Appendix A] we mentioned that the concept of a Leonard system can be viewed as a\n\"linear algebraic version\" of the polynomial system which D. Leonard considered in [7]. In\nthat appendix we outlined a correspondence that supports this view but we gave no proof.\nIn this section we provide the proof.\nWe recall some results from earlier in the paper. Let \u03a6 denote the Leonard system from\nDefinition 3.2. Let the polynomials p0 , p1 , . . . , pd+1 be as in Definition 8.1 and recall p\u22170 , p\u22171 ,\n. . . , p\u2217d+1 are the corresponding polynomials for \u03a6\u2217 . For the purpose of this section, we call\np0 , p1 , . . . , pd+1 the monic polynomial sequence (or MPS) of \u03a6. We call p\u22170 , p\u22171 , . . . , p\u2217d+1 the\ndual MPS of \u03a6. By Definition 8.1 we have\n\n\u03bbpi\n\u03bbp\u2217i\n\np0 = 1,\np\u22170 = 1,\n= pi+1 + ai pi + xi pi\u22121\n(0 \u2264 i \u2264 d),\n\u2217\n\u2217 \u2217\n\u2217 \u2217\n= pi+1 + ai pi + xi pi\u22121\n(0 \u2264 i \u2264 d),\n\n(98)\n(99)\n(100)\n\nwhere x0 , x\u22170 , p\u22121 , p\u2217\u22121 are all zero, and where\nai = tr(Ei\u2217 A),\n\u2217\nxi = tr(Ei\u2217 AEi\u22121\nA),\n\na\u2217i = tr(Ei A\u2217 )\nx\u2217i = tr(Ei A\u2217 Ei\u22121 A\u2217 )\n\n(0 \u2264 i \u2264 d),\n(1 \u2264 i \u2264 d).\n\nBy Lemma 7.2(iii) we have\nxi 6= 0,\n\nx\u2217i 6= 0\n\n(1 \u2264 i \u2264 d).\n\n(101)\n\nLet \u03b80 , \u03b81 , . . . , \u03b8d (resp. \u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 ) denote the eigenvalue sequence (resp. dual eigenvalue\nsequence) of \u03a6, and recall\n\u03b8i 6= \u03b8j ,\n\n\u03b8i\u2217 6= \u03b8j\u2217\n\nif i 6= j,\n37\n\n(0 \u2264 i, j \u2264 d).\n\n(102)\n\n\fBy Theorem 8.5(ii) we have\np\u2217d+1 (\u03b8i\u2217 ) = 0\n\npd+1 (\u03b8i ) = 0,\n\n(0 \u2264 i \u2264 d).\n\n(103)\n\nBy Theorem 11.4 we have\npi (\u03b80 ) 6= 0,\n\np\u2217i (\u03b80\u2217 ) 6= 0\n\n(0 \u2264 i \u2264 d).\n\n(104)\n\nBy Theorem 14.9 we have\np\u2217j (\u03b8i\u2217 )\npi (\u03b8j )\n= \u2217 \u2217\npi (\u03b80 )\npj (\u03b80 )\n\n(0 \u2264 i, j \u2264 d).\n\n(105)\n\nIn the following theorem we show the equations (98)\u2013(105) characterize the Leonard systems.\nTheorem 19.1 Let d denote a nonnegative integer. Given polynomials\np0 , p1 , . . . , pd+1 ,\np\u22170 , p\u22171 , . . . , p\u2217d+1\n\n(106)\n(107)\n\nin K[\u03bb] satisfying (98)\u2013(101) and given scalars\n\u03b80 , \u03b81 , . . . , \u03b8d ,\n\u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217\n\n(108)\n(109)\n\nin K satisfying (102)\u2013(105), there exists a Leonard system \u03a6 over K that has MPS (106),\ndual MPS (107), eigenvalue sequence (108) and dual eigenvalue sequence (109). The system\n\u03a6 is unique up to isomorphism of Leonard systems.\nProof: We abbreviate V\n\uf8eb\na0\n\uf8ec 1\n\uf8ec\n\uf8ec\nA := \uf8ec\n\uf8ec\n\uf8ec\n\uf8ed\n0\n\n= Kd+1 . Let A and A\u2217 denote the following matrices in Matd+1 (K):\n\uf8f6\nx1\n0\n\uf8f7\na1 x2\n\uf8f7\n\uf8f7\n1 * *\n\uf8f7,\nA\u2217 := diag(\u03b80\u2217 , \u03b81\u2217 , . . . , \u03b8d\u2217 ).\n\uf8f7\n* * *\n\uf8f7\n* * xd \uf8f8\n1 ad\n\nWe show the pair A, A\u2217 is a Leonard pair on V . To do this we apply Definition 1.1. Observe\nthat A is irreducible tridiagonal and A\u2217 is diagonal. Therefore condition (i) of Definition 1.1\nis satisfied by the basis for V consisting of the columns of I, where I denotes the identity\nmatrix in Matd+1 (K). To verify condition (ii) of Definition 1.1, we display an invertible\nmatrix X such that X \u22121 AX is diagonal and X \u22121 A\u2217 X is irreducible tridiagonal. Let X\ndenote the matrix in Matd+1 (K) that has entries\npi (\u03b8j )p\u2217j (\u03b80\u2217 )\nx1 x2 * * * xi\np\u2217j (\u03b8i\u2217 )pi (\u03b80 )\n=\nx1 x2 * * * xi\n\nXij =\n\n38\n\n(110)\n(111)\n\n\f0 \u2264 i, j \u2264 d. The matrix X is invertible since it is essentially Vandermonde. Using (99) and\n(110) we find AX = XH where H = diag(\u03b80 , \u03b81 , . . . , \u03b8d ). Apparently X \u22121 AX is equal to H\nand is therefore diagonal. Using (100) and (111) we find A\u2217 X = XH \u2217 where\n\uf8eb \u2217 \u2217\n\uf8f6\na0 x1\n0\n\uf8ec 1 a\u22171 x\u22172\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\n\uf8f7\n1 * *\n\u2217\n\uf8ec\n\uf8f7.\nH := \uf8ec\n\uf8f7\n*\n*\n*\n\uf8ec\n\uf8f7\n\u2217\n\uf8ed\n* * xd \uf8f8\n0\n1 a\u2217d\nApparently X \u22121 A\u2217 X is equal to H \u2217 and is therefore irreducible tridiagonal. Now condition\n(ii) of Definition 1.1 is satisfied by the basis for V consisting of the columns of X. We have\nnow shown the pair A, A\u2217 is a Leonard pair on V . Pick an integer j (0 \u2264 j \u2264 d). Using\nX \u22121 AX = H we find \u03b8j is the eigenvalue of A associated with column j of X. From the\ndefinition of A\u2217 we find \u03b8j\u2217 is the eigenvalue of A\u2217 associated with column j of I. Let Ej\n(resp. Ej\u2217 ) denote the primitive idempotent of A (resp. A\u2217 ) for \u03b8j (resp. \u03b8j\u2217 ). From our\nabove comments the sequence \u03a6 := (A; A\u2217 ; {Ei }di=0 ; {Ei\u2217 }di=0 ) is a Leonard system. From\nthe construction \u03a6 is over K. We show (106) is the MP S of \u03a6. To do this is suffices to\n\u2217\nshow ai = tr(Ei\u2217 A) for 0 \u2264 i \u2264 d and xi = tr(Ei\u2217 AEi\u22121\nA) for 1 \u2264 i \u2264 d. Applying Lemma\n7.2(i),(ii) to \u03a6 (with vi = column i of I, B = A) we find ai = tr(Ei\u2217 A) for 0 \u2264 i \u2264 d and\n\u2217\nxi = tr(Ei\u2217 AEi\u22121\nA) for 1 \u2264 i \u2264 d. Therefore (106) is the MP S of \u03a6. We show (107) is\nthe dual MP S of \u03a6. Applying Lemma 7.2(i),(ii) to \u03a6\u2217 (with vi = column i of X, B = H \u2217 )\nwe find a\u2217i = tr(Ei A\u2217 ) for 0 \u2264 i \u2264 d and x\u2217i = tr(Ei A\u2217 Ei\u22121 A\u2217 ) for 1 \u2264 i \u2264 d. Therefore\n(107) is the dual MP S of \u03a6. From the construction we find (108) (resp. (109)) is the eigenvalue sequence (resp. dual eigenvalue sequence) of \u03a6. We show \u03a6 is uniquely determined\nby (106)\u2013(109) up to isomorphism of Leonard systems. Recall that \u03a6 is determined up to\nisomorphism of Leonard systems by its own parameter array. We show the parameter array\nof \u03a6 is determined by (106)\u2013(109). Recall the parameter array consists of the eigenvalue sequence, the dual eigenvalue sequence, the first split sequence and the second split sequence.\nWe mentioned earlier that the eigenvalue sequence of \u03a6 is (108) and the dual eigenvalue\nsequence of \u03a6 is (109). By Lemma 17.5 the first split sequence of \u03a6 is determined by (106)\u2013\n(109). By this and Theorem 17.9 we find the second split sequence of \u03a6 is determined by\n(106)\u2013(109). We have now shown the parameter array of \u03a6 is determined by (106)\u2013(109).\nWe now see that \u03a6 is uniquely determined by (106)\u2013(109) up to isomorphism of Leonard\nsystems.\n\u0003\n\n20\n\nAcknowledgment\n\nThe author would like to thank Brian Hartwig and Darren Neubauer for giving this paper a\nclose reading and offering many valuable suggestions.\n\n39\n\n\fReferences\n[1] G.E. Andrews, R. Askey, R. Roy. Special functions. Encyclopedia of Mathematics and\nits Applications, 71. Cambridge University Press, Cambridge, 1999.\n[2] R. Askey and J.A. Wilson. A set of orthogonal polynomials that generalize the Racah\ncoefficients or 6 \u2212 j symbols. SIAM J. Math. Anal., 10:1008\u20131016, 1979.\n[3] E. Bannai and T. Ito. Algebraic Combinatorics I: Association Schemes.\njamin/Cummings, London, 1984.\n\nBen-\n\n[4] G. Gasper and M. Rahman. Basic hypergeometric series. Encyclopedia of Mathematics\nand its Applications, 35. Cambridge University Press, Cambridge, 1990.\n[5] T. Ito, K. Tanabe, and P. Terwilliger. Some algebra related to P - and Q-polynomial\nassociation schemes. Codes and Association Schemes (Piscataway NJ, 1999), Amer.\nMath. Soc., Providence RI, 56:167\u2013192, 2001.\n[6] R. Koekoek and R. Swarttouw. The Askey-scheme of hypergeometric orthogonal polyomials and its q-analog, volume 98-17 of Reports of the faculty of Technical Mathematics\nand Informatics. Delft, The Netherlands, 1998.\n[7] D. Leonard. Orthogonal polynomials, duality, and association schemes. SIAM J. Math.\nAnal., 13(4):656\u2013663, 1982.\n[8] J. J. Rotman. Advanced modern algebra. Prentice Hall, Saddle River NJ 2002.\n[9] P. Terwilliger. Two linear transformations each tridiagonal with respect to an eigenbasis\nof the other. Linear Algebra Appl., 330:149\u2013203, 2001.\n[10] P. Terwilliger. Two relations that generalize the q-Serre relations and the Dolan-Grady\nrelations. Physics and combinatorics 1999 (Nagoya), World Scientific Publishing, River\nEdge, NJ, 2001\n[11] P. Terwilliger. Leonard pairs from 24 points of view. Rocky mountain Journal of\nMathematics., 32(2):827\u2013888, 2002.\n[12] P. Terwilliger. Two linear transformations each tridiagonal with respect to an eigenbasis\nof the other: the T D-D and the LB-UB canonical form. Preprint.\n[13] P. Terwilliger. Introduction to Leonard pairs. OPSFA Rome 2001. J. Comput. Appl.\nMath., 153(2):463\u2013475, 2003.\n[14] P. Terwilliger. Introduction to Leonard pairs and Leonard systems. S\u016brikaisekikenky\u016bsho\nK\u014dky\u016broku, (1109):67\u201379, 1999. Algebraic combinatorics (Kyoto, 1999).\n[15] P. Terwilliger. Two linear transformations each tridiagonal with respect to an eigenbasis\nof the other: comments on the split decomposition. Preprint.\n\n40\n\n\f[16] P. Terwilliger. Two linear transformations each tridiagonal with respect to an eigenbasis\nof the other: comments on the parameter array. Geometric and Algebraic Combinatorics\n2, Oisterwijk, The Netherlands 2002. Submitted.\nPaul Terwilliger\nDepartment of Mathematics\nUniversity of Wisconsin\n480 Lincoln Drive\nMadison, Wisconsin, 53706 USA\nemail: terwilli@math.wisc.edu\n\n41\n\n\f"}