{"id": "http://arxiv.org/abs/0811.1374v1", "guidislink": true, "updated": "2008-11-09T21:31:48Z", "updated_parsed": [2008, 11, 9, 21, 31, 48, 6, 314, 0], "published": "2008-11-09T21:31:48Z", "published_parsed": [2008, 11, 9, 21, 31, 48, 6, 314, 0], "title": "Localized linear polynomial operators and quadrature formulas on the\n  sphere", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0811.0438%2C0811.4699%2C0811.0067%2C0811.2026%2C0811.4167%2C0811.2849%2C0811.1237%2C0811.0177%2C0811.1299%2C0811.4754%2C0811.2678%2C0811.1826%2C0811.4005%2C0811.1605%2C0811.3233%2C0811.0771%2C0811.1327%2C0811.1038%2C0811.4533%2C0811.0781%2C0811.3908%2C0811.2974%2C0811.2374%2C0811.2736%2C0811.2780%2C0811.0769%2C0811.3893%2C0811.2032%2C0811.2268%2C0811.4090%2C0811.1984%2C0811.3931%2C0811.0190%2C0811.1212%2C0811.1307%2C0811.4250%2C0811.1374%2C0811.4561%2C0811.2602%2C0811.0353%2C0811.4710%2C0811.0898%2C0811.1608%2C0811.3561%2C0811.4584%2C0811.0920%2C0811.1863%2C0811.1467%2C0811.1120%2C0811.4406%2C0811.0493%2C0811.3874%2C0811.3520%2C0811.0700%2C0811.2650%2C0811.2481%2C0811.2557%2C0811.0937%2C0811.4648%2C0811.3268%2C0811.2265%2C0811.1750%2C0811.3022%2C0811.1002%2C0811.2042%2C0811.0527%2C0811.1699%2C0811.2941%2C0811.4684%2C0811.2257%2C0811.0452%2C0811.0555%2C0811.2356%2C0811.0680%2C0811.2626%2C0811.1852%2C0811.4574%2C0811.0816%2C0811.4494%2C0811.3155%2C0811.2832%2C0811.3301%2C0811.0880%2C0811.2004%2C0811.2660%2C0811.3960%2C0811.2757%2C0811.3683%2C0811.0660%2C0811.3543%2C0811.0327%2C0811.4120%2C0811.4179%2C0811.3713%2C0811.4587%2C0811.0350%2C0811.3684%2C0811.1037%2C0811.2593%2C0811.4646%2C0811.4345&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Localized linear polynomial operators and quadrature formulas on the\n  sphere"}, "summary": "The purpose of this paper is to construct universal, auto--adaptive,\nlocalized, linear, polynomial (-valued) operators based on scattered data on\nthe (hyper--)sphere $\\SS^q$ ($q\\ge 2$). The approximation and localization\nproperties of our operators are studied theoretically in deterministic as well\nas probabilistic settings. Numerical experiments are presented to demonstrate\ntheir superiority over traditional least squares and discrete Fourier\nprojection polynomial approximations. An essential ingredient in our\nconstruction is the construction of quadrature formulas based on scattered\ndata, exact for integrating spherical polynomials of (moderately) high degree.\nOur formulas are based on scattered sites; i.e., in contrast to such well known\nformulas as Driscoll--Healy formulas, we need not choose the location of the\nsites in any particular manner. While the previous attempts to construct such\nformulas have yielded formulas exact for spherical polynomials of degree at\nmost 18, we are able to construct formulas exact for spherical polynomials of\ndegree 178.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0811.0438%2C0811.4699%2C0811.0067%2C0811.2026%2C0811.4167%2C0811.2849%2C0811.1237%2C0811.0177%2C0811.1299%2C0811.4754%2C0811.2678%2C0811.1826%2C0811.4005%2C0811.1605%2C0811.3233%2C0811.0771%2C0811.1327%2C0811.1038%2C0811.4533%2C0811.0781%2C0811.3908%2C0811.2974%2C0811.2374%2C0811.2736%2C0811.2780%2C0811.0769%2C0811.3893%2C0811.2032%2C0811.2268%2C0811.4090%2C0811.1984%2C0811.3931%2C0811.0190%2C0811.1212%2C0811.1307%2C0811.4250%2C0811.1374%2C0811.4561%2C0811.2602%2C0811.0353%2C0811.4710%2C0811.0898%2C0811.1608%2C0811.3561%2C0811.4584%2C0811.0920%2C0811.1863%2C0811.1467%2C0811.1120%2C0811.4406%2C0811.0493%2C0811.3874%2C0811.3520%2C0811.0700%2C0811.2650%2C0811.2481%2C0811.2557%2C0811.0937%2C0811.4648%2C0811.3268%2C0811.2265%2C0811.1750%2C0811.3022%2C0811.1002%2C0811.2042%2C0811.0527%2C0811.1699%2C0811.2941%2C0811.4684%2C0811.2257%2C0811.0452%2C0811.0555%2C0811.2356%2C0811.0680%2C0811.2626%2C0811.1852%2C0811.4574%2C0811.0816%2C0811.4494%2C0811.3155%2C0811.2832%2C0811.3301%2C0811.0880%2C0811.2004%2C0811.2660%2C0811.3960%2C0811.2757%2C0811.3683%2C0811.0660%2C0811.3543%2C0811.0327%2C0811.4120%2C0811.4179%2C0811.3713%2C0811.4587%2C0811.0350%2C0811.3684%2C0811.1037%2C0811.2593%2C0811.4646%2C0811.4345&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The purpose of this paper is to construct universal, auto--adaptive,\nlocalized, linear, polynomial (-valued) operators based on scattered data on\nthe (hyper--)sphere $\\SS^q$ ($q\\ge 2$). The approximation and localization\nproperties of our operators are studied theoretically in deterministic as well\nas probabilistic settings. Numerical experiments are presented to demonstrate\ntheir superiority over traditional least squares and discrete Fourier\nprojection polynomial approximations. An essential ingredient in our\nconstruction is the construction of quadrature formulas based on scattered\ndata, exact for integrating spherical polynomials of (moderately) high degree.\nOur formulas are based on scattered sites; i.e., in contrast to such well known\nformulas as Driscoll--Healy formulas, we need not choose the location of the\nsites in any particular manner. While the previous attempts to construct such\nformulas have yielded formulas exact for spherical polynomials of degree at\nmost 18, we are able to construct formulas exact for spherical polynomials of\ndegree 178."}, "authors": ["Q. T. Le Gia", "H. N. Mhaskar"], "author_detail": {"name": "H. N. Mhaskar"}, "author": "H. N. Mhaskar", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1137/060678555", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0811.1374v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0811.1374v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "24 pages 2 figures, accepted for publication in SIAM J. Numer. Anal", "arxiv_primary_category": {"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.CA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "65D32; 41A10; 41A25", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0811.1374v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0811.1374v1", "journal_reference": null, "doi": "10.1137/060678555", "fulltext": "arXiv:0811.1374v1 [math.NA] 9 Nov 2008\n\nLocalized linear polynomial operators and quadrature formulas\non the sphere\nQ. T. Le Gia\u2217\nSchool of Mathematics, University of New South Wales,\nSydney, NSW 2052, Australia\nqlegia@maths.unsw.edu.au\nH. N. Mhaskar\u2020\nDepartment of Mathematics, California State University\nLos Angeles, California, 90032, U.S.A.\nhmhaska@calstatela.edu\n\nAbstract\nThe purpose of this paper is to construct universal, auto\u2013adaptive, localized, linear, polynomial\n(-valued) operators based on scattered data on the (hyper\u2013)sphere Sq (q \u2265 2). The approximation and localization properties of our operators are studied theoretically in deterministic as well as\nprobabilistic settings. Numerical experiments are presented to demonstrate their superiority over\ntraditional least squares and discrete Fourier projection polynomial approximations. An essential\ningredient in our construction is the construction of quadrature formulas based on scattered data,\nexact for integrating spherical polynomials of (moderately) high degree. Our formulas are based on\nscattered sites; i.e., in contrast to such well known formulas as Driscoll\u2013Healy formulas, we need not\nchoose the location of the sites in any particular manner. While the previous attempts to construct\nsuch formulas have yielded formulas exact for spherical polynomials of degree at most 18, we are able\nto construct formulas exact for spherical polynomials of degree 178.\n\nKeywords: Quadrature formulas, localized kernels, polynomial quasi\u2013interpolation, learning theory on\nthe sphere.\nAMS classification: 65D32, 41A10, 41A25\n\n1\n\nIntroduction\n\nThe problem of approximation of functions on the sphere arises in almost all applications involving\nmodeling of data collected on the surface of the earth. More recent applications such as manifold matching\nand neural networks lead to the approximation of functions on the unit sphere Sq embedded in the\nEuclidean space Rq+1 for integers q \u2265 3 as well. Various applications in learning theory, meteorology,\ncosmology, and geophysics require analysis of scattered data collected on the sphere [7, 8, 9]. This means\nthat the data is of the form {(\u03be, f (\u03be))} for some unknown function f : Sq \u2192 R, where one has no control\non the choice of the sites \u03be.\nThere are many methods to model such data: spherical splines, radial basis functions (called zonal\nfunction networks in this context), etc. However, the most traditional method is to approximate by\n\u2217 The\n\nresearch of this author was supported by Australian Research Council under its Centres of Excellence Program.\nresearch of this author was supported, in part, by grant DMS-0605209 from the National Science Foundation and\ngrant W911NF-04-1-0339 from the U.S. Army Research Office.\n\u2020 The\n\n1\n\n\fspherical polynomials; i.e., restrictions of algebraic polynomials in q + 1 variables to Sq . Apart from\ntradition, some important advantages of polynomials are that they are eigenfunctions of many pseudo\u2013\ndifferential operators which arise in practical applications, and that they are infinitely smooth. Unlike\nin the case of spline approximation with a given degree of the piecewise component polynomials, global\npolynomial approximation does not exhibit a saturation property [2, Section 2, Chapter 11]; i.e., for\nan arbitrary sequence \u03b4n \u2193 0, it is possible to find a continuous function on the sphere, not itself a\npolynomial, which can be approximated by spherical polynomials of degree at most n uniformly within\n\u03b4n , n \u2265 1. In [20, 19], we have shown how a good polynomial approximation yields also a good zonal\nfunction network approximation. In [22], we have shown that the approximation spaces determined by\nzonal function network approximation are the same as those determined by polynomial approximations.\nTo illustrate the issues to be discussed in this paper, we consider an example in the case q = 1,\nor equivalently, the case of 2\u03c0\u2013periodic functions on the real line. In this discussion only, let f (x) =\n| cos x|1/4 , x \u2208 R. In Figure 1(left), we show the log-plot of the absolute errors between f and its\n(trigonometric) Fourier projection of order 31, where the Fourier coefficients are estimated by a 128 point\nDFT. In Figure 1(right), we show a similar log\u2013plot where the Fourier projection is replaced by a suitable\nsummability operator (described more precisely in (3.1)), yielding again a trigonometric polynomial of\norder 31. It is clear that our summability operator is far more localized than the Fourier projection; i.e.,\nthe error in approximation decreases more rapidly as one goes away from the singularities at \u03c0/2 and\n3\u03c0/2. The maximum error on [3\u03c0/4, 5\u03c0/4] is 0.0103 for the projection, 0.0028 for our operator. Out\nof the 2048 points considered for the test, the error by the summability operator is less than 10\u22123 at\n38.96% points, the corresponding percentage for the projection is only 4.88%. In contrast to free\u2013knot\nspline approximation, our summability operator is universal; i.e., its construction (convolution with a\nkernel) does not require any a priori knowledge about the location of singularities of the target function.\nIt yields a single, globally defined trigonometric polynomial, computed using global data. Nevertheless,\nit is auto\u2013adaptive, in the sense that the error in approximation on different subintervals adjusts itself\naccording to the smoothness of the target function on these subintervals. In [23, 24], we have given a\nvery detailed analysis of the approximation properties of these operators in the case q = 1.\n\u22120.5\n\n\u22120.5\n\n\u22121\n\u22121\n\u22121.5\n\n\u22122\n\u22121.5\n\u22122.5\n\n\u22122\n\n\u22123\n\n\u22123.5\n\u22122.5\n\u22124\n\n\u22124.5\n\u22123\n\u22125\n\n\u22123.5\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\n1.2\n\n1.4\n\n1.6\n\n1.8\n\n2\n\n\u22125.5\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\n1.2\n\n1.4\n\n1.6\n\n1.8\n\n2\n\nFigure 1: The log\u2013plot of the absolute error between the function x 7\u2192 | cos x|1/4 , and (left) its Fourier\nprojection (right) trigonometric polynomial obtained by our summability operator, where the Fourier\ncoefficients are estimated by 128 point FFT. The order of the trigonometric polynomials is 31 in each\ncase. The numbers on the x axis are in multiples of \u03c0, the actual absolute errors are 10y .\nOur computation based on a 128 point DFT implies that the values of the function are available at\n128 equidistant points. If only a scattered data is available, the following method is often used (especially\nin the context of approximation on the sphere) to estimate the values needed for the DFT. For each\npoint \u03be, we consider the nearest point of the form 2\u03c0k/128, and imagine that the value of f at this point\nis f (\u03be), taking averages in the case of multiplicities, and interpolating in the case of gaps. If we use\nour summability operator, estimating the Fourier coefficients in this way, then the maximum error on\n[3\u03c0/4, 5\u03c0/4] is 0.0357, and the proportion of points where the error is less than 10\u22123 is 7.08%. It is clear\nthat a careful construction of quadrature formulas is essential to obtain good approximation results.\nThe purpose of this paper is to construct universal, auto\u2013adaptive, localized, linear, polynomial (2\n\n\fvalued) operators based on scattered data on Sq (q \u2265 2) and to analyse their approximation properties. An\nessential ingredient in our construction is the construction of quadrature formulas based on scattered data,\nexact for integrating spherical polynomials of (moderately) high degree, and satisfying certain technical\nconditions known as the Marcinkiewicz\u2013Zygmund (M\u2013Z) conditions. Our construction is different from\nthe usual construction of quadrature formulas (designs) studied in numerical analysis, where one has a\nchoice of the placement of nodes. In [21], we had proved the existence of such quadrature formulas for\nscattered data. However, previous efforts to compute such formulas did not yield exactness beyond degree\n18 polynomials. This was a severe limitation on the practical applications of our theoretical constructions.\nWe will show that a very simple idea of solving a system of equations involving a Gram matrix yields\nsurprisingly good results, in particular, quadrature formulas exact for integrating polynomials of degree\nas high as 178. Gram matrices are typically ill\u2013conditioned. However, we will show both theoretically\nand numerically that the ones which we use are, in fact, very well conditioned. We will introduce another\nalgorithm of theoretical interest to compute data dependent orthogonal polynomials, and use these to\ncompute the quadrature formulas in a memory efficient manner. To the best of our knowledge, this is\nthe first effort to extend the univariate constructions in Gautschi's book [11] to a multivariate setting.\nConsidering that computation of classical spherical harmonics is a very delicate task, requiring many\ntricks based on the special function properties of these polynomials for a stable computation, it is not\nexpected that our computation of data dependent orthogonal polynomials with no such special function\nproperties would be stable. In describing this algorithm, we hope to stimulate further research in this\ninteresting direction. We note that even if this algorithm is not as stable for high degrees as the other\nalgorithm, it yields satisfactory quadrature formulas exact for integrating polynomials of degree 32. Most\nimportantly, our new found ability to compute quadrature formulas for moderately high degrees allows\nus to offer our operators as a viable, practical method of approximation, even superior to the commonly\nused methods of least squares and Fourier projection as far as localized approximation is concerned.\nAn additional problem is when the available values of the target function are noisy. One may assume\nthat the noise is an additive random variable with mean zero. It is also routine in learning theory to\nassume that the random variables have a bounded range. This assumption is usually satisfied with a high\nprobability even if the random variables do not actually have a bounded range. However, one does not\ntypically know the actual distribution of these random variables. We obtain probabilistic estimates in\nthis setting on the global and local approximations by our operators. To underline the practical utility\nof our operators, we use them for modelling the MAGSAT data supplied to us by Dr. Thorsten Maier,\nobtaining results comparable to those obtained by other techniques.\nIn Section 2, we review certain facts about spherical polynomials, the existence of quadrature formulas\nto integrate these, a few properties of the quadrature weights, and certain polynomial kernels which we will\nneed throughout the paper. In Section 3, we study the approximation properties of the linear polynomial\noperators. The new results here are Theorems 3.1 and 3.2. The first parts of these theorems were proved\nessentially in [18], but not stated in the form given here. In order to apply these operators in practice, one\nneeds quadrature formulas exact for high degree spherical polynomials. Explicit algorithms to construct\nsuch formulas are described in Section 4. The new results in this section are Theorems 4.1 and 4.2.\nNumerical results are presented in Section 5, and the proofs of all new results are given in Section 6. The\npaper is a result of a long process, involving discussions with a number of mathematicians. In particular,\nit is our pleasure to acknowledge the support and encouragement of Mahadevan Ganesh, Thorsten Maier,\nVolker Michel, Dominik Michel, Ian Sloan, and Joe Ward. We are also grateful to the two referees and\nFred Hickernell for their many useful suggestions for the improvement of the first draft of this paper.\n\n2\n\nBackground\n\nIn this section, we review some known results regarding spherical polynomials and localized polynomial\nkernels.\n3\n\n\f2.1\n\nSpherical polynomials\n\nLet q \u2265 1 be an integer, Sq be thePunit sphere embedded in the Euclidean space Rq+1 ; i.e.,\nq+1 2\nSq := {(x1 , . . . , xq+1 ) \u2208 Rq+1 :\nk=1 xk = 1}, and \u03bcq be its Lebesgue surface measure, normalized so\n2\u03c0 (q+1)/2\nthat \u03bcq (Sq ) = 1. The surface area of Sq is\n. For \u03b4 > 0, a spherical cap with radius \u03b4 and\n\u0393((q + 1)/2)\nq\ncenter x0 \u2208 S is defined by\nSq\u03b4 (x0 ) := {x \u2208 Sq : arccos(x * x0 ) \u2264 \u03b4}.\nIf 1 \u2264 p \u2264 \u221e, and f : Sq \u2192 R is measurable, we write\n\u001a R\n{ Sq |f (x)|p d\u03bcq (x)}1/p , if 1 \u2264 p < \u221e,\nkf kp :=\ness supx\u2208Sq |f (x)|,\nif p = \u221e.\nThe space of all Lebesgue measurable functions on Sq such that kf kp < \u221e will be denoted by Lp , with\nthe usual convention that two functions are considered equal as elements of this space if they are equal\nalmost everywhere. The symbol C(Sq ) denotes the class of all continuous, real valued functions on Sq ,\nequipped with the norm k \u25e6 k\u221e .\nFor a real number x \u2265 0, let \u03a0qx denote the class of all spherical polynomials of degree at most x.\n(This is the same as the class \u03a0qn , where n is the largest integer not exceeding x. However, our extension\nof the notation allows us, for example, to use the simpler notation \u03a0qn/2 rather than the more cumbersome\nnotation \u03a0q\u230an/2\u230b .) For a fixed integer l \u2265 0, the restriction to Sq of a homogeneous harmonic polynomial\nof exact degree l is called a spherical harmonic of degree l. Most of the following information is based\non [25], [32, Section IV.2], and [5, Chapter XI], although we use a different notation. The class of all\nq\nspherical harmonics of degree l will be denoted by Hql . The spaces H\nl are mutually orthogonal relative\nL\nto the inner product of L2 . For any integer n \u2265 0, we have \u03a0qn = nl=0 Hql . The dimension of Hql is\ngiven by\n\u0012\n\u0013\n\uf8f1\n\uf8f4\n\uf8f2 2l + q \u2212 1 l + q \u2212 1 , if l \u2265 1,\nl+q\u22121\nl\n(2.1)\nd ql := dim Hql =\n\uf8f4\n\uf8f3\n1,\nif l = 0.\n\b\nP\nL\nn\n\u221e\nq\nq\n2\n2\nand that of \u03a0qn is l=0 d l = d q+1\nn . Furthermore, L = L \u2013closure\nl=0 Hl . Hence, if we choose an\nq\nq\northonormal basis {Yl,k : k = 1, . . . , dl } for each Hl , then the set {Yl,k : l = 0, 1, . . . and k = 1, . . . , d ql }\nis a complete orthonormal basis for L2 . One has the well-known addition formula [25] and [5, Chapter\nXI, Theorem 4]:\nq\n\ndl\nX\n\nYl,k (x)Yl,k (\u03b6) =\n\nk=1\n(q/2\u22121,q/2\u22121)\n\nwhere pl := pl\n\n2q\u22121 \u0393(q/2)2\npl (1)pl (x * \u03b6),\n\u0393(q)\n\nl = 0, 1, * * * ,\n\n(2.2)\n\nis the orthonormalized Jacobi polynomial with positive leading coefficient:\n\u001a\nZ 1\n1, if l = k,\n2 q/2\u22121\npl (t)pk (t)(1 \u2212 t )\ndt =\n0, otherwise.\n\u22121\n\nIn particular, for x \u2208 Sq , l = 0, 1, * * *,\nq\n\ndl\nX\n\nk=1\n\n2.2\n\n2\nYl,k\n(x)\n\n2q\u22121 \u0393(q/2)2\n=\npl (1)2 =\n\u0393(q)\n\nZ\n\nq\n\ndl\nX\n\nSq k=1\n\n2\nYl,k\n(\u03b6)d\u03bcq (\u03b6) = dql .\n\n(2.3)\n\nLocalized polynomial kernels\n\nLet h : [0, \u221e) \u2192 R be a compactly supported function, and t > 0. We define for u \u2208 R,\n\u221e\n2q\u22121 \u0393(q/2)2 X\nh(l/t)pl (1)pl (u)\n\u03a6t (h; u) :=\n\u0393(q)\nl=0\n\n4\n\n(2.4)\n\n\fand define \u03a6t (h; u) = 0 if t \u2264 0.\nIn the sequel, we adopt the following convention regarding constants. The letters c, c1 , * * * will denote\ngeneric, positive constants depending only on the dimension q and other such fixed quantities in the\ndiscussion as the function h, the different norms involved in the formula, etc.. Their value will be different\nat different occurrences, even within the same formula. The symbol A \u223c B will mean cA \u2264 B \u2264 c1 A.\nThe following proposition summarizes some of the important properties of the kernels defined in (2.4).\nProposition 2.1 Let S \u2265 q be an integer, h : [0, \u221e) \u2192 R be a S times iterated integral of a function of\nbounded variation, h(x) = 1 for x \u2208 [0, 1/2], h(x) = 0 for x > 1, and h be non\u2013increasing. Let x \u2208 Sq .\nWe have for every integer n \u2265 0, \u03a6n (h; \u25e6 * x) \u2208 \u03a0qn , and\nZ\n\u03a6n (h; x * \u03b6)P (\u03b6)d\u03bcq (\u03b6) = P (x),\nP \u2208 \u03a0n/2 .\n(2.5)\nFurther,\nsup\nn\u22651, \u03b6\u2208Sq\n\nZ\n\n|\u03a6n (h; \u03b6 * \u03be)|d\u03bcq (\u03be) = sup\n\n2\u03c0 q/2\nsup\n\u0393(q/2) n\u22651\n\n=\n\nZ\n\nZ\n\nn\u22651\n\n1\n\n\u22121\n\nZ\n\n|\u03a6n (h; x * \u03be)|d\u03bcq (\u03be)\n\n|\u03a6n (h; u)|(1 \u2212 u2 )q/2\u22121 du < \u221e,\n\nZ 1\n2\u03c0 q/2\n|\u03a6n (h; x * \u03be)| d\u03bcq (\u03be) =\n|\u03a6n (h; u)|2 (1 \u2212 u2 )q/2\u22121 du\n\u0393(q/2) \u22121\n\u223c nq \u223c maxq |\u03a6n (h; x * \u03be)| = |\u03a6n (h; 1)|.\n2\n\n\u03be\u2208S\n\nand for every \u03be \u2208 Sq , \u03be 6= x,\n|\u03a6n (h; x * \u03be)| \u2264 cnq\n\n(2.6)\n\n\u001a\n\n\u221a\n(n 1 \u2212 x * \u03be)1/2\u2212q/2\u2212S ,\nn\u2212S ,\n\nif 0 \u2264 x * \u03be < 1,\nif \u2212 1 \u2264 x * \u03be < 0.\n\n(2.7)\n\n(2.8)\n\nExcept for (2.7), all parts of Proposition 2.1 have been proved and verified repeatedly in [17, 18, 12, 19].\nWe will sketch a proof of this proposition, mainly to reconcile notations.\nProof of Proposition 2.1. The equation (2.5) and the first two equations in (2.6) are clear. The last\nestimate in (2.6) follows from [17, Lemma 4.6] with following choice of the parameters there: \u03b1 = \u03b2 =\nq/2 \u2212 1, h\u03bd = h(\u03bd/n), where we observe that by a repeated application of the mean value theorem,\n\u221e\nX\n\n(\u03bd + 1)s |\u2206r h(\u03bd/n)| \u2264 cns\u2212r+1 ,\n\ns \u2208 R, r, n = 1, 2, * * * ,\n\n\u03bd=0\n\nwhere \u2206r is the r\u2013th order forward difference applied with respect to \u03bd. Similarly, the estimate (2.8)\nfollows from [17, Lemma 4.10] with same parameters as above, S in place of K in [17], and y = x * \u03be (cf.\nAppendix to [12]). We prove (2.7). The first equation is a consequence of the rotation invariance of \u03bcq .\nIn view of the addition formula (2.2),\n\u03a6n (h; x * \u03be) =\n\nn\nX\n\nq\n\nh(l/n)\n\nl=0\n\ndl\nX\n\nYl,k (x)Yl,k (\u03be).\n\nk=1\n\nIt follows using (2.3) and the facts that h(l/n) = 1 for l \u2264 n/2, 0 \u2264 h(t) \u2264 1 for t \u2208 [0, \u221e), that\nZ\n\n2\n\n\u03a6n (h; x * \u03be) d\u03bcq (\u03be) =\n\nn\nX\n\nq\n\n2\n\nh(l/n)\n\nl=0\n\ndl\nX\n\nk=1\n\n5\n\n2\n\nYl,k (x) =\n\nn\nX\nl=0\n\nh(l/n)2 dql \u223c nq .\n\n(2.9)\n\n\fSimilarly, using Schwarz inequality, (2.2), (2.3), and the fact that h(l/n) \u2265 0,\n\u03a6n (h; 1) = |\u03a6n (h; x * x)| \u2264 sup |\u03a6n (h; x * \u03be)|\n\u03be\u2208Sq\n\n\u2264\n\nn\nX\n\ndql\n\nh(l/n){\n\nl=0\n\nX\n\nk=1\n\nq\n\n2 1/2\n\nYl,k (x) }\n\n{\n\ndl\nX\n\nk=1\n\nYl,k (\u03be)2 }1/2 =\n\nn\nX\n\nh(l/n)dql = \u03a6n (h; 1).\n\nl=0\n\nSince dql \u223c lq\u22121 , 0 \u2264 h(l/n) \u2264 1, and h(l/n) = 1 for l \u2264 n/2, the above two estimates lead to (2.7).\n\n\u2737\n\nIn the remainder of this paper, h will denote a fixed function satisfying the conditions of Proposition 2.1.\n\n2.3\n\nQuadrature formulas\n\nLet C be a finite set of distinct points on Sq . A quadrature formula based on C has the form Q(f ) =\nP\nf (\u03be), where w\u03be , \u03be \u2208 C, are real numbers. For integer n \u2265 0, the formula is exact for degree n if\n\u03be\u2208C w\u03be R\nP\nw\u03ben f (\u03ben ) is a sequence\nQ(P ) = Sq P d\u03bcq for all P \u2208 \u03a0qn . It is not difficult to verify that if Qn (f ) =\nR\nof quadrature formulas, with QP\nf d\u03bcq for every continuous\nn being exact with degree n, then Qn (f ) \u2192\nfunction f on Sq if and only if\n|w\u03ben | \u2264 c, with c being independent of n. In the sequel, we will assume\ntacitly that C is one of the members of a nested sequence of finite subsets of Sq , whose union is dense\nin Sq . All the constants may depend upon the whole sequence, but not on any\nPindividual member of\nthis sequence. Thus, a formula Q will be called a bounded variation formula if \u03be\u2208C |w\u03be | \u2264 c, with the\nunderstanding that this is an abbreviation for the concept described above with a sequence of quadrature\nformulas.\nDefinition 2.1 Let m \u2265 0 be an integer. The set C admits an M\u2013Z quadrature of order m if there exist\nweights w\u03be such that\nZ\nX\nP (x)d\u03bcq (x) =\nw\u03be P (\u03be),\nP \u2208 \u03a0q2m ,\n(2.10)\nSq\n\nand\n\n\u03be\u2208C\n\n\uf8f61/p\n\uf8eb\nX\n\uf8ed\n\u2264 ckP kp ,\n|w\u03be ||P (\u03be)|p \uf8f8\n\u03be\u2208C\n\nP \u2208 \u03a0q2m , 1 \u2264 p < \u221e.\n\n(2.11)\n\nThe weights w\u03be will be called M\u2013Z weights of order m. The condition (2.11) will be referred to as the\nM\u2013Z condition.\nIf C admits an M\u2013Z quadrature of order m, and {w\u03be } are the weights\nP involved, it is clear from using\n(2.11) with the polynomial identically equal to 1 in place of P that \u03be\u2208C |w\u03be | \u2264 c. Further, if \u03b6 \u2208 C,\nthen applying (2.11) with p = 2 and \u03a6m (h; \u03b6 * \u25e6) in place of P , we obtain for M\u2013Z weights of order m:\nZ\nX\n|w\u03b6 |\u03a6m (h; 1)2 \u2264\n|w\u03be |\u03a6m (h; \u03b6 * \u03be)2 \u2264 c \u03a6m (h; \u03b6 * x)2 d\u03bcq (x).\n\u03be\u2208C\n\nThe estimate (2.7) now implies that for all M\u2013Z weights {w\u03be } of order m,\n|w\u03be | \u2264 cm\u2212q ,\n\n\u03be \u2208 C.\n\n(2.12)\n\nIn [21], we proved that every finite set C \u2282 Sq admits an M\u2013Z quadrature with an order depending\nupon how dense the set C is. This density is measured in terms of the mesh norm. The mesh norm of C\nwith respect to a subset K \u2286 Sq is defined to be\n\u03b4C (K) := sup dist(x, C).\nx\u2208K\n\nThe following theorem summarizes the quadrature formula given in [21].\n6\n\n(2.13)\n\n\fTheorem 2.1 There exists a constant \u03b1q with the following property. Let C be a finite set of distinct\npoints on Sq , and m be an integer with m \u2264 \u03b1q (\u03b4C (Sq ))\u22121 . Then C admits an M\u2013Z quadrature of order\nm, and the set {w\u03be } of M\u2013Z weights may be chosen to satisfy\n|{\u03be : w\u03be 6= 0}| \u223c mq \u223c dim(\u03a0q2m ).\n\n3\n\n(2.14)\n\nPolynomial operators\n\nFor t > 0, we define the summability operator \u03c3t\u2217 by the formula\n\u03c3t\u2217 (h; f, x)\n\n=\n\nZ\n\nSq\n\nf (\u03b6)\u03a6t (h; x * \u03b6)d\u03bcq (\u03b6) =\n\n\u221e\nX\n\nq\n\nh(l/t)\n\nl=0\n\ndl\nX\n\nf\u02c6(l, k)Yl,k (x),\n\nk=1\n\nf \u2208 L1 , x \u2208 Sq .\n\n(3.1)\n\n(It is convenient, and customary in approximation theory, to use the notation \u03c3t\u2217 (h; f, x) rather than\n\u03c3t\u2217 (h; f )(x).) Although we defined the operator for L1 to underline the fact that it is a universal operator,\nwe will be interested only in its restriction to C(Sq ). If f : Sq \u2192 R is a continuous function, the degree\nof approximation of f from \u03a0qx is defined by\nEx (f ) = inf q kf \u2212 P k\u221e .\nP \u2208\u03a0x\n\nIt is well known [16, 18] that for all integer n \u2265 1, and f \u2208 C(Sq ),\nEn (f ) \u2264 kf \u2212 \u03c3n\u2217 (h; f )k\u221e \u2264 cEn/2 (f ).\n\n(3.2)\n\nFollowing [18], we now define a discretized version of these operators.\nIf C \u2282 Sq is a finite set, W = {w\u03be }\u03be\u2208C and Z = {z\u03be }\u03be\u2208C are sets of real numbers, we define the\npolynomial operator\nX\n\u03c3t (C, W; h; Z, x) :=\nw\u03be z\u03be \u03a6t (h; x * \u03be),\nt \u2208 R, x \u2208 Sq .\n(3.3)\n\u03be\u2208C\n\nIf f : Sq \u2192 R, and z\u03be = f (\u03be), \u03be \u2208 C, we will write \u03c3t (C, W; h; f, x) in place of \u03c3t (C, W; h; Z, x). In [18],\nwe had denoted these operators by \u03c3t (\u03bd; h, f ), where \u03bd is the measure that associates the mass w\u03be with\n\u03be \u2208 C. In this paper, we prefer to use the slightly expanded notation as in (3.3). If n \u2265 1 is an integer,\nC \u2282 Sq is a finite set that admits an M\u2013Z quadrature of order n, W is the set of the corresponding M\u2013Z\nweights. Then it is shown in [18, Proposition 4.1] that\nEn (f ) \u2264 kf \u2212 \u03c3n (C, W; h; f )k\u221e \u2264 cEn/2 (f ),\n\nf \u2208 C(Sq ).\n\n(3.4)\n\nIn this paper, we will be especially interested in the approximation of functions in the class Wr , r > 0,\ncomprised of functions f \u2208 C(Sq ) for which En (f ) = O(n\u2212r ), n \u2265 1. A complete characterization of the\nclasses Wr in terms of such constructive properties of its members as the number of partial derivatives\nand their moduli of smoothness is well known [26, 16]. In view of (3.2), f \u2208 Wr if and only if\nkf kWr := kf k\u221e + sup 2nr k\u03c32\u2217n (h; f ) \u2212 \u03c32\u2217n\u22121 (h; f )k\u221e < \u221e.\nn\u22651\n\nIn practical applications, the data is contaminated with noise. Therefore, we wish to examine the\nbehavior of our operators based on a data of the form {(\u03be, f (\u03be) + \u01eb\u03be )}, where \u01eb\u03be are independent random\nvariables with unknown probability distributions, each with mean 0. If the range of these random variables\nis not bounded, one can still assume that the probability of the variables going out of a sufficiently\nlarge interval is small. Hence, it is customary in learning theory to assume that the variables \u01eb\u03be have\na bounded range, so that one may use certain technical inequalities of probability theory, known as\nBennett's inequalities; see the proof of Lemma 6.2 below.\n7\n\n\fIn the statements of the theorems below, we use three parameters. The symbol M denotes the number\nof points in the data set; we assume that the set admits an M\u2013Z quadrature of order m, and the degree n\nof the polynomial approximant \u03c3n (C, W; h; f ) is determined in terms of m. For theoretical considerations\nwhere one is not concerned about the actual numerical constructions of the quadrature weights, one may\nimagine a data set C with M := |C| \u223c \u03b4C (Sq )\u2212q , and assume that the weights W are as guaranteed by\nTheorem 2.1. If so, then we may take M \u223c mq \u223c \u03b4C (Sq )\u2212q in the discussion in this section. For example,\nthe estimates (3.7) and (3.8) below can then be expressed in terms of the number of samples respectively\nas follows:\nkf \u2212 \u03c3n (C, W; h; f )k\u221e \u2264 cM \u2212r/q ,\nwith some n \u223c M 1/q ,\n(3.5)\nand\n\u0012\n\u0013\n(log M )c\nProb k\u03c3n (C, W; h; Z) \u2212 f k\u221e \u2265 c1 r/(q+2r) \u2264 c2 M \u2212c ,\nM\n\nwith some n \u223c (M/ log M )1/(2r+q) .\n(3.6)\n\nTheorem 3.1 Suppose that m \u2265 1 is an integer, C = {\u03bej }M\nj=1 admits an M\u2013Z quadrature of order m,\nand let W be the corresponding quadrature weights. Let r > 0, f \u2208 Wr , kf kWr = 1.\n(a) For integer n \u2264 m, we have\nkf \u2212 \u03c3n (C, W; h; f )k\u221e \u2264 cn\u2212r .\n(3.7)\n(b) For j = 1, * * * , M , let \u01ebj be independent random variables with mean 0 and range [\u22121, 1], Z =\n{\u01ebj + f (\u03bej )}. If A > 0 and n \u2265 1 is the greatest integer with (A + q)n2r+q log n \u2264 c3 mq , n \u2264 m, then\n\u0001\nProb k\u03c3n (C, W; h; Z) \u2212 f k\u221e \u2265 c1 n\u2212r \u2264 c2 n\u2212A .\n\n(3.8)\n\nHere, the constants c1 , c2 , c3 are independent of the distribution of the variables \u01ebj .\nWe now turn our attention to local approximation by our operators. In the sequel, if K \u2286 Sq ,\nf : K \u2192 R, then kf k\u221e,K := supx\u2208K |f (x)|. If x0 \u2208 Sq , a function f is defined to be r\u2013smooth at x0 if\nthere is a spherical cap Sq\u03b4 (x0 ) such that f \u03c6 \u2208 Wr for every infinitely differentiable function \u03c6 supported\non Sq\u03b4 (x0 ). We have proved in [18, Theorem 3.3] that f is r\u2013smooth at a point x0 if and only if there is\na cap Sq\u03b4 (x0 ) such that\nk\u03c32\u2217n (h; f ) \u2212 \u03c32\u2217n\u22121 (h; f )k\u221e,Sq\u03b4 (x0 ) = O(2\u2212nr ).\nAccordingly, if K is a spherical cap, we may define the class Wr (K) to consist of f \u2208 C(Sq ), for which\nkf kWr (K) := kf k\u221e + sup 2nr k\u03c32\u2217n (h; f ) \u2212 \u03c32\u2217n\u22121 (h; f )k\u221e,K < \u221e.\nn\u22651\n\nTheorem 3.2 Suppose that m \u2265 1 is an integer, C = {\u03bej }M\nj=1 admits an M\u2013Z quadrature of order m,\nand let W be the corresponding quadrature weights. Let 0 < r \u2264 S \u2212 q, K \u2032 \u2282 K be concentric spherical\ncaps, f \u2208 C(Sq ), kf kWr (K) = 1.\n(a) For integer n, 1 \u2264 n \u2264 m,\n(3.9)\nkf \u2212 \u03c3n (C, W; h; f )k\u221e,K \u2032 \u2264 cn\u2212r .\n(b) For j = 1, * * * , M , let \u01ebj be independent random variables with mean 0 and range contained in [\u22121, 1],\nand Z = {\u01ebj + f (\u03bej )}. If A > 0 and n \u2265 1 is the greatest integer with (A + q)n2r+q log n \u2264 c3 mq , n \u2264 m,\nthen\n\u0001\n(3.10)\nProb k\u03c3n (C, W; h; Z) \u2212 f k\u221e,K \u2032 \u2265 c1 n\u2212r \u2264 c2 n\u2212A .\nHere, the constants c1 , c2 , c3 are independent of the distribution of the variables \u01ebj .\n\n.\n\n8\n\n\f4\n\nConstruction of quadrature formulas\n\nIn this section, we describe two algorithms to obtain bounded variation quadrature formulas associated\nwith a given finite set of points C \u2282 Sq . Both of these constructions can be described in a very general\nsetting. Since this also simplifies the notations and ideas considerably by avoiding the use of real and\nimaginary parts of a doubly indexed polynomial Yl,k , we will describe the algorithms in this generality.\nLet \u03a9 be a nonempty set, \u03bc be a probability measure on \u03a9, C \u2282 \u03a9, y1 , y2 , * * * be a complete orthonormal\nbasis for L2 (\u03a9, \u03bc), where y1 \u2261 1, and Vk denote the span of y1 , * * * , yk . Let \u03bd be another measure on \u03a9,\nand h\u25e6, \u25e6i denote the inner product of L2 (\u03a9, \u03bd). For integer N \u2265 1, the Gram matrix GN is an N \u00d7 N\nmatrix, defined\nR by (GNR)l,k = hyl , yk i = (GN )k,l , 1 \u2264 k, l \u2264 N . We wish to find a weight function W on\n\u03a9 such that \u03a9 P d\u03bc = \u03a9 P W d\u03bd for all P \u2208 VN for an integer N for which GN is positive definite.\nFor the applications to the case of quadrature formulas for the sphere, \u03a9 = Sq , \u03bc = \u03bcq , and yk 's are\nthe orthogonal spherical harmonics, arranged in a sequence, so that y1 \u2261 1, and all polynomials of lower\ndegree are listed before those of a higher degree. To include all polynomials in \u03a0qn , we need N = dq+1\nn .\nThere are many possibilities to define the measure \u03bd. The simplest is the measure \u03bd MC that associates\nthe mass 1/|C| with each point of C. A more sophisticated way to define the measure \u03bd is the following.\nWe obtain a partition of Sq into a dyadic triangulation such that each triangle contains at least one point\nof C. We choose only one point in each triangle, and hence, assume that each triangle contains exactly\none point of C. We define the measure \u03bd T R to be the measure that associates with each \u03be \u2208 C the area\nof the triangle containing \u03be.\nOne of the simplest ideas to compute\nPNthe quadratureR weights is the following. Let N be an integer for\nwhich GN is positive definite. If P = j=1 aj yj , then \u03a9 P d\u03bc = a1 . Also, the vector a = (a1 , . . . , aN )T\nsatisfies the matrix equation\nGN a = (hP, y1 i, . . . , hP, yN i)T ,\nso that\n\nZ\n\nP d\u03bc =\n\n\u03a9\n\nN\nX\n\nk=1\n\n(GN )\u22121\n1,k hP, yk i = hP,\n\nX\nk\n\n(GN )\u22121\n1,k yk i.\n\nIn the setting of the sphere, this gives the following quadrature formula:\n(\n)\nZ\nN\nX\nX\nX LSQ\n\u22121\nP d\u03bcq =\nP (\u03be) \u03bd({\u03be})\n(GN )1,k yk (\u03be) =:\nw\u03be P (\u03be).\nSq\n\n\u03be\u2208C\n\nk=1\n\n(4.1)\n\n(4.2)\n\n\u03be\u2208C\n\nWe formulate this as\nAlgorithm LSQ\nInput: The matrix Y = (yk (\u03be)), k = 1, * * * , N (optional), and the vector v = (\u03bd({\u03be}).\n1. Solve Y diag(v)Y T b = (1, 0, . . . , 0)T .\nPN\n2. Return w\u03beLSQ = \u03bd({\u03be}) k=1 bk yk (\u03be).\n\nWe observe that GN = Y diag(v)Y T . It is clear that the matrix GN is always positive semi\u2013definite;\nthe assumption that it is positive definite is equivalent to the assumption that no element of VN vanishes\nidentically on C. If C and {\u03bd({\u03be})} satisfy the M\u2013Z inequalities, Theorem 4.1 below shows that GN is well\nconditioned. Assuming that the matrix Y is input, the time to compute GN is O(N 2 |C|) and the space\nrequirement is O(N 2 ). (In the case of the sphere Sq , we need N = dq+1\n= O(nq ) to compute formulas\nn\nexact for degree n.) The vector b in Step 1 can be found using such iterative methods as the conjugate\nresidual method. We refer to [6] for a more detailed analysis of this method. Using this approach,\nthe matrix Y and GN need not be stored or precomputed, but the product of the matrix GN with an\narbitrary residual vector r needs to be computed. This observation results in a substantial saving in the\ntime and memory complexity of the algorithm when the results are desired only within a given accuracy.\nFor the unit sphere S2 , when N = (n + 1)2 , the product GN r = Y diag(v)Y T r can be computed within\nan accuracy \u01eb using a recent algorithm of Keiner [14] using O(n2 (log n)2 + log(1/\u01eb)|C|) operations, where\n\u01eb is the accuracy of the method.\n9\n\n\fOne way to interprete this algorithm is the following. Let f : Sq \u2192 R, and P be the solution to the\nleast square problem\nP = arg min{hf \u2212 Q, f \u2212 Qi : Q \u2208 VN }.\nP\nf )j yj . The quadrature formula with weights w\u03beLSQ thus\nIf f is the vector (hf, yj i), then P = j (G\u22121\nR N\nR\noffers Sq P d\u03bcq as the approximation to Sq f d\u03bcq . The weights w\u03beLSQ also satisfy a least square property\namong all the possible quadrature formulas, as shown in Lemma 6.1(a). We summarize some of the\nproperties of the weights w\u03beLSQ in the following theorem.\nq\nTheorem 4.1 Let n \u2265 1 be an integer, N = dq+1\nn , C be a finite set of points on S and \u03bd be a measure\nsupported on C. Let v\u03be := \u03bd({\u03be}), \u03be \u2208 C, and\n\uf8f1\n\uf8fc1/p\n\uf8f2X\n\uf8fd\nc1 kP kp \u2264\nv\u03be |P (\u03be)|p\n(4.3)\n\u2264 c2 kP kp ,\nP \u2208 \u03a0qn , 1 \u2264 p \u2264 \u221e,\n\uf8f3\n\uf8fe\n\u03be\u2208C\n\n(a) For the Gram matrix GN , the lowest eigenvalue is \u2265 c21 , and the largest eigenvalue is \u2264 c22 , where c1 , c2\nP\nare the constants in (4.3) with p = 2. In particular, GN is positive definite. Moreover, \u03be\u2208C |w\u03beLSQ | \u2264 c.\n(b) If\nZ\nZ\nZ\nc\nP 2 d\u03bd \u2212 P 2 d\u03bcq \u2264 q\n(4.4)\nP 2 d\u03bcq ,\nP \u2208 \u03a0qn ,\nn\n\nthen |w\u03beLSQ | \u2264 cv\u03be , \u03be \u2208 C. In particular, the weights {w\u03beLSQ } satisfy the M\u2013Z condition.\n(c) Let M \u2265 1 be an integer, C be a independent random sample of M points chosen from the distribution\n\u03bcq , and A, \u03b7 > 0. Let v\u03be = 1/M , \u03be \u2208 C. There exists a constant c = c(A) such that if n \u2265 2 is an integer\nwith M \u2265 cnq log n/\u03b7 2 , then\n\u0012Z\n\u0013\nZ\nZ\n2\n2\n2\nq\nProb\n(4.5)\nP d\u03bd \u2212 P d\u03bcq \u2265 \u03b7 P d\u03bcq ,\nP \u2208 \u03a0n \u2264 c1 n\u2212A .\nIn particular, if M \u2265 cn3q log n, then the condition (4.4) is satisfied with probability exceeding 1 \u2212 c1 n\u2212A .\n\nOne disadvantage of the algorithm LSQ is that one needs to know the value of N in advance. We\nnow describe an idea which has the potential to avoid this problem. In the case when \u03a9 is a subset\nof a Euclidean space, and the yj 's are polynomials, with y1 denoting the constant polynomial, one can\nconstruct a system {tk } of orthonormalized polynomials with respect to \u03bd using recurrence relations.\nRecurrence relations for orthogonal polynomials in several variables have been discussed in detail by\nDunkl and Xu [4, Chapter 3]. In contrast to the viewpoint in [4], we may depend upon a specific\nenumeration, but require the recurrence relation to have a specific form described in Theorem 4.2 below.\nThis form allows us to generalize the ideas in Gautschi's book [11, Chapter 2] in our context.\nTo describe our ideas in general, let \u03a9 \u2282 Rq+1 , u1 , u2 , * * * be the lexicographic enumeration of the\nmonomials in q + 1 variables, so that u1 is the monomial identically equal to 1, the restrictions of uk 's\nto \u03a9 are linearly independent, and Vk = span {u1 , * * * , uk }. It is not difficult to see that for every integer\nk \u2265 1, there is a minimal index p(k) such that there exists a monomial f \u0303k of degree 1 with\nf \u0303k up(k) = uk+1 ,\n\nk = 1, 2, * * * .\n\n(4.6)\n\nWe now let, for each k = 1, 2, * * *, {y1 , * * * , yk } be a basis for Vk orthonormal with respect to \u03bc, N \u2265 1 be\nan integer for which the Gram matrix GN is positive definite, and for each k = 1, * * * , N , {t1 , * * * , tk } be\na basis for Vk orthonormal with respect to \u03bd. Clearly, any polynomial P \u2208 VN can be written in the form\nZ\nX\nP (x) = P (\u03b6)\ntk (x)tk (\u03b6)d\u03bd(\u03b6),\nk\n\nand consequently, one gets the \"quadrature formula\"\n(\n)\n\u0013\nZ\nZ\nX \u0012Z\nP (x)d\u03bc(x) = P (\u03b6)\ntk (x)d\u03bc(x) tk (\u03b6) d\u03bd(\u03b6).\nk\n\n10\n\n(4.7)\n\n\fP\nIn this discussion only, let tk =: j ck,j yj , and the matrix (ck,j ) be denoted by C. The condition that\nT\nt1 , * * * , tN is an orthonormal system with respect to \u03bd is equivalent to the\nR condition that CGN C = I,\nT\nwhere I is the N \u00d7 N identity matrix. Hence, G\u22121\n=\nC\nC.\nMoreover,\nt\nd\u03bc\n=\nc\nfor\nk\n=\n1,\n*\n* * , N,\nk\nk,1\nN\nand hence, we conclude that\n\u0013\nX \u0012Z\nXX\nX\ntk (x)d\u03bc(x) tk =\nck,1 ck,j yj =\n(GN )\u22121\n1,j yj .\nj\n\nk\n\nj\n\nk\n\nThus, the quadrature weights in (4.7) are the same as those in (4.1).\nFirst, we summarize the various recurrence relations in Theorem 4.2 below, although we will not use\nall of them. We will denote the (total) degree of uk by Dk , and observe that Dk is also the degree of yk\nand tk , Dj \u2264 j, and Dp(k) = Dk+1 \u2212 1.\nTheorem 4.2 There exist real numbers sk,j , r\u0303k,j , Ak \u2265 0, and a linear polynomial fk , such that\nfk yp(k) = yk+1 \u2212\n\nX\n\nDk+1 \u22122\u2264Dj \u2264Dk\nj\u2264k\n\nr\u0303k,j yj , fk tp(k) = Ak tk+1 \u2212\n\nX\n\nsk,j tj .\n\n(4.8)\n\nDk+1 \u22122\u2264Dj \u2264Dk\nj\u2264k\n\nMore generally, if P is any linear polynomial, there exist real numbers rk,j (P ) such that\nX\n\nP yk =\n\nrk,j (P )yj ,\n\n(4.9)\n\nDk \u22121\u2264Dj \u2264Dk +1\n\nWe have tk =\n\nP\n\nj ck,j yj ,\n\nwhere\n\nAk ck+1,l =\n\n\uf8f1\n\uf8f2\n\uf8f3\n\nX\n\nrl,m (fk )cp(k),m +\n\nDl \u22121\u2264Dm \u2264Dl +1\n\nX\n\nDk+1 \u22122\u2264Dj \u2264Dk\n\nsk,j cj,l\n\n\uf8fc\n\uf8fd\n\uf8fe\n\n.\n\n(4.10)\n\nR\nIn the context of the sphere Sq , we will compute tk 's using (4.8), and compute tk d\u03bcq using a known\nquadrature formula. The resulting algorithm, Algorithm REC, in the context of the sphere is summarized\nbelow. This algorithm is similar to the Stieltjes method in Gautschi's book [11, Section 2.2]. Even though\nit is feasible to carry out the algorithm for as large an N as the data allows, and to find this value of\nN during run time, it is still desirable from the point of view of numerical stability to limit the largest\nN from the outset. Accordingly, in describing the following algorithm, we stipulate that the quadrature\nformula is to be computed to be exact only for polynomials in VN for the largest possible N \u2264 L for\nsome integer L \u2265 1. We assume further that we know another quadrature formula (for example, the\nDriscoll\u2013Healy formula [3]) exact for polynomials in VL :\nZ\nX\n\u03bb\u03b6 P (\u03b6) = P d\u03bcq ,\nP \u2208 VL .\n(4.11)\n\u03b6\u2208C \u2217\n\nAlgorithm REC\nInput: An integer L, the sequence p(k), k = 1, * * * , L, sets C, C \u2217 , weights (\u03bb\u03b6 )\u03b6\u2208C \u2217 so that (4.11) holds,\nthe values {yj (\u03be)}\u03be\u2208C , {yj (\u03b6)}\u03b6\u2208C \u2217 for j = 1, 2, 3, 4, and the values fk (\u03be), fk (\u03b6), k = 1, * * * , L.\n1. Using Gram\u2013Schmidt procedure, initialize t1 , t2 , t3 , t4 , both for points in C and in C \u2217 , and initialize\nN = 4.\nP\n2. For k = 1, * * * , 4, let \u03b3k = \u03b6\u2208C \u2217 \u03bb\u03b6 tk (\u03b6).\n\n3. For each \u03be \u2208 C, initialize w\u03be =\n\nP4\n\nk=1\n\n\u03b3k tk (\u03be).\n\n4. For k = 4, 5, * * * (so that the degrees are at least 0 for all polynomials entering in the recursions)\nand while N \u2264 L, repeat steps 5\u20138 below.\n11\n\n\f5. For j with Dk+1 \u2212 2 \u2264 Dj \u2264 Dk , set\nsk,j = hfk tp(k) , tj i.\n6. Define Tk+1 by\nTk+1 = fk tp(k) \u2212\n\nX\n\nsk,j tj .\n\nDk+1 \u22122\u2264Dj \u2264Dk\n\nboth for points in C and points in C \u2217 . If Ik+1 = hTk+1 , Tk+1 i = 0, then stop, and set N = k.\n1/2\nOtherwise, define tk+1 = Tk+1 /Ik+1 .\nP\n7. Set \u03b3k+1 = \u03b6\u2208C \u2217 \u03bb\u03b6 tk+1 (\u03b6).\n\n8. For each \u03be \u2208 C, w\u03be = w\u03be + \u03b3k+1 tk+1 (\u03be), k = k + 1, N = N + 1.\n\nIn the case of the sphere Sq , we take L = d\u00f1q+1 for some integer \u00f1 \u2265 1. The number of j's with\nDk+1 \u2212 2 \u2264 Dj \u2264 Dk , 1 \u2264 j, k \u2264 L is O(\u00f1q\u22121 ). In this discussion only, let M = |C| + |C \u2217 |. Consequently,\nSteps 5 and 6 require O(M \u00f1q\u22121 ) operations. Since the remaining two steps in the loop take O(M )\noperations, the loop starting at Step 4 require O(M \u00f12q\u22121 ) operations. Finally, we observe that in\nimplementing the above algorithm, one need not keep the whole matrix tk (\u03be); only the rows corresponding\nto three degrees are required in any step. In particular, the memory requirement of this algorithm is\nO(M \u00f1q\u22121 ).\n\n5\n\nNumerical experiments\n\nThe objective of this section is to demonstrate and supplement the theoretical results presented in Sections 3 and 4.\nOur first set of experiments illustrates the algorithms LSQ and REC. The experiments were conducted over a long period of time, many of them long before we started to write the paper. Hence, the\nnormalizations for the spherical polynomials Yl,k are somewhat different in Tables 1 and 2 from the rest\nof the paper. This is reflected in the sum of the absolute values of the weights, but has no effect on the\nvarious results other than scaling.\nFirst, we report on the algorithm LSQ. Each of the experiments in this case was repeated 30 times\nwith data sets chosen randomly from the distribution \u03bc2 on S2 . To test our algorithms, we computed the\ncomputed Gram matrix GCOM given by\nX LSQ\nGCOM\n=\nw\u03be yl (\u03be)ym (\u03be), l, m < \u230an/2\u230b.\nl,m\n\u03be\u2208C\n\nThe average maximum matrix norm of the difference between GCOM and the identity matrix of the\nsame size indicates the error of the quadrature formulas. The results are shown in Table 1. Based on\nthese results we conjecture that in order to obtain stable quadrature formulas (i.e., with small condition\nnumber for the original Gram matrix GN ) exact for degree n \u2265 1, one has to use at most 4dq+1\nuniformly\nn\ndistributed points. In contrast, the theoretical guarantee in Theorem 4.1(c) requires O(n3q log n) points.\nAs can be seen from the table, for a fixed degree n, the condition number \u03ba(GN ) decreases as the\nnumber of points increases. For n > 140 and various sets of randomly generated points on the sphere, we\ndo not obtain good numerical results. This might be due to a defect in the built in numerical procedures\nused by Matlab in computing the spherical harmonics of high degree at values close to \u22121 or 1. The\nsituation was much better for the dyadic points; i.e., the centers of the dyadic triangles.\nFor dyadic points on the sphere, the best result we obtained so far is n = 178 with 131, 072 points.\nAs a further verification of this quadrature, we considered the following data. The data are constructed\nusing coefficients {al,k } for spherical polynomials up to degree 90, taken from model MF4 used for\nmodelling the lithospheric field. The model is computed by geophysicists at GeoForschungsZentrum\n12\n\n\fM\n8192\n\nn\n16\n44\n64\n84\n16384 44\n64\n84\n100\n32768 44\n64\n84\n100\n\nError\n2.41 \u2217 10\u221215\n4.32 \u2217 10\u221215\n6.15 \u2217 10\u221215\n9.73 \u2217 10\u221212\n4.43 \u2217 10\u221215\n5.25 \u2217 10\u221215\n7.10 \u2217 10\u221215\n1.94 \u2217 10\u221215\n6.02 \u2217 10\u221215\n7.09 \u2217 10\u221215\n7.71 \u2217 10\u221215\n7.62 \u2217 10\u221215\n\nP\n\n|w\u03be |\n3.5449\n3.5714\n5.5575\n82.152\n3.5449\n3.5787\n4.4757\n9.1325\n3.5449\n3.5450\n3.5574\n3.6777\n\nmin w\u03be\n2.29 \u2217 10\u22124\n\u22125.06 \u2217 10\u22124\n\u22120.00664\n\u22120.16274\n\u22129.50 \u2217 10\u22126\n\u22123.75 \u2217 10\u22124\n\u22120.0024\n\u22120.0077\n3.11 \u2217 10\u22125\n\u22121.79 \u2217 10\u22125\n\u22121.43 \u2217 10\u22124\n\u22124.28 \u2217 10\u22124\n\nmax w\u03be\n7.88 \u2217 10\u22124\n0.0029\n0.0073\n0.1551\n8.82 \u2217 10\u22124\n0.0015\n0.0032\n0.0072\n2.90 \u2217 10\u22124\n5.23 \u2217 10\u22124\n7.92 \u2217 10\u22124\n9.96 \u2217 10\u22124\n\npos\n\u03ba(GN )\n8192\n2.43\n8039\n37.52\n6068\n1695.1\n4431 3.52 \u2217 106\n16382\n9.19\n16014\n51.9\n13361\n944.86\n10625 11896.1\n32768\n4.270\n32761\n7.977\n32410\n42.97\n30819\n145.6\n\n\u03bbmin\n0.607\n0.078\n0.003\n2.6 \u2217 10\u22126\n0.24036\n0.05964\n0.00612\n4.8 \u2217 10\u22124\n0.4157\n0.8208\n0.0716\n0.0250\n\n\u03bbmax\n1.4730\n2.8047\n3.9315\n5.4851\n2.1590\n2.9150\n3.8457\n4.6008\n1.7652\n5.2519\n2.7967\n3.2967\n\nTable 1: The statistics for the experiments with the algorithm LSQ. M = |C|, n \u2212 2 is the degree of\nspherical polynomials for which exact quadrature formulas were computed, N = n2 , pos stands for the\nnumber of positive weights, \u03ba(GN ), \u03bbmin , \u03bbmax are the condition number, the maximum eigenvalue and\nthe minimum eigenvalue of the matrix GN respectively.\nPotsdam (Germany)\nP based on CHAMP satellite data. We use those coefficients to construct the samples\nof a function f = l,k al,k Yl,k at the centers of 8 \u2217 47 dyadic triangles. We then use our pre-computed\nquadrature based at these centers which can integrate spherical polynomials up to degree 178 to compute\nthe Fourier coefficients b\nal,k . The maximum difference between the vector {b\nal,k } and the vector {al,k }\nwas found to be 6.66 \u2217 10\u221215 .\nNext, we considered the algorithm REC. In the context of spherical polynomials, the recurrence\nrelations have to be chosen very carefully using the special function properties of the spherical harmonics\nYl,k , in order to get stable results [28]. In the present situation, the polynomials tk have no special\nstructure. Therefore, it turns out that the algorithm REC is not very stable for high degrees. However,\nwhen we took the centers of 8192 dyadic triangles as the quadrature nodes, and used the measure \u03bd T R as\nthe starting measure, then we are able to obtain satisfactory quadrature formulas for degree 32. We note\nan interesting feature here that all the weights obtained by this algorithm are positive. These results are\nsummarized in Table 2 below.\nn\nError\n16 4.196643 \u2217 10\u221214\n22 5.302425 \u2217 10\u221213\n32 9.240386 \u2217 10\u221211\n42 4.434868 \u2217 10\u22128\n44 2.320896 \u2217 10\u22125\n\nmin(w\u03be )\n5.181468 \u2217 10\u22124\n5.175583 \u2217 10\u22124\n5.154855 \u2217 10\u22124\n5.086157 \u2217 10\u22124\n5.094771 \u2217 10\u22124\n\nmax(w\u03be )\n2.538441 \u2217 10\u22123\n2.543318 \u2217 10\u22123\n2.544376 \u2217 10\u22123\n2.544141 \u2217 10\u22123\n2.562948 \u2217 10\u22123\n\nP\n\nw\u03be\n12.56637\n12.56637\n12.56637\n12.56637\n12.56638\n\nTable 2: Quadrature constructed using REC on 8192 dyadic points\nOur second set of experiments demonstrates the local approximation properties of the operators\n\u03c3n (C, W; h) for a smooth function h. For this purpose, we consider the following benchmark functions,\nconsidered by various authors [31, 30, 15, 10], listed in (5.1) below. Using the notation x = (x1 , x2 , x3 ),\nthe functions are defined by\ng1 (x)\n\n=\n\ng2 (x)\ng3 (x)\n\n=\n=\n\ng4 (x)\n\n=\n\n3/4\n\n3/4\n\n(x1 \u2212 0.9)+ + (x3 \u2212 0.9)+ ,\n\n[0.01 \u2212 (x21 + x22 + (x3 \u2212 1)2 )]+ + exp(x1 + x2 + x3 ),\n1/(101 \u2212 100x3 ),\n\n1/(|x1 | + |x2 | + |x3 |),\n\n13\n\n\fg5 (x)\n\n=\n\n\u001a\n\ncos2\n0,\n\n3\u03c0\n2 dist(x, (\u22121/2, \u22121/2, 1/\n\n\u221a \u0001\n\u221a\n2)) , if dist(x, (\u22121/2, \u22121/2, 1/\u221a2)) < 1/3,\n(5.1)\nif dist(x, (\u22121/2, \u22121/2, 1/ 2)) \u2265 1/3.\n\nIn order to define the function h, we recall first that the B spline Bm of order m is defined recursively\n[1, p. 131] by\n\uf8f1\n\uf8f4\n\uf8f2 1,\n0,\nBm (x) :=\nm\u2212x\nx\n\uf8f4\n\uf8f3\nBm\u22121 (x) +\nBm\u22121 (x \u2212 1),\nm\u22121\nm\u22121\n\nif m = 1, 0 < x \u2264 1,\nif m = 1, x \u2208 R \\ (0, 1],\n\n(5.2)\n\nif m > 1, x \u2208 R.\n\nThe function Bm is an m \u2212 1 times interated integral of a function of bounded variation. We will choose\nh to be\nm\nX\nhm (x) =\nBm (2mx \u2212 k),\n(5.3)\nk=\u2212m\n\nfor different values of m, in order to illustrate the effect of the smoothness of hm on the quality of local\napproximation. If m \u2265 3, the function hm satisfies the conditions in Proposition 2.1 with S = m \u2212 1. We\nnote that the discretized Fourier projection operator \u03c363 (C, W; h1 ) has been called the hyperinterpolation\noperator [29].\nOne example of the localization properties of our operators is given in the following table,\nwhere\u221awe\n\u221a\nshow the error in approximation of g1 on the whole sphere and on the cap K = S20.4510 ((\u22121/ 2, 0, \u22121/ 2).\nThe operators were constructed using Driscoll\u2013Healy quadrature formula [3] based on 4(n + 1)2 points,\nexact for integrating polynomials of degree 2n. The maximum error on the whole sphere, given in\nColumns 2 and 3, is estimated by the error at 10000 randomly chosen points; that on the cap, given\nin Columns 4 and 5, is estimated by the error at 1000 randomly chosen points on the cap. It is clear\nthat even though the maximum error on the whole sphere is slightly better for the (discretized) Fourier\nprojection than for our summability operator, the singularities of g1 continue to dominate the error in the\nFourier projection on a cap away from these singularities; the performance of our summability operator\nis far superior.\nn S2errh1\n63\n0.0097\n127 0.0044\n255 0.0033\n\nS2errh5\n0.0112\n0.0055\n0.0038\n\nKerrh1\n3.4351 \u2217 10\u22124\n8.0596 \u2217 10\u22125\n1.4170 \u2217 10\u22125\n\nKerrh5\n6.5926 \u2217 10\u22127\n6.5240 \u2217 10\u22128\n1.1816 \u2217 10\u22128\n\nTable 3:\nS2errh1 = maxx\u2208S2 |g1 (x) \u2212 \u03c3n (C, W; h1 , g1 , x)|, S2errh5 = maxx\u2208S2 |g1 (x) \u2212\n\u03c3n (C, W; h5 , g1 , x)|, Kerrh1 = maxx\u2208K |g1 (x) \u2212 \u03c3n (C, W; h1 , g1 , x)|, Kerrh5 = maxx\u2208K |g1 (x) \u2212\n\u03c3n (C, W; h5 , g1 , x)|, (C, W) are given by the Driscoll\u2013Healy formulas.\nTheorem 3.2 points out another way to demonstrate the superior localization of our summability\noperator without an a priori knowledge of the locations of the singularities. Since each of the test\nfunctions is infinitely differentiable on large caps of different sizes, Theorem 3.2 suggests that the more\nlocalized the method, the greater is the probability that the approximation error would be smaller than a\ngiven number. To demonstrate also how our ability to construct quadrature formulas based on scattered\ndata helps us to analyse the approximation properties of our summability operators, we took for the\nset C a randomly generated sample of 65536 points. For these points, the weights W computed by the\nalgorithm LSQ yield a quadrature formula exact for integrating spherical polynomials of degree 126.\nWe compare three approximation methods, the least square approximation from \u03a0263 , the approximation\ngiven by the operator \u03c363 (C, W; h1 ), and the approximation given by \u03c363 (C, W; h5 ). For each function,\nwe computed the absolute value of the difference between the approximate value computed by each of\nthe three methods and the true value of the function at 20, 000 randomly chosen points on the sphere.\nThe percentage of points where the value of this difference is less than 10\u2212x is reported in Table 4 below,\nfor x = 2 : 10. It is very obvious that \u03c363 (C, W; h5 ) gives a far superior performance than the other\nmethods, due to its localization properties.\n14\n\n\fg1\n\ng2\n\ng3\n\ng4\n\ng5\n\nx\u2192\nS1\nLS\nS5\nS1\nLS\nS5\nS1\nLS\nS5\nS1\nLS\nS5\nS1\nLS\nS5\n\n10\n0\n0\n0.02\n0\n0\n0.39\n0\n0\n0.51\n0\n0\n0.01\n0\n0\n0.08\n\n9\n8\n7\n6\n5\n4\n3\n2\n0\n0.005 0.02 0.42 4.44 39.43 94.79 100\n0\n0\n0.04 0.56 5.32 46.38 95.45 100\n0.19 1.87 16.89 59.36 68.34 79.01 93.09 99.97\n0.01 0.09 0.74 7.94 84.99 99.19 99.99 100\n0.01 0.15 1.29 13.29 86.09 99.28 100\n100\n3.34 41.95 90.78 94.52 97.19 99.18 99.97 100\n0.01 0.11 1.26 12.02 91.87 99.86 100\n100\n0.01 0.10 1.49 16.26 93.12 99.87 100\n100\n5.43 51.08 82.22 91.90 95.79 98.49 99.87 100\n0\n0\n0.01 0.18 1.91 18.28 83.81 99.97\n0\n0.01 0.02 0.25 2.16 21.24 86.43 99.98\n0.01 0.04 0.36 3.47 17.48 40.98 80.06 99.88\n0\n0.01 0.09 1.12 11.84 88.94 99.45 100\n0.01 0.01 0.15 1.42 15.23 90.47 99.75 100\n0.64 5.73 66.82 83.54 88.74 92.95 96.78 97.64\n\nTable 4: Percentages of error less than 10\u2212x for different functions, LS= Least square, S1= error with\n\u03c363 (C, W; h1 ), S5= error with \u03c363 (C, W; h5 ). For example, for the function g3 , S5 was less than 10\u22127 for\n82.22% of the 20000 randomly selected points, while S1 (respectively, LS) was less than 10\u22127 for 1.26%\n(respectively, 1.49%) points.\nx\u2192\n5\n4\n3\n2\nS1\n0.05 0.635 9.93 97.45\nLS\n0\n0\n0\n100\nS5 0.085 1.015 10.03 97.49\n\n3.0 2.75\n2.5\n2.25\n0\n7.97 92.75 100.00\n0\n0.04 30.93 99.07\n0.24 51.97 99.87 100.00\n\nTable 5: Percentages of error less than 10\u2212x for \u01eb = 0.01, LS= Least square, S1= error with \u03c363 (C, W; h1 ),\nS5= error with \u03c363 (C, W; h5 ). The random noise in the left half comes from the uniform distribution in\n[\u2212\u01eb, \u01eb], that in the right half from the normal distribution with mean 0, standard deviation \u01eb.\n\nNext, we illustrate the stability of our operators under noise. Since our operators are linear operators, we\nassume for this part of the study that the target function f is the zero function contaminated either by\nuniform random noise in the range [\u2212\u01eb, \u01eb], or a normally distributed random variable with mean 0 and\nstandard deviation \u01eb. We let C be a set of 65536 random points and computed corresponding weights W\nthat integrate exactly polynomial up to degree 126. These were used in calculating \u03c363 (C, W; h1 ) and\n\u03c363 (C, W; h5 ) at each point of a test data set consisting of 20000 random samples from the distribution\n\u03bc2 . For each value of \u01eb = 0.1; 0.01; 0.001; 0.0001, the experiment is repeated 50 times and the errors are\nthe averaged over the number of repetitions. The percentage of points at which the absolute computed\nvalue is less than 10\u2212x is reported in Table 5 in the case when \u01eb = 0.01. The results for the other values of\n\u01eb were consistent with the linearity of the operator. We observe that in each case, both \u03c363 (C, W; h1 ) and\n\u03c363 (C, W; h5 ) yield better results than the least squared approximation, while \u03c363 (C, W; h5 ) is slightly\nsuperior to \u03c363 (C, W; h1 ).\nFinally, we used our operator \u03c322 (C, W; h7 ) with the MAGSAT data. Our purpose here is only to\ntest how our methods work on a \"real life\" data. This data, supplied to us kindly by Dr. Thorsten\nMaier, measures the magnetic field of the earth in nT as a vector field. It was derived from vectorial\nMAGSAT morning data that has been processed by Nils Olsen of the Danish Space Research Institute.\nThe measurements are averaged on a longitude-latitude grid with \u2206\u03c6 = 4o and \u2206\u03b8 = 2o in geomagnetic\ncoordinates. The radial variations of the MAGSAT satellite have been neglected in the dataset and,\ntherefore, prior to the averaging process, the GSFC(12/83) reference potential model has been subtracted.\nThe data results from one month of measurements, centered at March 21, 1980. We extract the East\nWest component of the vectorial data as a scalar valued function on the sphere. Totally, there are 8190\n15\n\n\fFigure 2: From left to right: The original data, its reconstruction using \u03c322 (C, W; h7 ), and the error in\nthe approximation, |\u03c322 (C, W; h7 ) \u2212 y|.\ndata sites. A quadrature of degree 44 was computed based on those sites. Figure 2 shows the original\ndata, its reconstruction using \u03c322 (C, W; h7 ), and the error in the approximation, |\u03c322 (C, W; h7 ) \u2212 y|, as\na map in the longitude-latitude plane. As can be seen from the figures, the reconstruction preserves the\nkey features of the original data.\n\n6\n\nProofs\n\nIn the interest of organization, we will prove the various new results in the paper in the following order.\nWe will prove Theorem 4.2 first, since its proof does not require any preparation. We will then use\nProposition 2.1 to prove Theorems 3.1(a) and 3.2(a). Next, we will prove Lemma 6.1 and use it to\nprove parts (a) and (b) of Theorem 4.1. The remaining results in this paper involve probabilities. We\nprove Lemma 6.2 next, estimating the probability that the supremum norm of a sum of random spherical\npolynomials exceeds a given number. This lemma will be used immediately to prove Theorem 4.1(c).\nFinally, we will prove Theorems 3.1(b), 3.2(b).\nProof of Theorem 4.2. It is convenient to prove (4.9) first. Since P yk is a polynomial of degree\nDk + 1, there exist real numbers rk,j (P ) such that\nX\nP yk =\nrk,j (P )yj .\nDj \u2264Dk +1\n\nSince the system {yk } is orthonormal with respect to \u03bc,\nZ\nrk,j (P ) =\nP yk yj d\u03bc.\n\u03a9\n\n16\n\n\fIf Dj < Dk \u2212 1, then the degree of P yj is less than Dk . Because of the lexicographic ordering where\nlower degree polynomials appear before the higher degree ones, this implies that P yj \u2208 Vk\u22121 . Since yk is\northogonal to Vk\u22121 , it follows that rj,k (P ) = 0 if Dj < Dk \u2212 1. This completes the proof of (4.9).\nWe observe that yp(k) \u2208 span {u1 , * * * , up(k) }. So, there exists a constant \u03b1 such that \u03b1yp(k) \u2212 up(k) \u2208\nVp(k)\u22121 . Thus, \u03b1f \u0303k yp(k) \u2212 f \u0303k up(k) = \u03b1f \u0303k yp(k) \u2212 uk+1 is linear combination of terms of the form f \u0303k uj ,\n1 \u2264 j \u2264 p(k)\u22121. Since p(k) is the minimal index for which there exists a monomial f \u0303k with f \u0303k up(k) \u2208 Vk+1 ,\neach of the terms f \u0303k uj , 1 \u2264 j \u2264 p(k) \u2212 1 is in Vk . It follows that \u03b1f \u0303k yp(k) \u2212 uk+1 \u2208 Vk . Again, there\nexists a constant \u03b1\u2032 such that \u03b1\u2032 uk+1 \u2212 yk+1 \u2208 Vk . Therefore, writing fk = \u03b1\u03b1\u2032 f \u0303k , we\nXconclude that\nr\u0303k,j yj . The\nfk yp(k) \u2212 yk+1 = \u03b1\u2032 (\u03b1f \u0303k yp(k) \u2212 uk+1 ) + \u03b1\u2032 uk+1 \u2212 yk+1 \u2208 Vk ; i.e., fk yp(k) = yk+1 \u2212\nDj \u2264Dk\n\nfirst equation in (4.8) is now proved in view of (4.9), applied with p(k) in place of k, and the fact that\nDp(k) = Dk+1 \u2212 1. We note that fk is a constant multiple of the monomial f \u0303k . The second equation in\n(4.8) is proved in the same way.\nUsing the second equation in (4.8) and (4.9), we obtain from the definition of ck,j 's that\nZ\nAk ck+1,l = Ak\ntk+1 yl d\u03bc\n\u03a9\nZ\nZ\nX\nfk tp(k) yl d\u03bc +\nsk,j\ntj yl d\u03bc\n=\n\u03a9\n\nDk+1 \u22122\u2264Dj \u2264Dk\n\nX\n\n=\n\nrl,m (fk )\n\nX\n\n\u03a9\n\ntp(k) ym d\u03bc +\n\n\u03a9\n\nDl \u22121\u2264Dm \u2264Dl +1\n\n=\n\nZ\n\nrl,m (fk )cp(k),m +\n\nDl \u22121\u2264Dm \u2264Dl +1\n\nX\n\nsk,j cj,l\n\nDk+1 \u22122\u2264Dj \u2264Dk\n\nX\n\nsk,j cj,l .\n\nDk+1 \u22122\u2264Dj \u2264Dk\n\nThis proves (4.10).\n\n\u2737\n\nNext, we use Proposition 2.1 to prove Theorem 3.1(a) and Theorem 3.2(a).\nProof of Theorem 3.1(a). To prove part (a), we assume without loss of generality that n \u2265 8, and\nlet l \u2265 1 be the largest integer with 2l+2 \u2264 n. In view of (3.4),\nkf \u2212 \u03c3n\u2217 (C, W; h; f )k\u221e\n\n\u2264\n\u2264\n\ncEn/2 (f ) \u2264 cE2l+1 (f ) \u2264 ckf \u2212 \u03c32\u2217l+1 (h; f )k\u221e\n\u221e\nX\nc\nk\u03c32\u2217k+1 (h; f ) \u2212 \u03c32\u2217k (h; f )k\u221e \u2264 c2\u2212rl \u2264 cn\u2212r .\nk=l+1\n\nThis proves part (a).\n\n\u2737\n\u2032\u2032\n\n\u2032\n\nProof of Theorem 3.2(a). Let K be a spherical cap, concentric with K, K , and having radius equal\nto the average of the radii of K, K \u2032 . Let \u03c8 be fixed, C \u221e function that is equal to 1 on K \u2032\u2032 and equal\nto 0 outside of K. Without loss of generality, we may assume that n \u2265 8, and let l \u2265 1 be the largest\ninteger such that 2l+2 \u2264 n. The direct theorem of approximation theory (cf. [26]) implies that there\nexists P \u2208 \u03a0q2l such that\nk\u03c8 \u2212 P k\u221e \u2264 c2\u2212lS .\nTherefore, using the definition of kf kWr (K) , we conclude that\nE2l+1 (f \u03c8)\n\n\u2264 kf \u03c8 \u2212 P \u03c32\u2217l (h; f )k\u221e \u2264 k(f \u2212 \u03c32\u2217l (h; f ))\u03c8k\u221e + k(\u03c8 \u2212 P )\u03c32\u2217l (h; f )k\u221e\n\u2264 c{kf \u2212 \u03c32\u2217l (h; f )k\u221e,K + 2\u2212nS kf k\u221e }\n( \u221e\n)\nX\n\u2217\n\u2217\n\u2212nS\n\u2264 c\nk\u03c32k+1 (h; f ) \u2212 \u03c32k (h; f )k\u221e,K + 2\nkf k\u221e \u2264 c2\u2212rl .\nk=l+1\n\nIn view of (3.4),\nkf \u2212 \u03c3n (C, W; h; f \u03c8)k\u221e,K \u2032\n\n=\n\u2264\n\nkf \u03c8 \u2212 \u03c3n (C, W; h; f \u03c8)k\u221e,K \u2032 \u2264 kf \u03c8 \u2212 \u03c3n (C, W; h; f \u03c8)k\u221e\ncEn/2 (f \u03c8) \u2264 E2l+1 (f \u03c8) \u2264 c2\u2212rl \u2264 cn\u2212r .\n17\n\n(6.1)\n\n\fSince 1 \u2212 \u03c8(\u03b6) = 0 for \u03b6 \u2208 K \u2032\u2032 , we may use (2.8) to deduce that for x \u2208 K \u2032 ,\n|\u03c3n (C, W; h; (1 \u2212 \u03c8)f, x)| =\n\u2264\n\nX\n\n\u03be\u2208C\\K \u2032\u2032\n\nw\u03be f (\u03be)(1 \u2212 \u03c8(\u03be))\u03a6n (h; x * \u03be)\n\nX\nc(K, K \u2032 , K \u2032\u2032 )\nc(K, K \u2032 , K \u2032\u2032 )\nk(1 \u2212 \u03c8)f k\u221e\n.\n|w\u03be | \u2264\nS\u2212q\nn\nnS\u2212q\n\u03be\u2208C\n\nTogether with (6.1) and the fact that r \u2264 S \u2212 q, this implies (3.9).\n\n\u2737\n\nNext, we prove Lemma 6.1, describing certain extremal properties for the weights w\u03beLSQ . These will\nbe used in the proof of parts (a) and (b) of Theorem 4.1.\nq\nLemma 6.1 Let n \u2265 1 be an integer, N = dq+1\nn , C be a finite set of points on S and \u03bd be a measure\nsupported on C. Let v\u03be := \u03bd({\u03be}), \u03be \u2208 C.\n(a) If the Gram matrix is positive definite, then the weights w\u03beLSQ are solutions of the extremal problem\nP\nP\nto minimize \u03be\u2208C w\u03be2 /v\u03be subject to the conditions that \u03be\u2208C w\u03be yl (\u03be) = \u03b41,l .\nP\n(b) If (4.3) holds, there exist real numbers W\u03be , \u03be \u2208 C, such that |W\u03be | \u2264 v\u03be for \u03be \u2208 C and \u03be\u2208C W\u03be P (\u03be) =\nR\nP d\u03bcq for all P \u2208 \u03a0qn .\n\nProof. In this proof, we will write G in place of GN . The Lagrange multiplier method to solve the\nminimization problem sets up parameters \u03bbl and minimizes\n\uf8eb\n\uf8f6\nX\nX\nX\nw\u03be2 /v\u03be \u2212 2\n\u03bbl \uf8ed\nw\u03be yl (\u03be) \u2212 \u03b41,l \uf8f8 .\n\u03be\u2208C\n\nl\n\n\u03be\n\nP\nSetting thePgradient (with respect to w\u03be ) equal to 0, we get w\u03be = v\u03be l \u03bbl yl (\u03be). Writing, in this proof\nonly, Q = l \u03bbl yl , we see that w\u03be = v\u03be Q(\u03be). Substituting back in the linear constraints,\nP \u22121 this reduces to\nP\nv\nQ(\u03be)y\n(\u03be)\n=\n\u03b4\n.\nThese\nconditions\ndetermine\nQ\nuniquely;\nindeed,\nQ\n=\n\u03be\nl\n1,l\nj G1,j yj . This proves\n\u03be\u2208C\npart (a).\nThe part (b) is proved essentially in [21], but since it is not stated in this manner, we sketch a proof\nM\nagain. During this proof,\nP different constants will retain their values. Let M = |C|, R qbe equipped\nwith the norm k|rk| = \u03be\u2208C v\u03be |r\u03be |. In this proof only, let S be the operator defined on \u03a0n by S(P ) =\n(P (\u03be))\u03be\u2208C \u2208 RM , and V be the range of S. The estimate\nZ\nX\n|P |d\u03bcq \u2264 c1\nv\u03be |P (\u03be)|\n(6.2)\n\u03be\u2208C\n\nimplies that the operator S :\n\n\u03a0qn\n\n\u2192 V is invertible. We may now define a linear functional on V by\nZ\n\u2217\nx (r) = S \u22121 (r)d\u03bcq ,\nr \u2208 V.\n\nIt is clear from (6.2) that the norm of x\u2217 is bounded above by c1 . The Hahn\u2013Banach theorem yields a\nM\nnorm preserving extension of this functional to the whole\nthis functional with the\nR\nP space R . Identifying\nvector (W\u03be )\u03be\u2208C , the extension property implies that \u03be\u2208C W\u03be P (\u03be) = P d\u03bcq for all P \u2208 \u03a0qn , while the\nnorm preservation property implies that |W\u03be | \u2264 c1 v\u03be for \u03be \u2208 C.\n\u2737\nP\nq+1\nN\nProof of Theorem 4.1 (a), (b). Let N = dn , r \u2208 R , and P = l rl yl . In this proof only, we write\nG in place of GN . Then\n\uf8f1\n\uf8fc\n\uf8fd\nX \uf8f2X\nX\nrT Gr =\nrl\nv\u03be yl (\u03be)ym (\u03be) rm =\nv\u03be P (\u03be)2 ,\n\uf8f3\n\uf8fe\nl,m\n\n\u03be\u2208C\n\n\u03be\u2208C\n\nand rT r = kP k22 . Therefore, (4.3) with p = 2 implies that c21 rT r \u2264 rT Gr \u2264 c22 rT r for all r \u2208 RN . The\nstatements about the eigenvalues of G are an immediate consequence of the Raleigh\u2013Ritz theorem [13,\n18\n\n\fP\nTheorem 4.2.2]. Using Lemma 6.1(b), we obtain weights W\u03be such that \u03be\u2208C W\u03be yl (\u03be) = \u03b41,l , l = 1, * * * , N ,\nand |W\u03be | \u2264 cv\u03be , \u03be \u2208 C. During the remainder of this proof, we write w\u03be = w\u03beLSQ . In view of Lemma 6.1(a),\nwe have\n\uf8f1\n\uf8fc1/2 \uf8f1\n\uf8fc1/2 \uf8f1\n\uf8fc1/2 \uf8f1\n\uf8fc1/2\n\uf8f2X \uf8fd \uf8f2X w 2 \uf8fd\n\uf8f2X \uf8fd \uf8f2X W 2 \uf8fd\nX\nX\n\u03be\n\u03be\nv\u03be\n|w\u03be | \u2264\nv\u03be\n\u2264\n\u2264c\nv\u03be \u2264 c1 .\n\uf8f3\n\uf8fe \uf8f3\n\uf8f3\n\uf8fe \uf8f3\nv\u03be \uf8fe\nv\u03be \uf8fe\n\u03be\n\n\u03be\u2208C\n\n\u03be\u2208C\n\n\u03be\n\n\u03be\u2208C\n\n\u03be\u2208C\n\nThis completes the proof of part (a).\nIn order to prove part (b), we adopt the following notation during this proof only. Let I denote the\nN \u00d7 N identity matrix. For any N \u00d7 N matrix H, let kHk denote sup kHrk, krk = 1, r \u2208 RN . We note\nthat kHk is the largest singular value of H. If H is a symmetric, positive definite matrix, then it is also\nthe largest eigenvalue of H, and moreover, |rT1 Hr2 | \u2264 kHkkr1kkr2 k, r1 , r2 \u2208 RN . Using (4.4), it is easy\nto conclude using the Raleigh\u2013Ritz theorem that kG \u2212 Ik \u2264 cn\u2212q , kG\u22121 k \u2264 c, and hence,\nkG\u22121 \u2212 Ik = kG\u22121 (I \u2212 G)k \u2264 ckG\u22121 kkG \u2212 Ik \u2264 cn\u2212q .\nLet y(x) denote the vector (y1 (x), * * * , yN (x))T for x \u2208 Sq . In view of the addition formula, ky(x)k2 is\nindependent of x, and hence,\nky(x)k2 =\n\nZ\n\nN\nX\n\nSq j=1\n\nyj (x)2 d\u03bcq (x) = dq+1\n\u2264 cnq ,\nn\n\nx \u2208 Sq .\n\nConsequently, we have\nZ\n=\ny(x)T G\u22121 y(\u03be)d\u03bcq (x)\nZ\nZ\ny(x)T (G\u22121 \u2212 I)y(\u03be)d\u03bcq (x) +\ny(x)T y(\u03be)d\u03bcq (x)\nZ\n\u22121\nkG \u2212 Ik ky(x)kky(\u03be)kd\u03bcq + |(1, 0, * * * , 0)T y(\u03be)| \u2264 cn\u2212q nq + c \u2264 c.\n\n|w\u03beLSQ |\nv\u03be\n\n\u2264\n\u2264\n\nThis completes the proof of part (b).\n\n\u2737\n\nThe proof of the remaining new results in the paper are based on the following lemma, that gives a\nrecipe for estimating the probabilities involving polynomial valued random variables.\nLemma 6.2 Let n, M \u2265 1 be integers, {\u03c9j }M\nj=1 be independent random variables, and for j = 1, * * * , M ,\nZj = Z(\u03c9j , \u25e6) \u2208 \u03a0qn have mean equal to 0 according to \u03c9j . Let B, R > 0,\nmax q |Zj (x)| \u2264 Rnq , and\n1\u2264j\u2264M, x\u2208S\n\nthe sum of the variances of Zj be bounded by Bnq uniformly on Sq . If A > 0 and 12R2 (A+ q)nq log n \u2264 B\nthen\n\uf8f6\n\uf8eb\nM\nX\np\n(6.3)\n\u2265 12B(A + q)nq log n\uf8f8 \u2264 c1 n\u2212A .\nZj\nProb \uf8ed\nj=1\n\n\u221e\n\nHere, the positive constant c1 is independent of M and the distributions of \u03c9j .\n\nProof. The proof depends upon Bennett's inequality [27, p. 192]. In this proof only, we adopt a slightly\ndifferent meaning for the symbols L, V , \u03b7. Let L, V, \u03b7 be positive numbers, and Xj , j = 1, * * * , M , be\nindependent random variables. According to Bennett's inequality, if the mean of each Xj is 0, the range\nof each Xj is a subset of [\u2212L, L], and V exceeds the sum of the variances of Xj , then for \u03b7 > 0,\n\uf8eb\n\uf8f6\n\u0013\n\u0012\nM\nX\nV\n\uf8ed\n\uf8f8\n(6.4)\nProb |\nXj | \u2265 \u03b7 \u2264 2 exp \u2212 2 g(L\u03b7/V ) ,\nL\nj=1\n19\n\n\fRtRu\nwhere, in this proof only, g(t) := (1 + t) log(1 + t) \u2212 t. We observe that g(t) = 0 0 (1 + w)\u22121 dwdu.\nTherefore, if 0 \u2264 t \u2264 1/2, then for 0 \u2264 w \u2264 u \u2264 t, (1 + w)\u22121 \u2265 2/3, and hence, g(t) \u2265 t2 /3. Consequently,\nif L\u03b7 \u2264 V /2, then\n\uf8f6\n\uf8eb\nM\nX\nXj | \u2265 \u03b7 \uf8f8 \u2264 2 exp(\u2212\u03b7 2 /(3V )).\n(6.5)\nProb \uf8ed|\nj=1\n\nq\n\nNow,plet x \u2208 S . We apply (6.5) with Zj (x) in place of Xj , Rnq in place of L, Bnq in place of V ,\n\u03b7 = 3B(A + q)nq log n. Our condition on n ensures that L\u03b7/V \u2264 1/2 with these choices. Therefore,\n\uf8eb\n\uf8f6\nM\nX\np\nZj (x)| \u2265 3B(A + q)nq log n\uf8f8 \u2264 2n\u2212A\u2212q .\nProb \uf8ed|\n(6.6)\nj=1\n\nP\n\u2217\nq\n\u2217 \u2217\n\u2217\nq\nNext, in the proof only, let P \u2217 = M\nj=1 Zj , x \u2208 S be chosen so that |P (x )| = kP k\u221e , C \u2282 S be\nq\nq\n\u2217\n\u2217 \u2217\nchosen so that |C| \u223c cn and \u03b4C (S ) \u2264 1/(2n). Then we may find \u03be \u2208 C such that dist(x , \u03be ) \u2264 1/(2n).\nSince P \u2217 \u2208 \u03a0qn , its restriction to the great circle through x\u2217 and \u03be \u2217 is a trigonometric polynomial of order\nat most n. In view of the Bernstein inequality for these polynomials [2, Chapter 4, (1.1)],\n|P \u2217 (\u03be \u2217 ) \u2212 P \u2217 (x\u2217 )| \u2264 nkP \u2217 k\u221e dist(\u03be \u2217 , x\u2217 ) \u2264 (1/2)|P \u2217 (x\u2217 )|.\nWe deduce that\nM\nX\nj=1\n\nZj\n\n\u2264 2 max\nx\u2208C\n\n\u221e\n\nM\nX\n\nZj (x) .\n\nj=1\n\np\nPM\n\u2265 2 3B(A + q)nq log n is a subset of the union of the |C| events\nTherefore, the event\nj=1 Zj\n\u221e\np\nP\n| M\n3B(A + q)nq log n, x \u2208 C. Hence, the estimate (6.6) implies (6.3) with c1 = 2c.\n\u2737\nj=1 Zj (x)| \u2265\nWe are now in a position to prove Theorem 4.1(c).\n\nR\nProof of Theorem 4.1(c). Let x \u2208 Sq . In this proof only, let Z\u03be = \u03a64n (h; x * \u03be) \u2212 \u03a64n (h; x * \u03b6)d\u03bcq (\u03b6).\nThen the mean of each Z\u03be is 0, and its variance can be estimated by\nZ\nZ\nZ\u03be2 d\u03bcq (\u03be) \u2264 (\u03a64n (h; x * \u03be))2 d\u03bcq (\u03be) \u2264 cnq .\nFinally, |Z\u03be | \u2264 cnq for each \u03be. Hence, we may use Lemma 6.2 with cM in place of B, and c in place of\nR, to conclude that\n\uf8f6\n\uf8eb\nr\nZ\nq log n\nX\nn\n1\n\uf8f8 \u2264 cn\u2212A ,\n\u03a64n (h; x * \u03be) \u2212 \u03a64n (h; x * \u03b6)d\u03bcq (\u03b6) \u2265 c2\nProb \uf8ed sup\nM\nx\u2208Sq M\n\u03be\u2208C\n\nand with M \u2265 cnq log n/\u03b7 2 ,\n\uf8eb\n\n\uf8f6\nZ\nX\n1\n\u03a64n (h; x * \u03be) \u2212 \u03a64n (h; x * \u03b6)d\u03bcq (\u03b6) \u2265 \u03b7 \uf8f8 \u2264 cn\u2212A .\nProb \uf8ed sup\nx\u2208Sq M\n\u03be\u2208C\n\nSince any P \u2208 \u03a0q2n can be written in the form\nZ\nP (\u03b6) = P (x)\u03a64n (h; x * \u03b6)d\u03bcq (x),\nwe see that with probability exceeding 1 \u2212 cn\u2212A ,\nZ\n1 X\nP (\u03be) \u2212 P (\u03b6)d\u03bcq (\u03b6)\nM\n\u03be\u2208C\n\n20\n\n\f=\n\nZ\n1 X\nP (x)\u03a64n (h; \u03be * x)d\u03bcq (x)\nM\n\u03be\u2208C\nZ Z\n\u2212\nP (x)\u03a64n (h; x * \u03b6)d\u03bcq (x)d\u03bcq (\u03b6)\n\nZ\n1 X\n\u03a64n (h; \u03be * x) \u2212 \u03a64n (h; x * \u03b6)d\u03bcq (\u03b6) d\u03bcq (x)\n\u2264\n|P (x)|\nM\n\u03be\u2208C\nZ\n\u2264 \u03b7 |P (x)|d\u03bcq (x).\nZ\n\nFor P \u2208 \u03a0qn , we may now apply this estimate with P 2 \u2208 \u03a0q2n .\n\n\u2737\n\nAnother immediate consequence of Lemma 6.2 is the following lemma, describing the the probabilistic\nbehavior of the operator \u03c3n (C, W; h).\nLemma 6.3 Suppose that m \u2265 1 is an integer, C = {\u03bej }M\nj=1 admits an M\u2013Z quadrature of order m, and\nlet W be the corresponding quadrature weights. Let R, V > 0, and for j = 1, * * * , M , \u01ebj be independent\nrandom variables with mean 0, variance not exceeding V , and range [\u2212R, R]. Let g \u2208 C(Sq ), kgk\u221e \u2264 1,\nand E = {\u01ebj g(\u03bej )}\u03bej \u2208C \u2032 . Then for integer n \u2265 1 with (R2 /V )(A + q)nq log n \u2264 c3 mq ,\n!\nr\nV (A + q)nq log n\nProb k\u03c3n (C, W; h; E)k\u221e \u2265 c1\n\u2264 c2 n\u2212A .\n(6.7)\nmq\nHere, the positive constants c1 , c2 , c3 depend only on q but not on M and the distributions of \u01ebj .\n\nProof. In this proof only, if \u03be = \u03bej \u2208 C, we will write \u01eb\u03be for \u01ebj and w\u03be for the weight in W corresponding\nto \u03be. We use Lemma 6.2 with E\u03be = mq w\u03be \u01eb\u03be g(\u03be)\u03a6n (h; \u03be * \u25e6), \u03be \u2208 C. We note that the random variable\n\u03c9j in Lemma 6.2 is \u01eb\u03be in this case. It is clear that the mean of each E\u03be is 0. Since (2.12) implies that\n|w\u03be | \u2264 cm\u2212q , (2.7) shows that kE\u03be k\u221e \u2264 cRnq . Moreover, for any x \u2208 Sq , the variance of E\u03be (x) does not\nexceed V m2q w\u03be2 \u03a6n (h; \u03be * x)2 . In view of the fact that w\u03be are M\u2013Z quadrature weights, (2.12) and (2.7)\nimply that\nX\nX\nm2q w\u03be2 \u03a6n (h; \u03be * x)2 \u2264 cmq\n|w\u03be |\u03a62n (h; \u03be * x)\n\u03be\u2208C\n\n\u2264\n\ncmq\n\nZ\n\nSq\n\n\u03be\u2208C\n\n\u03a62n (h; \u03b6 * x)d\u03bcq (\u03b6) \u2264 cmq nq .\n\nThus, we may choose B in Lemma 6.2 to be cV mq . The estimate (6.7) now follows as a simple consequence\nof (6.3).\n\u2737\nWe are now in a position to prove the probabilistic assertions of Theorems 3.1 and 3.2.\nProof of Theorem 3.1(b). To prove part (b), we use Lemma 6.3 with g \u2261 1. Since the range of \u01ebj 's\nis contained in [\u22121, 1], we may take R = V = 1, and obtain from (6.7) that\n!\nr\n(A + q)nq log n\n\u2264 c2 n\u2212A .\nProb k\u03c3n (C, W; h; E)k\u221e \u2265 c4\nmq\nThe choice of n with an appropriate c3 , ensures that (A + q)nq log n/mq \u2264 n\u22122r . Therefore,\n\u0001\nProb k\u03c3n (C, W; h; E)k\u221e \u2265 c4 n\u2212r \u2264 c2 n\u2212A .\n\nThe estimate (3.8) is now clear in view of (3.4) and the linearity of the operators \u03c3n (C, W; h).\n\n\u2737\n\nProof ofTheorem 3.2(b). We apply Lemma 6.3 again with g \u2261 1. As before, we may choose\nR = V = 1. The choice of n with an appropriate c3 , ensures that (A + q)nq log n/mq \u2264 n\u22122r . Therefore,\n(6.7) with these choices implies that\n\u0001\nProb k\u03c3n (C, W; h; E)k\u221e \u2265 c4 n\u2212r \u2264 c2 n\u2212A .\n21\n\n\fTogether with (3.9) and the linearity of the operators \u03c3n (C, W; h), this leads to (3.10).\n\n7\n\n\u2737\n\nConclusion\n\nWe have described a construction of linear operators yielding spherical polynomial approximations based\non scattered data on a Euclidean sphere. While the operators can be defined for arbitrary continuous\nfunctions on the sphere, without any a priori knowledge about the location and nature of its singularities,\nthey are auto\u2013adaptive in the sense that the approximation properties of these globally defined polynomials adapt themselves on the different parts of the sphere according to the smoothness of the target\nfunction on these parts. While the theoretical properties of these operators and their localization were\nstudied in [18], a bottleneck in their numerical construction was the construction of quadrature formulas\nbased on scattered data, exact for integrating moderately high degree spherical polynomials. So far, it\nwas possible only to compute quadrature formulas exact at most for degree 18 polynomials. We show\nthat a simple\u2013minded construction involving a Gram matrix is surprisingly well conditioned, and yields\nthe necessary quadrature rules, up to degree 178. Using these newly constructed quadrature formulas,\nwe are able to demonstrate that our constructions yield superior approximation properties to those of\nmore traditional techniques of least squares and Fourier projection, in the sense that the presence of\nsingularities in some parts of the sphere affects the degree of approximation by our operators on other\nparts far less than in the case of these other traditional techniques. We give probabilistic estimates on\nthe local and global degrees of approximation by our operators in the presence of noise, and demonstrate\nits use in the modeling of a \"real life\" data set. We also describe a theoretical algorithm for construction\nof data dependent multivariate orthogonal polynomials and their use in the construction of quadrature\nformulas, analogous to the univariate algorithms in the book [11] of Gautschi.\n\nReferences\n[1] C. de Boor, \"A practical guide to splines\", Springer Verlag, New York, 1978.\n[2] R. A. DeVore and G. G. Lorentz, \"Constructive approximation\", Springer Verlag, Berlin, 1993.\n[3] J. R. Driscoll and D. M. Healy, Computing Fourier transforms and convolutions on the 2sphere, Adv. in Applied Math. 15, 202-250 (1994).\n[4] C. F. Dunkl and Y. Xu, \"Orthogonal polynomials of several variables\", Cambridge University\nPress, Cambridge, 2001.\n[5] A. Erd\u00e9lyi (ed.), W. Magnus, F. Oberhettinger and F. G. Tricomi (research associates), \"Higher Transcendental Functions, Volume II\", California Institute of Technology, Bateman\nManuscript Project, McGraw-Hill Book Company, Inc., New York, Toronto, London, 1953.\n[6] B. Fischer, From orthogonal polynomials to iteration schemes for linear systems: CG and CR\nrevisited, in \"Wavelet Analysis and Applications, Proceedings of the international workshop in Delhi,\n1999\" (P. K. Jain, M. Krishnan, H. N. Mhaskar J. Prestin, and D. Singh Eds.), Narosa Publishing,\nNew Delhi, India, 2001, 225-247.\n[7] W. Freeden, M. Schreiner, and R. Franke, A Survey on Spherical Spline Approximation,\nSurveys Math. Indust. 7 (1997), 29-85.\n[8] W. Freeden, T. Gervens, and M. Schreiner, \"Constructive approximation on the sphere, with\napplications to geomathematics\", Clarendon Press, Oxford, 1998.\n[9] W. Freeden and V. Michel, \"Multiscale potential theory, with applications to geoscience\",\nBirkh\u00e4user, Boston, 2004.\n22\n\n\f[10] M. Ganesh and H. N. Mhaskar, Matrix\u2013free interpolation on the sphere, SIAM J. Numer. Analysis 44 (3) (2006), pp. 1314\u20131331.\n[11] W. Gautschi, \"Orthogonal Polynomials: Computation and Approximation\", Oxford University\nPress, 2004.\n[12] K. Hesse, H. N. Mhaskar, and I. H. Sloan, Quadrature in Besov spaces on the Euclidean\nsphere, Accepted for publication in Journal of Complexity.\n[13] R. A. Horn and C. R. Johnson, \"Matrix analysis\", Cambridge University Press, 1985.\n[14] J. Keiner, Fast Spherical Fourier Transforms and Applications, Diplomarbeit, Universit\u00e4t zu\nL\u00fcbeck, 2005.\n[15] Q. T. Le Gia and H. N. Mhaskar, Polynomial operators and local approximation of solutions of\npseudo-differential equations on the sphere, Numer. Math., 103 (2006), 299\u2013322.\n[16] P. I. Lizorkin and Kh. P. Rustamov, Nikolskii\u2013Besov spaces on the sphere in connection with\napproximation theory, Tr. Mat. Inst. Steklova, 204 (1993), 172\u2013201 (Proc. Steklov Inst. Math., 3\n(1994), 149\u2013172).\n[17] H. N. Mhaskar, Polynomial operators and local smoothness classes on the unit interval, J. Approx.\nTheory, 131 (2004), 243-267.\n[18] H. N. Mhaskar, On the representation of smooth functions on the sphere using finitely many bits,\nAppl. Comput. Harmon. Anal., 18 (3) (2005), 215-233.\n[19] H. N. Mhaskar, Weighted quadrature formulas and approximation by zonal function networks on\nthe sphere, J. Complexity, 22 (2006), 348\u2013370.\n[20] H. N. Mhaskar, F. J. Narcowich, and J. D. Ward, Approximation Properties of Zonal Function Networks Using Scattered Data on the Sphere, Adv. Comput. Math., 11 (1999), 121-137.\n[21] H. N. Mhaskar, F. J. Narcowich and J. D. Ward, Spherical Marcinkiewicz-Zygmund inequalities and positive quadrature, Math. Comp. 70 (2001), no. 235, 1113\u20131130. (Corrigendum: Math.\nComp. 71 (2001), 453\u2013454.)\n[22] H. N. Mhaskar, F. Narcowich, J. Prestin, and J. D. Ward, Converse theorems for approximation by SBF networks, In preparation.\n[23] H. N. Mhaskar and J. Prestin, On the detection of singularities of a periodic function, Advances\nin Computational Mathematics, 12 (2000), 95\u2013131.\n[24] H. N. Mhaskar and J. Prestin, On local smoothness classes of periodic functions, Journal of\nFourier Analysis and Applications, 11 (3) (2005), 353 - 373.\n[25] C. M\u00fcller, \"Spherical Harmonics\", Lecture Notes in Mathematics, Vol. 17, Springer Verlag, Berlin,\n1966.\n[26] S. Pawelke, \u00dcber die Approximationsordnung bei Kugelfunktionen und algebraischen Polynomen,\nT\u00f4hoku Math. Journ., 24 (1972), 473\u2013486.\n[27] D. Pollard, Convergence of stochastic processes, Springer Verlag, New York, 1984.\n[28] D. Potts, G. Steidl, and M. Tasche, Fast algorithms for discrete polynomial transforms, Math.\nComp., 67 (1998), 1577\u20131590.\n[29] I. H. Sloan, Polynomial interpolation and hyperinterpolation over general regions, J. Approx. Theory 83 (1995), no. 2, 238\u2013254.\n[30] I. H. Sloan and A. Sommariva, Approximation on the sphere using radial basis functions plus\npolynomials, Manuscript.\n23\n\n\f[31] I. H. Sloan and R.S. Womersley, Extremal systems of points and numerical integration on the\nsphere, Adv. Comput. Math., 21 (2004), 107\u2013125.\n[32] E. M. Stein and G. Weiss, \"Fourier Analysis on Euclidean Spaces\", Princeton University Press,\nPrinceton, New Jersey, 1971.\n\n24\n\n\f"}