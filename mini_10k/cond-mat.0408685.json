{"id": "http://arxiv.org/abs/cond-mat/0408685v2", "guidislink": true, "updated": "2005-08-31T20:44:21Z", "updated_parsed": [2005, 8, 31, 20, 44, 21, 2, 243, 0], "published": "2004-08-31T10:52:45Z", "published_parsed": [2004, 8, 31, 10, 52, 45, 1, 244, 0], "title": "Ab-initio theory of superconductivity - I: Density functional formalism\n  and approximate functionals", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cond-mat%2F0408369%2Ccond-mat%2F0408394%2Ccond-mat%2F0408270%2Ccond-mat%2F0408498%2Ccond-mat%2F0408546%2Ccond-mat%2F0408442%2Ccond-mat%2F0408331%2Ccond-mat%2F0408684%2Ccond-mat%2F0408041%2Ccond-mat%2F0408448%2Ccond-mat%2F0408682%2Ccond-mat%2F0408375%2Ccond-mat%2F0408341%2Ccond-mat%2F0408590%2Ccond-mat%2F0408483%2Ccond-mat%2F0408160%2Ccond-mat%2F0408672%2Ccond-mat%2F0408412%2Ccond-mat%2F0408675%2Ccond-mat%2F0408131%2Ccond-mat%2F0408493%2Ccond-mat%2F0408158%2Ccond-mat%2F0408356%2Ccond-mat%2F0408469%2Ccond-mat%2F0408182%2Ccond-mat%2F0408701%2Ccond-mat%2F0408462%2Ccond-mat%2F0408500%2Ccond-mat%2F0408230%2Ccond-mat%2F0408365%2Ccond-mat%2F0408357%2Ccond-mat%2F0408458%2Ccond-mat%2F0408446%2Ccond-mat%2F0408211%2Ccond-mat%2F0408664%2Ccond-mat%2F0408565%2Ccond-mat%2F0408550%2Ccond-mat%2F0408092%2Ccond-mat%2F0408685%2Ccond-mat%2F0408010%2Ccond-mat%2F0408553%2Ccond-mat%2F0408575%2Ccond-mat%2F0408143%2Ccond-mat%2F0408339%2Ccond-mat%2F0408132%2Ccond-mat%2F0408695%2Ccond-mat%2F0408168%2Ccond-mat%2F0408432%2Ccond-mat%2F0408367%2Ccond-mat%2F0408625%2Ccond-mat%2F0408134%2Ccond-mat%2F0408075%2Ccond-mat%2F0408618%2Ccond-mat%2F0408073%2Ccond-mat%2F0408313%2Ccond-mat%2F0408473%2Ccond-mat%2F0408210%2Ccond-mat%2F0408042%2Ccond-mat%2F0408691%2Ccond-mat%2F0408334%2Ccond-mat%2F0408436%2Ccond-mat%2F0408398%2Ccond-mat%2F0408642%2Ccond-mat%2F0408451%2Ccond-mat%2F0408393%2Ccond-mat%2F0408514%2Ccond-mat%2F0408556%2Ccond-mat%2F0408476%2Ccond-mat%2F0408511%2Ccond-mat%2F0408661%2Ccond-mat%2F0408415%2Ccond-mat%2F0408491%2Ccond-mat%2F0408281%2Ccond-mat%2F0408224%2Ccond-mat%2F0408616%2Ccond-mat%2F0408219%2Ccond-mat%2F0408291%2Ccond-mat%2F0408370%2Ccond-mat%2F0408464%2Ccond-mat%2F0408603%2Ccond-mat%2F0408443%2Ccond-mat%2F0408506%2Ccond-mat%2F0408686%2Ccond-mat%2F0408082%2Ccond-mat%2F0408425%2Ccond-mat%2F0408050%2Ccond-mat%2F0408171%2Ccond-mat%2F0408265%2Ccond-mat%2F0408681%2Ccond-mat%2F0408496%2Ccond-mat%2F0408306%2Ccond-mat%2F0408547%2Ccond-mat%2F0408651%2Ccond-mat%2F0408579%2Ccond-mat%2F0408580%2Ccond-mat%2F0408635%2Ccond-mat%2F0408389%2Ccond-mat%2F0408358%2Ccond-mat%2F0408677%2Ccond-mat%2F0408558%2Ccond-mat%2F0408385&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Ab-initio theory of superconductivity - I: Density functional formalism\n  and approximate functionals"}, "summary": "A novel approach to the description of superconductors in thermal equilibrium\nis developed within a formally exact density-functional framework. The theory\nis formulated in terms of three ``densities'': the ordinary electron density,\nthe superconducting order parameter, and the diagonal of the nuclear N-body\ndensity matrix. The electron density and the order parameter are determined by\nKohn-Sham equations that resemble the Bogoliubov-de Gennes equations. The\nnuclear density matrix follows from a Schroedinger equation with an effective\nN-body interaction. These equations are coupled to each other via\nexchange-correlation potentials which are universal functionals of the three\ndensities. Approximations of these exchange-correlation functionals are derived\nusing the diagrammatic techniques of many-body perturbation theory. The bare\nCoulomb repulsion between the electrons and the electron-phonon interaction\nenter this perturbative treatment on the same footing. In this way, a truly\nab-initio description is achieved which does not contain any empirical\nparameters.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=cond-mat%2F0408369%2Ccond-mat%2F0408394%2Ccond-mat%2F0408270%2Ccond-mat%2F0408498%2Ccond-mat%2F0408546%2Ccond-mat%2F0408442%2Ccond-mat%2F0408331%2Ccond-mat%2F0408684%2Ccond-mat%2F0408041%2Ccond-mat%2F0408448%2Ccond-mat%2F0408682%2Ccond-mat%2F0408375%2Ccond-mat%2F0408341%2Ccond-mat%2F0408590%2Ccond-mat%2F0408483%2Ccond-mat%2F0408160%2Ccond-mat%2F0408672%2Ccond-mat%2F0408412%2Ccond-mat%2F0408675%2Ccond-mat%2F0408131%2Ccond-mat%2F0408493%2Ccond-mat%2F0408158%2Ccond-mat%2F0408356%2Ccond-mat%2F0408469%2Ccond-mat%2F0408182%2Ccond-mat%2F0408701%2Ccond-mat%2F0408462%2Ccond-mat%2F0408500%2Ccond-mat%2F0408230%2Ccond-mat%2F0408365%2Ccond-mat%2F0408357%2Ccond-mat%2F0408458%2Ccond-mat%2F0408446%2Ccond-mat%2F0408211%2Ccond-mat%2F0408664%2Ccond-mat%2F0408565%2Ccond-mat%2F0408550%2Ccond-mat%2F0408092%2Ccond-mat%2F0408685%2Ccond-mat%2F0408010%2Ccond-mat%2F0408553%2Ccond-mat%2F0408575%2Ccond-mat%2F0408143%2Ccond-mat%2F0408339%2Ccond-mat%2F0408132%2Ccond-mat%2F0408695%2Ccond-mat%2F0408168%2Ccond-mat%2F0408432%2Ccond-mat%2F0408367%2Ccond-mat%2F0408625%2Ccond-mat%2F0408134%2Ccond-mat%2F0408075%2Ccond-mat%2F0408618%2Ccond-mat%2F0408073%2Ccond-mat%2F0408313%2Ccond-mat%2F0408473%2Ccond-mat%2F0408210%2Ccond-mat%2F0408042%2Ccond-mat%2F0408691%2Ccond-mat%2F0408334%2Ccond-mat%2F0408436%2Ccond-mat%2F0408398%2Ccond-mat%2F0408642%2Ccond-mat%2F0408451%2Ccond-mat%2F0408393%2Ccond-mat%2F0408514%2Ccond-mat%2F0408556%2Ccond-mat%2F0408476%2Ccond-mat%2F0408511%2Ccond-mat%2F0408661%2Ccond-mat%2F0408415%2Ccond-mat%2F0408491%2Ccond-mat%2F0408281%2Ccond-mat%2F0408224%2Ccond-mat%2F0408616%2Ccond-mat%2F0408219%2Ccond-mat%2F0408291%2Ccond-mat%2F0408370%2Ccond-mat%2F0408464%2Ccond-mat%2F0408603%2Ccond-mat%2F0408443%2Ccond-mat%2F0408506%2Ccond-mat%2F0408686%2Ccond-mat%2F0408082%2Ccond-mat%2F0408425%2Ccond-mat%2F0408050%2Ccond-mat%2F0408171%2Ccond-mat%2F0408265%2Ccond-mat%2F0408681%2Ccond-mat%2F0408496%2Ccond-mat%2F0408306%2Ccond-mat%2F0408547%2Ccond-mat%2F0408651%2Ccond-mat%2F0408579%2Ccond-mat%2F0408580%2Ccond-mat%2F0408635%2Ccond-mat%2F0408389%2Ccond-mat%2F0408358%2Ccond-mat%2F0408677%2Ccond-mat%2F0408558%2Ccond-mat%2F0408385&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A novel approach to the description of superconductors in thermal equilibrium\nis developed within a formally exact density-functional framework. The theory\nis formulated in terms of three ``densities'': the ordinary electron density,\nthe superconducting order parameter, and the diagonal of the nuclear N-body\ndensity matrix. The electron density and the order parameter are determined by\nKohn-Sham equations that resemble the Bogoliubov-de Gennes equations. The\nnuclear density matrix follows from a Schroedinger equation with an effective\nN-body interaction. These equations are coupled to each other via\nexchange-correlation potentials which are universal functionals of the three\ndensities. Approximations of these exchange-correlation functionals are derived\nusing the diagrammatic techniques of many-body perturbation theory. The bare\nCoulomb repulsion between the electrons and the electron-phonon interaction\nenter this perturbative treatment on the same footing. In this way, a truly\nab-initio description is achieved which does not contain any empirical\nparameters."}, "authors": ["M. L\u00fcders", "M. A. L. Marques", "N. N. Lathiotakis", "A. Floris", "G. Profeta", "L. Fast", "A. Continenza", "S. Massidda", "E. K. U. Gross"], "author_detail": {"name": "E. K. U. Gross"}, "author": "E. K. U. Gross", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevB.72.024545", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/cond-mat/0408685v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/cond-mat/0408685v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "18 pages, 4 figures, 1 table, revised version", "arxiv_primary_category": {"term": "cond-mat.supr-con", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.supr-con", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/cond-mat/0408685v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/cond-mat/0408685v2", "journal_reference": "Phys.Rev.B72:024545,2005", "doi": "10.1103/PhysRevB.72.024545", "fulltext": "arXiv:cond-mat/0408685v2 [cond-mat.supr-con] 31 Aug 2005\n\nAb-initio theory of superconductivity \u2013 I: Density functional formalism and\napproximate functionals\nM. L\u00fcders,1, 2 M. A. L. Marques,3, 2 N. N. Lathiotakis,3, 2 A. Floris,3, 4\nG. Profeta,5 L. Fast,6, 2 A. Continenza,5 S. Massidda,4, \u2217 and E. K. U. Gross3, 2\n1\n\nDaresbury Laboratory, Warrington WA4 4AD, United Kingdom\nInstitut f\u00fcr Theoretische Physik, Universit\u00e4t W\u00fcrzburg, Am Hubland, D-97074 W\u00fcrzburg, Germany\n3\nInstitut f\u00fcr Theoretische Physik, Freie Universit\u00e4t Berlin, Arnimallee 14, D-14195 Berlin, Germany\n4\nINFM SLACS, Sardinian Laboratory for Computational Materials Science and Dipartimento di Scienze Fisiche,\nUniversit\u00e0 degli Studi di Cagliari, S.P. Monserrato-Sestu km 0.700, I\u201309124 Monserrato (Cagliari), Italy\n5\nCASTI - Istituto Nazionale Fisica della Materia (INFM) and Dipartimento di Fisica,\nUniversit\u00e0 degli studi dell'Aquila, I-67010 Coppito (L'Aquila) Italy\n6\nSP Swedish National Testing and Research Institute, P.O.B. 857, S-501 15 Bor\u00e5s, Sweden\n(Dated: November 3, 2018)\n2\n\nA novel approach to the description of superconductors in thermal equilibrium is developed within\na formally exact density-functional framework. The theory is formulated in terms of three \"densities\": the ordinary electron density, the superconducting order parameter, and the diagonal of\nthe nuclear N -body density matrix. The electron density and the order parameter are determined\nby Kohn-Sham equations that resemble the Bogoliubov-de Gennes equations. The nuclear density\nmatrix follows from a Schr\u00f6dinger equation with an effective N -body interaction. These equations\nare coupled to each other via exchange-correlation potentials which are universal functionals of the\nthree densities. Approximations of these exchange-correlation functionals are derived using the diagrammatic techniques of many-body perturbation theory. The bare Coulomb repulsion between\nthe electrons and the electron-phonon interaction enter this perturbative treatment on the same\nfooting. In this way, a truly ab-initio description is achieved which does not contain any empirical\nparameters.\nPACS numbers: 74.25.Jb, 74.25.Kc, 74.20.-z, 74.70.Ad, 71.15.Mb\n\nI.\n\nINTRODUCTION\n\nOne of the great challenges of modern condensedmatter theory is the prediction of material specific properties of superconductors, such as the critical temperature Tc or the gap at zero temperature \u22060 . The model\nof Bardeen, Cooper and Scrieffer (BCS)1 successfully\ndescribes the universal features of superconductors, i.e.\nthose features which all (conventional, weak-coupling) superconductors have in common, like the universal value\nof the ratio 2\u22060 /kB Tc . The great achievement of BCS\ntheory was the microscopic identification of the superconducting order parameter which lead, after more than\n50 years of struggling, to a microscopic understanding of\nthe phenomenon of superconductivity.\nBCS theory, however, cannot be considered a predictive theory in the sense that it would allow the computation of material-specific properties. Moreover, materials with strong electron-phonon coupling, such as niobium or lead, are poorly described by BCS theory. In\nthese strong-coupling materials, phonon retardation effects play a very important role. A proper treatment of\nthose effects was developed by Eliashberg2,3 . His theory\ncan be viewed as a GW approximation4 in terms of the\nNambu-Gorkov5 Green's functions. Eliashberg's theory\nnot only achieves a successful description of the strong\ncoupling simple metals like Nb and Pb, it also provides\na convincing explanation of the superconducting features\nof more complex materials such as MgB2 6 .\n\nIn spite of its tremendous success, Eliashberg theory, in\nits practical implementation, has to be considered a semiphenomenological theory. While the electron-phonon interaction is perfectly accounted for, correlation effects\ndue to the electron-electron Coulomb repulsion are difficult to handle in this theory. Those effects are condensed\nin a single parameter, \u03bc\u2217 , which represents a measure\nof the effective electronic repulsion. Although \u03bc\u2217 could,\nin principle, be calculated by diagrammatic techniques3 ,\nfirst principles estimates of \u03bc\u2217 are extremely hard to\nmake, and in practice, \u03bc\u2217 is treated as an adjustable parameter, usually chosen such that the experimental Tc is\nreproduced.\nThe goal of this work is to develop a true ab-initio\ntheory for superconductivity which does not contain any\nadjustable parameters. The crucial point is to treat the\nelectron-phonon interaction and the Coulombic electronelectron repulsion on the same footing. This is achieved\nwithin a density-functional framework.\nDensity functional theory (DFT)7,8,9 enjoys enormous\npopularity as an electronic-structure method in solidstate physics, quantum chemistry and materials science.\nDFT combines good accuracy with moderate numerical\neffort and is often the method of choice especially for\nlarge molecules and solids with a big unit cell. DFT is\nbased on the Hohenberg-Kohn7 theorem which ensures\na rigorous 1\u20131 correspondence between the ground-state\ndensity and the external potential. At finite temperature,\nthe correspondence holds10 between the density in ther-\n\n\f2\nmal equilibrium and the external potential. As a consequence, all physical observables of an interacting electron\nsystem become functionals of the density. The practical\nimplementation of DFT rests on the Kohn-Sham8 scheme\nwhich maps the interacting system of interest on an auxiliary non-interacting system with the same ground-state\nthermal density.\nTraditional DFT, by its very nature, inevitably\ninvolves the Born-Oppenheimer approximation: One\nis supposed to calculate the electronic groundstate/thermal density that corresponds 1\u20131 to the electrostatic potential of clamped nuclei. To overcome this\nlimitation Kreibich and Gross (KG)11 recently presented\na multicomponent DFT which treats both electrons and\nnuclei quantum mechanically on the same footing. The\nKG theory involves two \"densities\": The electronic density n(r) referring to a body-fixed coordinate frame, and\nthe diagonal \u0393(R) of the nuclear N -body density matrix.\nThe exchange-correlation functional appearing in the resulting Kohn-Sham equations depends on both \"densities\" and contains, formally, all non-adiabatic couplings\nbetween the electrons and the nuclei.\nHence, in principle, the KG framework should be able\nto describe (conventional) superconductivity. In practice,\nhowever, it is not advisable to attempt such a description.\nThe situation is quite similar to the DFT treatment of\nmagnetic effects: By virtue of the Hohenberg-Kohn theorem, magnetic effects can be described on the basis of the\ndensity alone. In particular, the order parameter of spin\nmagnetism, the spin magnetization m(r), is a functional\nof the density m = m[n]. However, this functional has\nto be highly non-local and its explicit form is unknown.\nTherefore, it is advisable to include the order parameter\nm(r) as an additional \"density\" in the DFT formulation12 . This version of DFT is known as spin-DFT. It\nis the standard form of DFT which is employed in all\npractical applications.\nA similar idea was suggested in 1988 by Oliveira, Gross\nand Kohn (OGK)13 to treat superconductors in a DFT\nframework. OGK proposed the inclusion of the order parameter \u03c7(r, r \u2032 ) that characterizes the superconducting\nphase as a basic \"density\" in the DFT formulation. OGK\ndealt with singlet order parameters. A generalization to\ntriplet order parameters was given later14 .\nThe complexities of the many-body problem were cast\ninto an exchange and correlation term, but in contrast\nto ordinary density functional theory where a variety\nof functionals has appeared over the past thirty years,\nvery few exchange-correlation functionals have been proposed for the superconducting state. To our knowledge,\nonly a local density approximation describing the purely\nelectronic interactions has been presented15 . However,\nthe usefulness of the OGK approach was demonstrated\nby Gy\u00f6rffy and coworkers in their study of niobium and\nYBa2 Cu3 O7 using a semi-phenomenological parametrization of the exchange-correlation functional17,18 .\nThe OGK formulation was triggered by the discovery\nof high-Tc superconductors19 where an electronic pair-\n\ning mechanism was believed to be dominant. Hence, the\nOGK description treats the Coulomb repulsion between\nelectrons formally exactly while the electron phonon coupling only enters through a given, non-retarded BCS-type\nelectron-electron interaction, i.e. strong electron-phonon\ncoupling cannot be dealt with.\nIn this work we develop a DFT for superconductors\nbased on the three densities n(r), \u03c7(r, r \u2032 ) and \u0393(R). The\nformalism can thus be viewed as a superconducting generalization of KG or as a strong coupling generalization\nof OGK. It leads to a set of - formally exact - Kohn-Sham\nequations for electrons and nuclei. These equations contain exchange-correlation potentials which are universal\nfunctionals of the three densities n, \u03c7 and \u0393. For the time\nbeing, we do not study effects found in the presence of\nmagnetic fields. Those can be accomodated by generalizing the framework to include the current density as an\nadditional variable20,21 .\nThe success of any density functional theory crucially\ndepends on the availability of accurate approximations\nfor the exchange-correlation functionals. The main body\nof this article is devoted to the construction of such approximate exchange-correlation functionals. Diagrammatic many-body perturbation theory is used for this\npurpose. In a second article (henceforth referred to as\nII), these approximate functionals are employed to calculate superconducting properties of elemental metals.\nThe present paper is organized as follows: In Sect. II\nwe derive a multicomponent DFT for the superconducting state. This theory leads to a set of Kohn-Sham equations that are described in the following section. Sect. IV\nis devoted to the development of Kohn-Sham perturbation theory. The resulting exchange-correlation potentials are discussed in Sect. V. A simple BCS-like model\nis described in Sect. VI. This model is used, in Sect. VII,\nto analyze the approximate exchange-correlation kernels\nentering the linearized DFT gap equation. Finally, in\nSect. VIII, the exchange-correlation contributions to the\nnon-linear gap equation are discussed.\n\nII.\n\nMULTICOMPONENT DFT FOR\nSUPERCONDUCTORS\n\nIt is clear that a balanced treatment of the electronphonon and Coulomb interactions has to start from the\nmany-body electron-nuclear Hamiltonian (atomic units\nare used throughout this paper)\n\u0124 = T\u0302 e + \u00db ee + T\u0302 n + \u00db nn + \u00db en ,\n\n(1)\n\nwhere T\u0302 e represents the electronic kinetic energy, \u00db ee the\nelectron-electron interaction, T\u0302 n the nuclear kinetic energy and \u00db nn the Coulomb repulsion between the nuclei.\nThe interaction between the electrons and the nuclei is\n\n\f3\ndescribed by the term:\nZ\nXZ\n\u00db en = \u2212\nd3 r d3 R \u03a8\u0302\u2020\u03c3 (r)\u03a6\u0302\u2020 (R)\n\nZ\n\u03a6\u0302(R)\u03a8\u0302\u03c3 (r) ,\n|r \u2212 R|\n\u03c3\n(2)\nwhere \u03a8\u0302\u2020\u03c3 (r) and \u03a6\u0302\u2020 (R) are respectively electron and\nnuclear creation operators. (For simplicity we assume\nthe nuclei to be identical, and we neglect the nuclear spin\ndegrees of freedom. The extension of this framework to\na more general case is straightforward.) Note that there\nis no external potential in the Hamiltonian.\nTo develop a multicomponent DFT for the electronnuclear system we have to proceed with care. The\nHamiltonian (1) describes a translationally invariant and\nisotropic system. Thus, both the electronic and nuclear\none-particle densities are constant and therefore not useful to characterize the system. This problem can be\nsolved by adopting a body-fixed reference frame11,22 . In\nthis article we are interested in infinite solids where the\nnuclei perform small oscillations around the equilibrium\npositions. Furthermore, we assume that the solid is not\nrotating as a whole. Fortunately, in this case, the bodyfixed reference frame coincides with the normal Cartesian\nsystem commonly used to describe solids. The situation\nis very different for finite systems, which have to be handled by using appropriate internal coordinates.\nIn order to formulate a Hohenberg-Kohn type statement, the Hamiltonian (1) is generalized to\ne\nn\n\u02c6 ext \u2212 \u03bcN\u0302 . (3)\n\u0124 = T\u0302 e + T\u0302 n + \u00db en + \u00db ee + V\u0302ext\n+ V\u0302ext\n+\u2206\n\nThe external potential for the electrons is defined as\nXZ\ne\ne\nV\u0302ext =\nd3 r \u03a8\u0302\u2020\u03c3 (r)vext\n(r)\u03a8\u0302\u03c3 (r) .\n(4)\n\u03c3\n\nSince, at this level, the nuclei are taken into account explicitly, the lattice potential is not treated as an external\nfield, but is included via the interaction term \u00db en . The\ne\nis introduced as a mathematical trick to prove\nterm V\u0302ext\nthe Hohenberg-Kohn theorem, and will be taken to zero\nn\nat the end of the derivation. V\u0302ext\nis a multiplicative N body operator with respect to the nuclear coordinates\nn\nV\u0302ext\n=\n\nZ\n\nn\nd3 R vext\n(R)\u0393\u0302(R) ,\n\n(5)\n\nwhere we have defined R = {R1 , R2 , * * * , RN }, d3 R =\nd3 R1 d3 R2 * * * d3 RN , and\n\u0393\u0302(R) = \u03a6\u0302\u2020 (R1 ) . . . \u03a6\u0302\u2020 (RN )\u03a6\u0302(RN ) . . . \u03a6\u0302(R1 )\n\n(6)\n\nis the diagonal part of the nuclear N -particle density man\ntrix operator. Note that the term V\u0302ext\nincludes the internn\naction between the nuclei \u00db (to which it reduces if no\nother external nuclear potentials are present). The term\n\u02c6 ext = \u2212\n\u2206\n\nZ\n\nZ\nh\ni\nd r d3 r\u2032 \u2206\u2217ext (r, r \u2032 )\u03a8\u0302\u2191 (r)\u03a8\u0302\u2193 (r \u2032 ) + h.c.\n3\n\n(7)\n\ndescribes an external pairing field, and usually vanishes\nunless our system is in the proximity of an adjacent superconductor. However, this term is required to break\nthe gauge invariance of the Hamiltonian, and the limit\n\u2206ext \u2192 0 can only be taken at the end of the derivation. Note that the term (7) describes a singlet pairing field. The extension to triplet superconductors is\nstraightforward14. Finally, \u03bc stands for the chemical potential, and N\u0302 is the number operator for the electrons\n(we treat the electronic degrees of freedom in a grandcanonical ensemble).\nOur multicomponent formulation is based on three\ndensities:\ni) The electronic density\nn(r) =\n\nX\n\u03c3\n\nh\u03a8\u0302\u2020\u03c3 (r)\u03a8\u0302\u03c3 (r)i ,\n\n(8)\n\nwhich is defined in the usual way. The bracket h* * * i\ndenotes the thermal average h\u00c2i = Tr{\u03c1\u03020 \u00c2}, with\nthe grand canonical statistical density operator \u03c1\u03020 =\ne\u2212\u03b2 \u0124 /Tr{e\u2212\u03b2 \u0124 } in the superconducting state. We furthermore define the inverse temperature \u03b2 = 1/T .\nii) The anomalous density\n\u03c7(r, r \u2032 ) = h\u03a8\u0302\u2191 (r)\u03a8\u0302\u2193 (r \u2032 )i ,\n\n(9)\n\nwhich is the order parameter characterizing the singlet\nsuperconducting state. This quantity is finite for superconductors below the transition temperature and zero\nabove this temperature.\niii) To describe the nuclear degrees of freedom, we use\nthe diagonal part of the nuclear N -particle density matrix\n\u0393(R) = h\u0393\u0302(R)i. Alternatively, one could define a multicomponent DFT using the one-particle density for the\nnuclei nn (R) = h\u03a6\u0302\u2020 (R)\u03a6\u0302(R)i. However, in the following\nit will be convenient to transform the nuclear degrees of\nfreedom to collective (phonon) coordinates. Using nn (R)\nwould lead to a one body equation for non-interacting nuclei. Thus, the nuclear Kohn-Sham equation would not\nlead to realistic phonons with a proper dispersion relation. Only Einstein phonons could be present in this\nsystem. This is also clear from the fact that a system\nof non-interacting particles does not exhibit collective\nmodes. With our choice of \u0393(R), the nuclei obey a N particle equation, very similar to the Born-Oppenheimer\nequation, and where phonon coordinates can be easily\nintroduced.\nAs usual, the Hohenberg-Kohn theorem guarantees a one-to-one mapping between the set of\nthe densities {n(r), \u03c7(r, r \u2032 ), \u0393(R)} in thermal equilibrium and the set of their conjugate potentials\ne\nn\n{vext\n(r), \u2206ext (r, r \u2032 ), vext\n(R)}. As a consequence all observables are functionals of the set of densities. Finally\n\n\f4\nit assures that the grand canonical potential,\nZ\ne\n\u03a9[n, \u03c7, \u0393] = F [n, \u03c7, \u0393] + d3 r n(r)[vext\n(r) \u2212 \u03bc]\nZ\nZ\n\u2212 d3 r d3 r\u2032 [\u03c7(r, r \u2032 )\u2206\u2217ext (r, r \u2032 ) + h.c.]\nZ\nn\n+ d3 R \u0393(R)vext\n(R) , (10)\nis minimized by the equilibrium densities. We use the\nnotation A[f ] to denote that A is a functional of f . The\nfunctional F [n, \u03c7, \u0393] is universal, in the sense that it does\nnot depend on the external potentials, and is defined by\nF [n, \u03c7, \u0393] = T e [n, \u03c7, \u0393] + T n [n, \u03c7, \u0393]\n+ U en [n, \u03c7, \u0393] + U ee [n, \u03c7, \u0393] \u2212\n\n1\nS[n, \u03c7, \u0393] (11)\n\u03b2\n\nwhere S stands for the entropy of the system\nS[n, \u03c7, \u0393] = \u2212Tr{\u03c1\u03020 [n, \u03c7, \u0393] log(\u03c1\u03020 [n, \u03c7, \u0393])} .\n\n(12)\n\nThe proof of the theorem follows closely the proof of the\nHohenberg-Kohn theorem at finite temperatures10 and\nwill not be presented here.\nIn standard DFT one normally defines a Kohn Sham\nsystem, i.e. a non-interacting system chosen such that\nit has the same ground-state density as the interacting\none. In our formulation, the Kohn-Sham system consists\nof non-interacting (superconducting) electrons, and interacting nuclei. It is described by the thermodynamic\npotential [cf. Eq. (10)]\nZ\n\n\u03a9s [n, \u03c7, \u0393] = Fs [n, \u03c7, \u0393] + d3 r n(r)[vse (r) \u2212 \u03bcs ]\nZ\nZ\n\u2212 d3 r d3 r\u2032 [\u03c7(r, r \u2032 )\u2206\u2217s (r, r \u2032 ) + h.c.]\nZ\n+ d3 R \u0393(R)vsn (R) , (13)\nwhere Fs if the counterpart of (11) for the Kohn-Sham\nsystem, i.e.,\n1\nFs [n, \u03c7, \u0393] = Tse [n, \u03c7, \u0393]+Tsn [n, \u03c7, \u0393]\u2212 Ss [n, \u03c7, \u0393] . (14)\n\u03b2\nTse [n, \u03c7, \u0393], Tsn[n, \u03c7, \u0393]\n\nHere\nand Ss [n, \u03c7, \u0393] are the electronic and nuclear kinetic energies and the entropy of\nthe Kohn-Sham system, respectively.\nFrom Eq. (13) it is clear that the Kohn-Sham nuclei\ninteract with each other through the N -body potential\nvsn (R) while they do not interact with the electrons.\nBy applying the Hohenberg-Kohn theorem to both the\ninteracting and the non-interacting systems, and requiring the densities of the Kohn-Sham system to reproduce\nthe densities of the fully interacting one, we can identify\nthe expressions for the effective Kohn-Sham potentials.\nAs usual, these include contributions from external fields,\n\nHartree, and exchange-correlation terms. The latter account for all the many-body effects stemming from the\nelectron-electron and electron-nuclear interactions. To\nsimplify the expressions, we now set the auxiliary external potentials to zero.\nThe Kohn-Sham potential for the electrons vse (r) reads\nas\nXZ\n\u0393(R)\nvse [n, \u03c7, \u0393](r) = \u2212Z\nd3 R\n|r\n\u2212 R\u03b1 |\n\u03b1\nZ\n\u2032\nn(r )\ne\n+ d3 r\u2032\n+ vxc\n[n, \u03c7, \u0393](r) . (15)\n|r \u2212 r \u2032 |\nThe first term, the electron-nuclear Hartree potential,\nreduces to the usual nuclear attraction potential if we\nassume that the nuclei are classical and perfectly localized at their equilibrium positions. This term is usually treated as the external potential in standard DFT.\nThe last two contributions to vse (r) are respectively the\nHartree potential, which accounts for the classical repulsion between the electrons, and the exchange-correlation\nterm.\nThe anomalous Kohn-Sham potential \u2206s is given by\n\u2206s [n, \u03c7, \u0393](r, r \u2032 ) = \u2212\n\n\u03c7(r, r \u2032 )\n+ \u2206xc [n, \u03c7, \u0393](r, r \u2032 ) . (16)\n|r \u2212 r \u2032 |\n\nNote that the first term, the so-called anomalous Hartree\npotential, gives rise to a positive contribution to the energy.\nFinally, the nuclear potential is\nvsn [n, \u03c7, \u0393](R) =\n\nX\n\n\u03b16=\u03b2\n\n\u2212Z\n\nXZ\n\u03b1\n\nd3 r\n\nZ2\n|R\u03b1 \u2212 R\u03b2 |\nn(r)\nn\n+ vxc\n[n, \u03c7, \u0393](R) .\n|r \u2212 R\u03b1 |\n\n(17)\n\nThe first term stems from \u00db nn , and describes the bare\nnuclear-nuclear repulsion. The second is the nuclearelectron Hartree term and is the counterpart of the first\nterm in Eq. (15).\nAs in standard DFT, the exchange-correlation potentials are defined as functional derivatives\n\u03b4Fxc [n, \u03c7, \u0393]\n,\n\u03b4n(r)\n\u03b4Fxc [n, \u03c7, \u0393]\n,\n\u2206xc [n, \u03c7, \u0393](r, r \u2032 ) = \u2212\n\u03b4\u03c7\u2217 (r, r \u2032 )\n\u03b4Fxc [n, \u03c7, \u0393]\nn\nvxc\n[n, \u03c7, \u0393](R) =\n.\n\u03b4\u0393(R)\ne\nvxc\n[n, \u03c7, \u0393](r) =\n\n(18a)\n(18b)\n(18c)\n\nThe exchange-correlation free energy is defined through\nthe equation\nF [n, \u03c7, \u0393] = Fs [n, \u03c7, \u0393] + Fxc [n, \u03c7, \u0393]\nee\nen\n+ U nn [\u0393] + EH\n[n, \u03c7] + EH\n[n, \u0393] . (19)\n\n\f5\nee\nThere are two contributions to EH\n, one stemming from\nthe electronic Hartree potential, and the other from the\nanomalous Hartree potential\n\nee\nEH\n[n, \u03c7] =\n\n1\n2\n\nZ\n\nZ\nn(r)n(r \u2032 )\nd3 r d3 r\u2032\n|r \u2212 r \u2032 |\nZ\nZ\n|\u03c7(r, r \u2032 )|2\n. (20)\n+ d3 r d3 r\u2032\n|r \u2212 r \u2032 |\n\nen\nFinally, EH\ndenotes the electron-nuclear Hartree energy\n\nen\nEH\n[n, \u0393]\n\nIII.\n\n= \u2212Z\n\nXZ\n\u03b1\n\nZ\nn(r)\u0393(R)\n.\nd r d3 R\n|r \u2212 R\u03b1 |\n3\n\n(21)\n\nThe problem of minimizing the Kohn-Sham grand\ncanonical potential (13) can be transformed into a set\nof three differential equations that have to be solved selfconsistently: Two of them are coupled and describe the\nelectronic degrees of freedom. Their algebraic structure\nis similar to the Bogoliubov-de Gennes equations. The\nthird is an equation for the nuclei resembling the familiar\nnuclear Born-Oppenheimer equation.\nElectronic equations\n\nThe Kohn-Sham Bogoliubov-de Gennes (KS-BdG)\nequations16 read\n\u0014\n\u0015\nZ\n\u22072\n\u2212\n+ vse (r) \u2212 \u03bc ui (r) +\nd3 r\u2032 \u2206s (r, r \u2032 )vi (r \u2032 )\n2\n\n= \u1ebci ui (r) ,\n(22a)\n\u0014\n\u0015\nZ\n2\n\u2207\n\u2212 \u2212\n+ vse (r) \u2212 \u03bc vi (r) +\nd3 r\u2032 \u2206\u2217s (r, r \u2032 )ui (r \u2032 )\n2\n= \u1ebci vi (r) ,\n\nwhich can be solved by standard band-structure methods. The decoupling approximation then implies the following form for the particle and hole amplitudes, where\nonly one term of the expansion is retained:\nui (r) \u2248 ui \u03c6i (r) ;\n\nTHE KOHN-SHAM EQUATIONS\n\nA.\n\nthe electronic band structure. The so-called decoupling\napproximation23,24,25 relieves the problem by separating\nthese two energy scales.\nThe particle and hole amplitudes can be expanded in\nthe complete set of wave functions {\u03c6i } of the normalstate Kohn-Sham equation\n\u0014\n\u0015\n\u22072\ne\n\u2212\n+ vs [n, \u03c7, \u0393](r) \u2212 \u03bc \u03c6i (r) = \u01ebi \u03c6i (r)\n(23)\n2\n\n(22b)\n\nwhere ui (r) and vi (r) are the particle and hole amplitudes. This equation is very similar to the Kohn-Sham\nequations in the OGK formalism13 . However, in our formulation the lattice potential is not considered as an external potential but enters via the electron-ion Hartree\nterm. Furthermore, our exchange-correlation potentials\ndepend parametrically on the nuclear density matrix, and\ntherefore on the phonons.\nAlthough these equations have the structure of static\nequations, they contain, in principle, all retardation effects through the exchange-correlation potentials.\nA direct solution of the Kohn-Sham Bogoliubov-de\nGennes equations17 is faced with the problem that one\nneeds extremely high accuracy to resolve the superconducting energy gap, which is about three orders of magnitude smaller than typical electronic energies. At the\nsame time, one has to cover the whole energy range of\n\nvi (r) \u2248 vi \u03c6i (r) .\n\n(24)\n\nIn this way the eigenvalues in Eq. (22) become \u1ebci = \u00b1Ei ,\nwhere\nq\nEi = \u03bei2 + |\u2206i |2 ,\n(25)\n\nand \u03bei = \u01ebi \u2212 \u03bc. This form of the eigenenergies allows\nthe interpretation of the matrix elements of the pair potential as the gap function of the superconductor. The\ncoefficients ui and vi also have simple expressions within\nthis approximation\ns\n\u03bei\n1\ni\u03c6i\n,\n(26a)\n1+\nui = \u221a sgn(\u1ebci )e\n2\n\u1ebci\ns\n1\n\u03bei\n1\u2212\n.\n(26b)\nvi = \u221a\n2\n\u1ebci\n\nFinally, the matrix elements \u2206i are defined as\nZ\nZ\n\u2206i = d3 r d3 r\u2032 \u03c6\u2217i (r)\u2206s (r, r \u2032 )\u03c6i (r \u2032 ) ,\n\n(27)\n\nand \u03c6i is the phase ei\u03c6i = \u2206i /|\u2206i |. Within the decoupling approximation, the normal and the anomalous densities can be easily obtained from the particle and hole\namplitudes\n\u0013\u0015\n\u0012\nX\u0014\n\u03bei\n\u03b2\n1\u2212\nn(r) =\ntanh\nEi |\u03c6i (r)|2 (28a)\nE\n2\ni\ni\n\u0013\n\u0012\nX \u2206i\n1\n\u03b2\n\u2032\n\u03c7(r, r ) =\ntanh\nEi \u03c6i (r)\u03c6\u2217i (r \u2032 ) (. 28b)\n2 i Ei\n2\nThe validity and limitations of the decoupling approximation will be discussed in detail in II.\nB.\n\nNuclear equation\n\nThe Kohn-Sham equation for the nuclei has the form\n#\n\"\nX \u22072\n\u03b1\nn\n(29)\n+ vs (R) \u03a6l (R) = El \u03a6l (R) .\n\u2212\n2M\n\u03b1\n\n\f6\nThis equation has the same structure as the usual nuclear Born-Oppenheimer equation. We emphasize that\nthe Kohn-Sham equation (29) does not rely on any approximation and is, in principle, exact. As already mentioned, we are interested in solids at relatively low temperature, where the nuclei perform small amplitude oscillations around their equilibrium positions. In this case,\nwe can expand the vsn [n, \u03c7, \u0393] in a Taylor series around\nthe equilibrium positions, and transform the nuclear degrees of freedom into collective (phonon) coordinates.\nIn harmonic order, the nuclear Kohn-Sham Hamiltonian\nthen reads\n\u0014\n\u0015\nX\n1\n\u2020\nph\n\u0124s =\n\u03a9\u03bb,q b\u0302\u03bb,q b\u0302\u2020\u03bb,q +\n,\n(30)\n2\n\u03bb,q\n\nwhere \u03a9\u03bb,q are the phonon eigenfrequencies, and b\u0302\u03bb,q destroys a phonon from the branch \u03bb and wave-vector q.\nNote that the phonon eigenfrequencies are functionals of\nthe set of densities {n, \u03c7, \u0393}, and can therefore be affected by the superconducting order parameter. Within\nthe harmonic approximation, the nuclear density matrix\n\u0393(R) is given by\nX\n\u0393(R) =\nn\u03b2 (\u03a9\u03bb,q )|h\u03bb,q (Q)|2\n(31)\n\nApproximate\nvse,0 [n, \u03c7, \u0393](r) , \u22060s [n, \u03c7, \u0393](r, r \u2032 ) , vsn,0 [n, \u03c7, \u0393](R)\n\u271b\n\u2744\n\u2744\nSolve electronic KS\nEq. (23) for \u03c6i (r)\n\n\u273b\n\u2744\nSolve nuclear KS\nEq. (29) in the\nharmonic approximation\n\n\u2744\ndecoupling approximation\n\u2744\ncalculate n, \u03c7\nthrough Eq. (28)\n\n\u2744\ncalculate \u0393\nthrough Eq. (31)\n\n\u2744\n\n\u2744\n\n\u2744\ncalculate the potentials\nvse [n, \u03c7, \u0393](r),\n\u2206s [n, \u03c7, \u0393](r, r \u2032 ),\nvsn [n, \u03c7, \u0393](R)\n\n\u03bb,q\n\nwhere n\u03b2 (\u03a9) denote the Bose occupation numbers and\nh\u03bb,q (Q) are harmonic oscillator wave functions referring\nto the collective coordinates Q.\n\n\u2744\nself-consistency\nconvergence check\n\nNo\n\n\u2732\n\nYes\n\nC.\n\nGap equation\n\nIn Fig. 1 we sketch the Kohn-Sham self-consistent procedure within the decoupling approximation. We start by\nfinding suitable approximations for the Kohn-Sham potentials to start the cycle: for vse,0 [n, \u03c7, \u0393] we can use the\nKohn-Sham potential stemming from a standard DFT\ncalculation for the non-superconducting ground-state, i.e,\nvsGS [n]. This is a very good approximation as the dependence of vse [n, \u03c7, \u0393] on \u03c7 and \u0393 is certainly very weak\nfor the usual superconductors at low temperature; The\nstarting pair potential \u22060s [n, \u03c7, \u0393] can be approximated\nby a square well centered at the Fermi energy with width\nof the order of the Debye frequency and height computed\nfrom a BCS model; Finally, for vsn,0 [n, \u03c7, \u0393] we can use\nthe ground-state Born-Oppenheimer potential. The next\ntwo steps of the self-consistent cycle can be performed in\nparallel:\n\u2022 Equation (23) is solved to obtain the wavefunctions \u03c6i 's and the eigenenergies \u01ebi 's. These can\nthen be used within the decoupling approximation,\nequation (24), to calculate the normal and anomalous densities through Eqs. (28). We note that the\nchemical potential \u03bc entering Eq. (23) has to be\nadjusted at every iteration, such that the density\nn(r) integrates to the correct particle number N .\n\n\u2744\n\noutput\n\nFIG. 1: Schematic flow chart for the iterative Kohn-Sham\nscheme within the decoupling approximation.\n\n\u2022 With vsn [n, \u03c7, \u0393] we solve the nuclear equation (29)\nby expanding the nuclear potential to harmonic\norder to obtain the phonon eigenfrequencies and\neigenmodes. The nuclear density matrix \u0393 then\nfollows from Eq. (31).\nFinally, the set of densities {n, \u03c7, \u0393} is used to evaluate\nthe new Kohn-Sham potentials {vse , \u2206s , vsn } from the definitions (15,16,17). At this point, if self-consistency is\nreached, the cycle is stopped. Otherwise, the new potentials are used to restart the cycle.\nIt is clear that, even within the decoupling approximation, the task of solving the self-consistent cycle depicted in Fig. 1 is rather demanding. Furthermore, we\nare required to provide (good) approximations for the\nthree functionals vse [n, \u03c7, \u0393], \u2206s [n, \u03c7, \u0393], and vsn [n, \u03c7, \u0393].\nAs our objective is to study superconductivity, we will\nmake two simplifying assumptions: i) vse [n, \u03c7, \u0393] can be\nwell approximated by the ground state functional used\n\n\f7\nin standard density functional theory vsGS [n]. As the\nenergy scale of the phonons and of the superconducting gap is three orders of magnitude smaller than electronic energy scales (like the Fermi energy) this is a\nvery reasonable assumption. ii) The nuclear functional\nvsn [n, \u03c7, \u0393] is approximated by the ground-state BornOppenheimer energy surface. It is well known that calculations performed within the Born-Oppenheimer approximation yield phonon frequencies that are in excellent\nagreement with experimental dispersions26 . We therefore\nexpect this to be an excellent approximation to the KohnSham phonons. However, we are neglecting the effect of\nthe superconducting pair potential on the phonon dispersion. This effect has been measured experimentally27 ,\nand it turns out to be quite small. Note that these two\napproximations are equivalent to fixing vse [n, \u03c7, \u0393] and\nvsn [n, \u03c7, \u0393] to vse,0 [n, \u03c7, \u0393] and vsn,0 [n, \u03c7, \u0393].\nBy inserting Eqs. (28) in Eq. (16) and by subsequently\ninserting Eq. (16) on the right-hand side of Eq. (27), we\nobtain the DFT gap equation\n\u2206i = \u2206Hxc i [\u03bc, \u2206i ] ,\n\n(32)\n\nwhere \u2206Hxc stands for the sum of the Hartree and\nexchange-correlation contributions to the functional.\nNote that through the exchange-correlation functional\nthe right-hand side of Eq. (32) becomes a highly complicated functional of \u03bc and \u2206i . The dependence on the\ngap function is totally different from the usual mean-field\ngap equation (cf. Sect VIII).\nAfter these simplifying approximations, a Kohn-Sham\ncalculation proceeds as follows: i) Using a standard\nband structure code, the ground state wave-functions and\nband structure are obtained. ii) The Born-Oppenheimer\nphonon frequencies and eigenmodes are obtained from\nlinear-response26 calculations, again using standard tools\nwidely available to the community. iii) The gap equation (32) is iterated until self-consistency is achieved. We\ncan now see how the different energy scales are separated: The normal density, the anomalous density, and\nthe phonon properties are obtained from three separate\nequations.\nIn the vicinity of the transition temperature, the\nanomalous density will be vanishingly small. In this\nregime, the gap-equation can be linearized in \u03c7, leading\nto\n\u0011\n\u0010\n\u03b2\ntanh\n\u03be\nX\nj\n2\n \u0306i = \u22121\n \u0306j ,\n\u2206\nFHxc i,j [\u03bc]\n\u2206\n(33)\n2 j\n\u03bej\nwhere the anomalous Hartree exchange-correlation kernel\nof the homogeneous integral equation reads\nFHxc i,j [\u03bc] = \u2212\n\n\u03b4\u2206Hxc i\n\u03b4\u03c7j\n\n=\n\u03c7=0\n\nee\n\u03b4 2 (EH\n+ Fxc )\n\u03b4\u03c7\u2217i \u03b4\u03c7j\n\n.\n\u03c7=0\n\n(34)\nWe emphasize that the linearized gap equation can only\nbe used to calculate the superconducting transition tem \u0306 i that stems from\nperature. In particular, the function \u2206\n\nthe solution of this equation does not have any physical\ninterpretation.\nWe can gain further insight into Eq. (33) if we separate\nthe kernel FHxc i,j into a purely diagonal term, Zi , and\na non-diagonal part, Ki,j\n \u0306 i = \u2212Zi [\u03bc] \u2206\n \u0306i \u2212\n\u2206\n\n1X\n\n2\n\nj\n\ntanh\nKi,j [\u03bc]\n\n\u0010\n\n\u03bej\n\n\u03b2\n2 \u03bej\n\n\u0011\n\n \u0306j ,\n\u2206\n\n(35)\n\nThis equation has the same structure as the BCS gap\nequation with the kernel Ki,j replacing the model interaction of BCS theory. On the other hand, Zi plays a similar\nrole as the renormalization term in the Eliashberg equations. This similarity allows one to interpret the kernel\nKi,j as an effective interaction responsible for the binding\nof the Cooper pairs. The function Ki,j is a quantity of\ncentral importance in the density functional theory for\nsuperconductors. By studying Ki,j for a specific material as a function of i and j one can learn which orbitals\nare responsible for superconductivity and, ultimately, by\nidentifying those parts of the exchange-correlation functional (phononic/Coulombic) that lead to an effective attraction, one can trace the mechanism responsible for the\nsuperconducting state.\nNote that Eq. (35) is considerably simpler than the\nEliashberg equations as it does not dependent explicitly\non the frequency. However, phonon retardation effects\nare included through the exchange-correlation terms.\nFurthermore, Eq. (35) is not a mean-field equation like in\nBCS theory but contains correlation effects. A linearized\ngap equation can also be derived without the decoupling\napproximation25,28 , leading to a similar equation, but\nwith a four-point kernel. From this point of view, the\ndecoupling approximation can be viewed as a diagonal\napproximation to this four-point kernel, neglecting the\ncorresponding off-diagonal elements.\n\nIV.\n\nKOHN-SHAM PERTURBATION THEORY\n\nIn the previous sections we showed how to develop a\ndensity functional theory for the superconducting state.\nThe main equation of this theory, the gap equation (32),\nallows, in principle, the calculation of the superconducting gap for any system. However, to solve this equation one needs approximations for \u2206xc , the exchangecorrelation contribution to the Kohn-Sham pair potential. In the following, we will develop such approximations by applying Kohn-Sham perturbation theory, as described by G\u00f6rling and Levy29 , to superconducting systems25,30 . This perturbation theory, that will treat both\nthe electron-electron and electron-phonon interactions on\nthe same footing, is a generalization of the method used\nby Kurth et al. to calculate the exchange-correlation energy of the uniform superconducting electron gas15 .\nOur starting point is the Hamiltonian of the electronnuclear system as defined in Eq. (3). This Hamiltonian\n\n\f8\nis then split into a suitably chosen reference Hamiltonian \u01240 and the remainder, which is treated as a perturbation. The most appropriate reference system for\nthis formalism is as follows: i) The nuclear Kohn-Sham\nHamiltonian (29) rigorously defines the nuclear equilibrium positions R0 . When expanded to harmonic order\naround these positions it can be written as the phonon\nHamiltonian \u0124 ph (30). ii) Next we define a BornOppenheimer Kohn-Sham Hamiltonian via a rigid-lattice\npotential given by the equilibrium coordinates R0 ,\ne\ne\ne\n\u02c6 Hxc ,\n+ V\u0302Hxc\n+\u2206\n\u0124BO\n= T\u0302 e + V\u0302latt,R\n0\n\n(36)\n\nwhere\ne\nV\u0302Hxc\n=\n\nXZ\n\nd3 r \u03a8\u0302\u2020\u03c3 (r)\u03a8\u0302\u03c3 (r)\n\n\u03c3\n\n\u00d7\n\n\u0014Z\n\n\u0015\nn(r \u2032 )\ne\nd r\n+ vxc (r) , (37)\n|r \u2212 r \u2032 |\n3 \u2032\n\n\u02c6 Hxc includes the anomalous Hartree and\nwhile \u2206\nexchange-correlation contributions\n\u02c6 Hxc = \u2212\n\u2206\n\nZ\n\n\u001a\nZ\n3 \u2032\nd r d r \u03a8\u0302\u2191 (r)\u03a8\u0302\u2193 (r \u2032 )\n\u0014 \u2217\n\u0015\n\u001b\n\u03c7 (r, r \u2032 )\n\u2217\n\u2032\n\u00d7\n+ \u2206xc (r, r ) + H.c. . (38)\n|r \u2212 r \u2032 |\n3\n\ne\nWith the choice \u01240 = \u0124 ph + \u0124BO\n, the interaction\nHamiltonian reads:\ne\u2212ph\nn\ne\n\u02c6 Hxc\n\u01241 = \u00db ee + \u00dbBO\n\u2212 V\u0302Hxc\n\u2212 V\u0302Hxc\n\u2212\u2206\n\n(39)\n\nThe Born-Oppenheimer electron-phonon coupling opere\u2212ph\nator \u00dbBO\nis given by\nXXZ\ne\u2212ph\nBO\n\u00dbBO\n=\nd3 r V\u03bb,q\n(r)\u03a8\u0302\u2020\u03c3 (r)\u03a8\u0302\u03c3 (r)\u03a6\u0302\u03bb,q . (40)\n\u03c3\n\n\u03bb,q\n\nBO\nwhere V\u03bb,q\n(r) is basically the gradient of the electronic\nKohn-Sham potential with respect to the nuclear coordinates and the phononic field operator is \u03a6\u0302\u03bb,q =\nb\u0302\u03bb,q + b\u0302\u2020\u03bb,\u2212q . Note that now we have set the auxiliary\ne\n\u02c6 ext to zero, and V\u0302 n to the\nexternal potentials V\u0302ext\nand \u2206\next\nbare internuclear interaction.\nWe believe that this is the most physical way to split\nthe Hamiltonian, since the electronic structure calculation for n(r), in practice, is usually performed for fixed\nnuclear positions; the nuclear dynamics is absorbed in\nthe exchange correlation functionals. Furthermore, standard calculations for the electron-phonon coupling, which\nare based on linear response theory, involve the above\nBO\ncoupling potentials V\u03bb,q\n(r). Note that, besides the ine-ph\nee\n, the perturbation includes\nteraction terms \u00db and \u00dbBO\nthe Hartree and exchange-correlation potentials. In appendix A we give some more details of this construction.\n\nWe now develop a many-body perturbational approach, which will ultimately lead to explicit expressions\nfor the exchange-correlation functionals. The construction of this approach follows closely the standard manybody perturbation theory described in many textbooks31 .\nOur objective is to expand the difference \u2206\u03a9 = \u03a9 \u2212 \u03a9s\nin a power series. From this difference and with the definitions (10) and (13) it is straightforward to derive an\nexpression for the functional Fxc .\nIn standard perturbation theory \u2206\u03a9 is written as an\nexpansion in powers of e2 and g 2 , where e (the electron\ncharge) and g (the electron-phonon coupling constant)\nmeasure respectively the strength of the Coulomb and of\nthe electron-phonon interactions. In our approach, however, every order in perturbation theory contains all orders in e2 and g 2 . This is due to the special form of the\nperturbation \u01241 that involves the exchange-correlation\npotentials which contain implicitly all orders in the interactions. Therefore, for book-keeping purposes, we multiply the perturbation \u01241 by a dimensionless parameter\n\u039b. In this way, the terms appearing in the perturbative\nexpansion can be labeled by powers of \u039b.\nThe grand canonical potential \u03a9 can be written as\n\u03a9=\u2212\n\n1\nlog(Z) ,\n\u03b2\n\n(41)\n\nwhere the partition function has the definition Z =\nTr{exp(\u2212\u03b2 \u0124)}. From this expression it follows directly\nthat\n\u0012 \u0013\nZ\n1\n,\n(42)\n\u03a9 \u2212 \u03a9s = \u2212 log\n\u03b2\nZs\nwhere Zs is the partition function of the Kohn-Sham system. It is then straightforward, using the standard machinery of many-body perturbation theory, to write the\nratio Z/Zs as a series expansion in \u039b which can be evaluated with the help of Wick's theorem. Moreover, the\nnumber of terms in the series can be reduced by using a\ngeneralization of the linked-cluster theorem32 . The final\nresult reads\n1X\n\u03a9 \u2212 \u03a9s = \u2212\n(all connected diagrams) .\n(43)\n\u03b2\n\nIn this expression the sum runs over all connected Feynman diagrams that are topologically distinct. (Alternatively, one can expand diagrammatically the propagators\nand use the Galitskii-Migdal formula to evaluate the energy33 . The two approaches are equivalent.)\nThere are several Kohn-Sham propagators that enter\nthe Feynman diagrams: First we have the contraction\nthat reduces to the usual Green's function for systems\nthat are not superconducting\nGs\u03c3\u03c3\u2032 (r\u03c4, r \u2032 \u03c4 \u2032 ) = \u2212hT\u0302 \u03c8\u0302\u03c3 (r\u03c4 )\u03c8\u0302\u03c3\u2020 \u2032 (r \u2032 \u03c4 \u2032 )is ,\n\n(44)\n\nwhere T\u0302 is the time-ordering operator, which orders the\noperators from right to left in ascending imaginary time\n\n\f9\norder, and the average h* * * is is done with respect to the\nKohn-Sham statistical density operator \u03c1\u0302s . This Green's\nfunction is represented in the Feynman diagrams by a line\nwith two arrows pointing in the same direction. Furthermore, due to the presence of pairing fields in the KohnSham system (13), the following (anomalous) averages\nare non-vanishing for superconducting systems\ns\n\u2032 \u2032\n\u2032 \u2032\nF\u03c3\u03c3\n\u2032 (r\u03c4, r \u03c4 ) = \u2212hT\u0302 \u03c8\u0302\u03c3 (r\u03c4 )\u03c8\u0302\u03c3 \u2032 (r \u03c4 )is ,\n\ns\u2020\n\u2032 \u2032\nF\u03c3\u03c3\n\u2032 (r\u03c4, r \u03c4 )\n\n= \u2212hT\u0302\n\n\u03c8\u0302\u03c3\u2020 (r\u03c4 )\u03c8\u0302\u03c3\u2020 \u2032 (r \u2032 \u03c4 \u2032 )is\n\n.\n\n(45a)\n(45b)\n\nIn Feynman diagrams these propagators appear as lines\nwith two arrows pointing outwards (for F s ) and as\nlines with two arrows pointing inwards (for F s \u2020 ). (The\nGreen's function (44) and the anomalous averages (45)\ncan be conveniently assembled into a matrix Green's\nfunction in Nambu-Gorkov space5 .) Finally, as the perturbation includes the electron-phonon interaction term\n\u0124e\u2212ph , some diagrams contain the phonon propagator\n(represented as a curly line)\ns\nD\u03bb,q\n(\u03c4, \u03c4 \u2032 ) = hT\u0302 \u03a6\u0302\u03bb,q (\u03c4 )\u03a6\u0302\u2020\u03bb,q (\u03c4 \u2032 )is .\n\n(46)\n\nAs usual in finite temperature many-body theory, it is\nconvenient to work in imaginary frequency space. The\ntime Fourier transform of the Green's function (45) is\ndefined as\n1 X \u2212i\u03c9n (\u03c4 \u2212\u03c4 \u2032 ) s\ne\nG\u03c3\u03c3\u2032 (r, r \u2032 ; \u03c9n ) , (47)\nGs\u03c3\u03c3\u2032 (r\u03c4, r \u2032 \u03c4 \u2032 ) =\n\u03b2 \u03c9\nn\n\nwhere \u03c9n = (2n + 1)\u03c0/\u03b2 are the odd Matsubara frequencies. The frequency dependent anomalous propagators\nhave a similar definition. In Matsubara space the KohnSham propagators read, in terms of the Kohn-Sham particle and hole amplitudes and of the Kohn-Sham eigenenergies,\nGs\u03c3,\u03c3\u2032 (r, r \u2032 ; \u03c9n ) = \u03b4\u03c3,\u03c3\u2032\nX \u0014 ui (r)u\u2217 (r \u2032 ) vi (r)v \u2217 (r \u2032 ) \u0015\ni\ni\n\u00d7\n, (48a)\n+\ni\u03c9\n\u2212\nE\ni\u03c9\n+\nEi\nn\ni\nn\ni\ns\n\u2032\n\u2032\nF\u03c3,\u03c3\n\u2032 (r, r ; \u03c9n ) = \u03b4\u03c3,\u2212\u03c3 \u2032 sgn(\u03c3 )\n\u0014\nX v \u2217 (r)ui (r \u2032 ) ui (r)v \u2217 (r \u2032 ) \u0015\ni\ni\n\u00d7\n, (48b)\n\u2212\ni\u03c9\n+\nE\ni\u03c9\n\u2212\nEi\nn\ni\nn\ni\ns\u2020\n\u2032\nF\u03c3,\u03c3\n\u2032 (r, r ; \u03c9n ) = \u03b4\u03c3,\u2212\u03c3 \u2032 sgn(\u03c3)\nX \u0014 u\u2217 (r)vi (r \u2032 ) vi (r)u\u2217 (r \u2032 ) \u0015\ni\ni\n. (48c)\n\u2212\n\u00d7\ni\u03c9\n+\nE\ni\u03c9\n\u2212\nEi\nn\ni\nn\ni\n\nOn the other hand, the phonon propagator depends on\nthe even Matsubara frequencies \u03bdn = 2n\u03c0/\u03b2,\ns\nD\u03bb,q\n(\u03bdn ) = \u2212\n\n2\u03a9\u03bb,q\n.\n+ \u03a92\u03bb,q\n\n\u03bdn2\n\n(49)\n\na\n\nb\n\nc\n\nFIG. 2: Lowest order electronic (a) and phononic (b, c) contributions to Fxc .\n\nIn first order in \u039b there is only one diagram contributing to Fxc . This diagram, depicted in Fig. 2a, is of purely\nelectronic origin and has the same form as the standard\nexchange diagram. (The wavy line in Fig. 2a represents\nthe Coulomb interaction.) This term can be written as\n(for simplicity we write all contributions to Fxc within\nthe decoupling approximation\n(a)\nFxc\n\n\u0014\n\u0013\u0015\n\u0012\n1X\n\u03bei\n\u03b2\n=\u2212\nvi,j 1 \u2212\ntanh\nEi\n4 i,j\nEi\n2\n\u0014\n\u0013\u0015\n\u0012\n\u03bej\n\u03b2\n\u00d7 1\u2212\n,\ntanh\nEj\nEj\n2\n\n(50)\n\nwhere the matrix elements of the Coulomb interaction\nare defined as\nZ\nZ\n1\nvi,j = d3 r d3 r\u2032 \u03c6\u2217i (r)\u03c6i (r \u2032 )\n\u03c6j (r)\u03c6\u2217j (r \u2032 ) .\n|r \u2212 r \u2032 |\n(51)\nAs the expectation value h\u03a6\u03bb,q i = 0, the electron-phonon\ninteraction does not contribute to Fxc in first order perturbation theory in \u039b. The first non-vanishing terms\nappear in second order in \u039b (first order in g 2 ) and are\ndepicted in Fig. 2b, c. The first of these terms (Fig. 2b) is\nthe counterpart of the anomalous term that contributes\nto the electronic Hartree energy (20). Its analytic form\ncan be written as\n(b)\n=\nFxc\n\n1 X X ij\ng\u03bb,q\n2\nij\n\u03bb,q\n\n2\n\n\u2206i \u2206\u2217j h\nI(Ei , Ej , \u03a9\u03bb,q )\nEi Ej\n\ni\n\u2212 I(Ei , \u2212Ej , \u03a9\u03bb,q ) ,\n\n(52)\n\nwhere we defined the matrix elements of the electronphonon coupling constant\nij\ng\u03bb,q\n=\n\nZ\n\nBO\nd3 r \u03c6\u2217i (r)V\u03bb,q\n(r)\u03c6j (r) ,\n\n(53)\n\nwhile the function I is\nI(E, E \u2032 , \u03a9) =\n\n1\n1 X\n\u22122\u03a9\n1\n.\n2\n\u2032\n\u03b2 \u03c9 \u03c9 i\u03c91 \u2212 E i\u03c92 \u2212 E (\u03c91 \u2212 \u03c92 )2 + \u03a92\n1\n\n2\n\n(54)\nThe three fractions in the sum come from the denominators of the two Green's functions Gs and from the phonon\npropagator Ds . It is possible to perform the frequency\nsums using standard complex contour integration meth-\n\n\f10\nods. The final result is\nI(Ei , Ej , \u03a9) = f\u03b2 (Ei ) f\u03b2 (Ej ) n\u03b2 (\u03a9)\n\u0015\n\u0014 \u03b2Ei\ne\u03b2Ej \u2212 e\u03b2(Ei +\u03a9)\n\u2212 e\u03b2(Ej +\u03a9)\ne\n. (55)\n\u2212\n\u00d7\nEi \u2212 Ej \u2212 \u03a9\nEi \u2212 Ej + \u03a9\nA diagram analogous to the one depicted in Fig. 2b\nbut with the phonon propagator replaced by the bare\nCoulomb interaction exists as well. This diagram is the\nanomalous Hartree term which appears as the second\nterm on the right hand side of Eq. (20). Since this term is\ntreated explicitly in the electronic Kohn-Sham equations\nit is not part of the exchange-correlation functional.\nNote that expression (52) is so much more complicated than the anomalous Hartree term simply because\nthe phonon propagator describes a retarded interaction.\nIf we assumed a retarded electronic interaction instead\nof the instantaneous Coulomb potential 1/|r \u2212 r \u2032 | the\nanomalous Hartree contribution would look very similar\nto (52).\nThe second phononic term that contributes to Fxc is\ndepicted in Fig. 2c. This Feynman diagram has the same\nstructure as the electronic exchange term (Fig. 2a). However, and again due to retardation effects, its analytic\nstructure is more complicated than (50), namely\n(c)\nFxc\n\n\"\u0012\n\u0013\n\u03bei \u03bej\n1 X X ij 2\n1+\ng\u03bb,q\nI(Ei , Ej , \u03a9\u03bb,q )\n=\u2212\n2\nEi Ej\n\u03bb,q ij\n#\n\u0013\n\u0012\n\u03bei \u03bej\nI(Ei , \u2212Ej , \u03a9\u03bb,q ) . (56)\n+ 1\u2212\nEi Ej\n(b)\nFxc\n\nFxc = Fxc [\u03bc, |\u2206i |2 , \u03c6i ] .\n\nFUNCTIONAL DERIVATIVES AND THE\nCHAIN RULE\n\nWe have seen in Eq. (18b) how the anomalous\nexchange-correlation potential is defined as the functional derivative of the exchange-correlation free-energy\nfunctional with respect to the anomalous density \u03c7. However, the contributions to the exchange-correlation freeenergy functional that stem from Kohn-Sham perturbation theory are only known as explicit functionals of\n\n(57)\n\nFor convenience, instead of working with \u2206i and \u2206\u2217i ,\nwe prefer using the modulus square of the pair potential\nand its phase as independent variables. The anomalous\nexchange-correlation potential can thus be evaluated using the chain rule for functional derivatives\n\u2206xc i = \u2212\n\n\u0014\n\u0015\n\u03b4Fxc \u03b4\u03bc X \u03b4Fxc \u03b4|\u2206j |2\n\u03b4Fxc \u03b4(\u03c6j )\n\u2212\n+\n.\n\u03b4\u03bc \u03b4\u03c7\u2217i\n\u03b4|\u2206j |2 \u03b4\u03c7\u2217i\n\u03b4(\u03c6j ) \u03b4\u03c7\u2217i\nj\n\n(58)\nThe partial derivatives of Fxc can now be calculated directly. The remaining functional derivatives are somehow\nharder to obtain, but can be derived from the definitions\nof the densities, equations (28), and from the fact that\nthe particle density and the anomalous density are independent variables. This latter condition can be expressed\nthrough the relation\n\u03b4n(x)\n= 0.\n\u03b4\u03c7\u2217 (r, r \u2032 )\n\n(c)\nFxc\n\nand\nThe self-energy diagrams contributing to\nresemble the self-energy diagrams that appear in Eliashberg theory2,3 . By virtue of Migdal's theorem34 , vertex\ncorrections should be small and are therefore neglected,\nboth in Eliashberg theory and in our treatment. There\nis, however, an important difference: in Eliashberg theory the propagators that enter the self-energy diagrams\nare dressed propagators, while in our case we have bare\n(Kohn-Sham) propagators. By using the bare propagators we neglect more diagrams than those containing vertex corrections. We postpone a more detailed discussion\nof this problem to the section on the exchange-correlation\nkernels.\nV.\n\nthe Kohn-Sham orbitals \u03c6i (r), the Kohn-Sham singleparticle energies (\u01ebi \u2212 \u03bc), and the pair potential \u2206i . Of\ncourse, the Hohenberg-Kohn theorem tells us that these\nquantities are themselves functionals of the densities, so\nthe free-energy is an implicit functional of the densities.\nFurthermore, if one makes the additional approximation\ne\nthat vxc\ndoes not depend on \u03c7 then the Kohn-Sham orbitals \u03c6i (r) and the eigenenergies \u01ebi are also independent\nof the anomalous density. Fxc is then a function of the\nchemical potential \u03bc and a functional of the (complex)\npair potential \u2206i\n\n(59)\n\nMoreover, we make use of the two trivial conditions\n\u03b4\u03c7\u2217i\n= \u03b4i,j\n\u03b4\u03c7\u2217j\n\n\u03b4\u03c7i\n= 0.\n\u03b4\u03c7\u2217j\n\n,\n\n(60)\n\nFrom the above conditions, and after some algebra, we\narrive at the expressions for the remaining functional\nderivatives\n\u0014\n\u0015\n\u03b4 |\u2206j |2\n2\n2 \u03b4\u03bc\n2\n1\n=\nEj \u2206j \u03b4i,j \u2212 Yj |\u2206j |\n, (61a)\n\u03b4\u03c7\u2217i\nYj0\n\u03b4\u03c7\u2217i\nEi\n\u03b4(\u03c6j )\n\u0010\n\u0011\n, = i\u03b4i,j\n\u2217\n\u03b4\u03c7i\n\u2206\u2217 tanh \u03b2 E\ni\n\n2\n\n(61b)\n\ni\n\n.X\n\u03b4\u03bc\nZj0 .\n= \u2212Zi1\n\u2217\n\u03b4\u03c7i\nj\n\n(61c)\n\nThe functions Zi0 and Zi1 have the definitions\nZi0 =\n\n\u0010\n\n\u0011\n\n\u03b2\n\u03b2\nEi 2 tanh 2 Ei\n\u0011\n\u0010\nYi0 cosh2 \u03b2 Ei\n2\n\n;\n\nZi1 =\n\nYi1\n\u2206i ,\nYi0\n\n(62)\n\n\f11\nand, finally, the two functions Yi0 and Yi1 read\n\u03bei2\ntanh\nEi\n\n\u0012\n\n\u03b2\nEi\n2\n\n\u0013\n\n+\n\n\u03bei\ntanh\n=\nEi\n\n\u0012\n\n\u03b2\nEi\n2\n\n\u0013\n\n\u2212\n\nYi0 =\nYi1\n\n\u03b2\n2\n\n|\u2206i |\n\u0010\n\ncosh2\n\n2\n\n\u03b2\n2 Ei\n\n\u0011,\n\n(63a)\n\n.\n\n(63b)\n\n\u03b2\n\u03bei\n2\u0010\n\u0011\n2 \u03b2\ncosh 2 Ei\n\nThere exists another method to obtain exchangecorrelation functionals using Kohn-Sham perturbation\ntheory without resorting to functional derivatives. This\nmethod follows the ideas of Sham and Schl\u00fcter35 , and\nprovides a very direct connection between many-body\nperturbation theory and the normal and anomalous\nexchange-correlation functionals. In the following we will\ngive a brief account of the Sham-Schl\u00fcter method for superconductors.\nThere is a simple connection between the electron density n(r) and the interacting many-body Green's function\n1 X X i\u03b7\u03c9n\nn(r) = lim+\nG\u03c3\u03c3 (r, r; \u03c9n ) .\ne\n\u03b7\u21920 \u03b2\n\u03c9\n\u03c3\n\n(64)\n\nThe definition of the interacting Green's function is similar to Eq. (44), but with the thermal average weighted\nby the interacting statistical operator \u03c1\u03020 . The infinitesimal \u03b7 is used to ensure the correct ordering of the field\noperators in Eq. (44) so that Eq. (64) is fulfilled. In the\nsame way it is simple to prove that the anomalous density\nobeys the relation\n\u03b7\u21920\n\n1 X i\u03b7\u03c9n\nF\u2191\u2193 (r, r \u2032 ; \u2212\u03c9n ) ,\ne\n\u03b2 \u03c9\n\n(65)\n\nn\n\nwhere F is the interacting anomalous propagator. On\nthe other hand, we defined the Kohn-Sham system as the\nnon-interacting system whose both normal and anomalous densities are equal to the densities of the interacting\nsystem. Therefore, one can equally calculate the interacting densities from the Kohn-Sham Green's functions\nn(r) = lim\n\n\u03b7\u21920+\n\n1 X X i\u03b7\u03c9n s\nG\u03c3\u03c3 (r, r; \u03c9n ) ,\ne\n\u03b2 \u03c9 \u03c3\n\nVI.\n\nA SIMPLE BCS-LIKE MODEL\n\nWe now introduce a simple model that will allow us\nto study in detail the functionals developed in this article. For simplicity, we assume that the pair potential\nhas s-wave symmetry and behaves approximately like\n\u2206i = \u2206(\u03bei ). This assumption is fulfilled by all traditional superconductors. In this model, we can transform\nthe gap equation into a one-dimensional equation in energy space\n\u2206(\u03be) = \u2212Z(\u03be)\u2206(\u03be)\n\nn\n\n\u03c7(r, r \u2032 ) = \u2212 lim+\n\napproach is closer to many-body perturbation theory,\nand provides a natural relationship between the Green's\nfunction and the exchange-correlation potentials of DFT.\nHowever, both approaches lead to the same result if the\nfree energy in the first method is expanded up to the same\norder in perturbation theory as the Green's functions in\nthe second method.\n\n(66)\n\nn\n\nwith an equation similar to Eq. (65) relating \u03c7 and F s .\nWe then expand perturbatively the interacting Green's\nfunctions in (64) and (65), and equate the two equations for n(r), and the two equations for \u03c7(r, r \u2032 ). As the\ne\n\u02c6 xc , the reperturbation (39) includes the terms V\u0302xc\nand \u2206\nsulting equations form a system of two coupled integral\ne\nequations that allow the determination of vxc\nand \u2206xc .\nThose integral equations are the so-called Sham-Schl\u00fcter\nequations.\nThe two methods to obtain the exchange-correlation\npotentials are conceptually quite different. The first uses\nthe definitions (18) to derive the exchange-correlation potentials using a series of chain rules. The Sham-Schl\u00fcter\n\n1\n\u2212\n2\n\nZ\n\n\u221e\n\n\u2212\u03bc\n\nd\u03be \u2032 N (\u03be \u2032 )K(\u03be, \u03be \u2032 )\n\ntanh\n\n\u0010\n\n\u03be\u2032\n\n\u03b2 \u2032\n2\u03be\n\n\u0011\n\n\u2206(\u03be \u2032 ) ,\n\n(67)\n\nwhere N (\u03be) is the density of states at the energy \u03be. It is\npossible to further simplify this equation by assuming a\nBCS-like model for both K and Z. If we assume that the\nkernel K and the renormalization term Z are constant\nin a shell of width \u03c9c around the Fermi energy and zero\noutside this region, Eq. (67) can be solved analytically\nfor the transition temperature Tc\n\u0014\n\u0015\n1 + Z(0)\nTc \u221d exp\n,\n(68)\nN (0)K(0)\nwhere K(0) and Z(0) are the values of K(\u03be, \u03be \u2032 ) and Z(\u03be)\nat the Fermi surface. Equation (68) has exactly the same\nstructure as McMillan's formula36,37 , which is an approximate solution of the Eliashberg equations. This latter\nformula reads\n\u0015\n\u0014\n\u03a9log\n1.04(1 + \u03bb)\nTc =\n.\n(69)\nexp \u2212\n1.20\n\u03bb \u2212 \u03bc\u2217 (1 + 0.62\u03bb)\nThe number \u03bc\u2217 , the Coulomb pseudo-potential of Eliashberg theory, measures the strength of the electronelectron interaction. This parameter is quite hard to\ncalculate and is often fitted to experimental data. As\n\u03bc\u2217 is normally positive, it tends to decrease the superconducting transition temperature. On the other hand,\n\u03bb is a measure of the electron-phonon coupling strength\nZ\n\u03b12 F (\u03a9)\n\u03bb = 2 d\u03a9\n.\n(70)\n\u03a9\nThe behavior of Tc with \u03bb is very non-linear: For small\nvalues of \u03bb, Tc grows exponentially; However, as \u03bb increases, the superconducting transition temperature saturates. The parameter \u03a9log is a weighted average of the\n\n\f12\nphonon frequencies\n\u03a9log = exp\n\n\u0014 Z\n\u0015\n2\n\u03b12 F (\u03a9)\n,\nd\u03a9 log(\u03a9)\n\u03bb\n\u03a9\n\n(71)\n\nand is of the order of the Debye frequency of the material.\nFinally, the Eliashberg spectral function is the electronphonon coupling constant averaged on the Fermi surface\n\n\u03b12 F (\u03a9) =\n\n1 X X ij\ng\u03bb,q \u03b4(\u03bei )\u03b4(\u03bej )\u03b4(\u03a9 \u2212 \u03a9\u03bb,q )\nN (0) ij\n\u03bb,q\n\n(72)\nIt is widely accepted that McMillan's formula gives a\nquite accurate description of the transition temperature\nfor simple, BCS-like, superconductors. Therefore, by\ncomparing expressions (68) and (69) for the phonon-only\ncase, i.e. \u03bc\u2217 = 0, we obtain that for BCS-like superconductors\n\nFIG. 3: The function \u2212N (0)Kph (\u03be, \u03be) for Al, Nb and Pb,\ncalculated at T = 0 K\n\nA.\n\nN (0)K(0) \u2248 \u2212\u03bb ;\n\nZ(0) \u2248 \u03bb .\n\nElectron-phonon contributions\n\n(73)\n\nThis is an extremely important property of the exchangecorrelation kernel, which should be fulfilled by any approximate functional.\n\nVII. APPROXIMATIONS TO THE\nANOMALOUS HARTREE EXCHANGE\nCORRELATION KERNEL\n\nFrom the perturbative expansion of the exchangecorrelation free-energy it is clear that we can split the\nfree-energy in three parts: The first contains the purely\nelectronic terms, i.e., the terms that do not contain explicitly the electron-phonon coupling constant; The second, terms only involving the electron-phonon coupling\nconstant; And the last, which we define as the total\nfree-energy minus the two first parts, will have mixed\ncontributions from the Coulomb and electron-phonon interactions. The exchange-correlation potentials and the\nexchange-correlation kernels can be split in the same way.\nIn this section we develop exchange-correlation kernels\nto be used in the linearized gap equation (35). Functionals that can be used in the non-linear gap equation (32)\nare discussed later. This section is divided in two parts:\nFirst we look at the purely electron-phonon contributions\nto the exchange-correlation kernel. Such functionals are\ndeveloped using the machinery of Kohn-Sham perturbation theory together with the chain rule introduced earlier. In the second part, we turn our attention to the\npurely electronic part of the kernel. Two functionals will\nbe presented: the first has the form of an local density approximation (LDA), while the second is a functional that\navoids the direct computation of the screened Coulomb\nmatrix elements. The mixed contributions appearing in\nthe perturbational expansion of the free energy are neglected in the current treatment.\n\nIn first order in g 2 there are two terms stemming from\nthe electron-phonon interaction that contribute to the\n(b)\nexchange-correlation free energy: Fxc given by equa(c)\ntion (52), and Fxc given by equation (56). The exchange(b)\ncorrelation kernel derived from Fxc is non-diagonal and\nhas the form\nph\n=\nKij\n\nX ij\n2\n\u0011\n\u0010\n\u0011\ng\u03bb,q\ntanh \u03b22 \u03bei tanh \u03b22 \u03bej \u03bb,q\n\u0010\n\n2\n\n\u00d7 [I(\u03bei , \u03bej , \u03a9\u03bb,q ) \u2212 I(\u03bei , \u2212\u03bej , \u03a9\u03bb,q )] .\n\n(74)\n\nTo gain further insight into this term, we use a simplified model: we approximate the electron-phonon coupling constants by their average value at the Fermi surface and the electronic energy dispersion is replaced by\nthe free-electron model. In Fig. 3 we depict the diagonal\nKph (\u03be, \u03be) for aluminum, niobium and lead at zero temperature for this simplified model. As this contribution\nto the exchange-correlation kernel exhibits particle-hole\nsymmetry we only plot the region \u03be > 0. This term is\nsharply peaked at the Fermi energy (note the logarithmic scale in the \u03be-axis). Furthermore, the width of the\ncurves for each material is of the order of the corresponding Debye frequency. The value of the kernel at the Fermi\nenergy can be calculated analytically\nZ\nN (0)Kph (0, 0) = \u2212 d\u03a9 \u03b12 F (\u03a9)\n#\n\"\n\u0013\n\u0012\n2\n4\n8\n\u03b2\u03a9\n\u00d7\n. (75)\n1\u2212\n+\ncotanh\n\u03a9\n\u03b2\u03a9\n2\n(\u03b2\u03a9)2\nAt zero temperature, the value of N (0)Kph (0, 0) reduces\nto \u2212\u03bb, which is the value expected from the comparison\nto McMillan's formula [cf. Eq. (73)]. However, at higher\ntemperature N (0)Kph (0, 0) decreases monotonically.\n\n\f13\nThe second phononic contribution to the exchangecorrelation kernel coming from the Kohn-Sham pertur(c)\nbation theory (PT) originates from the diagram Fxc . It\n\nZiph,PT\n\nis a diagonal term, that reads\n\n\uf8ee\n\n\uf8f9\nX X jl 2\n\u03b2/2\n1\n\uf8f0 \u2212\n\uf8fb\n\u0010\n\u0011\n\u0010\n\u0011\n= \u2212P\ng\u03bb,q I \u2032 (\u03bej , \u03bel , \u03a9\u03bb,q )\n\u03b2/2\n\u03b2\n\u03b2\n\u03be\ni\nsinh\n\u03be\n\u03be\ncosh\n\u03b2\nj cosh2 ( \u03bej )\njl \u03bb,q\n2 i\n2 i\n2\n(\n)\nX X ij 2 1\n1\n\u2032\n\u0010 \u0011\ng\u03bb,q\n[I(\u03bei , \u03bej , \u03a9\u03bb,q ) \u2212 I(\u03bei , \u2212\u03bej , \u03a9\u03bb,q )] \u2212 2I (\u03bei , \u03bej , \u03a9\u03bb,q ) ,\n+\n\u03bei\ntanh \u03b2 \u03bei j\n2\n\n2\n\nAl\n5.59\n7.10\n9.75\n\nKph + Z ph, sym\nKph + Z ph\nEliashberg\n\nNb\n15.7\n23.0\n24.7\n\nMo\n4.14\n5.23\n7.31\n\n(76)\n\n\u03bb,q\n\nTa\n8.48\n11.7\n14.0\n\nV\n23.2\n34.2\n36.4\n\nPb\n8.12\n12.8\n12.2\n\nTABLE I: Transition temperatures from numerical solutions\nof the phonon-only DFT and Eliashberg equations. All temperatures are in Kelvin.\n\nwhere the function I \u2032 is defined as\nI \u2032 (\u03bei , \u03bej , \u03a9\u03bb,q ) =\n\n\u2202\nI(\u03bei , \u03bej , \u03a9\u03bb,q ) .\n\u2202\u03bei\n\n(77)\n\nIf we try to apply the simplified model presented earlier\nwe find that Ziph,PT diverges logarithmically. This diij\nvergence can be traced back to the substitution of g\u03bb,q\nby its value at the Fermi surface. This problem can be\nsolved by retaining the full dependence of the electronij\nphonon coupling constant on the indexes i, and j: g\u03bb,q\nthen decays as a function of energy thereby making the\nintegrals present in Eq. (76) convergent. A closer analysis of the expressions also reveals that the divergent part\nof the integrands is antisymmetric around the Fermi surface. Therefore, the divergent integrals would vanish in\nthe case of particle-hole symmetry. It seems then reasonable to neglect the antisymmetric part of the integrands,\nretaining only the symmetric part. The new functional\nreads\nZiph, sym =\n\ntanh\n\n1\n\u0010\n\n\u03b2\n2 \u03bei\n\u2032\n\n\u0011\n\nXX\nj\n\ni,j\ng\u03bb,q\n\n2\n\n\u03bb,q\n\n\u00d7 [I (\u03bei , \u03bej , \u03a9) + I \u2032 (\u03bei , \u2212\u03bej , \u03a9)] . (78)\nIn Fig. 4 this term is plotted for niobium for several\ntemperatures. It turns out that the function Z ph, sym (\u03bei )\nis a smooth function of the energy, and its value at the\nFermi surface (\u03bek = 0) is approximately 2\u03bb. This is twice\nthe value expected from the comparison to McMillan's\nformula [cf. Eq. (73)]. Furthermore, a careful analysis of Fig. 4 suggest that Z ph, sym (\u03bei ) can be written as\n\nFIG. 4: The dependence of Ziph, sym on temperature for niobium.\n\nthe sum of two terms: i) one broader and very weekly\ntemperature dependent; ii) a second contribution whose\nwidth decreases significantly with the temperature. Both\nterms contribute with approximately \u03bb to the value of\nZ ph, sym (\u03bei ) at the Fermi surface. As the renormalization term Z ph, sym (\u03bei ) appears to be too large, one can\nexpect that transition temperatures calculated with this\nfunctional will be too small. The situation should be\nworst for the strong-coupling superconductors like niobium or lead, where the renormalization is large. This is\nconfirmed by Table I where we list the transition temperatures obtained with the phononic part of the functional.\nThese numbers are compared to solutions of Eliashberg's\nequation where we neglected the electron-electron repulsion.\nWe believe that the shortcomings of this functional can\nbe traced back to the following: Migdal's theorem tells us\nthat, to a very good approximation, we can neglect in the\nperturbative expansion diagrams including vertex corrections due to the electron-phonon interaction. However,\ndiagrams including self-energy insertions of phononic origin should be included to have a consistent description\n\n\f14\nof the electron-phonon interaction. Therefore the bare\nGreen's functions entering in the diagrams depicted in\nFig. 2b,c should be replaced by dressed propagators. In\na first step to improve our functionals we dressed the\npropagators with a subset of phonon self-energy insertions. We found that the non-diagonal term Kph is basically insensitive, while the term Z ph, sym is reduced by\nroughly 20%. This is almost half the correction necessary to satisfy Eq. (73). We expect that the other 30%\nare accounted for by the remaining self-energy insertions.\nHowever, this approach is quite involved numerically, so\nwe choose a different path to improve our functional.\nWe know that the phonon renormalization term should\nhave the value \u03bb at the Fermi surface. Furthermore,\nthis term should have a width comparable to the Debye frequency. It is clear that the broader contribution\nto Z ph, sym (\u03bei ) obeys these requirements. We therefore\npropose to separate the two parts of Z ph, sym (\u03bei ) and use\nthe part i) as our renormalization term. We believe that\nthis procedure is at least partially justified by the results\nobtained by dressing the Green's functions. The functional corrected in this way reads\nZiph\n\n=\ntanh\n\n1\n\u0010\n\n\u03b2\n2 \u03bei\n\n\u0011\n\nXX\nj\n\nij\ng\u03bb,q\n\n2\n\n\u03bb,q\n\n[J(\u03bei , \u03bej , \u03a9\u03bb,q ) + J(\u03bei , \u2212\u03bej , \u03a9\u03bb,q )] , (79)\n\nwhere the function J is defined by\n \u0303 \u03be \u2032 , \u03a9) \u2212 J \u0303(\u03be, \u03be \u2032 , \u2212\u03a9) .\nJ(\u03be, \u03be \u2032 , \u03a9) = J(\u03be,\n\n(80)\n\nFinally we have\n \u0303 \u03be \u2032 , \u03a9) = \u2212 f\u03b2 (\u03be) + n\u03b2 (\u03a9)\nJ(\u03be,\n\u03be \u2212 \u03be\u2032 \u2212 \u03a9\n\u0015\n\u0014\n\u2032\nf\u03b2 (\u03be ) \u2212 f\u03b2 (\u03be \u2212 \u03a9)\n\u2032\n\u2212 \u03b2f\u03b2 (\u03be \u2212 \u03a9)f\u03b2 (\u2212\u03be + \u03a9) .\n\u00d7\n\u03be \u2212 \u03be\u2032 \u2212 \u03a9\n(81)\nThe functional Z ph is smooth both as a function of the\nenergy and as a function of the temperature. Furthermore, it has approximately the value \u03bb at the Fermi surface. The functional (79), together with the phononic\nkernel (74), is a central result of our work. It is the functional that will be used in the calculations of II. In Table I, we present the phonon-only transition temperatures\ncalculated with this functional. All Tc 's are in quite good\nagreement with transition temperatures calculated from\nEliashberg's equation. We emphasize that the transition temperatures in Table I are given exclusively for the\npurpose of testing and/or calibrating the approximations\nmade for the phononic part of the exchange-correlation\nfunctional. Tc 's resulting from setting \u03bc\u2217 = 0 in the\nEliashberg equations and setting the Coulomb terms to\nzero in the DFT context have, of course, nothing to do\nwith the Tc 's observed in nature. For results including\nthe Coulomb terms, we refer the reader to II.\n\nB.\n\nElectron-electron contributions\n\nWe now develop functionals that take into account the\nCoulombic part of the interaction. There are two terms\nin the energy functional that give contributions to the\nlinearized gap-equation (35). The first is the anomalous\ncontribution to the Hartree energy, given Eq. (20), and\na\nthe second is the exchange term Fxc\ndepicted in Fig. 2a.\nThe interaction that enters these expressions is the bare\nCoulomb interaction, 1/|r \u2212 r \u2032 |. However, electrons in\na metal do not feel the bare Coulomb interaction, but\na much weaker interaction, screened by the sea of electrons. To take this into account, we take a step back,\nand propose an alternative form to the energy functional\nbased on the superconducting version of the local density\napproximation (LDA)15 . In this approach the exchangecorrelation energy of the inhomogeneous system is written in terms of the exchange-correlation energy density\nof the homogeneous superconducting electron-gas\nSCLDA\n[n(R), \u03c7(R, k)] =\nFxc\nZ\nhom\n[n, \u03c7(k)]\nd3 R fxc\n\nn=n(R)\n\u03c7=\u03c7W (R,k)\n\n,\n\n(82)\n\nwhere \u03c7W (R, k) is the Wigner transform of the anomalous density of the inhomogeneous system, given by\nZ\n\u0010\ns\u0011\ns\n.\n(83)\n\u03c7W (R, k) = d3 s eiks \u03c7 R + , R \u2212\n2\n2\n\nIt is easy to see that this definition reduces to the\nusual LDA for non-superconducting systems in the limit\n\u03c7 \u2192 0. Moreover, it is possible to prove that this is the\nonly consistent definition of an LDA for the superconducting state38 . As an approximation to the exchangecorrelation energy of the electron-gas one could take the\nrandom phase approximation (RPA) functional proposed\nin Ref. 15. However, this functional has only been evaluated for a very simple class of pair potentials, namely\nGaussians centered at the Fermi surface. We therefore\npropose an alternative and simpler form to the Coulombic contribution to Fxc . For convenience, we approximate together the anomalous Hartree and the exchangecorrelation contributions. Our approximation reads\nhom\nhom,NS\n[\u03c7](n) \u2212 fxc\n(n) =\nfHxc\nZ\nd3 (r \u2212 r\u2032 ) |\u03c7(r \u2212 r \u2032 )|2 v TF (r \u2212 r \u2032 ) ,\n\n(84)\n\nwhere v TF (r \u2212r \u2032 ) is the Coulomb interaction screened by\na Thomas-Fermi model. In coordinate space the ThomasFermi interaction reads\n\u2032\n\nv TF (r \u2212 r \u2032 ) =\n\ne\u2212kTF |r\u2212r |\n,\n|r \u2212 r \u2032 |\n\n(85)\n\nwith the Thomas-Fermi screening length, kTF , given by\n2\nkTF\n= 4\u03c0N (0) .\n\n(86)\n\n\f15\nBy inserting expression (84) in the definition of the LDA,\nequation (82), we can identify this approximation as a\nThomas-Fermi screened anomalous Hartree contribution\nto the free-energy.\nThe anomalous Hartree exchange-correlation kernel\nstemming from this term is simply\nTF\nTF\nKij\n= vij\n,\n\n(87)\n\nwhere the matrix elements of the Thomas-Fermi interaction are defined by\nZ\nZ\nTF\n3\nvij = d r d3 r\u2032 \u03c6\u2217i (r)\u03c6i (r \u2032 )v TF (r \u2212 r \u2032 )\u03c6j (r)\u03c6\u2217j (r \u2032 )\n\n(88)\nwhere the \u03c6i 's are the Kohn-Sham orbitals of the inhomogeneous system at hand.\nIn II we will compare the results obtained with the\nabove approximation with further simplified expressions.\nIn the simplest model, the Kohn-Sham orbitals are taken\nto be plane waves with a parabolic dispersion. In this\ncase, the kernel can be written in energy space (after\naveraging over the angles) as:\n#\n\"\n2\n2\n(k + k \u2032 ) + kTF\n\u03c0\n\u2032\n,\n(89)\nlog\nKTF (\u03be, \u03be ) =\n2\n2\nkk \u2032\n(k \u2212 k \u2032 ) + kTF\n\np\np\nwith k = 2(\u03be \u2212 \u03bc) and k \u2032 = 2(\u03be \u2032 \u2212 \u03bc). Using the\nBCS-like two-well model one can extract the counterpart\nof the Coulomb pseudo-potential \u03bc\u2217 from Eliashberg theory. A crude estimate for rs = 2 gives a value around 0.1,\nwhich compares well with the typical values of \u03bc\u2217 for\nsimple metals (\u03bc\u2217 = 0.10 \u2013 0.15)37 . It should be stressed\nagain at this point, that the present method does not\nrequire \u03bc\u2217 . The estimates given here are used to demonstrate to which values of \u03bc\u2217 our ab initio Coulomb terms\ncorrespond to.\nWhile the replacement of the Kohn-Sham orbitals in\n(88) by plane waves may be acceptable for simple metals, it will be too crude for more complex materials. In\nthose cases it is still possible to avoid the direct computation of the screened Coulomb matrix elements (88),\nby going along the lines described by Sham and Kohn39 .\nWe briefly outline here the main points of this classical\npaper, which deals with an approximate way of getting\nan electron self-energy for the normal state. We assume,\nas usual within the LDA, that our system can be described around the point r by a homogeneous electron\ngas of density n(r). The wave-functions of this electron\ngas can be locally expressed as plane-waves of momentum\np(r) whose value is determined, in a semi-classical way,\nfrom the electron energy of the real system. In the simplest form, the mapping can be obtained from Eqs. (4.5)\nand (4.13) of Ref. 39 as\np2\n= \u03bei + \u03bch (n(r)) ,\n2\n\n(90)\n\nwhere \u03bch (n) is the chemical potential of an noninteracting homogeneous electron gas with density n.\nFurthermore, we approximate \u03bch (n(r)) by the constant\n\u03bch (n), where n is the average density of the material.\nWe suggest here to approximate the Coulomb interaction kernel between electrons at energies \u03b5k and \u03b5k\u2032 by\nthe corresponding quantities in the free-electron gas. We\nthen replace p2 /2 \u2192 \u03bei + \u03bch = \u03b7i , and rewrite the interaction (89) as\n!\n\u221a\n2\n\u03b7\n+\n\u03b7\n+\n2\n\u03b7\n\u03b7\n+\nk\n/2\ni\nj\ni\nj\nTF\nSK\n.\nKi,j\n\u221a\n2 /2\n\u03b7i + \u03b7j \u2212 2 \u03b7i \u03b7j + kTF\n(91)\nIn principle, one could consider not only p but also kTF as\nlocally dependent on the density n(r). In our simplified\napproach, however, we fix the Thomas-Fermi screening\nlength to a constant value.\n\u03c0\nlog\n= \u221a\n2 \u03b7i \u03b7j\n\nEq. (90) is conceived in terms of wave packets, and is\nvalid if n(r) does not vary too much on the scale of the\nFermi length, exactly as in the normal state LDA. One\ncan speculate, however, that when applied to the superconducting state the relevant length scale becomes the\ncoherence length, normally much larger than the atomic\nscale. Therefore, we may assume that local variations of\nthe density on the atomic scale will not affect the final\nsuperconducting properties.\nIt should be noted that this approximation, although\nderived in the spirit of an LDA, is not a local density\napproximation, since it does not depend explicitly on the\ndensities, but implicitly via the single-particle energies \u03bei .\n\nVIII.\n\nFUNCTIONALS FOR THE NON-LINEAR\nGAP EQUATION\n\nIn this section we provide approximations to the\nexchange-correlation kernel that can be used in the nonlinear gap-equation (32). These functionals will obey to\none constraint, namely that upon linearization they will\nreduce to the functionals presented in the previous section. This assures that the gap functions obtained from\nEq. (32) and the transition temperatures calculated from\nEq. (32) are consistent. Furthermore, we require these\nfunctionals to be \"well behaved\", i.e., without discontinuities or any other kind of pathological behaviors.\nThe simplest way to derive an exchange-correlation\nfunctional is to use the expressions derived through\nKohn-Sham perturbation theory in the definition (18b).\n(b)\nFor example, the first phononic contribution Fxc\n(Fig. 2b) yields the contribution\n\n\f16\n\nph, (b)\n\u2206xc i\n\n\u2212\n\n#\n(\n\"\nYj1\n\u2206j \u2206\u2217l + \u2206\u2217j \u2206l \u03bej\n1 \u2212 0 \u03bej [I(Ej , El , \u03a9\u03bb,q ) \u2212 I(Ej , \u2212El , \u03a9\u03bb,q )]\nEj2 El\nEj\nYj\n#\n)\nYj1\n\u2212 \u03bej + 0 |\u2206j |2 [I \u2032 (Ej , El , \u03a9\u03bb,q ) \u2212 I \u2032 (Ej , \u2212El , \u03a9\u03bb,q )]\nYj\n\uf8ee\n\uf8f9\n(\n\u0001\n\u03b2\n\u2217\n\u2217\n2\n2\n\u2206\n\u2206\n\u2212\n\u2206\n\u2206\n\u03be\n\u2206\nj\ni\nj\nj\nij\n2\ni \uf8fb\n\uf8f0\n\u0010\n\u0010\n\u0011i\n\u0011 +2\ng\u03bb,q\n[I(Ei , Ej , \u03a9\u03bb,q ) \u2212 I(Ei , \u2212Ej , \u03a9\u03bb,q )]\n\u2206i Ei\ntanh \u03b22 Ei cosh2 \u03b22 Ej\n)\n\u0001 \u2032\n\u2032\n\u2217\n\u2217\n+ \u2206j \u2206i + \u2206j \u2206i [I (Ei , Ej , \u03a9\u03bb,q ) \u2212 I (Ei , \u2212Ej , \u03a9\u03bb,q )] .\n\n1 Z 1 X X jl\n= P i 0\ng\u03bb,q\n2 j Zj\njl \u03bb,q\n\"\n1 X X \u2206i\n2 j\nYi0 Ej\n\u03bb,q\n\n2\n\nIt can be seen here that the non-linear gap equation (32),\nin general, does not have the simple structure of a BCSlike gap equation and thus goes beyond the simple picture\nof an effective interaction mediating the pairing. However, this approach encompasses several problems. First,\nthe resulting functionals have extremely complicated analytical structures and are very hard to interpret in simple physical terms. Furthermore, these functionals contain several divergences and pathological behaviors that\nhave to be taken care of. For the time being, we restrict ourselves to using the partially linearized exchangecorrelation potential, leading to the BCS-type gap equation\n\u0010\n\u0011\n\u03b2\ntanh\nE\nX\n2 j\n1\nFHxc i,j\n\u2206i = \u2212\n\u2206j ,\n(93)\n2 j\nEj\nwhere FHxc i,j are the linearized functionals defined in\nEq. (34) and derived in detail in the previous section. It\nturns out that superconducting gap functions obtained\nwith these functionals are in rather good agreement with\nexperimental results (see II).\n\nIX.\n\nCONCLUSIONS\n\nIn this work we have developed a truly ab-initio approach to superconductivity. No adjustable parameters appear in the theory. The key feature is that the\nelectron-phonon interaction and the Coulombic electronelectron repulsion are treated on the same footing. This\nis achieved within a density-functional-type framework.\nThree \"densities\": the ordinary electronic density, the superconducting order parameter, and the diagonal of the\nnuclear N -body density matrix were identified as suitable quantities to formulate the density-functional framework. The formalism leads to a set of Kohn-Sham equations for the electrons and the nuclei. The electronic\nKohn-Sham equations have the structure of Bogoliubovde Gennes equations but, in contrast to the latter, they\n\n(92)\n\nincorporate normal and anomalous xc potentials. Likewise, the Kohn-Sham equation describing the nuclear\nmotion contains, besides the bare nuclear Coulomb repulsion, an exchange-correlation interaction. The latter is an N -body interaction, i.e., the nuclear KohnSham equation is an N -body Schr\u00f6dinger equation. The\nexchange-correlation potentials are functional derivatives\nof a universal functional Fxc [n, \u03c7, \u0393] which represents the\nexchange-correlation part of the free energy. Approximations for this functional were then derived by many-body\nperturbation theory. To this end, the effective nuclear\ninteraction was expanded to second order in the displacements from the nuclear equilibrium positions. By introducing the usual collective (phonon) coordinates, the nuclear Kohn-Sham equation is then transformed into a set\nof harmonic oscillator equations describing independent\nphonons. These non-interacting phonons, together with\nnon-interacting but superconducting (Kohn-Sham) electrons serve as unperturbed system for a G\u00f6rling-Levytype perturbative expansion of Fxc . The electron-phonon\ninteraction and the bare electronic Coulomb repulsion, as\nwell as some residual exchange-correlation potentials are\ntreated as the perturbation. In this way, both Coulombic and electron-phonon couplings are fully incorporated.\nThe solution of the KS-Bogoliubov-de Gennes equation\n(or the KS gap equation together with the normal-state\nSchr\u00f6dinger equation) fully determines the Kohn-Sham\nsystem. Therefore, within the usual approximation to\ncalculate observables from the Kohn-Sham system, one\ncan apply the full variety of expressions for physical\nquantities, known from phenomenological Bogoliubov-de\nGennes theory, also in the present framework. This approach was already successfully applied within a semiphenomenological parametrization of the xc-functional ,\ne.g., to the specific heat18 and to the penetration depth40\nof the cuprates. It should further be emphasized that the\nformalism, developed in this paper, is not restricted to\nperfect periodic systems. It was for this purpose that we\npresented all formulae in terms of general quantum numbers. The formalism can, in principle, be applied as well\nto inhomogeneous systems, containing, e.g., impurities or\n\n\f17\nsurfaces, as to perfect periodic crystals.\nIn the succeeding paper (II) we will detail the numerical implementation of this theory and present the first\nfull-scale applications to simple metals.\n\nHamiltonian (29) for the nuclei gives rise to a set of equilibrium coordinates and phonon eigenstates. It can then\n(up to harmonic order) be written as Eq. (30). The equilibrium positions R0 can be employed to define an electronic BO Hamiltonian with a lattice potential referring\nto these coordinates\n\nAcknowledgments\n\n\u0124 BO = T\u0302 e + \u00db ee + V\u0302Rlatt\n.\n0\nS.M. would like to thank A. Baldereschi, G. Cappellini, and G. Satta for useful discussions. This work\nwas partially supported by the INFM through the Advanced Research Project (PRA) UMBRA, by a supercomputing grant at Cineca, (Bologna, Italy) through\nthe Istituto Nazionale di Fisica della Materia (INFM),\nand by the Italian Ministery of Education, through a\n2004 PRIN project. Financial support by the Deutsche\nForschungsgemeischaft within the program SPP 1145, by\nthe EXC!TiNG Research and Training Network of the\nEuropean Union, and by the NANOQUANTA Network\nof Excellence is gratefully acknowledged.\nAPPENDIX A: ON THE ELECTRON-PHONON\nCOUPLING\n\nIn this appendix we discuss the electron-phonon coupling potential which appears in the phononic exchangecorrelation terms. If we decomposed the Hamiltonian\ninto the ionic Kohn-Sham Hamiltonian and the electronic\nKohn-Sham Hamiltonian as the reference system and the\nrest as perturbation, this perturbation would include the\nbare electron-ion interaction. Clearly, the use of the bare\nvertex, i.e. the gradient of the bare nuclear potential\nwith respect to the nuclear positions, would yield an\nunphysical electron-phonon interaction. This bare vertex will be screened by the conduction electrons. This\nscreening could be taken care of by a diagrammatical\nresummation22 .\nHere we will sketch a different approach which directly\ngenerates the screened coupling potential. A natural\ncoupling potential in the context of DFT is the gradient with respect to the nuclear positions of the effective\nKohn-Sham potential within the Born-Oppenheimer approximation. This is also exactly the quantity which is\nobtained from the standard DFT electron-phonon calculations based on linear response theory with respect to\nsmall lattice distortions.\nlatt,\n\u2207R vs,R (r) = \u2207R vR\n(r)\nZ\nZ\ni\nh\nlatt \u2032\u2032\n+ d3 r\u2032 d3 r\u2032\u2032 fHxc (r, r \u2032 )X (r \u2032 , r \u2032\u2032 ) \u2207R vR\n(r )\n\n(A1)\n\n\u2032\n\nX (r, r ) denotes the linear density-density response function and\n\u03b4\n{vH [n](r) + vxc [n](r)} .\n(A2)\nfHxc (r, r \u2032 ) =\n\u03b4n(r \u2032 )\nWe are going to outline an approach which generates\nexactly this gradient of the effective Kohn-Sham potential as the coupling potential. The effective Kohn-Sham\n\n(A3)\n\nThis BO Hamiltonian, without the electron-phonon coupling, gives rise to the electronic density nR0 . We now\nadd and subtract all Hartree and exchange-correlation\nterms as well as the BO lattice potential to the full Hamiltonian.\n\u0124 =\n\nn\n(T\u0302 n + \u00db nn + V\u0302Hxc\n)\n\n+\n\ne\n\u02c6 eHxc )\n(T\u0302 e + V\u0302Rlatt\n+ V\u0302Hxc\n+\u2206\n0\n\n+\n\n\u00db ee + (\u00db en \u2212 V\u0302Rlatt\n)\n0\n\n\u2212\n\nn\ne\n\u02c6e .\nV\u0302Hxc\n\u2212 V\u0302Hxc\n\u2212\u2206\nHxc\n\n(A4)\n\nThe first three terms of this operator represent the nuclear Kohn-Sham Hamiltonian. Assuming that the equie\nlibrium density n(r) entering the functional vHxc\n[n](r)\nwill be close to the equilibrium density nR0 (r) resulting from the BO Hamiltonian (A3) we can expand the\nHartree exchange-correlation potential around the BO\ndensity,\ne\nvHxc\n[n](r) =\ne\nvHxc\n[nR0 ](r)\n\n+\n\nZ\n\nd3 r\u2032 fHxc [nR0 ](r, r \u2032 )\u03b4n(r \u2032 ) . (A5)\n\nwhere the small density change \u03b4n(r) is induced by the\ndifference of the full electron-ion interaction and the BO\npotential. The density change can, in principle, be calculated via linear response to that perturbation. We expect\nthis density change to be close to\nZ\nh\ni\nlatt \u2032\u2032\n\u03b4n(r\u2032 ) = d3 r\u2032\u2032 X (r \u2032 , r \u2032\u2032 ) \u2207R vR\n(r ) .\n(A6)\nIf we keep only the BO part of the electronic Hartree\nexchange-correlation potential, i.e., the term stemming\nfrom nR0 (r), in the electronic Kohn-Sham Hamiltonian,\nwe can combine the remainder with the electron-ion interaction, and can identify (up to first order)\nX\nZ\nZ\n\u2212\n|r \u2212 Ri |\n|r \u2212 R0,i |\ni\ni\nZ\n+ d3 r\u2032 fHxc [nR0 ](r, r \u2032 )\u03b4n(r \u2032 ) \u2248 \u2207R vs,BO (r). (A7)\n\nX\n\nThis is the desired result, which allowed us to use the\nelectron-phonon couplings, determined by linear response\ncalculations, as the coupling potentials in our KohnSham perturbation theory.\n\n\f18\n\n\u2217\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n8\n9\n\n10\n11\n\n12\n13\n\n14\n\n15\n\n16\n17\n\n18\n\nAlso at LAMIA-INFM, Genova, Italy\nJ. Bardeen, L. N. Cooper, and J. R. Schrieffer, Phys. Rev.\n108, 1175 (1957).\nG. M. Eliashberg, Sov. Phys. JETP 11, 696 (1960) J. R.\nSchrieffer, Theory of Superconductivity, Addison-Wesley\n(1964). D. J. Scalapino, J. R. Schrieffer, J. W. Wilkins,\nPhys. Rev. 148, 263 (1966) J. P. Carbotte, Rev. Mod.\nPhys. 62 , 1027 (1990). P. B. Allen and B. Mitrovic, 1982,\nin Solid State Physics, edited by H. Ehrenreich, F. Seitz,\nand D. Turnbull (Academic, New York), Vol. 37, p. 1.\nD. J. Scalapino, in Superconductivity, ed. by R. D. Parks\n(Marcel Dekker, New York, 1969), Vol. 1.\nF. Aryasetiawan and O. Gunnarsson, Rep. Prog. Phys. 61,\n237 (1998).\nY. Nambu, Phys. Rev. 117, 648 (1960); L. P. Gorkov, Sov.\nPhys. JETP 7, 505 (1958).\nH. J. Choi, D. Roundy, H. Sun, M. L. Cohen, S. G. Louie,\nNature 418, 758 (2002); K.-P. Bohnen, R. Heid, and B.\nRenker, Phys. Rev. Lett. 86, 5771 (2001); Y. Kong, O. V.\nDolgov, O. Jepsen, and O. K. Andersen, Phys. Rev. B 64,\n020501(R) (2001).\nP. Hohenberg, W. Kohn, Phys. Rev. 136, B864 (1964).\nW. Kohn, L. J. Sham, Phys. Rev. 140, A1133 (1965).\nR. M. Dreizler, E. K. U. Gross, Density Functional Theory, Springer-Verlag, (1990); J. P. Perdew and S. Kurth,\nin A Primer in Density Functional Theory, C. Fiolhais,\nF. Nogueira, and M. A. L. Marques (ed.), Lecture Notes in\nPhysics, Vol. 620, Springer, Berlin, 144 (2003).\nN. D. Mermin, Phys. Rev. 137, A1441 (1965).\nT. Kreibich and E. K. U. Gross, Phys. Rev. Lett. 86, 2984\n(2001).\nU. von Barth and L. Hedin, J. Phys. C 5, 1629 (1972).\nL. N. Oliveira, E. K. U. Gross, and W. Kohn, Phys. Rev.\nLett. 60, 2430 (1988); E. K. U. Gross, S. Kurth, K. Capelle,\nand M. L\u00fcders, in Density Functional Theory, Vol. 337 of\nNATO ASI Series B, ed. by E. K. U. Gross and R. M.\nDreizler (Plenum Press, New York, 1995).\nK. Capelle and E. K. U. Gross, Int. J. Quant. Chem. 61,\n325 (1997).\nS. Kurth, M. Marques, M. L\u00fcders, and E. K. U. Gross,\nPhys. Rev. Lett. 83, 2628 (1999).\nN. N. Bogoliubov, Sov. Phys. JETP 7, 41 (1958).\nM. B. Suvasini and B. L. Gyorffy, Physica C 195, 109\n(1992); M. B. Suvasini, W. M. Temmerman, and B. L. Gyorffy, Phys. Rev. B 48, 1202 (1993); W. M. Temmerman,\nZ. Szotek, B. L. Gyorffy, O. K. Andersen, and O. Jepsen,\nPhys. Rev. Lett. 76, 307 (1996).\nB. L. Gy\u00f6rffy, Z. Szotek, W. M. Temmerman, O. K. Ander-\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n30\n\n31\n\n32\n33\n\n34\n35\n\n36\n37\n38\n\n39\n40\n\nsen, and O. Jepsen, Phys. Rev. B 58, 1025 (1998).\nJ. G. Bednorz, J. G., and K. A. M\u00fcller, Z. Phys. B: Condens. Matter 64, 189 (1986).\nW. Kohn, E. K. U. Gross, L. N. Oliveira, J. Phys. (Paris)\n50, 2601 (1989).\nO. J. Wacker, R. K\u00fcmmel, and E. K. U. Gross, Phys. Rev.\nLett. 73, 2915 (1994).\nR. van Leeuwen, Phys. Rev. B 69, 115110 (2004); R. van\nLeeuwen, Phys. Rev. B 69, 199901(E) (2004).\nE. K. U. Gross and Stefan Kurth, Int. J. Quantum\nChem. Symp. 25, 289 (1991).\nS. Kurth, Ph.D. thesis, Bayerische Julius-MaximiliansUniversit\u00e4t W\u00fcrzburg, (1995).\nM. L\u00fcders, Ph.D. thesis, Bayerische Julius-MaximiliansUniversit\u00e4t W\u00fcrzburg, (1998).\nS. Baroni, S. de Gironcoli, and A. Dal Corso, P. Giannozzi,\nRev. Mod. Phys. 73, 515 (2001).\nC. Thomsen, M. Cardona, B. Friedl, I. I. Mazin, O. Jepsen,\nO. K. Andersen, and M. Methfessel, Solid State Commun.\n75, 219 (1990); E. Altendorf, X. K. Chen, J. C. Irvin, R.\nLiang, and W. N. Hardy, Phys. Rev. B 47, 8140 (1993);\nX. J. Zhou, M. Cardona, D. Colson, and V. Viallet, Phys.\nRev. B 55, 12770 (1997).\nM. L\u00fcders and E. K. U. Gross, Int. J. Quant. Chem. 56,\n521 (1995)\nA. G\u00f6rling and M. Levy, Phys. Rev. A 50, 196 (1994).\nM.A.L. Marques, Ph.D. thesis, Bayerische JuliusMaximilians-Universit\u00e4t W\u00fcrzburg, (2000).\nA. A. Abrikosov, L. P. Gorkov, and I. E. Dzyaloshinski,\nMethods of Quantum Field Theory in Statistical Physics\n(Dover, New York, 1963); A. L. Fetter and J. D. Walecka,\nQuantum Theory of Many-Particle Systems (McGraw-Hill,\nNew York, 1971).\nJ. Goldstone, J. Proc. Roy. Soc. A239, 267 (1957).\nV. M. Galitskii and A. B. Migdal, Sov. Phys. JETP 7, 96\n(1958).\nA. B. Migdal, Sov. Phys. JETP 7, 996 (1958).\nR. W. Godby, M. Schl\u00fcter, and L. J. Sham, Phys. Rev.\nLett, 56, 2415 (1986); Phys. Rev. B 35, 4170 (1987); Phys.\nRev. B 36, 6497 (1987).\nW. L. McMillan, Phys. Rev. 167, 331 (1968).\nJ, P. Carbotte, Rev. Mod. Phys. 62, 1027 (1990).\nC. A. Ullrich and E. K. U. Gross, Aust. J. Phys. 49, 103\n(1996).\nL. J. Sham and W. Kohn, Phys. Rev. 145, 561 (1966).\nZ. Szotek, B. L. Gyorffy and W. M. Temmerman, Phys.\nRev. B 62, 3997 (2000).\n\n\f"}