{"id": "http://arxiv.org/abs/0903.2674v2", "guidislink": true, "updated": "2009-04-16T17:31:31Z", "updated_parsed": [2009, 4, 16, 17, 31, 31, 3, 106, 0], "published": "2009-03-15T22:41:55Z", "published_parsed": [2009, 3, 15, 22, 41, 55, 6, 74, 0], "title": "$\u03b5$-Factors for the Period Determinants of Curves", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.1984%2C0903.2003%2C0903.0971%2C0903.2493%2C0903.1080%2C0903.4898%2C0903.2354%2C0903.3366%2C0903.0496%2C0903.4390%2C0903.5070%2C0903.3347%2C0903.2148%2C0903.0968%2C0903.2056%2C0903.4031%2C0903.2983%2C0903.2904%2C0903.4133%2C0903.4715%2C0903.5155%2C0903.3707%2C0903.3853%2C0903.4400%2C0903.0938%2C0903.4501%2C0903.0732%2C0903.4181%2C0903.4013%2C0903.5265%2C0903.4445%2C0903.4009%2C0903.4287%2C0903.4338%2C0903.1750%2C0903.1454%2C0903.3292%2C0903.0537%2C0903.1045%2C0903.3108%2C0903.1436%2C0903.4920%2C0903.1789%2C0903.2606%2C0903.3718%2C0903.2399%2C0903.2877%2C0903.5322%2C0903.4134%2C0903.2632%2C0903.3472%2C0903.3968%2C0903.2022%2C0903.1089%2C0903.5235%2C0903.2694%2C0903.2176%2C0903.4816%2C0903.2471%2C0903.1347%2C0903.2674%2C0903.4451%2C0903.4139%2C0903.4402%2C0903.0284%2C0903.3340%2C0903.5286%2C0903.5415%2C0903.1708%2C0903.4377%2C0903.1645%2C0903.2854%2C0903.0236%2C0903.3259%2C0903.4694%2C0903.3592%2C0903.4477%2C0903.4430%2C0903.1167%2C0903.2420%2C0903.0853%2C0903.4736%2C0903.0444%2C0903.2761%2C0903.0430%2C0903.1574%2C0903.5159%2C0903.3599%2C0903.4773%2C0903.4954%2C0903.4689%2C0903.4331%2C0903.0310%2C0903.0218%2C0903.3189%2C0903.4441%2C0903.2830%2C0903.4237%2C0903.0023%2C0903.0277%2C0903.2014&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "$\u03b5$-Factors for the Period Determinants of Curves"}, "summary": "The article provides a factorization formalism for determinants of the period\nmatrices for D-modules on curves. Unlike previous approach due to Bloch,\nDeligne, and Esnault, it does not use Fourier transform.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.1984%2C0903.2003%2C0903.0971%2C0903.2493%2C0903.1080%2C0903.4898%2C0903.2354%2C0903.3366%2C0903.0496%2C0903.4390%2C0903.5070%2C0903.3347%2C0903.2148%2C0903.0968%2C0903.2056%2C0903.4031%2C0903.2983%2C0903.2904%2C0903.4133%2C0903.4715%2C0903.5155%2C0903.3707%2C0903.3853%2C0903.4400%2C0903.0938%2C0903.4501%2C0903.0732%2C0903.4181%2C0903.4013%2C0903.5265%2C0903.4445%2C0903.4009%2C0903.4287%2C0903.4338%2C0903.1750%2C0903.1454%2C0903.3292%2C0903.0537%2C0903.1045%2C0903.3108%2C0903.1436%2C0903.4920%2C0903.1789%2C0903.2606%2C0903.3718%2C0903.2399%2C0903.2877%2C0903.5322%2C0903.4134%2C0903.2632%2C0903.3472%2C0903.3968%2C0903.2022%2C0903.1089%2C0903.5235%2C0903.2694%2C0903.2176%2C0903.4816%2C0903.2471%2C0903.1347%2C0903.2674%2C0903.4451%2C0903.4139%2C0903.4402%2C0903.0284%2C0903.3340%2C0903.5286%2C0903.5415%2C0903.1708%2C0903.4377%2C0903.1645%2C0903.2854%2C0903.0236%2C0903.3259%2C0903.4694%2C0903.3592%2C0903.4477%2C0903.4430%2C0903.1167%2C0903.2420%2C0903.0853%2C0903.4736%2C0903.0444%2C0903.2761%2C0903.0430%2C0903.1574%2C0903.5159%2C0903.3599%2C0903.4773%2C0903.4954%2C0903.4689%2C0903.4331%2C0903.0310%2C0903.0218%2C0903.3189%2C0903.4441%2C0903.2830%2C0903.4237%2C0903.0023%2C0903.0277%2C0903.2014&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The article provides a factorization formalism for determinants of the period\nmatrices for D-modules on curves. Unlike previous approach due to Bloch,\nDeligne, and Esnault, it does not use Fourier transform."}, "authors": ["Alexander Beilinson"], "author_detail": {"name": "Alexander Beilinson"}, "author": "Alexander Beilinson", "links": [{"href": "http://arxiv.org/abs/0903.2674v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0903.2674v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0903.2674v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0903.2674v2", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:0903.2674v2 [math.AG] 16 Apr 2009\n\nFields Institute Communications\nVolume 56, 2009\n\nE-Factors for the Period Determinants of Curves\nAlexander Beilinson\nDepartment of Mathematics\nUniversity of Chicago\nChicago, IL 60637, USA\nsasha@math.uchicago.edu\n\nTo Spencer Bloch\n\nThe myriad beings of the six worlds \u2013\ngods, humans, beasts, ghosts, demons, and devils \u2013\nare our relatives and friends.\nTesshu \"Bushido\", translated by J. Stevens.\n\nIntroduction\n0.1. Let X be a smooth compact complex curve, M be a holonomic D-module\non X (so outside a finite subset T \u2282 X, our M is a vector bundle with a connection \u2207). Denote by dR(M ) the algebraic de Rham complex of M placed in\ndegrees [\u22121, 0]; this is a complex of sheaves on the Zariski topology XZar . Its\nanalytic counterpart dRan (M ) is a complex of sheaves on the classical topology\nXcl . Viewed as an object of the derived category of C-sheaves, this is a perverse\n\u2207\nsheaf, which we denote by B(M ); outside T , it is the local system MX\\T\nof \u2207*\n*\nhorizontal sections (placed in degree \u22121). Set HdR (X, M ) := H (XZar , dR(M )),\nHB* (X, M ) := H * (Xcl , B(M )); these are the de Rham and Betti cohomology. We\n\u223c\n*\nhave the period isomorphism \u03c1 : HdR\n(X, M ) \u2192 HB* (X, M ).\n*\n*\nThe cohomology HdR and HB have, respectively, algebraic and topological nature that can be tasted as follows. Let k, k \u2032 \u2282 C be subfields. Then:\n*\n- For (X, M ) defined over k, we have de Rham k-structure HdR\n(Xk , Mk ) on\n*\nHdR (X, M );\n- A k \u2032 -structure on B(M ), i.e., a perverse k \u2032 -sheaf Bk\u2032 on Xcl together with an iso\u223c\nmorphism Bk\u2032 \u2297 C \u2192 B(M ), yields Betti k \u2032 -structure H * (Xcl , Bk\u2032 ) on HB* (X, M ).\nk\u2032\n\nIf both (Xk , Mk ) and Bk\u2032 are at hand, then, computing det \u03c1 with respect to\nrational bases, one gets a number whose class [det \u03c1] in C\u00d7 /k \u00d7 k \u2032\u00d7 does not depend\non the choice of the bases. In his farewell seminar at Bures [Del], Deligne, guided\n2000 Mathematics Subject Classification. Primary 14F40; Secondary 11G45.\nKey words and phrases. \u03b5-factors, period determinants, D-modules.\nc 2009 American Mathematical Society\n\n1\n\n\f2\n\nAlexander Beilinson\n\nby an analogy between [det \u03c1] and the constant in the functional equation of an\nL-function, asked if [det \u03c1] can be expressed, in presence of an extra datum of a\nrational 1-form \u03bd, as the product of certain factors of local origin at points of T and\ndiv(\u03bd). He also suggested the existence of a general geometric format which would\nyield the product formula (see 0.3 below). Our aim is to establish such a format.\n0.2. Remarks. (i) A natural class of k \u2032 -structures on B(M ) comes as follows.\nSuppose for simplicity that M equals the (algebraic) direct image of MX\\T by\nX \\ T \u0592\u2192 X. Let \u03c0 : X\u0303 \u2192 X be the real blow-up of X at T (so X\u0303 is a real-analytic\nsurface with boundary \u2202 X\u0303 = \u03c0 \u22121 (T ), and \u03c0 is an isomorphism over X \\ T ). Then\n\u2207\n\u2207\nMX\\T\nextends uniquely to a local system MX\u0303\non X\u0303. Following Malgrange [M],\n\u03c4\n\u2207\nconsider the constructible subsheaf MX\u0303 of MX\u0303 of sections of moderate growth (so\n\u03c4\n\u2207\n\u03c4\n\u2207\nMX\u0303\ncoincides with MX\u0303\noff \u2202 X\u0303, and MX\u0303\nequals MX\u0303\nif and only if M has regular\nsingularities). By [M] 3.2, one has a canonical isomorphism\n\u223c\n\n\u03c4\n\u2192 B(M ).\nR\u03c0\u2217 MX\u0303\n\n(0.2.1)\n\n\u03c4\nTherefore a k \u2032 -structure on MX\u0303\nyields a k \u2032 -structure on B(M ). Notice that the\n\u2207\n\u2207\nformer is the same as a k \u2032 -structure on the local system MX\u0303\n, i.e., on MX\\T\n, such\n\u03c4\n\u2032\nthat the subsheaf MX\u0303 is defined over k .\n\u03c4\n(ii) By (0.2.1), one has HB* (X, M ) = H * (X\u0303, MX\u0303\n). The dual vector space equals\n*\n\u03c4\nH (X\u0303, DMX\u0303 ), where D is the Verdier duality functor, which is the homology group\n\u2228\nof cycles with coefficients in MX\\T\non X \\ T , having rapid decay at T . So \u03c1, viewed\n*\n\u03c4\nas a pairing HdR\n(X, M ) \u00d7 H * (X\u0303, DMX\u0303\n) \u2192 C, is the matrix of periods of M -valued\nforms along the cycles of rapid decay. See [BE] for many examples.\n(iii) The setting of 0.1 makes sense for proper X of any dimension. The passage\nB to perverse sheaves commutes with direct image functors for proper morphisms\nX \u2192 Y , so the data (Xk , Mk , Bk\u2032 ) are functorial with respect to direct image.\n\n0.3. The next format, which yields the product formula, was suggested in the\nlast expos\u00e9 of [Del]:\n*\n(i) There should exist \u03b5-factorization formalisms for det HdR\nand det HB* . These\nare natural rules which assign to every non-zero meromorphic 1-form \u03bd on X two\ncollections of lines EdR (M )(x,\u03bd) and EB (M )(x,\u03bd) labeled by points x \u2208 X. The lines\nE? (M )(x,\u03bd) have x-local nature; if x \u2208\n/ T \u222a div(\u03bd), then E? (M )(x,\u03bd) is naturally\ntrivialized. Finally, one has \u03b5-factorization, alias product formula, isomorphisms\n\u03b7? :\n\n\u2297\n\nx\u2208T \u222adiv(\u03bd)\n\n\u223c\n\nE? (M )(x,\u03bd) \u2192 det H?* (X, M ).\n\n(0.3.1)\n\n(ii) The de Rham and Betti \u03b5-factorizations should have, respectively, algebraic and topological origin. Thus, if X, M, \u03bd are defined over k, then the datum\n{EdR (M )(x,\u03bd) } is defined over k, and a k \u2032 -structure on B(M ) yields a k \u2032 -structure\non every EB (M )(x,\u03bd) . One wants these structures to be compatible with the trivializations of E? (M )(x,\u03bd) off T \u222a div(\u03bd), and \u03b7dR , \u03b7B to be defined over k, k \u2032 .\n\n\fE-Factors for the Period Determinants of Curves\n\n3\n\u223c\n\n(iii) There should be natural \u03b5-period isomorphisms \u03c1\u03b5 = \u03c1\u03b5(x,\u03bd) : EdR (M )(x,\u03bd) \u2192\nEB (M )(x,\u03bd) of x-local origin such that the next diagram commutes:\n\u2297EdR (M )(x,\u03bd)\n\u2297\u03c1\u03b5(x,\u03bd) \u2193\n\u2297EB (M )(x,\u03bd)\n\n\u03b7dR\n\n*\n\u2212\u2192 det HdR\n(X, M )\n\u03c1\u2193\n\u03b7B\n\n\u2212\u2192\n\n(0.3.2)\n\ndet HB* (X, M )\n\nSuppose (X, M, \u03bd) is defined over k. The points in T \u222a div(\u03bd) are algebraic over\nk; let {O\u03b1 } be their partition by the Galois orbits. By (ii), the lines \u2297 EdR (M )(x,\u03bd)\nx\u2208O\u03b1\n\ncarry k-structure. If B(M ) is defined over k \u2032 , then, by (ii), EB (M )(x,\u03bd) carry k \u2032 structure. Writing \u2297 \u03c1\u03b5(x,\u03bd) in k-k \u2032 -bases, we get numbers [\u03c1\u03b5(O\u03b1 ,\u03bd) ] \u2208 C\u00d7 /k \u00d7 k \u2032\u00d7 .\nx\u2208O\u03b1\n\nNow (0.3.2) yields the promised product formula\n[det \u03c1] = \u03a0 [\u03c1\u03b5(O\u03b1 ,\u03bd) ].\n\n(0.3.3)\n\n\u03b1\n\nWe will show that the above picture is, indeed, true.\n0.4. Parts of this format were established earlier: the de Rham \u03b5-factorization\nwas constructed already in [Del] (and reinvented later in [BBE]); the Betti counterpart was presented (in the general context of \"animation\" of Kashiwara's index\nformula) in [B].1 It remains to construct \u03c1\u03b5 . The point is that E? satisfy several\nnatural constraints, and compatibility with them determines \u03c1\u03b5 almost uniquely.\nNotice that we work completely over C: the k- and k \u2032 -structures are irrelevant.\nThe principal constraints are the global product formula (0.3.1) and its next\nlocal counterpart. For \u03bd \u2032 close to \u03bd, the points of T \u222a div(\u03bd \u2032 ) cluster around T \u222a\n\u223c\ndiv(\u03bd). Now the isomorphism\n\u2297\nE? (M )(x\u2032 ,\u03bd \u2032 ) \u2192\n\u2297\nE? (M )(x,\u03bd) that\nx\u2032 \u2208T \u222adiv(\u03bd \u2032 )\n\nx\u2208T \u222adiv(\u03bd)\n\ncomes from global identifications (0.3.1) can be written as the tensor product of\nnatural isomorphisms of local origin at points of T \u222a div(\u03bd). This local factorization\nstructure (which is a guise, with an odd twist, of the geometric class field theory) is\nfairly rigid: E? (M ) is determined by a rank 1 local system det MX\\T and a collection\nof lines labeled by elements of T .2\nThe rest of constraints for M 7\u2192 E? (M ) are listed in 5.1. We show that there\n\u223c\nis an isomorphism \u03c1\u03b5 : EdR \u2192 EB compatible with them, which is determined\nuniquely up to a power of a simple canonical automorphism of E? , i.e., \u03c1\u03b5 form a\nZ-torsor EB/dR . First we recover \u03c1\u03b5 from \u03b7-compatibility (0.3.2) for (P1 , {0, \u221e}),\nM with regular singularities at \u221e, and (P1 , {0, 1, \u221e}), M of rank 1 with regular\nsingularities. Having \u03c1\u03b5 at hand, one has to prove that it is compatible with the\nconstraints for all (X, T, M ), of which (0.3.2) is central. The core of the argument\nis global: we use a theorem of Goldman [G] and Pickrell-Xia [PX1], [PX2], which\nasserts that the action of the Teichm\u00fcller group on the moduli space of unitary\nlocal systems with fixed local monodromies is ergodic. As in [G], this implies that,\nwhen the genus of X and the order of T are fixed, the possible discrepancy of\n(0.3.2) depends only on the local datum of monodromies at singularities of M . An\nobservation that this discrepancy does not change upon quadratic degenerations of\nX reduces the proof to a few simple computations.\n1 In\n\n[Del] it was suggested that in case when Re(\u03bd) is exact, Re(\u03bd) = df , the Betti \u03b5factorization comes from the Morse theory of f ; see 4.6 or [B] 3.8 for a proof.\n2 In the same manner as the \u03bd-dependence of the classical \u03b5-factor of a Galois module V is\ncontrolled, via the class field theory, by det V .\n\n\f4\n\nAlexander Beilinson\n\n0.5. One can ask for an explicit formula for \u03c1\u03b5 (M ). An analytic approach\nas in [PS] or [SW] shows that the de Rham \u03b5-factors of a D-module M can be\nrecovered from the D\u221e -module M \u221e := D\u221e \u2297 M . Thus the ratio between the \u03b5D\n\nfactors of M and of another D-module M \u2032 (say, with regular singularities) with\nB(M ) = B(M \u2032 ), is certain Fredholm determinant (a variant of \u03c4 -function). If x\nis a regular singular point of M , then [\u03c1\u03b5(x,\u03bd) ] can be written explicitly using the\n\u0393-function, see 6.3 (which is similar to the fact that the classical \u03b5-factors of tamely\nramified Galois modules are essentially products of Gauss sums). An example of\nR1\nthe product formula is the Euler identity t\u03b1\u22121 (1 \u2212 t)\u03b2\u22121 dt = \u0393(\u03b1)\u0393(\u03b2)\n\u0393(\u03b1+\u03b2) .\n0\n\n0.6. Plan of the article: \u00a71 presents a general story of factorization lines (i.e.,\nof the local factorization structure); in \u00a72\u20134 the algebraic and analytic de Rham\n\u03b5-factors, and their Betti counterpart are defined; \u00a75 treats the \u03b5-period map; in \u00a76\nthe \u03b5-periods are written explicitly in terms of the \u0393-function.\nA different approach to product formula (0.3.3), based on Fourier transform,\nwas developed by Bloch, Deligne, and Esnault [BDE], [E] (some essential ideas go\nback to [Del] and [L]; the case of regular singularities was considered earlier, and\nfor X of arbitrary dimension, in [A], [LS], [ST], and [T]).3 The two constructions\nare fairly complementary; the relation between them remains to be understood.\nQuestions & hopes. (o) For Verdier dual M , M \u2228 the lines E? (M )(x,\u03bd) and\nE? (M \u2228 )(x,\u2212\u03bd) should be naturally dual,4 and \u03c1\u03b5 should be compatible with duality.\n(i) The period story should exist for X of any dimension, with mere lines\nreplaced by finer objects (the homotopy points of K-theory spectra). For the Betti\nside, see [B]; for the de Rham one, see [P].\nThe meaning of local factorization structure for dim X > 1 is not clear (as of the\nmore general notion of factorization sheaves in the setting of algebraic geometry).\nIs there an agebro-geometric analog of the recent beautiful work of Lurie on the\nclassification of TQFT?\n(ii) There should be a geometric theory of \u03b5-factors (cf. 5.1) for \u00e9tale sheaves;\nfor an \u00e9tale sheaf of virtual rank 0 on a curve over a finite field, the corresponding\ntrace of Frobenius function should be equal to the classical \u03b5-factors.5 Notice that\nLaumon's construction [L] (which is the only currently available method to establish\nthe product formula for classical \u03b5-factors) has different arrangement: its input is\nmore restrictive (the forms \u03bd are exact), while the output is more precise (the \u03b5-lines\nare realized as determinants of true complexes).\n(iii) What would be a motivic version of the story?\n(iv) \u0393-function appears in Deninger's vision [Den] of classical local Archimedean\n\u03b5-factors. Are the two stories related on a deeper level?\n0.7. I am grateful to S. Bloch, V. Drinfeld, and H. Esnault whose interest was\ncrucial for this work, to P. Deligne for the pleasure to play in a garden he conceived,\nto B. Farb for the information about the Goldman and Pickrell-Xia theorems, to\n3 [BDE] considers the case of M of virtual rank 0 and the Betti structure compatible with\nthe Stokes structures (hence of type considered in 0.3(i)).\n4 For E\nB this is evident from the construction; for EdR one can hopefully deduce it from\n(2.10.5) applied to M \u2295 M \u2228 .\n5 The condition of virtual rank 0 is essential: the \u03b5-line for the constant sheaf of rank 1\nhas non-trivial \u00b11 monodromy on the components of \u03bd's with odd order of zero, so the trace of\nFrobenius function is non-constant on every such component (as opposed to the classical \u03b5-factor).\n\n\fE-Factors for the Period Determinants of Curves\n\n5\n\nV. Schechtman and D. Zagier who urged me to write formulas, to the referee for\nthe help, and to IHES for a serene sojourn. The research was partially supported\nby NSF grant DMS-0401164.\nThe article is a modest tribute to Spencer Bloch, for all his gifts and joy of\nbooks, of the woods, and of our relatives and friends \u2013 the numbers.\n1 Factorization lines\nThis section is essentially an exposition of geometric class field theory (mostly)\nin its algebraic de Rham version.\n1.1. We live over a fixed ground field k of characteristic 0; \"scheme\" means\n\"separated k-scheme of finite type\". The category Sch of schemes is viewed as a\nsite for the \u00e9tale topology (so \"neighborhood\" means \"\u00e9tale neighborhood\", etc.),\n\"space\" means a sheaf on Sch; for a space F and a scheme S elements of F (S) are\nreferred to as S-points of F . All Picard groupoids are assumed to be commutative\nand essentially small. For a Picard groupoid L, we denote by \u03c00 (L), \u03c01 (L) the\ngroup of isomorphism classes of its objects and the automorphism group of any its\nobject; for L \u2208 L its class is [L] \u2208 \u03c00 (L).\nLet X be a smooth (not necessary proper or connected) curve, T its finite\nsubscheme, K a line bundle on X.6 For a test scheme S, we write XS := X \u00d7 S,\nTS := T \u00d7 S, KS := K \u22a0 OS ; \u03c0 : XS \u2192 S is the projection. For a Cartier divisor\nD on XS we denote by |D| the support of D viewed as a reduced closed subscheme.\nConsider the next spaces:\n(a) Div(X): its S-points are relative Cartier divisors D on XS /S such that |D| is\nfinite over S;\n(b) 2T is a scheme whose S-points c are idempotents in O(TS ). Such c amounts to\nan open and closed subscheme TSc of TS (the support of c);\n(c) D = D(X, T ) \u2282 Div(X) \u00d7 2T consists of those pairs (D, c) that D \u2229 TS \u2282 TSc ;\n(d) D\u22c4 = D\u22c4 (X, T ; K) is formed by triples (D, c, \u03bdP ) where (D, c) \u2208 D and \u03bdP is a\ntrivialization of the restriction of the line bundle K(D) := KS (D) to the subscheme\nP = PD,c := TSc \u222a |D|.\nDenote by \u03c00 (X) the scheme of connected components of X.7 One has projection deg : Div(X) \u2192 Z\u03c00 (X) , hence the projections D\u22c4 \u2192 D \u2192 Z\u03c00 (X) \u00d7 2T . Notice\nthat the component Dc=0 equals Div(X \\ T ), and Dc=1 equals Div(X).\nRemarks. (i) Every S-point of D can be lifted S-locally to D\u22c4 .\n(ii) Every \u03bdP as in (d) can be extended S-locally to a trivialization \u03bd of K(D)\non a neighborhood V \u2282 XS of P . One can view \u03bdP as an equivalence class of \u03bd's,\nwhere \u03bd and \u03bd \u2032 are equivalent if the function \u03bd/\u03bd \u2032 equals 1 on P . We often write\n(D, c, \u03bd) for (D, c, \u03bdP ).\n(iii) Each space F of the list (a)\u2013(d) is smooth in the next sense: for every\nclosed embedding S \u0592\u2192 S \u2032 , a geometric point s \u2208 S, and \u03c6 \u2208 F (S) one can find an\nneighborhood U \u2032 of s in S \u2032 and \u03c6\u2032 \u2208 F (U \u2032 ) such that \u03c6|US\u2032 = \u03c6\u2032 |US\u2032 .\n(iv) The geometric fibers of Div(X) over Z\u03c00 (X) and of D, D\u22c4 over Z\u03c00 (X) \u00d7 2T ,\nare connected (i.e., every two geometric points of any fiber are members of one\nconnected family).\n6 Starting\n7 Which\n\nfrom \u00a72, our K equals \u03c9X .\nis the spectrum of the integral closure of k in the ring of functions on X.\n\n\f6\n\nAlexander Beilinson\n\nA comment about the fiber D\u22c4(D,c) of D\u22c4 /D over (D, c) \u2208 D(S): Suppose S is\n\u00d7\nsmooth, so PD,c is a relative Cartier divisor in XS /S. Denote by OD,c\nthe Weil\n\u00d7\nPD,c /S-descent of GmP , and by K(D)D,c the Weil PD,c /S-descent of the GmP \u00d7\nis a smooth group\ntorsor of trivializations of the line bundle K(D)|PD,c . Then OD,c\n\u00d7\n\u00d7\nS-scheme, and K(D)D,c is an OD,c -torsor; for any S-scheme S \u2032 an S \u2032 -point of\nK(D)\u00d7\nD,c is the same as a trivialization of K(D) over (PD,c )S \u2032 . The latter relative\ndivisor contains PDS\u2032 ,cS\u2032 (the corresponding reduced schemes coincide), so we have\n\u22c4\na canonical surjective morphism K(D)\u00d7\nD,c \u2192 D(D,c) , hence a canonical (D, c, \u03bdP ) \u2208\n\u00d7\n\u00d7\n\u22c4\n\u2032\n\u22c4\nD (K(D)D,c ). The map K(D)D,c (S ) \u2192 D(D,c) (S \u2032 ) is bijective if S \u2032 is smooth over\nS, but not in general.\nExamples. (i) Suppose S = X \\ T , (D, c) = (l\u2206, 0) where \u2206 is the diagonal\n\u00d7\n(l)\ndivisor, l is any integer. Then OD,c\n= GmS , and K(D)\u00d7\nof\nD,c is the Gm -torsor K\n\u2297\u2212l\n\u2032\n\u2032\ntrivializations of the line bundle K(D)|\u2206 = K \u2297 \u03c9X |S . For any S /S an S -point\n\u2032\nof D\u22c4(l\u2206,0) is the same as an Sred\n-point of K(l) , i.e., D\u22c4(l\u2206,0) is the quotient of K(l)\nmodulo the action of the formal multiplicative group Gm\u0302 .\n(ii) For a point b \u2208 T let kb be its residue field, Tb \u2282 T be the component of\nb, and mb its multiplicity. Consider (D, c) = (nb, 1b ) \u2208 D(S), where S = Spec kb ,\nn is any integer, 1b is the characteristic function of b \u2208 T (S). Then PD,c = Tb , so\n\u00d7\nOD,c\n= OT\u00d7b is an extension of GmS by the unipotent radical. One has K(nb)\u00d7\nTb :=\n\u223c\n\u00d7\n\u00d7\n\u22c4\n.\nWe\nset\nK\n:=\nK(0b)\n.\n\u2192\nD\nK(D)\u00d7\nTb\nTb\nD,c\n(D,c)\n1.2. Let V be a stack, alias a sheaf of categories, on Sch. For a space F we\ndenote by V(F ) the category of Cartesian functors V : F \u2192 V. Explicitly, such V\nis a rule that assigns to every test scheme S and \u03c6 \u2208 F (S) an object V\u03c6 \u2208 V(S)\ntogether with a base change compatibility constraint. If V is a Picard stack, alias\na sheaf of Picard groupoids, then V(F ) is naturally a Picard groupoid.\nBelow we denote by F\u0304 the space with F\u0304 (S) := F (Sred ). The stack of V-crystals\nVcrys is defined by formula Vcrys (S) := V(S\u0304). If F is formally smooth (i.e., satisfies\nthe property from Remark (iii) in 1.1 for every nilpotent embedding S \u0592\u2192 S \u2032 ), then\nF\u0304 is the quotient of F modulo the evident equivalence relation; therefore objects\nof Vcrys (F ) = V(F\u0304 ) are the same as objects V \u2208 V(F ) equipped with a de Rham\n\u223c\nstructure, i.e., a natural identification \u03b1 : V\u03c6 \u2192 V\u03c6\u2032 for every \u03c6, \u03c6\u2032 \u2208 F (S) such\nthat \u03c6|Sred = \u03c6\u2032 |Sred , which is transitive and compatible with base change. E.g. if\nF is a smooth scheme, then a vector bundle crystal on F is the same as a vector\nbundle on F equipped with a flat connection.\nKey examples: Let Lk be the Picard groupoid of Z-graded k-lines (with \"super\"\ncommutativity constraint for the tensor structure). Below we call them simply\n\"lines\" or \"k-lines\"; the degree of a line G is denoted by deg(G). An O-line on\nS (or OS -line) is an invertible Z-graded vector bundle on S. These objects form\na Picard groupoid LO (S); the usual pull-back functors make LO a Picard stack.\nBelow LO -crystals are referred to as de Rham lines; they form a Picard stack LdR .\nInstead of Z-graded lines, we can consider Z/2-graded ones; the corresponding\nPicard stacks are denoted by L\u2032O , L\u2032dR . We mostly consider Z-graded setting; all\nthe results remain valid, with evident modifications, for Z/2-graded one.\nRemarks. (i) Let (X \u2032 , T \u2032 ) be another pair as in 1.1, and \u03c0 : (X \u2032 , T \u2032 ) \u2192 (X, T ) be\na finite morphism of pairs, i.e., \u03c0 : X \u2032 \u2192 X is a finite morphism of curves such that\n\u03c0(T \u2032 ) \u2282 T . It yields a morphism of spaces \u03c0 \u2217 : D\u22c4 (X, T ; K) \u2192 D\u22c4 (X \u2032 , T \u2032 ; \u03c0 \u2217 K),\n\n\fE-Factors for the Period Determinants of Curves\n\n7\n\n(D, c, \u03bd) 7\u2192 (\u03c0 \u2217 D, \u03c0 \u2217 c, \u03c0 \u2217 \u03bd), hence the pull-back functor \u03c0\u2217 : V(D\u22c4 (X \u2032 , T \u2032 ; \u03c0 \u2217 K)) \u2192\nV(D\u22c4 (X, T ; K)) denoted by \u03c0\u2217 ; if V is a Picard stack, then \u03c0\u2217 is a morphism of\nPicard groupoids. If X \u2032 = X, T \u2032 \u2282 T , we refer to \u03c0\u2217 as \"restriction to (X, T )\".\n\u2032\nExercise. If T \u2032 \u2282 T , Tred\n= Tred , then the restriction LdR (D\u22c4 (X, T \u2032 ; K)) \u2192\n\u22c4\nLdR (D (X, T ; K)) is a fully faithful embedding.\nWe denote the union of the Picards groupoids LdR (D\u22c4 (X, T \u2032\u2032 ; K)) for all T \u2032\u2032\n\u2032\u2032\nwith Tred\n= Tred by LdR (D\u22c4 (X, T\u0302 ; K)) (here T\u0302 is the formal completion of X at\nT ).\n(ii) The space D\u22c4 (X, T ; K), hence L? (D\u22c4 (X, T ; K)), actually depends only on\nthe restriction of K to X \\ T . Indeed, for any divisor D(T ) supported on T , there\n\u223c\nis a canonical identification D\u22c4 (X, T ; K) \u2192 D\u22c4 (X, T ; K(D(T ))), (D, c, \u03bd) 7\u2192 (D \u2212\nc\nc\nc\nD(T ) , \u03bd), where D(T ) equals D(T ) on TS and to 0 outside. We keep K to be a line\nbundle on X for future notational convenience.\n(iii) If U is any open subset of X, then D\u22c4 (U, TU ; KU ) \u2282 D\u22c4 (X, T ; K), hence\nwe have the restriction functor V(D\u22c4 (X, T ; K)) \u2192 V(D\u22c4 (U, TU ; KU )).\n(iv) Remark (iv) in 1.1 implies that \u03c01 (LdR (D\u22c4 ) = O\u00d7 (Z\u03c00 (X) \u00d7 2T ).\n1.3. Let Sm \u2282 Sch be the full subcategory of smooth schemes. For V, F as in\n1.2 we denote by V sm (F ) the Picard groupoid of Cartesian functors F |Sm \u2192 V|Sm .\nOne has a restriction functor V(F ) \u2192 V sm (F ). If F is smooth in the sense of\nRemark (iii) in 1.1, then this is a faithful functor.\nExercise. Suppose we have E, E \u2032 \u2208 LdR (D\u22c4 ) and a morphism \u03c6 : E \u2192 E \u2032 in\nLO (D\u22c4 ). Then \u03c6 is a morphism in LdR (D\u22c4 ), if (and only if) the corresponding\n\u22c4\nsm\n\u22c4 8\nmorphism in Lsm\nO (D ) lies in LdR (D ).\n\u223c\n\nLemma. LdR (F ) \u2192 Lsm\ndR (F ).\nProof. This follows from the fact that LdR is a stack with respect to the htopology, and h-locally every scheme is smooth.\n\u0003\nRemark. By the lemma and 1.1, one can view E \u2208 LdR (D\u22c4 ) as a rule that\nassigns to every smooth S and (D, c) \u2208 D(S) a de Rham line E(D,c) := E(D,c,\u03bdP ) on\nK(D)\u00d7\nD,c in a way compatible with the base change.\n1.4. For this subsection, X is proper. Let Rat(X, K) = Rat(X) be a space\nwhose S-points are rational sections \u03bd of the line bundle KS such that |div(\u03bd)|\ndoes not contain a connected component of any geometric fiber of XS /S. There\nis a natural morphism Rat(X) \u2192 D\u22c4c=1 , \u03bd 7\u2192 (\u2212div(\u03bd), 1, \u03bd), so every E \u2208 L? (D\u22c4 )\nyields naturally an object of L? (Rat(X)), which we denote again by E.\nThe next fact is a particular case of [BD] 4.3.13:\nProposition. Every function on Rat(X) is constant. All O- and de Rham lines\non Rat(X) are constant.\n(m)\n\nProof. Let L be an auxiliary ample line bundle on X; set V1\n:= \u0393(X, K \u2297\n(m)\n(m)\n(m)\n\u2297m\n(m)\n\u2297m\n\u2282 P(V1 \u00d7V2 ) be the open subset of those\nL ), V2 := \u0393(X, L ). Let U\n\u03c6 = (\u03c61 , \u03c62 ) that neither \u03c61 nor \u03c62 vanishes on any connected component of X.\nConsider a map \u03b8(m) : U (m) \u2192 Rat(X), (\u03c61 , \u03c62 ) 7\u2192 \u03c61 /\u03c62 . We will check that for m\nlarge the \u03b8(m) -pull-back of any O- or de Rham line on Rat(X) is trivial, and every\n8 Hint:\n\nUse Remark (iii) in 1.1 for embeddings S \u0592\u2192 S \u2032 where S \u2032 is smooth.\n\n\f8\n\nAlexander Beilinson\n\nfunction on U (m) is constant. This implies the proposition, since geometric fibers\nof \u03b8(m) are connected and the images of \u03b8(m) form a directed system of subspaces\nwhose inductive limit equals Rat(X) (i.e., every \u03bd \u2208 Rat(X)(S) factors S-locally\nthrough \u03b8(m) for sufficiently large m).\n(m)\n(m)\nNotice that the complement to U (m) in P(V1 \u00d7 V2 ) has codimension \u2265 2\nfor m large. Therefore every function and every O- and de Rham line extend to\n(m)\n(m)\nP(V1 \u00d7 V2 ). Thus for m large every function on U (m) is constant and every de\nRham line is trivial.\nThe case of an O-line requires an extra argument. Any (\u03c81 , \u03c82 ) \u2208 U (n) yields\n(m)\n(m)\nan embedding P(\u0393(X, L\u2297k )) \u0592\u2192 P(V1 \u00d7 V2 ), \u03b3 7\u2192 (\u03b3\u03c81 , \u03b3\u03c82 ); here m = n + k.\n(m)\nFor k large, the preimage of U\nin P(\u0393(X, L\u2297k )) is an open dense subset of\n(m)\ncodimension \u2265 2, and \u03b8\nis constant on it. Thus for any O-line L on Rat(X) the\n(m)\n(m)\nrestriction of the corresponding line on P(V1 \u00d7 V2 ) to P(\u0393(X, L\u2297k )) is trivial,\nhence the line itself is trivial, so \u03b8(m)\u2217 L is trivial, and we are done.\n\u0003\nTherefore for any E in LO (D\u22c4 ) or LdR (D\u22c4 ) the lines E\u03bd for all rational non-zero\n\u03bd are canonically identified. We denote this line simply by E(X).\n1.5. A finite subset of {(D\u03b1 , c\u03b1 , \u03bd\u03b1 )} of D\u22c4 (S), is said to be disjoint if the subschemes PD\u03b1 ,c\u03b1 are pairwise disjoint. Then we have \u03a3(D\u03b1 , c\u03b1 , \u03bd\u03b1 ) := (\u03a3D\u03b1 , \u03a3c\u03b1 , \u03a3\u03bd\u03b1 )\n\u2208 D\u22c4 (S), where \u03a3\u03bd\u03b1 equals \u03bd\u03b1 on PD\u03b1 ,c\u03b1 .\nFor E in L? (D\u22c4 ), where L? is a Picard stack, a factorization structure on E is\na rule which assigns to every disjoint family as above a factorization isomorphism\n\u223c\n\n\u2297\u03b1 E(D\u03b1 ,c\u03b1 ,\u03bd\u03b1 ) \u2192 E\u03a3(D\u03b1 ,c\u03b1 ,\u03bd\u03b1 ) .\n\n(1.5.1)\n\nThese isomorphisms should be compatible with base change and satisfy an evident\ntransitivity property. One defines factorization structure on objects of L? (D(X, T )),\nL? (Div(X)), L? (Diveff (X)), or L? (2T ) in the similar way.\nObjects of L? (D\u22c4 ) equipped with a factorization structure are called (K-twisted)\nfactorization objects of L? on (X, T ; K); they form a Picard groupoid L\u03a6\n? (X, T ; K).\n\u03a6\nIn particular, we have Picard groupoids L\u03a6\n(X,\nT\n;\nK),\nL\n(X,\nT\n;\nK)\nof\nO- and de\nO\ndR\nRham factorization lines.\nProposition. Factorization objects have local nature: U 7\u2192 L\u03a6\n? (U, TU ; KU ) is a\nPicard stack on X\u00e9t .\nProof. Let \u03c0 : U \u2192 X be an \u00e9tale map. For E \u2208 L\u03a6\n? (X, T ; K) one defines\nits pull-back \u03c0 \u2217 E as follows. Take any (D, c, \u03bd) \u2208 D\u22c4 (U, TU ; KU ). It suffices to\ndefine E(D,c,\u03bd) \u00e9tale locally on S. Write (D, c, \u03bd) = \u03a3(D\u03b1 , c\u03b1 , \u03bd\u03b1 ) with connected\nP\u03b1 = PD\u03b1 ,c\u03b1 . Then there is a uniquely defined (D\u03b1\u2032 , c\u2032\u03b1 , \u03bd\u03b1\u2032 ) \u2208 D\u22c4 (X, T ; K) such\nthat D\u03b1 is a connected component of the pull-back of D\u03b1\u2032 to U and \u03c0 yields an\n\u223c\n\u2032\nisomorphism P\u03b1 \u2192 P\u03b1\u2032 which identifies \u03bd\u03b1P\u03b1 with \u03bd\u03b1P\n\u2032 .\n\u03b1\n\u2217\nSet \u03c0 E(D,c,\u03bd) := \u2297 E(D\u03b1\u2032 ,c\u2032\u03b1 ,\u03bd\u03b1\u2032 ) . Due to factorization structure on E, this def\u22c4\ninition is compatible with base change, and \u03c0 \u2217 E \u2208 L\u03a6\n? (D (U, TU ; KU )) so defined\nhas an evident factorization structure. Thus L\u03a6\n? is a presheaf of Picard groupoids\non X\u00e9t . We leave it to the reader to check the gluing property.\n\u0003\nNB: The pull-back functor for open embeddings is defined regardless of factorization structure (see Remark (iii) in 1.2).\n\u03a6\nRemarks. (i) The evident forgetful functor L\u03a6\ndR (X, T ; K) \u2192 LO (X, T ; K) is\nfaithful. By 1.2 (and Remark (iii) in 1.1), for E \u2208 L\u03a6\nO (X, T ; K) a de Rham structure\n\n\fE-Factors for the Period Determinants of Curves\n\n9\n\non E, i.e., a lifting of E to L\u03a6\ndR (X, T ; K), amounts to a rule which assigns to every\nscheme S and a pair of points (D, c, \u03bdP ), (D\u2032 , c\u2032 , \u03bdP\u2032 ) \u2208 D\u22c4 (S) which coincide on\nSred , a natural identification (notice that c = c\u2032 )\n\u223c\n\n\u03b1\u03b5 : E(D,c,\u03bdP ) \u2192 E(D\u2032 ,c,\u03bdP\u2032 ) .\n\n(1.5.2)\n\nThe \u03b1\u03b5 should be transitive and compatible with base change and factorization.\n(ii) Remarks in 1.3 and (i)\u2013(iii) in 1.2 remain valid for factorization lines. Thus\nwe have a Picard groupoid L\u03a6\ndR (X, T\u0302 ; K), etc.\n(iii) There is a natural Picard functor\n\u03a6\n\u03a0 L? (b) \u2192 L? (X, T ; K),\n\nb\u2208Tred\n\n(1.5.3)\n\nwhich assigns to E = (Eb ) \u2208 \u03a0L? (b) a factorization object E with E(D,c,\u03bdP ) =\nc\nc\nc\nNmTredS\n/S (E); here TredS is the preimage of Tred by the projection p : TS \u2192 T .\n(iv) By Remark (iv) in 1.2 there is a natural isomorphism\n\u223c\n\nO\u00d7 (Tred ) \u00d7 O\u00d7 (\u03c00 (X)) \u2192 \u03c01 (L\u03a6\ndR (X, T ; K)).\n\n(1.5.4)\n\nHere (\u03b1, \u03b2) \u2208 O\u00d7 (Tred )\u00d7O\u00d7 (\u03c00 (X)) acts on E(D,c,\u03bd) as multiplication by the locally\ndeg(D)\nc\nconstant function NmTredS\n). Notice that the embedding\n/S (\u03b1)Nm\u03c00 (X)S /S (\u03b2\n\u00d7\n\u03a6\nO (Tred ) \u0592\u2192 \u03c01 (LdR (X, T ; K)) comes from (1.5.3).\n1.6. As in 1.1, every (D, c) \u2208 D(S), S is smooth, yields a morphism K(D)\u00d7\nD,c \u2192\n\u00d7\n\u22c4\n\u03a6\n\u22c4\nD , hence a Picard functor L? (D ) \u2192 L? (K(D)D,c ), E 7\u2192 E(D,c) . In particular,\nfollowing Examples in 1.1, for l \u2208 Z we have E (l) := E(l\u2206,0) \u2208 L? (K(l) ), and for\n(0)\n(n)\n\u00d7\nb \u2208 T , n \u2208 Z, we have ETb := E(nb,1b ) \u2208 L? (K(nb)\u00d7\nTb ). Set ETb := ETb \u2208 L? (KTb ).\n(0)\n(0)\nNotice that E \u2208 L? (K ) is canonically trivialized.\n\u22c4\n(l)\nIf E \u2208 L\u03a6\ncarry a canonical connection along the\nO (D ), then the O-lines E\n(l)\nfibers of the projection E \u2192 X \\ T (see Example (i) in 1.1). A de Rham structure\non E provides a flat connection \u2207\u03b5 on E (l) that extends this relative connection.\nSince the degrees of lines are locally constant, the factorization implies\ndeg(E (l) ) = l deg(E (1) ),\n\n(n+1)\n\ndeg(ETb\n\n(n)\n\n) = deg(ETb ) + deg(E (1) ).\n\n(1.6.1)\n\nLet LdR (X, T ) \u2282 LdR (X \\ T ) be the Picard subgroupoid of those de Rham lines\nwhose connection at every b \u2208 Tred has pole of order less or equal the multiplicity\nof T at b.\nFor a Gm -torsor K over a scheme Y we denote by LdR (Y ; K) the Picard\ngroupoid of de Rham lines G on K such that G \u22972 is constant along the fibers\n(i.e., comes from a de Rham line on Y ) and the fiberwise monodromy of G equals\n(\u22121)degG . Thus we have Picard groupoids LdR (X \\ T )(l) := LdR (X \\ T ; K(l) ),\nl \u2208 Z; let LdR (X, T )(l) \u2282 LdR (X \\ T )(l) be the Picard subgroupoids of those G that\nG \u22972 \u2208 LdR (X, T ).\nChoose a trivialization \u03bdT of the restriction of K to T , i.e., a collection {\u03bdTb }\nof kb -points in KT\u00d7b . For a factorization line E set E\u03bdTb := E(0,1b ,\u03bdTb ) = the fiber\nof ETb at \u03bdTb . The next theorem is the main result of this section. The proof for\nT = \u2205 is in 1.7\u20131.9; the general case is treated in 1.10\u20131.11. In 1.11 one finds its\nreformulation free from the auxiliary \u03bdT .\n\n\f10\n\nAlexander Beilinson\n\n(1)\nTheorem. For E \u2208 L\u03a6\n\u2208 LdR (X, T )(1) , and the functor\ndR (X, T ; K) one has E\n(1)\nL\u03a6\n\u00d7 \u03a0 Lkb ,\ndR (X, T ; K) \u2192 LdR (X, T )\nb\u2208Tred\n\nE 7\u2192 (E (1) , {E\u03bdTb }),\n\n(1.6.2)\n\nis an equivalence of Picard groupoids.\nIf K = \u03c9X , then the Gm -torsor K(1) is trivialized by a canonical section \u03bd1\n(its value at x \u2208 X \\ T is the element in \u03c9(x)/\u03c9 with residue 1). The functor\n\u03bd1\u2217 : LdR (X, T )(1) \u2192 LdR (X, T ) is evidently an equivalence, so the theorem can be\n(1)\nreformulated as follows (here EX\\T := \u03bd1\u2217 E (1) = E(\u2206,0,\u03bd1 ) ):\nTheorem\u2032 . One has a Picard groupoid equivalence\n\u223c\n\nL\u03a6\ndR (X, T ; \u03c9X ) \u2192 LdR (X, T ) \u00d7 \u03a0 Lkb ,\nb\u2208Tred\n\n(1)\n\nE 7\u2192 (EX\\T , {E\u03bdTb }).\n\n(1.6.3)\n\nVariant. More generally, we can fix a divisor \u03a3db b supported on T and take\nfor \u03bdT a trivialization of K(\u03a3db b) on T . The corresponding assertion is equivalent\nto the above theorem by Remark (ii) in 1.2.\nExample. If K = \u03c9X and T = Tred , then a convenient choice is db \u2261 1, for\n(1)\nK(b)\u00d7\nb is canonically trivialized by \u03bd1 as above. We denote the fiber of ETb at \u03bd1\n(1)\n\nby Eb .\n1.7. For the subsections 1.7\u20131.9 we assume that T = \u2205, so D = Div(X).\nFor a Picard stack L? and a commutative monoid space D denote by Hom(D, L? )\nthe Picard groupoid of symmetric monoidal morphisms D \u2192 L? (we view D as a\n\"discrete\" symmetric monoidal stack). Thus an object of Hom(D, L? ) is F \u2208 L? (D)\ntogether with a multiplication structure which is a rule that assigns to every finite\n\u223c\ncollection {D\u03b1 } of S-points of D a multiplication isomorphism \u2297 FD\u03b1 \u2192 F\u03a3D\u03b1\n(where \u03a3 is the operation in D); the isomorphisms should be compatible with base\nchange and satisfy an evident transitivity property. If Dgr is the group completion\n\u223c\nof D, then Hom(Dgr , L? ) \u2192 Hom(D, L? ).\nWe are interested in D equal to the monoid space of effective divisors Diveff (X) =\n\u2294 Symn (X) \u2282 Div(X); one has Diveff (X)gr = Div(X). A multiplication structure\non F being restricted to disjoint divisors makes a factorization structure. Pulling\nF back to D\u22c4 is a Picard functor\nHom(Div(X), L? ) \u2192 L\u03a6\n? (X; K).\n\n(1.7.1)\n\nLet L0dR \u2282 LdR be the Picard stack of degree 0 de Rham lines.\n\u223c\n\nProposition. One has Hom(Div(X), L0dR ) \u2192 L0\u03a6\ndR (X; K).\n(l)\nProof. (a) Let us show that for any E \u2208 L0\u03a6\non\ndR (X; K) the de Rham lines E\nK come from de Rham lines on X.\nThe claim is X-local, so we trivialize K by section a \u03bd0 and pick a function t\n(l)\non X with dt invertible. Then K(l) is trivialized by section \u03bd0 := \u03bd0 dt\u2297\u2212l ; let z be\nthe corresponding fiberwise coordinate on K(l) . Choose X-locally a trivialization\ne(l) of E (l) ; let \u03b8(l) \u2208 \u03c9K(l) /X be the restriction of \u2207(e(l) )/e(l) to the fibers. Then\n(l)\n\n(l)\n\n(l)\n\n\u03b8(l) = \u03a3fk (x)z k d log z, where fk (x), k \u2208 Z, are functions on X; we want to show\n(l)\n(l)\nthat fk (x) = 0 for k 6= 0,9 and f0 (x) \u2208 Z.\n9 The\n\nproof uses only the factorization O-line structure on E.\n\n\fE-Factors for the Period Determinants of Curves\n\n11\n\nLet S \u2282 X \u00d7 X be a sufficiently small neighborhood of the diagonal, x1 , x2 be\nthe coordinate functions on S that correspond to t, D(l1 ,l2 ) \u2208 Div(X)(S) be the divisor l1 \u22061 +l2 \u22062 . Then (t\u2212x1 )\u2212l1 (t\u2212x2 )\u2212l2 \u03bd0 is a trivialization of K(D(l1 ,l2 ) ) near\n(l ,l )\n|D(l1 ,l2 ) |. Denote by \u03bd0 1 2 the corresponding section of K(D(l1 ,l2 ) )\u00d7\n(see\nD(l1 ,l2 ) ,0\n(l1 ,l2 )\n\n1.1); set K(l1 ,l2 ) := Gm \u03bd0\n\n\u2282 K(D(l1 ,l2 ) )\u00d7\n, E (l1 ,l2 ) := E(D(l1 ,l2 ) ,0) |K(l1 ,l2 ) .\nD(l1 ,l2 ) ,0\n\nOutside the diagonal in S one has an embedding i(l1 ,l2 ) : K(l1 ,l2 ) \u0592\u2192 pr1\u2217 K(l1 ) \u00d7\n(l ,l )\npr2\u2217 K(l2 ) defined by the factorization; explicitly, it identifies z\u03bd0 1 2 (x1 , x2 ) with\n(l1 ,l2 )\n\u2212l1 (l2 )\n\u2212l2 (l1 )\nthe image of\n(z(x1 \u2212 x2 ) \u03bd0 (x1 ), z(x2 \u2212 x1 ) \u03bd0 (x2 )). Restricting to K\ne(l1 ) \u22a0 e(l2 ) by the factorization isomorphism (1.5.1), we get a trivialization e(l1 ,l2 )\nof E (l1 ,l2 ) outside the diagonal in S. Let m(l1 , l2 ) be its order of pole at the\ndiagonal, so (x1 \u2212 x2 )m(l1 ,l2 ) e(l1 ,l2 ) is a trivialization of E (l1 ,l2 ) on S. Therefore\nthe restriction \u03b8(l1 ,l2 ) of \u2207(e(l1 ,l2 ) )/e(l1 ,l2 ) to the fibers is a regular relative form,\n(l )\n(l )\nwhich equals i(l1 ,l2 )\u2217 (pr1\u2217 \u03b8(l1 ) +pr2\u2217 \u03b8(l2 ) ) = \u03a3(fk 1 (x1 )(x1 \u2212x2 )\u2212kl2 +fk 2 (x1 )(x2 \u2212\n\u2212kl1 k\n)z d log z.\nx1 )\n(l)\nSince \u03b8(l,\u2212l) has no pole at the diagonal, the above formula implies that fk = 0\n(l)\nfor kl < 0. Similarly, the formula for \u03b8(l,2l) shows that fk = 0 for kl > 0. To\n(l)\nsee that f0 \u2208 Z, notice that the above picture for l1 = l2 = l is symmetric with\nrespect to the transposition involution \u03c3 of X\u00d7X, hence descends to S/\u03c3 \u2282 Sym2 X.\n(l)\nThus m(l, l) is even. One has \u2207(e(l) )/e(l) = f0 d log z + g (l) (x)dx where g (l) (x) is\na regular function. Then \u2207(e(l,l) )/e(l,l) + d log(x1 \u2212 x2 )m(l,l) is a regular 1-form.\n(l)\n(l)\nIt equals (f0 (x1 ) + f0 (x2 ))(d log z \u2212 d log(x1 \u2212 x2 )) + m(l, l)d log(x1 \u2212 x2 ) +\n(l)\ng (l) (x1 )dx1 + g (l) (x2 )dx2 . Therefore f0 (x) = m(l, l)/2 \u2208 Z, and we are done.\n(b) The next properties of de Rham lines will be repeatedly used. Let \u03c0 : K \u2192\nS be a smooth morphism of smooth schemes with dense image.\nLemma. (i) The functor \u03c0 \u2217 : LdR (S) \u2192 LdR (K) is faithful. If the geometric fibers\nof \u03c0 are connected (say, \u03c0 is an open embedding), then \u03c0 \u2217 is fully faithful.\n(ii) If, in addition, \u03c0 is surjective, then a de Rham line E on K comes from S if\n(and only if ) this is true over a neighborhood U of the generic point(s) of S.\n\u0003\n(c) As was mentioned, Div(X) is the group completion of Diveff (X) = \u2294Symn (X).\nSo we have the projection Diveff (X) \u00d7 Diveff (X) \u2192 Div(X), (D1 , D2 ) 7\u2192 D1 \u2212 D2 ,\nwhich identifies Div(X) with the quotient of Diveff (X) \u00d7 Diveff (X) with respect\nto the diagonal action. Therefore a line E on Div(X) is the same as a collection of lines E n1 ,n2 on Symn1 ,n2 (X) := Symn1 (X) \u00d7 Symn2 (X) together with\nDiveff (X)-equivariance structure, which is the datum of identifications of their\npull-backs by Symn1 ,n2 (X) \u2190 Symn1 ,n2 (X) \u00d7 Symn3 (X) \u2192 Symn1 +n3 ,n2 +n3 (X),\n(D1 , D2 ) \u2190 (D1 , D2 ; D3 ) \u2192 (D1 + D3 , D2 + D3 ) that satisfy a transitivity property.\nLet us prove the proposition. We need to show that any E \u2208 L0\u03a6\ndR (X; K),\nviewed as a mere de Rham line on D\u22c4 , is the pull-back by D\u22c4 \u2192 Div(X) of a\nuniquely defined line in L0dR (Div(X)), which we denote by E or EDiv , and that the\nfactorization structure on E comes from a uniquely defined multiplication structure\non EDiv .\nWe use the fact that for any D \u2208 Div(X)(S), S is smooth, the projection\n\u00d7\nK(D)\u00d7\nD := K(D)D,0 \u2192 S satisfies the conditions of (i), (ii) of the lemma.\n\n\f12\n\nAlexander Beilinson\n\nTo define EDiv on S = Symn1 ,n2 (X), we apply (ii) of the lemma to E on K =\nn1\n\u00d7 X n2 .\nK(D1 \u2212 D2 )\u00d7\nD1 +D2 . Let U be the complement to the diagonal divisor in X\n(\u22121) \u22a0n2\n(1) \u22a0n1\n, and we are done by (a). The Diveff (X)\u22a0(E\n)\nOver U our E equals (E )\nn1 ,n2\nis automatic by (i) of the lemma\nequivariance structure on the datum of EDiv\n(applied to K(D1 \u2212 D2 )D1 +D2 +2D3 ).\nThe factorization structure on E yields one on EDiv . Let us show that it extends uniquely to a multiplication structure. It suffices to define the multiplication\n\u2297ED\u03b1 \u2192 E\u03a3D\u03b1 over each \u03a0Symn1\u03b1 ,n2\u03b1 (X) in a way compatible with the Diveff (X)equivariance structure. Our multiplication equals factorization over the open dense\nsubset where all Di\u03b1 are disjoint, so we have it everywhere by (i) of the lemma.\nThe compatibility with Diveff (X)-equivariance holds over the similar open subset\nof \u03a0(Symn1\u03b1 ,n2\u03b1 (X) \u00d7 Symn3\u03b1 (X)), hence everywhere, and we are done.\n\u0003\n0\n(1)\nCorollary. The functor L0\u03a6\n, is an equivalence.\ndR (X; K) \u2192 LdR (X), E 7\u2192 E\n\nProof. Its composition with the equivalence of the proposition is a functor\nHom(Diveff (X), L0dR ) \u2192 L0dR (X) which assigns to F its restriction to the component X = Sym1 (X) of Diveff (X). This functor is clearly invertible: its inverse\nassigns to P \u2208 L0dR (X) the de Rham line Sym(P) on Diveff (X) = \u2294Symn (X),\nSym(P)Symn (X) := Symn (P) equipped with an evident multiplication structure. \u0003\n1.8. An example of a de Rham factorization line E with deg(E (1) ) = 1:\nSuppose X = A1 , T = \u2205, K = OX . We construct E in the setting of Remark\nin 1.3. For a smooth S and D \u2208 Div(S) the line OX (D) is naturally trivialized by\n\u00d7\n-torsor K(D)\u00d7\na section \u03bdD , \u03bd\u03a3ni xi = \u03a0(t \u2212 xi )\u2212ni . Then \u03bdD trivializes the OD,0\nD,0 ,\n\u00d7\nso the canonical character f 7\u2192 f (D) of OD,0 yields an invertible function \u03c6D \u2208\nO\u00d7 (K(D)\u00d7\nD,0 ), \u03c6D (\u03bd) := (\u03bd/\u03bdD )(D). Our E(D,0) comes from the Kummer torsor\n\u22121/2\n\nfor \u03c6D\n\nplaced in degree deg(D), i.e., it equals OK(D)\u00d7 [deg(D)] as an O-line,\nD,0\n\nthe connection is given by the 1-form 12 d log \u03c6D .\nNotice that if D\u2032 \u2208 Div(S) is another divisor such that |D| \u2229 |D\u2032 | = \u2205, then the\ninvertible function \u03bdD on XS \\ |D| yields (D, D\u2032 ) := \u03bdD (D\u2032 ) \u2208 O\u00d7 (S). One has\n\u2032\n\n(D, D\u2032 ) = (\u22121)deg(D)deg(D ) (D\u2032 , D).\n\n(1.8.1)\n\nLet us define the factorization structure on E. Suppose D = \u2294D\u03b1 , so K(D)\u00d7\nD,0 =\n\u03a0K(D\u03b1 )\u00d7\n.\nAny\nlinear\norder\non\nthe\nset\nof\nindices\n\u03b1\nyields\nan\nevident\nidentificaD\u03b1 ,0\n\u223c\ntion of the \"constant\" O-lines \u2297E(D\u03b1 ,0) \u2192 E(D,0) . The factorization isomorphism\n(1.5.1) is its product with \u03a0 (D\u03b1 , D\u03b1\u2032 ). The choice of order is irrelevant due to\n\u03b1<\u03b1\u2032\n\nthe \"super\" commutativity constraint and (1.8.1). Both transitivity property and\nhorizontality follow since \u03a0\u03c6D\u03b1 = \u03c6D \u03a0 (D\u03b1 , D\u03b1\u2032 ).\n\u2032\n\u03b16=\u03b1\n\n1.9. Proof of the theorem in 1.6 in case T = \u2205. Let us check that for E \u2208\nL\u03a6\n(X;\nK) one has E (1) \u2208 LdR (X)(1) . The claim is X-local, so we can assume that\ndR\nK is trivialized and there is a function t on X with dt invertible, i.e., t : X \u2192 A1 is\n\u00e9tale. Let E \u2032 \u2208 L\u03a6\ndR (X; K) be the pull-back of the factorization line from 1.8. Then\n\u2032\n0\u03a6\nL\u03a6\n(X;\nK)\nis\ngenerated\nby L0\u03a6\ndR\ndR (X; K) and E . Our claim holds for E \u2208 LdR (X; K)\nby 1.7 and it is evident for E \u2032 ; we are done.\n\n\fE-Factors for the Period Determinants of Curves\n\n13\n\n(1)\nLet us show that L\u03a6\n, E 7\u2192 E (1) , is an equivalence. Notice\ndR (X; K) \u2192 LdR (X)\n0\nthat the preimage of LdR (X) \u2282 LdR (X) equals L0\u03a6\ndR (X; K), and, by the corollary\n\u223c\n0\nin 1.7, L0\u03a6\n(X;\nK)\n\u2192\nL\n(X).\nSince\nX-locally\nthere\nis E with deg(E (1) ) = 1 by 1.8\ndR\ndR\n\u223c\n0\n\u0003\nand deg : \u03c00 (LdR (X))/\u03c00 (LdR (X)) \u2192 Z, we are done.\n\n1.10. Suppose now T 6= \u2205. Pick b \u2208 Tred , and consider the OT\u00d7b -torsor KT\u00d7b (see\nExample (ii) in 1.1; we follow the notation of loc.cit.).\nLet (\u03c9)b := \u03c9X (\u221eb)/\u03c9X be the kb -vector space of polar parts of rational 1forms at b, (\u03c9)\u2264n\nbe the subspace of polar parts of order \u2264 n. The Lie algebra of\nb\n\u00d7\nOTb equals O(Tb ). The space \u03a91 (KT\u00d7b )inv of translation invariant 1-forms on KT\u00d7b is\nb\nits dual. The residue pairing (\u03c9)\u2264m\n\u00d7 O(Tb ) \u2192 kb , (\u03c8, f ) 7\u2192 Resb (f \u03c8), identifies\nb\n\u2264mb\nit with (\u03c9)b . So one has\n\u223c\n\nb\n\u03a91 (KT\u00d7b )inv \u2192 (\u03c9)\u2264m\n.\nb\n\n(1.10.1)\n\nLet U be a smooth affine curve over kb , u \u2208 U a closed point; as above, we\nset (\u03c9)u := \u03c9U (\u221eu)/\u03c9U . Let \u03be : U o := U \\ {u} \u2192 KT\u00d7b be a kb -morphism, which\namounts to a trivialization \u03bd \u03be of K on Tb U o \u2282 XU o . Denote by (\u03be) the composition\n\u223c\n\n\u03be\u2217\n\nb\n(\u03c9)\u2264m\n\u2192 \u03a91 (KT\u00d7b )inv \u2212\u2192 \u03c9(U \u25e6 ) \u2192 \u03c9(U \u25e6 )/\u03c9(U ) = (\u03c9)u .\nb\n\nLemma. (i) After a possible localization of U at u, one can find D \u2208 Div(X)(U )\nand a trivialization \u03bd of K(D) on a neighborhood V \u2282 XU of |D| \u222a TbU such that\n|D| \u2229 Xu is supported at b, |D| \u2229 Tb U o = \u2205, and \u03bd|Tb U o = \u03bd \u03be .\n(ii) Suppose U is a neighborhood of b, i.e., we have an \u00e9tale \u03c0 : U \u2192 X, \u03c0(u) = b.\nThen one can find (D, \u03bd) as in (i) with D equal to (the graph of ) \u03c0 if and only if\n\u03c0\u2217\n\nb\n\u2212(\u03be) equals \u03c0 \u2217 , i.e., the composition (\u03c9)\u2264m\n\u2282 (\u03c9)b \u0592\u2192 (\u03c9)u .\nb\n\nProof. (i) Let us extend \u03bd \u03be to a rational section \u03bd of K on an open subset V of\nXU , V \u2283 Tb U , which is defined at Tb U o . Shrinking U and V , one can find \u03bd with\nD := div(\u03bd) prime to Xu (if n is the multiplicity of Xu in D, then we replace \u03bd by\nf \u2212n \u03bd, where f is any rational function which equals 1 on Tb U o and whose divisor\ncontains Xu with multiplicity 1).10 After further localization of U and shrinking of\nV , we get D in Div(X)(U ) and |D| \u2229 Xu is supported at b; we are done.\n(ii) A map \u03c6 : U \u25e6 \u2192 KT\u00d7b extends to U if and only if for every \u03b2 \u2208 \u03a91 (KT\u00d7b )inv\nthe form \u03c6\u2217 (\u03b2) \u2208 \u03c9(U \u25e6 ) is regular at b. Thus either of the properties of \u03be in\nthe assertion of (ii) determines \u03bd \u03be uniquely up to multiplication by an invertible\nfunction on TbU . It remains to present a trivialization \u03bd of K(\u03c0) such that the\ncorresponding \u03be satisfies \u2212(\u03be) = \u03c0 \u2217 .\nShrinking X, we trivialize K and pick a function t with dt invertible; set x :=\n\u03c0 \u2217 (t) \u2208 O(U ). Our \u03bd is (t \u2212 x)\u22121 . The differential of the corresponding \u03be is\nthe Lie(OT\u00d7b ) = O(Tb )-valued 1-form \u03bd \u22121 dx \u03bd = \u2212(1 + t/x + (t/x)2 + . . .)dx/x.\nSo if \u03b2 \u2208 \u03a91 (KT\u00d7b )inv is identified with \u03c8(t) \u2208 (\u03c9)b by (1.10.1), then \u03be \u2217 (\u03b2) =\n\u2212(Resb (1 + t/x + (t/x)2 + . . .)\u03c8(t))dx/x = \u2212\u03c8(x), q.e.d.\n\u0003\n10 To find such f (after possible shrinking of U ), pick local coordinate t on X at b, and x on\nU at u (so t(b) = 0 = x(u), dt(b) 6= 0 6= dx(u)); set f = x(x \u2212 tmb )\u22121 .\n\n\f14\n\nAlexander Beilinson\n\n1.11. A de Rham line F on KT\u00d7b is said to be translation invariant if the\nde Rham line *\u2217 F \u2297 pr2\u2217 F \u2297\u22121 lies in pr1\u2217 LdR (OT\u00d7b ) \u2282 LdR (OT\u00d7b \u00d7 KT\u00d7b ); here * :\nOT\u00d7b \u00d7 KT\u00d7b \u2192 KT\u00d7b is the action map, pri are the projections to the factors. Such\n\u00d7\n\u00d7\nF 's form a Picard subgroupoid Linv\ndR (KTb ) of LdR (KTb ).\nLemma. (i) We trivialize KT\u00d7b , i.e., identify it with OT\u00d7b . The translation invariance of F is equivalent to the next properties:\n(a) The de Rham line pr1\u2217 F \u2297 pr2\u2217 F \u2297 *\u2217 F \u2297\u22121 is constant;\n(b) For any smooth curve U , a point u \u2208 U , and two maps \u03be1 , \u03be2 : U o := U \\ {u} \u2192\nKT\u00d7 , the de Rham line \u03be1\u2217 F \u2297 \u03be2\u2217 F \u2297 (\u03be1 \u03be2 )\u2217 F \u2297\u22121 on U o extends to U .\n(c) For some (or every) invertible section eF of F on KT\u00d7b one has \u2207(eF )/eF \u2208\n\u223c\n\u2264mb\n\u00d7\n\u03a91 (KT\u00d7b )inv . (ii) There is a natural isomorphism \u03c00 (Linv\n/Z)\ndR (KTb )) \u2192 Z \u00d7 ((\u03c9)b\nb\nwhere Z \u2282 (\u03c9)\u2264m\nare\npolar\nparts\nof\n1-forms\nwith\nsimple\npole\nand\nintegral\nresidue.\nb\nProof. (i) (a) is evidently equivalent to invariance of F . Since KT\u00d7b is a rational\nvariety, (a) amounts to the fact that *\u2217 F \u2297 pr1\u2217 F \u2297\u22121 \u2297 pr2\u2217 F \u2297\u22121 extends to a\ncompactification of KT\u00d7b . This can be tested on curves, which is (b). Finally (c)\nis equivalent to the translation invariance since every invertible function on OT\u00d7b is\nthe product of a character by a constant, and every line bundle on KT\u00d7b is trivial.\n(ii) One assigns to F the pair (n, \u03c8) where n = deg(F ) and \u03c8 is the class of\nthe image of \u2207(eF )/eF by (1.10.1).\n\u0003\n\u00d7\nWe say that G \u2208 LdR (X \\ T )(1) is compatible with F \u2208 Linv\n(K\n)\nif\nfor\nsome\ndR\nTb\nneighborhood U of b, a trivialization \u03bd of K(1) on U , and a map \u03be : U o := U \\ {b} \u2192\nKT\u00d7b as in (ii) of the lemma in 1.10, the de Rham line \u03bd \u2217 G \u2297 \u03be \u2217 F on U o extends to\nU (the validity of this does not depend on the choice of U , \u03bd, and \u03be). By loc.cit.,\ncompatibility is equivalent to the next condition: Pick U , \u03bd, and eF as above; let\neG be a non-zero rational section of \u03bd \u2217 G. Then the image of \u2207(eF )/eF by (1.10.1)\nb\nin (\u03c9)\u2264m\n/Z \u2282 (\u03c9)b /Z equals the class of \u2207(eG )/eG .\nb\n\u00d7\nLet L\u266edR (X, T ; K) be the Picard subgroupoid of LdR (X \\T )(1) \u00d7 \u03a0 Linv\ndR (KTb )\nb\u2208Tred\n\nformed by those collections (G, {FTb }) that G is compatible with every FTb . Then G\nlies automatically in LdR (X, T )(1) . By (ii) of the lemma, the functor L\u266edR (X, T ; K) \u2192\nLdR (X, T )(1) \u00d7 \u03a0Lkb , (G, {FTb }) 7\u2192 (G, {F\u03bdTb }), where F\u03bdTb is the fiber of FTb at\n\u03bdTb from 1.6, is an equivalence of categories. Thus the theorem in 1.6 follows from\nthe next one:\n(1)\nTheorem. For every E \u2208 L\u03a6\n, {ETb }) \u2208 L\u266edR (X, T ; K), and\ndR (X, T ; K) one has (E\nthe functor\n\u266e\nL\u03a6\ndR (X, T ; K) \u2192 LdR (X, T ; K),\n\nE 7\u2192 (E (1) , {ETb }),\n\n(1.11.1)\n\nis an equivalence of the Picard groupoids.\nProof. The assertion is X-local, and we have proved it for T = \u2205. So we can\nassume that Tred is a single k-point b. Thus Tb = T and D is the disjoint sum of\nDc=0 equal to Div(X \\ T ) and Dc=1 equal to Div(X). If needed, we can assume\nthat K is trivialized and there is an \u00e9tale map t : X \u2192 A1 .\n(a) Let us show that (E (1) , ET ) \u2208 L\u266edR (X, T ; K). Notice that L\u03a6\ndR (X, T ; K) is\ngenerated by L0\u03a6\n(X,\nT\n;\nK),\nthe\nimage\nof\n(1.5.3),\nand\nthe\npull-back\nby t of the\ndR\n\n\fE-Factors for the Period Determinants of Curves\n\n15\n\nfactorization line on A1 from 1.8. Since the assertion is evident for factorization\nlines of the latter two types, it suffices to consider the case of E \u2208 L0\u03a6\ndR (X, T ; K).\nWe know that E (1) comes from a de Rham line on X \\ T (see 1.7). Let us\ncheck that ET is translation invariant using the criterion of (i)(b) in the lemma.\nFor U , u, \u03bei as in loc.cit., let us choose Di , \u03bdi as in (i) of the lemma in 1.10; then\nD3 := D1 + D2 , \u03bd3 := \u03bd1 \u03bd2 serves \u03be3 := \u03be1 \u03be2 . The lines E(Di ,1,\u03bdi ) on U are equal to\nEDi \u2297 \u03bei\u2217 ET on U o by factorization; here EDi := E(Di ,0) . Since ED3 = ED1 \u2297 ED2 by\n1.7, the de Rham line \u03be1\u2217 ET \u2297 \u03be2\u2217 ET \u2297 (\u03be1 \u03be2 )\u2217 ET\u2297\u22121 on U o extends to U , q.e.d.\nIt remains to check that E (1) is compatible with ET . Let \u03bd is a trivialization of\nK(\u2206) on an open V \u2282 X \u00d7 X that contains (b, b), U := V \u2229({b} \u00d7 X), \u03be : U o \u2192 KT\u00d7\nthe map defined by the restriction of \u03bd to T \u00d7 U o . The de Rham line E(\u2206,1,\u03bd) on U\nequals E (1) \u2297 \u03be \u2217 ET on U o by factorization. Since the compatibility means that the\nlatter line extends to U , we are done.\n(b) Consider the projection \u03c0 : D\u22c4c=1 \u2192 KT\u00d7 \u00d7Div(X), (D, 1, \u03bdP ) 7\u2192 (\u03bdP |TS , D).\n\u22c4\nLet us show for any E \u2208 L0\u03a6\ndR (X, T ; K) its restriction E1 to Dc=1 comes from a\n\u00d7\nuniquely defined de Rham line on KT \u00d7 Div(X) which we denote by E1 or EDiv1 .\nWe use the fact that for every D \u2208 Div(X)(S), S is smooth, the projection\n\u00d7\nK(D)\u00d7\nD,1 \u2192 KT \u00d7 S satisfies the conditions of (i), (ii) of the lemma in 1.7.\nAs in part (c) of the proof in 1.7, we need to define EDiv1 on every KT\u00d7 \u00d7\nSymn1 ,n2 (X) and provide the Diveff (X)-equivariance structure. Consider our E on\nn1 ,n2\n\u00d7\nK(D1 \u2212 D2 )\u00d7\n(X \\ T ) it equals ET \u22a0 E(D1 \u2212D2 ,0) by\nD1 +D2 ,1 . Over KT \u00d7 Sym\n\u00d7\nfactorization, hence it descends to KT \u00d7 Symn1 ,n2 (X \\ T ) by 1.7. By (ii) of the\nlemma in 1.7, we have EDiv1 over the whole KT\u00d7 \u00d7 Symn1 ,n2 (X). The Diveff (X)equivariance is automatic by (i) of the lemma (applied to K(D1 \u2212 D2 )\u00d7\nD1 +D2 +2D3 ).\n0\u03a6\n(c) Our functor sends LdR (X, T ; K) to the Picard subgroupoid L0\u266e\ndR (X, T ; K)\n\u266e\nof LdR (X, T ; K) formed by all (G, {Fb }) with deg(G) = deg(Fb ) = 0. Let us prove\n0\u266e\nthat L0\u03a6\ndR (X, T ; K) \u2192 LdR (X, T ; K) is an equivalence.\nWe need to show that every (E (1) , ET ) \u2208 L0\u266e\ndR (X, T ; K) comes from a uniquely\n0\u03a6\ndefined E \u2208 LdR (X, T ; K). By the corollary in 1.7, E (1) defines E0 := E|Dc=0 , which\nwe can view, by 1.7, as a de Rham line with multiplication structure on Div(X \\ T ).\nAs in (b), E1 := E|D\u22c4c=1 comes from KT\u00d7 \u00d7 Div(X). By factorizaion, its restriction\nto KT\u00d7 \u00d7 Div(X \\ T ) equals ET \u22a0 E0 . It remains to show that ET \u22a0 E0 extends in a\nunique way to a de Rham line E1 on KT\u00d7 \u00d7 Div(X).\nAs in (c) of the proof in 1.7, we should define E1 on every KT\u00d7 \u00d7 Symn1 ,n2 (X)\nand provide the Div(X)eff (X)-equivariance structure. Our E1 is defined on an open\ndense subset U of triples (\u03be, D1 , D2 ), Di \u2208 Symni (X \\ T ). Let U \u2032 \u2283 U be the open\nsubset of those (\u03be, D1 , D2 ) that D1 + D2 contains b with multiplicity at most 1.\nThen E extends to U \u2032 due to compatibility of E (1) and ET . Since the complement\nto U \u2032 has codimension \u2265 2, E extends to KT\u00d7 \u00d7 Symn1 ,n2 (X), and we are done.\nAs in loc.cit., the Div(X)eff (X)-equivariance is identification of the pull-backs\nof our line by KT\u00d7 \u00d7 Symn1 ,n2 (X) \u2190 KT\u00d7 \u00d7 Symn1 ,n2 (X) \u00d7 Symn3 (X) \u2192 KT\u00d7 \u00d7\nSymn1 +n3 ,n2 +n3 (X). The two de Rham lines coincide on the dense open subset\nKT\u00d7 \u00d7Symn1 ,n2 (X \\T )\u00d7Symn3 (X \\T ), so they are canonically identified everywhere,\nand we are done. The factorization structure on E is evident.\n\n\f16\n\nAlexander Beilinson\n\n(d) By (c), the theorem is reduced to the claim that our functor yields an\nisomorphism between the quotients\n\u223c\n\n\u266e\n0\u266e\n0\u03a6\n\u03c00 (L\u03a6\ndR (X, T ; K))/\u03c00 (LdR (X, T ; K)) \u2192 \u03c00 (LdR (X, T ; K))/\u03c00 (LdR (X, T ; K)).\n\nThe degree map identifies the right group with Z\u00d7Z. Our map is evidently injective;\nlooking at the image of (1.5.3) and the pull-back by t of the factorization line on\nA1 from 1.8, we see that it is surjective, q.e.d.\n\u0003\n1.12. A complement. A connection on a trivialized line bundle amounts to a\n1-form; multiplying the trivialization by f , we add to the form d log f . Here is a\nsimilar fact in the factorization story.\n\u22c4\nConsider the group \u03c01 (L\u03a6\nO (X, T ; K)) of invertible functions on D that satisfy\n\u00d7\nfactorization property. One has evident embeddings O (Tred ) \u0592\u2192 \u03c01 (L\u03a6\ndR (X, T ; K))\n\u03a6\nO-triv\n\u0592\u2192 \u03c01 (L\u03a6\n(X,\nT\n;\nK))\n(see\nRemarks\n(iii),\n(iv)\nin\n1.5).\nLet\nL\n(X,\nT\n;\nK)\nbe the\nO\ndR\n\u03a6\n\u03a6\nkernel of the Picard functor LdR (X, T ; K) \u2192 LO (X, T ; K). This is a mere abelian\ngroup (since the functor is faithful); its elements are pairs (E, e) where E is a\nfactorization de Rham line, e is a trivialization of E as a factorization O-line. Let\n\u03c9(X, T ) be the space of 1-forms on X \\ T whose order of pole at any b \u2208 T is less\nor equal to the multiplicity of T at b.\nProposition. There is a natural commutative diagram\n\u223c\n\n\u00d7\n\u00d7\n\u03c01 (L\u03a6\nO (X, T ; K))/O (Tred ) \u2192 O (X \\ T )\n\u2193\n\u2193\n\u223c\nO-triv\n\u2192\n\u03c9(X,\nT ).\n(X,\nT\n;\nK)\nL\u03a6\ndR\n\n(1.12.1)\n\nProof. (a) The connection on E (l) along the fibers of K(l) /X \\ T is determined\n(l)\nsolely by the O-line structure. So the action of any h \u2208 \u03c01 (L\u03a6\nis\nO (X, T )) on E\n(l)\n\u00d7\nfiberwise horizontal, i.e., it is multiplication by a function h \u2208 O (X \\ T ). The\ntop horizontal arrow is h 7\u2192 h(1) .\nO-triv\nthe trivializations e(l) of\nFor the same reason, for (E, e) \u2208 L\u03a6\ndR (X, T ; K)\n(l)\n(l)\n(l)\nE are fiberwise horizontal, i.e., \u2207(e )/e \u2208 \u03c9(X \\ T ). By the theorem in 1.6,\n\u2207(e(1) )/e(1) \u2208 \u03c9(X, T ). The bottom horizontal arrow is (E, e) 7\u2192 \u2207(e(1) )/e(1) .\n\u03a6\nO-triv\nThe map \u03c01 (L\u03a6\n, f 7\u2192 (OD\u22c4 , f 1), with kernel\nO (X, T ; K)) \u2192 LdR (X, T ; K)\n\u03a6\n\u03c01 (LdR (X, T ; K)) yields the left vertical arrow. The right one is the d log map.\nThe diagram is evidently commutative. It remains to check that its horizontal\narrows are isomorphisms.\n\u22c4\n(b) For every h \u2208 \u03c01 (L\u03a6\nO (X, T )) its restriction to Dc=0 comes from a multiplicative function h0 on Div(X \\ T ). Similarly, if Tred is a single k-point b, then\nthe restriction of h to D\u22c4c=1 comes from a function h1 on KT\u00d7 \u00d7 Div(X) such that\nfor \u03be \u2208 KT\u00d7 , D \u2208 Div(X \\ T ) one has h1 (\u03be, D) = h1 (\u03be)h0 (D). This follows by a\nsimple modification of the argument from, respectively, part (c) of the proof in 1.7\nand part (b) of the proof in 1.11. The details are left to the reader.\n\u00d7\n\u00d7\nLet us show that the map \u03c01 (L\u03a6\nO (X, T ))/O (Tred ) \u2192 O (X \\ T ) is injective.\n(1)\nSuppose we have h such that h = 1. Since the group space Div(X \\T ) is generated\nby effective divisors of degree 1, one has h0 = 1. It remains to check that h is locally\nconstant on other components of D\u22c4 . The assertion is X-local, so we can assume\nthat Tred is a single k-point b, and we look at D\u22c4c=1 . By above, it suffices to check\nthat the restriction hT of h1 to KT\u00d7 is constant. We use (i) of the lemma 1.10;\nwe follow the notation of loc.cit. For \u03be : U o \u2192 KT\u00d7 , consider h(D,1,\u03bd) \u2208 O\u00d7 (U );\n\n\fE-Factors for the Period Determinants of Curves\n\n17\n\nby factorization, its restriction to U o equals \u03be \u2217 hT h(D,0,\u03bd) = \u03be \u2217 hT . Since \u03be \u2217 hT is\nregular at u for every \u03be, hT is constant, q.e.d.\nA similar argument shows that the bottom horizontal arrow in (1.12.1) is injective. The details are left to the reader.\n \u0303\n(c) Let us construct a section O\u00d7 (X \\ T ) \u2192 \u03c01 (L\u03a6\nO (X, T )), f 7\u2192 f , of the map\n(1)\nh 7\u2192 h . Fix a trivialization \u03bd0 of K on an open subset V0 of X that contains T .\nFor (D, c, \u03bdP ) \u2208 D\u22c4 (S) let us define f \u0303(D,c,\u03bdP ) \u2208 O\u00d7 (S). Pick \u03bd, V corresponding to\n(D, c, \u03bdP ) as in Remark (ii) in 1.1; we can assume that V \u2229 TS = TSc . Localizing S,\nwe can decompose D in a disjoint sum of D\u2032 and D\u2032\u2032 such that D\u2032 \u2282 V \\ TS and\nD\u2032\u2032 \u2282 V0S . Set\nf \u0303(D,c,\u03bd ) := f (D\u2032 ){f, \u03bd0 /\u03bd}|D\u2032\u2032 |\u222aT c .\n(1.12.2)\nP\n\nS\n\nHere {f, \u03bd0 /\u03bd}\n\u2208 O (S) is the Contou-Carr\u00e8re symbol at |D\u2032\u2032 | \u222a TSc (see\n[CC] or [BBE] 3.3). One readily checks that (1.12.2) does not depend on the\nauxiliary choices of \u03bd and the decomposition D = D\u2032 + D\u2032\u2032 ; its compatibility with\n \u0303(1) = f .\nthe factorization is evident. So f \u0303 \u2208 \u03c01 (L\u03a6\nO (X, T )); clearly f\n\u2032\nRemark. If \u03bd0 is another trivialization of K near T , f 7\u2192 f \u0303\u2032 the corresponding\nsection, then f \u0303/f \u0303\u2032 is an element of O\u00d7 (Tred ) \u2282 \u03c01 (L\u03a6\nO (X, T )) whose value at b \u2208\nTred equals (\u03bd0\u2032 /\u03bd0 )(b)nb , where div(f ) = \u03a3nb b.\n(d) To finish the proof, let us construct explicitly a section of the bottom\nhorizontal arrow in (1.12.1). For \u03c6 \u2208 \u03c9(X, T ), we construct the corresponding\nO-triv\nusing Remark (i) in 1.5. Since E \u03c6 is trivialized\nE \u03c6 = (E \u03c6 , e) \u2208 L\u03a6\ndR (X, T ; K)\nas an O-line, \u03b1\u03b5 of (1.5.2) is multiplication by a function \u03b1\u03c6 = \u03b1\u03c6(D\u2032 ,c,\u03bd \u2032 )/(D,c,\u03bdP ) \u2208\nP\nO\u00d7 (S). To determine it, we extend \u03bdP , \u03bdP\u2032 to \u03bd, \u03bd \u2032 as in Remark (ii) in 1.1 such that\n\u03bd equals \u03bd \u2032 on Vred . Then \u03bd/\u03bd \u2032 \u2208 O\u00d7 (V \\ P ) equals 1 on Vred , so we have a function\nlog(\u03bd/\u03bd \u2032 ) \u2208 O(V \\P ) that vanishes on Vred . The residue ResP/S (log(\u03bd/\u03bd \u2032 )\u03c6) \u2208 O(S)\nvanishes on Sred , and we set\n|D\u2032\u2032 |\u222aTSc\n\n\u00d7\n\n\u03b1\u03c6 := exp(ResP/S (log(\u03bd/\u03bd \u2032 )\u03c6)).\n\n(1.12.3)\n\nOur \u03b1\u03c6 does not depend on the auxiliary choice of \u03bd and \u03bd \u2032 : Indeed, \u03bd, \u03bd \u2032 can be\nchanged to f \u03bd, f \u2032 \u03bd \u2032 with f, f \u2032 \u2208 O\u00d7 (V ) that coincide on Vred and equal 1 on TSc\n(see Remark (ii) in 1.1); then log(f /f \u2032 ) is a regular function on V that vanishes\non TSc , so ResP/S (log(f /f \u2032 )\u03c6) = 0, and we are done. The transitivity of \u03b1\u03c6 and\ncompatibility with base change and factorization are evident; we have defined E \u03c6 .\nRemark. Suppose we have (D, c, \u03bdP ) \u2208 D\u22c4 (S) where S is smooth. The de\n\u03c6\nRham structure on E(D,c,\u03bd\namounts to a flat connection \u2207\u03c6 on our line bundle,\nP)\nwhich is the same as a closed 1-form \u03b8\u03c6 = \u2207\u03c6 (e)/e on S. Choose \u03bd as in Remark\n(ii) in 1.1; then (1.12.3) implies that\n\u03b8\u03c6 = ResP/S ((dS (\u03bd)/\u03bd) \u2297 \u03c6).\n\n(1.12.4)\n\nHere dS means derivation along the fibers of the projection V \u2282 XS \u2192 X, so dS (\u03bd)\nis a section of \u03a91S \u22a0 K over V \\ P , and dS (\u03bd)/\u03bd is a section of the pull-back of \u03a91S\nto V \\ P . Of course, due to the lemma in 1.3, one can use (1.12.4) as an alternative\ndefinition of E \u03c6 .\nExample. Consider the O-trivialized de Rham line (ET\u03c6b , e) on the OT\u00d7b -torsor\nKT\u00d7b (see 1.6). Its 1-form \u03b8\u03c6 = \u2207(e)/e is translation invariant and corresponds to\nthe functional f 7\u2192 Resb (f \u03c6) on the Lie algebra O(Tb ) of OT\u00d7b (cf. 1.11).\n\n\f18\n\nAlexander Beilinson\n\nIt remains to check that the bottom horizontal arrow in (1.12.1) sends (E \u03c6 , e) to\n\u03c6, i.e., that \u2207(e(1) )/e(1) = \u03c6. Pick a local trivialization of K and a local function\nt on X \\ T with non-vanishing dt; let x be the corresponding local function on\nS = X \\ T . Then \u03bd = (t \u2212 x)\u22121 is a trivialization of KS (\u2206) near the diagonal, so we\n\u03c6\nhave the de Rham line E(\u2206,0,\u03bd)\non S. Then dS (\u03bd)/\u03bd = (t \u2212 x)\u22121 dx, so, by (1.12.4),\none has \u2207(e(1) )/e(1) = \u03b8\u03c6 = (Rest=x ((t \u2212 x)\u22121 \u03c6))dx = \u03c6, q.e.d.\n\n\u0003\n\n\u2032\n\u03a6\nCorollary. For E, E \u2032 \u2208 L\u03a6\ndR (X, T ; K), a morphism E \u2192 E in LO (X, T ; K) is\n\u03a6\nhorizontal, i.e., is a morphism in LdR (X, T ; K), if (and only if ) the corresponding\nmorphism E (1) \u2192 E \u2032(1) of O-lines on K(1) is horizontal.\n\u0003\n\nRemark. If K = \u03c9X , then in the corollary one can replace \u03c6(1) by the morphism\n\u2032(1)\n(1)\n: EX\\T \u2192 EX\\T of O-lines on X \\ T (see 1.6).\n\n(1)\n\u03c6X\\T\n\n1.13. The next lemma will be used in 2.12. Assume that X \\ T is affine and\nK = \u03c9X . The Lie algebra \u0398(X \\ T ) of vector fields on X \\ T acts naturally on\n\u22c4\nD\u22c4 (X, T\u0302 ; \u03c9) := lim\n\u2190\u2212 D (X, nT ; \u03c9). Therefore we have the notion of \u0398(X \\ T )-action\non any O-line E on D\u22c4 (X, T\u0302 ; \u03c9). If E carries a factorization structure, then one can\nask our action to be compatible with it. Ditto for a de Rham structure.\nSuppose that E is a de Rham line. The flat connection yields then a \u0398(X \\ T )action on E, which we refer to as the standard action. It is evidently compatible\nwith the de Rham structure.\nLemma. Any \u0398(X \\T )-action \u03c4 on E compatible with the de Rham structure equals\nthe standard one.\nProof. Let \u03c40 be the standard action. Then \u03b8 7\u2192 \u03c4 (\u03b8) \u2212 \u03c40 (\u03b8) is a Lie algebra\nhomomorphism from \u0398(X \\ T ) to the Lie algebra of de Rham line endomorphisms\nof E. The latter Lie algebra is commutative; the former one is perfect. Thus our\nhomomorphism is 0, i.e., \u03c4 = \u03c40 .\n\u0003\n1.14. The whole story makes sense in the relative setting. The input is a\nsmooth (not necessary proper) Q-family of curves q : X \u2192 Q (where Q is a scheme),\na relative divisor T \u2282 X such that Tred is finite and \u00e9tale over Qred , and a line\nbundle K on X. It yields a space D\u22c4 = D\u22c4 (X/Q, T ; K) over Q. If L? is any sheaf\nof Picard groupoids on the category Sch/Q of Q-schemes (equipped with the \u00e9tale\ntopology), then we have the Picard groupoid L? (D) and L? (D\u22c4 ) defined as in 1.2,\nand the Picard groupoid of factorizarion objects L\u03a6\n? (X/Q, T ; K) as in 1.5. The L? 's\nwe need are LO , LdR/Q , and LdR , where LO , LdR are as in 1.2, and LdR/Q (S) is\nformed by O-lines equipped with an action of the universal relative formal groupoid\non S/Q (if S/Q is smooth, then this is the same as a flat relative connection, cf. 1.1).\nAll the results above immediately generalize to the relative setting. Thus, as in 1.4,\nfor proper q every E in LO (D\u22c4 ) or in LdR/Q (D\u22c4 ) yields an O-line E(X/Q) on Q; if\nE lies in LdR (D\u22c4 ), then E(X/Q) \u2208 LdR (Q). The theorem in 1.6 remains valid both\nin the setting of LdR/Q and LdR , etc.\n\n\fE-Factors for the Period Determinants of Curves\n\n19\n\n1.15. Suppose k = C, and X is any complex smooth curve. All the above\ndefinitions and results render into the analytic setting without problems. In fact,\n\u223c\n\u03a6\n11\nthe story simplifies since L\u03a6\nIt is equivalent to the\ndR (X, Tred ) \u2192 LdR (X, T ).\nBetti version of the story with de Rham lines replaced by local systems of C-lines.\nAnd the Betti version works if we replace this C by any commutative ring R of\ncoefficients.\n\u03a6\nRemark. The fact that L\u03a6\ndR (X, T ; K) = LdR (X, Tred ; K) permits to consider in\ncase K = \u03c9X a canonical equivalence (1.6.3) as in Example in 1.6.\nEvery de Rham factorization line E in the analytic setting carries a canonical\nautomorphism \u03bc which acts on E(D,c,\u03bd) as multiplication by the (counterclockwise)\nmonodromy of the de Rham line E(D,c,z\u03bd) , z \u2208 C\u00d7 , around z = 0. Notice that \u03bc is\n\u03a6\nmultiplicative, i.e., we have a homomorphism \u03bc : \u03c00 (L\u03a6\ndR (X, T )) \u2192 \u03c01 (LdR (X, T )).\nSame is true for the Betti factorization lines.\n2 The de Rham \u03b5-lines: algebraic theory\nThis section recasts the story of [Del] and [BBE] in the factorization line format.\n2.1. We follow the setting and notation of 1.1, so X is a smooth curve over\nk, T \u2282 X is a finite subscheme. From now on we assume that K from 1.1 equals\n\u03c9 = \u03c9X , so D\u22c4 = D\u22c4 (X, T ; \u03c9).\nLet M be a (left) holonomic D-module on (X, T ), i.e., a holonomic module on\nX which is smooth on X \\ T . We say that T is compatible with M if det MX\\T \u2208\nLdR (X, T ) (see 1.6).\nTheorem-construction. M defines naturally a de Rham factorization line EdR (M )\n(1)\n\u2297\u22121\n\u2208 L\u03a6\n. It is functorial with respect to\ndR (X, T\u0302 ) with EdR (M )X\\T = (det MX\\T )\nisomorphisms of M 's, has local origin, and lies in L\u03a6\ndR (X, T ) if T is compatible with\n\u223c\nM . For proper X there is a canonical isomorphism of k-lines \u03b7dR : EdR (M )(X) \u2192\n*\ndet HdR\n(X, M ). The construction is compatible with base change of k, filtrations\non M , and direct images for finite morphisms of X's.\nWe construct EdR (M ) as a factorization O-line in 2.5, and define a de Rham\n\u223c\n(1)\nstructure on it in 2.10. The identification EdR (M )X\\T \u2192 (det MX\\T )\u2297\u22121 is established in (2.6.1); we check that it is horizontal in 2.11. \u03b7dR is defined in 2.7,\nthe compatibilities are discussed in 2.8. The compatibility of T with M becomes\nrelevant only in 2.10. Let us begin with necessary preliminaries.\n2.2. L-groupoids and L-torsors: a dictionary. Let L be a Picard groupoid\nwith the product operation \u2297. Below \"L-groupoid\" means \"enriched category over\nL\". Thus this is a collection of objects J and a rule which assigns to every j, j \u2032 \u2208\nJ an object \u03bb(j/j \u2032 ) \u2208 L, and to every j, j \u2032 , j \u2032\u2032 \u2208 J a composition isomorphism\n\u223c\n\u03bb(j/j \u2032 ) \u2297 \u03bb(j \u2032 /j \u2032\u2032 ) \u2192 \u03bb(j/j \u2032\u2032 ) which satisfies associativity property. Then J is\nautomatically a mere groupoid with Hom(j \u2032 , j) := Hom(1L , \u03bb(j/j \u2032 )).\nLet J1 , J2 be L-groupoids. Their tensor product J1 \u2297 J2 is an L-groupoid\nwhose objects j1 \u2297 j2 correspond to pairs j1 \u2208 J1 , j2 \u2208 J2 , \u03bb(j1 \u2297 j2 /j1\u2032 \u2297 j2\u2032 ) :=\n\u03bb(j1 /j1\u2032 ) \u2297 \u03bb(j2 /j2\u2032 ), and the composition \u03bb(j1 \u2297 j2 /j1\u2032 \u2297 j2\u2032 ) \u2297 \u03bb(j1\u2032 \u2297 j2\u2032 /j1\u2032\u2032 \u2297 j2\u2032\u2032 ) \u2192\n\u03bb(j1 \u2297j2 /j1\u2032\u2032 \u2297j2\u2032\u2032 ) equal to (\u03bb(j1 /j1\u2032 )\u2297\u03bb(j2 /j2\u2032 ))\u2297(\u03bb(j1\u2032 /j1\u2032\u2032 )\u2297\u03bb(j2\u2032 /j2\u2032\u2032 )) \u2192 (\u03bb(j1 /j1\u2032 )\u2297\n\u03bb(j1\u2032 /j1\u2032\u2032 ))\u2297(\u03bb(j2 /j2\u2032 ))\u2297\u03bb(j2\u2032 /j2\u2032\u2032 )) \u2192 \u03bb(j1 /j1\u2032\u2032 )\u2297\u03bb(j2 /j2\u2032\u2032 ) where the first arrow is the\n11 Since\n\nfor any A1 -torsor K/S the pull-back functor LdR (S) \u2192 LdR (K) is an equivalence.\n\n\f20\n\nAlexander Beilinson\n\ncommutativity constraint, the second one is the tensor product of the composition\nmaps for J1 , J2 .\nAn L-morphism \u03c6 : J1 \u2192 J2 is an L-enriched functor, i.e., rule which assigns\nto every j \u2208 J1 an object \u03c6(j) \u2208 J2 , and to every j, j \u2032 \u2208 J1 an identification \u03c6 :\n\u223c\n\u03bb(j/j \u2032 ) \u2192 \u03bb(\u03c6(j)/\u03c6(j \u2032 )) compatible with the composition. Such a \u03c6 yields a morphism of mere groupoids J1 \u2192 J2 . All L-morphisms form naturally an L-groupoid\nHomL (J1 , J2 ). Precisely, there is an L-groupoid structure on HomL (J1 , J2 ) together with an L-morphism HomL (J1 , J2 ) \u2297 J1 \u2192 J2 that lifts the action map\nHomL (J1 , J2 ) \u00d7 J1 \u2192 J2 of mere groupoids, and such pair is unique (up to a unique\n2-isomorphism). The composition HomL (J2 , J3 ) \u00d7 HomL (J1 , J2 ) \u2192 HomL (J1 , J3 )\nlifts naturally to a morphism of L-groupoids HomL (J2 , J3 ) \u2297 HomL (J1 , J2 ) \u2192\nHomL (J1 , J3 ), etc.\nFor an L-groupoid J its inverse J \u2297\u22121 is an L-groupoid whose objects are in\nbijection j \u2194 j \u2297\u22121 with elements of J, and \u03bb(j \u2297\u22121 /j \u2032\u2297\u22121 ) = \u03bb(j \u2032 /j).\nThere are two equivalent ways to define the notion of L-torsor: (a) This is a\nmere groupoid F equipped with a L-action, i.e., a functor \u2297 : L \u00d7 F \u2192 F together\nwith an associativity constraint, such that for some (hence every) object f \u2208 F the\nfunctor L \u2192 F , l 7\u2192 l \u2297 f , is an equivalence of groupoids; (b) This is an L-groupoid\nsuch that the image of \u03bb meets every isomorphism class in L. To pass from (a) to\n(b), we lift the groupoid structure on F to L-groupoid one with \u03bb(f /f \u2032 ) := f \u2297f \u2032\u2297\u22121\n\u223c\n(the latter is an object of L together with an isomorphism (f \u2297 f \u2032\u2297\u22121 ) \u2297 f \u2032 \u2192 f ;\nthe pair is defined uniquely up to a unique isomorphism).\nFor a non-empty L-groupoid J and an L-torsor F both L-groupoids F \u2297 J and\nHomL (J, F ) are L-torsors. In particular, we have the product and ratio of L-torsors\n\u223c\n(with L being a unit). Notice that there is a natural equivalence F1 \u2297 F2\u2297\u22121 \u2192\n\u2297\u22121\n\u2032\n\u2032\nHomL (F2 , F1 ) which assigns to f1 \u2297 f2\nthe L-morphism f2 7\u2192 \u03bb(f2 /f2 ) \u2297 f1 .\nRemarks. (i) For any non-empty L-groupoid J the L-morphism J \u2192 L \u2297 J,\nj 7\u2192 1L \u2297 j, is a universal L-morphism to an L-torsor.\n(ii) Every L-morphism between L-torsors is an equivalence. Thus for non-empty\n\u223c\nJi 's every L-morphism J1 \u2192 J2 yields an equivalence of L-torsors HomL (J2 , L) \u2192\n\u223c\nHomL (J1 , L) and L \u2297 J1 \u2192 L \u2297 J2 ; in particular, the L-torsor HomL (J, L) does\nnot change if we replace J by any its non-empty subset. E.g. every j \u2208 J yields an\n\u223c\n\u223c\nidentification of L-torsors HomL (J, L) \u2192 L, \u03bb 7\u2192 \u03bb(j), and L \u2192 L \u2297 J, l 7\u2192 l \u2297 J.\n(iii) If Fi = HomL (Ji , L) where Ji are any L-groupoids, then F1 \u2297 F2\u2297\u22121\nidentifies naturally with the L-torsor whose objects are maps \u03bc : J1 \u00d7 J2 \u2192 L,\n\u223c\n(j1 , j2 ) 7\u2192 \u03bc(j1 /j2 ), together with identifications \u03bb(j1\u2032 /j1 ) \u2297 \u03bc(j1 /j2 ) \u2297 \u03bb(j2 /j2\u2032 ) \u2192\n\u03bc(j1\u2032 /j2\u2032 ) which are associative with respect to the composition of \u03bb on both Ji .\nHere f1 \u2297 f2\u2297\u22121 corresponds to \u03bc(j1 /j2 ) := f1 (j1 ) \u2297 f2 (j2 )\u2297\u22121 .\nSuppose a group G acts on a non-empty L-groupoid J. Then it acts on the Ltorsor L \u2297 J by transport of structure. We can view this action as a monoidal\nfunctor g 7\u2192 \u03bbg from G (considered as a discrete monoidal category) into the\nmonoidal category EndL (L \u2297 J), which is naturally equivalent to L. Explicitly,\n\u223c\n\u223c\n\u03bbg := \u03bb(g/idJ ) \u2192 \u03bb(g(j)/j), j \u2208 J; the product isomorphism \u03bbg1 \u2297 \u03bbg2 \u2192 \u03bbg1 g2\n\u223c\nis the composition \u03bb(g1 (g2 (j))/g2 (j)) \u2297 \u03bb(g2 (j)/j)) \u2192 \u03bb((g1 g2 )(j)/j). A monoidal\nfunctor G \u2192 L is sometimes called (central) L-extension G\u266d of G.12\n12 If L is the Picard groupoid of A-torsors, A is an abelian group, then G\u266d amounts to a\ncentral extension of G by A, which is the reason for the terminology.\n\n\fE-Factors for the Period Determinants of Curves\n\n21\n\nThe group G acts on G\u266d in adjoint way. Namely, for h \u2208 G the isomorphism\n\u223c\n\u223c\n\u223c\n\u223c\nAdh : \u03bbg \u2192 \u03bbhgh\u22121 is the composition \u03bbg \u2192 \u03bbg \u2297 \u03bbh \u2297 \u03bbh\u22121 \u2192 \u03bbh \u2297 \u03bbg \u2297 \u03bbh\u22121 \u2192\n\u03bbhgh\u22121 , the first arrow is the tensoring with the inverse to the composition map\n\u223c\n1L \u2190 \u03bbh \u2297 \u03bbh\u22121 , the second one is the commutativity constraint. Equivalently, Adh\nAdh\n\u223c\n\u223c\n\u03bbghg\u22121 \u2192\nis determined by the condition that the composition \u03bb(g(j)/j) \u2192 \u03bbg \u2212\u2192\n\u03bb(hgh\u22121 (h(j))/h(j)) = \u03bb(h(g(j))/h(j)) coincides with the action of h.\nFor commuting g, h \u2208 G we denote by {g, h}\u266d \u2208 \u03c01 (L) := AutL (1L ) their\ncommutant in G\u266d , i.e., the action of Adg on \u03bbh or the ratio of \u03bbg \u2297 \u03bbh \u2192 \u03bbgh and\n\u03bbg \u2297 \u03bbh \u2192 \u03bbh \u2297 \u03bbg \u2192 \u03bbhg = \u03bbgh where the first and the last arrows are the product,\nthe middle one is the commutativity constraint (cf. [BBE] A5).\n2.3. A digression on lattices and relative determinants (see e.g. [Dr] \u00a75).\nLet S be a scheme, P be a relative effective divisor in XS /S finite over S. Let\nE be any quasi-coherent OXS -module such that for some neighborhood V of P the\nrestriction of E to V \\ P is coherent and locally free.\nA P -lattice in E is an OXS -submodule L of E which is locally free (hence\ncoherent) on a neighborhood of P , and equals E on XS \\ P . Denote by \u039bP (E) the\nset of P -lattices in E. We assume that it is non-empty. Then \u039bP (E) is directed\nby the inclusion ordering. Since P is finite over S, for every P -lattices L \u2283 L\u2032 the\nOS -module \u03c0\u2217 (L/L\u2032 ) is locally free of finite rank.13\n\u039bP (E) carries a natural LO (S)-groupoid structure. Namely, for P -lattices L,\nL\u2032 one has their relative determinant \u03bbP (L/L\u2032 ) \u2208 LO (S); for L, L\u2032 , L\u2032\u2032 there is a\ncanonical composition isomorphism\n\u223c\n\n\u03bbP (L/L\u2032 ) \u2297 \u03bbP (L\u2032 /L\u2032\u2032 ) \u2192 \u03bbP (L/L\u2032\u2032 )\n\n(2.3.1)\n\nwhich satisfies associativity property. This datum is uniquely determined by a\ndemand that for L \u2283 L\u2032 one has \u03bbP (L/L\u2032 ) := det \u03c0\u2217 (L/L\u2032 ), and for L \u2283 L\u2032 \u2283 L\u2032\u2032\nthe composition is the standard isomorphism defined by the short exact sequence\n0 \u2192 \u03c0\u2217 (L\u2032 /L\u2032\u2032 ) \u2192 \u03c0\u2217 (L/L\u2032\u2032 ) \u2192 \u03c0\u2217 (L/L\u2032 ) \u2192 0.\nWe denote by DetP/S (E) the LO (S)-torsor HomLO (S) (\u039bP (E), LO (S)). Its objects, referred to as determinant theories on E at P , are rules \u03bb that assigns to every\n\u223c\nL \u2208 \u039bP (E) a line \u03bb(L) \u2208 LO (S) together with identifications \u03bbP (L/L\u2032 ) \u2297 \u03bb(L\u2032 ) \u2192\n\u03bb(L) compatible with (2.3.1). Here one can replace \u039bP (E) by any its non-empty\nsubset. DetP/S (E) is compatible with base change change.\nFor quasi-coherent OX -modules E1 , E2 as above set\nDetP/S (E1 /E2 ) := DetP/S (E1 ) \u2297 DetP/S (E2 )\u2297\u22121 .\nBy Remark (iii) in 2.2, objects of this LO (S)-torsor, referred to as relative determinant theories on E1 /E2 at P , can be viewed as rules \u03bc which assign to every\nP -lattices L1 in E1 and L2 in E2 a line \u03bc(L1 /L2 ) \u2208 LO (S) together with natural\nidentifications\n\u223c\n\n\u03bbP (L\u20321 /L1 ) \u2297 \u03bc(L1 /L2 ) \u2297 \u03bbP (L2 /L\u20322 ) \u2192 \u03bc(L\u20321 /L\u20322 )\n\n(2.3.2)\n\nwhich are associative with respect to composition (2.3.1) on the two sides. We can\nalso restrict ourselves to Li in any non-empty subsets of \u039bP (Ei ).\n13 Let us show that \u03c0 (L/L\u2032 ) is O -flat. We can assume that X is affine, L, L\u2032 are locally\n\u2217\nS\nfree. Since \u03c0\u2217 (L/L\u2032 ) = \u03c0\u2217 (L)/\u03c0\u2217 (L\u2032 ) and \u03c0\u2217 L, \u03c0\u2217 L\u2032 are OS -flat, it suffices to check that for any\ngeometric point s of S the map \u03c0\u2217 (L\u2032 )s \u2192 \u03c0\u2217 (L)s is injective. This is clear, since \u03c0\u2217 (L(\u2032) )s =\n(\u2032)\n\u0393(Xs , Ls ) and L\u2032s \u2192 Ls is injective (being an isomorphism at the generic points of Xs ).\n\n\f22\n\nAlexander Beilinson\n\nRemarks. (i) Let E(\u221eP ) := lim\n\u2212\u2192 E(nP ) be the localization of E with respect\nto P . An evident morphism of LO (S)-groupoids \u039bP (E) \u2192 \u039bP (E(\u221eP )) yields an\n\u223c\nequivalence DetP/S (E) \u2192 DetP/S (E(\u221eP )); same for relative determinant theories.\nThus DetP/S (E) depends only on the restriction of E to the complement of P .\nNotice that \u039bP (E(\u221eP )) is directed by both inclusion ordering and the opposite\none.\n(ii) Let us order the set of pairs of P -lattices (L1 , L2 ) by the product of either\nof the inclusion orderings. Let I be any of its directed subsets. Suppose we have\na rule \u03bb that assigns to every (L1 , L2 ) \u2208 I a line \u03bb(L1 /L2 ) \u2208 LO (S) together with\nnatural identifications (2.3.2) defined for (L1 , L2 ) \u2265 (L\u20321 , L\u20322 ) and associative for\n(L1 , L2 ) \u2265 (L\u20321 , L\u20322 ) \u2265 (L\u2032\u20321 , L\u2032\u20322 ). Then \u03bb extends uniquely to a relative determinant\ntheory.\n(iii) The group Aut(EV \\P ) acts on \u039bP (E(\u221eP )) as on an LO (S)-groupoid.\nAs in 2.2, this defines an LO (S)-extension Aut(EV \\P )\u266d of Aut(EV \\P ). Thus for\ncommuting g \u2032 , g \u2208 Aut(EV \\P ) we have {g \u2032 , g}\u266d = {g \u2032 , g}\u266dP \u2208 O\u00d7 (S). Example: if\ng \u2032 is multiplication by a function f \u2208 O\u00d7 (V \\ P ), then {g \u2032 , g}\u266dP equals the ContouCarr\u00e8re symbol {det g, f }P at P (see e.g. [BBE] 3.3).14 In particular, if f \u2208 O\u00d7 (V ),\nthen {g \u2032 , g}\u266dP = f (\u2212div(det g)); here div(det g) is the part of the divisor supported\non V , i.e., at P .\nP -lattices have local nature with respect to P . In particular, if P is the disjoint\nsum of components P\u03b1 , then a P -lattice L amounts to a collection of P\u03b1 -lattices\nL\u03b1 , and there is an evident canonical factorization isomorphism\n\u223c\n\n\u2297 \u03bbP\u03b1 (L\u03b1 /L\u2032\u03b1 ) \u2192 \u03bbP (L/L\u2032 )\n\n(2.3.3)\n\ncompatible with composition (2.3.1). Therefore DetP/S (E) is the LO (S)-torsor\nproduct of DetP\u03b1 /S (E). So every collection of determinant theories \u03bb\u03b1 on E at\nP\u03b1 yields a determinant theory \u2297\u03bb\u03b1 on M at P , (\u2297\u03bb\u03b1 )(L) := \u2297\u03bb\u03b1 (L\u03b1 ). Same for\nrelative determinant theories.\n2.4. We return to the story of 1.1. Suppose we have (D, c) \u2208 D(S). Let us\napply the format of 2.3 to E1 = MS = M \u22a0 OS , E2 = \u03c9MS := (\u03c9 \u2297 M )S , and\nP = PD,c . The connection \u2207 = \u2207M : M \u2192 \u03c9M yields a relative determinant\n\u2207\ntheory \u03bc\u2207\nP = \u03bc(M )P \u2208 DetP/S (M/\u03c9M ) := DetP/S (MS /\u03c9MS ) defined as follows.\nLet L, L\u03c9 be P -lattices in MS , \u03c9MS such that \u2207(L) \u2282 L\u03c9 . Let C(L, L\u03c9 ) =\n\u2207\nC(L, L\u03c9 )M,P be the complex MS /L \u2192 \u03c9MS /L\u03c9 in degrees \u22121 and 0, i.e., it is the\n\u2207\n\nquotient dR(M ) \u22a0 OS /Cone(L \u2192 L\u03c9 ). Then \u03c0\u2217 C(L, L\u03c9 ) is a complex of quasicoherent OS -modules.\nLemma. \u03c0\u2217 C(L, L\u03c9 ) has OS -coherent cohomology.\nProof. We can assume that TSc = TS , since the assertion is S-local. Its validity\ndoes not depend on the choice of L, L\u03c9 . Take them to be \"constant\" T -lattices\nequal to M , \u03c9M on X \\ T , and we are reduced to the case of S = Spec k, P = T .\nLet X\u0304 be the smooth projective curve that contains X, T \u221e := X\u0304 \\ X. Let us\nextend M to a holonomic D-module on X\u0304, which we denote also by M ; let L, L\u03c9 be\n14 A short proof: Both expressions are compatible with base change. Since the datum of E,\nV , P , g, f can be extended S-locally to a smooth base, we can assume that S is smooth. Then it\nsuffices to check the equality at the generic point of S, where the Contou-Carr\u00e8re symbol is the\nusual tame symbol. The rest is a standard computation.\n\n\fE-Factors for the Period Determinants of Curves\n\n23\n\nT \u222aT \u221e -lattices as above. Since C(L, L\u03c9 )M,T \u222aT \u221e = C(L, L\u03c9 )M,T \u2295C(L, L\u03c9 )M,T \u221e , it\nsuffices to check that \u03c0\u2217 C(L, L\u03c9 )M,T \u222aT \u221e has finite-dimensional cohomology. Therefore we are reduced to the case of projective X.\n\u2207\nNow the lemma follows since C(L, L\u03c9 ) = dR(M )/Cone(L \u2192 L\u03c9 ), and the\ncohomology of X with coefficients in dR(M ), L, L\u03c9 are finite dimensional.\n\u0003\nPairs (L, L\u03c9 ) as above form a directed set IC as in Remark (ii) in 2.3. Set\n\u03bc\u2207\nP (L/L\u03c9 ) := det \u03c0\u2217 C(L, L\u03c9 ).\nIf (L\n\n\u2032\n\n, L\u2032\u03c9 )\n\n\u2032\n\n\u2208 IC is such that L \u2283 L , L\u03c9 \u2283\n\u2207\n\nL\u2032\u03c9 ,\n\n(2.4.1)\n\nthen the short exact sequence\n\n0 \u2192 Cone(L/L\u2032 \u2192 L\u03c9 /L\u2032\u03c9 ) \u2192 C(L\u2032 , L\u2032\u03c9 ) \u2192 C(L, L\u03c9 ) \u2192 0 together with the identi\u2207\nfication det \u03c0\u2217 Cone(L/L\u2032 \u2192 L\u03c9 /L\u2032\u03c9 ) = det \u03c0\u2217 (L\u03c9 /L\u2032\u03c9 ) \u2297 det \u03c0\u2217 (L/L\u2032 )\u2297\u22121 yields an\nisomorphism\n\u223c\n\n\u2032\n\u2207\n\u2032\n\u2032\n\u03bbP (L\u2032 /L) \u2297 \u03bc\u2207\nP (L/L\u03c9 ) \u2297 \u03bbP (L\u03c9 /L\u03c9 ) \u2192 \u03bcP (L /L\u03c9 )\n\n(2.4.2)\n\nwhich evidently satisfies associativity property. By Remark (ii) in 2.3, we have\n\u2207\ndefined \u03bc\u2207\nP = \u03bc(M/\u03c9M )P \u2208 DetP/S (M/\u03c9M ).\nRemarks. (i) Sometimes it is convenient to consider a smaller directed set\nformed by pairs (L, L\u03c9 ) that equal M , \u03c9M outside TSc , or its subset of those\n(L, L\u03c9 ) that are locally constant with respect to S.\n(ii) Denote by jT the embedding X \\ T \u0592\u2192 X. Then jT \u2217 M := jT \u2217 MX\\T is\nholonomic D-module as well; by Remark (i) from 2.3, one has DetP/S (M/\u03c9M ) =\nDetP/S (jT \u2217 M/\u03c9jT \u2217 M ). Suppose TSc = TS . Then L, L\u03c9 are P -lattices in jT \u2217 M ,\n\u223c\n\u03c9jT \u2217 M , and Cone(C(L, L\u03c9 )M,P , C(L, L\u03c9 )jT \u2217 M,P ) \u2192 dR(Cone(M \u2192 jT \u2217 M )) \u2297 OS .\n\u2207\n\u2207\nThus \u03bc(M/\u03c9M )P = \u03bc(jT \u2217 M/\u03c9jT \u2217 M )P \u2297 det R\u0393dR T (X, M ).\nThe above construction has local nature with respect to P . If P is disjoint sum\nof components P\u03b1 , and L, L\u03c9 correspond to collections of P\u03b1 -lattices L\u03b1 , L\u03c9\u03b1 , then\nC(L, L\u03c9 ) = \u2295 C(L\u03b1 , L\u03c9\u03b1 ). Passing to the determinants, we see that\n\u2207\n\u03bc(M/\u03c9M )\u2207\nP = \u2297\u03bc(M/\u03c9M )P\u03b1 .\n\n(2.4.3)\n\n2.5. Now we can construct the promised EdR (M ) as a factorization O-line.\nFor (D, c) \u2208 D(S), any trivialization \u03bd of \u03c9(D) on a neighborhood V of\nP = PD,c yields naturally \u03bc\u03bdP = \u03bc(M/\u03c9M )\u03bdP \u2208 DetP/S (M/\u03c9M ). Namely, the\n\u223c\nmultiplication by \u03bd isomorphism MV \\P \u2192 \u03c9MV \\P identifies the LO (S)-groupoids\n\u223c\n\u039bP (M (\u221eP )) \u2192 \u039bP (\u03c9M (\u221eP )); passing to DetP/S , we get \u03bc\u03bdP . Explicitly, for every\nP -lattices L, L\u03c9 one has a canonical identification\n\u223c\n\n\u03bc\u03bdP (L/L\u03c9 ) \u2192 \u03bbP (\u03bdL/L\u03c9 ) = \u03bbP (\u03c9L(D)/L\u03c9 ),\n\n(2.5.1)\n\nand identifications (2.3.2) are (2.3.1) combined with the isomorphism\n\u223c\n\n\u03bdL/L\u2032 : \u03bbP (L/L\u2032 ) \u2192 \u03bbP (\u03bdL/\u03bdL\u2032 )\nthat comes from multiplication by \u03bd.\nThe r.h.s. of (2.5.1) does not depend on \u03bd. Thus every L provides an identification eL between \u03bc\u03bdP for all trivializations \u03bd of \u03c9(D) near P ; it is characterized by property that (2.5.1) transforms eL (L/L\u03c9 ) into the identity map for\n\u03bbP (\u03c9L(D)/L\u03c9 ).\nExercise. Let \u03bd1 , \u03bd2 be any trivializations of \u03c9(D) on V ; set f := \u03bd2 /\u03bd1 \u2208\n\u223c\nO\u00d7 (V ). Consider the identifications eL , eL\u2032 : \u03bc\u03bdP1 \u2192 \u03bc\u03bdP2 . Show that\neL\u2032 = f (div(L/L\u2032 ))eL .\n\n(2.5.2)\n\n\f24\n\nAlexander Beilinson\n\nHere div(L/L\u2032 ) := div(\u03c6L\u2032 /\u03c6L ), where \u03c6L , \u03c6L\u2032 are local trivializations of the line\nbundles det(L), det(L\u2032 ) at P ; this is a relative Cartier divisor supported at P .\nIf \u03bd1 |P = \u03bd2 |P , i.e., f |P = 1, then we define a canonical identification\n\u223c\n\ne : \u03bc\u03bdP1 \u2192 \u03bc\u03bdP2\n\n(2.5.3)\n1\n\nas follows. The function f (D) \u2208 O\u00d7 (S) equals 1 on Sred since f |P = 1. Let f (D) 2\nbe the branch of the root that equals 1 on Sred . Pick a lattice L0 which equals\nrk(M )\nM off TSc and is S-locally constant. Then15 e := f (D) 2 eL0 . By (2.5.2), the\n\u2032\nauxiliary choice of L0 is irrelevant: indeed, if L0 , L0 that satisfy our condition, then\nf (div(L0 /L\u20320 )) = 1, for the divisor div(L0 /L\u20320 ) is S-locally constant and supported\non TSc , and f |TSc = 1. The identifications e are evidently transitive.\nRemark. Suppose L is an arbitrary lattice. Then\ne = f (div(L/L0 ))f (D)rk(M)/2 eL\nwhere L0 is any lattice as above (see (2.5.2) and (2.5.3)).\nOur e provides a canonical identification of OS -lines\n\u223c\n\n\u03bd2 \u2297\u22121\n\u03bd1 \u2297\u22121\n\u2192 \u03bc\u2207\nr := id\u03bc\u2207\n\u2297 e\u2297\u22121 : \u03bc\u2207\n.\nP \u2297 (\u03bcP )\nP \u2297 (\u03bcP )\nP\n\n(2.5.4)\n\n\u03bd \u2297\u22121\nTherefore for (D, c, \u03bdP ) \u2208 D\u22c4 (S) the OS -line \u03bc\u2207\ndoes not depend on the\nP \u2297 (\u03bcP )\nchoice of \u03bd such that \u03bd|P = \u03bdP . Set\n\u03bd \u2297\u22121\n.\nEdR (M )(D,c,\u03bdP ) := \u03bc\u2207\nP \u2297 (\u03bcP )\n\n(2.5.5)\n\nThe construction is compatible with base change, so EdR (M ) is an O-line on D\u22c4 .\nBy (2.4.3) and similar property of \u03bc\u03bdP , it carries a factorization structure. So we\nhave defined EdR (M ) \u2208 L\u03a6\nO (X, T ).\nExample. If M is supported at T , then EdR (M )(D,c,\u03bd) = det R\u0393dR T c (X, M ).\nSummary. Suppose we have (D, c, \u03bdP ) \u2208 D\u22c4 (S). By (2.5.1), every L and \u03bd\nsuch that \u03bd|P = \u03bdP yields an isomorphism\n\u223c\n\nnrL,\u03bd : EdR (M )(D,c,\u03bdP ) \u2192 \u03bc\u2207\nP (L/\u03c9L(D)).\n\n(2.5.6)\n\nIf f |P = 1, then, by Remark,\nrL,f \u03bd = f (div(L0 /L))f (D)\u2212\n\nrk(M )\n2\n\naL,\u03bd .\n\n(2.5.7)\n\nIn particular, rL,f \u03bd = rL,\u03bd for reduced S.\n\n2.6. Lemma. (i) On X \\ T there is a canonical isomorphism\n(1)\n\n\u223c\n\nEdR (M )X\\T \u2192 (det MX\\T )\u2297\u22121 .\n\n(2.6.1)\n\n(ii) Suppose T \u2032 \u2282 T is such that M is smooth at T \\ T \u2032 . Let EdR (M )\u2032 be the\nrestriction to (X, T ) of the \u03b5-line of M on (X, T \u2032 ). Then there is a canonical\n\u223c\nidentification EdR (M ) \u2192 EdR (M )\u2032 .\n15 The\n\nreason for the normalization will become clear in 2.10.\n\n\fE-Factors for the Period Determinants of Curves\n\n25\n\n(1)\n\nProof. (i) Recall that EX\\T = E(D,0,\u03bd) where S = X \\ T , D = \u2206 = P is the\ndiagonal divisor, and \u03bd is (the principal part of) a form with logarithmic singularity\nrL,\u03bd\n(1)\nat \u2206 with residue 1. Take L = MX\\T . Then C(L, \u03c9L) = 0, hence EdR (M )X\\T \u2212\u2192\n\u223c\n\n\u2297\u22121\n\u03bc\u2207\n. Now (2.6.1) is this\nP (L/\u03c9L(D)) \u2192 \u03bbP (\u03c9L/\u03c9L(D)) = det \u03c0\u2217 (\u03c9L(D)/\u03c9L)\n\u223c\nisomorphism followed by the residue map \u03c0\u2217 (\u03c9L(D)/\u03c9L) \u2192 L = MX\\T .\n(ii) Evident.\n\u0003\n\n2.7. Proposition. For proper X there is a canonical isomorphism\n\u223c\n\n*\n\u03b7dR : EdR (M )(X) \u2192 det HdR\n(X, M ).\n\n(2.7.1)\n\u223c\n\nProof. By 1.4, (2.7.1) amounts to a natural identification \u03b7dR : EdR (M )\u03bd \u2192\n*\ndet HdR\n(X, M ) \u2297 OS which is defined for every S-family of rational 1-forms \u03bd on\nX and is compatible with base change.\nSet P = Pdiv(\u03bd),1 = T \u222a|div(\u03bd)|. Since X is proper, for a P -lattice L in M (\u221eP )\nthe complex of OS -modules R\u03c0\u2217 (L) is perfect; set \u03bb(L) := det R\u03c0\u2217 (L). Then \u03bb is a\ndeterminant theory on M at P in an evident manner. Replacing M by \u03c9M , we get\n\u03bb\u03c9 \u2208 DetP/S (\u03c9M ), hence \u03bb \u2297 \u03bb\u2297\u22121\n\u2208 DetP/S (M/\u03c9M ). One has an isomorphism\n\u03c9\n\u223c\n\n\u03bc\u03bdP \u2192 \u03bb \u2297 \u03bb\u2297\u22121\n,\n\u03c9\n\n(2.7.2)\n\u2297\u22121 \u223c\n\nnamely, \u03bc\u03bdP (L/L\u03c9 ) := \u03bbP (\u03bdL/L\u03c9 ) = \u03bb\u03c9 (\u03bdL) \u2297 \u03bb\u03c9 (L\u03c9 )\n\u2192 \u03bb(L) \u2297 \u03bb\u03c9 (L\u03c9 )\u2297\u22121 =\n\u223c\n\u223c\n\u22121\n\u2297\u22121\n(\u03bb \u2297 \u03bb\u03c9 )(L/L\u03c9 ) where \u2192 comes from isomorphism \u03bd : \u03bdL \u2192 L.\nFor P -lattices L in M , L\u03c9 in \u03c9M with \u2207(L) \u2282 L\u03c9 (see 2.4), set dR(L, L\u03c9 ) :=\n\u2207\nCone(L \u2192 L\u03c9 ) \u2282 dR(M ). Since dR(M )/dR(L, L\u03c9 ) = C(L, L\u03c9 ), we see that dR(M )\ncarries a 3-step filtration with successive quotients L\u03c9 , L[1], C(L, L\u03c9 ). Applying\ndet R\u03c0\u2217 , we get an isomorphism\n\u223c\n\n*\ndet R\u03c0\u2217 C(L, L\u03c9 ) \u2297 \u03bb(L)\u2297\u22121 \u2297 \u03bb(L\u03c9 ) \u2192 det HdR\n(X, M ) \u2297 OS .\n\n(2.7.3)\n\nTo get \u03b7dR , we combine it with (2.7.2) (and (2.5.5)). The construction does not\ndepend on the auxiliary choice of L, L\u03c9 .\n\u0003\nExample. Suppose M is a D-module on P1 with regular singularities at 0 and\n\u221e, where it is, respectively, the \u2217- and the !-extension. Since R\u0393dR (P1 , M ) = 0,\nour \u03b7dR is an isomorphism\n\u223c\n\n\u03b7dR : EdR (M )(0,t\u22121 dt) \u2297 EdR (M )(\u221e,t\u22121 dt) \u2192 k.\n\n(2.7.4)\n\nTo compute it explicitly, pick a t\u2202t -invariant vector subspace V of \u0393(P1 \\{0, \u221e}, M ),\nwhich freely generates MP1 \\{0,\u221e} as an O-module and such that the only possible\nintegral eigenvalue of t\u2202t on V is 0. Set L := OP1 (\u2212(\u221e)) \u2297 V , L\u03c9 := t\u22121 dt \u2297 L =\n\u03c9P1 ((0) + (\u221e)) \u2297 L. The condition on V implies that there are O-linear embeddings\ni : L \u0592\u2192 M , i\u03c9 : L\u03c9 \u0592\u2192 \u03c9M , which extend the evident isomorphisms on P1 \\ {0, \u221e},\nsuch that \u2207(L) \u2282 L\u03c9 and i\u03c9 (\u03c6l) = \u03c6i(l) for any \u03c6 \u2208 \u03c9P1 , l \u2208 L. Such i, i\u03c9\nare unique. The complex C(L, L\u03c9 ) = C(L, L\u03c9 )0 \u2295 C(L, L\u03c9 )\u221e is acyclic, so (2.5.6)\nprovides trivializations \u03b90 of EdR (M )(0,t\u22121 dt) and \u03b9\u221e of EdR (M )(\u221e,t\u22121 dt) .\nLemma. One has \u03b7dR (\u03b90 \u2297 \u03b9\u221e ) = 1.\n\n\f26\n\nAlexander Beilinson\n\nProof. The determinant of the complex R\u0393(P1 , dR(L, L\u03c9 )) has two natural trivializations \u03b11 , \u03b12 : the first one comes since the complex is acyclic, the second one\nfrom the identification det R\u0393(P1 , dR(L, L\u03c9 )) = det R\u0393(P1 , L\u03c9 )\u2297 det R\u0393(P1 , L)\u2297\u22121\n\u223c\nand the multiplication by t\u22121 dt isomorphism L \u2192 L\u03c9 . Now (2.7.3) identifies\n\u03b90 \u2297 \u03b9\u221e \u2297 \u03b11 with 1, and \u03b90 \u2297 \u03b9\u221e \u2297 \u03b12 with \u03b7dR (\u03b90 \u2297 \u03b9\u221e ). Since R\u0393(P1 , L) =\nR\u0393(P1 , L\u03c9 ) = 0, one has \u03b11 = \u03b12 ; we are done.\n\u0003\n2.8. The next constraints follow directly from the construction:\n(i) For a finite filtration M* on M , there is a canonical isomorphism\n\u223c\n\nEdR (M ) \u2192 \u2297 EdR (gri M )\n\n(2.8.1)\n\nwhich satisfies transitivity property with respect to refinement of the filtration.\nRemark. If M = \u2295M\u03b1 , then every linear ordering of the indices yields a\n\u223c\nfiltration on M , hence an isomorphism EdR (M ) \u2192 \u2297 EdR (M\u03b1 ). This isomorphism\ndoes not depend on the ordering. Thus EdR is a symmetric monoidal functor.\n(ii) Let \u03c0 : (X \u2032 , T \u2032 ) \u2192 (X, T ) be a finite morphism of pairs (see Remark (i)\nin 1.2) which is \u00e9tale over X \\ T . As in loc. cit., we have a morphism of Picard\n\u2032\n\u2032\n\u03a6\ngroupoids \u03c0\u2217 : L\u03a6\nO (X , T ) \u2192 LO (X, T ). We also have the D-module direct image\n\u2032\nfunctor \u03c0\u2217 which is exact. If M is a holonomic D-module on (X \u2032 , T \u2032 ), then \u03c0\u2217 M \u2032 is\nholonomic D-module on (X, T ). Notice that \u03c0\u2217 M \u2032 coincides with the \"naive\" direct\nimage \u03c0* M \u2032 outside T , and dR(\u03c0\u2217 M \u2032 ) is canonically quasi-isomorphic to \u03c0* dR(M \u2032 )\nas a dg module over the de Rham dg algebra of X. Therefore one has a canonical\nisomorphism\n\u223c\n\nEdR (\u03c0\u2217 M \u2032 ) \u2192 \u03c0\u2217 EdR (M \u2032 )\n\n(2.8.2)\n\ncompatible with the composition of \u03c0's and with (2.8.1).\n\u223c\n*\n*\nExercise. Consider the standard isomorphism HdR\n(X, \u03c0\u2217 M \u2032 ) \u2192 HdR\n(X \u2032 , M \u2032 ).\n\u223c\n\u2032\nIf X is proper, then (2.8.2) yields an isomorphism EdR (\u03c0\u2217 M )(X) \u2192 EdR (M \u2032 )(X \u2032 ).\nShow that \u03b7dR 's identify the second isomorphism with the determinant of the first\none.\n2.9. Another digression on lattices and relative determinants. For a Clifford\nalgebra explanation of the next constructions, see [BBE] 2.14\u20132.17. In this subsection and the next one we use Z/2-graded lines instead of Z-graded ones; as in 1.2,\nthe corresponding Picard groupoids are marked by \u2032 .\nLet S, P be as in 2.3. Let E, E \u25e6 be OX -modules as in 2.3, V a neighborhood\nof P such that both E, E \u25e6 are locally free over V \\ P , \u03c8 : EV \\P \u00d7 EV\u25e6 \\P \u2192 \u03c9V \\P/S\nbe a non-degenerate pairing. For a P -lattice L in E(\u221eP ) its \u03c8-dual L\u03c8 is the\nP -lattice in E \u25e6 (\u221eP ) such that \u03c8 is a non-degenerate \u03c9V /S -valued pairing between\n\u25e6\n\u03c8\nLV and L\u03c8\nV . The map \u03c4\u03c8 : \u039bP (E(\u221eP )) \u2192 \u039bP (E (\u221eP )), L 7\u2192 \u03c4\u03c8 (L) := L , is an\n\u2032\norder-reversing bijection. It lifts to an isomorphism of LO (S)-groupoids:\nLemma. For every L, L\u2032 \u2208 \u039bP (E(\u221eP )) there is a canonical isomorphism\n\u223c\n\n\u03c4\u03c8 : \u03bbP (L/L\u2032 ) \u2192 \u03bbP (L\u03c8 /L\u2032\u03c8 )\nof Z/2-graded lines compatible with the composition.\n\n(2.9.1)\n\n\fE-Factors for the Period Determinants of Curves\n\n27\n\nProof. It suffices to define (2.9.1) for L\u2032 \u2283 L and check the compatibility with\ncomposition for L\u2032\u2032 \u2283 L\u2032 \u2283 L.\nThe pairing l, l\u25e6 7\u2192 (l, l\u25e6 )\u03c8 := ResP/S \u03c8(l, l\u25e6 ) yields a duality between the\nvector bundles \u03c0\u2217 (L\u2032 /L) and \u03c0\u2217 (L\u03c8 /L\u2032\u03c8 ), hence a duality between the determinant\nn(n\u22121)\n\u223c\nlines \u03bbP (L\u2032 /L) \u2297 \u03bbP (L\u03c8 /L\u2032\u03c8 ) \u2192 OS , (\u2227li ) \u2297 (\u2227l\u25e6j ) 7\u2192 (\u22121) 2 det(li , l\u25e6j )\u03c8 where\nn = rk \u03c0\u2217 (L\u2032 /L). Then (2.9.1) is characterized by the property that id\u03bbP (L\u2032 /L) \u2297 \u03c4\u03c8\n\u223c\nidentifies the latter pairing with the composition \u03bbP (L\u2032 /L) \u2297 \u03bbP (L/L\u2032 ) \u2192 OS . The\ncompatibility of \u03c4\u03c8 with composition is left to the reader.\n\u0003\nRemark. Here is a sketch of a Clifford algebra interpretation of \u03c4\u03c8 . Consider the\nClifford OS -algebra generated by \u03c0\u2217 EV \\P \u2295 \u03c0\u2217 EV\u25e6 \\P equipped with the hyperbolic\nform ResP/S \u03c8. Let N be any \"invertible\" continuous Clifford module. For any\n\u03c8\nP -lattice L the OS -submodlule N L\u2295L of vectors killed by L \u2295 L\u03c8 lies in L\u2032O (S),\n\u03c8\n\u2032\n\u2032\u03c8\nand \u03bbP (L/L\u2032 ) = N L\u2295L \u2297 (N L \u2295L )\u2297\u22121 = \u03bbP (L\u03c8 /L\u2032\u03c8 ); the composition is \u03c4\u03c8 .\nPassing to Det\u2032P/S , our \u03c4\u03c8 yields \u03bc\u03c8 \u2208 Det\u2032P/S (E/E \u25e6 ). Thus for L \u2208 \u039bP (E(\u221eP )),\nL\u03c9 \u2208 \u039bP (E \u25e6 (\u221eP )) one has \u03bc\u03c8 (L/L\u03c9 ) = \u03bbP (L\u03c8 /L\u03c9 ), and identifications (2.3.2)\nare (2.3.1) combined with \u03c4\u03c8 .\nExercise. Suppose we have another non-degenerate pairing EV \\P \u00d7 EV\u25e6 \\P \u2192\n\u03c9V \\P/S ; one can write it as \u03c8g (*, *) = \u03c8(g*, *) = \u03c8(*, \u03c8g*) where g \u2208 Aut(EV \\P ) and\n\u03c8\ng \u2208 Aut(EV \\P ) is the \u03c8-adjoint to g. Then L\u03c8g = \u03c8g \u22121 (L\u03c8 ) = (g(L))\u03c8 and\n\u03c4\u03c8g = \u03c8g \u22121 \u03c4\u03c8 = \u03c4\u03c8 g.\n\n(2.9.2)\n\u223c\n\nE.g. for f \u2208 O\u00d7 (V ) one has Lf \u03c8 = L\u03c8 and \u03c4f \u03c8 = f (div(L/L\u2032 ))\u03c4\u03c8 : \u03bbP (L/L\u2032 ) \u2192\n\u03bbP (L\u03c8 /L\u2032\u03c8 ); here div(L/L\u2032 ) was defined in 2.5.\nAs in 2.2 and Remark (iii) in 2.3, we denote by g 7\u2192 \u03bbg the L\u2032O (S)-extension\nAutL\u2032O (S) (\u039bP (E(\u221eP )))\u266d\u2032 of the group AutL\u2032O (S) (\u039bP (E(\u221eP ))); same for E replaced\nby E \u25e6 . Passing to Det\u2032P/S , (2.9.2) yields then an isomorphism\n\u223c\n\n\u223c\n\n\u03bc\u03c8g \u2192 \u03bb\u03c8g\u22121 \u2297 \u03bc\u03c8 \u2192 \u03bc\u03c8 \u2297 \u03bbg .\n\n(2.9.3)\n\n\u25e6\n\nSuppose now that E = E and \u03c8 is symmetric. Then \u03c4\u03c8 is an involution of\nthe L\u2032O (S)-groupoid \u039bP (E(\u221eP )). Therefore, since \u03bc\u03c8 = \u03bb\u03c4\u03c8 \u2208 Det\u2032P/S (E/E) =\nL\u2032O (S), the composition yields a canonical identification\n\u223c\n\na\u03c8 : \u03bc\u03c8 \u2297 \u03bc\u03c8 \u2192 OS .\n\n(2.9.4)\n\n\u223c\n\nExplicitly, the isomorphism \u03bc\u03c8 \u2192 \u03bbP (\u03c4\u03c8 (L)/L) identifies a\u03c8 with the pairing\n\u03bbP (\u03c4\u03c8 (L)/L) \u2297 \u03bbP (\u03c4\u03c8 (L)/L) \u2192 OS , l1 \u2297 l2 7\u2192 \u03c4\u03c8 (l1 )l2 = l1 \u03c4\u03c8 (l2 ).\n2.10. Let us construct on E = EdR (M ) \u2208 L\u03a6\nO (X, T ) a de Rham structure such\nthat the identification of (2.6.1) is horizontal. By the corollary in 1.12, it is uniquely\ndefined by this property, and the constraints from 2.8 are automatically compatible\nwith the de Rham structure. As in 2.1, we assume that T is compatible with M .\nAs in Remark (i) in 1.2, we need to present for every scheme S and a pair of\npoints (D, c, \u03bdP ), (D\u2032 , c\u2032 , \u03bdP\u2032 ) \u2208 D\u22c4 (S) which coincide on Sred , a natural identification (notice that c = c\u2032 )\n\u223c\n\n\u03b1\u03b5 : E(D,c,\u03bdP ) \u2192 E(D\u2032 ,c,\u03bdP\u2032 ) .\n\n(2.10.1)\n\nThe \u03b1\u03b5 should be transitive and compatible with base change and factorization.\nSet P := TSc \u222a |D| \u222a |D\u2032 | = PD,c \u222a PD\u2032 ,c . Localizing S, we find an open\nneighborhood V of P , V \u2229 TS = TSc , together with a datum \u03bd, \u03bd \u2032 , \u03ba, where:\n\n\f28\n\nAlexander Beilinson\n\n(a) \u03bd, \u03bd \u2032 are trivializations of \u03c9V /S (D), \u03c9V /S (D\u2032 ) which coincide on Vred and such\nthat \u03bd|PD,c = \u03bdP , \u03bd|PD\u2032 ,c = \u03bdP\u2032 (cf. Remark (ii) in 1.1);\n(b) \u03ba : MV \\P \u00d7 MV \\P \u2192 OV \\P is a non-degenerate symmetric bilinear form.\nWe construct \u03b1\u03b5 explicitly using this datum.\nThe notation from 2.9 are in use. One can view \u03ba as a non-degenerarate pairing\nMV \\P \u00d7 \u03c9MV \\P \u2192 \u03c9V \\P/S , which yields \u03bc\u03baP = \u03bc\u03ba \u2208 Det\u2032P/S (M/\u03c9M ). We get\n\u2207/\u03ba\n\n\u03bcP\n\n\u03ba \u2297\u22121\n:= \u03bc\u2207\n,\nP \u2297 (\u03bcP )\n\n\u03ba/\u03bd\n\n\u03bcP\n\n:= \u03bc\u03baP \u2297 (\u03bc\u03bdP )\u2297\u22121 \u2208 L\u2032O (S);\n\n(2.10.2)\n\nrecall that \u03bc\u03bdP \u2208 Det\u2032P/S (M/\u03c9M ) corresponds to the multiplication by \u03bd identification of M (\u221eP ) and \u03c9M (\u221eP ). Let us rewrite (2.5.5) as an identification\n\u223c\n\n\u2207/\u03ba\n\n\u03ba \u2297\u22121\nE(D,c,\u03bd) \u2192 \u03bc\u2207\n\u2297 \u03bc\u03baP \u2297 (\u03bc\u03bdP )\u2297\u22121 = \u03bcP\nP \u2297 (\u03bcP )\n\n\u03ba/\u03bd\n\n\u2297 \u03bcP .\n\n(2.10.3)\n\nThere is a similar identification for E(D\u2032 ,c,\u03bd \u2032 ) .\n\u03ba/\u03bd\n\nNotice that \u03bcP is the line that corresponds to the symmetric pairing \u03ba/\u03bd =\n\u03bd \u22121 \u03ba : \u03c9MV \\P \u00d7 \u03c9MV \\P \u2192 \u03c9V \\P/S . So, by (2.9.4), one has a canonical trivializa\u223c\ntion a\u03ba/\u03bd : \u03bc\u03ba/\u03bd \u2297 \u03bc\u03ba/\u03bd \u2192 OS .\n\u223c\nLet \u03b2 : E(D,c,\u03bd) \u2192 E(D\u2032 ,c,\u03bd \u2032 ) be an isomorphism obtained by means of (2.10.3)\n\u03ba/\u03bd \u223c\n\n\u03ba/\u03bd \u2032\n\n\u2192 \u03bcP\n\nfrom the tensor product of \u03b21 := id\u03bc\u2207/\u03ba and an identification \u03b22 : \u03bcP\nP\n\n\u03b5\nsuch that \u03b22\u22972 = a\u22121\n\u03ba/\u03bd \u2032 a\u03ba/\u03bd and \u03b22 equals identity on Sred . We set \u03b1 := \u03b3\u03b2, where\n\n\u03b3 := exp ResP/S (log(\u03bd \u2032 /\u03bd)\u03c6\u03ba ) \u2208 O\u00d7 (S).\n\n(2.10.4)\n\n\u2032\n\nHere \u03bd /\u03bd is an invertible function on V \\ P that equals 1 on Vred , so log(\u03bd \u2032 /\u03bd) is\na nilpotent function on V \\ P , and \u03c6\u03ba := 12 \u2207M (det \u03ba\u22121 )/ det \u03ba\u22121 \u2208 \u0393(V \\ P, \u03c9V /S )\nwhere det \u03ba\u22121 is the trivialization of det MV\u22972\\P defined by \u03ba.\nProposition. \u03b1\u03b5 does not depend on the auxiliary choice of \u03bd, \u03bd \u2032 , and \u03ba.\nProof. (a) Let us show that \u03b1\u03b5 does not depend on \u03ba for fixed \u03bd, \u03bd \u2032 . Suppose we\nhave two forms \u03ba and \u03bag , so \u03bag (*, *) = \u03ba(g*, *) for a \u03ba-self-adjoint g \u2208 Aut(MV \\P ).\nConsider the corresponding \u03b2, \u03b3 and \u03b2g , \u03b3g . Then \u03b2g /\u03b2 and \u03b3/\u03b3g are functions on\nS that equal 1 on Sred ; we want to check that they are equal.\nWe have an \u03c9-valued symmetric bilinear form \u03c8 := \u03ba/\u03bd on \u03c9MV \\P . Our g,\nviewed as an automorphism of \u03c9MV \\P , is \u03c8-self-adjoint and \u03bag /\u03bd = \u03c8g . Since\n\u223c\nAd\u03c4\u03c8 (g) = g \u22121 , we have the isomorphism Ad\u03c4\u03c8 : \u03bbg\u22121 \u2192 \u03bbg (see 2.2). Consider the\n\u223c\nidentification \u03bc\u03c8g \u2192 \u03bbg\u22121 \u2297 \u03bc\u03c8 of (2.9.3). The next lemma follows directly from\nthe definition of a\u03c8 and a\u03c8g as the composition in the \u266d\u2032-extension (see (2.9.4)):\n\u223c\n\n\u223c\n\nLemma. a\u03c8g equals the composition \u03bc\u03c8g \u2297 \u03bc\u03c8g \u2192 \u03bbg\u22121 \u2297 \u03bc\u03c8 \u2297 \u03bbg\u22121 \u2297 \u03bc\u03c8 \u2192 \u03bbg\u22121 \u2297\n\u223c\n\u03bbg\u22121 \u2297 \u03bc\u03c8 \u2297 \u03bc\u03c8 \u2192 OS . Here the second arrow is the commutativity constraint, the\nthird one is tensor product of a map b\u03c8 : \u03bbg\u22121 \u2297 \u03bbg\u22121 \u2192 OS , l1 \u2297 l2 7\u2192 l1 Ad\u03c4\u03c8 (l2 ),\nand a\u03c8 .\n\u0003\nThere is a similar assertion for \u03c8 replaced by \u03c8 \u2032 := \u03ba/\u03bd \u2032 . Combining them,\nwe see that (\u03b2g /\u03b2)2 = b\u03c8 /b\u03c8\u2032 . Since \u03c4\u03c8\u2032 = h\u03c4\u03c8 where h is the multiplication\n\u223c\nby \u03bd \u2032 /\u03bd automorphism (see (2.9.2)), one has Ad\u03c4\u03c8\u2032 = {h, g}\u266dP Ad\u03c4\u03c8 : \u03bbg\u22121 \u2192 \u03bbg\n(see 2.2). Therefore (\u03b2g /\u03b2)2 = ({h, g}\u266d )\u22121 ; by Remark (iii) in 2.3, this equals the\nContou-Carr\u00e8re symbol {\u03bd \u2032 /\u03bd, det g}P .\n\n\fE-Factors for the Period Determinants of Curves\n\n29\n\nNow \u03c6\u03ba \u2212\u03c6\u03bag = 12 d log(det g), hence \u03b3/\u03b3g = exp ResP/S ( 21 log(\u03bd \u2032 /\u03bd)d log(det g))\n1\n= {(\u03bd \u2032 /\u03bd) 2 , det g}P , and we are done.\n(b) It remains to show that \u03b1\u03b5 does not depend on the choice of the lifts \u03bd, \u03bd \u2032\nof \u03bdP , \u03bdP\u2032 . One can change \u03bd, \u03bd \u2032 to f \u03bd, f \u2032 \u03bd \u2032 where f, f \u2032 \u2208 O\u00d7 (V ) are such that f\nequals f \u2032 on Vred , f equals 1 on PD,c , f \u2032 equals 1 on PD\u2032 ,c .\nBy (a), in the computation we are free to use \u03ba of our choice. We work Xlocally, so we can assume that c = 1 and pick \u03ba to be a non-degenerate symmetric\nform on MX\\T . Then \u03c6\u03ba \u2208 \u03c9(X, T ) due to the compatibility of T with M , see 2.1.\nThe function log(f \u2032 /f ) is regular on V and vanishes on TSc . Therefore log(f \u2032 /f )\u03c6\u03ba\nis regular at P , hence its residue vanishes. Thus \u03b3(f \u2032 \u03bd \u2032 , f \u03bd) = \u03b3(\u03bd \u2032 , \u03bd). It remains\nto show that \u03b2(f \u2032 \u03bd \u2032 , f \u03bd) = \u03b2(\u03bd \u2032 , \u03bd).\nLet L0 be any T -lattice in M , L\u03ba0 be the \u03ba-orthogonal T -lattice. Since \u03c9L\u03ba0 =\n\u223c\n\u223c\n\u03c4\u03ba/\u03bd (\u03c9L0 (D)) = \u03c4\u03ba/f \u03bd (\u03c9L0 (D)), one has \u03bc\u03ba/\u03bd \u2192 \u03bbP (\u03c9L\u03ba0 /\u03c9L0 (D)) \u2190 \u03bc\u03ba/f \u03bd . Let\n\u223c\n\u223c\ne\u03baL0 : \u03bc\u03ba/\u03bd \u2192 \u03bc\u03ba/f \u03bd be the composition, and rL0 : E(D,c,\u03bd) \u2192 E(D,c,f \u03bd) be the tensor\nproduct of id\u03bc\u2207/\u03ba and e\u03baL0 (we use identifications (2.10.3) for \u03bd and f \u03bd). We see that\nP\n\n\u223c\n\n\u2297 e\u2297\u22121\nrL0 coincides with the isomorphism id\u03bc\u2207\nwhere eL0 : \u03bc\u03bdP \u2192 \u03bcfP\u03bd was defined\nL0\nP\nrk(M )\n\u2212 2\n\n\u223c\n\nin 2.5. Thus f (D)\nrL0 : E(D,c,\u03bd) \u2192 E(D,c,f \u03bd) is the canonical isomorphism r\nfrom (2.5.4).\nWe want to check that r and the similar isomorphism for f \u2032 , \u03bd \u2032 identify\n\u2032 \u2032\n\u03b2(f \u03bd , f \u03bd) with \u03b2(\u03bd \u2032 , \u03bd). Indeed, e\u03baL0 identifies a\u03ba/f \u03bd with f (D)rk(M) a\u03ba/\u03bd (see Exrk(M )\n\nrk(M )\n\nercise in 2.9), so rL0 identify \u03b2(f \u2032 \u03bd \u2032 , f \u03bd) with f (D) 2 f \u2032 (D\u2032 )\u2212 2 \u03b2(\u03bd \u2032 , \u03bd). By\nabove, this implies the assertion for r.\n\u0003\nThe isomorphisms \u03b1\u03b5 are transitive (since such are \u03b1\u03b5 with fixed \u03ba) and evidently compatible with base change and factorization, so we have defined a de\nRham structure on E. The horizontality of (2.6.1) will be checked in Example (i)\nof 2.11.\nRemark. Let us fix a non-degenerate symmetric bilinear form \u03ba on MX\\T\n(like in part (b) of the proof of the lemma). Then the above construction can be\nreformulated as follows. There is a canonical isomorphism\n\u223c\n\nEdR (M ) \u2192 E1 \u2297 E2 \u2297 E3 ,\n\n(2.10.5)\n\nwhere Ei are the next de Rham factorization lines:\n\u2207/\u03ba\n- E1(D,c,\u03bd) := \u03bcP in (2.10.2); it depends only on c, i.e., E1 comes from 2T .\n\u03ba/\u03bd\n- E2(D,c,\u03bd) := \u03bcP in (2.10.2), so E2 \u2297 E2 is canonically trivialized (as a de Rham\nfactorization line) by a\u03ba/\u03bd . Notice that E2 does not depend on the connection \u2207M .\nO-triv\n(see 1.12), i.e., it is a de Rham factorization\n- E3 := E \u2212\u03c6\u03ba \u2208 L\u03a6\ndR (X, T )\nline equipped with an O-trivialization e with \u2207(e(1) )/e(1) = \u2212\u03c6\u03ba , where \u03c6\u03ba :=\n1\n\u22121\n)/ det \u03ba\u22121 \u2208 \u03c9(X, T ) (see (1.12.3)). Isomorphism (2.10.5) is (2.10.3)\u2297e.\n2 \u2207(det \u03ba\n2.11. As in 1.3, the de Rham structure on E can be viewed as a datum of\nintegrable connections \u2207\u03b5 on E(D,c,\u03bdP ) for S smooth. The next explicit construction\nof \u2207\u03b5 is a paraphrase of the above:\nOur problem is X-local, so we can fix \u03ba as in the above remark and a T -lattice\nL in M ; we can assume that c = 1. Choose any \u03bd as in Remark (ii) in 1.1. We\n\u223c\n\u2207\n\u03ba\n\u03ba\nhave identification rL,\u03bd : E(D,c,\u03bdP ) \u2192 \u03bc\u2207\nP (L/L(D)) = \u03bcP (L/\u03c9L ) \u2297 \u03bbP (\u03c9L /L(D))\n1\n1\n\u2207\nof (2.5.6). Let \u2207 = \u2207L,\u03ba be the \"constant\" connection on \u03bcP (L/\u03c9L\u03ba ), and\n\u22072 = \u22072L,\u03bd,\u03ba be the connection on \u03bbP (\u03c9L\u03ba /L(D)) for which the pairing a\u03ba/\u03bd :\n\n\f30\n\nAlexander Beilinson\n\n\u03bbP (\u03c9L\u03ba /L(D)) \u2297 \u03bbP (\u03c9L\u03ba /L(D)) \u2192 OS , l1 \u2297 l2 7\u2192 \u03c4\u03ba/\u03bd (l1 )l2 , of (2.9.4) is horizontal. We get a connection \u2207\u03bd,\u03ba := \u22071 \u2297 \u22072 on E(D,c,\u03bd) . Then\n\u2207\u03b5 = \u2207\u03bd,\u03ba \u2212 \u03b8\u03bd,\u03ba\n\n(2.11.1)\n\nwhere \u03b8\u03bd,\u03ba := ResP/S (dS \u03bd/\u03bd \u2297 \u03c6\u03ba ) \u2208 \u03a91S . Here dS is the derivation along the fibers\nof XS /X, so dS \u03bd/\u03bd is a section of \u03c0V\u2217 \u03a91S on V \\ P .\nExamples. (i) Let us compute the connection on E (l) (see 1.6). So let S be a\ncopy of X \\ T , P = \u2206, D = l\u2206. Let t be a local coordinate on X \\ T , x be the\ncorresponding coordinate on S, z be the coordinate on Gm , \u03bd := z(t \u2212 x)\u2212l dt. Our\nE (l) is the de Rham line E(D,0,\u03bd) on S \u00d7 Gm .\n\u03ba\nWe take L = MX\\T , so L\u03ba = L and \u03bc\u2207\nP (L/\u03c9L ) is trivialized. Therefore\nE (l) = \u03bbP (\u03c9M/\u03c9M (D)). The choice of t trivializes \u03c9 and all the vector bundles\n\u223c\n\u03c0\u2217 OX\u00d7S (m\u2206)/OX\u00d7S (n\u2206), which provides an identification E (l) \u2192 (det M )\u2297\u2212l .\nThe pairing a\u03ba/\u03bd is equal (up to sign) to (z \u2212n det \u03ba)\u2212l , n := rk(M ), so \u2207\u03bd,\u03ba =\n\u22121\ndz. One has dS\u00d7Gm \u03bd/\u03bd = z \u22121 dz + l(t \u2212 x)\u22121 dx. Hence\n\u2207(det M)\u2297\u2212l + l\u03c6\u03ba + ln\n2 z\n\u03b8\u03bd,\u03ba = l\u03c6\u03ba , and\nln\n(2.11.2)\n\u2207\u03b5 = \u2207(det M)\u2297\u2212l + z \u22121 dz.\n2\nIn case l = 1 and z \u2261 1, (2.11.2) says that (2.6.1) is horizontal with respect to\n\u2207\u03b5 and the connection on (det MX\\T )\u2297\u22121 .\n(ii) Suppose M has regular singularities at b \u2208 T . Let t be a parameter at b.\nConsider P = b, D = lb, and a family of 1-forms \u03bdz := zt\u2212l dt, z \u2208 Gm . Let us\ncompute the connection \u2207\u03b5 on the line bundle E(b,\u03bdz ) := E(D,1b ,\u03bdz ) on Gm .\nLet L be any t\u2202t -invariant P -lattice in M (\u221eb); denote by r the trace of t\u2202t acting on L/tL, n := rk(M ). Let \u22070 be a connection on E(b,\u03bdz ) such that rL,\u03bdz of (2.5.6)\nidentifies it with the \"constant\" connection on z-independent line \u03bc\u2207\nb (L/\u03c9L(D)).\nThen\nln\n(2.11.3)\n\u2207\u03b5 = \u22070 + ( \u2212 r)z \u22121 dz.\n2\nIndeed, consider the above construction with \u03bd = \u03bdz and \u03ba = tl \u03ba0 where \u03ba0 is\na non-degenerate symmetric bilinear form on L. Then L\u03ba = L(D), so \u2207\u03bd,\u03ba = \u22070 .\n\u22972\nThe trivialization det \u03ba\u22121 of det MX\\{b}\nhas pole of order ln at b, thus the form \u03c6\u03ba\nhas logarithmic singularity at b with residue r \u2212 ln/2. Since dz (\u03bdz )/\u03bdz = z \u22121 dz,\none has \u03b8\u03bd,\u03ba = (r \u2212 ln/2)z \u22121dz, and we are done by (2.11.1).\n2.12. Let q : X \u2192 Q, T be as in 1.14. Let M be a coherent DX/Q -module\nwhich is OQ -flat and is a vector bundle on X \\ T . We call such M a flat Q-family\nof holonomic D-modules on (X/Q, T ). The notion of compatibility of T and M is\ndefined as in 5.1.\nLet dRX/Q (M ) = Cone(\u2207) be the relative de Rham complex. If for some\n(hence every) T -lattices L in M , L\u03c9 in \u03c9M := \u03c9X/Q \u2297 M with \u2207(L) \u2282 L\u03c9 the\n\u2207\n\ncomplex q\u2217 (dRX/Q (M )/Cone(L \u2192 L\u03c9 )) has OQ -coherent cohomology, then we call\nM a nice Q-family of D-modules.\nExercises. Suppose Q = Spec C[s], X = Spec C[t, s], T is the divisor t = 0.\n(i) Show that M generated by a section m subject to the relation t\u2202t m = sm is\nnice, and that the DX/Q -module jT \u2217 M = M [t\u22121 ] is not coherent (cf. [BG]).\n(ii) Show that M generated by section m subject to the relation tn \u2202t m = sm,\nn > 1, is nice over the subset s 6= 0.\n\n\fE-Factors for the Period Determinants of Curves\n\n31\n\nBy a straightforward relative version of the constructions of this section, every\nnice family compatible with T gives rise to a relative factorization line EdR (M ) \u2208\nL\u03a6\ndR/Q (X/Q, T ) (see 1.14). The construction is compatible with base change. For\nproper X/Q, the OQ -complex RqdR\u2217 (M ) := Rq\u2217 dRX/Q (M ) is perfect, and we have\n\u223c\nan isomorphism of O-lines \u03b7dR : EdR (M )(X/Q) \u2192 det RqdR\u2217 (M ).\nSuppose that Q is smooth and the relative connection on M is extended to a\nflat connection (so our nice family is isomonodromic).\nProposition. The relative connection on EdR (M ) extends naturally to a flat absolute connection which has local origin and is compatible with base change and\nconstraints from 2.8. Thus EdR (M ) \u2208 L\u03a6\ndR (X/Q, T ). For proper X/Q, \u03b7dR is\nhorizontal (for the Gauss-Manin connection on the target).\nProof. Let L = L((X, T )/Q) be the Lie algebra of infinitesimal symmetries of\n(X, T )/Q; its elements are pairs (\u03b8X , \u03b8Q ) where \u03b8X , \u03b8Q are vector fields on X, Q\nsuch that \u03b8X preserves T and dq(\u03b8X ) = \u03b8Q . Our L acts on D\u22c4 (X/Q, T ; \u03c9) and on\nE := EdR (M ) by transport of structure. This action is compatible with constraints\nfrom 2.8 and the relative de Rham structure.\nVariant. Let T \u2032 \u2282 T be a component of T ; set L\u2032 := L((X \\ T \u2032 , T \\ T \u2032 )/Q) \u2283 L.\nThen L\u2032 acts naturally on D\u22c4 (X/Q, T\u0302 ; \u03c9) (see 1.13 where we considered the \"vertical\" part of this action). If M = jT \u2032 \u2217 M , then this action lifts naturally to EdR (M )\n(as follows directly from the construction of EdR (M )). The L\u2032 -action extends the\nL-action (pulled back to D\u22c4 (X/Q, T\u0302 ; \u03c9)) and satisfies similar compatibilities.\nLemma. The Lie ideals L0 \u2282 L, L\u20320 \u2282 L\u2032 act on E via \u2207\u03b5 .\nProof of Lemma. It suffices to check this Q-pointwise, so, due to compatibility\nwith the base change, we can assume that Q is a point. By the compatibility with\nthe first constraint in 2.8, it suffices to consider the cases when M is supported at\nT and M = jT \u2217 M . In the first situation the lemma is evident. If M = jT \u2217 M , then\nit suffices to consider the case of L\u20320 for T \u2032 = T , i.e., L\u20320 = \u0398(X \\ T ). The L\u20320 -action\nis compatible with the de Rham structure, so we are done by the lemma in 1.13. \u0003\nWe want to define the connection in a manner compatible with the localization\nof X, so it suffices to do it in case when X and Q are affine. Then L/L0 is the\nLie algebra of vector fields on Q. Therefore, by the lemma, \u2207\u03b5 extends in a unique\nmanner to an absolute flat connection such that L acts via this connection.\nRemark. In the situation with T \u2032 the Lie algebra L\u2032 acts on E via the connection\nas well (by the same lemma).\nAll the properties stated in the proposition, except the last one, are evident\nfrom the construction. Let us show that \u03b7dR is horizontal. We work Q-locally, so\nwe can assume that Q is affine and X \\ T admits a section s. We can enlarge T\nto T + := T \u2294 T \u2032 , T \u2032 := s(Q). By the first constraint from 2.8, the assertion for M\nreduces to that for s\u2217 s\u2217 M and jT \u2032 \u2217 M = M (\u221eT \u2032 ). The first case is evident. In the\nsecond case the Gauss-Manin connection comes from the action of the Lie algebra\nL\u2032 (for T + and T \u2032 ), and we are done by the remark.\n\u0003\n2.13. Compatibility of \u03b7dR with quadratic degenerations of X. We will show\nthat \u03b7dR remains constant (in some sense) when X degenerates quadratically and\nM stays constant outside the node. Notice that the family is not isomonodromic\n\n\f32\n\nAlexander Beilinson\n\n(so 2.12 is not applicable). We will need the result in \u00a75; the reader can presently\nskip the subsection. Consider the next data (a), (b):\n(a) A smooth proper curve Y , a finite subscheme T \u2282 Y , two points b+ , b\u2212 \u2208\n(Y \\ T )(k), a rational 1-form \u03bd on Y invertible off T \u222a {b\u00b1 } and having poles of\norder 1 at b\u00b1 with Resb\u00b1 \u03bd = \u00b11. Let t\u00b1 be formal coordinates at b\u00b1 such that\nd log t\u00b1 = \u00b1\u03bd.\n(b) A D-module N on (Y, T \u222ab\u00b1 ) which has regular singularities at b\u00b1 , is the \u2217extension at b+ and the !-extension at b\u2212 . We also have a t\u00b1 \u2202t\u00b1 -invariant b\u00b1 -lattice\n\u223c\nL in M , and an identification of the b\u00b1 -fibers \u03b1 : Lb+ \u2192 Lb\u2212 . Let A\u00b1 \u2208 End(Lb\u00b1 )\nbe the action of \u00b1t\u00b1 \u2202t\u00b1 on the fibers; we ask that \u03b1A+ = A\u2212 \u03b1, and that the\neigenvalues of A+ (or A\u2212 ) and their pairwise differences cannot be non-zero integers.\nThen the restriction of L to the formal neighborhoods Y \u00b1\u0302 = Spf k[[t\u00b1 ]] of b\u00b1 can be\nidentified in a unique way with Lb\u00b1 [[t\u00b1 ]] so that Lb\u00b1 \u2282 \u0393(Y \u00b1\u0302 , L) is t\u00b1 \u2202t\u00b1 -invariant.\nDatum (a) yields a proper family of curves X over Q = Spf k[[q]] = lim\n\u2212\u2192 Qn ,\nQn = Spec k[q]/q n , which has quadratic degeneration at q = 0. The 0-fiber X0 is Y\nwith b\u00b1 glued to a single point b0 \u2208 X0 (k); let jb0 be the embedding Y \\ {b+ , b\u2212 } =\nX0 \\ {b0 } \u0592\u2192 X0 . Outside b0 our X is trivialized, i.e., OX\\{b0 } = OX\\{b0 } [[q]].\nThe formal completion of the local ring at b0 equals k[[t+ , t\u2212 ]] with q = t+ t\u2212 ,\nand the glueing comes from the embedding k[[t+ , t\u2212 ]] \u0592\u2192 k((t+ ))[[q]] \u00d7 k((t\u2212 ))[[q]],\nt+ 7\u2192 (t+ , q/t\u2212 ), t\u2212 7\u2192 (q/t+ , t\u2212 ). Set R := k((t+ ))[[q]] \u00d7 k((t\u2212 ))[[q]]/k[[t+ , t\u2212 ]].\nWe have a short exact sequence (R is viewed as a skyscraper at b0 )\n0 \u2192 OX \u2192 jb0 \u2217 OX\\{b0 } = jb0 \u2217 OX0 \\{b0 } [[q]] \u2192 R \u2192 0,\n\n(2.13.1)\n\nwhere the right projection assigns to f = \u03a3fn q n the image of (f+ , f\u2212 ) in R, f\u00b1 =\n\u03a3fn (t\u00b1 )q n \u2208 k((t\u00b1 ))[[q]] are the expansions of f at b\u00b1 .\nOur family of curves has standard nodal degeneration, so we have the dualizing\nline bundle \u03c9X/Q . Our \u03bd defines a rational section \u03bdQ of \u03c9X/Q , which is \"constant\"\non X \\ {b0 } with respect to the above trivialization, and is invertible near b0 .\nBelow for an OX -module F a relative connection on F means a morphism \u2207 :\nF \u2192 \u03c9X/Q \u2297F such that \u2207(f \u03c6) = d(f )\u2297\u03c6+f \u2207(\u03c6), where d is the canonical differentiation d : OX \u2192 \u03c9X/Q . Set dRX/Q (F ) := Cone(\u2207), RqdR\u2217 F := Rq\u2217 dRX/Q (F ).\nDatum (b) yields an O-module M on X equipped with a relative connection\n\u2207. Our M is locally free over X \\ TQ . Outside b0 it is constant with respect to\nthe above trivialization: one has M |X\\{b0 } = N |Y \\{b+ ,b\u2212 } [[q]] = L|Y \\{b+ ,b\u2212 } [[q]].\nThe restriction M0 of M to X0 equals L with fibers Lb\u00b1 identified by \u03b1. On the\nformal neighborhood of b0 our M equals Mb0 [[t+ , t\u2212 ]], and the glueing comes from\nthe trivializations of L on Y \u00b1\u0302 (see (b)) and the gluing of functions. Therefore we\nhave a short exact sequence\n0 \u2192 M \u2192 (jb0 \u2217 L|Y \\{b+ ,b\u2212 } )[[q]] \u2192 Mb0 \u2297 R \u2192 0,\nn\n\n(2.13.2)\n\nwhere the right projection assigns to l = \u03a3ln q \u2208 (jb0 \u2217 L|Y \\{b+ ,b\u2212 } ) the image in\nof (l+ , l\u2212 ) Mb0 \u2297 R, l\u00b1 = \u03a3ln (t\u00b1 )q n \u2208 Lb\u00b1 ((t\u00b1 ))[[q]] = Mb0 ((t\u00b1 ))[[q]] are the\nexpansions of l at b\u00b1 with respect to the formal trivializations of L on Y \u00b1\u0302 . On\nX \\ {b0 } the relative connection \u2207 comes from the D-module structure on N ; on\nthe formal neighborhood of b0 this is the relative connection on Mb0 [[t+ , t\u2212 ]] with\n\u22121\npotential At\u22121\n+ dt+ = \u2212At\u2212 dt\u2212 .\nRemarks. (2.13.2) is an exact sequence of OX -modules equipped with relative\n\u22121\n\u22121\nconnections. The projection (t\u22121\n+ k[t+ ] \u2295 k[t\u2212 ])[[q]] \u2192 R is an isomorphism. The\nrelative connection on Mb0 \u2297 R is \u2207(m \u2297 ta\u00b1 q b ) = \u03bd(A(m) \u00b1 am)ta\u00b1 q b .\n\n\fE-Factors for the Period Determinants of Curves\n\n33\n\nSet D = \u2212div(\u03bd) \u2212 b+ \u2212 b\u2212 . Then div(\u03bdQ ) = \u2212DQ does not intersect b0 , so\nwe have an OQ -line EdR (M )\u03bdQ := EdR (M )(DQ ,1T ,\u03bdQ ) . An immediate modification\nof the construction in 2.7 (to be spelled out in the proof of the proposition below)\nyields an isomorphism\n\u223c\n\n\u03b7dR : EdR (M )\u03bdQ \u2192 det RqdR\u2217 M.\n\n(2.13.3)\n\nOur aim is to compute it explicitly. Notice that since our family (X, TQ , M, \u03bdQ ) is\ntrivialized outside b0 , one has a canonical identification\n\u223c\n\nEdR (M )\u03bdQ \u2192 EdR (N )(D,1T ,\u03bd) [[q]].\n\n(2.13.4)\n\n(i) Consider an embedding Cone(A)[[q]] \u0592\u2192 dRX/Q (Mb0 \u2297R) whose components\nare Mb0 [[q]] \u0592\u2192 Mb0 \u2297R, m\u2297f (q) 7\u2192 m\u2297(0, f (q)), and Mb0 [[q]] \u0592\u2192 \u03c9X/Q \u2297Mb0 \u2297R,\nm \u2297 f (q) 7\u2192 \u03bd \u2297 m \u2297 (0, f (q)). By the condition on A, this is a quasi-isomorphism.\nThus (2.13.2) yields an isomorphism\n\u223c\n\ndet RqdR\u2217 M \u2192 det R\u0393dR (Y, jb\u00b1 \u2217 N ) \u2297 det Cone(A)[[q]].\n\n(2.13.5)\n\n\u2212\n\nLet L be a b\u00b1 -lattice in N that equals L outside b\u2212 and t\u2212 L at b\u2212 . Set\nC! := Cone(\u2207 : L\u2212 \u2192 \u03c9Y (log b+ )L), C\u2217 := Cone(\u2207 : L \u2192 \u03c9Y (log b\u00b1 )L). Recall\nthat N is the !-extension at b\u2212 and the \u2217-extension at b+ , so the condition on\nA assures that the embeddings C! \u0592\u2192 dR(N ) and C\u2217 \u0592\u2192 dR(jb\u00b1 \u2217 N ) are quasiisomorphisms. Since C\u2217 /C! equals Cone(A) (viewed as a skyscraper at b\u2212 ), we see\n\u223c\nthat Cone(dR(N ) \u2192 dR(jb\u00b1 \u2217 N )) \u2192 Cone(A), hence\n\u223c\n\ndet R\u0393dR (Y, N ) \u2192 det R\u0393dR (Y, jb\u00b1 \u2217 N ) \u2297 det Cone(A).\n\n(2.13.6)\n\nCombining it with (2.13.5), we get an isomorphism\n\u223c\n\ndet RqdR\u2217 M \u2192 det R\u0393dR (Y, N )[[q]].\n\n(2.13.7)\n\n(ii) Consider a D-module on P1 \\ {0, \u221e} which equals OP1 \\{0,\u221e} \u2297 Mb0 as an\nO-module, \u2207(f \u2297 m) = df \u2297 m + f \u2297 A(m). Let N\u0304 be the !-extension to \u221e and\n1\nthe \u2217-extension to 0 of N . Consider the embeddings t+ : Y +\u0302 \u0592\u2192 P1 , t\u22121\n\u2212 : Y \u2212\u0302 \u0592\u2192 P\nwhich identify Y \u00b1\u0302 with the formal neighborhoods of 0 and \u221e. The trivializations\nof L on Y \u00b1\u0302 from (b) identify the pull-back of N\u0304 with N |Y \u00b1\u0302 . Since the pull-back\n\u223c\nof t\u22121 dt equals \u03bd|Y \u00b1\u0302 , we get the identifications EdR (N )(b+ ,\u03bd) \u2192 EdR (N\u0304 )(0,t\u22121 dt) ,\n\u223c\nEdR (N )(b\u2212 ,\u03bd) \u2192 EdR (N\u0304 )(\u221e,t\u22121 dt) . Combined with (2.7.4) (for M in loc. cit. equal\nto N\u0304 ), they produce an isomorphism\n\u223c\n\nEdR (N )(b+ ,\u03bd) \u2297 EdR (N )(b\u2212 ,\u03bd) \u2192 k.\n\n(2.13.8)\n\nSince EdR (N )\u03bd = EdR (N )(D,1T ,\u03bd) \u2297 EdR (N )(b+ ,\u03bd) \u2297 EdR (N )(b\u2212 ,\u03bd) , we rewrite it as\n\u223c\n\nEdR (N )(D,1T ,\u03bd) \u2192 EdR (N )\u03bd .\n\n(2.13.9)\n\nProposition. The diagram\n\u03b7dR\n\n\u2212\u2192\ndet RqdR\u2217 M\nEdR (M )\u03bdQ\n\u2193\n\u2193\n\u03b7dR\nEdR (N )\u03bd [[q]] \u2212\u2192 det R\u0393dR (Y, N )[[q]],\nwhere the vertical arrows are (2.13.9)\u25e6(2.13.4) and (2.13.7), commutes.\n\n(2.13.10)\n\n\f34\n\nAlexander Beilinson\n\nProof. We check the assertion modulo q n+1 . Thus we restrict our picture to\nQn := Spec Rn , Rn := k[q]/q n+1 ; we get a Qn -curve Xn , Mn = M \u2297 Rn , etc.\nLet F be a {b+ , b\u2212 }-lattice in jb\u00b1 \u2217 N such that \u2207(F ) \u2282 \u03bdF = \u03c9Y (log b\u00b1 ) \u2297 F ;\nset dR(F ) := Cone(\u2207 : F \u2192 \u03bdF ), R\u0393dR (Y, F ) := R\u0393(Y, dR(F )). Then there is a\ncanonical isomorphism\n\u223c\n\n\u03b7dR (F ) : EdR (N )(D,1T ,\u03bd) \u2192 det R\u0393dR (Y, F )\n\n(2.13.11)\n\ndefined as in the proposition in 2.7. Precisely, pick any T \u222a |D|-lattices E, E\u03c9\nin N , \u03c9N such that \u2207(E) \u2282 E\u03c9 . Denote by F E the T \u222a {b+ , b\u2212 } \u222a |D|-lattice\nin jb\u00b1 \u2217 N that equals F off T \u222a |D| and E off b\u00b1 ; similarly, F E\u03c9 equals E\u03c9\noff b\u00b1 and \u03bdF off T \u222a |D|. Now follow the construction from the proposition\nin 2.7, with L, L\u03c9 , dR(M ) from loc. cit. replaced by F E, F E\u03c9 and dR(F ).\nNamely, dR(F ) carries a 3-step filtration with successive quotients F E\u03c9 , F E[1],\n\u223c\nC(E, E\u03c9 ), and \u03b7dR (F ) is the composition EdR (N )(D,1T ,\u03bd) \u2192 det \u0393(Y, C(E, E\u03c9 )) \u2297\n\u223c\n\u223c\n\u03bb(F E\u03c9 /\u03bdF E) \u2192 det \u0393(Y, C(E, E\u03c9 )) \u2297 det R\u0393(Y, F E\u03c9 ) \u2297 (det R\u0393(Y, \u03bdF E))\u2297\u22121 \u2192\n\u223c\ndet \u0393(Y, C(E, E\u03c9 )) \u2297 det R\u0393(Y, F E\u03c9 ) \u2297 det R\u0393(Y, F E[1])) \u2192 det R\u0393(X, dR(F )).\nFor example, for F = L\u2212 from (i) above one has dR(L\u2212 ) = C! , so R\u0393dR (Y, L\u2212 ))\n\u223c\n= R\u0393dR (Y, N ), and we get \u03b7dR (L\u2212 ) : EdR (N )(D,1T ,\u03bd) \u2192 det R\u0393dR (Y, N ). We can\n\u223c\nalso view L\u2212 as a lattice in N , and compute \u03b7dR : EdR (N )\u03bd \u2192 R\u0393dR (Y, N ) using it\n(as in the proposition in 2.7). Now the lemma in 2.7 implies that \u03b7dR (L\u2212 ) equals\n(2.13.9)\n\n\u03b7dR\n\nthe composition EdR (N )(D,1T ,\u03bd) \u2212\u2192 EdR (N )\u03bd \u2212\u2192 R\u0393dR (Y, N ).\nExercise. If F \u2032 \u2282 F is a sublattice with \u2207(F \u2032 ) \u2282 \u03bdF \u2032 , then dR(F )/dR(F \u2032 ) =\nCone(\u2207 : F/F \u2032 \u2192 \u03bdF/\u03bdF \u2032 ). Thus dR(F ) carries a 3-step filtration with succes\u223c\nsive quotients dR(F \u2032 ), \u03bdF/\u03bdF \u2032 , F/F \u2032 , hence det R\u0393dR (Y, F ) \u2192 det R\u0393dR (Y, F \u2032 ) \u2297\ndet \u0393(Y, \u03bdF/\u03bdF \u2032 ) \u2297 det \u0393(Y, F/F \u2032 )\u2297\u22121 . The multiplication by \u03bd isomorphism\n\u223c\n\u223c\nF/F \u2032 \u2192 \u03bdF/\u03bdF \u2032 cancels the last two factors, i.e., we have det R\u0393dR (Y, F ) \u2192\n\u2032\n\u2032\n\u22121\n\u0393dR (Y, F ). Show that this isomorphism equals \u03b7dR (F )\u03b7dR (F ) .\nOne can repeat the above story with Y replaced by Xn , jb\u00b1 \u2217 N by jb0 \u2217 N \u2297 Rn ,\nand E, E\u03c9 by E \u2297 Rn , E\u03c9 \u2297 Rn . For a b0 -lattice G in jb0 \u2217 N \u2297 Rn (i.e., an\nOXn -submodule, which is Rn -flat and equals jb0 \u2217 N \u2297 Rn outside b0 ) such that\n\u2207(G) \u2282 \u03bdG, we get an isomorphism\n\u223c\n\n\u03b7dR (G) : EdR (N )(D,1T ,\u03bd) \u2297 Rn \u2192 det RqdR\u2217 G.\n\n(2.13.12)\n\nFor G = Mn , this is (2.13.3) combined with (2.13.4). If G is a \"constant\" lattice,\nG = F \u2297 Rn , then RqdR\u2217 G = R\u0393dR (Y, F ) \u2297 Rn and \u03b7dR (G) = \u03b7dR (F ) \u2297 idRn .\n\u223c\nBy above, the proposition means that \u03b7dR (L\u2212 )\u03b7dR (Mn )\u22121 : det RqdR\u2217 M \u2192\ndet R\u0393dR (Y, N ) \u2297 Rn coincides with (2.13.7). Set L(n) := I n+1 L, where I is the\nideal of {b+ , b\u2212 } in OY . Then L(n) lies in both L\u2212 and Mn . Set PN := L\u2212 /L(n)\nand PM := Mn /L(n) \u2297 Rn ; let BN , BM be their endomorphisms \u03bd \u22121 \u2207. One has\n\u223c\n\u223c\nevident isomorphisms Cone(BM ) \u2192 \u0393(Xn , dR(Mn )/dR(L(n) ) \u2297 Rn ), Cone(BN ) \u2192\n\u2212\n(n)\n(n)\n\u0393(Y, dR(L )/dR(L )). Thus det RqdR\u2217 M = det R\u0393dR (Y, L ) \u2297 det Cone(BM ),\n\u223c\ndet R\u0393dR (Y, N ) \u2192 det R\u0393dR (Y, L(n) ) \u2297 det Cone(BN ), so both \u03b7dR (L\u2212 )\u03b7dR (M )\u22121\n\u223c\nand (2.13.7) can be rewritten as isomorphisms det Cone(BM ) \u2192 det Cone(BN )\u2297Rn .\nBoth det Cone(BM ) and det Cone(BN ) are naturally trivialized (since\ndet Cone(BM ) = det(PM ) \u2297 det(PM [1]), etc.). By Exercise, \u03b7dR (L\u2212 )\u03b7dR (Mn )\u22121\nidentifies these trivializations. Isomorphism (2.13.7) comes due to the fact that\n\n\fE-Factors for the Period Determinants of Curves\n\n35\n\nCone(BM ) and Cone(BN ) \u2297 Rn are naturally quasi-isomorphic: we have the evident embeddings iM : Ma \u2297 Rn \u0592\u2192 Mn /L(n) , iN : Ma \u0592\u2192 L\u2212 /L(n) such that\nBM iM = iM A, BN iN = iN A, which yield quasi-isomorphisms Cone(A) \u2297 Rn \u0592\u2192\nCone(BM ), Cone(A) \u0592\u2192 Cone(BN ). Therefore the ratio of \u03b7dR (L\u2212 )\u03b7dR (Mn )\u22121 and\n(2.13.7) equals the ratio of the determinants of BM and BN acting on the quotients\n(Mn /L(n) )/Ma \u2297 Rn , (L\u2212 /L(n) )/Ma . The first quotient is the direct sum of comi \u2212i i\nponents Ma \u2297 (ti+ , q i t\u2212i\n\u2212 ) \u2297 Rn and Ma \u2297 (q t+ , t\u2212 ) \u2297 Rn for 1 \u2264 i \u2264 n, the second\ni\none is the direct sum of Ma \u2297 (t+ , 0) and Ma \u2297 (0, ti\u2212 ) for 1 \u2264 i \u2264 n. Both BM and\nBN act on them as A + i id and A \u2212 i id, so the two determinants are equal. We\nare done.\n\u0003\n2.14. Suppose k = C. The definitions and constructions of this section render\nimmediately into the complex-analytic setting of 1.15. Thus every triple (X, T, M ),\nwhere X is a smooth (not necessarily compact) complex curve, T its finite subset, M\na holonomic D-module on (X, T ), yields a factorization line EdR (M ) \u2208 L\u03a6\ndR (X, T )\nin the complex-analytic setting of 1.15. If X and M came from an algebraic setting, then EdR (M ) is an analytic factorization line produced by the algebraic one\n(defined previously). If an algebraic family of D-modules is nice (see 2.12), then\nthe corresponding analytic family is nice.\nWe work in the analytic setting. Let q : X \u2192 Q, i : T \u0592\u2192 X be as in 1.14; we\nassume that T is \u00e9tale over Q (see 1.15). Let M be a flat family of D-modules on\n(X/Q, T ) which admits locally a T -lattice, see 2.12. Consider the sheaf-theoretic\nrestriction F := i* dRX/Q (M ) of the relative de Rham complex to T . Since q|*T OQ =\nOT , this is a complex of OT -modules.\nLemma. M is nice if and only if F has OT -coherent cohomology.\nProof. The assertion is Q-local, so we can assume that T is a disjoint sum\n\u2207\nof several copies of Q. Since q\u2217 (dRX/Q (M )/Cone(L \u2192 L\u03c9 )) is the direct sum of\npieces corresponding to the components of T , we are reduced to the situation when\nX equals U \u00d7 Q, where U \u2282 A1 is a coordinate disc, and T = {0} \u00d7 Q.\nM extends in a unique manner to a DA1Q /Q -module on A1Q which is smooth\noutside T ; denote it also by M . So we can assume that X = A1Q . Set X\u0304 := P1Q ; let\nq\u0304 : X\u0304 \u2192 Q be the projection, so X = X\u0304 \\ T \u221e , TQ\u221e := {\u221e} \u00d7 Q.\nLet us extend M to an OX\u0304 -module M\u0304 such that the relative connection has\nlogarithmic singularity at T \u221e . Such an M\u0304 exists locally on Q. Replacing M\u0304 by\nsome M\u0304 (nT \u221e ), we can assume that the eigenvalues of \u2212t\u2202t in the fiber of M\u0304 over\n\u2207\nT \u221e do not meet Z\u22650 . Let dRX\u0304/Q (M\u0304 ) := Cone(M\u0304 \u2192 \u03c9 M\u0304 (T \u221e )) be the relative\nde Rham complex of M\u0304 with logarithmic singularities at T \u221e . One has the usual\nquasi-isomorphisms\n\u223c\n\n\u223c\n\nRq\u0304\u2217 (dRX\u0304/Q (M\u0304 )) \u2192 q\u2217 (dRX/Q (M )) \u2192 i*T dRX/Q (M ).\n\n(2.14.1)\n\nLet L\u0304 \u2282 M\u0304 , L\u0304\u03c9 \u2282 \u03c9 M\u0304 (T \u221e ) be OX\u0304 -submodules that equal L, L\u03c9 on X and\ncoincide with M\u0304 , \u03c9 M\u0304 (T \u221e ) outside T . Now dRX/Q (M )/Cone(L \u2192 L\u03c9 ) equals\ndRX\u0304/Q (M\u0304 )/Cone(L\u0304 \u2192 L\u0304\u03c9 ), so (2.14.1) yields an exact triangle\nRq\u0304\u2217 Cone(L\u0304 \u2192 L\u0304\u03c9 ) \u2192 i*T dRX/Q (M ) \u2192 q\u2217 dRX/Q (M )/Cone(L \u2192 L\u03c9 ).\n\n(2.14.2)\n\nIts left term is OQ -coherent, so the other two are coherent simultaneously, q.e.d. \u0003\n\n\f36\n\nAlexander Beilinson\n\n3 The de Rham \u03b5-lines: analytic theory\nFrom now on we work in the analytic setting over C using the classical topology.\n3.1. Let X be a smooth (not necessary compact) complex curve, T its finite\nsubset. For a holonomic D-module M we denote by B(M ) the de Rham complex\ndR(M ) viewed as mere perverse C-sheaf on X, and set HB* (X, M ) := H * (X, B(M ));\n\u223c\n*\nthus one has an evident period isomorphism \u03c1 : HB* (X, M ) \u2192 HdR\n(X, M ). Here is\nthe principal result of this section:\nTheorem-construction. Let M , M \u2032 be holonomic D-modules on (X, T ). Then\n\u223c\nevery isomorphism \u03c6 : B(M ) \u2192 B(M \u2032 ) yields naturally an identification of the\n\u223c\nde Rham factorization lines \u03c6\u01eb : EdR (M ) \u2192 EdR (M \u2032 ). The construction has local\norigin, and is compatible with constraints from 2.8. If X is compact, then the next\ndiagram of isomorphisms commutes:\n\u03c6\u01eb\n\nEdR (M )(X)\n\u2212\u2192\nEdR (M \u2032 )(X)\n\u03b7dR \u2193\n\u03b7dR \u2193\n*\n*\ndet HdR\n(X, M )\ndet HdR\n(X, M \u2032 )\n\u03c1\u2193\n\u03c1\u2193\ndet HB* (X, M )\n\n\u03c6\n\n\u2212\u2192\n\n(3.1.1)\n\ndet HB* (X, M \u2032 ).\n\nThe idea of the proof: By a variant of Riemann-Hilbert correspondence, B(M )\namounts to the D\u221e -module M \u221e . Thus what we need is to render the story of \u00a72 into\nthe analytic setting of D\u221e -modules, which is done using a version of constructions\nfrom [PS], [SW].\nAn alternative proof of the theorem, which uses 2.13 and \u00a74 instead of analytic\nFredholm determinants, is presented in 5.8. Thus the reader can skip the rest of\nthe section and pass directly to \u00a74.\n3.2. A digression on D\u221e -modules and Riemann-Hilbert correspondence. For\nthe proofs of the next results, see [Bj] III 4, V 5.5, or [Me].\n\u221e\nFor a complex variety X we denote by D\u221e or DX\nthe sheaf of differential\noperators of infinite order on X. If X is a curve and U is an open subset with\na coordinate function t, then D\u221e (U ) consists of series \u03a3 an \u2202tn , where an are\nn\u22650\n\nholomorphic functions on U such that for every \u01eb > 0 the series \u03a3an \u01eb\u2212n n! converges\n\u221e\nabsolutely on any compact subset. DX\nis a sheaf of rings that acts on OX in an\n16\n\u221e\nevident manner; it contains DX , and DX\nis a faithfully flat DX -module.\ndimX\nBy Grothendieck and Sato, one can realize D\u221e (U ) as H\u2206(U)\n(U \u00d7 U, O \u22a0 \u03c9)\nwhere \u2206 is the diagonal embedding. If X is a curve and U has no compact components, this means that\nD\u221e (U ) = (O \u22a0 \u03c9)(U \u00d7 U \\ \u2206(U ))/(O \u22a0 \u03c9)(U \u00d7 U ).\n\n(3.2.1)\n\nHere k(x, y) \u2208 (O \u22a0 \u03c9)(U \u00d7 U \\ \u2206(U )) acts on O(U ) as f 7\u2192 k(f ), k(f )(x) :=\nResy=x k(x, y)f (y).\nFor a (left) D-module M set M \u221e := D\u221e \u2297 M . The embedding dR(M ) \u0592\u2192\nD\n\n\u223c\n\n*\n*\ndR(M \u221e ) is a quasi-isomorphism, hence HdR\n(X, M ) \u2192 HdR\n(X, M \u221e ). If M is\n\u223c\n\u221e\nsmooth, then M \u2192 M .\n16 By\n\n\u221e coincides with the sheaf of all C-linear continuous endomorphisms of O .\n[I], DX\nX\n\n\fE-Factors for the Period Determinants of Curves\n\n37\n\nFor a D\u221e -module N a D-structure on N is a D-module M together with a D\u221e \u223c\nisomorphism M \u221e \u2192 N . Our N is said to be holonomic if it admits a D-structure\nwith holonomic M .\nFor a holonomic D-module M the de Rham complex dR(M ) is a perverse Csheaf, which we denote, as above, by B(M ); same for a holonomic D\u221e -module.\nTherefore B(M ) = B(M \u221e ). The functor B is an equivalence between the category\nof holonomic D\u221e -modules and that of perverse C-sheaves. The inverse functor assigns to a perverse sheaf F the D\u221e -module17 OX \u2297! F [dim X]. Thus for a holonomic\nC\n\nM the D\u221e -module M \u221e carries the same information as B(M ).\nThe functor M 7\u2192 M \u221e yields an equivalence between the category of holonomic D-modules with regular singularities and that of holonomic D\u221e -modules.\nIts inverse assigns to a holonomic D\u221e -module N its maximal D-submodule N rs\nwith regular singularities, so one has\n(N rs )\u221e = N.\n\n(3.2.2)\n\nTherefore every holonomic D\u221e -module admits a unique D-structure with regular\nsingularities.\nExercises. Let U be a coordinate disc, t be the coordinate, j be the embedding\nU o := U \\ {0} \u0592\u2192 U .\n(i) Recall a description of indecomposable DU -modules which are smooth of\nrank n on U o and have regular singularity at 0. For s \u2208 C denote by Ms,n a\nD-module whose sections are collections of functions (fi ) = (f1 , . . . , fn ) having\n1\nbe\nmeromorphic singularity at 0, and \u2207\u2202t ((fi )) = (\u2202t (fi ) + sfi + fi\u22121 ).18 Let M0,n\na D-submodule of M0,n formed by (fi ) with f1 regular at 0. Consider an embedding\n1\n3\n2\n/O. E.g.,\n:= M0,n+1\n:= M0,n+1 /O, M0,n\nOU \u0592\u2192 M0,n+1 , f 7\u2192 (0, . . . , 0, f ); set M0,n\n1\n2\nM0,1 = OU , and M0,0 = \u03b4 (the \u03b4-function D-module). Then any indecomposable\na\nDU -module M as above is isomorphic to either some Ms,n , or one of M0,n\n, a =\n1, 2, 3.\nShow that the corresponding D\u221e -module M \u221e has the same explicit description\nwith \"meromorphic singularity\" replaced by \"arbitrary singularity\".\n(ii) For n > 0 let E(n) be a D-module of rank 1 generated by exp(t\u2212n ), i.e.,\nE(n) is generated by a section e subject to the (only) relation tn+1 \u2202t (e) = \u2212ne.\nShow that there is an isomorphism of D\u221e -modules\n\u223c\n\n2\u221e\n\u221e\n\u2192 M0,1\n\u2295 (\u03b4 \u221e )n\u22121 .\nE(n)\n\n(3.2.3)\n\nHere is an explicit formula for (3.2.3). Let g(z), h1 (z), . . . , hn\u22121 (z) be entire functions such that (\u2202z \u2212 nz n\u22121 )g(z) = z \u22122 (exp(z n ) \u2212 1 \u2212 z n) and (\u2202z \u2212 nz n\u22121 )hi (z) =\n2 \u221e\nz i\u22121 . Then (3.2.3) assigns e a vector whose (M0,1\n) -component is (exp(t\u2212n ), g(t\u22121 ))\n\u221e\n\u22121\n2 \u221e\nand the \u03b4 -components are hi (t ) \u2208 (M0,0 ) = \u03b4 \u221e .\n3.3. A digression on Fredholm determinants (cf. [PS] 6.6). Recall that a\nFr\u00e9chet space is a complete, metrizable, locally convex topological C-vector space.\nThe category F of those is a quasi-abelian (hence exact) Karoubian C-category. A\nmorphism \u03c6 : F \u2192 F \u2032 is said to be Fredholm if it is Fredholm as a morphism of\nabstract vector spaces, i.e., if Ker \u03c6 and Coker \u03c6 have finite dimension. Then \u03c6 is\na split morphism, i.e., Ker\u03c6, Im\u03c6 are direct summands of, respectively, F and F \u2032 ,\n17 Here\n18\n\nD \u221e acts via the OX -factor, and F \u2297! G := R\u2206! F \u22a0 G.\n\u223c\nMs,n depends only on s modulo Z-translation: one has Ms,n \u2192 Ms\u22121,n , (fi ) 7\u2192 (tfi ).\n\n\f38\n\nAlexander Beilinson\n\u223c\n\nand F/Ker\u03c6 \u2192 Im\u03c6. Denote by F \u2282 F the subcategory of Fredholm morphisms\nF(F, F \u2032 ) \u2282 Hom(F, F \u2032 ).\nA Fredholm \u03c6 yields the determinant line \u03bb\u03c6 := det(Coker \u03c6)\u2297det\u2297\u22121 (Ker \u03c6) \u2208\n\u03c6\n\nL := LC (see 1.2). Sometimes we denote \u03bb\u03c6 by \u03bb(F \u2032 \u2192 F ) or, if F = F \u2032 , by \u03bb(F )\u03c6 .\nIf \u03c6 is invertible, then \u03bb\u03c6 has an evident trivialization; denote it by det(\u03c6) \u2208 \u03bb\u03c6 .\nFor any Fredholm \u03c6 one can find finite-dimensional F0 \u2282 F , F0\u2032 \u2282 F \u2032 such that\n\u2032\n\u03c6(F0 ) \u2282 F0 and the induced map F \u2032 /F0\u2032 \u2192 F/F0 is an isomorphism (equivalently,\nF0 + \u03c6(F \u2032 ) = F , F0\u2032 = \u03c6\u22121 (F0 )). Then the exact sequence 0 \u2192 Ker\u03c6 \u2192 F0\u2032 \u2192 F0 \u2192\nCoker\u03c6 \u2192 0 yields a natural isomorphism\n\u223c\n\n\u03bb\u03c6 \u2192 det(F0 ) \u2297 det\u2297\u22121 (F0\u2032 ).\n\n(3.3.1)\n\nIf \u03c6 is invertible, then (3.3.1) identifies det(\u03c6) \u2208 \u03bb\u03c6 with the usual determinant of\n\u223c\n\u03c6|F0\u2032 : F0\u2032 \u2192 F0 in Hom(det F0\u2032 , det(F0 )) = det(F0 ) \u2297 det\u2297\u22121 (F0\u2032 ).\n\u03c6\u2032\n\n\u03c6\n\nFor Fredholm F \u2032\u2032 \u2192 F \u2032 \u2192 F there is a canonical \"composition\" isomorphism\n\u223c\n\n\u03bb\u03c6 \u2297 \u03bb\u03c6\u2032 \u2192 \u03bb\u03c6\u03c6\u2032 ,\n\na \u2297 b 7\u2192 ab,\n\n(3.3.2)\n\nwhich satisfies the associativity property. Therefore \u03c6 7\u2192 \u03bb\u03c6 is a (central) Lextension F\u266d of F (see e.g. [BBE], Appendix to \u00a71, for terminology). To construct\n(3.3.2), choose F0 , F0\u2032 , F0\u2032\u2032 for \u03c6, \u03c6\u2032 as above; then (3.3.1) identifies the composition\n\u223c\nwith an evident map det(F0 ) \u2297 det\u2297\u22121 (F0\u2032 ) \u2297 det(F0\u2032 ) \u2297 det\u2297\u22121 (F0\u2032\u2032 ) \u2192 det(F0 ) \u2297\ndet\u2297\u22121 (F0\u2032\u2032 ). For invertible \u03c6, \u03c6\u2032 one has det(\u03c6) det(\u03c6\u2032 ) = det(\u03c6\u03c6\u2032 ).\nSuppose F , F \u2032 are equipped with finite split filtrations F* , F*\u2032 , \u03c6 : F \u2032 \u2192 F\npreserves the filtrations, and gr\u03c6 : grF \u2032 \u2192 grF is Fredholm. Then \u03c6 is Fredholm,\nand there is a canonical isomorphism\n\u223c\n\n\u03bb\u03c6 \u2192 \u2297\u03bbgri \u03c6 .\n\n(3.3.3)\n\nThe identification is transitive with respect to refinement of the filtration. If gr\u03c6\nis invertible, it identifies det(gr\u03c6) = \u2297 det(gri \u03c6) with det(\u03c6). For example, for a\nfinite collection of Fredholm morphisms {\u03c6\u03b1 }, every linear ordering of indices \u03b1\n\u223c\nproduces a filtration, hence an isomorphism \u03bb\u2295\u03c6\u03b1 \u2192 \u2297\u03bb\u03c6\u03b1 ; it does not depend on\nthe ordering.\nLet I fin \u2282 I tr \u2282 I com be the two-sided ideals of finite rank, nuclear, and\ncompact morphisms in F . We have the quotient categories F /I ? : their objects\nare Fr\u00e9chet spaces, and morphisms Hom/I ? (F, F \u2032 ) equal Hom(F, F \u2032 )/I ? (F, F \u2032 ). A\nmorphism \u03c6 is Fredholm if and only if \u03c6 is invertible in either F /I ? . Therefore\nthe groupoids Isom(F /I ? ) of isomorphisms in F /I ? are quotients of F modulo the\nI ? -equivalence relation \u03c6 \u2212 \u03c6\u2032 \u2208 I ? .\nExercise. Let G? (F ) \u2282 Aut(F ) be the (normal) subgroup of automorphisms \u03c8\nof F that are I ? -equivalent to idF . The next sequence is exact:\n1 \u2192 G? (F )/Gfin (F ) \u2192 Aut/I fin (F ) \u2192 Aut/I ? (F ) \u2192 1\n\n(3.3.4)\n\nProposition. F\u266d descends naturally to an L-extension Isom\u266d (F /I tr ) of the groupoid\nIsom(F /I tr ).\nProof. We first descend F\u266d to Isom(F /I fin ), and then to Isom(F /I tr ).\n(i) To descend F\u266d to Isom(F /I fin ), means to define for every I fin -equivalent\n\u223c\n\u03c6, \u03c8 \u2208 F(F, F \u2032 ) a natural identification \u03c4 = \u03c4\u03c6,\u03c8 : \u03bb\u03c6 \u2192 \u03bb\u03c8 which satisfies the\ntransitivity property and is compatible with composition.\n\n\fE-Factors for the Period Determinants of Curves\n\n39\n\nThe condition on \u03c6, \u03c8 means that we can find finite-dimensional F0 \u2282 F , F0\u2032 \u2282\nF such that \u03c6(F0\u2032 ), (\u03c6\u2212 \u03c8)(F \u2032 ) \u2282 F0 , and the map F \u2032 /F0\u2032 \u2192 F/F0 induced by \u03c6 (or\n\u223c\n\u223c\n\u03c8) is an isomorphism. Then \u03c4 is the composition \u03bb\u03c6 \u2192 det(F0 ) \u2297 det\u2297\u22121 (F0\u2032 ) \u2192 \u03bb\u03c8\nof isomorphisms (3.3.1) for \u03c6, \u03c8. The construction does not depend on the choice\nof auxiliary datum, and satisfies the necessary compatibilities.\n(ii) Recall that for \u03c8 \u2208 EndF that is I tr -equivalent to idF , its Fredholm determinant detF (\u03c8) \u2208 C is defined (see e.g. [Gr2]) as the sum of a rapidly converging\nseries\ndetF (\u03c8) := \u03a3 tr\u039bk (\u03c8 \u2212 idF ),\n(3.3.5)\n\u2032\n\nk\u22650\n\nwhere \u039bk (\u03c8 \u2212 idF ) is the kth exterior power of \u03c8 \u2212 idF . If \u03c8 \u2212 idF is of finite rank,\nthen the sum is finite, and detF (\u03c8) is the usual determinant.19\nThe central C\u00d7 -extension Aut\u266d (F ) of Aut(F ) is trivialized by the section \u03c8 7\u2192\ndet(\u03c8). The Fredholm determinant is multiplicative and invariant with respect to\nthe adjoint action of Aut(F ). We get a trivialization \u03c8 7\u2192 \u03c4 an (\u03c8) := det\u22121\nF (\u03c8) det(\u03c8)\nof the C\u00d7 -extension Gtr (F )\u266d which is invariant for the adjoint Aut(F )-action.\nSince for \u03c8 \u2208 Gfin (F ) one has \u03c4 an (\u03c8) = \u03c4idF ,\u03c8 \u2208 \u03bb\u03c8 , our \u03c4 an can be viewed as a\ntrivialization of the extension Aut\u266d/I fin (F ) over the normal subgroup Gtr (F )/Gfin (F ).\nIt is invariant with respect to the adjoint action of Aut/I fin (F ). Thus, by (3.3.4),\n\u03c4 an defines a descent of Aut\u266d/I fin (F ) to an L-extension Aut\u266d/I tr (F ) of Aut/I tr (F ).\nMore generally, for every F, F \u2032 \u2208 F , the set Isom/I fin (F, F \u2032 ) is a\n(Gtr (F \u2032 )/Gfin (F \u2032 ), Gtr (F )/Gfin (F ))-bitorsor over Isom/I tr (F, F \u2032 ), and we define the\nL-extension Isom/I tr (F, F \u2032 )\u266d as the quotient of Isom\u266d/I fin (F, F \u2032 ) by the \u03c4 an -lifting\nof either Gtr (F )/Gfin (F )- or Gtr (F \u2032 )/Gfin (F \u2032 )-action.\n\u0003\nRemark. The above constructions are compatible with constraint (3.3.3).\n3.4. For a topological space X whose topology has countable base, a Fr\u00e9chet\nsheaf on X means a sheaf of Fr\u00e9chet vector spaces. A Fr\u00e9chet algebra A is a sheaf\nof topological algebras which is a Fr\u00e9chet sheaf; a Fr\u00e9chet A-module is a Fr\u00e9chet\nsheaf equipped with a continuous (left) A-action.\nThe problem of finding Fr\u00e9chet structures on a given A-module M is delicate.\nHere is a simple uniqueness assertion. Suppose that M satisfies the next condition:\nthose open subsets U of X that M (U ) is a finitely generated A(U )-module form a\nbase of the topology of X.\nLemma. Every morphism of A-modules \u03c6 : M \u2192 N is continuous with respect to\nany Fr\u00e9chet structures on M , N . Thus M admits at most one Fr\u00e9chet structure.\nProof. It suffices to check that the maps \u03c6U : M (U ) \u2192 N (U ) are continuous for\nall U as above. Thus there is a surjective A(U )-linear map \u03c0U : A(U )n \u0589 M (U ).\nThe maps \u03c0U and \u03c6U \u03c0U are evidently continuous. Since A(U )n /Ker(\u03c0U ) \u2192 M (U )\nis a continuous algebraic isomorphism of Fr\u00e9chet spaces, it is a homeomorphism,\nand we are done.\n\u0003\nExample. Every locally free A-module of finite rank is a Fr\u00e9chet A-module.\nFrom now on our X is a complex curve. The two basic examples of Fr\u00e9chet\n\u221e\nalgebras on X are OX and DX\n. For an open U \u2282 X the topology on the space of\nholomorphic functions O(U ) is that of uniform convergence on compact subsets of\n19 i.e.,\n\ndet(\u03c8|F0 ) where F0 is any finite-dimensional subspace containing the image of \u03c8 \u2212 idF .\n\n\f40\n\nAlexander Beilinson\n\nU . If t is a coordinate function on U , then the topology on D\u221e (U ) is given by a\ncollection of semi-norms ||\u03a3an \u2202tn ||K\u01eb := max \u03a3|an (x)|\u01eb\u2212n n!; here K is any compact\nx\u2208K\n\nsubset of U and \u01eb is any small positive real number. Equivalently, one can use\n(3.2.1): then (O \u22a0 \u03c9)(U \u00d7 U ) is a closed subspace of (O \u22a0 \u03c9)(U \u00d7 U \\ \u2206(U )), and\nthe topology on D\u221e (U ) is the quotient one.\nProposition. Any holonomic D\u221e -module N on X admits a unique structure of a\n\u221e\nFr\u00e9chet DX\n-module.\nProof. Uniqueness: As follows easily from Exercise (i) in 3.2, N satisfies the\ncondition of the previous lemma. Existence: The problem is local, so it suffices to\ndefine some Fr\u00e9chet structure compatible with the D\u221e (U )-action on N (U ), where\nU is a disc and N is smooth outside the center 0 of U . Then N = M \u221e where M is\na D-module with regular singularities; we can assume that M is indecomposable.\n\u223c\nIf M \u2243 Ms,n (see Exercise (i) in 3.2), then, by loc. cit., M \u221e (U ) \u2192 M \u221e (U o ) \u2243\nO(U o )n , and we equip it with the topology of O(U o )n . Otherwise M \u221e (U ) is a\n\u221e\nsubquotient of some M0,n\n(U ), and we equip it with the corresponding Fr\u00e9chet\nstructure.\n\u0003\nQuestion. Can one find a less ad hoc proof (that would not use (3.2.2))? Is\nthe assertion of the proposition remains true for all perfect D\u221e -modules (or perfect\nD\u221e -complexes) on X of any dimension?20\n3.5. Let K \u2282 X be a compact subset which does not contain a connected\ncomponent of X; denote by jK the embedding X \\K \u0592\u2192 X. Let E be a Fr\u00e9chet OX module. Suppose that for some open neighborhood U of K, E|U\\K is a locally free\nOU\\K -module of finite rank. A K-lattice in E is an OX -module L, which is locally\n\u223c\nfree on U , together with an OX -linear morphism L \u2192 E such that L|X\\K \u2192 E|X\\K .\nThen L is a Fr\u00e9chet OX -module, and L \u2192 E is a continuous morphism. Set\n\u0393(E/L) := H 0 R\u0393(X, Cone(L \u2192 E)) = H 0 R\u0393(U, Cone(L \u2192 E)).\nShrinking U if needed, we can assume that the closure \u016a of U is compact with\nsmooth boundary \u2202 \u016a . We denote by \u2202U a contour in U \\ K homologous to the\nboundary of \u016a in \u016a \\ K.\nRemarks. (i) For all our needs it suffices to consider the situation when U is a\ndisjoint union of several discs.\n(ii) If Int(K) 6= \u2205, then the morphism L \u2192 E need not be injective. The map\nL(U ) \u2192 E(U ) is injective though, i.e., H \u22121 R\u0393(U, Cone(L \u2192 E)) = 0.\nExample. If L is any locally free OX -module of finite rank, then L is a K-lattice\nin jK* L := jK* (L|X\\K ).\nProposition. (i) L(U ) is a direct summand of the Fr\u00e9chet space E(U ).\n(ii) If H 1 (U, L) = 0 (which happens, e.g., if none of the connected components of\n\u223c\nU is compact), then E(U )/L(U ) \u2192 \u0393(E/L).\n\u2032\n\u2032\n(iii) Let (E , L ) be a similar pair, and \u03c6 : E \u2032 \u2192 E be any morphism of Fr\u00e9chet\nsheaves. Then the map E \u2032 (U ) \u2192 E(U ), viewed as a morphism in F /I tr , sends the\nsubobject L\u2032 (U ) to L(U ).\n20 For a perfect D \u221e -complex N , [PSch] define a natural ind-Banach structure on its complex\nof solutions RHomD \u221e (N, OX ). It is not clear if this result helps to see the topology on N .\n\n\fE-Factors for the Period Determinants of Curves\n\n41\n\nProof. (i) We want to construct a left inverse to the morphism of Fr\u00e9chet\nspaces L(U ) \u2192 E(U ). It suffices to define a left inverse to the composition L(U ) \u2192\nE(U ) \u2192 E(U \\ K) = L(U \\ K), i.e., to the restriction map L(U ) \u2192 L(U \\ K).\nWe can assume that U is connected and non compact.21 Then one can find\na Cauchy kernel on U \u00d7 U , which is a section \u03ba of L \u22a0 \u03c9L\u2217 (\u2206) with residue at\nthe\nR diagonal equal to \u2212idE . The promised left inverse is f 7\u2192 \u03ba(f ), \u03ba(f )(x) =\n\u03ba(x, y)f (y).\n\u2202U\n\n(ii) Follows from the exact cohomology sequence.\n(iii) We want to check that the composition L\u2032 (U ) \u2192 E \u2032 (U ) \u2192 E(U ) \u2192\nE(U )/L(U ) is nuclear. We can assume that U is connected and non compact.\nChoose an open V \u2283 K whose closure V\u0304 is compact and lies in U . Our map equals\n\u223c\nthe composition L\u2032 (U ) \u2192 L\u2032 (V ) \u2192 E \u2032 (V ) \u2192 E(V ) \u2192 E(V )/L(V ) \u2190 E(U )/L(U )\n\u223c\n(for \u2190, see (ii)). We are done, since the first arrow is nuclear (see e.g. [Gr1]). \u0003\nCorollary. (a) The isomorphism from (ii) yields a natural Fr\u00e9chet space structure\non \u0393(E/L), which does not depend on the auxiliary choice of U .\n(b) Every \u03c6 as in (iii) yields naturally a morphism \u03c6E \u2032 /L\u2032 ,E/L : \u0393(E \u2032 /L\u2032 ) \u2192 \u0393(E/L)\nin F /I tr . In particular, the spaces \u0393(E/L) for all K-lattices L in E are canonically\nidentified as objects of F /I tr .\n\u0003\nProof. (a) follows since, for U \u2032 \u2282 U as in (ii), the restriction map E(U )/L(U ) \u2192\nE(U \u2032 )/L(U \u2032 ) is a continuous algebraic isomorphism, hence a homeomorphism, and\nU 's form a directed set. The first assertion in (b) follows from (iii); for the second\none, consider \u03c6 = idE .\n\u0003\n3.6. The set \u039bK (E) of K-lattices in E has natural structure of an L-groupoid\n(see 2.2). Namely, by the corollary in 3.5, for every L, L\u2032 \u2208 \u039bK (E) one has a\n\u223c\ncanonical identification idE/L,E/L\u2032 : \u0393(E/L) \u2192 \u0393(E/L\u2032 ) in F /I tr . We set\n\u03bbK (L/L\u2032 ) := \u03bbidE/L,E/L\u2032 .\nThe composition\n\n(3.6.1)\n\n\u223c\n\n\u03bbK (L/L\u2032 ) \u2297 \u03bbK (L\u2032 /L\u2032\u2032 ) \u2192 \u03bbK (L/L\u2032\u2032 )\n\n(3.6.2)\ncomes from (3.3.2).\n\u0003\nSuppose \u039bK (E) is non-empty. We get an L-torsor DetK (E) := HomL (\u039bK (E), L)\nof determinant theories on E at K. For E1 , E2 we get an L-torsor DetK (E1 /E2 ) :=\nDetK (E1 ) \u2297 DetK (E2 )\u2297\u22121 of relative determinant theories on E1 /E2 at K.\nIf K = \u2294K\u03b1 , then a K-lattice L amounts to a collection of K\u03b1 -lattices L\u03b1 , and\none has an evident canonical isomorphism\n\u223c\n\n\u2297 \u03bbK\u03b1 (L\u03b1 /L\u2032\u03b1 ) \u2192 \u03bbK (L/L\u2032 )\n\n(3.6.3)\n\ncompatible with composition isomorphisms (3.6.2). Thus one has a canonical iden\u223c\ntification \u2297DetK\u03b1 (E) \u2192 DetK (E), (\u2297\u03bb\u03b1 )(L) = \u2297\u03bb\u03b1 (L\u03b1 ).\nBelow we fix a neighborhood U of K as in 3.5; we assume that it has no compact\ncomponents, so for every K-lattice L the O(U )-module L(U ) is free.\n\u039bK (E) carries a natural topology of compact convergence on U \\ K. Namely,\nto define a neighborhood of L we pick an O(U )-base {li } of L(U ), a compact\n21 If U is compact, then L(U ) is finite dimensional, and the assertion follows from the HahnBanach theorem.\n\n\f42\n\nAlexander Beilinson\n\nC \u2282 U \\ K and a number \u01eb > 0. The neighborhood is formed by those L\u2032 which\nadmit a base {l\u2032i } of L\u2032 (U ), l\u2032i = \u03a3aij li , with (aij ) \u01eb-close to the unit matrix on C.\nThe L-groupoid structure on \u039bK (E) is continuous, i.e., \u03bbK form naturally a\nline bundle on \u039bK (E) \u00d7 \u039bK (E), and the composition is continuous (cf. [PS] 6.3,\n7.7). Namely, if P is a closed linear subspace of E(U ), then the subset \u039bP\nK (E) of\n\u223c\nthose K-lattices L that L(U ) is complementary to P , i.e., P \u2192 \u0393(E/L), is open\ntr\nin \u039bK (E). For L, L\u2032 \u2208 \u039bP\nis represented\nK (E) the morphism idE/L,E/L\u2032 in F /I\nP\nP\nby idP , hence the restriction of \u03bbK to \u039bK (E) \u00d7 \u039bK (E) is trivialized by the section\n\u03b4 P := det(idP ). The topology on \u03bbK is uniquely determined by the condition that\nall these local trivializations are continuous, and the composition is continuous.\nRemarks. (i) If K \u2032 is a compact such that K \u2282 K \u2032 \u2282 U , then every K-lattice\nL in E is a K \u2032 -lattice, and \u03bbK \u2032 (L/L\u2032 ) = \u03bbK (L/L\u2032 ). Hence DetK (E) = DetK \u2032 (E).\n(ii) By (iii) of the proposition in 3.5, the subobjects L(U ), L\u2032 (U ) of E(U ) coin\u223c\ncide if viewed in F /I tr . Let \u03c6U : L(U ) \u2192 L\u2032 (U ) be the corresponding isomorphism\ntr\nin F /I . Then there is a canonical identification\n\u223c\n\n\u03bbK (L/L\u2032 ) \u2192 \u03bb\u2297\u22121\n\u03c6U\n\n(3.6.4)\n\ncompatible with the composition maps. Indeed, by (3.3.3) and Remark at the end of\n\u223c\n3.3 applied to the filtrations L(\u2032) \u2282 E(U ), one has \u03bbidE/L,E/L\u2032 \u2297 \u03bb\u03c6U \u2192 \u03bbidE(U ) = C.\n*\n(iii) Every K-lattice L in E can be viewed as a K-lattice in jK* E := jK* jK\nE (via\n\u2032\nL \u2192 E \u2192 jK* E). Then (3.6.4) shows that \u03bbK (L/L ) does not depend on whether\nwe consider L, L\u2032 as K-lattices in E or in jK* E. Thus DetK (E) = DetK (jK* E).\n(iv) Let S be an analytic space, LS be an S-family of K-lattices in E.22 Then\nthe pull-back of \u03bbK to S \u00d7 S is naturally a holomorphic line bundle, so that the\npull-back to S of any local trivialization \u03b4 P is holomorphic.\n(v) If L, L\u2032 are meromorphically equivalent, then \u03bbK (L/L\u2032 ) coincides with the\nrelative determinant line from 2.3 (where P is a finite subset in K such that L\nequals L\u2032 off P ). Indeed, in view of (3.6.2), it suffices to identify the lines in case\n\u223c\nL \u2283 L\u2032 , where the identification comes from L(U )/L\u2032 (U ) \u2192 \u0393(U, L/L\u2032). If L, L\u2032\nvary holomorphically as in (iv), then this identification is holomorphic.\n(vi) For every f \u2208 O\u00d7 (U \\ K) the lines \u03bbK (f L/L) for all L \u2208 \u039bK (jK* E)\n\u223c\nare canonically identified. Namely, one defines the isomorphism \u03bbK (f L\u2032 /L\u2032 ) \u2192\n\u223c\n\u223c\n\u03bbK (f L/L) as \u03bbK (f L\u2032 /L\u2032 ) \u2192 \u03bbK (f L\u2032 /f L)\u2297\u03bbK (f L/L)\u2297\u03bbK (L\u2032 /L)\u2297\u22121 \u2192 \u03bbK (f L/L)\nwhere the first arrow is inverse to the composition, and the second comes from the\n\u223c\nmultiplication by f identification \u03bbK (L\u2032 /L) \u2192 \u03bbK (f L\u2032 /f L).\n(vii) Let g \u2208 O\u00d7 (U ) be an invertible function. The multiplication by g automorphism of E|U preserves every K-lattice. Let g(L/L\u2032 ) \u2208 C\u00d7 be the corresponding\nautomorphism of \u03bbK (L/L\u2032 ).\nExample. Suppose that \u03bbK (L/L\u2032 ) has degree 0. Choose a Fr\u00e9chet isomorphism\n\u223c\n\u03b1 : \u0393(E/L) \u2192 \u0393(E/L\u2032 ) which represents idE/L,E/L\u2032 . Then g(L/L\u2032 ) is the Fred\u22121\nholm determinant detF (\u03b1\u22121 gE/L\u2032 \u03b1gE/L\n), where gE/L , gE/L\u2032 are multiplication by\n\u2032\ng automorphisms of \u0393(E/L), \u0393(E/L ).\nHere is a formula for g(L/L\u2032 ) (cf. [PS] 6.7, [SW] 3.6). Consider the line bundle\ndet E|U\\K . Then L \u2208 \u039bK (jK* E) yields a K-lattice det L|U \u2208 \u039bK (jK* det E|U\\K ).\nWe can assume that U has no compact components. Then the line bundle det L|U\n22 I.e., L is an O\nS\nXS -module together with a morphism L \u2192 ES such that LS is locally free\non US , and L \u2192 ES is an isomorphism off KS .\n\n\fE-Factors for the Period Determinants of Curves\n\n43\n\nis trivial; let \u03b8L be any its trivialization. For two lattices L, L\u2032 we get a function\n\u03b8L /\u03b8L\u2032 \u2208 O\u00d7 (U \\ K). Consider the analytic symbol {g, \u03b8L\u2032 /\u03b8L } \u2208 H 1 (U \\ K, C\u00d7 ).\nThen (see 3.5 for the notation \u2202U )\ng(L/L\u2032) = {g, \u03b8L\u2032 /\u03b8L }(\u2202U ).\n\n(3.6.5)\n\nTo check (3.6.5), consider first the case when L, L\u2032 are meromorphically equivalent.\nThen \u03b8L\u2032 /\u03b8L is a meromorphic function on U , and both parts of (3.6.5) evidently\ncoincide with g(div(\u03b8L\u2032 /\u03b8L )). The general case follows since for any L, L\u2032 one can\nfind (possibly enlarging K, as in (ii)) an L\u2032\u2032 meromorphically equivalent to L which\nis arbitrary close to L\u2032 , and both parts of (3.6.5) depend continuously on L\u2032 .\n3.7. Let N be a holonomic D\u221e -module on X. By 3.4, it carries a canonical\nFr\u00e9chet structure. For K as in 3.5, 3.6, let us define a relative determinant theory\n\u2207\n\u03bc\u2207\nK = \u03bc(N/\u03c9N )K \u2208 DetK (N/\u03c9N ) (cf. 2.4).\nIf L, L\u03c9 are K-lattices in N , \u03c9N such that \u2207(L) \u2282 L\u03c9 , then \u2207 yields a\nmorphism of sheaves N/L \u2192 \u03c9N/L\u03c9 , and we denote by C(L, L\u03c9 )N,K its cone.\n\u223c\nExample. Let M \u221e \u2192 N be a D-structure on N (see 3.2), and P be any finite\nsubset of K such that M is smooth on K \\P . Every P -lattices L, L\u03c9 in M , \u03c9M can\nbe viewed as K-lattices in N , \u03c9N . If \u2207(L) \u2282 L\u03c9 , then we get an evident morphism\nof complexes of sheaves (see 2.4)\nC(L, L\u03c9 )M,P \u2192 C(L, L\u03c9 )N,K .\n\n(3.7.1)\n\nProposition. (3.7.1) is a quasi-isomorphism.\nProof. Our complexes are supported on a finite set P , so it suffices to check that\n\u2207\nR\u0393(X, (3.7.1)) is a quasi-isomorphism. Notice that dR(L, L\u03c9 ) := Cone(L \u2192 L\u03c9 ) is\na subcomplex of both dR(M ) and dR(N ), and C(L, L\u03c9 )M,P = dR(M )/dR(L, L\u03c9 ),\nC(L, L\u03c9 )N,T \u2032 = dR(N )/dR(L, L\u03c9 ). Since dR(M ) \u2192 dR(N ) is a quasi-isomorphism\n(see 3.2), we are done.\n\u0003\nBy the corollary in 3.5, for K-lattices L, L\u03c9 in N , \u03c9N one has a F /I tr morphism\n\u2207N/L,\u03c9N/L\u03c9 : \u0393(N/L) \u2192 \u0393(\u03c9N/L\u03c9 ).\n\n(3.7.2)\n\nCorollary. (3.7.2) is a Fredholm map.\nProof. By loc. cit., the validity of the assertion does not depend on the choice\nof L, L\u03c9 . So we can assume to be in the situation of Example, and we are done by\n2.4 and the proposition.\n\u0003\n\u2208\nDet\n(N/\u03c9N\n)\nas\na\nrelative\ndeterminant\ntheory\nsuch\nthat\nfor\nWe define \u03bc\u2207\nK\nK\nany L \u2208 \u039bK (N ), L\u03c9 \u2208 \u039bK (\u03c9N ) one has\n\u03bc\u2207\nK (L/L\u03c9 ) := \u03bb\u2207N/L,\u03c9N/L\u03c9 ,\n\n(3.7.3)\n\u223c\n\n\u2032\n\u2207\n\u2032\n\u2032\nand the structure isomorphisms \u03bbK (L\u2032 /L)\u2297\u03bc\u2207\nK (L/L\u03c9 )\u2297\u03bbK (L\u03c9 /L\u03c9 ) \u2192 \u03bcK (L /L\u03c9 )\nare compositions (3.3.2) for idN/L\u2032 ,N/L \u2207N/L,\u03c9N/L\u03c9 id\u03c9N/L\u03c9 ,\u03c9N/L\u2032\u03c9 = \u2207N/L\u2032 ,\u03c9N/L\u2032\u03c9 .\n\n\f44\n\nAlexander Beilinson\n\n3.8. Let \u03bd be any invertible holomorphic 1-form defined on U \\ K, where U as\n\u223c\nin 3.5. The multiplication by \u03bd isomorphism jK* N |U \u2192 jK* \u03c9N |U yields an identifi\u223c\ncation of the L-groupoids \u039bK (jK* N ) \u2192 \u039bK (jK* \u03c9N ), hence a relative determinant\ntheory (see Remark (iii) in 3.6)\n\u03bc\u03bdK = \u03bc(N/\u03c9N )\u03bdK \u2208 DetK (jK* N/jK* \u03c9N ) = DetK (N/\u03c9N ).\n\n(3.8.1)\n\nSet\n\n\u03bd \u2297\u22121\nEdR (N )(K,\u03bd) := \u03bc\u2207\n\u2208 L.\nK \u2297 (\u03bcK )\nThus for every L \u2208 \u039bK (jK* N ) one has a canonical isomorphism\n\n(3.8.2)\n\n\u223c\n\nEdR (N )(K,\u03bd) \u2192 \u03bc\u2207\nK (L/\u03bdL);\n\n(3.8.3)\n\u223c\n\n\u2207\n\u2032\n\u2032\nfor two lattices L, L\u2032 the corresponding identification \u03bc\u2207\nK (L/\u03bdL) \u2192 \u03bcK (L /\u03bdL ) is\n\u223c\n\n\u223c\n\n\u2032\n\u2032\n\u2032\n\u2032\n\u2032 \u2297\u22121\n\u2032\n\u2207\n\u2192 \u03bc\u2207\n\u03bc\u2207\nK (L /\u03bdL ), (3.8.4)\nK (L/\u03bdL) \u2190 \u03bbK (L/L ) \u2297 \u03bcK (L /\u03bdL ) \u2297 \u03bbK (\u03bdL/\u03bdL )\n\nwhere the first arrow is the composition, the second one comes from the multipli\u223c\ncation by \u03bd identification \u03bbK (L/L\u2032 ) \u2192 \u03bbK (\u03bdL/\u03bdL\u2032 ).\nThe construction does not depend on the auxiliary choice of U . When \u03bd varies\nholomorphically, EdR (N )(K,\u03bd) form a holomorphic line bundle on the parameter\nspace (by (3.8.2) and Remark (vi) in 3.6). If K = \u2294K\u03b1 , then (3.6.3) yields a\nfactorization (here \u03bd\u03b1 are the restrictions of \u03bd to neighborhoods of K\u03b1 )\n\u223c\n\n\u2297 EdR (N )(K\u03b1 ,\u03bd\u03b1 ) \u2192 EdR (N )(K,\u03bd) .\n\n(3.8.5)\n\n3.9. The above constructions are compatible with those from 2.5. Precisely,\nlet M , P be as in Example in 3.7, and suppose that \u03bd is meromorphic on U with\nD := div(\u03bd) supported on P . Then \u039bP (M ) \u2282 \u039bK (N ), \u039bP (M (\u221eP )) \u2282 \u039bK (jK* N )\n(see loc. cit.). These embeddings are naturally compatible with the L-groupoid\nstructures, so\nDetP (M ) = DetK (M ),\n\nDetP (M/\u03c9M ) = DetK (N/\u03c9N ).\n\n(3.9.1)\n\nBy the proposition in 3.7, (3.7.1) provides an identification\n\u223c\n\n\u2207\n\u03bc\u2207\nP (M/\u03c9M ) \u2192 \u03bcK (N/\u03c9N ).\n\n(3.9.2)\n\n\u223c\n\nJoint with an evident isomorphism \u03bc\u03bdP (M/\u03c9M ) \u2192 \u03bc\u03bdK (N/\u03c9N ), it yields\n\u223c\n\nEdR (M )(D,c,\u03bdP ) \u2192 EdR (N )(K,\u03bd) .\n\n(3.9.3)\n\nIf \u03bd varies holomorphically, then (3.9.3) is holomorphic.\n\u223c\n\n3.10. Proof of the theorem in 3.1. By 3.2, \u03c6 : B(M ) \u2192 B(M \u2032 ) amounts to an\n\u223c\nisomorphism of D\u221e -modules M \u221e \u2192 M \u2032\u221e . Threfore we can view M and M \u2032 as\ntwo D-structures on a holonomic D\u221e -module N . Choose the multiplicity of T to\nbe compatible with both M and M \u2032 (see 2.1). We want to define an isomorphism\n\u223c\n\u03c6\u01eb : EdR (M ) \u2192 EdR (M \u2032 ) in L\u03a6\ndR (X, T ).\nLet S be an analytic space, (D, c, \u03bdP ) \u2208 D\u22c4 (S) (see 1.1). We work locally\non S, so we have T c \u2282 T . Choose a compact K, its open neighborhood U ,\nand a meromorphic \u03bd on US such that K, U satisfy the conditions from 3.5,\nP \u2282 KS , D = \u2212 div(\u03bd), and \u03bdP = \u03bd|P . We define \u03c6\u01eb at (D, c, \u03bdP ) as the com\u223c\n\u223c\n\u223c\nposition EdR (M )(D,c,\u03bdP ) \u2192 EdR (N )(K,\u03bd) \u2190 EdR (M \u2032 )(D,c,\u03bdP ) ; here \u2192 are (3.9.3).\n\u2032\n\u2032\n\u01eb\nEquivalently, choose L \u2208 \u039bP (M ), L \u2208 \u039bP (M ); then \u03c6 is the composition\n\u223c\n\u223c\n\u223c\n\u2032\n\u2032\n\u2032\n\u2207\nEdR (M )(D,c,\u03bdP ) \u2192 \u03bc\u2207\nK (L/\u03bdL) \u2192 \u03bcK (L /\u03bdL ) \u2190 EdR (M )(D,c,\u03bdP ) , the first and\nthe last arrows are compositions of (3.9.2) and (2.5.6), the middle one is (3.8.4).\n\n\fE-Factors for the Period Determinants of Curves\n\n45\n\nThe last description shows that \u03c6\u01eb does not depend on the auxiliary choice\nof \u03bd. Indeed, \u03bd is defined up to multiplication by an invertible function g on U\nwhich equals 1 on P . By (3.8.4), replacing \u03bd by g\u03bd multiplies the isomorphism\n\u223c\n\u2207\n\u2032\n\u2032\n\u2032\n\u03bc\u2207\nK (L/\u03bdL) \u2192 \u03bcK (L /\u03bdL ) by g(L/L ) (see Remark (vii) in 3.6). Since T is com\u2032\npatible with M and M , the 1-form d log(\u03b8L\u2032 /\u03b8L ) (see loc. cit.) has pole at P of\norder \u2264 the multiplicity of P , so (3.6.5) implies that g(L/L\u2032 ) = 1.\nThe construction is compatible with factorization, so we have defined \u03c6\u01eb as\n\u2032\n\u01eb\nisomorphism in L\u03a6\nO (X, T ). One has M |X\\T = M |X\\T , and \u03c6 |X\\T is the corresponding evident identification. By the corollary in 1.12, this implies that \u03c6\u01eb is\nhorizontal, i.e., it is an isomorphism in L\u03a6\ndR (X, T ).\nThe compatibility of \u03c6\u01eb with constraints from 2.8 is evident. Finally, the commutativity of (3.1.1) follows from the next proposition:\n\n3.11. Proposition. Suppose that X is compact, N is a holonomic D\u221e -module\nsmooth on X \\ K, and \u03bd is a holomorphic invertible 1-form on X \\ K. Then there\nis a canonical isomorphism\n\u223c\n\n\u03b7dR : EdR (N )(K,\u03bd) \u2192 det R\u0393dR (X, N ).\n\n(3.11.1)\n\nIf \u03bd is meromorphic and M is a D-structure on N , then the next diagram of isomorphisms commutes (see 1.4 and 2.7 for the left column, the top arrow is (3.9.2)):\n\u223c\n\n\u2192\nEdR (N )(K,\u03bd)\nEdR (M )\u03bd\n\u03b7dR \u2193\n\u03b7dR \u2193\n\u223c\n*\n*\n(X, N ).\n(X, M ) \u2192 det HdR\ndet HdR\n\n(3.11.2)\n\nProof (cf. 2.7). For L \u2208 \u039bK (jK* N ) set \u03bb(L) := det R\u0393(X, L). Then \u03bb is a\ndeterminant theory on jK* N at K in an evident way. Replacing N by \u03c9N , we\nget \u03bb\u03c9 \u2208 DetK (jK* \u03c9N ), hence \u03bb \u2297 \u03bb\u2297\u22121\n\u2208 DetK (jK* N/jK* \u03c9N ). One has an\n\u03c9\nisomorphism\n\u223c\n\n,\n\u03bc\u03bdK \u2192 \u03bb \u2297 \u03bb\u2297\u22121\n\u03c9\n\n(3.11.3)\n\u223c\n\nnamely, \u03bc\u03bdK (L/L\u03c9 ) := \u03bbK (\u03bdL/L\u03c9 ) = \u03bb\u03c9 (\u03bdL) \u2297 \u03bb\u03c9 (L\u03c9 )\u2297\u22121 \u2192 \u03bb(L) \u2297 \u03bb\u03c9 (L\u03c9 )\u2297\u22121 =\n\u223c\n\u223c\n(\u03bb \u2297 \u03bb\u2297\u22121\n)(L/L\u03c9 ) where \u2192 comes from the isomorphism \u03bd \u22121 : \u03bdL \u2192 L.\n\u03c9\nFor K-lattices L in N , L\u03c9 in N\u03c9 such that \u2207(L) \u2282 L\u03c9 , set dR(L, L\u03c9 ) :=\n\u2207\nCone(L \u2192 L\u03c9 ). Since dR(N )/dR(L, L\u03c9 ) = C(L, L\u03c9 ), our dR(N ) carries a 3-step\nfiltration with successive quotients L\u03c9 , L, C(L, L\u03c9 ). Applying det R\u0393, we get an\nisomorphism\n\u223c\n\ndet R\u0393(X, C(L, L\u03c9 )) \u2297 \u03bb(L)\u2297\u22121 \u2297 \u03bb(L\u03c9 ) \u2192 det R\u0393dR (X, N ).\n\n(3.11.4)\n\nTo get \u03b7dR , we combine (3.11.4) with (3.11.3) (and (3.7.3)). The construction does\nnot depend on the auxiliary choice of L, L\u03c9 .\n\u0003\n4 The Betti \u03b5-line\nWe present a construction from [B] in a format adapted for the current subject.\nIn 4.2\u20134.5 X is considered as a mere real-analytic surface.\n\n\f46\n\nAlexander Beilinson\n\n4.1. Let L be any Picard groupoid. For a (non-unital) Boolean algebra23 C, an\nL-valued measure \u03bb on C is a rule that assigns to every S \u2208 C an object \u03bb(S) \u2208 L,\nand to every finite collection {S\u03b1 } of pairwise disjoint elements of C an identification\n\u223c\n\u2297\u03bb(S\u03b1 ) \u2192 \u03bb(\u222aS\u03b1 ) (referred to as integration); the latter should satisfy an evident\ntransitivity property. Such \u03bb form naturally a Picard groupoid M(C, L).\nRemarks. (i) For an abelian group A denote by M(C, A) the group of Avalued measures on C. Then \u03c01 (M(C, L)) = M(C, \u03c01 (L)), and one has a map\n\u03c00 (M(C, L)) \u2192 M(C, \u03c00 (L)) which assigns to [\u03bb] a \u03c00 (L)-valued measure |\u03bb|,\n|\u03bb|(S) := [\u03bb(S)] (see 1.1 for the notation).\n(ii) Let I \u2282 C be an ideal. Then M(C/I, L) identifies naturally with the Picard\ngroupoid of pairs (\u03bb, \u03c4 ) where \u03bb \u2208 M(C, L) and \u03c4 is a trivialization of its restriction\n\u223c\n\u03bb|I to I, i.e., an isomorphism 1M(I,L) \u2192 \u03bb|I in M(I, L).\n(iii) Suppose C is finite, i.e., C = (Z/2)T := the Boolean algebra of all subsets\nof a finite set T . Then an L-valued measure \u03bb on C is the same as a collection of\n\u223c\nobjects \u03bbt = \u03bb({t}), t \u2208 T . Thus M(T, L) := M(Z/2T , L) \u2192 LT .\n4.2. For an open U \u2282 X we denote by C(U ) the (non-unital) Boolean algebra\nof relatively compact subanalytic subsets of U . For U \u2032 \u2282 U one has C(U \u2032 ) \u2282 C(U ),\nand U 7\u2192 M(C(U ), L) is a sheaf of Picard groupoids on X.\nFor a commutative ring R, let LR be the Picard groupoid of Z-graded super\nR-lines. Its objects are pairs L = (L, deg(L)) where L is an invertible R-module,\ndeg(L) a locally constant Z-valued function on SpecR; the commutativity constraint\nis \"super\" one. Every perfect R-complex F yields a graded super line det F \u2208\nLR . For a finite filtration F* on F by perfect subcomplexes, one has a canonical\n\u223c\nisomorphism det F \u2192 \u2297 det gri F ; it satisfies transitivity property with respect to\nrefinement of the filtration. For a finite collection {F\u03b1 }, every linear ordering of \u03b1's\n\u223c\nyields a filtration on \u2295F\u03b1 , and the corresponding isomorphism det \u2295F\u03b1 \u2192 \u2297 det F\u03b1\nis independent of the ordering; thus det is a symmetric monoidal functor.\nLet F = FU be a perfect constructible complex of R-sheaves on U . Then for\nevery locally closed subanalytic subset iC : C \u0592\u2192 U the R-complex R\u0393(C, Ri!C F ) is\nperfect, so we have det R\u0393(C, Ri!C F ) \u2208 LR .\nSuppose we have a finite closed subanalytic filtration24 C\u2264* on C (therefore\nCi := C\u2264i \\ C\u2264i\u22121 are locally closed and form a partition of C). It yields a finite filtration25 on R\u0393(C, Ri!C F ) with gri R\u0393(C, Ri!C F ) = R\u0393(Ci , Ri!Ci F ), hence an\nidentification\n\u223c\n(4.2.1)\n\u2297 det R\u0393(Ci , Ri!Ci F ) \u2192 det R\u0393(C, Ri!C F ).\nIt satisfies transitivity property with respect to refinement of the filtration.\nLemma. There is a unique (up to a unique isomorphism) pair (\u03bb(F ), \u03b9), where\n\u03bb(F ) \u2208 M(C(U ), LR ), \u03b9 is a datum of isomorphisms\n\u223c\n\n\u03b9C : \u03bb(F )(C) \u2192 det R\u0393(C, Ri!C F )\n23 Recall that a Boolean algebra is the same as a commutative Z/2-algebra each of whose\nelements is idempotent; the basic Boolean operations are x \u2229 y = xy, x \u222a y = x + y + xy; elements\nx, y are said to be disjoint if x \u2229 y = 0. The Boolean algebras we meet are already realized as\nBoolean algebras of subsets of some set.\n24 I.e., each C\n\u2264i is a subanalytic subset closed in C.\n25 A filtration on an object C of a derived category is an object of the corresponding filtered\nderived category identified with C after the forgetting of the filtration.\n\n\fE-Factors for the Period Determinants of Curves\n\n47\n\ndefined for any locally closed C, such that for every filtration C\u2264* on C as above, \u03b9\n\u223c\nidentifies (4.2.1) with the integration \u2297 \u03bb(F )(Ci ) \u2192 \u03bb(F )(C).\nProof. Suppose we have a compact subanalytic subset of U equipped with a\nsubanalytic stratification whose strata C\u03b1 are smooth and connected. The strata\ngenerate a Boolean subalgebra C({C\u03b1 }) of C(U ); call a subalgebra of such type nice.\nEvery finite subset of C(U ) lies in a nice subalgebra; in particular, the set of nice\nsubalgebras is directed. To prove the lemma, it suffice to define the restriction of\n(\u03bb(F ), \u03b9) to every nice C({C\u03b1 }); their compatibility is automatic.\nBy Remark (iii) in 4.1, \u03bb(F )|C({C\u03b1 }) is the measure defined by condition\n\u03bb(F )(C\u03b1 ) = det R\u0393(C\u03b1 , Ri!C\u03b1 F ). For a locally closed C in C({C\u03b1 }) one defines\n\u03b9C using (4.2.1) for a closed filtration on C whose layers are strata of increasing\ndimension; its independence of the choice of filtration follows since det is a symmetric monoidal functor in the way described above. The compatibility with (4.2.1) is\nchecked by induction by the number of strata involved.\n\u0003\nExample. Suppose C \u2032 , C \u2032\u2032 \u2208 C(U ) are such that C \u2032 , C \u2032\u2032 , and C := C \u2032 \u222a C \u2032\u2032 are\nlocally closed, C \u2032 \u2229 C \u2032\u2032 = \u2205. By the lemma, there is a canonical isomorphism\n\u223c\n\ndet R\u0393(C \u2032 , Ri!C \u2032 F ) \u2297 det R\u0393(C \u2032\u2032 , Ri!C \u2032\u2032 F ) \u2192 det R\u0393(C, Ri!C F ).\n\n(4.2.2)\n\nIf, say, C \u2032 is closed in C, then this is (4.2.1) for the filtration C \u2032 \u2282 C. To construct\n(4.2.2) when neither C \u2032 nor C \u2032\u2032 are closed (e.g. C = X is a torus, and C \u2032 , C \u2032\u2032 are\nnon-closed annuli), consider a 3-step closed filtration C \u2032 \u2282 C\u0304 \u2032 \u2282 C, where C\u0304 \u2032 is the\nclosure of C \u2032 in C; set P := C\u0304 \u2032 \\ C \u2032 = C\u0304 \u2032 \u2229 C \u2032\u2032 , Q := C \\ C\u0304 \u2032 = C \u2032\u2032 \\ P . By (4.2.1),\n\u223c\ndet R\u0393(C \u2032 , Ri!C \u2032 F ) \u2297 det R\u0393(P, Ri!P F ) \u2192 det R\u0393(C\u0304 \u2032 , Ri!C\u0304 \u2032 F ), det R\u0393(P, Ri!P F ) \u2297\n\u223c\ndet R\u0393(Q, Ri!Q F ) \u2192 det R\u0393(C \u2032\u2032 , Ri!C \u2032\u2032 F ), and det R\u0393(C\u0304 \u2032 , Ri!C\u0304 \u2032 F )\u2297det R\u0393(Q, Ri!Q F )\n\u223c\n\u2192 det R\u0393(C, Ri!C F ). Combining them, we get (4.2.2).\n4.3. Let U \u2282 X be an open subset, and N = NU \u2282 TU be a continuous family\nof proper cones in the tangent bundle (so for each x \u2208 U the fiber Nx is a proper\nclosed sector with non-empty interior in the tangent plane Tx ). For an open V \u2282 U\nwe denote by NV the restriction of N to V .\nOne calls C \u2208 C(U ) an N -lens if it satisfies the next two conditions:\n(a) Every point in U has a neighborhood V such that C \u2229 V = C1 \\ C2 where\nC1 , C2 are closed subsets of V that are invariant with respect to some family of\nproper cones NV\u2032 \u22d1 NV .26\n(b) There is a C 1 -function f defined on a neighborhood V of the closure C\u0304 such\nthat for every x \u2208 V and a non-zero \u03c4 \u2208 Nx one has \u03c4 (f ) > 0.\nLet I(U, N ) \u2282 C(U ) be the Boolean subalgebra generated by all N -lenses.\nBasic properties of lenses (see [B] 2.4, 2.7): (i) Every N -lens C is locally closed,\nand Int C is dense in C; the intersection of two N -lenses is an N -lens.\n(ii) Every point in U admits a base of neighborhoods formed by N -lenses.\n(iii) Suppose we have an N -lens C and a (finite) partition {C\u03b1 } of C with C\u03b1 \u2208\nI(U, N ). Then there exists a finer partition {C1 , . . . , Cn } of C such that Ci are\nN -lenses and each subset C\u2264i := C1 \u222a C2 \u222a . . . \u222a Ci is closed in C.\nExercise. Every C \u2208 C(U ) that satisfies (a) lies in I(U, N ).\n26 Here \u22d1 means that Int N \u2032 \u2283 N \\ {0}, and N \u2032 -invariance of C means that every C 1 -arc\ni\nV\nV\nV\nd\n\u03b3 : [0, 1] \u2192 V such that \u03b3(0) \u2208 Ci and dt\n\u03b3(t) \u2208 NV\u2032 \\ {0} for every t, lies in Ci .\n\n\f48\n\nAlexander Beilinson\n\nSuppose F from 4.2 is locally constant (say, a local system of finitely generated\nprojective R-modules). Then for any N -lens C one has R\u0393(C, Ri!C F ) = 0 (see [B]\n\u223c\n2.5). Let \u03c4C : 1 \u2192 \u03bb(F )(C) be the corresponding trivialization of the determinant.\nProposition. The restriction of \u03bb(F ) to I(U, N ) admits a unique trivialization\n\u223c\n\u03c4N : 1M(I(U,N ),LR ) \u2192 \u03bb(F )|I(U,N ) such that for every N -lens C the trivialization\n\u03c4N C coincides with \u03c4C .\nProof. By (iii) above, every finite subset of I(U, N ) lies in the Boolean subalgebra generated by a finite subset of pairwise disjoint N -lenses. This implies\nuniqueness. To show that \u03c4N exists, it suffices to check the next assertion: For\nany N -lens C and any finite partition {C\u03b1 } of C by N -lenses the integration\n\u223c\n\u2297\u03bb(F )(C\u03b1 ) \u2192 \u03bb(F )(C) identifies \u2297\u03c4C\u03b1 with \u03c4C .\nChoose {C1 , . . . , Cn } as in (iii) above. Since C\u2264* is a closed filtration, the\n\u223c\nintegration \u2297\u03bb(F )(Ci ) \u2192 \u03bb(F )(C) identifies \u2297\u03c4Ci with \u03c4C (see the lemma in 4.2),\n\u223c\nand for each \u03b1 the integration \u2297\u03bb(F )(Ci \u2229 C\u03b1 ) \u2192 \u03bb(F )(C\u03b1 ) identifies \u2297\u03c4Ci \u2229C\u03b1\nwith \u03c4C\u03b1 . The partition {Ci } is finer than {C\u03b1 }, so we are done by the transitivity\nof integration.\n\u0003\n4.4. Let K be a compact subset of X, W be an open subset that contains K,\nU := W \\ K. For N = NU as above, let C(W, N ) be the set of C \u2208 C(W ) that\nsatisfy the next two conditions:\n(a) For every C \u2032 \u2208 I(U, N ) one has C \u2229 C \u2032 \u2208 I(U, N ).\n(b) One has Int(C) \u2229 K = C\u0304 \u2229 K.\nThen C(W, N ) is a Boolean subalgebra of C(W ), and I(U, N ) is an ideal in it.\nExercise. Let K \u2032 be a subset of K which is open and closed in K. Choose\nan open relatively compact subset V of W such that V \u2229 K = V\u0304 \u2229 K = K \u2032 , and\nC \u2032 \u2208 I(U, N ) such that C \u2032 \u2283 \u2202V := V\u0304 \\ V . Then C := V \\ C \u2032 \u2208 C(W, N ) and\nC \u2229 K = K \u2032.\nDenote by C[K] the Boolean algebra of subsets of K which are open and closed\nin K. By (b), we have a morphism of Boolean algebras C(W, N ) \u2192 C[K], C 7\u2192\nC \u2229 K. It yields an identification\n\u223c\n\nC(W, N )/I(U, N ) \u2192 C[K].\n\n(4.4.1)\n\nLet F = FW be a perfect constructible complex of R-sheaves on W whose restriction to U is locally constant. By the proposition in 4.3, we have a trivialization\n\u03c4N of the restriction of \u03bb(F ) to I(U, N ). By Remark (ii) in 4.1, (4.4.1), the pair\n(\u03bb(F )|C(W,N ) , \u03c4N ) can be viewed as a measure E(F )N \u2208 M(C[K], LR ). If K is finite,\nthen, by Remark (iii) in 4.1, it amounts to a collection of lines E(F )(b,N ) := E(F )N b ,\nb \u2208 K.\nIf C \u2208 C(W, N ) is locally closed, then we have identifications\n\u223c\n\n\u223c\n\nE(F )N (C \u2229 K) \u2192 \u03bb(F )(C) \u2192 det R\u0393(C, Ri!C F ).\n\n(4.4.2)\n\nIn particular, if X is compact and W = X, then X \u2208 C(X, N ), and\n\u223c\n\nE(F )N (K) \u2192 det R\u0393(X, F ).\n\n(4.4.3)\n\nIf K is finite, this is a product formula\n\u223c\n\n\u2297 E(F )(b,N ) \u2192 det R\u0393(X, F ).\n\nb\u2208K\n\n(4.4.4)\n\n\fE-Factors for the Period Determinants of Curves\n\n49\n\n4.5. Suppose we have another datum of W \u2032 \u2283 U \u2032 , N \u2032 = NU\u2032 \u2032 as above,\nsuch that W \u2032 \u2282 W , U \u2032 \u2282 U , and N \u2032 \u2283 NU \u2032 . Then I(U \u2032 , N \u2032 ) \u2282 I(U, N ),\nC(W \u2032 , N \u2032 ) \u2282 C(W, N ), and (4.4.1) identifies the morphism of Boolean algebras\nC(W \u2032 , N \u2032 )/I(U \u2032 , N \u2032 ) \u2192 C(W, N )/I(U, N ) with a morphism r : C[K \u2032 ] \u2192 C[K],\nQ 7\u2192 r(Q) := Q \\ U = Q \u2229 K. Since \u03c4N \u2032 equals the restriction of \u03c4N to I(U \u2032 , N \u2032 ),\none has\nE(F )N \u2032 = r\u2217 E(F )N .\n(4.5.1)\nRemarks. (i) Taking for W \u2032 a small neighborhood of a component K \u2032 of K,\nU = W \u2032 \u2229 U , N \u2032 = N |U \u2032 , we see that E(F )N has local nature with respect to K.\n(ii) By (4.5.1), E(F )N (W \u2032 \u2229 K) depends only on the restriction of N to U \u2032 .\n\u2032\n\n4.6. Suppose now X is a complex curve, T \u2282 X a finite subset, F is a constructible sheaf on X which is smooth on X \\ T . Let us define a constructible\nfactorization R-line EB (F ) on (X, T ) (see 1.15).\nLet S be an analytic space, (D, c, \u03bdP ) \u2208 D\u22c4 (S). Let us define a local system of\nR-lines E(F )(D,c,\u03bdP ) on S. Consider a datum (W, K, N , \u03bdS ), where W is an open\nsubset of X, K a compact subset of W , N = NU is a continuous family of proper\ncones in the tangent bundle to U := W \\ K (viewed as a real-analytic surface, see\n4.3), \u03bdS is an S-family of meromorphic 1-forms on W . We say that our datum is\ncompatible if P = PD,c \u2282 KS , div(\u03bd) = \u2212D, \u03bd|P = \u03bdP , and the 1-forms Re(\u03bds ) are\nnegative on N . As in 4.4, every compatible datum yields the R-line E(F )N (K).\nLemma. Locally on S compatible data exist; the lines E(F )N (K) for all compatible\ndata are naturally identified.\nProof. The existence statement is evident. Suppose that we fix an open subset\nW0 of X and an S-family of meromorphic forms \u03bdS on W0 such that P \u2282 W0S ,\ndiv(\u03bdS ) = D, and \u03bdP = \u03bd|P . Let us consider compatible data with W \u2282 W0 and\nthe above \u03bdS . The identification of the lines for these data comes from 4.5. Thus\nour line depends only on \u03bdS ; in fact, by Remark (i) in 4.5, on the germ of \u03bdS at\nP . If we move \u03bdS , it remains locally constant. Since the space of germs of \u03bdS is\ncontractible, we are done.\n\u0003\nLocally on S, we define E(F )(D,c,\u03bdP ) as E(F )N (K) for a compatible datum. The\nfactorization structure is evident. For X compact, we have, by (4.4.3), a canonical\nidentification\n\u223c\n\u03b7 : E(F )(X) \u2192 det R\u0393(X, F ).\n(4.6.1)\nExercise. Check that E satisfies the constraints from 2.8.\nRemark. Suppose X is compact and a rational form \u03bd has property that Re(\u03bd)\n\u223c\nis exact, Re(\u03bd) = df . Then the isomorphism \u03b7 : E(F )\u03bd \u2192 det R\u0393(X, F ) can be\n\u2032\ncomputed using Morse theory: indeed, if a < a are non-critical values of f , then\nf \u22121 ((a\u2032 , a]) \u2208 C(N ) for N compatible with \u03bd.\nIn \u00a75 we apply this construction to F = B(M ), the de Rham complex of a\nholonomic D-module M , and write EB (M ) := E(B(M )). We use the same notation\nfor the corresponding de Rham factorization line (in the analytic setting).\n4.7. For b \u2208 X and a meromorphic \u03bd on\n(!)\nE(F )(b,\u03bd) := E(F )(lb,\u03bd) . Let Fb := Ri!b F =\ni\u2217b F = R\u0393(Xb , F ) be the fibers of F at b in !disc around b). Let t be a local parameter at\n\na neighborhood of b, vb (\u03bd) = \u2212l, set\n(\u2217)\nR\u0393{b} (X, F ) = R\u0393c (Xb , F ), Fb :=\nand \u2217-sense (here Xb is a small open\nb.\n\n\f50\n\nAlexander Beilinson\n\nLemma. There are canonical identifications\n(!)\n\nE(F )(b,t\u22121 dt) = det Fb ,\n\n(\u2217)\n\nE(F )(b,\u2212t\u22121 dt) = det Fb .\n\n(4.7.1)\n\nProof. Let Xb be a small disc |t| < r. Let W be the open disc of radius r\u2032 , K\nbe the closed disc of radius r\u2032\u2032 , r\u2032\u2032 < r < r\u2032 . If N is a sufficiently tight cone around\nthe Euler vector field Re(t\u2202t ), then Xb \u2208 C(W, N ) and X\u0304b \u2208 C(W, \u2212N ). The data\n(W, K, N , \u2212t\u22121 dt) and (W, K, \u2212N , t\u22121 dt) are compatible, and we are done.\n\u0003\n(!)\nThus if F is the \u2217-extension at b, i.e., Fb = 0, then E(F )(b,t\u22121 dt) is canon(\u2217)\n\nically trivialized; if F is the !-extension at b, i.e., Fb = 0, then E(F )(b,\u2212t\u22121 dt)\nis canonically trivialized. Denote these trivializations by 1!b \u2208 E(F )(b,t\u22121 dt) , 1\u2217b \u2208\nE(F )(b,\u2212t\u22121 dt) .\nExercise. Suppose X = P1 and F is smooth outside 0, \u221e. Then the compo\u03b7\n(!)\n(\u2217) \u223c\nsition det F0 \u2297 det F\u221e \u2192 E(F )(0,t\u22121 dt) \u2297 E(F )(\u221e,t\u22121 dt) \u2192 det R\u0393(P1 , F ) comes\n(\u2217)\n\nfrom the standard triangle R\u0393{0} (P1 , F ) \u2192 R\u0393(P1 , F ) \u2192 R\u0393(P1 \\ {0}, F ) = F\u221e .\nIn particular, if F is \u2217-extension at 0 and !-extension at \u221e, then \u03b7(1!0 \u2297 1\u2217\u221e ) = 1\n:= the trivialization of det R\u0393(P1 , F ) that comes since R\u0393(P1 , F ) = 0.\n(!)\n(\u2217)\nFor x \u2208 X \\ T one has Fx = Fx (\u22121)[\u22122], so (4.7.1) yields a natural identification\n\u223c\n(1)\n(4.7.2)\nE(F )X\\T \u2192 det F (\u22121)X\\T .\nIf R = C, then the Tate twist acts as identity. If M is a holonomic D-module, then\n\u2207\n[1], and (4.7.2) can be rewritten as\nB(M )X\\T = MX\\T\n(1)\n\n\u223c\n\nEB (M )X\\T \u2192 (det MX\\T )\u2297\u22121 .\n\n(4.7.3)\n\nRemark. For any l \u2208 Z we have the local system of lines E(F )(b,zt\u2212l dt) , z \u2208 C\u00d7 .\nA simple computation (or a reference to the compatibility property in 1.11) together\nwith (4.7.2) shows that its monodromy around z = 0 equals (\u22121)rk(F )l mb where\nrk(F ) = deg det FX\\T is the rank of F and mb is the monodromy of det F around\nb. Thus (4.7.1) provides two descriptions of this local system for l = 1 (using the\nfibers at z = \u00b11). For a relation between them, see below.\n4.8. We are in the situation of 4.7. Suppose R is a field, outside singular points\n(\u2217)\nour F is a local system of rank 1 placed in degree \u22121, and Fb = 0. Let m be the\n(!)\nmonodromy of F around b; suppose m 6= 1. Then Fb vanishes as well, so we have\n!\n\u2217\n1b \u2208 E(F )(b,t\u22121 dt) , 1b \u2208 E(F )(b,\u2212t\u22121 dt) .\nProposition. The (counterclockwise) monodromy from t\u22121 dt to \u2212t\u22121 dt identifies\n1!b with (1 \u2212 m)\u22121 1\u2217b .\nProof. Consider an annulus around b (which lies in U ), and cut it like this:\n\n\fE-Factors for the Period Determinants of Curves\n\n51\n\nLet D+ be the larger open disc, D\u2212 the smaller one, D\u0304\u00b1 be their closures. Let\n\u2665 be a constructible set obtained from the closed heart figure by removing the right\npart of its boundary together with the lower vertex; the upper vertex stays in \u2665.\nSet A := D\u0304+ \\ \u2665, B := \u2665 \\ D\u2212 \u2208 I(U, N\u2212 ), C := A \u222a B = D\u0304+ \\ D\u2212 .\nSuppose \u01eb > 0 is small; let \u03b8\u00b1 be the real part of the complex vector field\nexp(i\u03c0/2 \u00b1 i\u01eb)t\u2202t , and N\u00b1 be a tight cone around \u03b8\u00b1 . Then N+ is compatible\nwith exp(i\u03b1)t\u22121 dt for \u03b1 \u2208 [0, \u03c0/2], and N\u2212 is compatible with exp(i\u03b2)t\u22121 dt for\n\u03b2 \u2208 [\u03c0/2, \u03c0]. Our \u03b8\u00b1 are transversal to the lines of the drawing. Then A \u2208 I(U, N+ )\nand B \u2208 I(U, N\u2212 ) (each of them is the union of two lenses), hence \u2665 \u2208 C(W, N\u00b1 ).\nThus the monodromy in the statement of the proposition is inverse to the com\u223c\n\u223c\nposition \u03bb(F )(D\u2212 ) \u2192 \u03bb(F )(\u2665) \u2192 \u03bb(F )(D\u0304+ ) where the first arrow is multiplication\nby \u03c4N\u2212 \u2208 \u03bb(F )(B), the second one is multiplication by \u03c4N+ \u2208 \u03bb(F )(A) (we use\ntacitly the integration). Notice that R\u0393C (X, F ) is acyclic; let \u03c4 be the correspond\u223c\ning trivialization of \u03bb(F )(C). Since the multiplication by \u03c4 map \u03bb(F )(D\u2212 ) \u2192\n\u03bb(F )(D\u0304+ ) sends 1\u2217b to 1!b , the proposition can be restated as \u03c4N+ \u03c4N\u2212 = (1 \u2212 m)\u03c4 .\nConsider the chain complex (P, d) that computes R\u0393C (X, F ) by means of the\ncell decomposition of the drawing. The graded vector space P is a direct sum of\nrank 1 components P\u03b1 labeled by the cells. Set PA := \u2295 P\u03b1 , PB := \u2295 P\u03b2 . Since\n\u03b1\u2208A\n\n\u03b2\u2208B\n\nA is the image of a 2-simplex with one face removed, PA carries a differential dA\nsuch that (PA , dA ) is the chain complex of the simplex modulo the face. One defines\ndB in a similar way. Both (PA , dA ) and (PB , dB ) are acyclic, and the corresponding\ntrivializations of det PA = \u03bb(F )(A), det PB = \u03bb(F )(B) equal \u03c4N+ , \u03c4N\u2212 .\nLet P \u2032 = PA\u2032 \u2295 PB\u2032 be sum of P\u03b1 's for \u03b1 in the boundary of \u2665. Then P \u2032 is a\nsubcomplex with respect to both d and dA \u2295 dB , on P/P \u2032 the differentials d and\ndA \u2295 dB coincide, and the complex P/P \u2032 is acyclic. We see that P \u2032 is acyclic with\nrespect to both d|P \u2032 and (dA \u2295 dB )|P \u2032 , and \u03c4 , \u03c4N+ \u03c4N\u2212 are the trivializations of\ndet P \u2032 that correspond to these differentials. Our P \u2032 sits in degrees 0, 1. Choose\nbase vectors eA \u2208 PA\u20320 , fA \u2208 PA\u20321 , eB \u2208 PB\u20320 , fB \u2208 PB\u20321 such that dA (eA ) = fA ,\ndB (eB ) = fB , and d(eA ) = fA \u2212 fB . Then d(eB ) = \u2212mfA + fB . Therefore\n\u0003\n\u03c4N+ \u03c4N\u2212 /\u03c4 = 1 \u2212 m, q.e.d.\n4.9. Let b, \u03bd, l be as in the beginning of 4.7; suppose l 6= 1. Denote by \u03bdb\nthe principal term of \u03bd at b. Let f be any holomorphic function defined near b and\nvanishing at b such that \u03bdb = (df )b if l < 1, and \u03bdb = (d(f \u22121 ))b if l > 1. For a\nsmall z \u2208 C, z 6= 0, the set f \u22121 (z) is finite of order |l \u2212 1|. For a finite subset Z of\n(\u2217)\n(!)\nX, denote by FZ , FZ the direct sum of !-, resp. \u2217-fibers of F at points of Z. Let\n\u01eb be a small positive real number.\nProposition. For l < 1, one has canonical identifications\n\u223c\n\n(!)\n\n(!)\n\n\u223c\n\n(\u2217)\n\n\u223c\n\n(!)\n\nE(F )(b,\u03bd) \u2192 det Fb \u2297 (det Ff \u22121 (\u2212\u01eb) )\u2297\u22121 \u2192 det Fb\n\n(\u2217)\n\n\u2297 (det Ff \u22121 (\u01eb) )\u2297\u22121 . (4.9.1)\n\nFor l > 1, one has\n\u223c\n\n(\u2217)\n\nE(F )(b,\u03bd) \u2192 det Fb\n\nProof. Since E(F )(b,\u03bd)\nassume that \u03bd equals df or\nCase l = 0: Then f\naround b with vertices at\n\n(!)\n\n(\u2217)\n\n\u2297 det Fg\u22121 (\u2212\u01eb) \u2192 det Fb \u2297 det Fg\u22121 (\u01eb) .\n\n(4.9.2)\n\ndepends only on the principal term of \u03bd at b, we can\nd(f \u22121 ). Set \u03bb := \u03bb(F ).\nis a local coordinate at b. Let Q be an open romb\nf = \u00b1\u01eb, \u00b1i\u01eb, I and I \u2032 be the parts of its boundary\n\n\f52\n\nAlexander Beilinson\n\nwhere Re(f ) \u2264 0, resp. Re(f ) > 0; set C := Q\u0304 \\ I = Q \u222a I \u2032 . Then one has\n\u223c\n\u223c\nE(F )(b,\u03bd) = \u03bb(C) \u2192 \u03bb(Q\u0304) \u2297 \u03bb(I)\u2297\u22121 \u2192 \u03bb(Q) \u2297 \u03bb(I \u2032 ). This yields (4.9.1) due to the\nnext identifications:\n\u223c\n\u223c\n\u223c\n\u223c\n(!)\n(\u2217)\n(a) \u03bb(Q\u0304) \u2192 det R\u0393Q\u0304 (X, F ) \u2190 det Fb and \u03bb(Q) \u2192 det R\u0393(Q, i\u2217Q F ) \u2192 det Fb ;\n\u223c\n\u223c\n(b) \u03bb(I) \u2192 det R\u0393I (X, F ), and R\u0393f \u22121 (\u2212\u01eb) (X, F ) \u2192 R\u0393I (X, F );\n\u223c\n\n\u223c\n\n\u223c\n\n(\u2217)\n\n(c) \u03bb(I \u2032 ) \u2192 det R\u0393(I \u2032 , Ri!I \u2032 F ) \u2192 det R\u0393(I \u2032 , i\u2217I \u2032 F [\u22121]) \u2192 (det Ff \u22121 (\u01eb) )\u2297\u22121 , where\n\u223c\n\n\u223c\n\nthe second isomorphism comes from i\u2217I \u2032 F [\u22121] \u2192 Ri!I \u2032 iQ! i\u2217Q F \u2192 Ri!I \u2032 F .\nCase l = 2: Then f is a local coordinate at b. Define Q, etc., as above. Then\nE(F )(b,\u03bd) = \u03bb(Q \u222a I) = \u03bb(Q\u0304 \\ I \u2032 ), so (a)\u2013(c) yield (4.9.2).\nIf l 6= 1 is arbitrary, then f is a |l \u2212 1|-sheeted cover of a neighborhood of b over\n\u223c\na coordinate disc. The projection formula compatibility E(F )(b,\u03bd) \u2192 E(f\u2217 F )(0,dt)\n\u223c\nfor l < 1 and E(F )(b,\u03bd) \u2192 E(f\u2217 F )(0,d(t\u22121 )) for l > 1 reduces the assertion to the\ncases of l equal to 0 and 2, and we are done.\n\u0003\n5 The torsor of \u03b5-periods.\n5.1. We consider triples (X, T, M ) where X is a complex curve, T its finite\nsubset, and M is a holonomic D-module on (X, T ) (i.e., a D-module on X smooth\noff T ). For us, a weak theory of \u03b5-factors is a rule E that assigns to every such triple\na de Rham factorization line E(M ) on (X, T ) (in complex-analytic sense). Our E\nshould be functorial with respect to isomorphisms of triples, and have local nature,\ni.e., be compatible with pull-backs by open embeddings. We ask that:\n(i) For a nice flat family (X/Q, T, M ) (see 2.12) with reduced Q the factorization\nlines E(Mq ) vary holomorphically, i.e., we have E(M ) \u2208 L\u03a6\ndR/Q (X/Q, T ). If the\n\u03a6\nfamily is isomonodromic, then E(M ) \u2208 LdR (X/Q, T ).\n(ii) E(M ) is multiplicative with respect to finite filtrations of M 's: for a finite\n\u223c\nfiltration M* on M there is a natural isomorphism E(M ) \u2192 \u2297 E(gri M ).\n\u2032\n\u2032\n(iii) (projection formula) Let \u03c0 : (X , T ) \u2192 (X, T ) be a finite morphism of\npairs \u00e9tale over X \\ T , so, as in Remarks (i), (ii) in 1.2, (ii) in 1.5, we have a\n\u2032\n\u2032\n\u2032\n\u2032\n\u2032\n\u03a6\nmorphism \u03c0\u2217 : L\u03a6\ndR (X , T ) \u2192 LdR (X, T ). Then for any M on (X , T ) one has a\n\u223c\nnatural identification E(\u03c0\u2217 M \u2032 ) \u2192 \u03c0\u2217 E(M \u2032 ) compatible with composition of \u03c0's.\n(iv) (product formula) For compact X there is a natural identification (see 1.4\n\u223c\nfor the notation) \u03b7 = \u03b7(M ) : E(M )(X) \u2192 det R\u0393dR (X, M ).\nThe constraints should be pairwise compatible in the evident sense. (i) should\nbe compatible with the base change. (ii) should be transitive with respect to re\u223c\nfinements of the filtration, and the isomorphism E(\u2295M\u03b1 ) \u2192 \u2297E(M\u03b1 ) should not\ndepend on the linear ordering of the indices \u03b1 (which makes E a symmetric monoidal\nfunctor). (iii) should be compatible with the composition of \u03c0's.\nWeak theories of \u03b5-factors form naturally a groupoid which we denote by w E.\nIts key objects are EdR and EB .\nReplacing det R\u0393dR (X, M ) in (iv) by the trivial line C and leaving the rest of\nthe story unchanged, we get a groupoid w E0 . It has an evident Picard groupoid\nstructure, and w E is naturally a w E0 -torsor. Below we denote by (i)0 \u2013(iv)0 the\nstructure constraints in w E0 that correspond to (i)\u2013(iv) above.\n5.2. Compatibility with quadratic degenerations of X. Let us formulate an\nimportant property of E \u2208 w E.\n\n\fE-Factors for the Period Determinants of Curves\n\n53\n\nSuppose we have data 2.13(a),(b) in the analytic setting; we follow the notation\nof loc. cit. In 2.13 we worked in the formal scheme setting. Now the whole story\nof (2.13.1)\u2013(2.13.7) makes sense analytically: we have a proper family of curves\nX over a small coordinate disc Q and an OX -module M equipped with a relative\nconnection \u2207, etc., so that the picture of 2.13 coincides with the formal completion\nof the present one at q = 0. To construct X, notice that t\u00b1 from 2.13(a) converge\non some true neighborhoods U\u00b1 of b\u00b1 . Suppose that t\u00b1 identify U\u00b1 with coordinate\ndiscs of radii r\u00b1 and U+ \u2229U\u2212 = U\u00b1 \u2229(T \u222a|D|) = \u2205. Then Q is the coordinate disc of\nradius r+ r\u2212 . Let W be an open subset of Y \u00d7 Q formed by those pairs (y, q) that if\ny \u2208 U+ , then r\u2212 |t+ (y)|2 > |q|r+ , and if y \u2208 U\u2212 , then r+ |t\u2212 (y)|2 > |q|r\u2212 . Our X is\nthe union of two open subsets V := U+ \u00d7 U\u2212 and W : we glue (y, q) \u2208 W such that\ny \u2208 U\u00b1 with (y+ , y\u2212 ) \u2208 V such that either y+ or y\u2212 equals y and t+ (y+ )t\u2212 (y\u2212 ) = q.\nThe projection q : X \u2192 Q is (y, q) 7\u2192 q on W and q(y+ , y\u2212 ) = t+ (y+ )t\u2212 (y\u2212 ) on\n\u22121\n\u22121\nV . Set K0Q := X \\ W = {(y+ , y\u2212 ) \u2208 V : r+\n|t+ (y+ )| = r\u2212\n|t\u2212 (y\u2212 )|}. The formal\ntrivializations of L at b\u00b1 from 2.13(b) converge on U\u00b1 , and we define M by gluing\nMb0 \u2297 OV and the pull-back NW of N by the projection W \u2192 Y .\nLet us define an analytic version of (2.13.7), which is an isomorphism of OQ lines\n\u223c\n\ndet RqdR\u2217 M \u2192 det R\u0393dR (Y, N ) \u2297 OQ .\n\n(5.2.1)\n\nLet i, j be the embeddings K0Q \u0592\u2192 X \u2190\u0593 W . Since V \\ K0Q is disjoint union\n\u22121\n\u22121\nof two open subsets V\u00b1 , V+ := {(y+ , y\u2212 ) : r+\n|t+ (y+ )| > r\u2212\n|t\u2212 (y\u2212 )|}, the com\u2217\nplex F := i j\u2217 dRW/Q (NW ) is the direct sum of the two components F\u00b1 . Both\n\u223c\nmaps i\u2217 dRX/Q (M ) \u2192 F\u00b1 are quasi-isomorphisms, so i\u2217 F\u2212 \u2192 Cone(dRX/Q (M ) \u2192\n\u223c\nj\u2217 dRW/Q (NW )), hence det RqdR\u2217 M \u2192 (det Rq|W dR\u2217 NW ) \u2297 (det Rq|K0Q \u2217 F\u2212 )\u2297\u22121 .\nLet NX \u2282 j\u2217 NW be \u2217-extension from V+ side and !-extension from V\u2212 side. Then\n\u223c\ni\u2217 dRX/Q (NX ) = F+ \u2282 F+ \u2295 F\u2212 , hence det RqdR\u2217 NX \u2192 (det Rq|W dR\u2217 NW ) \u2297\n\u223c\n(det Rq|K0Q \u2217 F\u2212 )\u2297\u22121 . Thus we get a canonical identification \u03b1 : det RqdR\u2217 M \u2192\ndet RqdR\u2217 NX . Now NW , hence NX , are D-modules, i.e., they carry an absolute\nflat connection, so RqdR\u2217 NX , Rq|W dR\u2217 NW carry a natural connection. It is clear\nfrom the topology of the construction that the cohomology are smooth, hence constant, DQ -modules. Since the fiber of RqdR\u2217 NX at q = 0 equals R\u0393dR (Y, N ), we\nget (5.2.1).\nFor any E \u2208 w E we have an OQ -line E(M )\u03bdQ := E(M )(DQ ,1T ,\u03bdQ ) and a natural\n\u223c\nisomorphism E(M )\u03bdQ \u2192 E(N )(D,1T ,\u03bd) \u2297 OQ , cf. (2.13.4). There is a canonical\n\u223c\nisomorphism E(N )(D,1T ,\u03bd) \u2192 E(N )\u03bd defined in the same way as (2.13.9) (using\n\u223c\n\u03b7 on P1 ). Since X is smooth over Qo := Q \\ {0}, we have \u03b7 : E(M )\u03bdQ |Qo \u2192\ndet RqdR\u2217 M |Qo . Thus comes a diagram\nE(M )\u03bdQ |Qo\n\u2193\nE(N )\u03bd \u2297 OQo\n\n\u03b7\n\n\u2212\u2192\n\ndet RqdR\u2217 M |Qo\n\u2193\n\u03b7\n\u2212\u2192 det R\u0393dR (Y, N ) \u2297 OQo .\n\n(5.2.2)\n\nWe say that E is a theory of \u03b5-factors if (5.2.1) commutes for all data 2.13(a),(b).\nSuch E form a subgroupoid E of w E called the \u03b5-gerbe; see 5.4 for the reason.\nFor E 0 \u2208 w E0 there is a similar diagram\n\n\f54\n\nAlexander Beilinson\n\nE 0 (M )\u03bdQ |Qo\n\u0581\n\u2193\n\nOQo\n\n(5.2.3)\n\n\u0580\nE 0 (N )\u03bd \u2297 OQo\nThose E 0 for which (5.2.3) commutes for every datum 2.13(a),(b) form a Picard\nsubgroupoid E0 of w E0 . Our E is an E0 -torsor.\nProposition. EdR and EB are theories of \u03b5-factors.\nProof. Compatibility of EdR with quadratic degenerations follows from 2.13.\nNamely, the construction from loc. cit., spelled analytically as above, provides \u03b7dR :\n\u223c\nEdR (M )\u03bdQ \u2192 det RqdR\u2217 M over the whole Q (not only on Qo ), and the proposition\nin 2.13 says that our diagram commutes on the formal neighborhood of q = 0.\nHence it commutes everywhere, q.e.d.\nLet us treat EB . Let K\u221e be a compact neighborhood of T \u222a |D| in Y that\ndoes not intersect U\u00b1 , K := K\u221e \u222a {b+ , b\u2212 }. Let N be a continuous family\nof proper cones in the tangent bundle to Y \\ K such that Re(\u03bd) is negative on\nit. Set K\u221eQ := K\u221e \u00d7 Q, KQ := K\u221eQ \u2294 K0Q \u2282 X; let NW be the pull-back\nof N by the projection W \u2192 Y . Then (X, KQ , NW , \u03bdQ ) form a Q-family of\ncompatible data as in 4.6. Consider isomorphisms \u03b7 of (4.7.1) for M and NX .\nOur Q-family is constant near K\u221eQ , so EB (M )N (K\u221eQ ) = EB (NX )N (K\u221eQ ) =\nEB (N )N (K\u221e ) \u2297 OQ . Let C be a locally closed subset of V which consists of those\n(y+ , y\u2212 ) that 2|t+ (y+ )|/r+ \u2212 |t\u2212 (y\u2212 )|/r\u2212 \u2264 1 and 2|t\u2212 (y\u2212 )|/r\u2212 \u2212 |t+ (y+ )|/r+ < 1;\n(C)\nset RqdR\u2217 (?) := Rq|C\u2217 Ri!C dRX/Q (?). If N is sufficiently tight, then C \u2208 C(X, NW )\n(C)\n(see the proof of the lemma in 4.7), thus EB (?)N (K\u221eQ ) = det RqdR\u2217 (?).\n\u03b7B\nSince the construction of (5.2.1) was local at K0Q , the composition of EB (M ) \u2212\u2192\n\u223c\ndet RqdR\u2217 M \u2192 det R\u0393dR (Y, N ) \u2297 OQ = det RqdR\u2217 NX in (5.2.2) can be rewritten as\n\u03b7B\n\u223c\n(C)\n(C)\nEB (N )N (K\u221e ) \u2297 det RqdR\u2217 (M ) \u2192 EB (N )N (K\u221e ) \u2297 det RqdR\u2217 (NX ) \u2212\u2192 RqdR\u2217 NX .\n\u223c\nHere \u2192 comes from the identification\n(C)\n\n\u223c\n\n(C)\n\n\u03b1C : det RqdR\u2217 (M ) \u2192 det RqdR\u2217 (NX )\n\n(5.2.4)\n(C)\n\ndefined by the same construction as (5.2.1) with RqdR\u2217 replaced by RqdR\u2217 .\n\u223c\n\u223c\nThe composition EB (M ) \u2192 EB (N )\u2297OQ \u2192 det R\u0393dR (Y, N )\u2297OQ = det RqdR\u2217 NX\n\u223c\n\u223c\n(C)\nin (5.2.2) equals EB (N )N (K\u221e )\u2297det RqdR\u2217 (M ) \u2192 EB (N )N (K\u221e ) \u2192 EB (N )N (K\u221e )\u2297\n\u03b7B\n\u223c\n(C)\n(C)\n(C)\ndet RqdR\u2217 (NX ) \u2212\u2192 RqdR\u2217 NX . Here \u2192 come since RqdR\u2217 (M ) = RqdR\u2217 (NX ) =\n0, hence their determinant lines are trivialized (notice that the trivialization of\n(C)\nRqdR\u2217 (NX ) is horizontal, and at q = 0 it equals the Betti version of (2.13.8) due to\nExercise in 4.7).\nWe see that commutativity of (5.2.2) means that \u03b1C identifies the above trivializations. To see this, consider the open subspace V\u2212 \u2282 V , and the corresponding\n2-step filtration jV\u2212 ! M |V\u2212 \u2282 M |V , and notice that NX |V = grM |V . The assertion\nfollows now from the construction of \u03b1C .\n\u0003\n\n\fE-Factors for the Period Determinants of Curves\n\n55\n\n5.3. Let (X, T, M ) be as in 5.1. For E \u2208 w E, b \u2208 X, and a meromorphic form\n\u03bd on a neighborhood of b, vb (\u03bd) = \u2212l, we write E(M )(b,\u03bd) := E(M )(lb,\u03bd) .\nRemark. If b is a smooth point of M , then E(M )(b,\u03bd) does not depend on\nwhether we view b as a point of T or X \\ T (by 5.1(iii) with \u03c0 = idX , T = T \u2032 \u222a {b}).\nLet \u03b4(M )b,\u03bd \u2208 Z be the degree of E(M )(b,\u03bd) , and \u03bc(M )b,\u03bd \u2208 C\u00d7 be the value of\n\u03bc \u2208 Aut(E(M )) (see 1.15) at (b, \u03bd).\n(!)\n\nLemma. (i) One has \u03b4(M )b,\u03bd = dim(B(M )b ) + (1 \u2212 l)rk(M ).\n(ii) For c \u2208 C\u00d7 the multiplication by c automorphism of M acts on E(M )(b,\u03bd) as\nmultiplication by c\u03b4(M)b,\u03bd .\n(iii) One has \u03bc(M )b,\u03bd = (\u22121)l rk(M) mb (M )\u22121 where mb (M ) is the monodromy of\ndet MX\\T around b.\n\u223c\n(iv) For smooth M , there is an isomorphism E(M )(1) \u2192 (det M )\u2297\u22121 compatible\nwith constraint 5.1(ii) and pull-backs by open embeddings. In particular, this is an\nisomorphism of symmetric monoidal functors.\n(v) Suppose we have M , M \u2032 over discs U , U \u2032 which have regular singularity and are\neither \u2217- or !-extension at b, b\u2032 . Let \u03c6 : U \u2192 U \u2032 be any open embedding, \u03c6(b) = b\u2032 ,\n(1) \u223c\nand \u03c6\u0303 : M \u2192 \u03c6\u2217 M \u2032 be any its lifting. Then the isomorphism E(\u03c6\u0303) : E(M )b \u2192\n(1)\nE(M \u2032 )b\u2032 does not depend on the choice of (\u03c6, \u03c6\u0303).\nProof. (i) Let t be a local coordinate at b, t(b) = 0. We can view t as an\nidentification of a small disc Xb at b with a neighborhood of 0 \u2208 P1 . Let us extend\nM |Xb to a D-module M (t) on P1 which is smooth outside {0, \u221e}, and is the \u2217extension with regular singularities at \u221e. Such M (t) is unique.\nBy continuity, \u03b4(M )b,\u03bd is the same for all \u03bd with fixed l. We can assume\nthat \u03bd is meromorphic on P1 with div(\u03bd) \u2282 {0, \u221e}, so v0 (\u03bd) = \u22122 \u2212 v\u221e (\u03bd). By\n(!)\n5.1(iv), one has \u03b4(M (t) )0,\u03bd + \u03b4(M (t) )\u221e,\u03bd = \u03c7dR (P1 , M (t) ) = dim(B(M (t) )b ). Thus\nthe assertion for (Xb , M, \u03bd) amounts to that for (P1\u221e , M (t) , \u03bd), i.e., we are reduced\nto the case when M is the \u2217-extension with regular singularities. By 5.1(ii), it\nsuffices to treat the case of rk(M ) = 1; then, by continuity, it suffices to consider\nM = OX (the trivial D-module). By 5.1(iv) applied to P1 and t\u22121 dt, we see that\n\u03b4(OP1 )0,t\u22121 dt + \u03b4(OP1 )\u221e,t\u22121 dt = \u22122, hence, since v\u221e (t\u22121 dt) = v0 (t\u22121 dt), one has\n\u03b4(OP1 )b,t\u22121 dt = \u22121. By factorization, \u03b4(OP1 )0,t\u2212l dt = l\u03b4(OP1 )0,t\u22121 dt = \u2212l, q.e.d.\n(ii) The C\u00d7 -action on E(M )(b,\u03bd) , which comes from the action of homotheties\n\u2032\non M , is a holomorphic character of C\u00d7 . Thus c acts as multiplication by c\u03b4 (M)b,\u03bd\nfor some \u03b4 \u2032 (M )b,\u03bd \u2208 Z. The argument of (i) works for \u03b4 replaced by \u03b4 \u2032 , so \u03b4 and \u03b4 \u2032\nare given by the same formula, q.e.d.\n(iv) By (i), E (1) (OX ) is a de Rham line of degree \u22121, which has local origin.\n\u223c\nThus there is a line E of degree \u22121 and an isomorphism E \u2297 OX \u2192 E (1) (OX )\ncompatible with the pull-backs by open embeddings of X's; such a datum is uniquely\ndefined.\n\u223c\nThe set of isomorphisms \u03b1 : E \u2192 C[1] identifies naturally with the set of\n\u223c\nisomorphisms of symmetric monoidal functors \u03b1E : E(M )(1) \u2192 (det M )\u2297\u22121 (where\nM is smooth) that are compatible with the pull-backs by open embeddings. Namely,\n\u03b1E is a unique isomorphism that equals \u03b1 \u2297 idOX for M = OX . To see this, notice\n\u223c\nn\nn\n) as multiplication by\n) acts on E (1) (OX\nthat a matrix g \u2208 GLn (C) \u2192 Aut(OX\ndet(g)\u22121 (which follows from (ii) and 5.1(ii)).\n(iii) Use (iv) and the compatibility property from 1.11.\n\n\f56\n\nAlexander Beilinson\n(1)\n\n(v) Let us show that Aut(M ) acts trivially on E(M )b . Pick any g \u2208 Aut(M ).\nSince MU\\{b} admits a g-invariant filtration with successive quotients of rank 1, we\nare reduced, by 5.1(ii), to the case of M of rank 1. Here g is multiplication by some\n(1)\nc \u2208 C\u00d7 , and we are done by (ii) (since, by (i), E(M )b has degree 0).\nThus for given \u03c6 the isomorphism E(\u03c6\u0303) does not depend on the choice of \u03c6\u0303. The\nspace of \u03c6's is connected, so it suffices to show that the map \u03c6 7\u2192 E(\u03c6\u0303) is locally\nconstant. If \u03c6 varies in a disc Q, then we can find \u03c6\u0303 which is an isomorphism of\nD-modules on U \u00d7 Q, hence our map is horizontal (see 5.1(i)), q.e.d.\n\u0003\n5.4. For E \u2208 E and (X, T, M ) as in 5.1 the canonical automorphism \u03bc of\nE(M ) (see 1.15) is evidently compatible with constraints 5.1(i)\u2013(iv), i.e., \u03bc is an\nautomorphism of E. Here is the main result of this section:\nTheorem. Aut(E) is an infinite cyclic group generated by \u03bc. All objects of E are\nisomorphic. Thus E is a Z-gerbe.\n\u223c\n\nWe call \u03c1\u03b5 : EdR \u2192 EB an \u03b5-period isomorphism. By the theorem, \u03b5-period\nisomorphisms form a Z-torsor EB/dR referred to as the \u03b5-period torsor.\nSince E is an E0 -torsor, the theorem can be reformulated as follows. By (iii) of\nthe lemma in 5.3, every E 0 \u2208 E0 carries a natural automorphism \u03bc0 that acts on\nE 0 (M )(b,\u03bd) as multiplication by \u03bc(M )b,\u03bd \u2208 C\u00d7 .27\nTheorem\u2032 . The map Z \u2192 \u03c01 (E0 ), 1 7\u2192 \u03bc0 , is an isomorphism, and \u03c00 (E0 ) = 0.\nThe proof occupies the rest of the section.\n5.5. Pick any E 0 \u2208 w E0 . Then for (X, T, M ) as in 5.1 one has:\nLemma. (i) The factorization line E 0 (M ) \u2208 L\u03a6\ndR (X, T ) is trivial.\n(ii) Every automorphism of M acts trivially on E 0 (M ).\n(iii) For M of rang 0, the factorization line E 0 (M ) is canonically trivialized. The\ntrivialization has local nature and is compatible with constraints 5.1(i)0 \u2013(iv)0 ; it is\nuniquely defined by this property.\nProof. (i) One checks that the de Rham line E 0 (M )(1) on X \\ T is trivial by\nmodifying the argument in the proof of 5.3(iv) in the evident manner (or one can\nuse 5.3(iv) directly, noticing that E 0 is the ratio of two objects of w E). Similarly,\nE(M ) has zero degree by 5.3(i). Now use the theorem in 1.6.\n(ii) Let us show that g \u2208 Aut(M ) acts trivially on E 0 (M )(b,\u03bd) . Let M (t) be\nas in the proof of 5.3(i); g acts on it. We can assume that \u03bd is meromorphic\non P1 with div(\u03bd) \u2282 {0, \u221e}. The action of g on E 0 (M (t) )(P1 ) = E 0 (M )(0,\u03bd) \u2297\nE 0 (M (t) )(\u221e,\u03bd) is trivial by 5.1(iv)0 , it suffices to check that it acts trivially on\nE 0 (M (t) )(\u221e,\u03bd) . Thus we are reduced to the situation when our M is the \u2217-extension\nwith regular singularities. By constraint 5.1(ii)0 , it suffices to consider the case when\nthe monodromy of M around b is multiplication by a constant. Then Aut(M ) is\ngenerated by the diagonal matrices, and by 5.1(ii)0 we are reduced to the case when\nM has rank 1, where we are done by 5.3(ii).\n(iii) is left to the reader.\n\u0003\n27\n\n\u03bc0 does not equal the canonical automorphism \u03bc of E 0 (M ) (which is identity by 5.5(i)).\n\n\fE-Factors for the Period Determinants of Curves\n\n57\n\nRemarks. (i) By (i) of the lemma, the degree 0 lines E 0 (M )(b,\u03bd) for all \u03bd with\nfixed vb (\u03bd) = \u2212l are canonically identified; we denote this line by E 0 (M )(b,l) . By\n(ii) of loc. cit., it depends only on the isomorphism class of M , and by (iii) there is\n\u223c\na canonical identification E 0 (M )(b,l) \u2192 E 0 (jb\u2217 M )(b,l) .\n\u2032\n(ii) Suppose we have M , M on discs U , U \u2032 which have regular singularity at\n(\u2032)\nb \u2208 U (\u2032) . Let \u03c6 : U \u2192 U \u2032 be an open embedding, \u03c6(b) = b\u2032 , and \u03c6\u0303 : M \u2192 \u03c6\u2217 M \u2032\n\u223c\nbe any its lifting. Then the isomorphisms E 0 (\u03c6\u0303) : E 0 (M )(b,l) \u2192 E 0 (M \u2032 )(b\u2032 ,l) do\nnot depend on the choice of (\u03c6, \u03c6\u0303). To see this, we can assume that M , M \u2032 are\n\u2217-extensions at b, b\u2032 , and then repeat the second part of the proof of 5.3(v).\n5.6. For m \u2208 C\u00d7 let Mm be a D-module of rank 1 on a disc U , which has\nregular singularity at b \u2208 U with the monodromy m and is \u2217-extension at b. By\nthe remark in 5.5, the degree 0 line G(m,l) := E 0 (Mm )(b,l) depends only on m and\nl. By 5.1(i)0 , G(m,l) form a holomorphic line bundle G = G(E 0 ) over Gm \u00d7 Z. The\nfactorization structure on E 0 (Mm ) provides, by 5.5(i), canonical isomorphisms\n\u223c\n\n\u2297 G(1,l\u03b1 ) \u2192 G(1,\u03a3l\u03b1 ) ,\n\n\u223c\n\nG(1,l) \u2297 G(m,l\u2032 ) \u2192 G(m,l+l\u2032 ) .\n\n(5.6.1)\n\nSuppose we have a finite collection {(m\u03b1 , l\u03b1 )} with \u03a0m\u03b1 = 1, \u03a3l\u03b1 = 2. Then for\nany choice of a subset {b\u03b1 } \u2282 P1 one can find a D-module M on P1 of rank 1 which\nis smooth off {b\u03b1 } and is \u2217-extension with regular singularity at b\u03b1 with monodromy\nm\u03b1 , and a rational form \u03bd with div(\u03bd) = \u2212\u03a3l\u03b1 b\u03b1 . Writing E(M )(P1 ) = E(M )\u03bd in\n5.1(iv)0 , we get\n\u223c\n\u03b7 : \u2297G(m\u03b1 ,l\u03b1 ) \u2192 C.\n(5.6.2)\nIt does not depend on the auxiliary choices (for \u03b7 is locally constant, and the datum\nof {b\u03b1 }, \u03bd forms a connected space; M is unique up to an isomorphism).\nNow assume that E 0 \u2208 E. Consider the holomorphic Gm -torsor G \u00d7 = G \u00d7 (E 0 )\nover Gm \u00d7 Z that corresponds to G.\nLemma. G \u00d7 has a unique structure of holomorphic commutative group Gm -extension\n\u00d7\n\u00d7\n, 1 \u2264 i \u2264 n, and g \u2208 G((m\nof Gm \u00d7Z such that for any gi \u2208 G(m\n\u22121 ,2\u2212l \u2212...\u2212l )\ni ,li )\n1 ...mn )\n1\nn\none has \u03b7(g \u2297 (g1 * * * gn )) = \u03b7(g \u2297 g1 \u2297 . . . \u2297 gn ).\nProof. The above formula defines commutative n-fold product maps G \u00d7n \u2192\nG , (g1 , . . . , gn ) 7\u2192 g1 * * * gn , which lift the n-fold products on Gm \u00d7 Z. We need to\ncheck the associativity property, which says that for any g1 , . . . , gn \u2208 G \u00d7 and any\nk, 1 < k < n, one has g1 * * * gn = (g1 * * * gk )gk+1 * * * gn .\n\u00d7\n\u00d7\n\u00d7\n\u00d7\n\u2192 Gm\n:= \u2294G(m,l)\n\u2282 G \u00d7 . The maps (G1\u00d7 )n \u2192 G1\u00d7 , G1\u00d7 \u00d7 Gm\nFor m \u2208 C\u00d7 set Gm\ncoming from the arrows in (5.6.1) are evidently associative and commutative, i.e.,\n\u00d7\nthey define a commutative group structure on G1\u00d7 and a G1\u00d7 -torsor structure on Gm\n.\n\u00d7\n\u00d7\nThus G is a G1 -torsor over Gm .\nSince (5.6.2) comes from a trivialization of E(M ), the above maps are restrictions of the multiple products maps in G \u00d7 . Moreover, the n-fold product on G \u00d7\nis compatible with the G1\u00d7 -action on G \u00d7 : for h \u2208 G1\u00d7 one has (hg1 )g2 * * * gn =\nh(g1 , . . . , gn ). So, while checking the associativity, we have a freedom to change gi\n\u00d7\nare such that l1 +. . .+lk = 1.\nin its G1\u00d7 -orbit. Thus we can assume that gi \u2208 G(m\ni ,li )\n\u00d7\n\nThen one can find a quadratic degeneration picture as in 5.2 such that T\u0303 =\nb1Q \u2294 . . . \u2294 bnQ , M\u0303 of rank 1 has regular singularities at biQ with monodromy mi ,\ndiv(\u03bd\u0303) = \u2212\u03a3li biQ ; the fiber X\u03031 is P1 , and X\u03030 is the union of two copies of P1 with\n\n\f58\n\nAlexander Beilinson\n\n{b1 , . . . , bk } in the first copy and {bk+1 , . . . , bn } in the second. The compatibility\nwith quadratic degeneration yields the promised associativity, q.e.d.\n\u0003\n5.7. Let \u03c0 (n) : U \u2032 \u2192 U , \u03c0 (n) (b\u2032 ) = b, be a degree n covering of a disc completely\n(n)\nramified at b. Then \u03c0\u2217 Mm\u2032 is isomorphic to \u2295 Mm , and vb\u2032 (\u03c0 (n)\u2217 \u03bd) + 1 =\nmn =m\u2032\n\nn(vb (\u03bd) + 1). Therefore 5.1(iii)0 , 5.1(ii)0 yield a canonical isomorphism\n\u2297\n\n\u223c\n\nmn =m\u2032\n\nG(m,l) \u2192 G(m\u2032 ,n(l\u22121)+1) .\n\n(5.7.1)\n\nFor example, if n = 2, m\u2032 = 1, l = 1, then (5.6.2), with G(1,1) factored off, is a\ntrivialization of G(\u22121,1) , which we denote by e(\u22121,1) \u2208 G(\u22121,1) . Notice that\n\u03b7(e\u22972\n(\u22121,1) ) = 1.\n\n(5.7.2)\n\nThis follows from compatibility of \u03b7 with \u03c0\u2217 applied to a covering P1 \u2192 P1 , t 7\u2192 t2 ,\nthe trivial D-module OP1 on the source, and the form t\u22121 dt on the target.\nLet Ext(Gm , Gm ) be the Picard groupoid of holomorphic commutative group\nextensions of Gm by Gm . One has \u03c00 (Ext(Gm , Gm ) = 0 and \u03c01 (Ext(Gm , Gm ) =\nHom(Gm , Gm ) = Z.\nThe quotient of Gm \u00d7 Z modulo the subgroup generated by (\u22121, 1) identifies\nwith Gm by the projection (m, l) 7\u2192 (\u22121)l m. Thus the quotient \u1e20 \u00d7 (E 0 ) of G \u00d7 (E 0 )\nmodulo the subgroup generated by e(\u22121,1) is an object of Ext(Gm , Gm ).\n\u1e20 \u00d7 : E0 \u2192 Ext(Gm , Gm )\n0\n\n(5.7.3)\n\n0\n\nis a Picard functor. It assigns to \u03bc \u2208 Aut(E ) (see 5.4) the generator \u22121 of\nZ = Aut(\u1e20 \u00d7 (E 0 )). Therefore we can reformulate the theorem from 5.4 as follows:\nTheorem. \u1e20 \u00d7 is an equivalence of Picard groupoids.\nLet us define a Picard functor\nExt(Gm , Gm ) \u2192 E0\n\n(5.7.4)\n\nright inverse to (5.7.3). We need to assign to an extension \u1e20 \u00d7 an object E 0 = E 0 (\u1e20 \u00d7 )\nof E0 . Suppose we have (X, T, M ) as in 5.1. For b \u2208 T let m(M )b be the monodromy\nof det M |X\\T around b; for c \u2208 2T we denote by m(M )c the product of m(M )b for\nb \u2208 T c (see 1.1 for the notation). Then\nE 0 (M )(D,c,\u03bd) := \u1e20(\u22121)deg(D)rk(M ) m(M)c .\n\n(5.7.5)\n\u00d7\n\nHere \u1e20 is the degree 0 line that corresponds to the Gm -torsor \u1e20 . The factorization\nstructure comes from the product in \u1e20 \u00d7 . Constraints 5.1(i)0 , 5.1(ii)0 are evident.\n\u223c\nThe identification E 0 (\u03c0\u2217 M \u2032 ) \u2192 \u03c0\u2217 E(M \u2032 ) of 5.1(iii)0 comes since both lines are fibers\nof \u1e20 over the same point of C\u00d7 . To see this, it suffices to consider the situation of\n(5.7.1): there the assertion is clear since \u03a0 (\u22121)l m = (\u22121)n(l\u22121)+1 m\u2032 . Finally,\nn\n\u2032\nm =m\n\nfor compact X one has m(M )1 = 1 and deg(D) is even, hence E 0 (M )(D,c,\u03bd) = \u1e201 =\nC, which is 5.1(iv)0 . The constraints are mutually compatible by construction. We\nleave it to the reader to check that E 0 is compatible with quadratic degenerations\nof X, so we have defined (5.7.4). Due to an evident identification \u1e20 \u00d7 (E 0 ) = \u1e20 \u00d7 ,\n(5.7.3) is left inverse to (5.7.4), so the theorem amounts to the next statement:\n\u223c\n\nTheorem\u2032 . For any E 0 \u2208 E0 there is a natural isomorphism \u03b9 : E 0 \u2192 E 0 (\u1e20 \u00d7 (E 0 )).\n\n\fE-Factors for the Period Determinants of Curves\n\n59\n\n5.8. The next step reduces us to the setting of D-modules with regular singularities. For a holonomic D-module M we denote by M rs the holonomic Dmodule with regular singularities such that B(M rs ) = B(M ), or, equivalently,\nM \u221e = M rs\u221e , see 3.2. The functor M 7\u2192 M rs sends nice families of D-modules\nto nice families (as follows from 2.14), it is exact, comutes with \u03c0\u2217 , and one has\n\u223c\nan evident identification R\u0393dR (X, M ) \u2192 R\u0393dR (X, M rs ). Thus for any theory of\n\u03b5-factors E the rule M 7\u2192 rE(M ) := E(M rs ) is again a theory of \u03b5-factors. Clearly\nr is an endofunctor of E. The same formula defines an endofunctor r0 of E0 . It is\nnaturally a Picard endofunctor, and r is a companion E0 -torsor endofunctor: one\n0\n0\n0\n\u223c 0\n\u223c\nhas r E 0 \u2297 r E \u20320 \u2192 r (E 0 \u2297 E \u20320 ), r E 0 \u2297 rE \u2192 r(E 0 \u2297 E).\nProposition. The endofunctor r of E is naturally isomorphic to idE . Namely, there\n\u223c\nis a unique \u03ba : idE \u2192 r such that \u03baE,M : E(M ) \u2192 E(M rs ) is the identity map if M\n\u223c\nhas regular singularities. Same is true for E replaced by E0 . Here \u03ba0 : idE0 \u2192 r0 is\nan isomorphism of Picard endofunctors, and \u03ba is an isomorphism of the companion\nE0 -torsor endofunctors.\nProof. (i) Let us define a canonical isomorphism of factorization lines\n\u223c\n\n\u03ba = \u03baE,M : E(M ) \u2192 E(M rs ).\n\n(5.8.1)\n\nOne has M |X\\T = M rs |X\\T , and over X \\ T our \u03ba is the identity map. It\n(1)\n(1) \u223c\nremains to define \u03ba(1) : E(M )b \u2192 E(M rs )b for b \u2208 T (see 1.6 and 1.15).\nPick a local parameter t at b. As in the proof of 5.3(i), M yields a D-module\n(1)\n(t)\nM on P1 with E(M )b = E(M (t) )(0,t\u22121 dt) . Ditto for M rs . Since M rs(t) = M (t)rs\n(t)\nequals M outside 0, constraints 5.1(iv) for M (t) and M rs(t) yield isomorphisms\n\u223c\n\u223c\nE(M (t) )(0,t\u22121 dt) \u2297E(M (t) )(\u221e,t\u22121 dt) \u2192 det R\u0393dR (P1 , M (t) ) = det R\u0393dR (P1 , M rs(t) ) \u2190\nE(M rs(t) )(0,t\u22121 dt) \u2297 E(M (t) )(\u221e,t\u22121 dt) . Factoring out E(M (t) )(\u221e,t\u22121 dt) , we get \u03ba(1) .\nIt remains to show that \u03ba(1) does not depend on the auxiliary choice of t. The\nspace of local parameters t is connected, so we need to check that \u03ba is locally\nconstant with respect to it. Let ts be a family of local parameters at b that are\ndefined on the same disc Xb and depend holomorphically on s \u2208 S; then ts identify\n(t)\nXbS with a neighborhood U of {0}\u00d7S in P1S . Let MU be the pull-back of M by the\nprojection U \u2192 Xb , (v, s) 7\u2192 ts\u22121 (v). This is a holonomic DU -module; let M (t) be a\n(t)\nholonomic D-module on P1S which equals MU on U , is smooth outside {0, \u221e} \u00d7 S,\nand is the \u2217-extension with regular singularities at {\u221e} \u00d7 S. The restriction of\nM (t) to any fiber equals M (ts ) , i.e., M (ts ) form a nice isomonodromic family. The\n(1) \u223c\nidentifications E(M )b \u2192 E(M (ts ) )(0,t\u22121 dt) are horizontal, ditto for M rs . We are\ndone the compatibility of \u03b7 with the Gauss-Manin connection.\nThe same construction (with R\u0393dR (P1 , *) replaced by C) yields for E 0 \u2208 E0 a\ncanonical isomorphism\n\u223c\n\u03ba0 : E 0 (M ) \u2192 E 0 (M rs ).\n(5.8.2)\n(ii) \u03ba0 and \u03ba are evidently compatible with the tensor product of E 0 's and E's,\nand with constraints 5.1(i)\u2013(iii) and 5.1(i)0 \u2013(iii)0 . It remains to check compatibility\nwith constraint (iv). We treat the setting of E0 (which suffices, say, since r2 = r).\nSuppose we have (X, T, M ) with compact X. We need to prove that the composition\n\u03ba0\n\n\u03b7(M rs )\n\nE 0 (M )(X) \u2192 E 0 (M rs )(X) \u2212\u2192 C equals \u03b7(M ).\n\n\f60\n\nAlexander Beilinson\n\nLet b \u2208 T be a point where M has non-regular singularity, and M rsb be the\n\u223c\nD-module which equals M outside of b and M rs near b. Let \u03ba0b : E 0 (M ) \u2192 E 0 (M rsb )\nbe equal to \u03ba0 near b and the identity morphism off b.\n\u03ba0\n\n\u03b7(M rsb )\n\nb\nLemma. The composition E 0 (M )(X) \u2212\u2192\nE 0 (M rsb )(X) \u2212\u2192 C equals \u03b7(M ).\n\nThe lemma implies the proposition: since (M rsb )rs = M rs and the composition\n\u03ba0\n\n\u03ba0\n\nb\nE 0 (M ) \u2212\u2192\nE 0 (M rsb ) \u2212\u2192 E(M rs ) equals \u03ba0 , we are done by induction by the\nnumber of points of T where M has non-regular singularity.\nProof of Lemma. Let \u03bd be a rational form on X such that Resb \u03bd = 1. Let tb\nbe a local parameter at b such that t\u22121\nb dtb = \u03bd.\nConsider a datum 2.13(a) with Y = P1 \u2294 X, b+ = b \u2208 X, b\u2212 = \u221e \u2208 P1 and \u03bdY\nequal to t\u22121 dt on P1 and \u03bd on X. Let t+ be the parameter tb , t\u2212 be the parameter\nt\u22121 at \u221e. The corresponding family of curves X \u2032 as defined in 5.2 (it was denoted\nby X there) over Q = A1 is the blow-up of X \u00d7 A1 at (b, 0). We have a datum\n2.13(b) with N equal to M (tb ) on P1 \\ {\u221e} and to M on X \\ {b} (this determines N\nsince it is !-extension with regular singularities at b\u2212 and \u2217-extension with regular\nsingularities at b+ ). Let L be any t\u00b1 \u2202t\u00b1 -invariant b\u00b1 -lattice in N such that the\neigenvalues of \u00b1t\u00b1 \u2202t\u00b1 on Lb\u00b1 and their pairwise differences do not contain nonzero integers. Then the spectra of the \u00b1t\u00b1 \u2202t\u00b1 actions on Lb\u00b1 coincide, and there\n\u223c\nis a canonical identification \u03b1 : Lb+ \u2192 Lb\u2212 characterized by the next property:\nConsider the t\u00b1 \u2202t\u00b1 -invariant embeddings Lb\u2212 \u2282 \u0393(P1 \\ {0}, L) and Lb+ \u2282 \u0393(U, L)\nas in 2.13(b). By the definition of M (tb ) , its sections over a punctured neighborhood\nof 0 are identified with sections of M over U \\{b}; by this identification the subspaces\nLb\u00b1 correspond to one another, and \u03b1 is the corresponding isomorphism. Let M \u2032 be\nthe corresponding family of OX -modules with relative connection on X/Q (which\nwas denoted by M in 5.2).\nAt q = 1 our M \u2032 equals M , so the top arrow in (5.2.3) at q = 1 equals \u03b7(M ).\nAnd the composition of its lower arrows equals the composition from the statement\nof our lemma. Since E 0 \u2208 E0 , the diagram commutes; we are done.\n\u0003\n\n5.9. Let us turn to the proof of Theorem\u2032 in 5.7. For E 0 \u2208 E0 let \u1e20 \u00d7 = \u1e20 \u00d7 be\nthe corresponding extension of Gm (see (5.7.3)) and E 0\u2032 \u2208 E0 be the object defined\n\u223c\nby \u1e20 \u00d7 (see (5.7.4)). We want to define a natural isomorphism \u03b9 : E 0 \u2192 E 0\u2032 .\nFor (X, T, M ) as in 5.1 we define a canonical isomorphism of factorization lines\n\u223c\n\n\u03b9 : E 0 (M ) \u2192 E 0\u2032 (M )\n\n(5.9.1)\nrs\n\nas follows. Due to isomorphism (5.8.2), we can assume that M = M . Now \u03b9 is\na unique isomorphism of local nature which is compatible with constraints 5.1(ii)0\nand 5.5(iii), and is the identity map for M = Mm (see 5.6). Indeed, we can assume\nthat X is a disc, T = {b}, and, by 5.5(iii), that M is \u2217-extension at b. Then\nM = \u2295M (m) , where the monodromy around b acts on M (m) with eigenvalues m.\nBy compatibility with 5.1(ii)0 , we can assume that M = M (m) . Pick any filtration\n\u223c\non M with successive quotients of rank 1 and define \u03b9 as the composition E 0 (M ) \u2192\n\u223c\n\u223c\n\u2297E 0 (gri M ) = \u2297E 0\u2032 (gri M ) \u2192 E 0\u2032 (M ) where \u2192 are constraints 5.1(ii)0 . The choice\nof the filtration is irrelevant by 5.10 (for the space of filtrations is connected).\nOur \u03b9 is compatible with constraints 5.1(i)0 , 5.1(ii)0 ; its compatibility with\n5.1(iii)0 will be checked in 5.13. We treat 5.1(iv)0 first; this takes 5.10\u20135.12. For\n\n\fE-Factors for the Period Determinants of Curves\n\n61\n\n(X, T, M ) with compact X let \u03be(X, M ) \u2208 C\u00d7 be the ratio of \u03b7(M ) for E 0 and the\ncomposition of \u03b7(M ) for E 0\u2032 with \u03b9. We want to show that \u03be(X, M ) \u2261 1.\n5.10. By 5.8 and the construction of \u03b9, it suffices to consider M with regular\nsingularities. By 5.5(iii), \u03be(X, M ) depends only on M |X\\T . Therefore, by compatibility with 5.10 , \u03be(X, M ) depends only on the purely topological datum of (the\nisomorphism class of) a punctured oriented surface X \\ T (that can be replaced by\na compact surface with boundary) and a local system on it.\nThe compatibility with quadratic degenerations implies that if Y is obtained\nfrom X by cutting along a disjoint union of embedded circles and N = M |Y , then\n\u03be(X, M ) = \u03be(Y, N ). Here is an application:\nLemma. (i) If M admits a filtration such that gri M are D-modules of rank 1, then\n\u03be(X, M ) = 1.\n(ii) For every (X, T, M ) with X connected one can find (X \u2032 , T, M \u2032 ) such that the\nrestriction of M to a neighborhood of T is isomorphic to that of M \u2032 , X \u2032 is connected\nof any given genus g \u2265 g(X), and \u03be(X, M ) = \u03be(X \u2032 , M \u2032 ).\n(iii) For every (X, T, M ) one can find (X \u2032 , T, M \u2032 ) with X \u2032 connected such that\n\u03be(X, M ) = \u03be(X \u2032 , M \u2032 ) and for every b \u2208 T the restriction of M \u2032 to a neighborhood\nof b is isomorphic to that of M plus a direct sum of copies of a trivial D-module.\nProof. (i) By compatibility with 5.1(ii)0 , we can assume that M is a D-module\nof rank 1. Our assertion is true if X has genus 0 by the construction. An arbitrary\nX can be cut into a union of genus 0 surfaces, and we are done.\n(ii) Consider Y = X \u2294Z where Z is a compact smooth connected curve of genus\ng \u2212 g(X); let N be a DY -module such that N |X = M and N |Z is a trivial D-module\nof the same rank as M . Pick x \u2208 X \\ T , z \u2208 Z, cut off small discs around x, z\nand connect their boundaries by a tube. This is X \u2032 . Take for M \u2032 any extension of\nMY (restricted to the complement of the cut discs) to a local system on X \u2032 . Since\n\u03be(Z, N |Z ) = 1 by (i), one has \u03be(Y, N ) = \u03be(X, M ), hence \u03be(X \u2032 , M \u2032 ) = \u03be(X, M ).\n(iii) Let us construct (X \u2032 , M \u2032 ). First, add to M on different components of X\nappropriate number of copies of the trivial D-module to assure that the rank of M\nis constant; this does not change \u03be(X, M ) by (i). Let X1 , . . . , Xn be the connected\ncomponents of X. On each Xi \\ T , choose a pair of distinct points xi , yi . Cut off\nsmall discs around x1 , . . . , xn\u22121 and y2 , . . . , yn , and connect the boundary circle at\nxi with that at yi+1 by a tube. This is our X \u2032 . Take for M \u2032 any extension of M to\na local system on X \u2032 .\n\u0003\n5.11. Proposition. For X connected, \u03be(X, M ) depends only on the datum of\nconjugacy classes of local monodromies of M (the rank of M is fixed).\nProof. According to [PX1], [PX2], the action of the mapping class group on the\nmoduli of unitary local systems of given rank with fixed cojugacy classes of local\nmonodromies, is ergodic (provided that the genus of the Riemann surface is > 1).\nAs in Theorem 1.4.1 in [G], this implies that for connected X with g(X) > 1 our\n\u03be(X, M ) depends only on g(X), the rank of M , and the datum of conjugacy classes\nof local monodromies of M (indeed, \u03be is invariant with respect to the action of the\nmapping class group by the compatibility with 5.10 , and is holomorphic; by the\nergodicity, its restriction to the real points of the moduli space of local systems is\n\n\f62\n\nAlexander Beilinson\n\nconstant, and we are done). Use 5.10(ii) to eliminate the dependence on g(X) (and\nthe condition on g(X)).\n\u0003\n5.12. For any (X, M ), let Sp(M ) be the datum of other than 1 eigenvalues\n(with multiplicity) of the direct sum of local monodromies. We write it as an\nelement \u03a3ni zi (zi are the eigenvalues, ni are the multiplicities) of the quotient of\nDiv(C\u00d7 ) modulo the subgroup of divisors supported at 1 \u2208 C\u00d7 .\nLemma. \u03be(X, M ) depends only on Sp(M ).\nProof. (i) By 5.10(iii), it suffices to check this assuming that X is connected,\nand by 5.10(i) we can assume that the rank of M is fixed. By 5.11, it suffices to find\nfor any (X, M ) some (X \u2032 , M \u2032 ) such that \u03be(X, M ) = \u03be(X \u2032 , M \u2032 ), Sp(M ) = Sp(M \u2032 ),\nand each local monodromy of M \u2032 has at most one eigenvalue different from 1. Take\nany b \u2208 T ; let mb be the local monodromy at b. Then one can find a local system\nK(b) on P1 with ramification at \u221e and n other points, n = rk(M ), such that its local\nmonodromy at \u221e is conjugate to m\u22121\nb , and K(b) admits a flag of local subsystems\nsuch that each gri K(b) has rank 1 and ramifies at \u221e and only one other point.\nCut a small disc around b in X and that around \u221e in P1 , and connect the two\n\u2032\n\u2032\nboundary circles by a tube; we get a surface X(b)\n. Let M(b)\nbe a local system on it\n1\n\u2032\n\u2032\nthat extends M and K(b) . By 5.10(i), \u03be(P , K(b) ) = 1, so \u03be(X(b)\n, M(b)\n) = \u03be(X, M )\nby the compatibility with quadratic degenerations. Repeating this construction for\neach point of T , we get (X \u2032 , M \u2032 ).\n\u0003\nThe lemma implies that \u03be(X, M ) = 1. Indeed, if Sp(M ) = \u03a3ni zi , then \u03a0zini =\n1 (for the product does not change if we replace M by det M , where it equals 1 by\nthe Stokes formula). Therefore one can find a D-module M \u2032 of rank 1 on P1 with\nSp(M \u2032 ) = Sp(M ). Since \u03be(X, M \u2032 ) = 1, we are done by the lemma.\n5.13. It remains to check that \u03b9 of (5.9.1) is compatible with 5.1(iii)0 . We want\nto show that for \u03c0 : X \u2032 \u2192 X and a D-module M \u2032 the diagram\n\u03b9\n\nE 0 (\u03c0\u2217 M \u2032 ) \u2212\u2192 E 0\u2032 (\u03c0\u2217 M \u2032 )\n\u2193\n\u2193\n\u03c0\u2217 \u03b9\n0\n\u2032\n0\u2032\n\u03c0\u2217 E (M ) \u2212\u2192 \u03c0\u2217 E (M \u2032 ),\n\n(5.13.1)\n\nwhere the vertical arrows are constraints 5.1(iii)0 for E 0 , E 0\u2032 , commutes. For b \u2208 X\n(1)\n(1)\nlet \u03c8(M \u2032 , \u03c0, b) be the ratio of the morphisms E 0 (\u03c0\u2217 M \u2032 )b \u2192 \u03c0\u2217 E 0\u2032 (M \u2032 )b that\ncome from the two sides of the diagram. We want to show that \u03c8(M \u2032 , \u03c0, b) \u2261 1\n(see 1.6). It is clear that \u03c8(M \u2032 , \u03c0, b) = 1 if \u03c0 is unramified at b.\nOur \u03c8 has X-local nature and it is multiplicative with respect to disjoint unions\nof X \u2032 , so it suffices to consider the case when X, X \u2032 are discs and \u03c0 = \u03c0 (n) is\nramified of index n at b. Choosing a local coordinate t at b, we identify X \u2032 and X\nwith neighborhoods of 0 in P1 so that our covering is the restriction of \u03c0 : P1 \u2192 P1 ,\nt 7\u2192 tn , to X. Let us extend M \u2032 to a D-module on P1 , which we again denote by\nM \u2032 , such that it is smooth outside 0 and 1. We know that 5.1(iii)0 is compatible\nwith 5.1(iv)0 for both E 0 and E 0\u2032 . Since \u03b9 is compatible with 5.1(iv)0 and \u03c0 is\nramified only at 0 and \u221e, we know that \u03c8(M \u2032 , \u03c0, 0)\u03c8(M \u2032 , \u03c0, \u221e) = 1. Since M \u2032\nis smooth over \u221e, this means that \u03c8(M \u2032 , \u03c0 (n) , b)\u03c8(OX \u2032 , \u03c0 (n) , b)rk(M) = 1. We are\nreduced to the case M \u2032 = OX \u2032 .\n\n\fE-Factors for the Period Determinants of Curves\n\n63\n\nSet \u03c8n := \u03c8(OX \u2032 , \u03c0 (n) , b). By above, \u03c8n2 = 1, i.e., \u03c8n = \u00b11. By the construction of E 0\u2032 (see 5.7), one has \u03c82 = 1. Due to compatibility with the composition,\nn\nn\u22121\none has \u03c8mn = \u03c8n \u03c8m\n= \u03c8m \u03c8nm , i.e, \u03c8nm\u22121 = \u03c8m\n. For m = 2 we get \u03c8n \u2261 1,\nq.e.d.\n\u0003\n6 The \u0393-function.\n\u223c\n\n6.1. Let us describe explicitly the \u03b5-period map \u03c1\u03b5 = \u03c1\u03b5 (M ) : EdR (M ) \u2192\nEB (M ) for \u03c1\u03b5 \u2208 EB/dR (see 5.4).\n\u03ba\n\u223c\nBy 5.8, \u03c1\u03b5 (M ) equals the composition EdR (M ) \u2192 EdR (M rs ) \u2192 EB (M rs ) =\n\u223c\nEB (M ), where \u03ba is the canonical isomorphism of (5.8.1) and \u2192 is \u03c1\u03b5 (M rs ). A\ndifferent construction of the same \u03ba was given in (3.1.1) in terms of certain analytical\nFredholm determinant (a version of \u03c4 -function).\nFrom now on we assume that M has regular singularities.\nBy (1.6.3), Example in 1.6, and Remark in 1.15, E? (M ) amounts to a datum\n(1)\n(1)\n(E? (M )X\\T , {E? (M )b }). Thus \u03c1\u03b5 is completely determined by the isomorphisms\n(1)\n\n\u223c\n\n(1) \u223c\n\n(1)\n\nEdR (M )X\\T \u2192 EB (M )X\\T and EdR (M )b\n\n(1)\n\n\u2192 EB (M )b , b \u2208 T .\n(1) \u223c\n\n(1)\n\nLet us write a formula for \u03c1\u03b5 = \u03c1\u03b5b : EdR (M )b \u2192 EB (M )b , b \u2208 T . Below t is\na local parameter at b, and ib , jb are the embeddings {b} \u0592\u2192 Xb \u2190\u0593 Xbo := Xb \\ {b}.\n(1)\n(1)\nIf M is supported at b, then EdR (M )b = EB (M )b = det R\u0393dR (X, M ) and\n(1)\n(1)\n\u03c1\u03b5b is the identity map. Thus for arbitrary M one has E? (M )b = E? (jb\u2217 M )b \u2297\ndet R\u0393dR {b} (X, M ) and\n\u03c1\u03b5b (M ) = \u03c1\u03b5b (jb\u2217 M ) \u2297 iddet R\u0393dR {b} (X,M) .\n\n(6.1.1)\n\n\u03c1\u03b5b\n\nSo it suffices to define\nfor M = jb\u2217 M . Then we have a canonical trivialization\n(1)\n!\n1b of EB (M )b := EB (M )(b,t\u22121 dt) , see 4.7.\nLet L be a t\u2202t -invariant b-lattice in M . Denote by \u039b(L) the spectrum of the\noperator t\u2202t acting on on Lb = L/tL. Suppose that it does not contain positive\nintegers. Then the complex C(L, \u03c9L(b)) (see 2.4) is acyclic; here L(b) := t\u22121 L,\ni.e., \u03c9L(b) = t\u22121 dtL. Denote by \u03b9(L)zt\u22121 dt the corresponding trivialization of\n\u223c\nEdR (M )(b,zt\u22121 dt) \u2192 det C(L, \u03c9L(b)), z 6= 0 (see (2.5.6)); it does not depend on\nthe choice of t. If L\u2032 \u2283 L is another lattice, then \u03b9(L)zt\u22121 dt /\u03b9(L\u2032 )zt\u22121 dt is the\ndeterminant of the action of z \u22121 t\u2202t on L\u2032 /L (see 2.5). In particular, we have a\n(1)\ntrivialization \u03b9(L)t\u22121 dt of EdR (M )b .\nWe write \u03c1\u03b5b (\u03b9(L)t\u22121 dt ) = \u03b3\u03c1! \u03b5 (L)1!b . For example, if M = Mt\u03bb is the D-module\n\u03bb\nMt generated by t\u03bb , t\u2202t (t\u03bb ) = \u03bbt\u03bb , where \u03bb \u2208 C \\ Z>0 , and L = L\u03bbt is the lattice\ngenerated by t\u03bb , then \u039b(L\u03bbt ) = {\u03bb}, and we write \u03b3\u03c1! \u03b5 (\u03bb) := \u03b3\u03c1! \u03b5 (L\u03bbt ).\nTheorem. (i) One has \u03b3\u03c1! \u03b5 (L) =\n\n\u03a0\n\n\u03bb\u2208\u039b(L)\n\n\u03b3\u03c1! \u03b5 (\u03bb).\n\n(ii) For a \u2208 Z one has28 \u03b3\u03c1! \u03b5 +a (\u03bb) = (\u22121)a exp(\u22122\u03c0i\u03bba)\u03b3\u03c1! \u03b5 (\u03bb).\n(iii) For one \u03c1\u03b5 in EB/dR one has\n\u03b3\u03c1! \u03b5 (\u03bb) = (2\u03c0)\u22121/2 (1 \u2212 exp(2\u03c0i\u03bb))\u0393(\u03bb),\nwhere \u0393 is the Euler \u0393-function and (2\u03c0)1/2 is the positive square root.\n28 Recall\n\nthat EB/dR is a Z-torsor.\n\n(6.1.2)\n\n\f64\n\nAlexander Beilinson\n\nProof. (i) By above, for L\u2032 \u2283 L one has \u03b3\u03c1! \u03b5 (L)/\u03b3\u03c1! \u03b5 (L\u2032 ) = det(t\u2202t ; L\u2032 /L).\nTherefore the validity of (i) does not depend on the choice of L. So we can assume\nthat (M, L) is a successive extension of some (Mt\u03bb , L\u03bbt ), and we are done since all\nour objects are multiplicative with respect to extensions.\n(1)\n(ii) By 5.3(iii), \u03bc(Mt\u03bb ) acts on E(Mt\u03bb )b as multiplication by \u2212 exp(\u22122\u03c0i\u03bb).\n(iii) The claim follows from (ii) and the next lemma:\nLemma. (i) The function \u03b3\u03c1! \u03b5 (\u03bb) is holomorphic and invertible for \u03bb \u2208 C \\ Z>0 ,\nand satisfies the next relations: (a) \u03b3\u03c1! \u03b5 (\u03bb + 1) = \u03bb\u03b3\u03c1! \u03b5 (\u03bb); (b) For every positive\n1\n\u03bb+n\u22121\n!\n) = n 2 \u2212\u03bb \u03b3\u03c1! \u03b5 (\u03bb).\ninteger n one has \u03b3\u03c1! \u03b5 ( n\u03bb )\u03b3\u03c1! \u03b5 ( \u03bb+1\nn ) * * * \u03b3\u03c1\u03b5 (\nn\n(ii) Any function \u03b3 that satisfies the properties from (i) equals one of the functions\n\u03b3a (\u03bb) = (2\u03c0)\u22121/2 (\u22121)a exp(2\u03c0i\u03bba)(1 \u2212 exp(2\u03c0i\u03bb))\u0393(\u03bb) for some integer a.\nProof of Lemma. (i) We check (b); the rest is clear. Let \u03c0 : X \u2032 \u2192 X is a\ncovering of a disc completely ramified of index n at b, so for a parameter t\u2032 at b\u2032 one\nhas \u03c0 \u2217 (t) = t\u2032n , hence \u03c0 \u2217 (t\u22121 dt) = nt\u2032\u22121 dt\u2032 . Let M \u2032 be a D-module on X \u2032 which is\nthe \u2217-extension with regular singularities at b\u2032 . Consider isomorphisms\n\u03b1\n\n\u03b2\n\nEdR (\u03c0\u2217 M \u2032 )(x,t\u22121 dt) \u2212\u2192 EdR (M \u2032 )(x\u2032 ,mt\u2032\u22121 dt\u2032 ) \u2212\u2192 EdR (M \u2032 )(x\u2032 ,t\u2032\u22121 dt\u2032 )\n\u03b5\n\n(6.1.3)\n\nwhere \u03b1 is the projection formula identification and \u03b2 is the \u2207 -parallel transport\nalong the interval [m, 1]t\u2032\u22121 dt\u2032 . By the construction of 1!b , the Betti version of \u03b2\u03b1\ntransforms 1!b to 1!b\u2032 .\n\u03bb/n\n(\u03bb+1)/n\nSuppose M \u2032 equals Mt\u03bb\u2032 for some \u03bb \u2208 C. Then \u03c0\u2217 M \u2032 equals Mt \u2295 Mt\n\u2295\n(\u03bb+1)/n\n\u03bb/n\n(\u03bb+n\u22121)/n\n\u03bb\n\u2032\n\u2032\n\u03bb\n\u2295 ... \u2295\n. If L = Lt\u2032 \u2282 Mt\u2032 , then \u03c0\u2217 L = Lt \u2295 Lt\n. . . \u2295 Mt\n(\u03bb+(n\u22121))/n\nLt\n. It is clear that \u03b1 sends \u03b9(\u03c0\u2217 L\u2032 )t\u22121 dt to \u03b9(L\u2032 )nt\u2032\u22121 dt\u2032 . Since \u03b9(L\u2032 )\nis horizontal for the connection \u22070 of (2.11.3) (with l and n in loc. cit. equal\n1\nto 1), \u03b2 sends \u03b9(L\u2032 )nt\u2032\u22121 dt\u2032 to n 2 \u2212\u03bb \u03b9(L\u2032 )t\u2032\u22121 dt\u2032 . Now \u03c1\u03b5 (\u03b9(L\u2032 )t\u2032\u22121 dt\u2032 ) = \u03b3\u03c1! \u03b5 (\u03bb)1!b\u2032\n\u03bb+n\u22121 !\n!\n)1b , and we are\nand \u03c1\u03b5 (\u03b9(\u03c0\u2217 L\u2032 )t\u22121 dt ) = \u03b3\u03c1! \u03b5 (\u03c0\u2217 L\u2032 )1!b = \u03b3\u03c1! \u03b5 ( n\u03bb )\u03b3\u03c1! \u03b5 ( \u03bb+1\nn ) * * * \u03b3\u03c1\u03b5 (\nn\n\u03b5\ndone since \u03c1 is compatible with 5.1(iii).\n(ii) Denote by E the set of functions \u03b3 that satisfy properties from (i). Let E 0\nbe the set of functions e(\u03bb) which are invertible and holomorphic on the whole C\n\u03bb+n\u22121\nand satisfy the relations (a) e(\u03bb + 1) = e(\u03bb); (b) e( n\u03bb )e( \u03bb+1\n) = e(\u03bb)\nn ) * * * e(\nn\n0\nfor any positive integer n. Then E is a group with respect to multiplication, and\nE is an E 0 -torsor.\nNotice that the function \u03bc(\u03bb) := \u2212 exp(\u22122\u03c0i\u03bb) belongs to E 0 , and {\u03bba }a\u2208Z\nis a \u03bcZ -torsor. Recall that \u0393(\u03bb) is holomorphic and invertible for \u03bb \u2208 C \\ Z\u22640 ,\n) =\nand satisfies the next relations: (a) \u0393(\u03bb + 1) = \u03bb\u0393(\u03bb); (b) \u0393( n\u03bb ) . . . \u0393( \u03bb+n\u22121\nn\nn\u22121\n1\n(2\u03c0) 2 n 2 \u2212\u03bb \u0393(\u03bb) for any positive integer n. This implies that \u03b3a belong to E. To\nprove the lemma, it remains to check that \u03bc generates E 0 .\nPick any e \u2208 E 0 ; let a be the index of the holomorphic map e : C/Z \u2192\nC\u00d7 . Let us check that e\u03bca \u2261 1. Indeed, e\u03bca has index 0, so e\u03bca (\u03bb) = exp f (\u03bb)\nfor some holomorphic f : C/Z \u2192 C. Notice that for any n \u2208 Z>0 the function\n\u03bb+n\u22121\n) \u2212 f (\u03bb) takes values in 2\u03c0iZ, hence constant.\n\u03bb 7\u2192 f ( n\u03bb ) + f ( \u03bb+1\nn ) + . . . + f(\nn\nConsider the coefficients of the Laurent series f (\u03bb) = \u03a3bm exp(2\u03c0im\u03bb). The above\nproperty implies that (n \u2212 1)b\u00b1n = 0 for n > 1, i.e., bm = 0 for |m| > 1. The case\nn = 2 shows that b\u00b11 = 0. Finally the fact that (n \u2212 1)b0 \u2208 2\u03c0Z for any n > 0\nimplies that b0 \u2208 2\u03c0iZ, and we are done.\n\u0003\n\n\fE-Factors for the Period Determinants of Curves\n\n65\n(1)\n\n\u223c\n\n(1)\n\nCorollary. For \u03c1\u03b5 as in (6.1.2) the isomorphism \u03c1\u03b5 : EdR (M )X\\T \u2192 EB (M )X\\T\n(2.6.1)\n\n(1)\n\n(4.7.3)\n\n(1)\n\nequals the composition EdR (M )X\\T \u2212\u2192 (det MX\\T )\u2297\u22121 \u2212\u2192 EB (M )X\\T multiplied by ((2\u03c0)1/2 i)rk(M) . Replacing \u03c1\u03b5 by \u03c1\u03b5 + a multiplies it by (\u22121)rk(M)a .\nProof. Suppose M is smooth at b. Compatibility with 5.1(iii) implies, as in\n(1) \u223c\n(1)\nRemark in 5.3, that \u03c1\u03b5b : EdR (M )b \u2192 EB (M )b does not depend on whether\nb is viewed as a point of T or not. The exact sequence 0 \u2192 M \u2192 jb\u2217 jb\u2217 M \u2192\n(1)\nib\u2217 Mb \u2192 0 shows that R\u0393dR b (X, M ) = Mb [\u22121], hence E? (M )b = E? (jb\u2217 M )(1) \u2297\n(1) \u223c\n(det Mb )\u2297\u22121 . The isomorphisms E? (M )b \u2192 (det Mb )\u2297\u22121 come from trivializations\n(1)\nof E? (jb\u2217 M ) , which are \u03b9(M )t\u22121 dt in the de Rham and 1!b in the Betti case. Since\n\u03b3\u03c1! \u03b5 (M ) = ((2\u03c0)1/2 i)rk(M) by the theorem, we are done.\n\u0003\n\u03b5\nThe corollary together with the theorem completely determines \u03c1 (M ).\n6.2. Here is another explicit formula for\n\u223c\n\n\u03c1\u03b5 : EdR (M )(b,\u2212t\u22121 dt) \u2192 EB (M )(b,\u2212t\u22121 dt) .\n\u223c\n\nRecall that EB (M )(b,\u2212t\u22121 dt) \u2192 det R\u0393dR (Xb , M ) by (4.7.1); here Xb is a small\nopen disc at b. Let L be a t\u2202t -invariant b-lattice in M such that \u039b(L) does not\ncontain non-positive integers, L\u03c9 be the O-submodule of \u03c9M generated by \u2207(L)\n(this is a b-lattice). Then the projection\n\u0393(Xb , dR(M )) \u0589 C(L, L\u03c9 )\n\n(6.2.1)\n\u223c\n\nis a quasi-isomorphism. Together with isomorphism rL,\u2212t\u22121 dt : EdR (M )(b,\u2212t\u22121 dt) \u2192\n\u223c\ndet C(L, L\u03c9 ) from(2.5.6), it yields an identification e(L) : EdR (M )(b,\u2212t\u22121 dt) \u2192\nEB (M )(b,\u2212t\u22121 dt) . Thus \u03c1\u03b5(b,\u2212t\u22121 dt) = \u03b3\u03c1\u2217\u03b5 (L)e(L) for some \u03b3\u03c1\u2217\u03b5 (L) \u2208 C\u00d7 .\nProposition. One has \u03b3\u03c1\u2217\u03b5 (L) =\n\n\u03a0\n\n\u03bb\u2208\u039b(L)\n\n\u03b3\u03c1\u2217\u03b5 (\u03bb), and for \u03c1\u03b5 as in (6.1.2)\n\n\u03b3\u03c1\u2217\u03b5 (\u03bb) = (2\u03c0)\u22121/2 exp(\u03c0i(\u03bb \u2212 1/2))\u0393(\u03bb).\n\n(6.2.2)\n\nProof. If L\u2032 \u2283 L is another lattice as above, then e(L\u2032 )/e(L) is the determinant\nof the action of \u2212t\u2202t on tL\u2032 /tL, so the validity of the assertion does not depend on\nthe choice of L. It is compatible with filtrations, and holds for M supported at b, so\nwe can assume that M has rank 1 and is the \u2217-extension at b. Thus \u039b(L) = {\u03bb}; by\ncontinuity, it suffices to consider the case of \u03bb \u2208\n/ Z. Then the complexes in (6.2.1) are\nacyclic. The corresponding trivializations of EdR (M )(b,\u2212t\u22121 dt) and EB (M )(b,\u2212t\u22121 dt)\nare \u03b9(L)\u2212t\u22121 dt from 6.1 and 1\u2217b from 4.7; by construction, e(L)(\u03b9(L)\u2212t\u22121 dt ) = 1\u2217b .\nBy (2.11.3), the counterclockwise monodromy from t\u22121 dt to \u2212t\u22121 dt sends\n\u03b9(L)t\u22121 dt to exp(\u03c0i(\u03bb \u2212 1/2))\u03b9(L)\u2212t\u22121 dt . According to 4.8, the same monodromy\nsends 1!b to (1 \u2212 exp(\u22122\u03c0i\u03bb))\u22121 1\u2217b . Since \u03c1\u03b5 is horizontal, one has \u03b3\u03c1\u2217\u03b5 (\u03bb) = (1 \u2212\nexp(\u22122\u03c0i\u03bb))\u22121 \u03b3\u03c1! \u03b5 (\u03bb) exp(\u03c0i(1/2 \u2212 \u03bb)) = exp(\u03c0i(\u03bb \u2212 1/2))(1 \u2212 exp(2\u03c0i\u03bb))\u22121 \u03b3\u03c1! \u03b5 (\u03bb),\nand we are done by (6.1.2).\n\u0003\nExample. If M is smooth at b and L = tM , then isomorphism (6.2.1) is\n1\n\u223c\n\u0393(Xb , M \u2207 ) \u2192 Mb , m 7\u2192 mb , and \u03b3\u03c1\u2217\u03b5 (tM ) = ((2\u03c0)\u2212 2 i)rk(M) e(L).\nExercise. Deduce Euler's reflection formula \u0393(\u03bb)\u0393(1 \u2212 \u03bb) = \u03c0 sin\u22121 (\u03c0\u03bb) from\n(6.1.2), (6.2.2), the lemma in 2.7, and Exercise in 4.7.\n\n\f66\n\nAlexander Beilinson\n\n6.3. Let us write down a formula for the factors [\u03c1\u03b5(O,\u03bd) ] from 0.3.\nRecall that we have X, M and \u03bd defined over a subfield k of C, and B(M ) is\ndefined over a subfield k \u2032 . The finite set of singular points of M and \u03bd is defined\nthen over k; it is partitioned by Aut(C/k)-orbits. Let O be such an orbit. The\nC-line EdR (M )(O,\u03bd) = \u2297 EdR (M )(x,\u03bd) is defined over k by \u00a72,29 and EB (M )(O,\u03bd) =\nx\u2208O\n\n\u223c\n\n\u2297 EB (M )(x,\u03bd) is defined over k \u2032 by \u00a74. Computing \u03c1\u03b5 : EdR (M )(O,\u03bd) \u2192 EB (M )(O,\u03bd) ,\n\nx\u2208O\n\n\u03c1\u03b5 \u2208 EB/dR , in k- and k \u2032 -bases, we get a number whose class [\u03c1\u03b5(O,\u03bd) ] in C\u00d7 /k \u2032\u00d7 k \u00d7\ndoes not depend on the choice of the bases and the choice of \u03c1\u03b5 in EB/dR . Let us\ncompute [\u03c1\u03b5(O,\u03bd) ] explicitly assuming that M has regular singularities.\nFor b \u2208 O let kb \u2282 C be its field of definition; let Xb be a small disc around\nb. Choose an auxiliary datum on the de Rham side: it is (t, L, u, v), where t is a\nparameter at b, L is a t\u2202t -invariant b-lattice in M , u is a non-zero vector in det Lb ,\nand v is a non-zero vector in det C(L, L\u03c9 ) (see 6.2); we assume that (t, L, u, v)\nare defined over kb . Let \u039bb be the spectrum (with multiplicities) of t\u2202t acting\non the fiber Lx ; we assume that \u039bb does not contain non-positive integers. An\nauxiliary datum on the Betti side is (\u03c6, w), where \u03c6 is a non-zero horizontal section\nof det M over the half-disc Re(t) > 0, which is defined over k \u2032 (with respect to the\nBetti k \u2032 -structure on the sheaf of horizontal sections), w is a non-zero vector in\ndet R\u0393dR (Xb , M ) defined over k \u2032 .\nThe data yield numbers: The leading term of \u03bd at b is \u03b1b t\u2212l dt, \u03b1b \u2208 kb\u00d7 ; let rb \u2208\nkb be the trace of t\u2202t acting on Lb . Notice that mb := exp(\u22122\u03c0rb ) is the monodromy\nof det Mb\u2207 around b, so mb \u2208 k \u2032\u00d7 . Then the section trb \u03c6 on the half-disc extends\nto an invertible holomorphic section of det L on Xb ; set \u03b2b := (trb \u03c6)b /u \u2208 C\u00d7 . Let\n\u03b4b \u2208 C\u00d7 be the ratio of v and the image of w by the determinant of (6.2.1).\nLet us compute the numbers \u03b1b , \u03b2b , \u03b4b and the spectrum \u039bb for each b \u2208 O\nusing Galois-conjugate de Rham side data. Set n := rk(M ).\nProposition. One has\n[\u03c1\u03b5(O,\u03bd) ] = \u03a0 (2\u03c0)\u2212\nb\u2208O\n\nnl\n2\n\nin\n\nl(l\u22121)\n2\n\nl\u22121\n\nnl\n\nmb 2 \u03b1b2\n\n\u2212rb\n\n\u03b2bl\u22121 \u03b4b \u03a0 \u0393(\u03bb).\n\u03bb\u2208\u039bb\n\n(6.3.1)\n\nProof. For the sake of clarity, we do the computation assuming that b is a\nk-point, leaving the general case to the reader.\nAs follows from (2.11.3), the validity of formula does not depend on \u03b1b . Notice\nthat the class of \u03b1b\u2212rb := exp(\u2212rb log(\u03b1b )) in C\u00d7 /k \u2032\u00d7 is well defined: adding 2\u03c0i to\nthe logarithm multiplies the exponent by mb \u2208 k \u2032\u00d7 .\nIf l = 1 and \u03b1b = \u22121, then the formula follows from (6.2.2).\nTo finish the proof, it remains to check that\nn\n\n[\u03c1\u03b5(b,\u2212t\u2212l\u22121 dt) ] = (2\u03c0)\u2212 2 in \u03b2[\u03c1\u03b5(b,t\u2212l dt) ].\nConsider a family of forms \u03bdx := t\u2212l (x\u2212t)\u22121 dt. Then EdR (M )(x,1b ,\u03bdx ) = \u03bc\u2207 (tl\u22121 (t\u2212\nx)L/L\u03c9 ) = det C(L, L\u03c9 ) \u2297 \u03bb(L/tl\u22121 (x \u2212 t)L)\u2297\u22121 = C(L, L\u03c9 ) \u2297 \u03bb(L/tl\u22121 L)\u2297\u22121 \u2297\n\u03bb(tl\u22121 L/tl\u22121 (x \u2212 t)L)\u2297\u22121 . We fix a non-zero l in \u03bb(L/tl\u22121 L) defined over k. Any\nlocal trivialization g of det L yields then a trivialization e(g)x := v\u2297l\u22121 \u2297tn(1\u2212l) gx\u22121\nof EdR (M )(x,1b ,\u03bdx ) ; if g is defined over k, then so is e(g).\n29 The group Aut(C/k) acts on E\ndR (M )(O,\u03bd) by transport of structure; its fixed points is the\nk-structure on EdR (M )(O,\u03bd) .\n\n\fE-Factors for the Period Determinants of Curves\n\n67\n\nThe leading terms of \u03bdx at t = 0 and t = x are x\u22121 t\u2212l dt and x\u2212l (x \u2212 t)\u22121 dt.\nApplying (2.11.2) to the x-lattice (x\u2212 t)L and (2.11.3) to the b-lattice tl\u22121 L, we see\nn(l\u22122)\nnl\nthat e(trb \u03c6)x = v \u2297 (x\u2212 2 \u2212rb l\u22121 )\u2297 (x\u2212 2 \u03c6\u22121 ) is a horizontal (with respect to x)\nsection of EdR (M )(x,1b ,\u03bdx ) . Since the value at b of \u03b2b tn(1\u2212l) (trb \u03c6)\u22121 is a generator\nof det(tl\u22121 L/tl L)\u2297\u22121 defined over k, we see that \u03b2b e(trb \u03c6)b \u2208 EdR (M )(b,\u2212t\u2212l\u22121 dt)\nis defined over k. If s a horizontal section of EB (M )(x,1b ,\u03bdx ) over Xb defined over k \u2032 ,\nthen \u03c1\u03b5 (e(trb \u03c6))/s is a constant function. Its value at x = 0, i.e., at b, belongs to\n\u03b2b\u22121 [\u03c1\u03b5(b,\u2212t\u2212l\u22121 dt) ]. By factorization and Example in 6.2, its value at x = 1 belongs\nn\nto [\u03c1\u03b5(b,t\u2212l dt) ](2\u03c0)\u2212 2 in , and we are done.\n\u0003\nNotation. a\u03c8 2.9; C(U ) 4.2; C(W, N ) 4.4; C(L, L\u03c9 ) 2.4; D, D\u22c4 , (D, c, \u03bdP ),\n(D, c, \u03bd) 1.1; |D| 1.1; dR(L, L\u03c9 ) 2.7; DetP/S (E), DetP/S (E1 /E2 ) 2.3; Div(X) 1.1;\nw\nE, w E0 5.1; E, E0 5.2; E 1.2; E (l) 1.6; EdR/B 5.4; e, eL 2.5; EB (M ) 4.6; EdR (M ) 2.5;\n(l)\nI(U, N ) 4.3; G\u266d 2.2; HomL (J1 , J2 ) 2.2; jT \u2217 M 2.4; K(D), K(D)\u00d7\n1.1;\nD,c 1.1; K\n\u00d7\n\u00d7\n0\n(l)\nKTb 1.1; L? , Lk , LO , LdR 1.2; Linv\n(K\n)\n1.11;\nL\n1.7;\nL\n(X,\nT\n),\nL\n(X,\nT\n)\n,\ndR\ndR\ndR\ndR\nTb\n\u266e\n(l)\n\u03a6\n\u03a6\nO-triv\n\u03a6\nLdR (X \\ T ) 1.6; L? 1.5; LdR (X, T ; K) 1.11; LdR (X, T )\n, L? (X, T ; K)T 1.13;\n\u00d7\nM(C(U )) 4.1; OD,c\n1.1; OT\u00d7b 1.1; PD,c 1.1; Rat 1.4; rL,\u03bd 2.5; Vcrys 1.2; V sm 1.3;\n\u03c4\u03c8 2.9; \u03c4N 4.3; T , TSc 1.1; \u03b3\u03c1\u2217\u03b5 (L), \u03b3\u03c1\u2217\u03b5 (\u03bb) 6.2; \u03b3\u03c1! \u03b5 (L), \u03b3\u03c1! \u03b5 (\u03bb) 6.1; \u03bbP 2.3; \u03bb(F ) 4.2;\n\u2207/\u03ba\n\n\u03ba/\u03bd\n\n\u03bd\n\u03c8\n\u039b(L) 6.1; \u03bc\u2207\n, \u03bcP 2.10; \u03c00 (X), \u03c00 (L), \u03c01 (L) 1.1; \u03c6\u03ba\nP 2.4; \u03bcP 2.5; \u03bc 2.9; \u03bcP\n\u03b5\n2.10; \u2207 2.11; \u03c9(X, T ) 1.12; \u03a91 (KT\u00d7 )inv 1.10; \u03c4\u03c8 2.9; 1!b , 1\u2217b 4.7; 2T 1.1.\n\nReferences\n[A]\n\nG. Anderson, Local factorization of determinants of twisted DR cohomology groups, Compositio Math. 83 (1992), no. 1, 69\u2013105.\n[B]\nA. Beilinson, Topological E-factors, Pure Appl. Math. Q. 3 (2007), no. 1, 357\u2013391.\n[BBE] A. Beilinson, S. Bloch, H. Esnault, E-factors for Gauss-Manin determinants, Moscow\nMathematical Journal 2 (2002), no. 3, 477\u2013532.\n[BD] A. Beilinson, V. Drinfeld, Quantization of Hitchin's integrable system and Hecke eigensheaves, http://www.math.uchicago.edu/\u223cmitya/langlands.html\n[BG] A. Beilinson, D. Gaitsgory, A corollary of the b-function lemma, math.AG 0810.1504\n(2008).\n[Bj]\nJ.-E. Bj\u00f6rk, Analytic D-modules and applications, Mathematics and its Applications,\nKluwer Academic Publishers, Dordrecht-Boston-London, 1993.\n[BDE] S. Bloch, P. Deligne, H. Esnault, Periods for irregular connections on curves (2005).\n[BE] S. Bloch, H. Esnault, Homology for irregular connections, J. Th\u00e9or. Nombres Bordeaux\n16 (2004), no. 2, 357\u2013371.\n[CC] C. Contou-Carr\u00e8re, Jacobienne locale, groupe de bivecteurs de Witt universel, et symbole\nmod\u00e9r\u00e9, C. R. Acad. Sci. Paris S\u00e9r. I Math. 318 (1994), no. 8, 743\u2013746.\n[Del] P. Deligne, Seminar at IHES, Spring 1984, handwritten notes by G. Laumon,\nhttp://www.math.uchicago.edu/\u223cmitya/langlands.html\n[Den] C. Deninger, Local L-factors of motives and regularized determinants, Invent. Math. 107\n(1992), 135\u2013150.\n[Dr]\nV. Drinfeld, Infinite-dimensional vector bundles in algebraic geometry, The Unity of Mathematics. In Honor of the 90th Birthday of I.M. Gelfand. Progress in Mathematics, vol. 244,\nBirkh\u00e4user, Boston-Basel-Berlin, 2006, pp. 263\u2013304.\n[E]\nH. Esnault, Talk at the Tokyo conference \"Ramification and vanishing cycles\", 2007,\nhttp://www.ms.u-tokyo.ac.jp/\u223ct-saito/conf/rv/rv.html\n[G]\nW. Goldman, The complex-symplectic geometry of SL(2, C)-characters over surfaces, Algebraic groups and arithmetic, Tata Inst. Fund. Res., Mumbai, 2004, pp. 375\u2013407.\n[Gr1] A. Grothendieck, Sur certains espaces de fonctions holomorphes, I,II, J. Reine Angew.\nMath. 192 (1953), 35\u201364, 77\u201395.\n[Gr2] A. Grothendieck, La th\u00e9orie de Fredholm, Bulletin de la S.M.F. 84 (1956), 319\u2013384.\n\n\f68\n\n[I]\n\nAlexander Beilinson\n\nR. Ishimura, Homomorphismes du faisceau des germes de fonctions holomorphes dans luim\u00eame et op\u00e9rateurs diff\u00e9rentiels, Memoirs of the Faculty of Science, Kyushu University\n32 (1978), 301\u2013312.\n[L]\nG. Laumon, Transformation de Fourier, constantes d'equations fonctionelles et conjecture\nde Weil, Publ. Math. IHES 65 (1987), 131\u2013210.\n[M]\nB. Malgrange, \u00c9quations diff\u00e9rentielles \u00e0 coefficients polynomiaux, Progress in Mathematics, vol. 96, Birkh\u00e4user, Boston, MA, 1991.\n[LS]\nF. Loeser, C. Sabbah, \u00c9quations aux diff\u00e9rences finies et d\u00e9terminants d'int\u00e9grales de\nfonctions multiformes, Comment. Math. Helv. 66 (1991), no. 3, 458\u2013503.\n[Me] Z. Mebkhout, Une \u00e9quivalence de cat\u00e9gories, Compositio Math. 51 (1984), no. 1, 51\u201362.\n[P]\nD. Patel, Thesis, University of Chicago (2008).\n[PX1] D. Pickrell, E. Xia, Ergodicity of mapping class group actions on representation varieties,\nI. Closed surfaces, Comment. Math. Helv. 77 (2002), 339\u2013362\n[PX2] D. Pickrell, E. Xia, Ergodicity of mapping class group actions on representation varieties,\nII. Surfaces with boundary, Transformation Groups 8 (2003), no. 4, 397\u2013402.\n[PS] A. Pressley, G. Segal, Loop groups, Oxford Mathematical Monographs, The Clarendon\nPress, Oxford University Press, New York, 1986.\n[PSch] F. Prosmans, J.-P. Schneiders, A topological reconstruction theorem for D \u221e -modules, Duke\nMath J. 102 (2000), no. 1, 39\u201386.\n[ST] T. Saito, T. Terasoma, Determinant of period integrals, J. Amer. Math. Soc. 10, (1997),\nno. 4, 865\u2013937.\n[SW] G. Segal, G. Wilson, Loop groups and equations of KdV type, Publ. Math. IHES 61 (1985),\n5\u201365.\n[T]\nT. Terasoma, A product formula for period integrals, Math. Ann. 298 (1994), 577\u2013589.\n\n\f"}