{"id": "http://arxiv.org/abs/1012.0569v3", "guidislink": true, "updated": "2011-05-20T17:25:01Z", "updated_parsed": [2011, 5, 20, 17, 25, 1, 4, 140, 0], "published": "2010-12-02T21:00:06Z", "published_parsed": [2010, 12, 2, 21, 0, 6, 3, 336, 0], "title": "Photons and Baryons before Atoms: Improving the Tight-Coupling\n  Approximation", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1012.4137%2C1012.4490%2C1012.1619%2C1012.0181%2C1012.4388%2C1012.5380%2C1012.3027%2C1012.0406%2C1012.3219%2C1012.1498%2C1012.0569%2C1012.5556%2C1012.5926%2C1012.1019%2C1012.3644%2C1012.4044%2C1012.5264%2C1012.3927%2C1012.1710%2C1012.2229%2C1012.4716%2C1012.2945%2C1012.2013%2C1012.1348%2C1012.5071%2C1012.1275%2C1012.1889%2C1012.4863%2C1012.0772%2C1012.5850%2C1012.3215%2C1012.1465%2C1012.3521%2C1012.2462%2C1012.4774%2C1012.5453%2C1012.3818%2C1012.1209%2C1012.0442%2C1012.0214%2C1012.1051%2C1012.5608%2C1012.5070%2C1012.0224%2C1012.2504%2C1012.2417%2C1012.2856%2C1012.2693%2C1012.1300%2C1012.1958%2C1012.1218%2C1012.2202%2C1012.5908%2C1012.0799%2C1012.1496%2C1012.2365%2C1012.5458%2C1012.5885%2C1012.4561%2C1012.4584%2C1012.5002%2C1012.3804%2C1012.3770%2C1012.3163%2C1012.3340%2C1012.0285%2C1012.0101%2C1012.2472%2C1012.5203%2C1012.1305%2C1012.0276%2C1012.3193%2C1012.0666%2C1012.4768%2C1012.1499%2C1012.5816%2C1012.0754%2C1012.1723%2C1012.1415%2C1012.3935%2C1012.5136%2C1012.1233%2C1012.3655%2C1012.6020%2C1012.3306%2C1012.2217%2C1012.2460%2C1012.0172%2C1012.2939%2C1012.4860%2C1012.5274%2C1012.3541%2C1012.5695%2C1012.5382%2C1012.0421%2C1012.0459%2C1012.1214%2C1012.1207%2C1012.0889%2C1012.0684%2C1012.5262&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Photons and Baryons before Atoms: Improving the Tight-Coupling\n  Approximation"}, "summary": "Prior to recombination photons, electrons, and atomic nuclei rapidly\nscattered and behaved, almost, like a single tightly-coupled photon-baryon\nplasma. We investigate here the accuracy of the tight-coupling approximation\ncommonly used to numerically evolve the baryon and photon perturbation\nequations at early times. By solving the exact perturbations equations with a\nstiff solver starting deep in the radiation-dominated epoch we find the level\nof inaccuracy introduced by resorting to the standard first-order\ntight-coupling approximation. We develop a new second-order approximation in\nthe inverse Thomson opacity expansion and show that it closely tracks the full\nsolution, at essentially no extra numerical cost. We find the bias on estimates\nof cosmological parameters introduced by the first-order approximation is, for\nmost parameters, negligible. Finally, we show that our second-order\napproximation can be used to reduce the time needed to compute cosmic microwave\nbackground angular spectra by as much as ~17%.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1012.4137%2C1012.4490%2C1012.1619%2C1012.0181%2C1012.4388%2C1012.5380%2C1012.3027%2C1012.0406%2C1012.3219%2C1012.1498%2C1012.0569%2C1012.5556%2C1012.5926%2C1012.1019%2C1012.3644%2C1012.4044%2C1012.5264%2C1012.3927%2C1012.1710%2C1012.2229%2C1012.4716%2C1012.2945%2C1012.2013%2C1012.1348%2C1012.5071%2C1012.1275%2C1012.1889%2C1012.4863%2C1012.0772%2C1012.5850%2C1012.3215%2C1012.1465%2C1012.3521%2C1012.2462%2C1012.4774%2C1012.5453%2C1012.3818%2C1012.1209%2C1012.0442%2C1012.0214%2C1012.1051%2C1012.5608%2C1012.5070%2C1012.0224%2C1012.2504%2C1012.2417%2C1012.2856%2C1012.2693%2C1012.1300%2C1012.1958%2C1012.1218%2C1012.2202%2C1012.5908%2C1012.0799%2C1012.1496%2C1012.2365%2C1012.5458%2C1012.5885%2C1012.4561%2C1012.4584%2C1012.5002%2C1012.3804%2C1012.3770%2C1012.3163%2C1012.3340%2C1012.0285%2C1012.0101%2C1012.2472%2C1012.5203%2C1012.1305%2C1012.0276%2C1012.3193%2C1012.0666%2C1012.4768%2C1012.1499%2C1012.5816%2C1012.0754%2C1012.1723%2C1012.1415%2C1012.3935%2C1012.5136%2C1012.1233%2C1012.3655%2C1012.6020%2C1012.3306%2C1012.2217%2C1012.2460%2C1012.0172%2C1012.2939%2C1012.4860%2C1012.5274%2C1012.3541%2C1012.5695%2C1012.5382%2C1012.0421%2C1012.0459%2C1012.1214%2C1012.1207%2C1012.0889%2C1012.0684%2C1012.5262&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Prior to recombination photons, electrons, and atomic nuclei rapidly\nscattered and behaved, almost, like a single tightly-coupled photon-baryon\nplasma. We investigate here the accuracy of the tight-coupling approximation\ncommonly used to numerically evolve the baryon and photon perturbation\nequations at early times. By solving the exact perturbations equations with a\nstiff solver starting deep in the radiation-dominated epoch we find the level\nof inaccuracy introduced by resorting to the standard first-order\ntight-coupling approximation. We develop a new second-order approximation in\nthe inverse Thomson opacity expansion and show that it closely tracks the full\nsolution, at essentially no extra numerical cost. We find the bias on estimates\nof cosmological parameters introduced by the first-order approximation is, for\nmost parameters, negligible. Finally, we show that our second-order\napproximation can be used to reduce the time needed to compute cosmic microwave\nbackground angular spectra by as much as ~17%."}, "authors": ["Francis-Yan Cyr-Racine", "Kris Sigurdson"], "author_detail": {"name": "Kris Sigurdson"}, "author": "Kris Sigurdson", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevD.83.103521", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1012.0569v3", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1012.0569v3", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "10 pages, 6 figures. Published version. Codes available at\n  http://www.phas.ubc.ca/~francis", "arxiv_primary_category": {"term": "astro-ph.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "gr-qc", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "hep-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1012.0569v3", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1012.0569v3", "journal_reference": "Phys.Rev.D83:103521,2011", "doi": "10.1103/PhysRevD.83.103521", "fulltext": "Photons and Baryons before Atoms: Improving the Tight-Coupling Approximation\nFrancis-Yan Cyr-Racine\u2217 and Kris Sigurdson\u2020\n\narXiv:1012.0569v3 [astro-ph.CO] 20 May 2011\n\nDepartment of Physics and Astronomy, University of British Columbia, Vancouver, BC, V6T 1Z1, Canada\n(Dated: October 22, 2018)\nPrior to recombination photons, electrons, and atomic nuclei rapidly scattered and behaved,\nalmost, like a single tightly-coupled photon-baryon plasma. We investigate here the accuracy of\nthe tight-coupling approximation commonly used to numerically evolve the baryon and photon\nperturbation equations at early times. By solving the exact perturbations equations with a stiff\nsolver starting deep in the radiation-dominated epoch we find the level of inaccuracy introduced\nby resorting to the standard first-order tight-coupling approximation. We develop a new secondorder approximation in the inverse Thomson opacity expansion and show that it closely tracks the\nfull solution, at essentially no extra numerical cost. We find the bias on estimates of cosmological\nparameters introduced by the first-order approximation is, for most parameters, negligible. Finally,\nwe show that our second-order approximation can be used to reduce the time needed to compute\ncosmic microwave background angular spectra by as much as \u223c 17%.\nPACS numbers: 98.80.-k,98.80.Jk\n\nI.\n\nINTRODUCTION\n\nThe cosmic microwave background (CMB) radiation\nprovides us with a picture of the Universe as it looked\nwhen the first atoms formed, about 380 000 years after\nthe big bang. At that time, photons and baryonic\nmatter practically ceased interacting and the Universe\nbecame transparent to radiation, allowing CMB photons\nto free-stream through space. To extract accurate\ncosmological information from CMB data it is crucial\nto understand the evolution of the photon-baryon\nplasma before decoupling. This involves solving the\nBoltzmann equations for both photons and baryons\ncoupled by a Thomson-scattering collision term [1\u20137].\nHowever, the large value of the Thomson opacity (\u03c4c\u22121 )\nbefore recombination renders these equations stiff, and\nhence difficult to solve numerically. This difficulty is\nusually circumvented by making use of the so-called\n\"tight-coupling\" approximation [1]. In this scheme,\nan alternative (approximate) form of the equations is\nfound and used to find the solution by systematically\nexpanding the problematic terms to first order in \u03c4c .\nAt late times, once the Thomson opacity drops below\na certain threshold, one switches back to the exact\nequations to determine the final answer.\nRecently, it has been shown that uncertainties in the\ncosmological recombination process may lead to a bias in\nestimates of cosmological parameters [8\u201310]. Could the\ntight-coupling approximation also result in such a bias\nand affect the final result of modern Boltzmann codes\nsuch as CAMB [11] or CMBFAST [12]? In this paper, we first\ninvestigate the accuracy of the tight-coupling approximation by directly solving the exact set of equations at all\n\n\u2217 Electronic\n\u2020 Electronic\n\naddress: francis@phas.ubc.ca\naddress: krs@phas.ubc.ca\n\ntimes using a stiff integration scheme. This necessitates\ncalculating more accurate cosmological initial conditions\nthan has been done in the past. While not efficient, solving the exact equations allows us to determine the level of\ninaccuracy introduced by resorting to the tightly-coupled\nlimit at early times. We then design a higher-order expansion scheme and show that at second order in k\u03c4c and\n\u03c4\u0307c , the final solution very closely tracks that obtained by\nsolving the exact set of equations. We are then able to\ncompute the bias on cosmological parameter estimates\nintroduced by resorting to the first-order tight-coupling\napproximation and show that it is indeed small for most\ncosmological parameters. Finally, and most importantly,\nwe describe how our second-order expansion can be used\nto speed up the computation of CMB power spectra without loss of overall accuracy.\n\nII.\n\nSOLUTION TO THE EXACT EQUATIONS\n\nThe first step in testing the validity of the tightcoupling approximation is to evolve the exact set of equations from early times. This requires the use of a differential equation solver able to solve stiff systems with\nadaptive step sizes. We utilize the LSODA [13] solver\nwhich is based on the backward differentiation formula\nmethod. We find that the stiff integrator can solve the\nexact Boltzmann equations provided suitably accurate\ninitial conditions are given. Indeed, the usual initial conditions for the perturbation variables used by modern\nBoltzmann codes are valid only in the limit of perfect\ncoupling between photons and baryons [7, 14]. In this\nlimit, the dipole moments of the photon and baryon distributions are exactly equal to each other and the photon quadrupole moment vanishes. However, in order to\nsolve the exact equations at early times, one needs to\ninitialize the relative dipole moment (usually called the\nslip) between the photons and baryons and the photon\nquadrupole moment to nonzero values. We describe our\n\n\f2\napproach to this problem in the next subsection. We\nthen verify the convergence of the solution obtained with\nthe stiff integrator to ensure it is stable to changes in the\nnumerical tolerance and accuracy settings.\n\n10\n10\n\nA.\n\nInitial Conditions\n\nTo find suitable initial conditions to the system of exact equations, we expand each perturbation variable in\npowers of k\u03c4 and \u000f \u2261 \u03c4c /\u03c4\nX\n\u2206(\u03c4, \u000f) =\n(C\u2206 )mn (k\u03c4 )m \u000fn\n(1)\nm,n\n\nand substitute the result in the system of coupled differential equations (see Appendix A). Here k is the\nFourier wave number, \u03c4 is conformal time and \u2206(\u03c4, \u000f)\nstands for any of the following perturbation variables:\n\u03b4c , \u03b4\u03b3 , \u03b8\u03b3 , F\u03b32 , \u03b4b , Sb \u2261 \u03b8b \u2212 \u03b8\u03b3 , \u03b4\u03bd , \u03b8\u03bd , F\u03bd2 , \u03b7 (our notation\nclosely follows that of [7]). We then match coefficients\nof like powers of k\u03c4 and \u000f to obtain a set of linear equations for the series coefficients (C\u2206 )mn . We then solve\nthese linear equations to find a global series solution, demanding that the tightly-coupled solutions (adiabatic or\nisocurvature) are retrieved in the limit \u000f \u2192 0. In principle, one could try to solve the full recursion relation\nand obtain a closed-form expression for the (C\u2206 )mn . In\npractice however, finding the first few terms of the series\nis sufficient to set accurate initial conditions. Using this\nmethod, we obtain the leading-order contribution to the\ninitial value of the slip between baryons and photons for\nthe adiabatic mode\nSb (\u03c4 ) \u2261 \u03b8b (\u03c4 ) \u2212 \u03b8\u03b3 (\u03c4 ) =\n\n\u03b21 R b\n\u03c9k 4 \u03c4 4 \u000f + O(\u000f2 ), (2)\n6(1 \u2212 R\u03bd )\n\nwhere \u03b2l = 1 \u2212 l(l + 2)K/k 2 is a normalization constant,\n\u221a\nR\u03bd \u2261 \u03c1\u03bd /(\u03c1\u03bd + \u03c1\u03b3 ), Rb \u2261 \u03c1b /\u03c1m and \u03c9 = H0 \u03a9m / \u03a9r .\nThe leading-order contribution of the photon quadrupole\nmoment of the adiabatic mode is\n\u0014\n\u0015\n16 (8R\u03bd \u2212 5) \u03c9\u03c4\n4k 2 \u03c4 2 \u000f\nF\u03b32 (\u03c4 ) =\n+\n+O(\u000f2 ). (3)\n9\n3 (2R\u03bd + 15) (4R\u03bd + 15)\n\n\u2206C l /C l\n\n10\n10\n10\n10\n10\n\n!5\n\nC lT T\nC lE E\n\n!6\n\n!7\n\n!8\n\n!9\n\n!10\n\n!11\n\n0\n\n500\n\n1000\n\nl\n\n1500\n\n2000\n\n2500\n\nFIG. 1: Fractional change in ClT T and ClEE versus multipole\nmoments as the relative tolerance of the stiff integrator is\nvaried from 10\u22126 to 10\u22127 . Here the CAMB accuracy boost\nfactors are set equal to 5. The average change is 3.5 \u00d7 10\u22127\nfor ClT T and 3.3 \u00d7 10\u22127 for ClEE .\n\nhierarchies and the sampling of the final angular power\nspectrum. See Ref. [15] for a complete list. Here, we\nincrease the accuracy boost factors to verify for convergence but we also vary independently the tolerance of\nthe stiff integrator to single out any error that is introduced by the solver itself. Throughout this section, we\nuse as a benchmark model the WMAP seven-year cosmological parameter best-values [16]. Figure 1 shows the\nfractional change in both ClT T and ClEE as a function of\nthe multipole moment l as the relative tolerance of the integrator is increased by an order of magnitude from 10\u22126\nto 10\u22127 . The average fractional change in the angular\npower spectra is approximately 3 \u00d7 10\u22127 hence showing that the integration process has converged. Figure\n2 shows the fractional change in both ClT T and ClEE as\nthe three CAMB accuracy boost factors are increased from\n5 to 6. We see that the Cl computed with the stiff integrator have an accuracy of 0.01% or better with the\naccuracy boost factors set to 5. We shall use this spectrum as our benchmark for testing the accuracy of our\nsecond-order tight-coupling approximation scheme which\nwe now present in the next section.\n\nWe list the initial conditions for all of the relevant perturbation variables in Appendix B.\nIII.\nB.\n\nSECOND-ORDER SCHEME\n\nConvergence of the Stiff Integration\n\nWe verify the convergence of the stiff integrator by\nrunning several computations with increasing accuracy\nand comparing the resulting angular power spectra. In\nCAMB, the desired accuracy is usually selected by choosing\nthe appropriate \"accuracy boost factors\" which control,\namong other things, the Fourier mode sampling of the\nCMB anisotropy sources, the time step of the integrator,\nthe number of multipoles kept in photon and neutrino\n\nIn the usual tight-coupling approximation, the photon\nand baryon dipole moments are obtained by solving the\ntwo exact equations [17]\n\u03b8\u0307\u03b3\n\n\u0013\n\u0012\nR\n1\nF\u03b32\n2\n=\nk\n\u03b4 \u03b3 \u2212 \u03b21\n1+R\n4\n2\n\u0012\n\u0013\n1\n\u0227\n2 2\n+\nk cs \u03b4b \u2212 \u03b8b \u2212 \u1e60b ,\n1+R\na\n\n(4)\n\n\f3\n!2\n\n10\n\nC lT T\nC lE E\n!4\n\n\u2206C l /C l\n\n10\n\n!6\n\n10\n\nX\n\u0227\n\u1e27 + 2 (2k\u03c3 \u2212 6\u03b7\u0307) \u2212 2k 2 \u03b21 \u03b7 = \u22128\u03c0Ga2\n3\u03c1i wi \u03b4i , (7)\na\ni\n\n!8\n\n10\n\n!10\n\n10\n\nThe second derivative of the photon-baryon slip is computed by taking the time derivative of the right-hand\nside of Eq. (6). Here, we neglect terms proportional to\nd3 Sb /d\u03c4 3 and F\u0308\u03b32 . We then use the time derivative of\nEqs. (A7) and (A10) to eliminate the second derivatives\nof \u03b4\u03b3 and \u03b4b . \u1e27 is eliminated by using the i-i component\nof the perturbed Einstein equation\n\n0\n\n500\n\n1000\n\nl\n\n1500\n\n2000\n\n2500\n\nFIG. 2: Fractional change in ClT T and ClEE versus multipole\nmoments as the three CAMB accuracy boost factors are increased from 5 to 6. The maximum change is about 1 \u00d7 10\u22124\nfor ClEE and 6 \u00d7 10\u22123 for ClT T .\n\n\u03b8\u0307b\n\n\u0012\n\u0013\n\u0227\n1\n2 2\nk cs \u03b4b \u2212 \u03b8b\n=\n1+R\na\n\u0014 \u0012\n\u0013\n\u0015\n1\nR\nF\u03b32\n2\nk\n\u03b4 \u03b3 \u2212 \u03b21\n+ \u1e60b ,\n+\n1+R\n4\n2\n\n\u1e58 = \u2212H(1 \u2212 3c2s )R,\n\u03c4\u0308c = 2\u1e22\u03c4c + 2H\u03c4\u0307c ,\n\n(5)\n\nwhere a stands for the scale factor and dots represent\nderivatives with respect to conformal time. The exactness of the solution to the above equations of motion\ndepends strongly on the accuracy at which we can determine both \u1e60b and F\u03b32 . Current CMB Boltzmann\ncodes use a first-order expansion in \u03c4c to approximate\nthe photon-baryon slip and the photon quadrupole moment. Here, we propose a method to obtain the secondorder corrections in \u03c4c to these quantities. See [18] for a\nrelated expansion in the context of magnetogenesis.\nA.\n\nwhere \u03c3 = (\u1e23 + 6\u03b7\u0307)/2k is the shear. We further eliminate\n\u03b8\u0307\u03b3 using Eq. (A8) and set F\u03b32 = \u1e1e\u03b32 = 0 since they\ncontribute terms of order \u03c4c2 to S\u0308b . We finally substitute\nthe time-evolution equations for the parameters R, c2s , \u03c4c\nand \u0227/a \u2261 H:\n\nPhoton-Baryon Slip\n\nOur starting point is the exact equation for the slip obtained from combining Eq. (A8) and the time derivative\nof Eq. (A11) [17]:\n\u001a\u0014\n\u0015\n1\n\u03c4\u0307c\n\u0227 2\n\u1e60b =\n\u2212\nSb\n\u03c4c\n\u03c4c\na1+R\n1 + 2 \u0227a 1+R\n\u0014\n\u0012\n\u0013\n\u03c4c\n\u00e4\n\u0227 1\n+\n\u2212 \u03b8b \u2212 S\u0308b \u2212 k 2\n\u03b4\u03b3 \u2212 \u03b21 F\u03b32\n1+R\na\na 2\n!#)\n1\n\u1e1e\u03b32\n2\n2\n+k cs \u03b4\u0307b \u2212 \u03b4\u0307\u03b3 + \u03b21\n.\n(6)\n4\n2\nUsually, one sets S\u0308b = F\u03b32 = \u1e1e\u03b32 = 0 and neglect the\nprefactor on the right-hand side of Eq (6) since they\ncontribute terms of order \u03c4c2 and higher. However, to\nobtain an equation for the photon-baryon slip valid at\nsecond order in \u03c4c , an approximation for S\u0308b , F\u03b32 and\n\u1e1e\u03b32 accurate to first order in \u03c4c is necessary.\n\n\u010b2s = \u2212Hc2s\n\n\u1e26 = \u22123H\u1e22 \u2212 H3 .\n\nNow armed with an expression for S\u0308b , we substitute it\ninto Eq. (6) and solve algebraically for \u1e60b . The result is\ngiven in Appendix C.\n\nB.\n\nPhoton Quadrupole Moment\n\nTo obtain an expression for F\u03b32 and \u1e1e\u03b32 accurate to\nsecond order in \u03c4c , we use the recursion relation between\nhigher photon multipole moments [7]\n\u1e1e\u03b3l =\n\n\u0003\nk \u0002\n1\nlF\u03b3(l\u22121) \u2212 (l + 1)\u03b2l F\u03b3(l+1) \u2212 F\u03b3l , (8)\n2l + 1\n\u03c4c\n\nwhich is valid for l \u2265 3. We begin by setting F\u03b35 = 0\nand solve Eq. (8) with l = 4 for F\u03b34 . We then take\nthe derivative with respect to proper time, setting F\u0308\u03b34 =\n0. We finally solve the resulting equation for \u1e1e\u03b34 and\nsubstitute back the result in Eq. (8). This last equation\nleads to an expression for F\u03b34 valid to fourth order in \u03c4c\n(remembering that F\u03b33 \u221d k 2 \u03c4c2 and that \u03c4\u0307c \u221d \u03c4c /\u03c4 ):\nF\u03b34 '\n\n4\n4\nk\u03c4c F\u03b33 (1 \u2212 \u03c4\u0307c ) \u2212 k\u03c4c2 \u1e1e\u03b33 + O(\u03c4c5 ).\n9\n9\n\n(9)\n\nSubstituting the above in Eq. (8) evaluated at l = 3 and\nusing a similar procedure, we obtain an expression for\nF\u03b33 valid to fourth order in \u03c4c\nF\u03b33 '\n\n3\n3\nk\u03c4c F\u03b32 (1 \u2212 \u03c4\u0307c + \u03c4\u0307c2 ) \u2212 k\u03c4c2 \u1e1e\u03b32 (1 \u2212 \u03c4\u0307c )\n7\n7\n16 3 3\n\u2212\nk \u03c4c F\u03b32 + O(\u03c4c5 ).\n(10)\n147\n\nThe last step in deriving expansions for the quadrupole\nmoment and its derivative is to express the polarization\nmultipole G\u03b32 in terms of \u1e1e\u03b32 and F\u03b32 . Similar to the\n\n\f4\n\nwhere \u03b4ij is the Kronecker delta. Again, we set G\u03b35 = 0\nand follow the method outlined above to obtain\n\u0012\n\u0013\nF\u03b32\n5\n5\n25\nG\u03b32 '\n\u2212 \u03c4c \u1e1e\u03b32 1 \u2212 \u03c4\u0307c + \u03c4\u0307c2\n4\n8\n2\n4\n15 2 3\n5 2 2\n\u2212 k \u03c4c F\u03b32 (1 \u2212 6\u03c4\u0307c ) + k \u03c4c \u1e1e\u03b32 , (12)\n56\n27\nwhich is accurate to fourth order in \u03c4c . We now have all\nthe necessary tools to derive approximate expressions for\nF\u03b32 and \u1e1e\u03b32 . We substitute Eqs. (12) and (10) in Eq.\n(A9) and solve for F\u03b32 . We then take the derivative with\nrespect to conformal time and set F\u0308\u03b32 = 0. We finally\nsolve for \u1e1e\u03b32 and obtain\n\u0012\n\u0013\n32\n11\n\u1e1e\u03b32 =\n\u03c4\u0307c (\u03b8\u03b3 + k\u03c3) 1 \u2212 \u03c4\u0307c\n45\n6\n\u0012\n\u0013\n\u0010\n\u0011\n32\n11\n+ \u03c4c \u03b8\u0307\u03b3 + k \u03c3\u0307\n1 \u2212 \u03c4\u0307c + O(\u03c4c3 ). (13)\n45\n6\nSubstituting the above back in Eq. (A9) we ultimately arrive at the desired expression for the photon\nquadrupole moment\n\u0012\n\u0013\n11\n32\n\u03c4c (\u03b8\u03b3 + k\u03c3) 1 \u2212 \u03c4\u0307c\nF\u03b32 =\n45\n6\n\u0011 \u0012 11 \u0013\n32 2 \u0010\n+ \u03c4c \u03b8\u0307\u03b3 + k \u03c3\u0307\n+ O(\u03c4c3 ). (14)\n\u2212\n45\n6\nC.\n\nComputational Procedure\n\nAs we can see from Eq. (14), our second-order expression for the photon quadrupole moment depends on \u03b8\u0307\u03b3 .\nFrom a practical perspective, this is problematic since it\nis the quantity that we are trying to determine in the\nfirst place. We overcome this difficulty by computing\neach quantity order by order in \u03c4c until the desired level\nof accuracy is reached.\nThe first step is to obtain an approximation to F\u03b32\nusing Eq. (14) but keeping only the terms linear in \u03c4c ,\nwhich are independent of \u03b8\u0307\u03b3 . We then use this expression\nto calculate \u03c3\u0307 to first order in \u03c4c using the traceless spacespace part of the perturbed Einstein equation\n\u0227\nk \u03c3\u0307 + 2 k\u03c3 \u2212 k 2 \u03b7 = \u22128\u03c0Ga2 (\u03c1\u03bd F\u03bd2 + \u03c1\u03b3 F\u03b32 ) .\na\n\n(15)\n\nNext, we calculate a zeroth-order expression for \u03b8\u0307\u03b3 using\nEq. (4) with \u1e60b and F\u03b32 set to zero. We then use our\n\n10\n\n10\n\u2206C l /C l\n\nabove calculation, this is accomplished by using the recursion relation for the polarization multipole moments\n[19]\n\u0014\n\u0015\n(l + 3)(l \u2212 1)\nk\nlG\u03b3(l\u22121) \u2212\n\u03b2l G\u03b3(l+1)\n\u0120\u03b3l =\n2l + 1\nl+1\n\u0014\n\u0012\n\u0013 \u0015\n1\n2 3\n9\n\u2212\nG\u03b3l \u2212\nF\u03b32 + G\u03b32 \u03b4l2 ,\n(11)\n\u03c4c\n15 4\n2\n\n10\n\n10\n\n!2\n\n!4\n\n!6\n\n!8\n\nFirst-Order Scheme\nSecond-Order Scheme\n\n10\n\n!10\n\n0\n\n500\n\n1000\n\nl\n\n1500\n\n2000\n\n2500\n\nFIG. 3: Fractional difference of ClT T between the usual firstorder tight-coupling approximation and the benchmark integration (full line), and between the second-order approximation and the benchmark integration (dashed line). Here,\nthe three sets of Cl s have been computed with default accuracy. The average fractional difference is 6.6 \u00d7 10\u22124 for the\nfirst-order approximation and 5 \u00d7 10\u22125 for the second-order\napproximation.\n\ntwo formulas for \u03c3\u0307 and \u03b8\u0307\u03b3 to compute \u1e1e\u03b32 to first order\nin \u03c4c using Eq. (13).\nWe now have all the necessary tools to calculate the\nphoton-baryon slip to second order in \u03c4c using Eq. (C1).\nWe finally use this last expression to obtain a first order\napproximation to \u03b8\u0307\u03b3 using Eq. (A8) which in turn is used\nto obtain \u1e1e\u03b32 and F\u03b32 accurate to second order in \u03c4c .\nD.\n\nAccuracy of the Second-Order Scheme\n\nWe test the accuracy of the second-order scheme by\ncomparing the final angular power spectrum with both\nthe stiff integrator benchmark and the usual first-order\ntight-coupling approximation. To isolate the effect of\nthe second-order terms in the equations of motion, we\nleave untouched the algorithm that switches from the\ntightly-coupled equations to the exact system of equations. Improvements to the switching criteria will be discussed in Sec. V. As mentioned above, all the results\npresented in this section are valid for the WMAP sevenyear best-fit values for cosmological parameters. We find\nthat at default accuracy setting (\"accuracy boost\" = 1)\nfor all three computations, the fractional difference between the second-order scheme and the benchmark integration averaged over multipoles is about an order of\nmagnitude smaller than the average fractional difference\nbetween the usual first-order tight-coupling approximation and the benchmark integration (see Fig. 3). Hence,\nthe second-order scheme reproduces more accurately the\nsolution to the exact equations.\nAs the accuracy boost factors are increased, the\nsecond-order scheme keeps providing, on average, a more\n\n\f5\n!4\n\nproximation does not modify any of the above, it is therefore natural to expect that the precision of the secondorder power spectrum to remain unchanged.\n\n10\n\n!5\n\n10\n\n\u2206C l /C l\n\n!6\n\n10\n\nIV.\n\n!7\n\n10\n\n!8\n\n10\n\nFirst-Order Scheme\nSecond-Order Scheme\n!9\n\n10\n\n0\n\n500\n\n1000\n\nl\n\n1500\n\n2000\n\n2500\n\nFIG. 4: Fractional difference of ClT T between the usual firstorder tight-coupling approximation and the benchmark integration (full line) and the second-order approximation and\nthe benchmark integration (dashed line). Here, all the Cl s\nhave been computed with the three accuracy boost factors\nset to 5. The average fractional difference is 2.4 \u00d7 10\u22125 for\nthe first-order approximation and 3.5 \u00d7 10\u22126 for the secondorder approximation.\n\nBIAS ON COSMOLOGICAL PARAMETERS\n\nIn today's era of precision cosmology, the main purpose\nof CMB codes is to generate theoretical spectra that are\nthen compared with data for cosmological parameter estimation purpose. However, numerical errors in the theoretical spectra could lead to a slight bias on estimates of\ncosmological parameters [15]. Since our improved tightcoupling approximation scheme leads to more accurate\nvalues of the power spectra, it is interesting to see how\nthe bias is affected. To answer this question, we need to\ncompute the effective \u03c72 between our theoretical spectra\nand a fiducial data set which we take to have Planck-level\nnoise. The effective \u03c72 is defined by\n\"\n#\n\u0010\n\u0011\nX\n|C\u0303l |\n\u22121\n2\n\u03c7 =\n(2l + 1)fsky Tr C\u0303l \u0108l + ln\n\u2212 2 , (16)\n|\u0108l |\nl\n0\n\naccurate answer than the first-order tight-coupling approximation. Figure 4 compares the angular power spectra from the two schemes with those found by integrating\nthe exact system of equations. Although, the difference\nbetween the two codes might be insignificant for current\nCMB experiments, it illustrates that the next-to-leadingorder code is better capturing what is happening during\nthe tightly-coupled epoch, especially for the low multipoles. The key point however is that this better accuracy comes at almost no additional computational cost,\na point that we shall emphasize in Sec. V.\nIn summary, we have shown that the second-order\ntight-coupling approximation reproduces more closely\nthe result found by solving the exact equations, hence\nshowing that the tight-coupling expansion is converging\ntoward the exact solution. For practical applications\nhowever, the percentage change in the angular power\nspectrum between the usual first-order approximation\nand the exact solution is small and well within the quoted\nprecision from CAMB (0.3% at default accuracy). This\nimplies that the first-order tight-coupling approximation\nshould be sufficient for most practical purposes. Nevertheless, as we will describe in the next few sections, it is\npossible to use our second-order expansion to reduce the\npotential bias on cosmological parameter estimates and\nto speed up the code.\nWe mention in passing that the precision (i.e., the size\nof the numerical noise) of individual Cl is almost not affected by the introduction of the second-order terms in\nthe equations of motion. Indeed, the precision of the final angular power spectrum is mainly determined by the\nnumber of k-modes evolved by the code, the number of\nphoton multipoles that are solved for, as well as various\ninterpolation errors. Since our new tight-coupling ap-\n\nwhere fsky is the observed sky fraction and C\u0303l = {ClXX +\n0\nNlXX } is the theoretical covariance matrix. Here, X\nruns over temperature (T) and polarization (E). \u0108l is\nthe data covariance matrix. If we assume that the likelihood L = exp (\u2212\u03c72 /2) is a multivariate Gaussian and\nthat the prior probability densities are flat, then\np the bias\non any cosmological parameter cannot exceed \u03c72 standard deviations. In practice however, this bound is rarely\nsaturated. Nonetheless, a small \u03c72 between the data and\nthe theory is still necessary to ensure a minimal bias.\nWe generate a fiducial data set up to l = 2500 using the\nmethod outlined in [15] but with the Cl obtained from\nthe stiff solver. Again, we use the WMAP 7-year best-fit\nvalues for cosmological parameters. We take the noise to\nbe Gaussian and isotropic with power spectrum given by\n\u0015\n\u0014\n0\n\u03b82\n2\n(17)\nNlXX = \u03b4XX 0 \u03b8beam\n\u22062X exp l(l + 1) beam ,\n8 ln 2\nwhere \u03b8beam is the beam width and \u2206X is the sensitivity\nper pixel. As an example, we consider the 143 GHz channel of the HFI instrument aboard Planck [20] which has\n\u03b8beam = 7.10 , \u2206T = 6.0\u03bcK and \u2206E = 11.4\u03bcK, assuming\n14 months of integrated observation. We assume a sky\ncoverage of fsky = 0.65.\nWe list in Table I the values of \u03c72 computed between\nour fiducial Planck data and our improved second-order\ncode. For comparison, we also give the \u03c72 values for\nunmodified CAMB at similar accuracy boost. We see that\nthe higher-order tight-coupling approximation leads to a\nbetter fit to the fiducial data and therefore to a smaller\ntheoretical maximal bias on cosmological parameters at\nno extra numerical cost. To estimate the real biases on\ncosmological parameters, we run several Markov chains\nusing both the first- and second-order tight-coupling code\n\n\f6\ntogether with the publicly available code CosmoMC [21].\nWe restrict ourselves to the \"vanilla\" 6-parameter \u039bCDM\nmodel and made sure that the Gelman-Rubin \"R \u2212 1\"\nconvergence criteria [22] is smaller than 0.005 for all the\nparameters under consideration.\nWe list in Table II the biases between the results from\nour second-order CMB code and the results from a code\nthat used the same accuracy setting as the fiducial spectra (mimicking an error-free analysis). For comparison,\nwe also give the biases for the usual first-order code. At\ndefault accuracy, we see that the difference between the\ntwo codes in terms of the bias is rather slim, with \u03b8 being\nthe most dramatically affected by the second-order code.\nThis stems from the fact that our second-order code better captures the position of the first peak as can be seen\nfrom Figs. 3 and 4. We conclude that the numerical errors due to the first-order tight-coupling approximation\ndoes introduce a small bias to the estimate of \u03b8 at default\naccuracy, although it is clear that other numerical errors\n(k-sampling, interpolation, etc) contribute the most significant part to the biases of cosmological parameters for\nboth codes. As the accuracy of the codes is increased,\nthe difference in bias between the two codes becomes insignificant for parameter estimation purposes. Therefore,\nif one sets the accuracy of the theoretical spectra to be\nlarge enough such that the bias from numerical errors\nothers then the first-order tight-coupling is small, then\nthe usual tightly-coupled equations are appropriate for\ncosmological parameter estimation.\n\nV.\n\nREDUCING THE COMPUTATIONAL\nRUNTIME\n\nUp to this point, we have used the second-order expansion in \u03c4c to improve the accuracy of CMB Boltzmann codes. In this section, we adopt a different point of\nview and take advantage of our improved tight-coupling\nscheme to reduce the computational time needed to\nevolve the perturbation equations. Indeed, the new\n\nCode\n\n\u03c72\n\nTime (s)\n\nCAMB accuracy = 1\n2nd Order acc. = 1\nCAMB accuracy = 2\n2nd Order acc. = 2\nOpt. CAMB acc. = 2\nOpt. 2nd Order acc. = 2\n\n2.3\n1.3\n0.17\n0.091\n1.1\n0.10\n\n4.8\n4.8\n18.2\n18.2\n15.1\n15.1\n\nTABLE I: \u03c72 values between fiducial Planck data and theoretical spectra gotten with the first- and second-order codes\nfor different accuracy boost. We also give the computational\ntime needed to generate the theoretical spectra in order to\nshow that the greater accuracy comes at no extra numerical cost. The computational times displayed here are for a\nsingle-processor machine.\n\nCode\nCAMB accuracy = 1\n2nd Order acc. = 1\nCAMB accuracy = 2\n2nd Order acc. = 2\n\n\u03a9 b h2 \u03a9 c h2\n0.24\n0.25\n0.02\n0.03\n\n0.15\n0.16\n0.006\n0.003\n\n\u03b8\n\n\u03c4\n\nns\n\nln (1010 As )\n\n0.31\n0.15\n0.03\n0.01\n\n0.11\n0.12\n0.013\n0.016\n\n0.40\n0.33\n0.03\n0.017\n\n0.19\n0.15\n0.03\n0.015\n\nTABLE II: Biases of the 6-parameter \u039bCDM model in unit\nof the standard deviation. We contrast the first- and secondorder tight-coupling approximation and give the value of the\naccuracy boost factors used for each computation.\n\nO(\u03c4c2 ) terms in the tightly-coupled perturbation equations allow one to switch to the exact equations at a later\ntime while keeping the same accuracy as the usual firstorder expansion. Since the approximate tightly-coupled\nequations are easier to solve than their exact counterparts, precious computational time can be saved. Moreover, the higher accuracy of the second-order equations\nlets us use a larger minimal time step for the numerical integrator, hence reducing the total number of steps taken\nby the integrator and further cutting down the computational time.\nOur approach here is to degrade the accuracy of\nthe second-order code by modifying the tight-coupling\nswitching criteria, using larger time steps and cutting\ndown the photon hierarchy until the output from this\n\"optimized\" code somewhat matches that of the unmodified first-order code. We then compute the \u03c72 value between our fiducial Planck data and the output from this\noptimized code and compare it to a similar calculation\ndone with regular CAMB. The results are shown on the\ntwo last rows of Table I where we see that we achieve a\n\u223c 17% computational time reduction while still retaining\nthe accuracy of the first-order code at accuracy boost 2.\nAlthough this gain in computational efficiency is modest, it can significantly reduce the amount of time necessary to run Markov chains for cosmological parameter estimation. To demonstrate this, we run 8 chains with our\noptimized second-order code at accuracy boost 2, generating 20000 samples per chains. We also run the similar\nchains with regular CAMB at accuracy boost 2 and make\nsure to have R \u2212 1 . 0.005. Figure 5 shows that the results for the marginalized posterior distribution are very\nsimilar between the two codes, with the distribution for \u03b8\nbeing the most affected, although very mildly (0.09 standard deviation). However, the most important difference\nbetween the two results is that our optimized secondorder code took on average \u223c 16% less time to complete.\nHence, our second-order tight-coupling code, in addition\nto leading to more accurate angular CMB spectra, can\ninstead be used to speed up the computational time and\nmake more efficient use of computing resources.\n\n\f7\n\n0.0222 0.0224 0.0226 0.0228 0.023\n\n\u03a9bh2\n\n0.08\n\n0.09\n\n0.1\n\n\u03c4\n\n0.108 0.11 0.112 0.114 0.116\n\u03a9ch2\n\n0.95\n\n0.96\n\nns\n\n1.0385 1.039 1.0395 1.04 1.0405\n\n\u03b8\n\n0.97\n\n3.06\n\n3.08\n\nln[1010As ]\n\n3.1\n\nFIG. 5: Marginalized posterior probability distribution for\nthe vanilla \u039bCDM model. The full black line represents the\nresult gotten using the first-order code at accuracy boost 2\nwhile the red dotted line was obtained using our optimized\nsecond-order code.\n\nIn conclusion, we have investigated the accuracy of the\ntight-coupling approximation by solving the exact equations at all times using a stiff numerical solver. We have\nshown that the first-order tight-coupling approximation\nleads to a small accuracy lost compared to the exact solution and that this change is well within the quoted precision of the angular power spectra. We have discussed\nhow our second-order code has a smaller maximal possible bias on cosmological parameters than its first-order\ncounterpart. We have shown that the bias introduced by\nthe first-order tight-coupling is insignificant for today's\ncosmological experiments, unless CAMB's default accuracy\nis used. Finally, we have shown that the improved accuracy of our second-order approximation allows one to\noptimize the tight-coupling switching criteria and integration parameters in order to reduce the computational\ntime of the code. (After this project was completed, a\nrelated work appeared [23].)\n\n!3\n\n1\n\nAcknowledgments\n\nx 10\n\nFirst-Order Scheme\nSecond-Order Scheme\n\n0.75\n\n\u2206\u03b4 \u03b3 (\u03c4 )\n\n0.5\n0.25\n0\n!0.25\n!0.5\n\nWe thank Adam Moss and Antony Lewis for useful discussions. The work of FYCR is supported by\nthe National Science and Engineering Research Council\n(NSERC) of Canada. The work of KS is supported in\npart by a NSERC of Canada Discovery grant. Research\ninfrastructure funded by the Canada Foundation for Innovation (CFI) Leaders Opportunity Fund was essential\nto completing this project.\n\n!0.75\n!1\n0\n\n100\n\n200\n\n300\n\u03c4 (M pc)\n\n400\n\n500\n\n600\n\nFIG. 6: Residuals (\u2206\u03b4\u03b3 \u2261 \u03b4\u03b3exact \u2212 \u03b4\u03b3approx ) between the photon perturbation \u03b4\u03b3 computed using the exact equations and\nthe solutions obtained with the first- and second-order tightcoupling approximation.\n\nVI.\n\nDISCUSSION AND CONCLUSION\n\nWe have developed a second-order tight-coupling approximation to the photon-baryon perturbation equations and shown that it closely reproduces the solution to the nonapproximated equations. In practice, the\nmain reason why our second-order tight-coupling code\nproduces more accurate power spectra is that it better\ntracts the evolution of the photon perturbations. Figure\n6 shows the residuals between the photon perturbation\n\u03b4\u03b3 computed using the exact equations and the solutions\nobtained with the first- and second-order tight-coupling\napproximation. We see that the second-order scheme deviates much less from the exact solution then the usual\nfirst-order scheme, leading to a more accurate value of\nthe source term needed for the line-of-sight integration\n[12].\n\nAppendix A: Perturbation Equations\n\nIn this Appendix, we list the perturbation equations\nused to solve for the initial conditions found in Appendix\nB. We closely follow the notation of [7]. Here, \u03b7 and h\nstand for the synchronous gauge curvature perturbation\nvariables, a is the scale factor, K is the inverse of the\nsquared curvature radius, \u03c1i is the energy density of the\nith specie, wi \u2261 pi /\u03c1i , where pi is the pressure, and a dot\ndenotes differentiation with respect to conformal time.\nk 2 \u03b21 \u03b7 \u2212\nk 2 \u03b21 \u03b7\u0307 \u2212\n\nX\n1 \u0227\n\u1e23 + 4\u03c0Ga2\n\u03c1i \u03b4i = 0 (A1)\n2a\ni\n\nX\nK \u1e23\n\u2212 4\u03c0Ga2\n(1 + wi )\u03c1i \u03b8i = 0 (A2)\n2\ni\n1\n\u03b4\u0307c + \u1e23 = 0 (A3)\n2\n4\n2\n\u03b4\u0307\u03bd + \u03b8\u03bd + \u1e23 = 0 (A4)\n3\n3\n\nk2\n(\u03b4\u03bd \u2212 2\u03b21 F\u03bd2 ) = 0 (A5)\n4\n!\n8\n3\n4 \u1e23\n\u1e1e\u03bd2 \u2212 \u03b8\u03bd + \u03b22 kF\u03bd3 \u2212\n+ 2\u03b7\u0307 = 0 (A6)\n15\n5\n5 3\n\u03b8\u0307\u03bd \u2212\n\n\f8\n4\n2\n\u03b4\u0307\u03b3 + \u03b8\u03b3 + \u1e23\n3\n3\n1\nk2\n(\u03b4\u03b3 \u2212 2\u03b21 F\u03b32 ) \u2212 Sb\n\u03b8\u0307\u03b3 \u2212\n4\n\u03c4c\n!\n8\n3\n4 \u1e23\n\u1e1e\u03b32 \u2212 \u03b8\u03b3 + \u03b22 kF\u03b33 \u2212\n+ 2\u03b7\u0307\n15\n5\n5 3\n\u0012\n\u0012\n\u0013\u0013\n1\n2 3\n9\n\u2212\nF\u03b32 \u2212\nF\u03b32 + G\u03b32\n\u03c4c\n15 4\n2\n1\n\u03b4\u0307b + \u03b8b + \u1e23\n2\n\u0014\n\u03c4c\n\u0227\n\u2212 (Sb + \u03b8\u03b3 ) \u2212 \u1e60b\nSb \u2212\n1+R\na\n\u0012\n\u0013\u0015\n1\nF\u03b32\n+k 2 c2s \u03b4b \u2212 \u03b4\u03b3 + \u03b21\n4\n2\n\nF\u03b33 '\n\n= 0 (A7)\n\n3\nk\u03c4c F\u03b32 .\n7\n\n(A13)\n\n= 0 (A8)\nFinally, we eliminate the photon polarization moments\nfrom (A9) using\n\n= 0 (A9)\n\nG\u03b32\n\n1\n'\n4\n\n\u0012\n\n\u0013\n5\u03c4c\nF\u03b32 \u2212\n\u1e1e\u03b32 .\n2\n\n(A14)\n\n= 0 (A10)\n\nAppendix B: Initial Conditions\n\n= 0 (A11)\n\nHere, R = (4/3)\u03c1\u03b3 /\u03c1b . Our approach to solve these equations follow closely that of [24]. We first use Eq. (A1)\nto eliminate \u1e23 in favor of the curvature perturbation \u03b7.\nFor simplicity, we set c2s = 0. We then approximate the\noctupole moment of the neutrinos and photons as:\n\u0013\n\u0012\nk\u03c4\n4 2 2\nF\u03bd3 '\nk \u03c4 F\u03bd2 ,\n(A12)\n1\u2212\n7\n315\n\nIn this Appendix, we list the initial conditions obtained by the method outlined in Sec. II A. Here,\n\u221a\nR\u03bd = \u03c1\u03bd /(\u03c1\u03bd + \u03c1\u03b3 ), Rb = \u03c1b /\u03c1m , \u03c9 = H0 \u03a9m / \u03a9r ,\n\u000f = \u03c4c /\u03c4 , Sb (\u03c4 ) \u2261 \u03b8b (\u03c4 ) \u2212 \u03b8\u03b3 (\u03c4 ) is the velocity difference\nbetween baryons and photons. Note that our convention\nfor the normalization of perturbations differs from [24]\nby \u03b21 \u2192 \u2212\u03b21 /2. Note also that what we label \u03b21 here is\ndenoted by \u03b22 in [24].\n\n1. Photons\n\u03b4\u03b3 (\u03c4 ) = \u2212\n\n2\u03b21 2 2 2\u03b21 2 3 \u03b21 (4\u03b21 R\u03bd + 15\u03b21 \u2212 5) 4 4 \u03b21 2 2 4\nk \u03c4 +\n\u03c9k \u03c4 +\nk \u03c4 \u2212 \u03c9 k \u03c4\n3\n15\n27 (4R\u03bd + 15)\n24\n\n\u03b21 4 3\n8\u03b21\n\u03b21 (1 + 5Rb \u2212 R\u03bd ) 4 4\nk \u03c4 \u2212\nk4 \u03c4 3 \u000f +\n\u03c9k \u03c4\n18\n36R\u03bd + 135\n120 (1 \u2212 R\u03bd )\n\u0001\n2\u03b21 2 (5Rb \u2212 9) R\u03bd + 75Rb + 8R\u03bd2 + 10\n16\u03b21 (6R\u03bd + 181)\n\u03c9k 4 \u03c4 4 \u000f +\nk 4 \u03c4 3 \u000f2\n\u2212\n15 (R\u03bd \u2212 1) (2R\u03bd + 15) (4R\u03bd + 15)\n45 (2R\u03bd + 15) (4R\u03bd + 15)\n\n(B1)\n\n\u03b8\u03b3 (\u03c4 ) = \u2212\n\nF\u03b32 (\u03c4 ) =\n\n64\n4 (8R\u03bd \u2212 5)\n32 (6R\u03bd + 181)\nk2 \u03c4 2 \u000f +\n\u03c9k 2 \u03c4 3 \u000f \u2212\nk 2 \u03c4 2 \u000f2\n9(4R\u03bd + 15)\n3 (2R\u03bd + 15) (4R\u03bd + 15)\n9 (2R\u03bd + 15) (4R\u03bd + 15)\n16 (2R\u03bd (12R\u03bd + 767) \u2212 1855)\n\u2212\n\u03c9k 2 \u03c4 3 \u000f2\n9 (2R\u03bd + 15) (2R\u03bd + 25) (4R\u03bd + 15)\n\n(B2)\n\n(B3)\n\n2. Baryons\n3\n\u03b4\u03b3 (\u03c4 )\n4\n\n(B4)\n\n\u03b21 R b\n10\u03b21 Rb\n\u03b21 Rb (15Rb + 2R\u03bd \u2212 2) 2 4 5\n\u03c9k 4 \u03c4 4 \u000f +\n\u03c9k 4 \u03c4 4 \u000f2 \u2212\n\u03c9 k \u03c4 \u000f\n6(1 \u2212 R\u03bd )\n3 (1 \u2212 R\u03bd ) (4R\u03bd + 15)\n96 (R\u03bd \u2212 1) 2\n\n(B5)\n\n\u03b4b (\u03c4 ) =\n\nSb (\u03c4 ) =\n\n3. Cold Dark Matter\n\u0012\n\u0013\n\u03b21 2 2 \u03b21 2 3\n1\n10\n\u03b21\n+ 2\u03b21 \u2212 1 k 4 \u03c4 4 \u2212 \u03c9 2 k 2 \u03c4 4\n\u03b4c (\u03c4 ) = \u2212 k \u03c4 + \u03c9k \u03c4 + \u03b21 \u2212\n2\n10\n72\n4R\u03bd + 15\n32\n\n(B6)\n\n\f9\n4. Neutrinos\n\u0012\n\u0013\n1\n1\n\u03b21\n2\u03b21 2 2 2\u03b21 2 3\nk \u03c4 +\n\u03c9k \u03c4 + \u03b21 \u03b21 \u2212\nk4 \u03c4 4 \u2212 \u03c92 k2 \u03c4 4\n\u03b4\u03bd (\u03c4 ) = \u2212\n3\n15\n27\n4R\u03bd + 15\n24\n\u0001\n\u03b21 8R\u03bd2 + 50R\u03bd + 275\n\u03b21 (4R\u03bd + 23) 4 3\n16\u03b21 (1 \u2212 R\u03bd )\n4 3\n\u03b8\u03bd (\u03c4 ) = \u2212\nk \u03c4 +\nk \u03c4 \u000f+\n\u03c9k 4 \u03c4 4\n18(4R\u03bd + 15)\n9 (2R\u03bd + 15) (4R\u03bd + 15)\n120 (2R\u03bd + 15) (4R\u03bd + 15)\n16\u03b21 (R\u03bd \u2212 1) (2R\u03bd \u2212 15)\n32\u03b21 (R\u03bd \u2212 1) (6R\u03bd + 181)\n\u2212\n\u03c9k 4 \u03c4 4 \u000f +\nk 4 \u03c4 3 \u000f2\n15 (2R\u03bd + 15) (2R\u03bd + 25) (4R\u03bd + 15)\n45 (2R\u03bd + 15) (2R\u03bd + 25) (4R\u03bd + 15)\n\n(B7)\n\n(B8)\n\n4\n(4R\u03bd \u2212 5)\n64 (R\u03bd \u2212 1)\nF\u03bd2 (\u03c4 )\n=\nk2 \u03c4 2 +\n\u03c9k 2 \u03c4 3 +\nk2 \u03c4 2 \u000f\n2\n12R\u03bd + 45\n3 (2R\u03bd + 15) (4R\u03bd + 15)\n9 (2R\u03bd + 15) (4R\u03bd + 15)\n28 (7\u03b21 \u2212 3) R\u03bd + 5 (175\u03b21 + 27\u03b22 \u2212 84) 4 4\n(4R\u03bd (2R\u03bd \u2212 65) + 225)\n\u2212\nk \u03c4 +\n\u03c92 k2 \u03c4 4\n189 (25 + 2R\u03bd ) (15 + 4R\u03bd )\n24 (2R\u03bd + 15) (2R\u03bd + 25) (4R\u03bd + 15)\n16 (R\u03bd \u2212 1) (2R\u03bd \u2212 15)\n32 (R\u03bd \u2212 1) (6R\u03bd + 181)\n+\n\u03c9k 2 \u03c4 3 \u000f \u2212\nk 2 \u03c4 2 \u000f2\n(B9)\n3 (2R\u03bd + 15) (2R\u03bd + 25) (4R\u03bd + 15)\n9 (2R\u03bd + 15) (2R\u03bd + 25) (4R\u03bd + 15)\nF\u03bd3 (\u03c4 ) =\n\n4\nk3 \u03c4 3\n7(12R\u03bd + 45)\n\n(B10)\n\n5. Curvature (synchronous gauge)\n\u0012\n\u03b7(\u03c4 ) = 2+\n\n5\n\u03b21\n\u2212\n12R\u03bd + 45\n6\n\n\u0013\n\n\u0001\n16\u03b21 R\u03bd2 + 20 (9\u03b21 + 5) R\u03bd + 25 (18\u03b21 \u2212 5)\n80 (R\u03bd \u2212 1)\n2 2\nk \u03c4 +\nk \u03c4 \u000f+\n\u03c9k 2 \u03c4 3\n9 (2R\u03bd + 15) (4R\u03bd + 15)\n60 (2R\u03bd + 15) (4R\u03bd + 15)\n(B11)\n2 2\n\nAppendix C: Tight-coupling Approximation to Second Order in \u03c4c\n\nIn this Appendix, we give the key result of our improved tight-coupling approximation scheme: the photon-baryon\nslip to second order in \u03c4c .\n\"\n!#\n\u0015\n\u0012\n\u0013\n\u03c4\u0307c\n\u03c4c\n\u00e4\n1\n\u1e1e\u03b32\n2\n1\n2\n2\n2\n=\nSb +\n\u2212 \u03b8b \u2212 k H\n\u03b4\u03b3 \u2212 \u03b21 F\u03b32 + k cs \u03b4\u0307b \u2212 \u03b4\u0307\u03b3 + \u03b21\n(C1)\n\u2212H\n\u03c4c\n1+R\n1+R\na\n2\n4\n2\n\u0010\n\u0011\uf8f9\n\uf8ee\n\"\n\u0001\n\u0001\n2R 3H2 c2s + (R + 1)\u1e22 \u2212 3H2\n2\n\u03c4\nHk 2 (1 \u2212 3c2s )\u03b8b\n\u00e4 H 2 \u2212 3c2s R \u2212 2 \u03b8b\nc\n\uf8f0\n\uf8fb\n\u2212\nS\n\u03c4\n+\n+\nb\nc\n(R + 1)3\n(1 + R)2 a\n(R + 1)\n3(R + 1)\n\u0001\n\u0001\nH2 k 2 2 \u2212 3c2s R \u2212 1 \u03b4\u03b3\n\u00e4 k 2 c2s \u03b4b\nk 4 (3c2s \u2212 1)c2s \u03b4b\nk 4 R(3c2s \u2212 1)\u03b4\u03b3\n\u00e4 k 2 (2 + 3R)\u03b4\u03b3\n+\n+\n+\n+\n+\na (R + 1)\n3(R + 1)\n12(R + 1)\na 4(R + 1)\n2(R + 1)\n\u0001 \u0001\n2\n2\n2 2\n2\n2\n3\n4\nHk 2 + 5 \u2212 3cs R \u03b4\u0307\u03b3\nHk cs (1 + (3cs \u2212 2)R)\u03b4\u0307b\n2H(1 \u2212 3cs )k \u03c3 k (3c2s \u2212 1)\u03b21 \u03b7\n+\n+\n+\n+\nR+1\n4(R + 1)\n3\n3\n\"\n#\n\u0015\n\u00e4\n2 2\n2\n2\n2\n2\n4 a \u03b8b \u2212 4k cs \u03b4\u0307b + 2Hk \u03b4\u03b3 + k \u03b4\u0307\u03b3\nk (1 \u2212 3cs )\u2206\n4HR\n+2Hk 2 (3c2s \u2212 1)\u03b7\u0307 +\n+\n\u03c4c \u03c4\u0307c \u2212\n\u03c4\u0307c Sb + O(\u03c4c3 )\n6\n2(R + 1)2\n(R + 1)2\n\u0014\n\n\u1e60b\n\nHere, \u2206 = 8\u03c0Ga2 (\u03c1\u03b3 \u03b4\u03b3 + \u03c1\u03bd \u03b4\u03bd + 3c2s \u03c1b \u03b4b ).\n\n[1] P. J. E. Peebles and J. T. Yu, Astrophys. J. 162, 815\n(1970).\n\n[2] M. L. Wilson and J. Silk, Astrophys. J. 243, 14 (1981).\n\n\f10\n[3] J. R. Bond and G. Efstathiou, Astrophys. J. 285, L45\n(1984).\n[4] N. Vittorio and J. Silk, Astrophys. J. 285, L39 (1984).\n[5] J. R. Bond and G. Efstathiou, Mon. Not. Roy. Astron.\nSoc. 226, 655 (1987).\n[6] N. Sugiyama and N. Gouda, Progress of Theoretical\nPhysics, 88, 803 (1992).\n[7] C. P. Ma and E. Bertschinger, Astrophys. J. 455, 7\n(1995) [arXiv:astro-ph/9506072].\n[8] D. Grin and C. M. Hirata, Phys. Rev. D 81, 083005\n(2010) [arXiv:0911.1359 [astro-ph.CO]].\n[9] J. A. Rubino-Martin, J. Chluba, W. A. Fendt and\nB. D. Wandelt, arXiv:0910.4383 [astro-ph.CO].\n[10] W. Y. Wong, A. Moss and D. Scott, MNRAS\n386:10231028 (2008) arXiv:0711.1357 [astro-ph].\n[11] A. Lewis, A. Challinor and A. Lasenby, Astrophys. J.\n538, 473 (2000) [arXiv:astro-ph/9911177].\n[12] U. Seljak and M. Zaldarriaga, Astrophys. J. 469, 437\n(1996) [arXiv:astro-ph/9603033].\n[13] A. C. Hindmarsh, Scientific Computing, R. S. Stepleman\net al. (eds.), North-Holland, Amsterdam, 1983, pp. 55-64.\n\n[14] M. Bucher, K. Moodley and N. Turok, Phys. Rev. D 62,\n083508 (2000) [arXiv:astro-ph/9904231].\n[15] J. Hamann, A. Balbi, J. Lesgourgues and C. Quercellini,\nJCAP 0904, 011 (2009) [arXiv:0903.0382 [astro-ph.CO]].\n[16] E. Komatsu et al., arXiv:1001.4538 [astro-ph.CO].\n[17] M. Doran, JCAP 0506, 011 (2005) [arXiv:astroph/0503277].\n[18] T. Kobayashi, R. Maartens, T. Shiromizu and K. Takahashi, Phys. Rev. D 75, 103501 (2007) [arXiv:astroph/0701596].\n[19] A. Challinor and A. Lasenby, Astrophys. J. 513, 1 (1999)\n[arXiv:astro-ph/9804301].\n[20] [Planck Collaboration], arXiv:astro-ph/0604069.\n[21] A. Lewis and S. Bridle, Phys. Rev. D 66, 103511 (2002)\n[arXiv:astro-ph/0205436].\n[22] A. Gelman and D. B. Rubin, Statist. Sci. 7 457-511\n(1992)\n[23] C. Pitrou,\nPhys. Lett. B698,\n1-5 (2011).\n[arXiv:1012.0546 [astro-ph.CO]].\n[24] A. Lewis, CAMB notes, unpublished (2010)\n\n\f"}