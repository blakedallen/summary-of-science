{"id": "http://arxiv.org/abs/0903.3887v2", "guidislink": true, "updated": "2009-03-23T21:10:06Z", "updated_parsed": [2009, 3, 23, 21, 10, 6, 0, 82, 0], "published": "2009-03-23T15:59:17Z", "published_parsed": [2009, 3, 23, 15, 59, 17, 0, 82, 0], "title": "Universal features of surname distribution in a subsample of a growing\n  population", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.0578%2C0903.2928%2C0903.0202%2C0903.3013%2C0903.0006%2C0903.4559%2C0903.0921%2C0903.4765%2C0903.1314%2C0903.2066%2C0903.3849%2C0903.1534%2C0903.4580%2C0903.1514%2C0903.2692%2C0903.1135%2C0903.2244%2C0903.2085%2C0903.4455%2C0903.4375%2C0903.0791%2C0903.2655%2C0903.5517%2C0903.5296%2C0903.4959%2C0903.4003%2C0903.3923%2C0903.3314%2C0903.3005%2C0903.0826%2C0903.4705%2C0903.5535%2C0903.2289%2C0903.3149%2C0903.2555%2C0903.3233%2C0903.2177%2C0903.0156%2C0903.1073%2C0903.1353%2C0903.0250%2C0903.5144%2C0903.0132%2C0903.1298%2C0903.2909%2C0903.1602%2C0903.0934%2C0903.4553%2C0903.1775%2C0903.1760%2C0903.2933%2C0903.1802%2C0903.0998%2C0903.3887%2C0903.5427%2C0903.4877%2C0903.0268%2C0903.4489%2C0903.1158%2C0903.2651%2C0903.1489%2C0903.2001%2C0903.3724%2C0903.0664%2C0903.1410%2C0903.2152%2C0903.5247%2C0903.3867%2C0903.4785%2C0903.3365%2C0903.5544%2C0903.5269%2C0903.2945%2C0903.1948%2C0903.1198%2C0903.0720%2C0903.5500%2C0903.0429%2C0903.4925%2C0903.3694%2C0903.5060%2C0903.1285%2C0903.2541%2C0903.2044%2C0903.2011%2C0903.4601%2C0903.5534%2C0903.1306%2C0903.3299%2C0903.4412%2C0903.5363%2C0903.3410%2C0903.3187%2C0903.1348%2C0903.2443%2C0903.4205%2C0903.1423%2C0903.2882%2C0903.2838%2C0903.1015%2C0903.1049&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Universal features of surname distribution in a subsample of a growing\n  population"}, "summary": "We examine the problem of family size statistics (the number of individuals\ncarrying the same surname, or the same DNA sequence) in a given size subsample\nof an exponentially growing population. We approach the problem from two\ndirections. In the first, we construct the family size distribution for the\nsubsample from the stable distribution for the full population. This latter\ndistribution is calculated for an arbitrary growth process in the limit of slow\ngrowth, and is seen to depend only on the average and variance of the number of\nchildren per individual, as well as the mutation rate. The distribution for the\nsubsample is shifted left with respect to the original distribution, tending to\neliminate the part of the original distribution reflecting the small families,\nand thus increasing the mean family size. From the subsample distribution,\nvarious bulk quantities such as the average family size and the percentage of\nsingleton families are calculated. In the second approach, we study the past\ntime development of these bulk quantities, deriving the statistics of the\ngenealogical tree of the subsample. This approach reproduces that of the first\nwhen the current statistics of the subsample is considered. The surname\ndistribution from th e 2000 U.S. Census is examined in light of these findings,\nand found to misrepresent the population growth rate by a factor of 1000.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0903.0578%2C0903.2928%2C0903.0202%2C0903.3013%2C0903.0006%2C0903.4559%2C0903.0921%2C0903.4765%2C0903.1314%2C0903.2066%2C0903.3849%2C0903.1534%2C0903.4580%2C0903.1514%2C0903.2692%2C0903.1135%2C0903.2244%2C0903.2085%2C0903.4455%2C0903.4375%2C0903.0791%2C0903.2655%2C0903.5517%2C0903.5296%2C0903.4959%2C0903.4003%2C0903.3923%2C0903.3314%2C0903.3005%2C0903.0826%2C0903.4705%2C0903.5535%2C0903.2289%2C0903.3149%2C0903.2555%2C0903.3233%2C0903.2177%2C0903.0156%2C0903.1073%2C0903.1353%2C0903.0250%2C0903.5144%2C0903.0132%2C0903.1298%2C0903.2909%2C0903.1602%2C0903.0934%2C0903.4553%2C0903.1775%2C0903.1760%2C0903.2933%2C0903.1802%2C0903.0998%2C0903.3887%2C0903.5427%2C0903.4877%2C0903.0268%2C0903.4489%2C0903.1158%2C0903.2651%2C0903.1489%2C0903.2001%2C0903.3724%2C0903.0664%2C0903.1410%2C0903.2152%2C0903.5247%2C0903.3867%2C0903.4785%2C0903.3365%2C0903.5544%2C0903.5269%2C0903.2945%2C0903.1948%2C0903.1198%2C0903.0720%2C0903.5500%2C0903.0429%2C0903.4925%2C0903.3694%2C0903.5060%2C0903.1285%2C0903.2541%2C0903.2044%2C0903.2011%2C0903.4601%2C0903.5534%2C0903.1306%2C0903.3299%2C0903.4412%2C0903.5363%2C0903.3410%2C0903.3187%2C0903.1348%2C0903.2443%2C0903.4205%2C0903.1423%2C0903.2882%2C0903.2838%2C0903.1015%2C0903.1049&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We examine the problem of family size statistics (the number of individuals\ncarrying the same surname, or the same DNA sequence) in a given size subsample\nof an exponentially growing population. We approach the problem from two\ndirections. In the first, we construct the family size distribution for the\nsubsample from the stable distribution for the full population. This latter\ndistribution is calculated for an arbitrary growth process in the limit of slow\ngrowth, and is seen to depend only on the average and variance of the number of\nchildren per individual, as well as the mutation rate. The distribution for the\nsubsample is shifted left with respect to the original distribution, tending to\neliminate the part of the original distribution reflecting the small families,\nand thus increasing the mean family size. From the subsample distribution,\nvarious bulk quantities such as the average family size and the percentage of\nsingleton families are calculated. In the second approach, we study the past\ntime development of these bulk quantities, deriving the statistics of the\ngenealogical tree of the subsample. This approach reproduces that of the first\nwhen the current statistics of the subsample is considered. The surname\ndistribution from th e 2000 U.S. Census is examined in light of these findings,\nand found to misrepresent the population growth rate by a factor of 1000."}, "authors": ["Yosef E. Maruvka", "Nadav M. Shnerb", "David A. Kessler"], "author_detail": {"name": "David A. Kessler"}, "author": "David A. Kessler", "links": [{"href": "http://arxiv.org/abs/0903.3887v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0903.3887v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "q-bio.PE", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "q-bio.GN", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0903.3887v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0903.3887v2", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "Universal features of surname distribution in a subsample of a growing\npopulation\nYosef E. Maruvka, Nadav M. Shnerb, David A. Kessler\u2217\n\narXiv:0903.3887v2 [q-bio.PE] 23 Mar 2009\n\nDepartment of Physics, Bar-Ilan University, Ramat-Gan 52900 Israel\n\nAbstract\nWe examine the problem of family size statistics (the number of individuals carrying the same surname, or\nthe same DNA sequence) in a given size subsample of an exponentially growing population. We approach the\nproblem from two directions. In the first, we construct the family size distribution for the subsample from\nthe stable distribution for the full population. This latter distribution is calculated for an arbitrary growth\nprocess in the limit of slow growth, and is seen to depend only on the average and variance of the number\nof children per individual, as well as the mutation rate. The distribution for the subsample is shifted left\nwith respect to the original distribution, tending to eliminate the part of the original distribution reflecting\nthe small families, and thus increasing the mean family size. From the subsample distribution, various bulk\nquantities such as the average family size and the percentage of singleton families are calculated. In the\nsecond approach, we study the past time development of these bulk quantities, deriving the statistics of the\ngenealogical tree of the subsample. This approach reproduces that of the first when the current statistics of\nthe subsample is considered. The surname distribution from th e 2000 U.S. Census is examined in light of\nthese findings, and found to misrepresent the population growth rate by a factor of 1000.\nKey words: family size, growing population, coalescent, distribution\n\n1. Introduction\nThere is a long history of work in the social\nsciences on family size distributions. The classic\nfounding work in this field is that of Galton and\nWatson (GW) [4] who tried to explain the decline\nof the British great families, as indicated by data on\nsurname abundance. Rejecting previous explanations based on \"fitness\", e.g., that the rise of physical comfort is followed by fertility decline, they assumed that the phenomenon is purely statistical.\nThe affiliation of an individual with certain family,\nexpressed in his/her surname, was assumed by GW\nto be a neutral property. This feature is inherited\nto the next generation according to a well defined\nrule (all offsprings take the surname of their father)\n\n\u2217 Corresponding author, (tel) +972-3-531-8177, (fax)\n+972-3-738-4054\nEmail addresses: yosi.maruvka@gmail.com (Yosef E.\nMaruvka), shnerbn@mail.biu.ac.il (Nadav M. Shnerb),\nkessler@dave.ph.biu.ac.il (David A. Kessler)\n\nPreprint submitted to Journal of Theoretical Biology\n\nand is subject to the stochasticity that characterizes birth-death processes. Assuming a well-mixed\npopulation, GW claimed that all surnames undergo\nextinction in the long run. In fact, their conclusions were correct only for an equilibrium population, whereas for a growing population, their equations exhibit a second nontrivial solution which was\nfound by Steffenson [13, 14] and exploited by Lotka\n[8, 9] using U.S. census data to deduce the offspring\ndistribution. Subsequently the impact of surname\nchanges (\"mutations\") was considered by Manrubia\nand Zanette (MZ) [10]. All in all, the surname in\na society undergoes a birth-death-mutation process,\nand the current surname abundance distribution reflects the demographic (birth-death ratio) and social (mutation rate) characteristics of the population. MZ also presented data for the distribution\nof surname in the populations in Argentina, Berlin,\nand five cities in Japan, where the statistics were\nobtained from phonebooks. The data exhibited the\npredicted 1/n2 behavior at large n for the probability of n appearances of a surname. MZ then\nNovember 19, 2018\n\n\fattempted to use the deviations for smaller n to\ndeduce the growth rate of the population.\nAs already pointed out in Manrubia et al. [11],\nthe importance of the clan statistics for a population that undergoes a birth-death-mutation process goes far beyond its applicability to surname\ndynamics. Any neutral genetic feature associated\nwith a sequence that appears on certain loci and\nis subject to mutations undergoes exactly the same\nprocess, thus the results for surnames reflect also\nthe amount of genetic polymorphism in the population. Another neutral process of the same kind\nwas suggested by Hubbell [5, 6, 2] and Bell [2] as\nthe underlying mechanism that yields the observed\nspecies abundance distribution. This heretical idea\nopposes the traditional \"niche\" theories that seeks\nto explain species abundance ratios in terms of interspecies interaction and fitness, and ignited an\nenormous contentious debate on that subject [12].\nThe argumentation of both sides is based on the\nspecies abundance statistics, as gathered in largescale censuses [3] and the very same problem arises:\nwhat statistics should one expects in case of a growing or shrinking population which is subject to neutral mutation?\nBefore trying to compare the observed statistics\nwith some theoretical predictions (e.g., in order\nto recover demographic parameters from the abundance ratio) one should address two crucial issues.\nThe first is universality: to what extent should one\nexpect the results to be independent of the \"microscopic\" features of the process? Fig. 1 shows the\nfamily size statistics (Pareto plot) obtained from\nnumerical simulations of two populations with the\nsame demographic characteristics. The dynamics\nassumes nonoverlapping generations, where the average number of offspring per individual is \u03bb > 1\nand the chance of an offspring to mutate (i.e., to\ndiffer from its originator and to start a new clan)\nis \u03bc. Both populations have the same values for\n\u03bb and \u03bc, but they differ microscopically: in one\ncase the chance for an individual to produce n offsprings obeys the Poisson distribution with average \u03bb, in the other case it satisfies the geometrical\ndistribution with the same average. As one can\nclearly see, the tails of these distribution coincides,\nbut the bulk abundance statistic is different; this\nimplies that the theory of abundance ratio has no\nuse for any practical purpose unless one knows the\nvery fine details of the demographic properties of\nthe population throughout history, an inconceivable task in almost all circumstances. A comparison\n\n4\n\nAvg. Number of Families\n\n10\n\nPoisson\nGeometric\n\n2\n\n10\n\n0\n\n10\n\n-2\n\n10\n\n1000\n\n-4\n\n10\n\n100\n-6\n\n10\n\n1\n\n4\n\n8\n\n12\n100\n\n16\n10000\n\nFamily Size\n\nFigure 1: Family size distribution for a population of 4 * 106 ,\nfor the parameters \u03bb = 1.005, \u03bc = 5 * 10\u22124 , for a Poisson\nand for a geometrical distribution of offspring. The data was\naveraged over 100 runs and binned into bins which contained\na minimum of 1000 families over the 100 runs. One sees that\nthe large families are distributed in both cases as a power\nlaw, as in the MZ model. The power-law cuts off at small\nfamily sizes, below sizes of roughly 1000, at which point the\ntwo distributions diverge. Inset: A blowup of the figure for\nsmall family sizes, highlighting the difference between the\ntwo distributions.\n\nbetween experimental data and theoretical predictions is possible if, and only if, one can show that\nthere is a universal regime in which the statistics is\nindependent of the microscopic details; this is one\nof the aims of this paper.\nThe second issue that should be addressed is the\neffect of sampling. In all cases considered above\n- surnames, genetic polymorphism, species abundance - the raw data is made of individuals sampled from the whole population together with their\naffiliation with certain surname or certain species.\nIt is difficult to perform a complete census, given\nthat typically one does not have access to the entire population. Thus for example, MZ only looked\nat the surnames beginning with \"A\" in the Berlin\nphone book. Even for the US census data, one has\naccess to (almost) the entire population only under the assumption that the US is demographically\nisolated, which it is clearly not. In the application\nwe have in mind, that of looking at genomic data\nto measure historic growth rates of the population,\none has such data for an extremely small sample of\nthe entire human population.\nWhat is the effect of incomplete sampling? In\nFig. 2 one can see the characteristic features of\n2\n\n\fweak sampling limits, exhibiting simpler formulae\nfor the average family size and number of singleton\nfamilies We also show that the large-family powerlaw asymptotics is left unchanged by the sampling.\nThe second approach is based on looking at the\nbehavior of the genealogical tree of the selected\nsample. We calculate the size of the tree as a function of time, as well as the number of families and\nsingletons, all in the limit of small mutation rate.\nThese results are seen to reproduce those of the\nprevious approach for the current statistics of the\nselected sample.\nThe plan of the paper is as follows. In Section 2,\nwe describe our model, explain the notation used\nalong this work and highlight our main results. In\nSection III, we present our derivation of the family size distribution for the subsample, and calculate the average family size and number of singleton\nfamilies. In Section IV, we present our second approach. Finally, in Section V we examine the surname distribution taken from the U.S. census data\nin light of our findings. We then summarize and\npresent some concluding remarks.\n\n4\n\nAvg. No. of Families\n\n10\n\n0\n\n10\n\n6\n\n4 10\n5\n2 10\n4\n2 10\n3\n2 10\n2\n2 10\n\n-4\n\n10\n\n-8\n\n10\n\n1\n\n10\n\n100\n\n1000\n\nFamily Size\n\nFigure 2: Avg. number of families of a given size, for the full\npopulation of 4 * 106 , and subsamples of size 2 * 105 , 2 * 104 ,\n2 * 103 and 200. The growth rate is \u03b3 = 0.005, and the\nmutation rate is \u03bc = 5 * 10\u22124 , and the child distribution is\nPoisson. The circles represent averages over 100 iterations.\nThe lines are the theory for the full population, Eq. (7) and\nfor a \"red\" subsample, Eq. (8). The deviations from the\npower law for the largest m's seen in the No = 200 and 2000\ndata are due to the fact that the largest family does not\nobey the stable distribution, but rather reflects the single\nindividual initial conditions chosen [10].\n\n2.\nthe family statistics obtained in the two regimes:\nstrong and weak sampling. One can see that the\nfull statistics is characterized by a \"shoulder\" in\nthe small families region, followed by a power-law\ndecay for large families. If the sampling is strong\nthe distribution is shifted quite rigidly to the left,\nwhile the case of weak sampling is characterized by\na peak for the singletons (families with only one\nmember) followed by a power-law. Our second aim\nhere is to clarify effect in both regimes.\nIn the following, we analyze the problem from\ntwo different angles. The first is centered on the\nstable distribution for the entire population. This\ndistribution can be calculated from a Fokker-Planck\nequation, akin to that written down by MZ. We\nshow this Fokker-Planck equation is in fact universally valid in the limit of small growth rate, for an\narbitrary distribution of children produced by an\nindividual, with the coefficients depending only on\nthe average and variance of the children distribution, together with the mutation rate. From this\nwe can calculate the distribution for a given sized\nsubsample of the population in terms of a hypergeometric function. We then endeavor to assimilate the\nmeaning of this result, focussing on the strong and\n\nModel, simulation technique and main\nresults\n\nOur basic model is that of a growing population\nwith nonoverlapping generations, as in the original\nGalton-Watson work. Every member of the population simultaneously gives birth to a random number\nof children, drawn from a given distribution with\nmean \u03bb, and is then removed. The children are\nall reckoned to belong to the same family as the\nparent, unless they undergo a mutation at birth,\nwhich occurs with probability \u03bc. The mutated child\nis considered to start a new family. We start the\npopulation with one individual, repeating the experiment until the population survives the initial\nstages and achieves the desired size. In principle,\nwe could track the genealogy of every individual. In\npractice, for efficiency's sake, we track only the genealogy of families, which is sufficient to determine\nthe family identification of every individual. Thus,\nit is sufficient to draw the number of children of\neach family. In our simulations, we mostly employ\na Poisson distribution for the number of children,\noccasionally comparing to the case of a geometrical distribution. In the former case, the distribution of children of a given family of size n is again\nPoisson, with mean \u03bb, whereas for the geometrical\n3\n\n\fWe then measure sampling strength, s, through\n\ndistribution, it is a Pascal (or negative binomial)\ndistribution.\nAs a technical point, we will be interested in Section V in the genealogical tree of subsamples of the\npopulation, so that we can track the time development of the statistics of this tree. We can do this\nretrospectively for the Poisson case, simply picking\nancestors for each individual among the set of individuals in the family in the previous generation\nwhich gave rise to this individual (which is the same\nfamily, barring mutations). This is done to avoid\nhaving to store the genealogies of individuals, which\nare of course more voluminous than those of families.\nGlossary: The growth rate \u03b3 \u2261 \u03bb\u22121 reflects the\ndeviation of the process from demographic equilibrium. In general, as discussed above, the distribution function depends on the details of P (m), the\nchance of an individual to have m children in the\nnext generation. It turns out, however, that in the\nuniversal regime the family statistics depends only\non three parameters: \u03b3 (or equivalently \u03bb), which\nreflects the average number of offspring per individual, \u03c3, the standard deviation of the offspring\ndistribution defined as\nX\n\u03c32 \u2261\nm2 P (m) \u2212 \u03bb2 = Var(m),\n(1)\n\ns\u2261\n\n1. In the large m limit nm decays like a powerlaw, nm \u223c m\u2212\u03b2 where\n\u03b2=\n\n2No \u03b3\n+ \u03bd)\n\nln \u03bb2 (1 \u2212 \u03bc)\nln \u03bb(1 \u2212 \u03bc)\n\n(5)\n\nThis law is semi-universal, in that it is independent of the details of P (m). It however depends on the assumption of nonoverlapping generations, and therefore differs from\nthe power law found by MZ. It does however\nreduce to the MZ result, \u03b2 = 2 + \u03bd, in the slow\ngrowth, small mutation limit \u03b3 \u223c \u03bc \u001c 1.\n2. The whole distribution (except for the very\nsmallest m's) becomes universal if both \u03bc and \u03b3\nare small. In that case n(x) satisfy the FokkerPlanck equation:\n\u2202\n\u03c32 \u2202 2\n\u2202n\n= \u2212(\u03b3 \u2212 \u03bc) (xn) +\n(xn).\n\u2202t\n\u2202x\n2 \u2202x2\n\n(6)\n\nA similar equation has been obtained by MZ\nfor their particular model; here we show that\nit is a universal limit of the process for small\nrates, and also reveal its dependence on \u03c3.\n3. Solving for the steady state distribution of (6),\nthe abundance distribution function is:\n\u0012\n\u0013\n\u03bdRc\n2\u03b3\nn(x) =\n\u0393 (2 + \u03bd) U 1 + \u03bd, 0, 2\nx\nx\n\u03c3 (1 + \u03bd)\n(7)\nwhere U is the Kummer function [1]. Thus,\nthe abundance distribution for different microscopic processes with the same \u03b3 and \u03bc are\nrelated by a rescaling of the family size m and\nthe abundance n, n\u03c3 4 being a universal function of m/\u03c3 2 (since Rc \u221d 1/\u03c3 2 ). We see this\nin Fig. 3.\n4. For the sampled (\"red\") population, nR\nm is\ngiven by the monstrous expression:\n\nand \u03bc, the mutation rate. For convenience, we define\n\u03bc\n(2)\n\u03bd\u2261\n\u03b3\u2212\u03bc\nas this combination appears often.\nThe number of families with m members is defined as nm . These definition implies that the sum\nof mnm over all m's yields the overall current size\nof the population, No . Except for m's of order\nunity, one may consider the size of the family as\na continuous variable, thus replacing m by x and\nnm by n(x). When the sampling is incomplete we\ntag the sampled individuals as \"red\", defining nR\nm\nas the abundance of families with m individuals in\nthe red (sampled) population [When dealing with\nthe whole genealogy we define a \"red\" subgenealogy\nconsisting of all the individuals that have at least\none descendent in the sampled population]. Sampling introduces a new parameter to the problem,\nRo , the number of sampled (\"red\") individuals. It\nturns out that there is a \"critical\" sample size which\ndistinguishes between weak and strong sampling:\n\u03c3 2 (1\n\n(4)\n\nOur main results are:\n\nm\n\nRc \u2261\n\nRo\nRo \u03c3 2 (1 + \u03bd)\n=\n.\nRc\n2No \u03b3\n\nm\nnR\nm \u2248 \u03bdRc B (2 + \u03bd, m) s 2 F1 (m, m + 1; m + 2 + \u03bd; 1 \u2212 s)\n\n(\nwhere B(a, b) \u2261 \u0393(a)\u0393(b)/\u0393(a + b) is the Beta\nfunction and 2 F1 is the hypergeometric function [1], and s is the sampling strength introduced above. To digest this, we focus on two\n\n(3)\n4\n\n\f4\n\nScaled No. of Families ( n\u03c3 )\n\n4\n\n10\n\n10\n\nPoisson\nGeometric\nAnalytic\n\n2\n\n10\n\n10\n\nx\n\n\u22121\n\n8\n\n10\n0\n\n6\n\nR\n\nRo nm\n\n10\n\n-2\n\n10\n\n10\n\n-4\n\n10\n\nFull - 4 10\n5\n6.4 10\n5\n3.2 10\n5\n1.6 10\n4\n8 10\n\n6\n\n4\n\n10\n\n-6\n\nx\n\n\u22122.11\n\n10\n\n2\n\n1\n\n100\n\n10\n\n10000\n2\n\nFigure 3: Scaled average number of families n\u03c3 4 as a function of scaled family size m/\u03c3 2 for the Poisson and geometric\noffspring distributions. The data is the same as in Fig. 1.\nAlso shown is the analytic prediction, Eq. (7).\n\n\u0393(2 + \u03bd)\nU (1 + \u03bd, 0, m/s)\nm\n\n\u03bdRc\nm\n\n(9)\n\n-2\n\n10\n\ns(1 + \u03bd)\ni\nmR = h\n\u03bd 2 F1 (1, 1; 3 + \u03bd; 1) \u2212 (1 \u2212 s) 2 F1 (1, 1; 3 + \u03bd; 1 \u2212 s)\n(12)\nThis is shown in Fig. 6, where mR is shown\nas a function of Ro , together with the results\nof numerical simulations. For strong sampling,\nthere of order ln s red families, and\ns\nmR \u2248\n(13)\n\u03bd ln as\nwhere a is a \u03bd dependent constant which approaches unity for small \u03bd, given by Eq. (38).\nIn particular, in the full sample, s = \u03c3 2 (1 +\n\u03bd)/2\u03b3, and the average family size is large, of\norder \u22121/(\u03b3\u03bd ln \u03b3)\nFor weak enough sampling, the average family size approaches unity, since all families are\n\n(10)\n\nFor large arguments, we recover the standard\npower-law. This is evidenced in Fig. 4.\nFor weak sampling, Ro \u001c \u03b3No , i.e., s \u001c 1,\nthe sampling strength decouples from the distribution for m > 1 except to set the overall\nnormalization:\n\u03bd\nnR\nm \u2248 B(2 + \u03bd, m \u2212 1 \u2212 \u03bd)\u03bdRo s\n\n10\n\nThis is demonstrated in Fig. 5. The distribution rapidly approaches the expected powerlaw behavior from above as m increases. Thus,\nthe shoulder has disappeared completely. The\nfamilies of family size 1, which we denote singletons, are exceptional for weak sampling,\nsince the chance of sampling more than one\nmember from a given family vanishes in the\nsmall s limit, except for small (scaled) mutation rate \u03bd, where there are anomalously large\nnumbers of large families.\n5. The average red family size, mR , is given by\nthe equally monstrous formula\n\nThus, since s is proportional to Ro , when varying Ro , Ro nR\nm is a function only of m/Ro , and\nthe dependence of Ro just amounts to rescalings of m and nR\nm . This implies that in this\nlimit the breakdown of the asymptotic powerlaw occurs at m's of order No \u03b3/Ro , and in\ngeneral sampling induces a rigid displacement\nof the family size distribution to the left and\ndownward. For strong but partial sampling the\nformula applies all the way down to m = 1,\nwhereas for the full population, the formula\nbreaks down for the smallest m's. For small\nargument, U approaches a constant, and so for\nm \u001c s, we get\nnR\nm \u2248\n\n-4\n\nm / Ro\n\nFigure 4: Data collapse for strong sampling: Ro nR\nm as a\nfunction of m/Ro for various sized samples, Ro = 6.4 * 105 ,\n3.2*105 , 1.6*105 and 8*104 , along with the whole population\nRo = No = 4 * 106 . Also shown are the small and large s\npower law predictions.\n\nlimits, that of strong and weak sampling. In\nthe strong sampling limit, \u03b3No \u001c Ro \u001c No ,\nso that s \u001d 1,\nnR\nm \u2248 \u03bdRc\n\n-6\n\n10\n\nScaled Family Size ( m / \u03c3 )\n\nm>1\n(11)\n5\n\n\f)\n1+\u03bd\n\n0\n\n10\n\n4\n\n2 10\n3\n2 10\n2\n2 10\nDilute Sample Limit\n\nR\n\nScaled Abundance (nm / Ro\n\nsingletons. For small \u03bd however, this again occurs only for extremely small samples, and in\npractice,\n1\u2212s\n(14)\nmR \u2248 \u2212\n\u03bd ln s\nso that for small \u03bd the average red family size\nis large, and decreases logarithmically as the\nsampling strength decreases.\n6. The distinction between weak and strong sampling is also reflected in the statistics of the\ngenealogical tree of the subsample. For strong\nsampling, this is a strong coalescence at first\nas we must upward in the tree. For weak\nsampling, on the other hand, the coalescence\nis very small initially. Eventually, both trees\nnarrow exponentially. For critical sampling,\nthe narrowing of the tree is exponential for all\ntimes.\n\n-2\n\n10\n\n-4\n\n10\n\n1\n\n10\n\n100\n\nFamily Size (m)\n\nThis then is the general outline of our results. In\nthe next section, we turn to a detailed derivation of\nthese findings.\n\n1+\u03bd\nFigure 5: Data collapse for weak sampling: nR\nas a\nm /Ro\nfunction of m for various sized samples, Ro = 200, 2000 and\n2 * 104 , along with the analytic prediction, Eq. (11).\n\nAvg. Family Size ( m )\n\n3. General analysis\nmutation process\n\nthe\n\nbranching-\n\nWe start with the family size distribution for the\nentire population. This is given by the solution to\na Fokker-Planck equation generalizing that derived\nby MZ for their model of overlapping generations.\nWe start with the set of difference equations for the\nevolution of the whole-population distribution:\n\u0012 \u0013\nX\np\nnt+1\n=\nn\nP\n(`\n\u2192\np)\n\u03bcp\u2212m (1 \u2212 \u03bc)m ; m > 1\n`\nm\nm\n`\np\u2265m\n\nTheory\nSimulation\n\n100\n\nof\n\nnt+1\n=\n1\n\nX\n`\n\n10\n\n(15a)\n\u0012 \u0013\np p\u22121\nn` P (` \u2192 p)\n\u03bc (1 \u2212 \u03bc) + \u03bcN (t + 1)\n1\n(15b)\n\n1\n100\n\n1000\n\n10000\n\n1e+05\n\nThe first equation represents the contribution of a\nfamily of size ` giving birth to a family of size p,\nm \u2212 p are whom mutate, leaving a family of size\nm. The probability P (` \u2192 m) of ` individuals to\ngive birth to m children is derived in term of the\nfundamental distribution of the number of children\nof a single individual, P (m), whose mean we label\n\u03bb. All mutations become new families of size one.\nBefore we present the differential equation, we\ncan verify that asymptotically for large m (item 1\nabove), the stable distribution falls like a power.\n\n1e+06\n\nSubsample Size (Ro)\nFigure 6: Average family size mR as a function of the subsample size Ro for \u03b3 = 0.005, \u03bc = 5 * 10\u22124 , and No = 4 * 106 .\n\n6\n\n\fwhere A is a normalization factor. From here, we\ncan justify the neglect of the higher derivatives.\nThe argument of the Kummer function is proportional to the small quantity \u03b3 \u2212 \u03bc, so that higher\nderivatives bring down additional factors of this\nsmall quantity and are thus indeed negligible. This\nstems from the fact that the drift term is small,\nand again hearkens back to the necessity of assuming slow growth and small mutation probability.\nThe normalization factor can be obtained from\nthe size of the entire population, which we denote\nNo , since\nZ \u221e\nX\nNo =\nmnm \u2248\nxn(x)dx\n(20)\n\nThis can be accomplished by using the central limit\ntheorem and evaluating the sums via the Laplace\nmethod. The details are this calculation are presented in Appendix A. We find that indeed nm \u223c\nm\u2212\u03b2 where\nln \u03bb2 (1 \u2212 \u03bc)\n(16)\n\u03b2=\nln \u03bb(1 \u2212 \u03bc)\nThis is different from the MZ result, and reflects\nthe difference between the overlapping generations\nin their model versus the synchronized update of\nthis model. Nevertheless, writing the growth factor\n\u03bb \u2261 1 + \u03b3 and going to the slow growth, small\nmutation limit \u03b3 \u223c \u03bc \u001c 1, we get to leading order\n\u03b2\u2248\n\n2\u03b3 \u2212 \u03bc\n=2+\u03bd\n\u03b3\u2212\u03bc\n\n(17)\n\nm\u22651\n\nThis integral can be performed analytically [see 7,\nEq. 7.612.2], yielding (item 3)\n\u0012\n\u0013\n2\u03b3\n\u03bdRc\n\u0393 (2 + \u03bd) U 1 + \u03bd, 0, 2\nx\nn(x) =\nx\n\u03c3 (1 + \u03bd)\n(21)\nIt should be noted that this normalization is different from that of MZ. The fact that the distribution\nis proportional to \u03bc flows from the fact that for\n\u03bc = 0 the distribution goes like 1/x2 and so the\nintegral diverges as 1/\u03bc.\nThe form of the distribution means that \u03c3 4 n is a\nfunction of the scaled family size m/\u03c3 2 , for all offspring distributions. This collapse is shown in Fig.\n3, where the data for the Poisson and geometric\noffspring distributions is plotted, together with the\nanalytic prediction. We see the analytic prediction\nis excellent except for the singletons, the families of\nsize one. In any case, these are not expected to be\ngiven by the formula, since the governing equation\nfor the singletons is exceptional.\nFrom the full population distribution, it is\nstraightforward to generate, at least formally, the\nfamily size distribution, nR\nm , for the \"red\" subsample of size Ro :\n\u0001 No \u2212p \u0001\np\nX\nm Ro \u2212m\nR\nnm =\nnp\n(22)\n\u0001\nNo\n\nThis is the MZ result, indicating that for overlapping generations the growth rate is always small in\nsome sense. In any case, we conclude that when\nthe growth and mutation are sufficiently small so\nthat the population changes slowly, the details of\nthe update procedure no longer matter.\nBy using the generating function for the child\ndistribution, we can derive, as detailed in Appendix\nB, the Fokker-Planck equation (item 2):\n\u2202\n\u03c32 \u2202 2\n\u2202n\n= \u2212(\u03b3 \u2212 \u03bc) (xn) +\n(xn)\n\u2202t\n\u2202x\n2 \u2202x2\n\n0\n\n(18)\n\nThis equation is approximate. In particular, the\ncoefficients are presented, in light of the discussion\nabove, to leading order in \u03bc and \u03b3. In addition, we\nhave truncated the equation at terms of second order. There are additional second derivative terms,\nwhich arise from the third \"spatial\" derivative of\nxn(x), which we have as dropped, as do MZ. The\nfirst order derivative represents the drift to larger\npopulation, with an effective growth rate for the\nfamily of \u03b3 \u2212 \u03bc, since mutations reduce the family\nsize. The coefficient of the second derivative term,\n\u03c3 2 , is the variance of the given children distribution\nof an individual. It is eminently reasonable that the\nvariance in the number of children is what gives\nrise to diffusive behavior of the family size. For the\ncase of the geometric distribution of children, which\ncharacterizes the MZ model, with variance 2 in the\nsmall \u03b3 limit, the equation reduces to theirs.\nThus, up to the change of the diffusion constant, the stable distribution in this approximation\nis again the Kummer function [1]\n\u0012\n\u0013\nA\n2(\u03b3 \u2212 \u03bc)\nn(x) \u2248 U 1 + \u03bd, 0,\nx\n(19)\nx\n\u03c32\n\np\u2265m\n\nRo\n\nwhich reflects the hypergeometric probability of\nchoosing m red members of an original family of\nsize p, when choosing Ro from No . When Ro \u001c No ,\nthe hypergeometric distribution reduces to a Poisson distribution\n\u0012\n\u0013m\nX\ne\u2212pRo /No pRo\nR\n(23)\nnm \u2248\nnp\nm!\nNo\np\u2265m\n\n7\n\n\ffor nR\nm implies that as we vary Ro , the whole distribution moves rigidly leftward and downward. In\nparticular, for m \u001c s, U approaches a constant\nvalue, 1/\u0393(2 + \u03bd), and\n\nWe can replace the sum by an integral, yielding [see\n7, Eq. 7.621.6], the result quoted in the 4th item\nabove,\n\u0012 \u0013m Z \u221e\n1 Ro\nR\ndx xm\u22121 e\u2212xRo /No \u00d7\nnm \u2248\nm! No\nm\n\u0012\n\u0013\n2\u03b3\nAU 1 + \u03bd, 0, 2\nx\n\u03c3 (1 + \u03bd)\n\u2248 \u03bdRc B (2 + \u03bd, m) sm \u00d7\n2 F1\n\nnR\nm \u2248\n\nIn Fig. 2 above, we have included together with the\nsimulational results for the family size distribution\nfor various size subsamples the predictions of our\nformula Eq. (24). We see that for all but the largest\nfamilies in the smallest subsample, there is excellent\nagreement, even for a subsample which is 1/20000\nof the whole.\nThe first thing we can verify with our analytic\nformula is that the large m behavior of the distribution is unchanged, except for normalization.\nFor large m, the sum is dominated by p's of order mNo /Ro . Expanding the summand around this\nmaximum yields a Gaussian, and we see that powerlaw is preserved.\nWe now investigate our result in the two limits\nof strong and weak sampling, defined by s \u001d 1 and\ns \u001c 1, respectively. In the limit of strong sampling,\nwe return to our fundamental expression for nR\nm,\nEq. (23). As we shall see momentarily, the typical\nscale of family size over which nm varies is large,\nof order s. Thus, the Poisson sum is essentially\n\u221a a\nGaussian centered at `\u2217 = mNo /Ro , of width `\u2217 .\nSince nm itself varies over the scale 1/\u03b3, which is\nmuch larger, to leading order the sum over ` reduces\nto a \u03b4-function, and we have\nnR\nm\n\n(26)\n\nClearly for m \u001d s, we recover the MZ power-law,\nas expected. We refer the reader back to Fig. 4\nfor a graphical presentation of the strong sampling\nregime.\nSince the shoulder of the distribution extends to\nm's of order s, clearly the shoulder vanishes by the\ntime s reaches 1. We call this \"critical\" sampling,\nand in this case the distribution is given by\n\n(m, m + 1; 2 + \u03bd + m; 1 \u2212 s) . (24)\n\n\u0393(2 + \u03bd)\n\u2248 \u03bdRc\nU (1 + \u03bd, 0, m/s)\nm\n\n\u03bdRc\nm\n\nnR\nm = \u03bdRc B (2 + \u03bd, m)\n\n(27)\n\nIn particular, for small \u03bd, this reduces to the simple\nform\n\u03bdRc\n(28)\nnR\nm =\nm(m + 1)\nand show that in this case the distribution still approaches the large m power law from below, but the\npower-law regime sets in already for m & 5 or so.\nWe now turn to the weak sampling regime, s \u001c 1.\nHere, using the transformation formula [1]\n2 F1 (a, b; c; z)\n\n=\n\n\u0393(c)\u0393(c \u2212 a \u2212 b)\n2 F1 (a, b; a + b \u2212 c + 1; 1 \u2212 z)\n\u0393(c \u2212 a)\u0393(c \u2212 b)\n\u0393(c)\u0393(a + b \u2212 c)\n\u00d7\n+ (1 \u2212 z)c\u2212a\u2212b\n\u0393(a)\u0393(b)\n2 F1 (c \u2212 a, c \u2212 b; c \u2212 a \u2212 b + 1; 1 \u2212 z)\n(29)\n\nwe note that for m > 1, the second term dominates\nfor small s. Thus, we get to leading order\n\n(25)\n\n\u03bd\nnR\nm \u2248 B(2+\u03bd, m\u22121\u2212\u03bd)\u03bdRo s\n\nAlternatively, we can obtain this expression directly\nfrom our general formula for nR\nm using the integral\nrepresentation of 2 F1 and taking the large s limit.\nThe first derivation shows that the result is valid\neven for Ro \u223c No , beyond the range of the Poisson\nsampling approximation, since the argument generalizes to the original hypergeometric sampling formula, Eq. (22). This is evident from the fact that\nwe recover the full population distribution if we simply set Ro = No . However, the partial sample distribution formula is reliable for all m, whereas for\nthe full population, the formula does not apply to\nm's of order unity. As we noted above, this form\n\nm > 1 (30)\n\nso that the m > 1 distribution is independent of\nRo , up to normalization. We see that as s \u2192 0,\nnR\nm /Ro vanishes for m > 1, since extremely dilute\nsampling will never encounter two individuals from\nthe same family. Again, the small \u03bd limit is particularly simple\nnR\nm \u2248\n\n\u03bdRo\nm(m \u2212 1)\n\nm>1\n\n(31)\n\nWe see clearly that the case m = 1 is exceptional,\nand requires a separate treatment. We also see\n8\n\n\fconverting the sum to an integral yields\nZ \u221e\u0010\n\u0011\nR\nF\n\u2248\n1 \u2212 e\u2212xRo /No \u00d7\n0\n\u0012\n\u0013\nA\n2\u03b3\nU 1 + \u03bd, 0, 2\nx dx\nx\n\u03c3 (1 + \u03bd)\n(34a)\n\u03bdRc h\n=\n2 F1 (1, 1; 3 + \u03bd; 1) \u2212\n(2 + \u03bd)\ni\n(1 \u2212 s) 2 F1 (1, 1; 3 + \u03bd; 1 \u2212 s)\n\nthat the distribution now approaches the asymptotic power-law from above. The weak sampling\nregime is illustrated in Fig. 5 above.\nWe have seen that the case of the singleton families, m = 1, requires special attention, particularly\nfor weak sampling. Using the transformation formula above, we can verify that in the weak sampling limit, s \u2192 0, nR\n1 approaches Ro , consistent\nwith the vanishing of the larger size families in this\nlimit. However, this is misleading for small \u03bc. In\nthis limit, the hypergeometric function can be expressed in terms of elementary functions, and\nnR\n1\n\n\u2212Ro \u03bd\n(1 \u2212 s + ln s) + O(\u03bd 2 )\n\u2248\n(1 \u2212 s)2\n\n(34b)\nThe details of this calculation are presented in Appendix C. Again, formally, for any finite \u03bd, we get\nthat F R approaches Ro as s \u2192 0, as all families\nare singletons. Nevertheless, for small, but not absurdly small, \u03bd, the number of families reads\n\n(32)\n\nThus, for dilute sampling, nR\n1 /Ro is seen to be approximately the small quantity \u2212\u03bd ln(s), The logarithmic behavior is again a reflection of the slow\n1/x2 decay of the whole population family distribution in the small \u03bc limit. Only for ridiculously\ndilute samples, with Ro /No of order \u03b3e\u2212\u03b3/\u03bc , does\nthe whole subsample reduce to singletons. This\nis what we see in the graphs of the simulations\nin Fig. 2.where even for the smallest subsample\nshown, with s = 0.0222, there are only 73 singletons in a population of 200. In the strong sampling regime, as can be seen from Eq. (26), we get\nnR\n1 \u2248 \u03bdRc , so it is independent of Ro . This convergence is also apparent in the data. Overall, the\nfraction of singletons decreases with the strength of\nthe sampling.\n\nF R \u2248 \u2212\u03bdRc\n\nF\n\n\u2248\n\nX\n\n\u0010\n\nnp 1 \u2212 e\n\n\u2212pRo /No\n\n\u0011\n\n(35)\n\nThus, the average family size, m \u2261 Ro /F R is given\nfor small \u03bd by\n1\u2212s\nm=\u2212\n(36)\n\u03bd ln s\nwhich is large but decreases logarithmically at small\nsampling, cutting off at one for extremely small\nsamples. density s. It is interesting that whereas\nboth the number of red families and the number of\nred singletons behave anomalously for small samples and small \u03bc, the fraction of red families that\nare singletons is smooth, approaching unity as it\nshould.\nAt critical sampling, F R = \u03bdRc /(1+\u03bd), and m =\n(1 + \u03bd)/\u03bd, which is large for small \u03bd. For large s,\nand general \u03bd, the number of families is dominated\nby the contribution from the small families, which\nbehaves as 1/m and so is logarithmically large:\n\nThe last quantity of interest is the total number\nof red families, which we denote by F R . In principle\nwe can calculate it as the sum over m red family size\ndistribution nR\nm , but it is easier to go back to the\ndefinition of nR\nm in terms of np and sum over m\nfirst, leaving the sum over p for last. The sum over\nm, if it started at m = 0 would just give unity, but\nbecause it starts at m = 1, yields, in the Poisson\napproximation Ro \u001c No :\nR\n\ns ln s\n.\n1\u2212s\n\nF R \u2248 \u03bdRc ln as\n\n(37)\n\nwhere the O(1) constant a is given by\nln a = \u03c8(1) \u2212 \u03c8(2 + \u03bd) +\n\n(33)\n\np\u22651\n\n1\n1+\u03bd\n\n(38)\n\nand \u03c8 is the digamma function, so that a approaches 1 for small \u03bd. Thus the average family\nsize diverges for large s,\n\nThus, all families in the full population give a family of some size in the red population, unless they\nare not picked at all, which occurs with probability\nexp(\u2212pRo /No ), where p is the size of the originating family. Plugging in our expression for np , and\n\nm\u2248\n\ns\n\u03bd ln as\n\nin agreement with what we found for small \u03bd.\n9\n\n(39)\n\n\f4. Red Statistics Through Time\n4.1. Red Population\nWe now present an alternative derivation of these\nresults (at least in the small \u03bd limit), based on tracing the time development of the red genealogy. We\nhave labeled an individual \"red\" if he is in the selected sample of the final population. We also label\nas red any ancestor of such an individual. We first\naddress the question of the time development of the\nred population. The basic tool for the analysis, as\nwith the original Galton-Watson work, is the generating function for the distribution of children, which\nwe denote by\nF (x) \u2261\n\n\u221e\nX\n\nP (n)xn\n\n(40)\n\nn=0\n\nThe key is the Galton-Watson observation that the\ngenerating function for the probability of descendants in the second generation, F2 (x) is the second\niterate of F ; i.e., F (F (x)). We can see this noting\nthat\n\u221e\nX\nP2 (n) =\nP (i)P i (n)\n(41)\ni=0\n\nThis is the exact answer. The function Fn is\nwhat appears in the Galton-Watson theory, and\nFn (x) approaches the Galton-Watson-Steffensen\nfixed point (which exists for all \u03bb > 1) for all x < 1.\nThis implies there is an interesting change of behavior of Rn depending on whether 1 \u2212 Ro /No is\ngreater, smaller or equal to the fixed point value. At\nthe fixed point, the percentage of reds in the general\npopulation is constant as a function of time. For a\nsmaller sample, the ratio increases as we move back\nin time, starting from the small initial value. For\na larger sample, the situation is reversed, and the\nratio decreases to the asymptotic Galton-Watson\nsurvival probability as we go back in time.\nIn order to get a more useful expression, we will\nspecialize to our limit of \u03bb close to 1, i.e., \u03b3 \u001c 1. We\nfirst calculate the Galton-Watson (GW) fixed point\nin this limit. Since for zero growth, the GW fixed\npoint is unity, it is close to this for \u03b3 small. Writing\nQ\u221e = 1\u2212\u03b4, the fixed-point equation Q\u221e = F (Q\u221e )\nreads\n1\u2212\u03b4 = F (1\u2212\u03b4) \u2248 1\u2212\u03b4\u03bb+\n\n\u0003\n\u03b42 \u0002 2\n\u03c3 \u2212 \u03bb(1 \u2212 \u03bb) (45)\n2\n\nwhere as before \u03c3 is the variance of the children\ndistribution, so that\n\nso that\nF2 (x)\n\n=\n\nX\n\nP (i)P (i \u2192 n)xn =\n\ni,n\n\nX\n\nP (i)[F (x)]i\n\n\u03b4\u2248\n\n2\u03b3\n\u03c32\n\n(46)\n\ni\n\n(42) We thus see the origin of the \"critical\" value\nof sampling we encountered in the previous section, namely the change in behavior depending on\n. Generalizing, the generating function for the\nwhether Ro /No is less than or greater than \u03b4 \u2248\nprobability of descendants in the n0 th generation,\n2\u03b3/\u03c3 2 ; i.e., on whether Ro is less than or greater\nFn (x) = F (Fn\u22121 (x)).\nthan 2\u03b3No /\u03c3 2 , which is Rc to leading order in \u03bd.\nWe now need to include the effects of sampling.\nFor the remainder of this section, we will in fact\nWe ask what the probability Qn that a person n\nrewrite 2\u03b3No /\u03c3 2 = Rc , as we are working only to\ngenerations before the end has no red descendent\nleading order in \u03bd.\nin the final sample. This is just the sum of the\nAs long as x is close to one, F (x) will similarly be\nprobabilities that it had k descendants, and that\nclose to one. Thus, for Ro \u001c No , 1 \u2212 Ro /No meets\nnone of these were picked to be in the sample:\nthis criterion and we can approximate the change\n\u0013k\n\u0012\n\u0013\n\u0012\n\u221e\nX\nin \u03b4n = Rn /Nn = 1 \u2212 Qn , the fraction of reds in\nRo\nRo\n= Fn 1 \u2212\nQn =\nPn (k) 1 \u2212\nthe population.\nNo\nNo\nk=0\n(43)\n\u0001\n\u03b42\n\u03b4n+1 = 1 \u2212 F (1 \u2212 \u03b4n ) \u2248 \u03bb\u03b4n \u2212 n \u03c3 2 \u2212 \u03bb(1 \u2212 \u03bb)\nwhere the final population is No and the sample\n2\nsize is Ro . The red population n generations before\n\u03b4n2 \u03c3 2\nthe end is then\n\u2248 (1 + \u03b3)\u03b4n \u2212\n(47)\n2\n\u0012\n\u0012\n\u0013\u0013\nRo\nso that\nRn = No \u03bb\u2212n (1\u2212Qn ) = No \u03bb\u2212n 1 \u2212 Fn 1 \u2212\nNo\nd\u03b4\n\u03c32 \u03b42\n= \u03b3\u03b4 \u2212\n(48)\n(44)\ndn\n2\n10\n=\n\nF (F (x))\n\n\fparent, is the chance of having two surviving chilP\ndren,\nP (n) n(n\u22121)\n\u03b4 2 \u2248 \u03c3 2 \u03b4 2 /2. Thus, the de2\ncrease in the number of reds is \u03c3 2 R2 /2N so that\nthe equation for R is\n\n6\n\nRed Populaton (R(n))\n\n10\n\nRo = 2000\nRo = 40000\nRo = 800000\n\n4\n\n10\n\n\u03c3 2 R2\ndR\n=\u2212\ndn\n2N\n\n(51)\n\nwhich is equivalent to our above equation for \u03b4.\n2\n\n10\n\n4.2. Red Families\n0\n\n10\n\n0\n\n500\n\n1000\n\n1500\n\nWe now turn to examine the time development\nof the number of red families, F R (n), n steps in the\npast . As in the absence of mutation every family\nsurvives, since it is red, the only change in families\nfrom n steps in the past to n \u2212 1 steps in the past\nis the new families due to mutation. As mutations\nof singletons do not create new families, we have\n\n2000\n\nGenerations in past (n)\n\nFigure 7: The number of red individuals as a function of the\nnumber of generations in the past, R(n), for a single run,\nwith No = 4 * 106 , \u03b3 = 5 * 10\u22123 , \u03bc = 5 * 10\u22124 . The sample\nsizes are Ro = 2000, 4 * 104 , and 8 * 105 , which are subcritical,\ncritical and supercritical respectively. Also shown as solid\nlines are the predictions of Eq. (50).\n\nF R (n \u2212 1) = F R (n) + \u03bc(R(n) \u2212 nR\n1 (n)) .\n\nIn the small \u03bc limit, the number of singletons is\nsmall, proportional to \u03bc. Thus to leading order in\n\u03bc, we have\n\nwith the solution\n\u03b4n =\n\nRo\n\n\u03c32\n\n2\u03b3Ro\n+ (2\u03b3No \u2212 Ro \u03c3 2 )e\u2212\u03b3n\n\n(52)\n\n(49)\n\nF R (n \u2212 1) = F R (n) + \u03bcR(n)\n\n(53)\n\nso that\nRc\nR(n) =\nRo\n\u03b3n\nRo e + (Rc \u2212 Ro )\n\nor, in its differential equation form,\n(50)\n\ndF R\n= \u2212\u03bcR\ndn\n\nThe change in behavior as Ro crosses Rc is apparent. In particular, at critical sampling, R(n) is\na pure exponential in time. We also see that Rn\ndepends on the underlying distribution of children\nonly through its average, i.e. \u03b3, and its variance.\nIn Fig. 7, we show data for the R(n) from a single\nsimulation, for three different sampling strengths,\ntogether with our analytic formula, Eq. (50). The\ndata exhibit the striking change in behavior from\na fast initial decrease in red individuals for strong\nsampling, a pure exponential for critical sampling\nand a slow initial decrease for weak sampling. All\nthree curves merge in the past, at the coalescence\ntime for the entire population.\nAn alternate, equivalent way to arrive at our\nresult is to consider the coalescence of branches\non the red tree. If we look at the Rn reds in\nthe nth previous generation, these are generated\nby slightly less than Rn parents, due to coalescence. The chances of coalescence, per potential\n\n(54)\n\nUsing our solution, Eq. (50), for R(n), we obtain\nF R (n) =\n\n\u0012\n\u0012\n\u0013\n\u0013\n\u03bdRc Ro\nRc\nln 1 +\n\u2212 1 e\u2212\u03b3n (55)\nRc \u2212 Ro\nRo\n\nwhere we have demanded that F R \u2192 0 as n \u2192 \u221e.\nIn particular, at the sampling time,\nF R (0) =\n\n\u03bdRc Ro\nRc\nln\nRc \u2212 Ro Ro\n\n(56)\n\nwhich of course agrees with the small \u03bc limit result Eq. (36) we derived using the Fokker-Planck\napproach.\nIn Figure 8, we show data for the number of red\nfamilies going backward in time, again for subcritical, critical and supercritical sampling. The small \u03bd\nresult, Eq. (55), is also shown. The small deviation\nis due to higher order corrections in \u03bd.\n11\n\n\f4\n\nRo = 2000\nRo = 40000\nRo = 800000\n\n3\n\n10\n\nR\n\nRed Singletons ( n1 )\n\nR\n\nRed Families (F (n))\n\n10\n\n2\n\n10\n\n1\n\n10\n\n0\n\n10\n\n0\n\n500\n\n1000\n\n100\n\n10\n\n1\n\n1500\n\nGenerations in past (n)\n\nRo = 2000\nRo = 40000\nRo = 800000\n\n1000\n\n0\n\n500\n\n1000\n\n1500\n\nGenerations in past (n)\n\nFigure 8: The number of red families as a function of the\nnumber of generations in the past, F R (n), for a single run,\nwith No = 4 * 106 , \u03b3 = 5 * 10\u22123 , \u03bc = 5 * 10\u22124 . The sample\nsizes are Ro = 2000, 4 * 104 , and 8 * 105 , which are subcritical,\ncritical and supercritical respectively. Also shown as solid\nlines are the small \u03bd approximations from Eq. (55).\n\nFigure 9: The number of red singletons as a function of the\nnumber of generations in the past, nR\n1 (n), for a single run,\nwith No = 4 * 106 , \u03b3 = 5 * 10\u22123 , \u03bc = 5 * 10\u22124 . The sample\nsizes are Ro = 2000, 4 * 104 , and 8 * 105 , which are subcritical,\ncritical and supercritical respectively. Also shown as solid\nlines are the small \u03bd approximations from Eq. (58).\n\n4.3. Red Singletons\nWe now examine the time development of the\nnumber of red singletons. The number of singletons decreases due to the fact that some singletons\ngive birth to multiple children, who are no longer\nsingletons. It increases due to the fact that mutations of non-singletons give rise to new singletons. The latter factor is very simple: \u03bc(R \u2212 nR\n1 ),\njust as with red families. As discussed above, the\ndecreases in number of reds due to coalescence is\n\u03c3 2 R(n)2 /2N (n). Of these a fraction nR\n1 /R are singletons, so the loss of singletons due to coalescence\nof singletons is \u03c3 2 RnR\n1 /2N . Thus the differential\nequation for nR\nis\n1\n\nIn particular, at the sampling time the number of\nred singletons is given by\n\u0015\n\u0014\n\u03bdRc Ro\nRc\nR\nn1 (0) =\n\u2212 (Rc \u2212 Ro )\nRc ln\n(Rc \u2212 Ro )2\nRo\n(59)\nThis again can be seen to reproduce our FokkerPlanck result, Eq. (32). It is interesting to note\nthat at critical sampling nR\n1 approaches \u03bdRc /2,\nwhereas F R approaches \u03bdRc , so that half the families are singletons in this case. The simulation data\nfor nR\n1 (n) is presented in Fig. 9, together with the\nsmall \u03bd prediction, Eq. (58). The picture is qualitatively similar to that of the red families.\n\ndnR\n\u03c3 2 RnR\n1\n1\n=\n\u2212 \u03bc(R \u2212 nR\n1)\ndn\n2No e\u2212\u03b3n\n\n5. The U.S. Census Data\n\n(57)\n\nWe now attempt to apply the theory to the surname distribution taken from the 2000 U.S. Census1 . We must make clear at the outset that degree\nof overlap between the assumptions underlying our\ntheoretical treatment and the real dynamics of the\n\nAgain we can drop the \u03bcnR\n1 term as being higher\norder in \u03bc. Then the solution that vanishes as n \u2192\n\u221e is\n\"\n\u03bdRc Ro\nR\n\u2212 (Rc \u2212 Ro ) +\nn1 (t) =\n(Rc \u2212 Ro )2\n\u0010\n\u0011\nRo e\u03b3n + (Rc \u2212 Ro ) \u00d7\n\u0012\n\u0012\n\u0013\n\u0013#\nRc\n\u2212\u03b3n\nln 1 +\n\u22121 e\nRo\n\n1 Available at http://www.census.gov/genealogy/www/freqnames2k.html.\nThis\ndata\nonly\nextends\nto\nsurnames\nwith\nmore than 100 representatives.\nData for rarer\nsurnames\nis\navailable\nin\nbinned\nform\nfrom\nhttp://www.census.gov/genealogy/www/surnames.pdf.\nThe binned data was then debinned using a smoothing\nprocedure\n\n(58)\n12\n\n\fNumber of Families\n\nU.S. Population (millions)\n\n6\n\n10\n\n2\n\n1/m\nCensus Data\n\u22124\n\u22124\n\u03b3 = 5 10 , \u03bc = 10\n\n3\n\n10\n\n0\n\n10\n\n-3\n\n10\n\n0\n\n10\n\n10\n\n1\n\n10\n\n2\n\n3\n\n10\n\n10\n\n4\n\n+ 250)\n\n10\n\n1\n-300\n\n5\n\n10\n\nData\n0.0255 (t\n2e\n\n100\n\n-250\n\n-200\n\n-150\n\n-100\n\n-50\n\n0\n\nYears, relative to 2000\n\nFamily Size\nFigure 10: The surname distribution taken from the 2000\nU.S. census. Also show is a curve outlining a 1/m2 power-law\ndecay, and the theoretical curve, Eq. (7) for No = 2.8 * 108 ,\n\u03b3 = 5 * 10\u22124 , and \u03bc = 10\u22124 .\n\nFigure 11: The population of the U.S. as a function of time,\ntogether with an exponential fit to the period prior to 1920\n\nlarge impact of immigration in driving the population growth before WWI is clear evidence of this.\nOne might then want to claim that the U.S. population should be considered as a (biased) sample of\nthe European (or perhaps, world) population. The\ngrowth rate of the European and world population\nbefore 1920 is roughly a factor of 5 smaller than\nthe U.S. growth rate. However, this improvement is\nmore than counterbalanced by the sampling effect,\nwhich is to move the distribution leftward by the\nsampling factor, thereby moving the onset of the\nasymptotic 1/m2 scaling to even smaller m. Thus,\nthe solution cannot lie in this direction.\nIn fact, no clear answer presents itself at this\npoint, and we must leave this puzzle as a challenge\nfor the future. One possibility might be that the\n\"mutation\" of family names, at least for the U.S.,\nis likely very different from that assumed by the\nmodel. There was a great tendency in the period\nof the great immigration for family name changes\nnot to create new surnames, as we assume, but in\nfact the opposite. The immigration officials were\n(in)famous for mapping the wide spectrum of surnames they encountered onto recognizable \"American\" names. Further work will be needed to see\nwhat effect this might have had on the surname\ndistribution.\nIn summary, then, we have calculated the family size distribution for a growing population. We\nhave shown that the distribution is universal for\nslow growth rate. In addition, we have calculated\nthe distribution for arbitrarily sized subsamples of\n\nsurname distribution may rightfully be questioned.\nNevertheless, we will proceed and see how far we\ncan go.\nThe surname data is presented in Fig. 10. We see\nthat its overall shape is similar to that of the theory. In particular, the graph exhibits a 1/m2 falloff\nfor large family sizes, in accord with our expectation. However, upon closer examination, the data\npresents us with a severe problem. The asymptotic\npower law only sets in for family sizes above 104 or\nso. According to the theory, the onset of the power\nlaw should occur roughly at m \u223c 10/(2\u03b3). Thus,\nthe data would point to a value of \u03b3 of roughly\n5 * 10\u22124 . However, this is off from the true growth\nrate of the population by a factor of 1000!\nThe growth rate of the U.S. population has not\nbeen constant in time. However, it was quite constant up until the severe immigration restrictions\nwere applied in the wake of World War I, as can be\nseen from Fig. 11, with a value of 0.0255/year. Assuming a generational time of 20 years, this works\nout to give a value of \u03b3 = 0.51. Even taking the\npost-WWI growth rate, the growth rate is only reduced to \u03b3 = 0.3, so we still have a factor of 500\nto account for. Even if we compare the data to the\ntheoretical curve with \u03b3 = 5 * 10\u22124 , so as to reproduce the break from the power-law at m = 104 ,\nthe agreement only extends down to family sizes of\nm = 500.\nOne might think that the problem is that the\nU.S. is not a demographically closed system. The\n13\n\n\fthe population. We found a distinction between\nstrong sampling, where the shoulder at small family sizes, while truncated still exists, and weak sampling, where the small family distribution lies above\nthe power-law. The critical sampling dividing these\ntwo regimes is Rc = 2\u03b3No /\u03c3 2 (1 + \u03bd). In the strong\nsampling regime, the distribution is rigidly translated (in log space) through a rescaling of m. For\nweak sampling, the distribution is independent of\nsampling, up to overall normalization. We have also\nseen that the distinction between weak and strong\nsampling holds for the properties of the genealogical\ntree constructed from the sampled individuals.\nThis work was supported by the EU 6th framework CO3 pathfinder. Y.M. acknowledge the financial support of the Israeli Center for Complexity\nScience.\nA. Derivation of the Power-Law\nFor large m, the major contribution of the sum\nover p is from the vicinity of p\u2217 \u2261 m/(1 \u2212 \u03bc) and\nfor the sum over ` from the vicinity of `\u2217 \u2261 p\u2217 /\u03bb =\nm\u2217 /((1 \u2212 \u03bc)\u03bb). Thus, we can, invoking the central\nlimit theorem, approximate the distribution P (` \u2192\np) by\n(p\u2212\u03bb`)2\n1\n(60)\ne\u2212 2\u03c32\nP (` \u2192 p) \u2248 \u221a\n2\u03c0\u03c3 2 `\nSimilarly, we can approximate the binomial distribution for the number of mutations by\n\u0012 \u0013\n(m\u2212p(1\u2212\u03bc))2\np\n1\n(1 \u2212 \u03bc)m \u03bcp\u2212m \u2248 p\ne\u2212 2\u03bc(1\u2212\u03bc)p\nm\n2\u03c0\u03bc(1 \u2212 \u03bc)p\n(61)\nReplacing the sums over ` and p by integrals and\nexpanding the exponent to second order yields\nZZ\n1\np\nnt+1\n\u2248\nd` dp nt`\n\u00d7\nm\n2\u03c0\u03c3 `p\u03bc(1 \u2212 \u03bc)\n\u0012\n\u0013\n(p \u2212 \u03bb`)2\n(m \u2212 p(1 \u2212 \u03bc))2\nexp \u2212\n\u2212\n2\u03c3 2 `\n2\u03bc(1 \u2212 \u03bc)p\np\nZZ\n\u03bb(1 \u2212 \u03bc) t\n\u2248\nd` dp eF (`,p) (62)\n\u221a n\n2\u03c0\u03c3m \u03bc `\u2217\nwhere\nF(`, p)\n\n\u03bb3 (1 \u2212 \u03bc)(` \u2212 m\u2217 )2\n2\u03c3 2 m\n(1 \u2212 \u03bc)(\u03bb\u03bc + \u03c3 2 (1 \u2212 \u03bc))(p \u2212 p\u2217 )2\n\u2212\n2\u03bcm\n\u03bb2 (1 \u2212 \u03bc)(` \u2212 `\u2217 )(p \u2212 p\u2217 )\n\u2212\n(63)\n\u03c32 m\n14\n\n= \u2212\n\nSubstituting ntm = Am\u2212\u03b2 \u03bbt and doing the Gaussian integrals gives\n\u0012\n\u0013\u2212\u03b2\nm\n1\n(64)\n\u03bbm\u2212\u03b2 =\n\u03bb(1 \u2212 \u03bc) \u03bb(1 \u2212 \u03bc)\nEquivalently, we could simply replace the Gaussians\nby the \u03b4-functions \u03b4(p \u2212 m`)\u03b4(m \u2212 (1 \u2212 \u03bc)p) and\nintegrate over ` and p successively. Taking the logarithm gives us our equation for \u03b2, Eq. (16).\nB. The Fokker-Planck Equation\nWe start with Eq. (15a), and write P (` \u2192 p) in\nterms of the generating function, F :\nI\ndz `\nF (z)\n(65)\nP (` \u2192 p) =\nz p+1\ngiving\nnt+1\nm =\n\nXI\n\ndz\nz\n\n`\u22650\np\u2265m\n\nF ` (z)nt`\np+1\n\n\u0012 \u0013\np\n\u03bcp\u2212m (1 \u2212 \u03bc)m\nm\n\n(66)\nWe next expand nt` in a Taylor series around ntm :\n\u2202n\n1 \u22022n\n(` \u2212 m) +\n(` \u2212 m)2 + . . . (67)\n\u2202m\n2 \u2202m2\nWe can now do the geometric sums over ` and the\nsum over p using\nX \u0012p\u0013\nxm\nxp =\n(68)\nm\n(1 \u2212 x)m+1\nnt` = ntm +\n\np\u2265m\n\nto get\nnt+1\nm\n\nI\n=\n\n\"\ndz (1 \u2212 \u03bc)m n \u2212 n0 m + n00 m2 /2\n2\u03c0i (z \u2212 \u03bc)m+1\n1 \u2212 F (z)\n\n(n0 \u2212 mn00 )F (z) (n00 /2)F (z)(1 + F (z))\n+\n+\n(1 \u2212 F (z))2\n(1 \u2212 F (z))3\n=\n\n#\n\nn \u2212 n0 m + n00 m2 /2\n\u03bb(1 \u2212 \u03bc)\n\u0002\n\u0003\n0\n(n \u2212 mn00 ) (\u03bb2 \u2212 f2 )(1 \u2212 \u03bc) + (m + 1)\u03bb\n+\n\u03bb3 (1 \u2212 \u03bc)2\n\"\nn00 /2\n+ 5\n\u2212 6\u03bb(1 \u2212 \u03bc)2 f3\n\u03bb (1 \u2212 \u03bc)3\n+ 12(1 \u2212 \u03bc)2 f22 \u2212 6\u03bb(1 \u2212 \u03bc)2 \u03bbf2\n+ 6\u03bb(1 \u2212 \u03bc)(m + 1)f2 + \u03bb4 (1 \u2212 \u03bc)2\n#\n3\n\n\u2212 3\u03bb (1 \u2212 \u03bc)(m + 1) + (m + 2)(m + 1)\u03bb\n\n2\n\n(69)\n\n\fwhere we have set the contour between the pole at\nz = \u03bc and that at z = 1 and picked up the residue\nat the outer pole at z = 1, and the expansion of\nF (z) near z = 1 is\n\nReferences\n\nF (z) \u2248 1+\u03bb(z\u22121)+f2 (z\u22121)2 +f3 (z\u22121)3 +. . . (70)\nIt is possible to translate this difference equation to\na differential equation only in the limit \u03b3 \u223c \u03bc \u001c\n1. Then, expanding the coefficients of the various\nderivatives of n to leading order, things simplify to\n\u1e45(m) = \u2212(\u03b3 \u2212 \u03bc)n + [\u2212(\u03b3 \u2212 \u03bc)m + 2f2 ] n0 + f2 mn00\n(71)\nUsing that, to leading order in \u03b3, f2 = \u03c3 2 /2, gives\nus Eq. (18).\n\nC. The Number of Red Families\nThe number of red families is, from Eq. (34a)\nZ \u221e\n\u0010\n\u0011\nFR =\ndx 1 \u2212 e\u2212pRo /No \u00d7\n0\n\u0012\n\u0013\n2\u03b3\nA\nU 1 + \u03bd, 0, 2\nx (72)\nx\n\u03c3 (1 + \u03bd)\nWe cannot break up the term in the parenthesis\nas is, since both integrals would then diverge. We\ntherefore regularize the problem:\nZ \u221e\n\u0001\nR\nF\n= A lim\n1 \u2212 e\u2212s x\u000f\u22121 U (1 + \u03bd, 0, x) dx\n\u000f\u21920\n\n0\n\n\u0393(\u000f)\u0393(\u000f + 1)\n= A lim\n\u00d7\n\u000f\u21920 \u0393 (2 + \u03bd + \u000f)\nh\n2 F1 (\u000f, \u000f + 1; 2 + \u03bd + \u000f; 1)\n\u22122 F1 (\u000f, \u000f + 1; 2 + \u03bd + \u000f + 1; 1 \u2212 s)\n\n[1] Abromowitz, M., Stegun, I. (Eds.), 1972. Handbook of\nMathematical Functions. Government Printing Office,\nWashington.\n[2] Bell, G., 2001. Neutral macroecology. Science 293,\n2413\u20132418.\n[3] Condit, R., Pitiman, N., Leigh, E. G., Chave, J., Terborgh, J., Foster, R. B., et al., 2002. Beta-diversity in\ntropical forest trees. Science 293, 666\u2013669.\n[4] Galton, F., Watson, H. W., 1874. On the probability\nof the extinction of families. J. Roy. Antropol. Inst. 4,\n138\u2013144.\n[5] Hubbell, S. P., 1979. Tree dispersion, abundance and\ndiversity in a tree dispersion, abundance and diversity\nin a tropical dry forest. Science 203, 1299\u20131309.\n[6] Hubbell, S. P., 2001. The unified neutral theory of\nbiodiversity and biogeography. Princeton Univ. Press,\nPrinceton, N. J., USA.\n[7] Jeffrey, A., Zwillinger, D. (Eds.), 2007. Table of Integrals, Series and Products, seventh edition Edition.\nAcademic Press, San Diego.\n[8] Lotka, A. J., 1931. Population analysis - on the extinction of families, i. J. Wash. Academy of Sciences 21,\n377\u2013380.\n[9] Lotka, A. J., 1931. Population analysis - on the extinction of families, ii. J. Wash. Academy of Sciences 21,\n453\u2013459.\n[10] Manrubia, S., Zanette, D. H., 2002. At the boundary\nbetween biological and cultural evolution: The origin\nof surname distributions. J. Theor. Biology 216, 461\u2013\n477.\n[11] Manrubia, S. C., Derrida, B., Zanette, D. H., 2003.\nGenealogy in the era of genomics. American Scientist\n91, 158.\n[12] McGill, B. J., 2003. A test of the unified neutral theory\nof biodiversity. Nature 422, 881\u2013881.\n[13] Steffensen, J. F., 1930. Om sandsynlighenden for at\nafkommet uddr. Mat. Tidsskr. B 1, 1923.\n[14] Steffensen, J. F., 1933. Deux problemes du calcul des\nprobabilites. Annales de l'institut Henri Poincar\u00e9 3,\n319\u2013344.\n\n'\n\ni\n\n\u221e\nX\n\u0393(\u000f + n)\u0393(\u000f + n + 1)\n[1 \u2212 (1 \u2212 s)n ]\n\u000f\u21920\nn!\u0393\n(2\n+\n\u03bd\n+\n\u000f\n+\nn)\nn=1\n\n= A lim\n\n=\n\n=\n\n\u221e\nX\n\n\u0003\n\u0393(n + 1)\u0393(n + 2) \u0002\n1 \u2212 (1 \u2212 s)n+1\n(n + 1)!\u0393 (3 + \u03bd + n)\nn=0\nh\nA\n2 F1 (1, 1; 3 + \u03bd; 1)\n\u0393 (3 + \u03bd)\ni\n\u2212 (1 \u2212 s)2 F1 (1, 1; 3 + \u03bd; 1)\nn0 \u03bd h\n2 F1 (1, 1; 3 + \u03bd; 1)\n(2 + \u03bd)s\ni\n\u2212 (1 \u2212 s) 2 F1 (1, 1; 3 + \u03bd; 1 \u2212 s)\n(73)\n\n= A\n\n15\n\n\f"}