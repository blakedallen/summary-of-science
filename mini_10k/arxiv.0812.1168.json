{"id": "http://arxiv.org/abs/0812.1168v2", "guidislink": true, "updated": "2010-01-04T14:50:28Z", "updated_parsed": [2010, 1, 4, 14, 50, 28, 0, 4, 0], "published": "2008-12-05T15:58:17Z", "published_parsed": [2008, 12, 5, 15, 58, 17, 4, 340, 0], "title": "Langevin equation with colored noise for constant-temperature molecular\n  dynamics simulations", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0812.1515%2C0812.2133%2C0812.2109%2C0812.4359%2C0812.3146%2C0812.4244%2C0812.3953%2C0812.0771%2C0812.3540%2C0812.0273%2C0812.3002%2C0812.1528%2C0812.4409%2C0812.3323%2C0812.2980%2C0812.1339%2C0812.4456%2C0812.3088%2C0812.3904%2C0812.2876%2C0812.4101%2C0812.1491%2C0812.3873%2C0812.0212%2C0812.4338%2C0812.3533%2C0812.3578%2C0812.2066%2C0812.0435%2C0812.1854%2C0812.3217%2C0812.1429%2C0812.3843%2C0812.1253%2C0812.2830%2C0812.1925%2C0812.2006%2C0812.3661%2C0812.4316%2C0812.1234%2C0812.4650%2C0812.2368%2C0812.1295%2C0812.0046%2C0812.4748%2C0812.0501%2C0812.1315%2C0812.3789%2C0812.2083%2C0812.1151%2C0812.1168%2C0812.4525%2C0812.2209%2C0812.4398%2C0812.1830%2C0812.1737%2C0812.2472%2C0812.0569%2C0812.1110%2C0812.4139%2C0812.0129%2C0812.1736%2C0812.0545%2C0812.2169%2C0812.0856%2C0812.2067%2C0812.1676%2C0812.4886%2C0812.4865%2C0812.2958%2C0812.2496%2C0812.0517%2C0812.4097%2C0812.1092%2C0812.2933%2C0812.2062%2C0812.1081%2C0812.3966%2C0812.2535%2C0812.0214%2C0812.0342%2C0812.4180%2C0812.0013%2C0812.1650%2C0812.3455%2C0812.1366%2C0812.2986%2C0812.0991%2C0812.0654%2C0812.3776%2C0812.4829%2C0812.0347%2C0812.1531%2C0812.4659%2C0812.2953%2C0812.0362%2C0812.4787%2C0812.3352%2C0812.1402%2C0812.4327%2C0812.2489&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Langevin equation with colored noise for constant-temperature molecular\n  dynamics simulations"}, "summary": "We discuss the use of a Langevin equation with a colored (correlated) noise\nto perform constant-temperature molecular dynamics simulations. Since the\nequations of motion are linear in nature, it is easy to predict the response of\na Hamiltonian system to such a thermostat and to tune at will the relaxation\ntime of modes of different frequency. This allows one to optimize the time\nneeded to thermalize the system and generate independent configurations. We\nshow how this frequency-dependent response can be exploited to control the\ntemperature of Car-Parrinello-like dynamics, keeping at low temperature the\nelectronic degrees of freedom, without affecting the adiabatic separation from\nthe vibrations of the ions.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0812.1515%2C0812.2133%2C0812.2109%2C0812.4359%2C0812.3146%2C0812.4244%2C0812.3953%2C0812.0771%2C0812.3540%2C0812.0273%2C0812.3002%2C0812.1528%2C0812.4409%2C0812.3323%2C0812.2980%2C0812.1339%2C0812.4456%2C0812.3088%2C0812.3904%2C0812.2876%2C0812.4101%2C0812.1491%2C0812.3873%2C0812.0212%2C0812.4338%2C0812.3533%2C0812.3578%2C0812.2066%2C0812.0435%2C0812.1854%2C0812.3217%2C0812.1429%2C0812.3843%2C0812.1253%2C0812.2830%2C0812.1925%2C0812.2006%2C0812.3661%2C0812.4316%2C0812.1234%2C0812.4650%2C0812.2368%2C0812.1295%2C0812.0046%2C0812.4748%2C0812.0501%2C0812.1315%2C0812.3789%2C0812.2083%2C0812.1151%2C0812.1168%2C0812.4525%2C0812.2209%2C0812.4398%2C0812.1830%2C0812.1737%2C0812.2472%2C0812.0569%2C0812.1110%2C0812.4139%2C0812.0129%2C0812.1736%2C0812.0545%2C0812.2169%2C0812.0856%2C0812.2067%2C0812.1676%2C0812.4886%2C0812.4865%2C0812.2958%2C0812.2496%2C0812.0517%2C0812.4097%2C0812.1092%2C0812.2933%2C0812.2062%2C0812.1081%2C0812.3966%2C0812.2535%2C0812.0214%2C0812.0342%2C0812.4180%2C0812.0013%2C0812.1650%2C0812.3455%2C0812.1366%2C0812.2986%2C0812.0991%2C0812.0654%2C0812.3776%2C0812.4829%2C0812.0347%2C0812.1531%2C0812.4659%2C0812.2953%2C0812.0362%2C0812.4787%2C0812.3352%2C0812.1402%2C0812.4327%2C0812.2489&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We discuss the use of a Langevin equation with a colored (correlated) noise\nto perform constant-temperature molecular dynamics simulations. Since the\nequations of motion are linear in nature, it is easy to predict the response of\na Hamiltonian system to such a thermostat and to tune at will the relaxation\ntime of modes of different frequency. This allows one to optimize the time\nneeded to thermalize the system and generate independent configurations. We\nshow how this frequency-dependent response can be exploited to control the\ntemperature of Car-Parrinello-like dynamics, keeping at low temperature the\nelectronic degrees of freedom, without affecting the adiabatic separation from\nthe vibrations of the ions."}, "authors": ["Michele Ceriotti", "Giovanni Bussi", "Michele Parrinello"], "author_detail": {"name": "Michele Parrinello"}, "author": "Michele Parrinello", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1103/PhysRevLett.102.020601", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0812.1168v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0812.1168v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.chem-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.comp-ph", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0812.1168v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0812.1168v2", "arxiv_comment": null, "journal_reference": "M. Ceriotti, G. Bussi and M. Parrinello, Phys. Rev. Lett. 102,\n  020601 (2009)", "doi": "10.1103/PhysRevLett.102.020601", "fulltext": "Langevin equation with colored noise for\nconstant-temperature molecular dynamics simulations\nMichele Ceriotti, Giovanni Bussi,\u2217 and Michele Parrinello\n\narXiv:0812.1168v2 [cond-mat.stat-mech] 4 Jan 2010\n\nComputational Science, Department of Chemistry and Applied Biosciences,\nETH Z\u00fcrich, USI Campus, Via Giuseppe Buffi 13, CH-6900 Lugano, Switzerland\n(Dated: October 22, 2018)\nWe discuss the use of a Langevin equation with a colored (correlated) noise to perform constanttemperature molecular dynamics simulations. Since the equations of motion are linear in nature, it\nis easy to predict the response of a Hamiltonian system to such a thermostat and to tune at will the\nrelaxation time of modes of different frequency. This allows one to optimize the time needed to thermalize the system and generate independent configurations. We show how this frequency-dependent\nresponse can be exploited to control the temperature of Car-Parrinello-like dynamics, keeping at\nlow temperature the electronic degrees of freedom, without affecting the adiabatic separation from\nthe vibrations of the ions.\nPACS numbers: 02.70.Ns,02.50.Ey,05.40.Ca,71.15.Pd\n\nSolving Hamilton's equations leads to sampling of the\nmicrocanonical constant-energy distribution, but in reallife experiments it is the temperature that is kept constant. Reproducing this condition in computer simulations is of great importance for the investigation of a\nlarge class of physical, chemical and biological problems.\nSeveral approaches have been proposed to modify Hamilton's equations in order to perform constant-temperature\ndynamics (see e.g. Refs. [1\u20134]). Many of these [1, 4] rely\non stochastic methods, which are a natural choice for\nmodeling the interactions with an external heat bath,\nand which display excellent ergodic behavior due to their\nrandom nature. A good thermostat should be able to\nrapidly enforce the correct probability distribution, and\ngenerate uncorrelated configurations, which are necessary\nto compute ensemble averages. The efficiency of the thermostat is particularly important in ab initio simulations,\nbecause of their high computational cost. The stochastic\nthermostats used so far are based on Markovian equations\nof motion, and imply no memory of the past trajectory\nof the system.\nMarkovian random processes are, however, only a subset of all possible stochastic processes. Furthermore, the\nMori-Zwanzig theory ensures that whenever some degree\nof freedom is integrated out, the dynamics of the remaining degrees of freedom are described by a non-Markovian\nLangevin equation, with a finite-range memory function [5\u20137]. Hence, in the quest for a better thermostat,\nand considering the thermostat as arising from a set of\nbath variables whose effect is integrated out, it is natural\nto explore the effect of using a non-Markovian Langevin\nequation to perform constant-temperature molecular dynamics. In this Letter we will show that, by using colored\nnoise, it is possible to influence in a different manner\nthe different vibrational modes of the system. Therefore the thermostat can be adjusted to the system under\nstudy, and its performance optimized in a precise and\npredictable fashion. This is, to our knowledge, the first\n\ntime that a colored Langevin equation has been employed\nin atomistic simulations.\nAn area which would greatly benefit from an improved,\ntunable thermostat is that of Car-Parrinello (CP)-like,\nextended Lagrangian schemes [8]. The idea behind this\napproach is very general, as it applies to any system\nwhere the forces are the result of an expensive optimization procedure. This process is circumvented by extending the dynamical degrees of freedom (DOF), so as to\ninclude the parameters to be optimized, and introducing\nan artificial dynamics which allows these extra variables\nto be maintained close to the ground state, by adiabatic\ndecoupling from the other degrees of freedom. In the prototypical example of CP molecular dynamics (CPMD) a\nfictitious mass is assigned to the electronic DOF so that\nthey can be evolved at the same time as the ionic DOF.\nIf the fictitious mass is small enough, the dynamics of the\nelectrons are adiabatically separated from the dynamics\nof the ions. Hence, the electrons are kept close to the\nground state, while the nuclei are evolved at the correct\ntemperature. This same technique can be used in classical simulations that use polarizable force fields, where\nthe electronic DOF describe the charge polarization of\nthe system [9, 10]. Similar approaches have also been suggested in the field of rare-events sampling, to separate the\noscillations of the microscopic degrees of freedom from\nthose of a few selected slow reaction coordinates [11].\nControlling the temperature in these CP-like techniques requires that one acts separately on the ionic degrees of freedom, which must sample the correct canonical ensemble, and on the variational parameters, which\nmust always remain at low temperature to minimize\nthe error in the forces [12]. Traditional stochastic thermostats allow for a highly ergodic sampling of all the degrees of freedom, irrespectively of their frequency. This is\nbeneficial for the ionic DOFs but causes the breakdown\nof adiabatic separation. For this reason, deterministic\nthermostats of the Nos\u00e9-Hoover (NH) type [2] have been\n\n\f2\n100\n\nq\u0307i (t) = pi (t)/mi\n\u1e57i (t) = fi [q(t)] \u2212\n\nZ\n\n0\n\nt\n\ndt\u2032 K(t \u2212 t\u2032 )pi (t\u2032 ) + \u03b6i (t)\n\n(1)\n\nwhere fi = \u2212\u2202U/\u2202qi are the forces, K(t) is the memory kernel and \u03b6(t) is a vector of independent Gaussian noises. In order to set the temperature to a chosen value T , the noise term \u03b6(t) needs to be related to\nthe memory kernel by the fluctuation-dissipation theorem\nh\u03b6i (t)\u03b6j (t\u2032 )i = \u03b4ij mi T K(t \u2212 t\u2032 ).\nThe non-Markovian Eqs. (1) might seem at first too\ncomplex to be used in practical applications. However,\nforPa rather general form of the memory kernel, K (t) =\nR k ck e\u2212t(\u03b3k +i\u03c9k ) with \u03b3k > 0, it is possible to rewrite\nEq. (1) in an equivalent Markovian form by introducing\na set of auxiliary momenta [13, 14]:\nq\u0307i (t) =s0i (t)/m\nT\n\n\u1e61i (t) = (fi [q(t)], 0, . . . , 0) \u2212 Asi (t) + B\u03b7 i (t).\n\n(2)\n\nT\n\nHere si = (pi , si1 , . . . , siN ) is a N + 1 dimensional vector, whose first component is the canonical momentum pi\nassociated to the i-th DOF, and \u03b7 i is a vector of Gaussian\nwhite noises, with h\u03b7ik (t)\u03b7jk\u2032 (t\u2032 )i = \u03b4ij \u03b4(t \u2212 t\u2032 )\u03b4kk\u2032 . The\nreal-valued matrices A and B determine the dynamics\nof pi , and can be related to K (t) by extending the arguments of Ref. [13], as will be discussed elsewhere.\nIn order to illustrate some of the effects of using a colored noise, we study the simple case in which\nr\n\u0013\n\u0012\n\u0012\n\u0013\n\u221a\n2T mi 0 0\n1\n0\n\u2212 \u03b3\u03c4F\n\u221a\n,B=\nA=\n. (3)\n\u03b3\u03c4F\n1\n0 1\n\u03c4F\n\u03c4F\nThis choice leads to the stationary distribution\n\u0012\n\u0013\u0015\n\u0014\ns21\n1 p2\n+\n+ U (q) ,\nP\u0304 (q, p, s1 ) \u221d exp \u2212\nT 2m 2m\ncorresponding to the desired canonical ensemble for q and\np. The memory kernel and its power spectrum are\n1\n\u03b3\n\u03b3 \u2212|t|/\u03c4F\nand S(\u03c9) =\ne\n(4)\nK(t) =\n\u03c4F\n\u03c0 1 + \u03c4F2 \u03c9 2\n\n500 1000 2000\n\n5000 1  \u0301 10\n1.0\n\n0.01\n\n0.6\n100\n\n0.4\n\n4\n\n10\n\nshell\n\nDoS Harb. unitsL\n\n0.8\n1\n\u03a4H HpsL\n\nadopted. However the original NH thermostat has wellknown ergodicity problems, and the extension to Nos\u00e9Hoover chains is normally used [3]. This comes though\nat the price of introducing a large number of parameters, whose effect on the ions dynamics is not easy to\npredict and control. In the following we show that by using correlated noise it is possible to tune the coupling of\na stochastic thermostat with the various degrees of freedom. This allows one not only to use Langevin dynamics\nin CP-like methods, but also significantly improves the\nsampling of the target ensemble, because the thermostat\nis tailored to the system under study, in a predictable\nand controlled fashion.\nWe consider here a system described by coordinates qi ,\nmomenta pi and masses mi , interacting via a potential\nU (q), where q is the set of qi 's. The colored Langevin\nequations [5, 6] read\n\n200\n\n0.2\n\nmodes\n\n0.0\n100\n\n200\n\n500 1000 2000\n\n5000 1  \u0301 104\n\n\u03a9 Hcm-1 L\nFIG. 1: (color online) The autocorrelation time of the total\nenergy for harmonic oscillators of frequency \u03c9 [Cf. Equation (5)] is plotted for different values of the thermostat parameters. Dark curves correspond to high friction (\u03b3 \u22121 = 20\nfs) whereas light ones correspond to a more gentle thermostat (\u03b3 \u22121 = 1 ps). Dotted lines correspond to white noise\n(\u03c4F = 0) and full ones to colored noise with \u03c4F = 2 fs. The\ncurves are superimposed on the vibrational density of states\n(DoS) for a polarizable force-field simulation of crystalline calcite, which was obtained from the Fourier transform of the\nvelocity-velocity autocorrelation function. For reference, we\nreport the shell vibrational modes as obtained from a run\nwhere we artificially heated the shells to 300 K.\n\nrespectively. Thus the friction \u03b3 determines the intensity\nof the kernel and \u03c4F the autocorrelation time of the noise.\nFor the purpose of this work, one can consider S (\u03c9) to\nbe a low-pass filter for the noise, which has the cutoff\nfrequency \u03c4F\u22121 . Clearly, when \u03c4F \u2192 0 the white-noise\nlimit is recovered.\nWe consider the dynamics of a set of harmonic oscillators. In this case Eqs. (2) are fully linear, and the autocorrelation time for the total energy of an eigenmode of\nfrequency \u03c9 can be explicitly evaluated [6, 15]:\n\u03c4H (\u03c9) =\n\n\u03b3\n1 \u03c9 2 \u03c4F2\n+\n+\n.\n4\u03c9 2\n\u03b3\n\u03b3\n\n(5)\n\nWe take \u03c4H (\u03c9) as a measure of the time needed for the\nthermalization of each individual normal mode. For a\nwhite noise (\u03c4F = 0), \u03c4H decreases with \u03c9 until it reaches\na plateau at \u03c4H = 1/\u03b3, while for \u03c4Fp6= 0, the autocorrelation time has a minimum at \u03c9 = \u03b3/(2\u03c4F ) and grows\nquadratically thereafter. By properly adjusting \u03c4F , one\ncan select which modes are going to be maximally coupled with the thermostat, and thus reduce the coupling\nof the thermostat to the fastest modes (see also Fig. 1).\nWe next consider the application of the colored-noise\nthermostat, with the parameters of Eq. (3), to classical\nMD simulation using a polarizable force field. Here the\nelectronic DOF are represented by charged shells, bound\nwith harmonic potentials to the corresponding atomic\ncores. We couple a colored-noise thermostat to the ions,\nat the target temperature, and choose the filtering time\n\u03c4F in such a way that the impact on the electronic DOF is\nminimal. At the same time, we apply a zero temperature\n\n\f3\n\nTS HKL\n\nHaL\n\nHbL\n\n1\n\n0.1\n-3\n\n10\n\n-2\n\n-3\n\n-2\n\n-1\n\n0\n\n10\n10\n10\n10\n10\n\u0393S-1 HpsL\n\u03a4F HpsL\nFIG. 2: (color online) Shell temperature (TS ) for calcite as\na function of the thermostat parameters. Simulations have\nbeen performed for the discrete series of values indicated by\narrows on the horizontal axes. The points are joined by continuous lines, for clarity sake. In both panels we distinguish\nthe strength of the ion thermostat by the line color. Darker or\nlighter (red or blue in the online version) curves correspond respectively to a strong (\u03b3 \u22121 = 20 fs) or mild (\u03b3 \u22121 = 1 ps) friction. In panel (a) we plot TS against \u03c4F , and we choose two extreme values of the shell friction, \u03b3S\u22121 = 1 ps and \u03b3S\u22121 = 50 fs,\nwhich are represented respectively with full and dashed lines.\nIn panel (b) we plot the dependence of TS versus \u03b3S . Here\nfull and dashed lines correspond respectively to a physically\nmeaningful filter (\u03c4F = 2 fs) and to white noise (\u03c4F = 0).\n\nthermostat of friction \u03b3S to the electrons. This latter\nthermostat is memory-less, so that it couples optimally\nwith the fast electronic modes. Such a simulation scheme\namounts to a non-equilibrium dynamics, in which heat\nis injected into the ionic DOF and systematically subtracted from the electronic ones. In spite of the stochastic\nnature of these equations it is still possible to introduce\na conserved quantity that measures the accuracy of the\nintegration. This can be obtained by accumulating the\nchange in kinetic energy due to the thermostat [4, 16\u201318].\nHowever, at variance with Refs. [4, 16], the conservation\nof this quantity does not rigorously measure the sampling\naccuracy.\nAs an example we consider the simulation of crystalline\ncalcite, modeled by a polarizable force field [17]. The\nCa2+ ions are treated as non-polarizable, while the polarization of the CO2\u2212\n3 anions is described by a charged shell\nattached to each oxygen. The thermostats are applied to\nthe non-polarizable ions and, in the case of the oxygens,\nto the center of mass of the system formed by the ion\nplus its shell. Meanwhile, the electronic temperature is\ncontrolled by the damping of the velocity of the shells\nrelative to the partner O ions. The vibrational density of\nstates in the absence of any thermostat can be used as an\napproximate guide to the choice of the colored thermostat parameters (see Fig. 1). In real-life, anharmonicity\nwill introduce some coupling between the normal modes,\nso that deviations from the predictions of Eq. (5) are expected. However, at least in the case of quasi-harmonic\nmodes, they will most likely reduce \u03c4H (\u03c9). Thus, one can\nsafely use the analytical estimate to tune the thermostat\nparameters beforehand, without having to perform timeconsuming tests on the real system.\nWe simulated [19] a box containing 96 CaCO3 units,\n\nwith a timestep of 1 fs, performing N V T runs with target\ntemperature T = 300 K. We performed systematic tests\nby varying \u03c4F , \u03b3 and \u03b3S (Fig. 2). The averages have\nbeen computed from 1 ns-long runs, where we discarded\nthe first 100 ps for equilibration. Within a large range\nof parameters, the procedure performs as expected: the\ntemperature of the shells remains below a few K, and\nthe ions equilibrate to the desired temperature. As \u03c4F is\nset to a value different from zero, the heat transferred to\nthe electronic DOF is reduced. However, some care must\nbe taken in choosing the friction \u03b3S , because the shell\nthermostat can induce a small drag on the ions which\nresults in an ionic temperature lower than desired, if not\ncompensated by a high thermostat strength \u03b3. Since \u03c4H\ndoes not decay fast enough to zero for \u03c9 > \u03c4F\u22121 , one must\nchoose a low cutoff frequency in order not to heat up the\nshells. As a consequence, the relaxation time for highfrequency phonons increases, making the effects of shellinduced drag more pronounced. However, the thermostat\ncan be systematically improved by adding more degrees\nof freedom, so as to obtain a more sharply defined filter,\nas we will show below.\nThermostatting on ab initio CPMD is more challenging. Since wavefunctions are not atom-centered, the coupling of the dynamics of the electronic DOF to the ions\nis stronger than in the shell-model case, and the presence\nof high-frequency components in the noise quickly heats\nup the electrons. Furthermore, because of the expense\nof ab initio CPMD, it is mandatory to have fast equilibration and sampling. We will show that both problems\ncan be solved thanks to the tunability and predictability\nof our scheme. As a test example, we ran simulations of\na single heavy water molecule in vacuum, using a standard literature setup (see Fig. 3 and Ref. [21]). We ran\nseveral independent trajectories for a total of 90 ps, starting from ionic configurations equilibrated at 300 K and\nfrom wavefunctions quenched to the Born-Oppenheimer\nsurface [22]. We have used Eq. (2) with 5 extended momenta and fitted A and B in order to obtain a short,\noptimal response time over the ionic degrees of freedom,\nand an abrupt increase in the region corresponding to\nelectronic modes [see inset of Fig. 3(b)]. We then compare this case with results from a massive Nos\u00e9-Hooverchains simulation [3, 23]. In both cases the strength of\nthe thermostat is such that the underlying dynamics of\nthe ions is severely altered.\nWith the present, very conservative choice of parameters the drift in electronic energy is negligible for both\nthermostats. In Figure 3 we plot the autocorrelation\nfunction of the squares of the normal modes. The integral of these functions measures the time required to\nlose memory of the initial configuration. It is evident\nthat the use of an optimized colored-Langevin thermostat dramatically reduces this time.\nThe thermostat we have presented offers a number\nof advantages. It can be used in CP-like, extended-\n\n\f4\n\n<q2 H0Lq2 HtL>\n\nHaL\n\n1\n\n1\n\nq\n\n0.5\n\n0.5\n0\n0\n\n0.5\n\ntHpsL\n\n1\n\npath-integrals MD. We believe that this is only a first\nexample, and that colored noise will find many other applications in a variety of computational problems. We\nthank Dr. G. Tribello for helping us in the simulation of\ncalcium carbonate and for carefully reading the paper.\n\n0\n\u2217\n\n1\n\n10-3\n\nq\n\n\u03a4H HpsL\n\n<q2 H0Lq2 HtL>\n\nHbL\n\n0.5\n\n100\n103\n\n[1]\n\n106\n103\n\n\u03a9 Hcm-1 L\n\n104\n\n105\n\n0\n0\n\n2\n\n4\n\n6\ntHpsL\n\n8\n\n10\n\n12\n\nFIG. 3: (color online) Autocorrelation functions for the\nsquares of (a) the symmetric stretching and (b) the bending modes of a heavy water molecule in vacuum, performed\nin the N V T ensemble at T = 300 K. We use a fictitious mass\n\u03bc = 200 a.u., and a timestep of 4 a.u., in order to minimize\nthe errors on the forces [20]. The Nos\u00e9-Hoover thermostat\nwith chain length 4 has been used, and its mass chosen so as\nto maximize the coupling to the stretching mode. The NH\ncorrelation functions (lighter lines, blue in the online version)\nare highly oscillating and decay very slowly. The shading\nhighlights the curve's envelope. In contrast using the new\nthermostat (darker lines, red in the online version) we find a\nmuch sharper decay, which in the case of the stretching requires an enlarged scale to be appreciated [inset of panel (a)].\nIn the inset of panel (b) we show the relation between \u03c4H and\n\u03c9 for our thermostat. The parameters have been optimized\nto obtain a sharp decay of the response for frequencies above\nthe stretching mode.\n\nLagrangian simulations, and it is also much faster in\nreaching equilibrium than the Nos\u00e9-Hoover thermostat.\nThis is particularly relevant when performing expensive,\nab initio simulations, but any problem which requires averaging over uncorrelated configurations of the system\ncan greatly benefit from the enhanced relaxation time.\nThe optimal parameters of the simulation can be easily\nestimated before the run is started. Here, in the difficult\ncase of a molecule in vacuum, we have been able to reduce the correlation time down to a fraction of a picosecond. An additional advantage is that the exact propagator in the case of zero force is obtained easily [16], which\nmakes the implementation simple and robust, at variance with Nos\u00e9-Hoover chains [3] which requires a high\norder integrator to ensure accurate trajectories [24]. Finally, the introduction of highly tunable, non-Markovian\nthermostats in molecular dynamics simulations lays the\nfoundations for the development of optimal sampling algorithms, which can be of great benefit in free-energy\ntechniques, or when one must treat systems with a broad\nvibrational spectrum, which is the case for instance in\n\n[2]\n[3]\n[4]\n[5]\n[6]\n[7]\n[8]\n[9]\n[10]\n[11]\n\n[12]\n[13]\n[14]\n[15]\n[16]\n[17]\n[18]\n[19]\n[20]\n[21]\n[22]\n[23]\n[24]\n\nElectronic address: gbussi@unimore.it; Present address:\nS3 research center and Dipartimento di Fisica, Universit\u00e0 di Modena e Reggio Emilia, via Campi 213/A, 41100\nModena, Italy.\nT. Schneider and E. Stoll, Phys. Rev. B 17, 1302 (1978);\nH. C. Andersen, J. Chem. Phys. 72, 2384 (1980); D. M.\nHeyes, Chem. Phys. 82, 285 (1983); C. P. Lowe, Europhys. Lett. 47, 145 (1999); T. Soddemann, B. D\u00fcnweg,\nand K. Kremer, Phys. Rev. E 68, 046702 (2003).\nS. Nos\u00e9, J. Chem. Phys. 81, 511 (1984); W. G. Hoover,\nPhys. Rev. A 31, 1695 (1985).\nG. J. Martyna, M. E. Tuckerman, and M. L. Klein,\nJ. Chem. Phys. 97 (1992).\nG. Bussi, D. Donadio, and M. Parrinello, J. Chem. Phys.\n126, 014101 (2007).\nR. Zwanzig, Physical Review 124, 983 (1961).\nR. Zwanzig, Nonequilibrium statistical mechanics (Oxford University Press, New York, 2001).\nH. Mori, Prog. Theor. Phys. 33, 423 (1965).\nR. Car and M. Parrinello, Phys. Rev. Lett. 55, 2471\n(1985).\nM. Sprik, J. Phys. Chem. 95, 2283 (1991).\nS. W. Rick, S. J. Stuart, and B. J. Berne, J. Chem. Phys.\n101, 6141 (1994).\nL. Rosso, P. Min\u00e1ry, Z. Zhu, and M. E. Tuckerman,\nJ. Chem. Phys. 116, 4389 (2002); J. VandeVondele and\nU. Rothlisberger, J. Phys. Chem. B 106, 203 (2002);\nL. Maragliano and E. Vanden-Eijnden, Chem. Phys. Lett.\n426, 168 (2006).\nP. E. Bl\u00f6chl and M. Parrinello, Phys. Rev. B 45, 9413\n(1992).\nF. Marchesoni and P. Grigolini, J. Chem. Phys. 78, 6287\n(1983).\nJ. Luczka, Chaos 15, 026107 (2005).\nC. W. Gardiner, Handbook of Stochastic Methods\n(Springer, Berlin, 2003), 3rd ed.\nG. Bussi and M. Parrinello, Phys. Rev. E 75, 056707\n(2007).\nF. Bruneval, D. Donadio, and M. Parrinello, J. Phys.\nChem. B 111, 12219 (2007).\nB. Ensing, S. O. Nielsen, P. B. Moore, M. L. Klein, and\nM. Parrinello, J. Chem. Theory Comput. 3, 1100 (2007).\nW. Smith, T. R. Forester, I. T. Todorov, and M. Leslie,\nCCLRC Daresbury Laboratory, UK (2006).\nP. Tangney and S. Scandolo, J. Chem. Phys. 116, 14\n(2002).\nP. H. L. Sit and N. Marzari, J. Chem. Phys. 122, 204510\n(2005).\nCPMD, Copyright IBM Corp 1990-2006, Copyright MPI\nStuttgart 1997-2001, http://www.cpmd.org/.\nD. J. Tobias, G. J. Martyna, and M. L. Klein,\nJ. Phys. Chem. 97, 12959 (1993).\nM. E. Tuckerman and M. Parrinello, J. Chem. Phys. 101,\n1302 (1994).\n\n\f"}