{"id": "http://arxiv.org/abs/0812.0164v1", "guidislink": true, "updated": "2008-11-30T19:22:38Z", "updated_parsed": [2008, 11, 30, 19, 22, 38, 6, 335, 0], "published": "2008-11-30T19:22:38Z", "published_parsed": [2008, 11, 30, 19, 22, 38, 6, 335, 0], "title": "Factor complexity of infinite words associated with non-simple Parry\n  numbers", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0812.3393%2C0812.0702%2C0812.0708%2C0812.1470%2C0812.0142%2C0812.4354%2C0812.0431%2C0812.4210%2C0812.3295%2C0812.2499%2C0812.3870%2C0812.0881%2C0812.0532%2C0812.1441%2C0812.1084%2C0812.2289%2C0812.3690%2C0812.4658%2C0812.4686%2C0812.2079%2C0812.1927%2C0812.1474%2C0812.4731%2C0812.0449%2C0812.5047%2C0812.4389%2C0812.0688%2C0812.3236%2C0812.4307%2C0812.3441%2C0812.2071%2C0812.0629%2C0812.4540%2C0812.2404%2C0812.4943%2C0812.0947%2C0812.1727%2C0812.0818%2C0812.3401%2C0812.4977%2C0812.3666%2C0812.4519%2C0812.0380%2C0812.0531%2C0812.2162%2C0812.4880%2C0812.3515%2C0812.1265%2C0812.3040%2C0812.4499%2C0812.4495%2C0812.2894%2C0812.4203%2C0812.1552%2C0812.4137%2C0812.2359%2C0812.1764%2C0812.0988%2C0812.0368%2C0812.2789%2C0812.2001%2C0812.0364%2C0812.1374%2C0812.0741%2C0812.2690%2C0812.3270%2C0812.0652%2C0812.2369%2C0812.3188%2C0812.2389%2C0812.4590%2C0812.2936%2C0812.4680%2C0812.3486%2C0812.5110%2C0812.1153%2C0812.2815%2C0812.4220%2C0812.2859%2C0812.3524%2C0812.1440%2C0812.0606%2C0812.0164%2C0812.4351%2C0812.1646%2C0812.4454%2C0812.1825%2C0812.3180%2C0812.2845%2C0812.1709%2C0812.3833%2C0812.2208%2C0812.3470%2C0812.5115%2C0812.4129%2C0812.0686%2C0812.2287%2C0812.2193%2C0812.2493%2C0812.1522%2C0812.3353&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Factor complexity of infinite words associated with non-simple Parry\n  numbers"}, "summary": "The factor complexity of the infinite word $\\ubeta$ canonically associated to\na non-simple Parry number $\\beta$ is studied. Our approach is based on the\nnotion of special factors introduced by Berstel and Cassaigne. At first, we\ngive a handy method for determining infinite left special branches; this method\nis applicable to a broad class of infinite words which are fixed points of a\nprimitive substitution. In the second part of the article, we focus on infinite\nwords $\\ubeta$ only. To complete the description of its special factors, we\ndefine and study $(a,b)$-maximal left special factors. This enables us to\ncharacterize non-simple Parry numbers $\\beta$ for which the word $\\ubeta$ has\naffine complexity.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0812.3393%2C0812.0702%2C0812.0708%2C0812.1470%2C0812.0142%2C0812.4354%2C0812.0431%2C0812.4210%2C0812.3295%2C0812.2499%2C0812.3870%2C0812.0881%2C0812.0532%2C0812.1441%2C0812.1084%2C0812.2289%2C0812.3690%2C0812.4658%2C0812.4686%2C0812.2079%2C0812.1927%2C0812.1474%2C0812.4731%2C0812.0449%2C0812.5047%2C0812.4389%2C0812.0688%2C0812.3236%2C0812.4307%2C0812.3441%2C0812.2071%2C0812.0629%2C0812.4540%2C0812.2404%2C0812.4943%2C0812.0947%2C0812.1727%2C0812.0818%2C0812.3401%2C0812.4977%2C0812.3666%2C0812.4519%2C0812.0380%2C0812.0531%2C0812.2162%2C0812.4880%2C0812.3515%2C0812.1265%2C0812.3040%2C0812.4499%2C0812.4495%2C0812.2894%2C0812.4203%2C0812.1552%2C0812.4137%2C0812.2359%2C0812.1764%2C0812.0988%2C0812.0368%2C0812.2789%2C0812.2001%2C0812.0364%2C0812.1374%2C0812.0741%2C0812.2690%2C0812.3270%2C0812.0652%2C0812.2369%2C0812.3188%2C0812.2389%2C0812.4590%2C0812.2936%2C0812.4680%2C0812.3486%2C0812.5110%2C0812.1153%2C0812.2815%2C0812.4220%2C0812.2859%2C0812.3524%2C0812.1440%2C0812.0606%2C0812.0164%2C0812.4351%2C0812.1646%2C0812.4454%2C0812.1825%2C0812.3180%2C0812.2845%2C0812.1709%2C0812.3833%2C0812.2208%2C0812.3470%2C0812.5115%2C0812.4129%2C0812.0686%2C0812.2287%2C0812.2193%2C0812.2493%2C0812.1522%2C0812.3353&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The factor complexity of the infinite word $\\ubeta$ canonically associated to\na non-simple Parry number $\\beta$ is studied. Our approach is based on the\nnotion of special factors introduced by Berstel and Cassaigne. At first, we\ngive a handy method for determining infinite left special branches; this method\nis applicable to a broad class of infinite words which are fixed points of a\nprimitive substitution. In the second part of the article, we focus on infinite\nwords $\\ubeta$ only. To complete the description of its special factors, we\ndefine and study $(a,b)$-maximal left special factors. This enables us to\ncharacterize non-simple Parry numbers $\\beta$ for which the word $\\ubeta$ has\naffine complexity."}, "authors": ["Karel Klouda", "Edita Pelantov\u00e1"], "author_detail": {"name": "Edita Pelantov\u00e1"}, "author": "Edita Pelantov\u00e1", "arxiv_comment": "25 pages, 6 figures", "links": [{"href": "http://arxiv.org/abs/0812.0164v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0812.0164v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "68R15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0812.0164v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0812.0164v1", "journal_reference": "Integers - Electronic Journal of Combinatorial Number Theory 9\n  (2009), 281-310", "doi": null, "fulltext": "Factor complexity of infinite words associated with non-simple Parry\nnumbers\nKarel Klouda1,2 , Edita Pelantov\u00e11,3\nkarel@kloudak.eu\n\narXiv:0812.0164v1 [math.CO] 30 Nov 2008\n\n1\n2\n3\n\nFNSPE, Czech Technical University in Prague\nLIAFA, Universit\u00e9 Denis-Diderot (Paris VII)\nDoppler Institute for mathematical physics and applied mathematics, Prague\n\nThe factor complexity of the infinite word u\u03b2 canonically associated to a non-simple Parry\nnumber \u03b2 is studied. Our approach is based on the notion of special factors introduced by\nBerstel and Cassaigne. At first, we give a handy method for determining infinite left special\nbranches; this method is applicable to a broad class of infinite words which are fixed points\nof a primitive substitution. In the second part of the article, we focus on infinite words u\u03b2\nonly. To complete the description of its special factors, we define and study (a, b)-maximal\nleft special factors. This enables us to characterize non-simple Parry numbers \u03b2 for which the\nword u\u03b2 has affine complexity.\n\n1\n\nIntroduction\n\nThe aim of this work is to compute the factor complexity function C(n) of the infinite word\nu\u03b2 associated with \u03b2-expansions [24], where \u03b2 is a non-simple Parry number. The definition\nof Parry numbers is connected with the R\u00e9nyi expansion of unity d\u03b2 (1). Parry numbers are\nthose \u03b2 for which d\u03b2 (1) is eventually periodic. Positional numerical systems with a Parry\nnumber as a base have a nice behavior. For example, if we consider \u03b2-integers, i.e., real\nnumbers with vanishing \u03b2-fractional part in their \u03b2-expansion, then the distances between\ntwo consecutive \u03b2-integers take only finitely many values. In fact, this property can be used as\nan equivalent definition of Parry numbers. In this sense, positional numeration systems based\non Parry numbers are a natural generalization of the classical decimal or binary systems. Let\nus mention that even the innocent looking rational base \u03b2 = 32 brings into numeration systems\nphenomena never observed before [1].\n\u221a\nThe most prominent Parry number is the golden mean \u03c4 = 1+2 5 with d\u03c4 (1) = 11. The\ninfinite word associated to \u03c4 is the famous Fibonacci chain, i.e., the word generated by the\nsubstitution 0 7\u2192 01 and 1 7\u2192 0. The Fibonacci chain codes the distances between \u03c4 -integers.\nFabre in [12] showed that for any Parry number there exists a canonical substitution over a\nfinite alphabet such that its unique fixed point u\u03b2 represents the distribution of \u03b2-integers on\nthe real line.\n\u03b2-integers attracted attention of physicists after the discovery of quasicrystals in 1982 [25].\n\u03c4 -integers were shown to be a suitable tool for describing atomic positions in solid materials\n\n1\n\n\fwith long range order and non-crystalographical five-fold symmetry [20], [3]. The knowledge\nof the factor complexity of the Fibonacci chain is the first step towards the description of\nvariability of local configurations in quasicrystals [19].\nParry numbers are split into two groups: a Parry number \u03b2 is called simple if the R\u00e9nyi\nexpansion of unity d\u03b2 (1) has only a finite number of nonzero elements, otherwise \u03b2 is nonsimple. The questions concerning the factor complexity of words u\u03b2 associated with simple\nParry numbers were discussed in [15] and [4]. Of course, since among u\u03b2 one can find some\nSturmian sequences and Arnoux-Rauzy words, the complexity of u\u03b2 for some specific values\nof \u03b2 were known earlier.\nThe first non-simple Parry number \u03b2 for which the factor complexity of u\u03b2 was precisely\ndetermined is such that d\u03b2 (1) = 2(01)\u03c9 , i.e., \u03b2 is a root of the polynomial x3 \u2212 2x2 \u2212 x + 1.\nThis non-simple Parry number appears naturally when describing the model of quasicrystals\nwith seven-fold symmetry [14]. The first attempt to study factor complexity of u\u03b2 for broader\nclass of non-simple Parry number can be found in [16].\nSince any infinite word u\u03b2 is the fixed point of a primitive substitution, the factor complexity of u\u03b2 can be estimate from above by a linear function, see [23]. Moreover, we know\nthat the first difference of complexity is bounded by a constant [8] [21]. Nevertheless, in\ngeneral, it is hard to find an explicit formula for the complexity function of an infinite word\nu and it seems it holds also for the case of u\u03b2 . However, we are able to find all left special\nfactors that, in a certain sense, completely determine the factor complexity. The notion of\n(right) special factor was introduced by Berstel [5] in 1980 and considerably enhanced by\nCassaigne in his paper [9] in 1997. We introduce another slight enhancement, a tool that will\nhelp us to identify all infinite left special branches of fixed point of substitutions satisfying\nsome natural assumption. Further, the knowledge of the structure of left special factors will\nallow us to identify all non-simple Parry numbers \u03b2 for which the complexity of u\u03b2 is affine:\nThe complexity of u\u03b2 is affine if and only if t1 (0 * * * 0(t1 \u2212 1))\u03c9 (Theorem 57).\n\n2\n\nParry numbers and associated infinite words\n\nFor each x \u2208 [0, 1) and for each \u03b2 > 1, using a greedy algorithm, one can obtain the unique\n\u03b2-expansion (xi )i\u22651 ,xi \u2208 N, of the number x such that\nX\nX\nx=\nxi \u03b2 \u2212i and\nxi \u03b2 \u2212i < \u03b2 \u2212k+1 .\ni\u22651\n\ni\u2265k\n\nBy shifting, each non-negative number has a \u03b2-expansion. For x \u2208 [0, 1), the \u03b2-expansion can\nbe computed also by using the piecewise linear map T\u03b2 : [0, 1) \u2192 [0, 1) defined as\nT\u03b2 (x) = {\u03b2x},\nwhere {\u03b2x} is the fractional part of the real number \u03b2x. The sequence d\u03b2 (x) = x1 x2 x3 * * * is\nobtained by iterating T\u03b2 with\nxi = b\u03b2T\u03b2i\u22121 (x)c.\n\n2\n\n\fThe difference between \u03b2-expansion and d\u03b2 (x) arises for x = 1 since the R\u00e9nyi expansion of\nunity d\u03b2 (1) is not a \u03b2-expansion. Parry [22] showed that d\u03b2 (1) plays a very important role in\nthe theory of \u03b2-numeration. Among other things, it allows us to define Parry numbers.\nDefinition 1. A real number \u03b2 > 1 is said to be a Parry number if d\u03b2 (1) is eventually\nperiodic. In particular,\na) if d\u03b2 (1) = t1 * * * tm is finite, i.e., it ends in infinitely many zeros, then \u03b2 is a simple\nParry number,\nb) if it is not finite, i.e., d\u03b2 (1) = t1 * * * tm (tm+1 * * * tm+p )\u03c9 , then \u03b2 is called a non-simple\nParry number.\nNote, that the parameters m, p > 0 are taken the least possible. It implies that tm 6= tm+p\nwhich will be a very important fact. Another crucial property of d\u03b2 (1) is the following Parry\ncondition [22] valid for all \u03b2 > 1\ntj tj+1 tj+2 * * *\n\n\u227a\n\nt1 t2 t3 * * *\n\nfor every j > 1 ,\n\n(1)\n\nwhere \u227a is the (strict) lexicographical ordering.\nAs the infinite word u\u03b2 is tightly connected with a geometrical interpretation of \u03b2-integers,\nwe first introduce \u03b2-integers along with some of their properties.\nDefinition 2. The real number x is a \u03b2-integer if the \u03b2-expansion of |x| is of the form\nPk\ni\ni=0 ai \u03b2 . The set of all \u03b2-integers is denoted by Z\u03b2 .\nThe definition of \u03b2-integers coincides with the definition of classical integers in the case of\n\u03b2 in Z. But there are several new phenomena linked with the notion of \u03b2-integers when \u03b2 is\nnot an integer. For our purposes, the most interesting difference between classical integers and\n\u03b2-integers is the difference in their distribution on the real line. While the classical integers\nare distributed equidistantly, i.e., gaps between two consequent integers are always of the\nsame length 1, the lengths of gaps between \u03b2-integers can take their values even in an infinite\nset. More precisely, Thurston [26] proved the following theorem.\nTheorem 3. Let \u03b2 > 1 be a real number and d\u03b2 (1) = (ti )i\u22651 . Then the length of gaps between\nneighbors in Z\u03b2 takes values in the set {40 , 41 , . . .}, where\n4i =\n\nX tk+i\nk\u22651\n\n\u03b2k\n\n,\n\nfor i \u2208 N.\n\nCorollary 4. The set of lengths of gaps between two consecutive \u03b2-integers is finite if and\nonly if \u03b2 is a Parry number. Moreover, if \u03b2 is a simple Parry number, i.e., d\u03b2 (1) =\nt1 * * * tm , the set reads {40 , 41 , . . . 4m\u22121 }, if \u03b2 is a non-simple Parry number, i.e., d\u03b2 (1) =\nt1 * * * tm (tm+1 * * * tm+p )\u03c9 , we obtain {40 , 41 , . . . 4m+p\u22121 }.\n\n3\n\n\fNow, let us suppose that we have drawn \u03b2-integers on the real line and assume that\n\u03b2 is a Parry number. If we read the length of gaps from zero to the right, we obtain an\ninfinite sequence, say {4ik }k\u22650 . Further, if we read only indices, we obtain an infinite word\nover the alphabet {0, . . . , m \u2212 1} in the case of simple Parry numbers, and over the alphabet\n{0, . . . , m + p \u2212 1} in the non-simple case. The obtained infinite word is just the word u\u03b2 we\nare interested in. However, there exists another way to define it. Fabre [12] proved that u\u03b2\ncan be defined as the unique fixed point of a substitution \u03c6\u03b2 canonically associated with a\nParry number \u03b2 and defined as follows.\nDefinition 5. For a simple Parry number \u03b2 the canonical substitution \u03c6\u03b2 over the alphabet\nA = {0, 1, . . . , m \u2212 1} is defined by\n\u03c6\u03b2 (0)\n\u03c6\u03b2 (1)\n\n= 0t1 1\n= 0t2 2\n..\n.\n\n\u03c6\u03b2 (m\u22122) = 0tm\u22121 (m\u22121)\n\u03c6\u03b2 (m\u22121) = 0tm\nDefinition 6. For a non-simple Parry number \u03b2 the canonical substitution \u03c6\u03b2 over the alphabet A = {0, 1, . . . , m + p \u2212 1} is defined by\n\u03c6\u03b2 (0)\n\u03c6\u03b2 (1)\n\n= 0t1 1\n= 0t2 2\n..\n.\n\n\u03c6\u03b2 (m\u22121)\n\u03c6\u03b2 (m)\n\n= 0tm m\n= 0tm+1 (m+1)\n..\n.\n\n\u03c6\u03b2 (m+p\u22122) = 0tm+p\u22121 (m+p\u22121)\n\u03c6\u03b2 (m+p\u22121) = 0tm+p m.\nWe see that the definition of \u03c6\u03b2 is given by d\u03b2 (1) and that the only difference between\nsimple and non-simple cases lies in the images of the last letters m \u2212 1 and m + p \u2212 1. While\nin the simple case the last letters of images \u03c6\u03b2 (k), k = 0, 1, . . . , m \u2212 1, are all distinct and so\nthe images form a suffix-free code, in the non-simple case either \u03c6\u03b2 (m) = 0tm m is a prefix of\n\u03c6\u03b2 (m + p \u2212 1) = 0tm+p m or vice versa. As we will see later on, this property is crucial from\nthe point of view of computing the complexity of the infinite word u\u03b2 .\nDefinition 7. Let \u03b2 > 1 be a Parry number. The unique fixed point of the canonical substitution \u03c6\u03b2 is denoted by\nu\u03b2 = lim \u03c6n\u03b2 (0) = \u03c6\u221e\n\u03b2 (0).\nn\u2192\u221e\n\nThe uniqueness of u\u03b2 follows from the definitions of \u03c6\u03b2 , the letter 0 is the only admissible\nstarting letter of a fixed point.\n\n4\n\n\f3\n\nSpecial factors and factor complexity\n\nIn this section, we will recall the notion of special factors of an arbitrary infinite word and\nwe will explain how the structure of special factors of an infinite word determines its factor\ncomplexity. To be able to do it, we need some usual basic notation, see [9] for more.\nDefinition 8. Let A = {0, 1, . . . , q \u2212 1}, q \u2265 1 be a finite alphabet. An infinite word over the\nalphabet A is a sequence u = (ui )i\u22651 where ui \u2208 A for all i \u2265 1. If v = uj uj+1 * * * uj+n\u22121 ,\nj, n \u2265 1, then v is said to be a factor of u of length n and the index j is an occurrence of v,\nthe empty word \u000f is the factor of length 0.\nBy Ln (u) we denote the set of all factors of u of length n \u2208 N, the language of u is then\nS\nthe set L(u) = n\u2208N Ln (u).\nDefinition 9. Let u be an infinite word over an alphabet A. The function C(n) = #Ln (u) is\nthe factor complexity function of u. We further define the first difference of the complexity\nby M C(n) = C(n + 1) \u2212 C(n).\nIn what follows, we shall restrict ourself to those infinite words which are fixed point of\nsome substitution (morphism) \u03c6 defined over a finite alphabet A. We shall further assume\nthat \u03c6 is injective and primitive.\nDefinition 10. A substitution \u03c6 is primitive if there exists k \u2208 N such that for all a, b \u2208 A\nthe word \u03c6k (a) contains b.\nEquivalently, \u03c6 is primitive if the incidence matrix M\u03c6 is primitive.\nThere are several well-known properties of the complexity function C.\nProposition 11.\n(i) For each infinite word u, 0 \u2264 C(n) \u2264 (#A)n ,\n(ii) if u is eventually periodic then C(n) is eventually constant,\n(iii) u is aperiodic in and only if C(n) is unbounded and C(n) is unbounded if and only if\nM C(n) \u2265 1, for all n \u2208 N,\n(iv) if u is a fixed point of a primitive substitution then C(n) is a sublinear function, i.e.,\nC(n) \u2264 an + b, for some a, b \u2208 N,\n(v) if u is a fixed point of primitive substitution then M C(n) is bounded.\nItems (i) \u2212 (iii) are obvious, (iv) is due to [23], (v) was proved in [21] and in a more\ngeneral context in [8].\nIt is also well known that any fixed point of a primitive substitution is uniformly recurrent, i.e., each factor occurs infinitely many times and the gaps between its two consecutive\noccurrences are bounded in length. It implies that each factor is extendable both to the right\nand to the left.\n\n5\n\n\fDefinition 12. Let v be a factor of u, the set of left extensions of v is defined as\nLext(v) = {a \u2208 A | av \u2208 L(u)}.\nIf #Lext(v) \u2265 2, then v is said to be a left special (LS) factor of u.\nIn the analogous way we define the set of right extensions Rext(u) and a right special\n(RS) factor. If v is both left and right special, then it is called bispecial.\nThe connection between (left) special factors and the complexity follows from the following\n(i)\n(i)\nreasoning. Let us suppose that Ln (u) = {v1 , . . . , vk }, k \u2265 1 and let Lext(vi ) = {a1 , . . . , a`i },\n`i \u2265 1, i = 1, . . . , k. Now, it is not difficult to realize that\n(1)\n\n(1)\n\n(2)\n\n(k\u22121)\n\n(k)\n\n(k)\n\nLn+1 (u) = {a1 v1 , . . . , a`1 v1 , a1 v2 , . . . , a`k\u22121 vk\u22121 , a1 vk , . . . , a`k vk },\ni.e., by concatenating all factors of length n and all their left extensions we obtain all factors\nof length n + 1. It implies that\nX\n#Ln+1 (u) \u2212 #Ln (u) =M C(n) =\n(#Lext(v) \u2212 1).\n(2)\nv\u2208Ln (u)\nv is LS\n\nHence, if we know all LS factors along with the number of their left extensions, we are able\nto evaluate the complexity C(n) using this formula.\n\n3.1\n\nClassification of LS factors\n\nLet a, b \u2208 Lext(v) be left extensions of a factor v of u, it means both av and bv are factors of\nu. If there exists a letter c \u2208 Rext(av) \u2229 Rext(bv), we say that v can be extended to the right\nsuch that it remains LS with left extensions a, b, indeed a, b \u2208 Lext(vc).\nDefinition 13. Let a, b \u2208 Lext(v) be distinct left extensions of a LS factor v of u. We\nsay that v is an (a, b)-maximal LS factor if Rext(av) \u2229 Rext(bv) = \u2205, in words, v cannot be\nextended to the right such that it remains LS with left extensions a, b.\n\na\n\nv\n\nb\n\nd\n\na\n\ne\n\nb\n\nv\n\nd\ne\n\nc\na)\n\nb)\n\nFigure 1: Two types of (a, b)-maximal LS factor v.\nIn general, there are two types of (a, b)-maximal LS factors both depicted in Figure 1. In\nCase a), a and b are only left extensions of v and so v cannot be extended to the right and\n\n6\n\n\fremain LS. In Case b), v can be prolonged by letter e such that ve is still a LS factor but it\nlooses its left extension a.\nIt can also happen that a factor v with left extensions a and b is extendable to the right\ninfinitely many times. In this way we obtain an infinite LS branch.\nDefinition 14. An infinite word w is an infinite LS branch of u if each prefix of w is a LS\nfactor of u. We put\n\\\nLext(w) =\nLext(v).\nv prefix of w\n\nProposition 15.\n(i) If u is eventually periodic, then there is no infinite LS branch of u,\n(ii) if u is aperiodic, then there exists at least one infinite LS branch of u,\n(iii) if u is a fixed point of a primitive substitution then the number of infinite LS branches\nis bounded.\n(i) is obvious, (iii) is a direct consequence of (2) and Proposition 11 (v). Item (ii) is a\ndirect consequence of the famous K\u00f6nig's infinity lemma [18] applied on sets V1 , V2 , . . ., where\nthe set Vk comprises all LS factors of length k and where v1 \u2208 Vi is connected by an edge with\nv2 \u2208 Vi+1 if v1 is prefix of v2 .\nTaking all together, our aim is to find all (a, b)-maximal LS factors and also all infinite\nLS branches of u.\nRemark 16. The term \"special factor\" (for us it was RS factor) was introduced in 1980 [5]\nand it has been used for computing the factor complexity since then (eg. [6], [11]). The\nnotations introduced above are based on Cassaigne's article [9]. An (a, b)-maximal factor is\na new term, actually it is a special case of a weak bispecial factor proposed there. It is also\nshown in the article that bispecial factors determine the second difference of the complexity in\na similar way as LS factors determine the first difference of the complexity.\nRemark 17. Everything what has been (and will be) defined or showed for LS factors can be\ndefined or showed similarly for RS factors.\n\n3.2\n\nHow to find infinite LS branches\n\nBefore introducing a new notion, let us consider the example substitution\n\u03c6 : 1 7\u2192 1211, 2 7\u2192 311, 3 7\u2192 2412, 4 7\u2192 435, 5 7\u2192 534\n\n(3)\n\nwith u = \u03c6\u221e (1). Further, let w be a LS factor (or infinite LS branch) of u with left extensions\n1 and 2. Is \u03c6(w) again LS factor? From Figure 2 (first line) we see that it is not since the\nletter 1 is its only left extension. In order to obtain a LS factor, we have to prepend the\nfactor 11 which is the longest common suffix of \u03c6(1) = 1211 and \u03c6(2) = 311, then 11\u03c6(w) is\n\n7\n\n\f1\n2\n\n\u03c6-image\nw\n\n1211\n311\n\n\u03c6(w)\n\nfL (1, 2) = 11\nf -image\n2\n11\u03c6(w)\n3\ngL (1, 2) = {2, 3}\nfL (2, 3) = \u000f\n\n2\n3\n\n\u03c6-image\nw\n\n311\n2412\n\n\u03c6(w)\n\nf -image\n\n1\n\n2\ngL (2, 3) = {1, 2}\n\n\u03c6(w)\n\nFigure 2: Images of LS factors.\na LS factor with left extensions 2 and 3. In the case when Lext(w) = {2, 3} (second line in\nFigure 2), \u03c6(w) is a LS factor since the longest common suffix of \u03c6(2) = 311 and \u03c6(3) = 2412\nis the empty word \u000f.\nDefinition 18. Let \u03c6 be a substitution defined over an alphabet A. For each couple of distinct\nletters a, b \u2208 A we define fL (a, b) as the longest common suffix of words \u03c6(a) and \u03c6(b).\nDefinition 19. Let v be a prefix of a word w, then v \u22121 w is the word w without the prefix v.\nAnalogously, we define wv \u22121 , if v is a suffix of w.\nDefinition 20. Let \u03c6 be an injective substitution defined over an alphabet A having a fixed\npoint u. For each unordered couple of distinct letters a, b \u2208 A such that Rext(a) \u2229 Rext(b) 6= \u2205\nwe define the set gL (a, b) as follows.\n(i) If fL (a, b) is a proper suffix of both \u03c6(a) and \u03c6(b), then gL (a, b) contains just the last\nletters of factors \u03c6(a)(fL (a, b))\u22121 and \u03c6(b)(fL (a, b))\u22121 .\n(ii) If fL (a, b) = \u03c6(a) (i.e., W.L.O.G. |\u03c6(a)| < |\u03c6(b)|), then gL (a, b) contains the last letter\nof the factor \u03c6(b)(fL (a, b))\u22121 and all the last letters of factors \u03c6(c), where c \u2208 Lext(a)\nsuch that Rext(ca) \u2229 Rext(b) 6= \u2205.\nAssumption 21. A substitution \u03c6 defined over A is injective and it has a fixed point u such\nthat for all a, b \u2208 A, for which gL (a, b) is defined, it holds that #gL (a, b) = 2.\nMoreover, if fL (a, b) = \u03c6(a) and d is the last letter of the factor \u03c6(b)(fL (a, b))\u22121 , then for\nall c \u2208 Lext(a) such that Rext(ca) \u2229 Rext(b) 6= \u2205 it holds that d is not the last letter of \u03c6(c).\nAssumption 21 is valid for all suffix-free substitutions since gL (a, b) from point (i) of\nDefinition 20 contains always just two elements and the case when fL (a, b) = \u03c6(a) never\nhappens. If fL (a, b) = \u03c6(a), then Assumption 21 says that if v is a LS factor with Lext(v) =\n{a, b}, then the last letter e of \u03c6(c) is the same for all c \u2208 Lext(av) and, moreover, e\u03c6(a) is\nnot a suffix of \u03c6(b) \u2013 in other words, for each LS factor v the factor fL (a, b)\u03c6(v) is again LS.\nWe will see that this complicated assumption is satisfied for the (not suffix-free) substitution\n\u03c6\u03b2 , where \u03b2 is a non-simple Parry number.\n\n8\n\n\f11\n\n1\n3\n\n\u000f\n\n1\n2\n\n2\n3\n\u000f\n\n3\n5\n\n\u000f\n\n2\n4\n\n\u000f\n\n4\n5\n\n\u000f\n\n\u000f\n\n1\n5\n\n1\n4\n\n\u000f\n\n2\n5\n\n\u000f\n\n3\n4\n\n\u000f\n\nFigure 3: The graph GL\u03c6 for the Substitution (3).\nDefinition 22. Let \u03c6 be a substitution satisfying Assumption 21. Then for each LS factor\n(or infinite LS branch) w having distinct left extensions a and b we define f -image of w as\nthe factor fL (a, b)\u03c6(w).\nWith respect to the preceding discussion, Assumption 21 says that f -image is always LS\nfactor and it has just two left extensions, namely two elements of gL (a, b), corresponding to\ntwo original left extensions a and b.\nAssumption 21 along with the notation introduced above allow us to define the following\ngraph.\nDefinition 23. Let \u03c6 be a substitution defined over an alphabet A satisfying Assumption 21.\nWe define a directed labelled graph GL\u03c6 as follows:\n(i) vertices of GL\u03c6 are couples of distinct letters a, b such that Rext(a) \u2229 Rext(b) 6= \u2205,\n(ii) if gL (a, b) = {c, d}, then there is an edge from a vertex (a, b) to a vertex (c, d) labelled\nby fL (a, b).\nIn fact, the crucial result of Assumption 21 is that out-degree of each vertex is exactly one.\nThe graph GL\u03c6 for our example substitution is drawn in Figure 3, this substitution satisfies\nAssumption 21 for it is suffix-free.\nNow, let us consider the case when w is an infinite LS branch with a, b \u2208 Lext(w), a 6= b.\nObviously, f -image of w is uniquely given. For most substitutions even a \"f -preimage\" of\neach infinite LS branch exists.\nAssumption 24. An infinite word u is a fixed point of a substitution \u03c6 satisfying Assumption 21. For each infinite LS branch w of u with a, b \u2208 Lext(w), a 6= b there exists at least\none infinite LS branch w with left extensions c and d such that f -image of w equals w and\ngL (c, d) = {a, b}.\n\n9\n\n\fThis assumption is very weak. Actually, we have not found any primitive substitution not\nsatisfying it. The reason for it is the following. It is not difficult to prove (but it requires a\nlot of new notation) this: Disruption of Assumption 24 implies that each factor of u can be\ndecomposed into images of letters \u03c6(a), a \u2208 A, in at least two different ways. Thus, in order to\nprove that Assumption 24 is satisfied, it suffices to find any factor with unique decomposition\nto images of letters. For the example substitution (3) the factor 1211 is such a factor since it\ncan arise only as \u03c6(1), an example of a factor having two different decomposition is 1112, it\nis part of both \u03c6(1)\u03c6(1) and \u03c6(3)\u03c6(1). In the case of \u03c6\u03b2 , we will prove that Assumption 24\nis satisfied differently.\nTheorem 25. Let u be a fixed point of a primitive injective substitution \u03c6 satisfying Assumption 24 and let w be an infinite LS branch with a, b \u2208 Lext(w), a 6= b. Then either w is a\nperiodic point of \u03c6, i.e,\nw = \u03c6` (w) for some ` \u2265 1,\n(4)\nand (a, b) is a vertex of a cycle in GL\u03c6 labelled by \u000f only or w = s\u03c6` (s)\u03c62` (s) * * * is the unique\nsolution of the equation\nw = s\u03c6` (w),\n(5)\nwhere (a, b) is a vertex of a cycle in GL\u03c6 containing at least one edge with non-empty label,\n` is the length of this cycle and\ns = fL (gL`\u22121 (a, b)) * * * \u03c6`\u22122 (fL (gL (a, b))\u03c6`\u22121 (fL (a, b)).\n\n(6)\n\nProof. Due to Assumption 24, both the f -image and the f -preimage of w exist. The f -image\nis unique due to Assumption 21 and the uniqueness of f -preimage follows from the fact that\nthe number of infinite LS branches is finite. Thus, f -image is one-to-one mapping on the\nfinite set of all ordered couples\n{((c, d), w)},\nwhere w is an infinite LS branch of u and (c, d) is an unordered couple of letters such that\nc, d \u2208 Lext(w)), c 6= d. The f -image can be viewed as a permutation on this finite set and so\nit decomposes the set to independent cycles as depicted in Figure 4, ` is then the length of\nthe cycle containing ((a, b), w).\nAs explained earlier, applying f -image on a LS factor having left extensions a, b corresponds to the movement along the edge in GL\u03c6 which leads from (a, b). If the labels of the\nedges of the cycle are all \u000f, then the f -image coincides with \u03c6 and so we obtain the periodic\npoint (4). If at least one edge is labelled by non-empty word, then ` is also length of the cycle\nin GL\u03c6 containing the vertex (a, b) and Equation (5) then corresponds to `-times applying of\nf -image on w.\nOur example substitution \u03c6 (see (3)) has five periodic points\n\u03c6\u221e (1), \u03c6\u221e (4), \u03c6\u221e (5), (\u03c62 )\u221e (2), (\u03c62 )\u221e (3).\n\n10\n\n\ffL (a, b)\u03c6(w)\n\nf -image\n\nf -image\n\na w\nb\nf -image\n\nf -image\n\nFigure 4: Circular structure of infinite LS branches.\nIt is an easy exercise to show that\nLext(1) = {1, 2, 3, 4, 5}, Lext(2) = {1, 4, 5}, Lext(3) = {1, 4, 5},\n\nLext(4) = {1, 2, 3}, Lext(5) = {1, 2, 3}.\n\nLooking at the graph GL\u03c6 depicted in Figure 3 we see that \u03c6\u221e (4), \u03c6\u221e (5) are not infinite LS\nbranches as none of the vertices (1, 2), (2, 3) and (1, 3) is a vertex of a cycle labelled by \u000f only.\nHence, only \u03c6\u221e (1), (\u03c62 )\u221e (2), (\u03c62 )\u221e (3) are infinite LS branches with left extensions 1, 4, 5.\nAs for infinite LS branches corresponding to Equation (5), in the case of our example,\nthere is only one cycle not labelled by the empty word only between vertices (1, 2) and (2, 3).\nThere are two (= the length of the cycle) equations corresponding to this cycle\nw = \u03c6(11)\u03c62 (w)\n\nand w = 11\u03c62 (w).\n\nThey give us two infinite LS branches\n\u03c6(11)\u03c63 (11)\u03c65 (11) * * * ,\n11\u03c62 (11)\u03c64 (11) * * * ,\n\nthe former having left extensions 1 and 2 and the latter 2 and 3.\nRemark 26. Assumption 21 can be reformulated into a weaker form but to do so, it would\nrequire to introduce rather complicated notation. The important fact is that the canonical\nsubstitution \u03c6\u03b2 satisfies Assumption 21.\n\n4\n\nInfinite LS branches of u\u03b2\n\nAt first, let us recall known results for simple Parry numbers. The substitution \u03c6\u03b2 from\nDefinition 5 is suffix-free and it implies that it satisfies Assumption 21. One can easily prove\nthat even Assumption 24 is satisfied. As mentioned earlier, the last letters of images of letters\n\n11\n\n\fare all distinct and so fL (a, b) = \u000f for all couples a, b \u2208 A. The graph GL\u03c6\u03b2 then looks as\nin Figure 5. It contains m \u2212 1 cycles labelled by \u000f only and hence the only candidate for\nbeing an infinite LS branch is the unique fixed (and periodic) point of \u03c6\u03b2 , namely u\u03b2 with\nLext(u\u03b2 ) = A. The same result is proved in [15] using different techniques.\nk = 1, . . . , m \u2212 1\n0\nk\n\n\u000f\n\n1\nk+1\n\n\u000f\n\n\u000f\n\nm\u22121\nk\u22121\n\nm\u2212k\u22121\nm\u22121\n\n\u000f\n\n\u000f\n\nm\u2212k\n0\n\nFigure 5: GL\u03c6\u03b2 for simple Parry \u03b2.\nTheorem 27 ([4],[15]). Let \u03b2 > 1 be a simple Parry number with d\u03b2 (1) = t1 * * * tm and let\nu\u03b2 be the fixed point of the canonical substitution \u03c6\u03b2 (5). Then\n(i) if t1 = t2 = * * * = tm\u22121\nknown [15],\n\nor\n\nt1 > max{t2 , . . . , tm\u22121 }, the exact value of C(n) is\n\n(ii) in particular, (m \u2212 1)n + 1 \u2264 C(n) \u2264 mn,\n\nfor all n \u2265 1,\n\n(iii) C(n) is affine \u21d4 the following two conditions are fulfilled\n1) tm = 1\n2) for all i = 2, 3, . . . , m\u22121 we have\nti ti+1 * * * tm\u22121 t1 * * * ti\u22121\n\n\u0016\n\nt1 t2 * * * tm\u22121 .\n\nThen C(n) = (m \u2212 1)n + 1.\nIn this paper, we will find the necessary and sufficient condition for the complexity being\naffine in the case of non-simple Parry numbers. We will see that it is more restrictive than\nthe one from point (iii).\n\n4.1\n\nInfinite LS branches in case of non-simple Parry numbers\n\nIn this section, we will apply hitherto introduced theory on the fixed point u\u03b2 of the substitution \u03c6\u03b2 , where \u03b2 is a non-simple Parry number. To be able to do so, we need some more\nnotation and simple but useful technical lemmas.\nDefinition 28. For all k, ` \u2208 N, we define the addition \u2295 : N \u00d7 N \u2192 A as follows.\n(\nk+`\nif k + ` < m + p,\nk \u2295 ` :=\nm + (k + ` \u2212 m mod p) otherwise.\n\n12\n\n\fSimilarly, if used with parameters ti , we define for all k, ` \u2208 N, k + ` > 0\n(\ntk+`\nif 0 < k + ` < m + p + 1,\ntk\u2295` :=\ntm+1+(k+`\u2212m\u22121 mod p) otherwise.\nIn fact, the addition \u2295 tracks the last letters of the words \u03c6n\u03b2 (0), n = 0, 1, . . .. Therefore,\nwe can rewrite the definition of the substitution \u03c6 in a simpler form\n\u03c6\u03b2 (k) = 0tk+1 (k \u2295 1),\n\n\u2200k \u2208 A.\n\nFurther, employing the new notation and the definition of the substitution \u03c6\u03b2 , one can easily\nprove the following simple observations.\nLemma 29. For the substitution \u03c6\u03b2 it holds\n(i) for all n \u2208 N and for all k \u2208 A\ntk\u22951\n\u03c6n\u03b2 (k) = (\u03c6n\u22121\n(\u03c6\u03b2n\u22122 (0))tk\u22952 * * * (\u03c6\u03b2 (0))tk\u2295(n\u22121) 0tk\u2295n (k \u2295 n),\n\u03b2 (0))\n\n(ii) if avb is a factor of u\u03b2 , v \u2208 A\u2217 and a, b 6= 0, then there exists unique factor v 0 such\nthat \u03c6\u03b2 (v 0 ) = vb.\nOur aim is to obtain the graph GL\u03c6\u03b2 , thus, we need to know left extensions of letters and\nalso all gL (a, b).\nDefinition 30. Let us define for all k \u2208 A, k 6= 0, a function z : {1, . . . , m + p \u2212 1} \u2192\n{0, 1, . . . , m + p \u2212 2} by\nz(k) = max{j \u2208 N | 0j is a suffix of t1 t2 * * * tk }.\nFor k \u2208 {m, . . . , m + p \u2212 1} we also define a function y : {m, . . . , m + p \u2212 1} \u2192 {0, 1, . . . , p \u2212 1}\nby\n(\nmax{j \u2208 N | 0j is a suffix of tm+1 tm+2 * * * tm+p tm+1 * * * tk } if k > m,\ny(k) =\nmax{j \u2208 N | 0j is a suffix of tm+1 tm+2 * * * tm+p }\nif k = m.\nFurther, we define\n`0 =\n\n(\n0\n1 + max{j \u2208 N |\n\nif t1 > 1,\n0j\n\nis a prefix of t2 t3 * * * tm }\n\notherwise\n\nand finally we put t = min{tm , tm+p }.\nNote that z(k) and y(k) can return the same value for k \u2265 m, a necessary condition for\nz(k) 6= y(k) is that t = 0 and z(`) 6= y(`) for all m \u2264 l < k. Due to Parry condition (1) we\nmust have 1 \u2264 `0 \u2264 m \u2212 1 as the case d\u03b2 (1) = 10 * * * 0(tm+1 * * * tm+p\u22121 1)\u03c9 is not admissible.\nLemma 31. For u\u03b2 the fixed point of \u03c6\u03b2 it holds\n\n13\n\n\f(i) Lext(0) = {`0 , . . . , m + p \u2212 1},\n(ii) Lext(k) = {z(k)}, for k \u2208 {2, 3, . . . , m \u2212 1},\n(iii) Lext(k) = {z(k), y(k)}, for k \u2208 {m, m + 1 . . . , m + p \u2212 1}.\nProof. (ii) Each letter k > 0 can appear in u\u03b2 as the image of k \u2212 1, namely \u03c6\u03b2 (k \u2212 1) = 0tk k.\nIf tk > 0, then 0 \u2208 Lext(k), if tk = 0 we consider \u03c62\u03b2 (k \u2212 2) = \u03c6\u03b2 (0tk\u22121 )k = (0t1 1)tk\u22121 k. Again,\nif tk\u22121 > 0, then 1 \u2208 Lext(k), otherwise we continue in the same way. Since t1 > 0, this\nprocess is finite.\n(iii) The letter m can appear in u\u03b2 not only as an image \u03c6\u03b2 (m \u2212 1) (i.e., case (ii)) but\nas well as \u03c6\u03b2 (m + p \u2212 1) = 0tm+p m. If we realize this second possible origin of the letters\nm, m + 1, . . . , m + p \u2212 1, then the proof is the same as for (ii).\n(i) If t1 > 1, then 00 is a factor of u. Hence, for all n \u2208 N the word \u03c6n\u03b2 (0)0 = * * * (0 \u2295 n)0\nis a factor as well and so Lext(0) = A.\nLet t1 = 1, it implies ti \u2208 {0, 1} for i = 1, . . . , m + p. It holds \u03c6`\u03b20 (01) = \u03c6\u03b2 ((`0 \u2212 1)`0 ) =\n`0 0(`0 + 1), hence, `0 , `0 + 1, . . . , m + p \u2212 1 \u2208 Lext(0). But d\u03b2 (1) cannot contain a sequence\nof consecutive 0's shorter than `0 due to Parry condition (1) and so `0 is the least letter in\nLext(0).\nThe previous lemma allows us to partially determine all LS factors of u\u03b2 .\nCorollary 32. Let v be a LS factor of u\u03b2 containing at least one nonzero letter, then one of\nthe following factors is a prefix of v.\n(i) 0t1 1,\n(ii) 0t m,\n(iii) 0tk k, if k > m and t = tm+1 = tm+2 = * * * = tk\u22121 = 0.\nNote, that the factors from the last point are images of the factor 0t m in the case when\nt = 0.\nLemma 33. For u\u03b2 the fixed point of \u03c6\u03b2 it holds\n(i) if (k, `) is unordered couple of distinct letters of A such that Rext(k) \u2229 Rext(`) 6= \u2205, and\n(k, `) 6= (m \u2212 1, m + p \u2212 1), then fL (k, `) = \u000f and gL (k, `) = {k \u2295 1, ` \u2295 1},\n(ii) fL (m \u2212 1, m + p \u2212 1) = 0t m and gL (m \u2212 1, m + p \u2212 1) = {0, z}, where\n(\n1 + z(m \u2212 1)\nif tm < tm+p ,\nz=\n1 + z(m + p \u2212 1) if tm+p < tm .\n\n(7)\n\nProof. (i) follows directly from the definitions of gL , fL and \u03c6\u03b2 . (ii) is a simple consequence\nof Lemma 31. Remark that if tm > tm+p \u2265 0, then z(m + p \u2212 1) = y(m + p \u2212 1).\n\n14\n\n\fNow we have the knowledge necessary to complete the graph GL\u03c6\u03b2 but still we have to\nprove that the substitution \u03c6\u03b2 satisfies Assumptions 21 and 24.\nLemma 34. The substitution \u03c6\u03b2 from Definition 6 satisfies Assumptions 21 and 24.\nProof. The fact that Assumptions 21 is fulfilled follows from Lemmas 31 and 33.\nTo construct an f -preimage for an arbitrary infinite LS branch is easy due to Lemma 29\npart (ii), Corollary 32 and Lemma 33.\nNow, we know all we need to be able to construct the graph GL\u03c6\u03b2 . For the case when\nt1 > 1, the graph is depicted in Figure 6. Since Lext(0) = A, all possible unordered couples\nof letters are vertices of the graph. If z is not a multiple of p (i.e., the decision condition\nz = sp in Figure 6 returns no), then the graph contains only cycles with edges labelled by \u000f\nonly. If z = sp for certain positive integer s, then there is the cycle on vertices (0, z), (1, z \u2295\n1), . . . , (m \u2212 1, z \u2295 m \u2212 1), where the edge from the vertex (m \u2212 1, z \u2295 m \u2212 1) to the vertex\ngL (m \u2212 1, z \u2295 m \u2212 1) = (0, z) is labelled by fL (m \u2212 1, z \u2295 m \u2212 1) = 0t m.\nIf t1 = 1 the graph GL\u03c6\u03b2 is the same as in Figure 6 but we have to remove vertices (k, `),\nwhere k < `0 or ` < `0 and (k, `) 6= (0 \u2295 n, z \u2295 n) for any n \u2208 N. What is important for our\npurpose is that the structure of cycles is the same for arbitrary value of t1 .\nk 6= sp\n\n0\nk\n\n\u000f\n\n1\nk\u22951\n\n\u000f\n\nm\nk\u2295m\n\nm+p\u22121\nk\u2295m+p\u22121\n\n\u000f\n\u000f\n\n0t m\nno\n0\nsp\n\n\u000f\n\n1\nsp \u2295 1\n\nm\u22121\nsp \u2295 m \u2212 1\n\n\u000f\n\n0t m\n\nz = sp\nyes\n\nFigure 6: GL\u03c6\u03b2 for non-simple Parry \u03b2, s is a positive integer.\nSince the fact whether z is or is not a multiple of p is crucial for the structure of cycles in\nGL\u03c6\u03b2 , we introduce the following set.\nDefinition 35. A non-simple Parry number \u03b2 > 1 is an element of a set S if and only if\nthere exists a positive integer s such that z = sp, where z is the non-zero left extension of\n0t m.\nEmploying Lemmas 31 and 33, one can easily prove the following.\n\n15\n\n\fLemma 36. A non-simple Parry number \u03b2 > 1 belongs to S if and only if one of the following\nconditions is satisfied\na) d\u03b2 (1) = t1 * * * tm (0 * * * 0tm+p )\u03c9\n\nand tm > tm+p ,\n\n* * 0} tm (tm + 1 * * * tm+p )\u03c9 ,\nb) d\u03b2 (1) = t1 * * * tm\u2212qp |0 *{z\n| {z }\n6=0\n\nqp\u22121\n\nq \u2265 1, and tm < tm+p .\n\nPutting it all together, we obtain a proof of the following proposition which gives us the\ncomplete list of infinite LS branches of u\u03b2 for all non-simple Parry numbers.\nProposition 37. Let \u03b2 > 1 be a non-simple Parry number and let u\u03b2 be the fixed point of\nthe canonical substitution \u03c6\u03b2 . Then\n(i) if p > 1, then u\u03b2 is an infinite LS branch with left extensions {m, m + 1, . . . , m + p \u2212 1},\n(ii) if \u03b2 \u2208\n/ S, then u\u03b2 is the unique infinite LS branch,\n(iii) if \u03b2 \u2208 S, then there are m infinite LS branches\n0t m\u03c6m (0t m)\u03c62m (0t m) * * *\n..\n.\n\u03c6m\u22121 (0t m)\u03c62m\u22121 (0t m)\u03c63m\u22121 (0t m) * * * .\nThere are no other infinite LS branches of u\u03b2 .\n\n5\n\nMaximal LS factors\n\nAs explained earlier, in order to determine the complexity of an infinite word, we need to\nfind all infinite LS branches as well as all (a, b)-maximal LS factors. The structure of (a, b)maximal LS factors is not so simple as the one of infinite LS branches but still it can be\ndescribed using the notion of f -image. To define an f -image for (a, b)-maximal LS factors,\nwe need Assumption 21 to be satisfied also for gR \u2013 we will say that the right version of\nAssumption 21 is satisfied.\nLemma 38. For the substitution \u03c6\u03b2 and for all distinct a, b \u2208 A we have fR (a, b) = 0ta,b ,\nwhere\nta,b = min{ta , tb }.\n(8)\nThus, the right version of Assumption 21 is satisfied for \u03c6\u03b2 is prefix-free.\nDefinition 39. A factor v \u2208 A+ is an (a \u2212 c, b \u2212 d)-bispecial factor of an infinite word u\ndefined over a finite alphabet A if both avc and bvd are factors of u.\nDefinition 40. Let a substitution \u03c6 defined over a finite alphabet A satisfy the left and right\nversion of Assumption 21 and let v be an (a \u2212 c, b \u2212 d)-bispecial factor of a fixed point of \u03c6.\nThen fL (a, b)\u03c6(v)fR (c, d) is said to be the f -image of v.\n\n16\n\n\f \u0303\nObviously, the f -image of v is (\u00e3\u2212c\u0303, b\u0303\u2212 d)-bispecial,\nwhere gL (a, b) = {\u00e3, b\u0303} and gR (c, d) =\n \u0303\n{c\u0303, d}.\n\nNow, consider again the particular case of u\u03b2 . A LS factor v having a, b \u2208 Lext(v) is\n(a, b)-maximal if Rext(av) \u2229 Rext(bv) = \u2205 and so it is as well an (a \u2212 c, b \u2212 d)-bispecial for all\nc \u2208 Rext(av) and d \u2208 Rext(bv). Are f -images of v again (gL (a, b))-maximal? Not all of them\nas states the following simple lemma.\nLemma 41. Let v be a bispecial factor of u\u03b2 having left extensions a and b. If its f -image\nfL (a, b)\u03c6\u03b2 (v)fR (c, d) = fL (a, b)\u03c6\u03b2 (v)0tc\u22951,d\u22951 ,\nis (gL (a, b))-maximal, then c \u2208 Rext(av), d \u2208 Rext(bv) satisfy\ntc\u22951 \u2265 max{te\u22951,f \u22951 | e \u2208 Rext(av), f \u2208 Rext(bv)}\n\ntd\u22951 \u2265 max{te\u22951,f \u22951 | e \u2208 Rext(bv), f \u2208 Rext(bv)}.\n\n(9)\n\nDefinition 42. An f -image of a bispecial factor v having left extensions a and b\nfL (a, b)\u03c6\u03b2 (v)fR (c, d),\nwhere c \u2208 Rext(av), d \u2208 Rext(bv) satisfy (9), is said to be the max-f -image of v.\nThe following lemma is crucial for understanding the structure of the max-f -images of\n(a, b)-maximal factors.\nLemma 43. If `, k \u2208 A, ` 6= k and t`\u22951 t`\u22952 * * * \u0017 tk\u22951 tk\u22952 * * * , then for all n \u2208 N the longest\ncommon prefix of the factors \u03c6n\u03b2 (k) and \u03c6n\u03b2 (`), denoted by lcp(\u03c6n\u03b2 (k), \u03c6n\u03b2 (`)), equals\nlcp(\u03c6n\u03b2 (k), \u03c6n\u03b2 (`)) = \u03c6n\u03b2 (k)(k \u2295 n)\u22121 ,\ni.e., \u03c6n\u03b2 (k) without the last letter k \u2295 n.\nMoreover, denote by c the letter such that (lcp(\u03c6n\u03b2 (k), \u03c6n\u03b2 (`)))c is a prefix of \u03c6n\u03b2 (`). Then,\ntc\u22951 tc\u22952 * * * \u0017 tk\u2295(n+1) tk\u2295(n+2) * * * for all n \u2208 N.\nProof. The case n = 0 is trivial.\nThe rest of the proof is carried on by induction on n.\nn\ntk\u22951 n\n\u03c6n+1\n\u03c6\u03b2 (k \u2295 1),\n\u03b2 (k) = (\u03c6\u03b2 (0))\n\nn\ntk\u22951\n\u03c6n+1\n(\u03c6n\u03b2 (0))t`\u22951 \u2212tk\u22951 \u03c6n\u03b2 (` \u2295 1),\n\u03b2 (`) = (\u03c6\u03b2 (0))\n\n(10)\n\nif t`\u22951 = tk\u22951 , we apply the assumption of induction on lcp(\u03c6n\u03b2 (k \u2295 1), \u03c6n\u03b2 (` \u2295 1)) and if\nt`\u22951 > tk\u22951 , then on lcp(\u03c6n\u03b2 (k \u2295 1), \u03c6n\u03b2 (0)) (see Parry condition (1)).\nAs for the second part of the statement, the letter c is given by (10) and this along with\nthe Parry condition concludes the proof.\n\n17\n\n\fLemma 44. Let n \u2208 N. The n-th max-f -image of a bispecial factor v with left extensions a\nand b, i.e., the factor we obtain if we apply n times the mapping max-f -image on v, equals\nv = s\u03c6n\u03b2 (v)lcp(\u03c6n\u03b2 (c), \u03c6n\u03b2 (d)),\nwhere c \u2208 Rext(av), d \u2208 Rext(bv), s is given by (cf. (6))\ns = fL (gLn\u22121 (a, b)) * * * \u03c6n\u22122 (fL (gL (a, b))\u03c6n\u22121 (fL (a, b)).\n\n(11)\n\nand\ntc\u22951 tc\u22952 * * * \u0017 tc0 \u22951 tc0 \u22952 * * * ,\n\ntd\u22951 td\u22952 * * * \u0017 td0 \u22951 td0 \u22952 * * *\nfor all c0 \u2208 Rext(av) and d0 \u2208 Rext(bv).\n\nProof. The case n = 0 is obvious, we carry on by induction on n. Let us assume W.L.O.G.\nthat\ntc\u22951 tc\u22952 * * * \u0017 td\u22951 td\u22952 * * *\nand that gLn (a, b) = {\u00e3, b\u0303}. Hence\nv = s\u03c6n\u03b2 (v)\u03c6n\u03b2 (d)(d \u2295 n)\u22121\nand\nRext(b\u0303v) = {d0 \u2295 n | td0 \u22951 * * * td0 \u2295n = td\u22951 * * * td\u2295n }.\nFurther, let c0 \u2208 Rext(\u00e3v), then due to Lemma 43\ntc0 \u22951 tc0 \u22952 * * * \u0017 td0 \u2295(n+1) td0 \u2295(n+2) * * *\nfor all d0 \u2295 n \u2208 Rext(b\u0303v). But td\u2295(n+1) \u2265 td0 \u2295(n+1) for all d0 \u2295 n \u2208 Rext(b\u0303v) and so the\nmax-f -image of v equals\nn+1\nn+1\nfL (gLn (a, b))\u03c6\u03b2 (v)0td\u2295(n+1) = fL (gLn (a, b))\u03c6\u03b2 (s)\u03c6n+1\n\u03b2 (v)lcp(\u03c6\u03b2 (c), \u03c6\u03b2 (d)).\n\nEach bispecial factor v having left extensions a and b has the unique max-f -image. Since\nthe substitution \u03c6\u03b2 is injective, the structure of max-f -images cannot be circular as it is for\nf -images of infinite LS branches \u2013 v cannot be the k-th max-f -image of its own for any k.\nHowever, the notion of a max-f -image allows us to describe all (a, b)-maximal factors of u\u03b2 for\nall a, b \u2208 A. We will prove that each (a, b)-maximal factor is the k-th max-f -image either of\n0t1 \u22121 if t1 > 1 or of 0 if t1 = 1, for some k \u2208 N. A sketch of the proof is as follows. Let v be an\n(a, b)-maximal factor containing at least two nonzero letters. Employing Lemma 29 part (ii),\none can find a bispecial factor v such that its max-f -image is v. Again, if v contains at least\ntwo nonzero letters, we find a bispecial factor v such that its max-f -image is v. In this way, we\n\n18\n\n\fobtain a bispecial factor containing at most one nonzero letter such that its k-th max-f -image\nequals v. According to Corollary 32, the only candidates for such bispecials are of the form 0s\nor 0t m0q , where 1 \u2264 s \u2264 t1 and 0 \u2264 q \u2264 t1 . Note that 0t1 +1 cannot be a factor of u\u03b2 and that\nis why we consider s, q \u2264 t1 . In the case when t = 0, 0tk k0q , k > m, tm+1 = * * * = tk\u22121 = 0,\ncould also be taken as the candidates but we do not consider them as they are just prefixes\nof \u03c6k\u2212m\n(m0q ). The following two lemmas tell us that 0t1 \u22121 (resp. 0 if t1 = 1) is the only\n\u03b2\ncandidate.\nLemma 45. Let t1 > 1 and k \u2208 N. Then the k-th max-f -image of factors 0t1 , 0s and 0t m0q ,\nwhere 1 \u2264 s < t1 \u2212 1 and 0 \u2264 q \u2264 t1 , are not (a, b)-maximal for any distinct letters a and b.\nProof. First, consider 0t1 with distinct left extensions a and b. It holds that Lext(0t1 ) =\nLext(0t1 1) and Rext(0t1 ) \u2282 {k \u2208 A \\ {0} | tk = t1 }. For each k \u2208 Rext(0t1 ), we must have\ntk\u22951 tk\u22952 * * * \u227a t2 t3 * * * (see Parry condition (1)) and, due to Lemma 44, k-th max-f -image\nof 0t1 is a prefix of the k-th f -image of the LS factor \u03c6k\u03b2 (0t1 1), both having the same left\nextensions.\nSimilar arguments can be used in order to prove that k-th max-f -image of 0s is always a\nprefix of k-th f -image of the LS factor 0t1 \u22121 . Again, Lext(0s ) = Lext(0t1 \u22121 ) and the rest is\nimplied directly by the Parry condition.\nFinally, consider the LS factor 0t m0q having just two left extensions 0 and z (see (7)). In\naccord with Lemma 44, the m-th max-f -image of 0t1 \u22121 with left extensions 0 and p equals\nt1 \u22121 m\n)\u03c6\u03b2 (1)(m + 1)\u22121 = 0t m0t1 1 * * * .\n0t m\u03c6m\n\u03b2 (0\n\n(12)\n\nIndeed, Rext(00t1 \u22121 ) = {k \u2208 A \\ {0}|tk = t1 } and 0 \u2208 Rext(p0t1 \u22121 ) and so the fact\nthat tk\u22951 tk\u22952 * * * \u227a t2 t3 * * * and the Parry condition imply that the m-th max-f -image is\nt1 \u22121 )lcp(\u03c6m (0), \u03c6m (1)). Thus, 0t m0q , as a prefix of (12), is not a (0, z)-maximal.\n0t m\u03c6m\n\u03b2\n\u03b2\n\u03b2 (0\nLemma 46. Let t1 = 1 and k \u2208 N. Then t = 0 and the k-th max-f -image of the factor m0q ,\nwhere 0 \u2264 q \u2264 1, is not (a, b)-maximal for any distinct letters a and b.\nProof. As in the proof of the previous lemma, we can prove that the (m \u2212 `0 )-th max-f -image\nof 0 with left extensions `0 and `0 + p is the factor\n\u22121\nm\u03c6m\n\u03b2 (1)(m + 1) ,\n\n(13)\n\nwhere, according to Lemma 29 part (i),\nm\u22121\n\u03c6m\n(0))t2 (\u03c6m\u22122\n(0))t3 * * * (\u03c6\u03b2 (0))tm 0tm+1 (m + 1).\n\u03b2 (1) = (\u03c6\u03b2\n\u03b2\n\nIn order that m0 may be (0, z)-maximal, it must be \u03c6m\n\u03b2 (1) = m + 1 and so t2 = * * * =\ntm+1 = 0. But is is not possible due to the Parry condition since then t1 t2 * * * * * * \u227a (tm+p =\n1)tm * * * tm+p t(m+p)\u22951 * * * .\n\n19\n\n\fProposition 47. Let v be an (a, b)-maximal factor of u\u03b2 . Then there exists k \u2208 N such that\nv is the k-th max-f -image of\n(i) 0t1 \u22121 if t1 > 1,\n(ii) 0 if t1 = 1.\nProof. We will prove that if v contains at least two nonzero letters, then it is the k-th maxf -image of a bispecial factor of the form 0s or 0t m0q , where 1 \u2264 s \u2264 t1 and 0 \u2264 q \u2264 t1 . The\nrest of the proof then follows from the previous two lemmas.\nLet us assume that v contains at least two nonzero letters. Then, due to Lemma 29 part\n(ii), v = fL (a0 , b0 )\u03c6\u03b2 (v)fR (c0 , d0 ), where v is a (a0 \u2212 c0 , b0 \u2212 d0 )-bispecial factor such that v is\nthe max-f -image of v and gL (a0 , b0 ) = {a, b}. Analogously, if v contains at least two nonzero\nletters, there exists an (a00 \u2212 c00 , b00 \u2212 d00 )-bispecial factor v which is an f -preimage of v. But it\n0\nmust be also a max-f -preimage, if it is not, then v0q is also the f -image of v having the left\nextensions a0 and b0 for some q 0 > 0 and so v cannot be (a, b)-maximal as it is a proper prefix\n0\nof the max-f -image of LS factor v0q with the left extensions a and b. Using this argument\niteratively, we will obtain a bispecial factor of the form 0s or 0t m0q such that v is its k-th\nmax-f -image.\nIn fact, the previous proposition along with Lemma 44 provides us with the complete list\nof (a, b)-maximal factors. However, in the last section of this paper we will need to know some\ndetails to be able to determine under which conditions the complexity of u\u03b2 is affine.\nCorollary 48. If d\u03b2 (1) 6= t1 (0 * * * 0(t1 \u2212 1))\u03c9 , then the k-th max-f -image of the factor (12)\nis (gLk (0, z))-maximal for all k \u2208 N.\nIf \u03b2 \u2208\n/ S, then the k-th max-f -image reads\n(1)(m \u2295 k)\u22121 .\n(0t1 \u22121 )\u03c6m+1\n\u03c6k\u03b2 (0t m)\u03c6m+1\n\u03b2\n\u03b2\nProof. The factor (12) is always LS with just two left extensions 0 and z. Therefore it is\n(0, z)-maximal if it is neither a prefix of any infinite LS branch or a proper prefix of the k-th\nmax-f -image of its own for certain k > 0.\nIn the case when \u03b2 \u2208\n/ S, the longest common prefix of the k-th max-f -image of the\nfactor (12) and of the unique infinite LS branch u\u03b2 equals\n\u03c6k\u03b2 (0t m)(m \u2295 k)\u22121 .\nHence, either it is non-empty and shorter than the longest common prefix of the (k + 1)-th\nmax-f -image of (12) and of u\u03b2 or it is empty, k < p and t = tm+1 = * * * = tm+k = 0 (or\nonly t = 0 for k = 0). In the latter case, the k-th max-f -image of (12) begins in letter m + k\nwhich is different from the first letters of u\u03b2 and of all other max-f -images of (12). Putting\nall together, the k-th max-f -image of (12) is neither a prefix of u\u03b2 or of the `-th max-f -image\nof (12) for any ` 6= k.\n\n20\n\n\fIf \u03b2 \u2208 S, then u\u03b2 is not the only one infinite LS branch, there are m other branches\nt\n2m t\nu1 = 0t m\u03c6m\n\u03b2 (0 m)\u03c6\u03b2 (0 m) * * *\n\n(14)\n\nand u` = \u03c6`\u22121\n\u03b2 (u1 ), l = 2, . . . , m. To finish the proof, we have to foreclose the possibility\nthat the factor (12) is prefix of u1 . Looking at (14) and (12), we see that it happens only if\nt = t1 \u2212 1 and m = 1, in other words, if d\u03b2 (1) = t1 (0 * * * 0(t1 \u2212 1))\u03c9 . The proof of that the\nfactor (12) is not a prefix of any max-f -image of its own is analogous to the one above.\nCorollary 49. If t1 > 1, then the k-th max-f -image of 0t1 \u22121 with left extensions 0 and a is\na (gLk (0, a))-maximal factor for all a \u2208 A \\ {0, z} and for all 0 \u2264 k < m.\nMoreover, put\n\uf8f1\n\uf8f4\nif t 6= t1 \u2212 1,\n\uf8f4\n\uf8f2\u22121\nk0 =\n\n0\n\uf8f4\n\uf8f4\n\uf8f3max{` \u2208 N | t\n`+1 6= tm\u2295` }\n\nif t = t1 \u2212 1 and t2 6= tm+1\n\n(15)\n\notherwise,\n\nthen the k-th max-f -image of 0t1 \u22121 is also (gLk (0, z))-maximal factor for all k0 < k < m.\nProof. It holds\nRext(00t1 \u22121 ) = {k \u2208 A \\ {0} | tk = t1 or k = m and tm+p = t1 }\nand for all a \u2208 A \\ {0} we have k \u2208 Rext(a0t1 \u22121 ) if and only if k = 0 or the both following\nconditions are satisfied:\n(i) z(k) = a \u2212 1 or y(k) = a \u2212 1,\n(ii) tk = t1 \u2212 1 or k = m and tm+p = t1 \u2212 1.\nThe intersection of Rext(00t1 \u22121 ) and Rext(a0t1 \u22121 ) is not empty if and only if a = z and\nt = t1 \u2212 1, in other words, if and only if 0t1 \u22121 is a prefix of 0t m what is a LS factor having\njust two left extensions 0 and z.\nSimilarly, we can prove that the k-th max-f -image of 0t1 \u22121 is (gLk (0, a))-maximal factor\nfor all a \u2208 A \\ {0, z}. Also similarly, the k-th max-f -image of 0t1 \u22121 , namely\n\u03c6k\u03b2 (0t1 \u22121 )\u03c6k\u03b2 (1)(k + 1)\u22121 ,\nis (gLk (0, z))-maximal if it is not prefix of the LS factor\n\u03c6k\u03b2 (0t m) = \u03c6k\u03b2 (0t )\u03c6k\u03b2 (m)\nhaving the left extensions gLk (0, z). The proof then follows from Lemma 29 part (i) and\nLemma 43 applied on \u03c6k\u03b2 (1) and \u03c6k\u03b2 (m).\n\n21\n\n\fTaking into account Lemmas 31 and 47, one can prove the following corollary using analogous techniques as in the proof of the previous one. Note that Rext(`0 0) = {k \u2208 A | z(k \u22121) =\n`0 \u2212 1 or y(k \u2212 1) = `0 \u2212 1} and Rext(a0) = {1} for all a > `0 , i.e., 0 is (`0 , `0 + z)-maximal\nif it is not a prefix of the `0 -th max-f -image of the factor (12) which reads\n\u22121\n0\n(1)(1 \u2295 (m + `0 ))\u22121 = \u03c6`\u03b20 (m)\u03c6m\n\u03c6`\u03b20 (m)\u03c6m+`\n\u03b2 (`0 + 1)(1 \u2295 (m + `0 )) .\n\u03b2\n\nCorollary 50. If t1 = 1, then the k-th max-f -image of 0 is (gLk (`0 , a + `0 ))-maximal factor\nfor all letters a > `0 , a 6= z and for all 0 \u2264 k < m \u2212 `0 .\nMoreover, k-th max-f -image of 0 is (gLk (`0 , z + `0 ))-maximal if k0 \u2265 `0 and k = k0 \u2212\n`0 , k0 \u2212 `0 + 1, . . . m \u2212 `0 , where k0 is defined by (15).\n\n6\n\nAffine complexity\n\nThe aim of the present section is to find the necessary and sufficient condition for the factor\ncomplexity of u\u03b2 being affine. In order the complexity to be affine, the first difference of\ncomplexity M C(n) must be constant. The following lemma says when M C(n) can change its\nvalue. The proof is an immediate consequence of (2).\nLemma 51. Let u be an infinite word over a finite alphabet.\n(i) If M C(n + 1) >M C(n), then the number of LS factor of length n + 1 is greater then the\nnumber of LS factor of length n.\n(ii) If M C(n + 1) <M C(n), then u contains (a, b)-maximal factor of length n for some letters\na and b.\nThat is, the complexity is affine if either u does not contain any (a, b)-maximal factor and\nall infinite LS branches have empty common prefix or if each (a, b)-maximal factor of length\nn is \"compensated\" by appearing of a \"new\" LS factor of length n + 1. Examples of the first\ncase are Arnoux-Rauzy words whose all LS factors are prefixes of unique infinite LS branch.\nAs for the latter case, appearing of a \"new\" LS factor of length n + 1 means there are a LS\nfactor v of length n and its right extensions c and d such that vc and vd are both LS, i.e v\nis the longest common prefix of two different LS factors \u2013 Cassaigne [9] call such LS factors\nstrong bispecial.\nSince u\u03b2 comprises always at least one (a, b)-maximal factor, each such (a, b)-maximal\nmust be as long as the longest common prefix of two different LS factors in order that the\ncomplexity may be affine. We will prove that it is possible only if the number of (a, b)-maximal\nfactors is finite, thus in the case of d\u03b2 (1) = t1 (0 * * * 0(t1 \u2212 1))\u03c9 .\nLemma 52. If k0 < m \u2212 1, where k0 is defined by (15), then the factor complexity of u\u03b2 is\nnot affine.\n\n22\n\n\fProof. If k0 < m \u2212 1, then the (k0 + 1)-th max-f -image, if t1 > 1, (resp. (k0 \u2212 `0 + 1)-th if\nt1 = 1) of 0t1 \u22121 (resp. 0) is gLk0 (0, z)-maximal. Consider the longest common prefix of the\nLS factor \u03c6k\u03b20 (0t m) having left extensions gLk0 (0, z) and of the infinite LS branch u\u03b2 , if p > 1,\nor of the LS factor \u03c6m\u22121\n(0t1 \u22121 ) with left extensions m \u2212 1 and m, if p = 1 (and so u\u03b2 i\n\u03b2\n\nnot an infinite LS branch). This factor equals \u03c6k\u03b20 (0t m)(m \u2295 k0 )\u22121 which is a prefix of the\n(k0 + 1)-th max-f -image (resp. (k0 \u2212 `0 + 1)-th if t1 = 1) of 0t1 \u22121 (resp. 0) and hence it is\nnot (a, b)-maximal for any distinct a, b \u2208 A. Overall, M C(n0 ) <M C(n0 + 1), where n0 is the\nlength of the factor \u03c6k\u03b20 (0t m)(m \u2295 k0 )\u22121 .\n\nLemma 53. If d\u03b2 (1) = t1 (0 * * * 0(t1 \u2212 1))\u03c9 , then the factor complexity of u\u03b2 is affine, namely\nC(n) = pn + 1, n \u2208 N.\nProof. In this case, t = t1 \u2212 1 and so k0 = 0 = m \u2212 1. Hence, the (0, a)-maximal factor\n0t1 \u22121 is at the same time the longest common prefix of the only infinite LS branches u\u03b2\nand 0t m\u03c6\u03b2 (0t m)\u03c62\u03b2 (0t m) * * * . But 0t1 \u22121 is the only (a, b)-maximal and prefixes of these two\ninfinite LS branches are the only LS factors of u\u03b2 , thus, the proof is complete.\nLemma 54. If \u03b2 \u2208 S and d\u03b2 (1) 6= t1 (0 * * * 0(t1 \u2212 1))\u03c9 , then the factor complexity of u\u03b2 is not\naffine.\nProof. In the case when p > 1, there are m + 1 infinite LS branches given by Proposition 37.\nLet us denote them by u0 = u\u03b2 , u1 , . . . , um and put\nn0 = max{|v| | v = lcp(ui , uj ), i 6= j, i, j = 0, 1, . . . , m}.\nP\nWe have M C(n) \u2265 #Lext(u0 ) \u2212 1 + m\nk=1 #Lext(uk ) \u2212 1 \u2265 p \u2212 1 + m for all n > n0 . Due to\nCorollary 48, we know that there exist infinitely many (gLk (0, z))-maximal factors, k = 0, 1, . . .,\nand hence there must exist a LS factor of length n1 > n0 which is not a prefix of any LS\nbranch and so M C(n1 ) > m + p \u2212 1 =M C(1).\nIn the case of p = 1, the proof is analogous. Only difference is that there are only m\ninfinite LS branches since u\u03b2 is not.\nRemark 55. For the word u\u03b2 with d\u03b2 (1) = t1 (0 * * * 0(t1 \u2212 1))\u03c9 we may easily describe all\nleft special factors. If the length of the period p > 1, each LS factor is a prefix of one of two\ninfinite LS branches u\u03b2 and 0\u22121 u\u03b2 . If p = 1, then u\u03b2 is not an infinite LS branch and so each\nLS factor is prefix of the unique infinite LS branch 0\u22121 u\u03b2 . Hence, we obtain the known result\nthat u\u03b2 is Sturmian if and only if d\u03b2 (1) = t1 (t1 \u2212 1)\u03c9 . We were pointed out by Christiane\nFrougny that numbers \u03b2 satisfying d\u03b2 (1) = t1 (0 * * * 0(t1 \u2212 1))\u03c9 are Pisot units. Such Parry\nnumber \u03b2 is a root of the polynomial xp+1 \u2212 t1 xp \u2212 x + 1.\nLemma 56. Let \u03b2 \u2208\n/ S and let k0 \u2265 m \u2212 1. Then the factor complexity of u\u03b2 is not affine.\n\n23\n\n\fProof. As shown in the proof of Lemma 52, the k-th max-f -image of 0t1 \u22121 (resp. 0 if t1 = 1),\nk = 0, 1, . . . , m \u2212 1, is not beginning in 0t m and it is equal to the longest prefixes of some two\nLS factors. In order that the complexity is affine, also all max-f -images of the factor (12)\nmust be as long as the longest prefixes of some two LS factors.\nLet t1 > 1. Then the factor (12) must be of the same length as the longest common prefix\nof u\u03b2 and m-th max-f -image of its own \u2013 remember that the longest common prefix of u\u03b2 and\nk-th max-f -image of (12) is the k-th max-f -image of 0t1 \u22121 for k = 0, 1, . . . , m \u2212 1. Formally,\nt1 \u22121\n|0t m\u03c6m\n1)(1 + m)\u22121 | =\n\u03b2 (0\n\nt\n2m t1 \u22121\nt\n\u22121\n= |lcp(u\u03b2 , \u03c6m\n1)(1 \u2295 (2m))\u22121 )| = |\u03c6m\n\u03b2 (0 m)\u03c6\u03b2 (0\n\u03b2 (0 m)(m \u2295 m) |\n\nt\nm t1 \u22121 1)|.\nwhich is never satisfied for |\u03c6m\n\u03b2 (0 m)| \u2264 |\u03c6\u03b2 (0\nLet t1 = 1. Following the same reasoning as for the case t1 > 1, a necessary condition for\nthe complexity to be affine is that the factor (12)\n\u22121\nm\u03c6m\n\u03b2 (1)(1 + m)\n\nmust be of the same length as the longest common prefix of the (m \u2212 `0 )-th max-f -image of\nits own and u\u03b2 , namely\n0\n0\n0\n|lcp(u\u03b2 , \u03c6m\u2212`\n(m)\u03c62m\u2212`\n(1)(1 \u2295 (2m \u2212 `0 ))\u22121 )| = |\u03c6m\u2212`\n(m)(m \u2295 (m \u2212 `0 ))\u22121 |\n\u03b2\n\u03b2\n\u03b2\n0\nwhich is never satisfied for |\u03c6m\u2212`\n(m)| \u2264 |\u03c6m\n\u03b2 (1)|.\n\u03b2\n\nPutting all lemmas of this section together, we obtain the main theorem of this paper.\nTheorem 57. Let \u03b2 be a non-simple Parry number. The factor complexity of u\u03b2 is affine if\nand only if d\u03b2 (1) = t1 (0 * * * 0(t1 \u2212 1))\u03c9 .\n\n7\n\nConclusion\n\nAmong infinite words u\u03b2 associated with Parry numbers we may identify Arnoux-Rauzy\nwords. An infinite word is said to be Arnoux-Rauzy of order `, if for any length n \u2208 N\nthere exists exactly one left special factor and one right special factor both of length n and,\nmoreover, these special factors have just ` left and ` right extensions respectively. ArnouxRauzy words can be considered as a natural generalization of Sturmian words to more letter\nalphabets.\nIs is easy to see that only Sturmian words among u\u03b2 correspond to \u03b2 with d\u03b2 (1) = t1 1\nor d\u03b2 (1) = t1 (t1 \u2212 1)\u03c9 . The word u\u03b2 is an Arnoux-Rauzy word of order m \u2265 3 if and only\nif d\u03b2 (1) = tm\u22121\n1. It means that there is no Arnoux-Rauzy word over more letter alphabet\n1\nassociated with non-simple Parry number. A direct consequence of the definition of ArnouxRauzy words is that the complexity of Arnoux-Rauzy word is affine and that any left (right)\nspecial factor is a prefix of an infinite left (right) special branch.\n\n24\n\n\fIn the previous section, we have proved that the infinite word u\u03b2 associated with a nonsimple Parry number \u03b2 has the affine complexity if and only if d\u03b2 (1) = t1 (0 * * * 0(t1 \u2212 1))\u03c9 . In\nfact, we have proved that the complexity is affine if and only if any left special factor of u\u03b2\nis a prefix of an infinite left special branch. The validity of the same statement for infinite\nwords associated with simple Parry numbers is proven in [4]. However, this equivalency is not\na general rule for the factor complexity of fixed points of primitive morphisms. For a counter\nexample see [10] and [13].\nIt is known that Sturmian words have many equivalent definitions, see [7] for more. In\n2001 Vuillon [28] showed that a binary infinite word is Sturmian if and only if each its factor\nhas exactly two return words. In the article [27] Vuillon introduced the property R` : an\ninfinite word satisfies the property R` if each its factor has exactly ` return words. Therefore,\nwords with R` can be considered as another generalization of Sturmian words. In [17] Justin\nand Vuillon proved that Arnoux-Rauzy words of order ` have the property R` . Applying\nTheorem 4.5 of [2], we see that all u\u03b2 with affine complexity have also the property R` .\n\nAcknowledgement\nWe thank Christiane Frougny for many fruitful discussions. We acknowledge financial support\nby the grants MSM6840770039 and LC06002 of the Ministry of Education, Youth, and Sports\nof the Czech Republic.\n\nReferences\n[1] S. Akiyama, C. Frougny, and J. Sakarovitch. Powers of rationals modulo 1 and rational\nbase number systems. Isral J. Math, 168:53\u201391, 2008.\n[2] L. Balkov\u00e1, E. Pelantov\u00e1, and W. Steiner. Sequences with constant number of return\nwords. Monatshefte fr Mathematik, 2008.\n[3] D. Barache, B. Champagne, and J.-P. Gazeau. Quasicrystals and discrete geometry, chapter Pisot-cyclotomic quasilattices and their symmetry semigroups, pages 15\u201366. Amer.\nMath. Soc., 1998.\n[4] J. Bernat, Z. Mas\u00e1kov\u00e1, and E. Pelantov\u00e1. On a class of infinite words with affine factor\ncomplexity. Theoretical Computer Science, 389(1-2):12\u201325, 2007.\n[5] J. Berstel. Mots de Fibonacci. S\u00e9minaire d'informatique th\u00e9orique, LITP, Paris, Ann\u00e9e\n1980/81, 57-78.\n[6] J. Berstel. Properties of infinite words: recent results. In Proceedings of the 6th Annual\nSymposium on Theoretical Aspects of Computer Science on STACS 89, pages 36\u201346, New\nYork, NY, USA, 1989. Springer-Verlag New York, Inc.\n\n25\n\n\f[7] J. Berstel. Sturmian and episturmian words: A survey of some recent results. Lecture\nnotes in computer science, 4728:23\u201347, 2007.\n[8] J. Cassaigne. Special factors of sequences with linear subword complexity. In Developments in Language Theory II, pages 25\u201334. World Scientific, 1996.\n[9] J. Cassaigne. Complexit\u00e9 et facteurs sp\u00e9ciaux. Bull. Belg. Math. Soc. Simon Stevin,\n4:67\u201388, 1997.\n[10] R. V. Chacon. Weakly mixing transformations which are not strongly mixing. Proceedings\nof the American Mathematical Society, 22(3):559\u2013562, 1969.\n[11] A. de Luca and S. Varricchio. On the factors of the Thue-Morse word on three symbols.\nInf. Process. Lett., 27(6):281\u2013285, 1988.\n[12] S. Fabre. Substitutions et beta-syst\u00e8mes de num\u00e9ration. Theoretical Computer Science,\n137:219\u2013236, 1995.\n[13] S. Ferenczi. Les transformations de Chacon : combinatoire, structure g\u00e9om\u00e9trique, lien\navec les syst\u00e8mes de complexit\u00e9 2n + 1. Bulletin de la Soci\u00e9t\u00e9 Math\u00e9matique de France,\n123(2):271\u2013292, 1995.\n[14] C. Frougny, J.-P. Gazeau, and R. Krejcar. Additive and multiplicative properties of point\nsets based on beta-integers. Theor. Comput. Sci., 303(2-3):491\u2013516, 2003.\n[15] C. Frougny, Z. Mas\u00e1kov\u00e1, and E. Pelantov\u00e1. Complexity of infinite words associated\nwith beta-expansions. Theoretical Informatics and Applications, 38:163\u2013185, 2004.\n[16] C. Frougny, Z. Mas\u00e1kov\u00e1, and E. Pelantov\u00e1. Infinite special branches in words associated\nwith beta-expansions. Discrete Math. Theor. Comput. Sci., 9:125\u2013144, 2007.\n[17] J. Justin and L. Vuillon. Return words in Sturmian and episturmian words. TIA, 34:343\u2013\n356, 2000.\n[18] D. K\u00f6nig. Theorie der endlichen und unendlichen Graphen. Akademische Verlagsgesellschaft, Leipzig, 1936.\n[19] Z. Mas\u00e1kov\u00e1, J. Patera, and J. Zich. Classification of voronoi and delone tiles in quasicrystals: I. general method. J. Phys. A: Math. Gen., 16:1869\u20131894, 2003.\n[20] R. V. Moody and J. Patera. Quasicrystals and icosians. J. Phys. A: Math. Gen., 26:2829\u2013\n2853, 1993.\n[21] B. Moss\u00e9. Notions de reconnaissabilit\u00e9 pour les substitutions et complexit\u00e9 des suites\nautomatiques. Bull. Soc. Math. France, 124:101\u2013108, 1996.\n[22] W. Parry. On the \u03b2-expansions of real numbers. Acta Math. Acad. Sci. Hunger., 11:401\u2013\n416, 1960.\n\n26\n\n\f[23] M. Queff\u00e9lec. Substitution dynamical systems\u2013spectral analysis, volume 1284 of Lecture\nNotes in Mathematics. Springer-Verlag, Berlin, 1987.\n[24] A. R\u00e9nyi. Representations for real numbers and their ergodic properties. Acta Math.\nAcad. Sci. Hungar., 8:477\u2013493, 1957.\n[25] D. Shechtman, I. Blech, D. Gratias, and J. W. Cahn. Metallic phase with long-range\norientational order and no translational symmetry. Phys. Rev. Lett., 53(20):1951\u20131953,\nNov 1984.\n[26] W. Thurston. Groups, tilings and finite state automata. AMS Colloquium Lecture Notes,\n1989.\n[27] L. Vuillon. On the number of return words in infinite words with complexity 2n + 1.\nTechnical Report 15, LIAFA, 2000.\n[28] L. Vuillon. A characterization of Sturmian words by return words. Eur. J. Comb.,\n22:263\u2013275, 2001.\n\n27\n\n\f"}