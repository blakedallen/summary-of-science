{"id": "http://arxiv.org/abs/1001.3628v1", "guidislink": true, "updated": "2010-01-20T16:08:13Z", "updated_parsed": [2010, 1, 20, 16, 8, 13, 2, 20, 0], "published": "2010-01-20T16:08:13Z", "published_parsed": [2010, 1, 20, 16, 8, 13, 2, 20, 0], "title": "Asymptotic enumeration and limit laws for graphs of fixed genus", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1001.4645%2C1001.5146%2C1001.1142%2C1001.2495%2C1001.4944%2C1001.1639%2C1001.0054%2C1001.2731%2C1001.2032%2C1001.5427%2C1001.1106%2C1001.1192%2C1001.3934%2C1001.2536%2C1001.0427%2C1001.2199%2C1001.0404%2C1001.3741%2C1001.4891%2C1001.1816%2C1001.4638%2C1001.5214%2C1001.2522%2C1001.3409%2C1001.2428%2C1001.1837%2C1001.2148%2C1001.1058%2C1001.3976%2C1001.5037%2C1001.1417%2C1001.4627%2C1001.3764%2C1001.1684%2C1001.2180%2C1001.0878%2C1001.3279%2C1001.3455%2C1001.2296%2C1001.5204%2C1001.3793%2C1001.3288%2C1001.2060%2C1001.2861%2C1001.2399%2C1001.1403%2C1001.4296%2C1001.4426%2C1001.1309%2C1001.4669%2C1001.0469%2C1001.3005%2C1001.3749%2C1001.2246%2C1001.3621%2C1001.1707%2C1001.3536%2C1001.1188%2C1001.5257%2C1001.2213%2C1001.0710%2C1001.3020%2C1001.1176%2C1001.0088%2C1001.1943%2C1001.0193%2C1001.1122%2C1001.1386%2C1001.3298%2C1001.3684%2C1001.3384%2C1001.3805%2C1001.1236%2C1001.0271%2C1001.3628%2C1001.3871%2C1001.3443%2C1001.3898%2C1001.4626%2C1001.2830%2C1001.2195%2C1001.0719%2C1001.3933%2C1001.0673%2C1001.0350%2C1001.0677%2C1001.1901%2C1001.2043%2C1001.4315%2C1001.1656%2C1001.2938%2C1001.3088%2C1001.5144%2C1001.4263%2C1001.3403%2C1001.1983%2C1001.0529%2C1001.5099%2C1001.4319%2C1001.3635%2C1001.1910&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Asymptotic enumeration and limit laws for graphs of fixed genus"}, "summary": "It is shown that the number of labelled graphs with n vertices that can be\nembedded in the orientable surface S_g of genus g grows asymptotically like\n$c^{(g)}n^{5(g-1)/2-1}\\gamma^n n!$ where $c^{(g)}>0$, and $\\gamma \\approx\n27.23$ is the exponential growth rate of planar graphs. This generalizes the\nresult for the planar case g=0, obtained by Gimenez and Noy.\n  An analogous result for non-orientable surfaces is obtained. In addition, it\nis proved that several parameters of interest behave asymptotically as in the\nplanar case. It follows, in particular, that a random graph embeddable in S_g\nhas a unique 2-connected component of linear size with high probability.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1001.4645%2C1001.5146%2C1001.1142%2C1001.2495%2C1001.4944%2C1001.1639%2C1001.0054%2C1001.2731%2C1001.2032%2C1001.5427%2C1001.1106%2C1001.1192%2C1001.3934%2C1001.2536%2C1001.0427%2C1001.2199%2C1001.0404%2C1001.3741%2C1001.4891%2C1001.1816%2C1001.4638%2C1001.5214%2C1001.2522%2C1001.3409%2C1001.2428%2C1001.1837%2C1001.2148%2C1001.1058%2C1001.3976%2C1001.5037%2C1001.1417%2C1001.4627%2C1001.3764%2C1001.1684%2C1001.2180%2C1001.0878%2C1001.3279%2C1001.3455%2C1001.2296%2C1001.5204%2C1001.3793%2C1001.3288%2C1001.2060%2C1001.2861%2C1001.2399%2C1001.1403%2C1001.4296%2C1001.4426%2C1001.1309%2C1001.4669%2C1001.0469%2C1001.3005%2C1001.3749%2C1001.2246%2C1001.3621%2C1001.1707%2C1001.3536%2C1001.1188%2C1001.5257%2C1001.2213%2C1001.0710%2C1001.3020%2C1001.1176%2C1001.0088%2C1001.1943%2C1001.0193%2C1001.1122%2C1001.1386%2C1001.3298%2C1001.3684%2C1001.3384%2C1001.3805%2C1001.1236%2C1001.0271%2C1001.3628%2C1001.3871%2C1001.3443%2C1001.3898%2C1001.4626%2C1001.2830%2C1001.2195%2C1001.0719%2C1001.3933%2C1001.0673%2C1001.0350%2C1001.0677%2C1001.1901%2C1001.2043%2C1001.4315%2C1001.1656%2C1001.2938%2C1001.3088%2C1001.5144%2C1001.4263%2C1001.3403%2C1001.1983%2C1001.0529%2C1001.5099%2C1001.4319%2C1001.3635%2C1001.1910&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "It is shown that the number of labelled graphs with n vertices that can be\nembedded in the orientable surface S_g of genus g grows asymptotically like\n$c^{(g)}n^{5(g-1)/2-1}\\gamma^n n!$ where $c^{(g)}>0$, and $\\gamma \\approx\n27.23$ is the exponential growth rate of planar graphs. This generalizes the\nresult for the planar case g=0, obtained by Gimenez and Noy.\n  An analogous result for non-orientable surfaces is obtained. In addition, it\nis proved that several parameters of interest behave asymptotically as in the\nplanar case. It follows, in particular, that a random graph embeddable in S_g\nhas a unique 2-connected component of linear size with high probability."}, "authors": ["Guillaume Chapuy", "Eric Fusy", "Omer Gimenez", "Bojan Mohar", "Marc Noy"], "author_detail": {"name": "Marc Noy"}, "author": "Marc Noy", "links": [{"href": "http://arxiv.org/abs/1001.3628v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1001.3628v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1001.3628v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1001.3628v1", "arxiv_comment": null, "journal_reference": "Journal of Combinatorial Theory, Series A, 118(3):748-777 (2011)", "doi": null, "fulltext": "arXiv:1001.3628v1 [math.CO] 20 Jan 2010\n\nAsymptotic enumeration and limit laws for graphs of fixed genus\nGuillaume Chapuy\u2217\n\n\u00c9ric Fusy\n\nDepartment of Mathematics\nSimon Fraser University\nBurnaby, B.C. V5A 1S6, Canada\ngchapuy@sfu.ca\n\nLaboratoire d'Informatique\n\u00c9cole Polytechnique\n91128 Palaiseau Cedex, France\nfusy@lix.polytechnique.fr\n\nOmer Gim\u00e9nez\n\nBojan Mohar\u2020\u2021\n\nDept. de Llenguatges i Sistemes Inform\u00e0tics\nUniversitat Polit\u00e8cnica de Catalunya\nJordi Girona, 1-3\n08034 Barcelona, SPAIN\nomer.gimenez@gmail.com\n\nDepartment of Mathematics\nSimon Fraser University\nBurnaby, B.C. V5A 1S6, Canada\nmohar@sfu.ca\n\nMarc Noy\nDepartament de Matem\u00e0tica Aplicada II\nUniversitat Polit\u00e8cnica de Catalunya\nJordi Girona 1-3\n08034 Barcelona, Spain\nmarc.noy@upc.edu\n\nOctober 31, 2018\n\nAbstract\nIt is shown that the number of labelled graphs with n vertices that can be embedded in the\norientable surface Sg of genus g grows asymptotically like\nc(g) n5(g\u22121)/2\u22121 \u03b3 n n!\nwhere c(g) > 0, and \u03b3 \u2248 27.23 is the exponential growth rate of planar graphs. This generalizes\nthe result for the planar case g = 0, obtained by Gim\u00e9nez and Noy.\nAn analogous result for non-orientable surfaces is obtained. In addition, it is proved that\nseveral parameters of interest behave asymptotically as in the planar case. It follows, in particular, that a random graph embeddable in Sg has a unique 2-connected component of linear size\nwith high probability.\n\u2217\n\nSupported by a CNRS/PIMS postdoctoral fellowship. Partial support from the European Grant ERC StG 208471\n\u2013 ExploreMaps\n\u2020\nSupported in part by the Research Grant P1\u20130297 (Slovenia), by an NSERC Discovery Grant (Canada) and by\nthe Canada Research Chair program.\n\u2021\nOn leave from: IMFM & FMF, Department of Mathematics, University of Ljubljana, Ljubljana, Slovenia.\n\n1\n\n\f1\n\nIntroduction and statement of main results\n\nIt has been shown by Gim\u00e9nez and Noy [20] that the number of planar graphs with n labelled\nvertices grows asymptotically as\nc * n\u22127/2 \u03b3 n n!\nwhere c > 0 and \u03b3 \u2248 27.23 are well defined analytic constants. Since planar graphs are precisely\nthose that can be embedded in the sphere, it is natural to ask about the number of graphs that\ncan be embedded in a given surface.\nIn what follows, graphs are simple and labelled with V = {1, 2, . . . , n}, so that isomorphic\ngraphs are considered different unless they have exactly the same edges. Let Sg be the orientable\n(g)\nsurface of genus g, that is, a sphere with g handles, and let an be the number of graphs with n\nvertices embeddable in Sg . A first approximation to the magnitude of these numbers was given by\nMcDiarmid [27], who showed that\n!\n(g) 1/n\nan\n= \u03b3.\nlim\nn\u2192\u221e\nn!\n(g)\n\nThis establishes the exponential growth of the an , which is the same as for planar graphs and does\nnot depend on the genus.\nIn this paper we provide a considerable refinement and obtain a sharp estimate, showing how\nthe genus comes into play in the subexponential growth. In the next statements, \u03b3 is the exponential\ngrowth rate of planar graphs, and \u03b3\u03bc is the exponential growth rate of planar graphs with n vertices\nand \u230a\u03bcn\u230b edges. Both \u03b3 and the function \u03b3\u03bc are determined analytically in [20].\n(g)\n\nTheorem 1.1. For g \u2265 0, the number an of graphs with n vertices that can be embedded in the\norientable surface Sg of genus g satisfies\nan(g) \u223c c(g) n5(g\u22121)/2\u22121 \u03b3 n n!\n\n(1)\n\nwhere c(g) is a positive constant and \u03b3 is as before.\n(g)\nFor \u03bc \u2208 (1, 3), the number an,m of graphs with n vertices and m = \u230a\u03bcn\u230b edges that can be\nembedded in Sg satisfies\n(g)\nan,m\n\u223c c\u03bc(g) n5g/2\u22124 (\u03b3\u03bc )n n! when n \u2192 \u221e,\n(g)\n\nwhere c\u03bc is a positive constant and \u03b3\u03bc is as before.\nWe also prove an analogous result for non-orientable surfaces. Let Nh be the non-orientable\nsurface of genus h, that is, a sphere with h crosscaps.\n(h)\n\nTheorem 1.2. For h \u2265 1, the number bn of graphs with n vertices that can be embedded in the\nnon-orientable surface Nh of genus h satisfies\nbn(h) \u223c c\u0303(h) n5(h\u22122)/4\u22121 \u03b3 n n!\nwhere c\u0303(h) is a positive constant and \u03b3 is as before.\n\n2\n\n\f(h)\n\nFor \u03bc \u2208 (1, 3), the number bn,m of graphs with n vertices and m = \u230a\u03bcn\u230b edges that can be\nembedded in Nh satisfies\n(h)\nbn,m\n\u223c c\u0303\u03bc(h) n5h/4\u22124 (\u03b3\u03bc )n n! when n \u2192 \u221e,\n(h)\n\nwhere c\u0303\u03bc is a positive constant and \u03b3\u03bc is as before.\nIn theory, the constants c(g) can be computed via non-linear recursions. Indeed, our computations relate c(g) to the asymptotic number of maps embedded on the surface Sg , and weighted by\ntheir number of vertices, which are shown to obey such recursions in [6]. However, these recursions\nare so intricate that in practice is not easy to compute even the first few of these numbers. The same\nis true for the numbers c\u0303(h) . The case \u03bc < 1 of the above theorems has been treated in the planar\ncase in [19], and gives results of a different nature. Also, it was shown in [20] that lim\u03bc\u21923\u2212 \u03b3\u03bc = 256\n27 ,\nwhich is the exponential growth rate of triangulations embedded on a fixed surface.\nThere are three main ingredients in our proof. The first one is the theory of map enumeration,\nstarted by Tutte in his pioneering work on planar maps, and extended later by Arqu\u00e8s, Bender,\nCanfield, Gao, Richmond, Wormald, and others to arbitrary surfaces. Our main references in this\ncontext are [5], [6] and [9]. In particular, Bender and Canfield [5] showed that the number of rooted\nmaps with n edges embeddable in Sg grows asymptotically as\ntg n5(g\u22121)/2 12n ,\nfor some constant tg > 0. If we compare it with Estimate (1) in Theorem 1.1, we see that they are\nvery similar. This is no coincidence, since our counting of graphs relies in a fundamental way on\nthe counting of maps (the extra factor of n in the estimate occurs because maps are rooted, and\nthe absence of a factorial term is because they are unlabelled).\nThe second ingredient is topological graph theory, in particular the concept of face-width, which\nmeasures in some sense the local planarity of an embedding of a graph in a surface. According\nto Whitney's theorem, planar 3-connected graphs have a unique embedding in the sphere, but\nthis is not true for arbitrary surfaces. The key result is that a 3-connected graph with large\nenough face-width has a unique embedding [25]. It turns out that almost all 3-connected graphs\nhave large face-width and, as a consequence, the asymptotic enumeration of 3-connected graphs\nin a surface can be reduced to the enumeration of 3-connected maps. In order to enumerate 3connected maps of genus g we start from the known enumeration of maps of genus g [5, 6] via\nassociated quadrangulations.\nThe final step is to go from 3-connected graphs in a surface to 2-connected, connected and\nfinally arbitrary graphs. Again, the face-width plays the main role in this reduction. A result of\nRobertson and Vitray [28] says that if a connected graph G of genus g has face-width at least two,\nthen G has a unique block of genus g and the remaining blocks are planar. A similar result holds for\n2-connected graphs and 3-connected components. As a consequence, the asymptotic enumeration\nof graphs of genus g can be reduced to the planar case, which was completely solved in [20].\nThere is a fundamental difference between the planar and non-planar cases. For planar graphs\nwe have at our disposal exact counting generating functions, defined through functional and differential equations [20]. The reason is precisely that 3-connected graphs have a unique embedding,\nand there is a bijection with 3-connected maps, for which we know the exact generating function. For higher surfaces this is not the case and we have to approximate the counting series. If\n3\n\n\ff (x) is the generating function of interest, we find series f1 (x) and f2 (x) that are computable and\nwhose coefficients have the same leading asymptotic estimates, and such that f1 (x) dominates f (x)\ncoefficient-wise from below, and f2 (x) from above. If we can estimate the coefficients of the fi (x),\nthen we can estimate those of f (x). A key argument in the proofs is the following. If a graph G of\ngenus g has a short non-contractible cycle C, then cutting G along C produces either a graph of\ngenus g \u2212 1, or two graphs whose genera add up to g. In either case, induction on the genus g shows\nthat there are few such graphs and that the probability of a graph having a short non-contractible\ncycle tends to zero as the size of the graph grows. This is precisely where approximate counting\nseries come into play.\nThe paper is structured as follows. Section 2 contains the analytic tools used in the paper.\nIn Section 3 we study the enumeration of a family of maps, near-irreducible quadrangulations,\nclosely related to 3-connected graphs. In order to prove our main results, we need a careful analysis\nof quadrangulations according to their face-width. The proof of Theorems 1.1 and 1.2 comes in\nSection 4, again using results on face-width. On the way, we also characterize the asymptotic\nnumber of 2-connected graphs of genus g (Theorem 4.6). In Section 5 we apply the machinery we\nhave developed to analyze random graphs of genus g.\nAfter we announced the result of Theorem 1.1 at the conferences AofA'09 and Random Graphs\nand Maps on Surfaces (Institut Henri Poincar\u00e9, 2009), E. Bender and Z. Gao informed us of their\nongoing project to address the same problem, with slightly different methods. They have recently\nissued a draft of their approach [7]. As far as we can tell, the main difference with our paper will\nbe in the way of handling the singular analysis of bivariate generating functions.\n\n2\n\nSingularity analysis\n\nIn our work singular expansions are expressed in terms both of square-roots and logarithms (indeed\nthe leading terms in the series counting graphs embeddable on the torus and on the Klein bottle\ninvolve logarithms).\nWe define a set D of ordered pairs of integers as follows:\nD = Z2 \\ {(2a, 0) ; a \u2208 Z}.\nLet f (x) be a series with non-negative coefficients and finite positive radius of convergence \u03c1. We\nuse throughout the following notations:\np\nX = 1 \u2212 x/\u03c1, L = ln(1 \u2212 x/\u03c1).\n\nMonomials of the form X a Lb , with (a, b) \u2208 D, are totally ordered as follows (essentially a lexico\u2032\n\u2032\ngraphic order): X a Lb < X a Lb if either a\u2032 < a or {a\u2032 = a, b\u2032 > b}. An expansion-series is a series\nh(X, L) of the form\nh(X, L) = X d e\nh(X, L),\nwhere d \u2208 Z, e\nh(X, L) is analytic at (0, 0), and e\nh(X, L) is of the form h0 (X)+h1 (X)L+. . .+hc (X)Lc\n\n(i.e., a polynomial in L) with the hi 's analytic at 0. The type of h(X, L) is the largest (a, b) \u2208 D\nsuch that [X a Lb ]h(X, L) 6= 0.\nThe series f (x) is said to admit a singular expansion of type (a, b) \u2208 D if, in a complex\nneighbourhood of \u03c1 > 0 (except on x \u2212 \u03c1 \u2208 R+ ):\nf (x) = h(L, X),\n4\n\n(2)\n\n\fwhere h(L, X) is an expansion-series of type (a, b) (we also say of type X a Lb ). The singular\nexpansion is called strong if f (x) is analytically continuable to a complex domain of the form\n\u03a9 = {|x| \u2264 \u03c1 + \u03b4}\\{x \u2212 \u03c1 \u2208 R+ } for some \u03b4 > 0. We consider mostly singular expansions of type\nX a , with a \u2208 Z\\(2Z\u22650 ) -such singular expansion are called of order a/2- and singular expansions\nof type X 2a L, with a \u2208 Z\u22650 -called of order a. In particular, if the order is 0, a singular expansion\nhas L as leading monomial. With this definition, the order \u03b1 can take values that are either integers\nor half-integers (nonnegative or negative), which we write as \u03b1 \u2208 12 Z.\nFrom a singular expansion of a series f (x) one can obtain automatically an asymptotic estimate\nfor the coefficients [xn ]f (x).\nTheorem 2.1 (Transfer theorem [16]). Let f (x) be a series with non-negative coefficients that\nadmits a strong singular expansion of order \u03b1 around its radius of convergence \u03c1 > 0. Then\nfn = [xn ]f (x) satisfies\nfn \u223c c \u03c1\u2212n n\u2212\u03b1\u22121 ,\nwhere c depends explicitly on the \"dominating\" coefficient of the expansion-series h(X, L).\nLet us now extend the concept to a bivariate series f (x, u) with non-negative coefficients. For\nu > 0, let \u03c1(u) be the radius of convergence of x 7\u2192 f (x, u). The function \u03c1(u) is called the\nsingularity function of f (x, u) with respect to x, and each point (x0 , u0 ) such that x0 = \u03c1(u0 ) is\ncalled a singular point of f (x, u). We use the notations\np\nX = 1 \u2212 x/\u03c1(u), L = ln(1 \u2212 x/\u03c1(u)), U = u \u2212 u0 .\nA trivariate series h(X, L, U ) is called an expansion series if it is of the form\nh(X, L, U ) = X d e\nh(X, L, U ),\n\nwith d \u2208 Z, e\nh(X, L, U ) analytic at (0, 0, 0) and of polynomial dependence in L, that is, e\nh(X, L, U )\nc\nis of the form h0 (X, U ) + h1 (X, U )L + . . . + hc (X, U )L , with the hi 's analytic at (0, 0). If there is\n\u2032\n\u2032\nsome (a, b) \u2208 D such that [X a Lb ]h(X, L, U ) is non-zero at U = 0 and [X a Lb ]h(X, L, U ) = 0 for\n(a\u2032 , b\u2032 ) > (a, b), then the expansion series is said to be of type (a, b).\nLet (x0 , u0 ) be a singular point of f (x, u) such that \u03c1\u2032 (u0 ) 6= 0 and such that \u03c1(u) is analytically\ncontinuable to a complex neighbourhood of u0 . Then f (x, u) is said to admit a singular expansion\nof type (a, b) \u2208 D, or of type X a Lb , if in a complex neighbourhood of (x0 , u0 ) (except on the set\n1 \u2212 x/\u03c1(u) \u2208 R\u22640 ) we have\nf (x, u) = h(X, L, U ),\n(3)\nwhere h(X, L, U ) is an expansion series of type (a, b). The singular expansion is called strong\nif f (x, u) is analytically continuable to a complex domain of the form \u03a9 = {|x| \u2264 x0 + \u03b4, |u| \u2264\nu0 + \u03b4}\\{1 \u2212 x/\u03c1(u) \u2208 R\u22640 } for some \u03b4 > 0. Again we consider mostly singular expansions of\ntype X a , with a \u2208 Z\\(2Z\u22650 ) -called of order a/2- and singular expansions of type X 2a L, with\na \u2208 Z\u22650 -called of order a. A singular expansion is called log-free if h does not involve L, that is,\n\u2202L h(X, L, U ) = 0. Singular expansions of order 1/2 are called square-root singular expansions.\nAt some points we will need the following easy lemma:\nLemma 2.2. If two series f (x, u), g(x, u) with non-negative coefficients admit singular expansions\nof orders \u03b1 \u2264 \u03b1\u2032 around (x0 , u0 ), then the product-series h(x, u) = f (x, u)*g(x, u) admits a singular\nexpansion at (x0 , u0 ),\n5\n\n\f\u2022 of order \u03b1 + \u03b1\u2032 if \u03b1 < 0 and \u03b1\u2032 < 0,\n\u2022 of order \u03b1 if \u03b1 < 0 < \u03b1\u2032 .\nRemark. Our definition of singular expansions may seem a bit technical, but it meets the following convenient requirements: they are closed under derivation and integration (see\np Lemma 2.5 in\nthis section), closed under product, and they include the basic singular functions 1 \u2212 x/\u03c1 which\ntypically appear in series counting maps, and ln(1 \u2212 x/\u03c1) which appear in series counting unrooted\ngraphs in the torus and in the Klein bottle.\nFrom bivariate singular expansions, it is possible to get asymptotic estimates for the coefficient\nfn = [xn ]f (x, 1), (just apply Theorem 2.1 to f (x, 1)), but also to get asymptotic estimates according\nto two parameters.\nP\nTheorem 2.3 (Local limit theorem [16]). Suppose that f (x, u) = n,m fn,m xn um admits a strong\nsingular expansion of order \u03b1 around each singular point (\u03c1(u0 ), u0 ), and let \u03c1(u) be the singularity\nfunction of f (x, u). Suppose that the function \u03bc(u) = \u2212u\u03c1\u2032 (u)/\u03c1(u) is strictly increasing, and define\na = \u03bc(0+ ), b = limu\u2192\u221e \u03bc(u). For each \u03bc \u2208 (a, b), let u0 be the positive value such that \u03bc(u0 ) = \u03bc,\nand let \u03b3(\u03bc) = 1/\u03c1(u0 ). Then there exists a constant c(\u03bc) > 0 such that\nfn,m \u223c c(\u03bc) n\u2212\u03b1\u22123/2 \u03b3(\u03bc)n when n \u2192 \u221e and m = \u230a\u03bcn\u230b.\nLemma 2.4 (Exchange of variables, from [14]). With f (x, u) and \u03c1(u) as in the previous lemma,\nassume (x0 , u0 ) is a singular point and \u03c1\u2032 (u0 ) 6= 0.\nIf f (x, u) admits a singular expansion of order \u03b1 around (x0 , u0 ) with leading variable x, then\nf (x, u) also admits a singular expansion of order \u03b1 around (x0 , u0 ) with leading variable u. In\naddition, if the singular expansion in x is strong, then the singular expansion in u is also strong.\nSketch of proof. Let R(x) be the local inverse of \u03c1(u) at u0 . Then, by the Weierstrass preparation\ntheorem, there exists Q(x, u) analytic at (x0 , u0 ), with Q(x0 , u0 ) 6= 0, such that x \u2212 \u03c1(u) = (u \u2212\nR(x)) * Q(x, u) in a neighbourhood of (x0 , u0 ). Replacing x \u2212 \u03c1(u) by (u \u2212 R(x))Q(x, u) and\nrearranging terms, one obtains a singular expansion with leading variable u; and this singular\nexpansion is strong if the one in x is strong (indeed, by definition, the domain \u03a9 of analytic\ncontinuation required by strong expansions is symmetric in x and u).\nBy Lemma 2.4, we can omit to mention which is the leading variable in a singular expansion, since\nthe other variable could be chosen as well.\nWe need the following two technical lemmas to manipulate singular expansions.\nLemma 2.5 (Derivation and integration, from [14]). Let f (x, u) be a series that admits a singular\nexpansion of\nexpansion of order \u03b1 \u2208 12 Z around (x0 , u0 ). Then the series \u2202f\n\u2202x (x, u) admits a singular\nRx\norder \u03b1 \u2212 1 around (x0 , u0 ) with the same singularity function; and the series 0 f (s, u)ds admits\na singular expansion of order \u03b1 + 1 around (x0 , u0 ) with the same singularity function.\nRx\nMoreover, if the expansion of f (x, u) is strong, then so are the ones of \u2202f\n\u2202x (x, u) and 0 f (s, u)ds.\np\nProof. We use again the notations X = 1 \u2212 x/\u03c1(u), L = ln(1 \u2212 x/\u03c1(u)). The main point is that,\nfor a \u2208 2Z>0 , \u2202x X a L has dominating monomial X a\u22122 L, \u2202x L has dominating monomial X \u22122 , and\nfor a \u2208 Z\\2Z\u22650 , \u2202x X a has dominating monomial X a\u22122 . We refer the reader to [14] for a detailed\nproof in the case of a square-root singular expansion, the arguments of which can be extended\ndirectly to any order.\n6\n\n\fLemma 2.6 (Critical composition schemes). Let M (x, u), H(x, u), C(t, u) be non-zero series with\nnon-negative coefficients linked by the equation\nM (x, u) = C(H(x, u), u).\nAssume that H(x, u) has a log-free strong singular expansion of order 3/2 around (x0 , u0 ), and\nlet \u03c1(u) be the singularity function of H(x, u). Assume also that C(t, u) has a strong singular\nexpansion of order \u03b1 \u2264 0 at (t0 , u0 ), with t0 = H(x0 , u0 ), and the singularity function R(u) of\nC(t, u) coincides with H(\u03c1(u), u) (this means that the composition is critical).\nThen M (x, u) has a strong singular expansion of order \u03b1 around (x0 , u0 ) with singularity function \u03c1(u).\nProof. Since C(t, u) has a singular expansion of order \u03b1 around (t0 , u0 ), the series M (x, u) =\nC(H(x, u), u) has an expansion of the form\nM (x, u) = h(X, L, U ),\n\nwith t = H(x, u), T = 1 \u2212\n\n\u221a\nt\n, X = T , L = ln(T ), U = u \u2212 u0 ,\nR(u)\n\nwith h an expansion-series of type (2\u03b1, 0) if \u03b1 \u2208 12 Z\\Z\u22650 , or of type (2\u03b1, 1) if \u03b1 \u2208 Z\u22650 . Moreover,\nsince H(x, u) has a log-free singular expansion of order 3/2, we have\n\u221a\nx\n, X = Z,\nT = Z * \u03bb(X, U ), with Z = 1 \u2212\n\u03c1(u)\nwhere \u03bb(X, U ) is analytic and non-zero in a neighbourhood of (0, 0), which implies that X =\nX *\u03bc(X, U ) and L = L*\u03bd(X, U ) with \u03bc(X, U ) and \u03bd(X, U ) analytic and non-zero in a neighbourhood\nof (0, 0). Hence, by easy rearrangements, M (x, u) can be written as\n\u221a\nM (x, u) = h(X, L, U ), with X = Z, L = ln(Z), U = u \u2212 u0 ,\nwhere h(X, L, U ) is an expansion-series of the same type as h(X, L, U ).\nIt remains to prove that the singular expansion of M (x, u) is strong. For z \u2208 C and \u01eb > 0,\ndenote by B(z, \u01eb) the open ball of center z and radius \u01eb. Since M (x, u) has a singular expansion\naround (x0 , u0 ) and has nonnegative coefficients, M (x, u) is already analytically continuable to a\ndomain of the form D1 \u222a D2 , with\nD1 = {(x, u) \u2208 C2 : |x| < x0 , |u| < u0 },\nand\nD2 : {(x, u) \u2208 C2 : x \u2208 B(x0 , \u01eb), u \u2208 B(u0 , \u01eb), x \u2212 \u03c1(u) \u2208\n/ R+ },\nfor some \u01eb > 0. So we just have to show that M (x, u) is analytically continuable to the domain\nD3 = {(x, u) \u2208 C2 : x0 \u2264 |x| < x0 + \u03b4, u0 \u2264 |u| < u0 + \u03b4}\\(B(x0 , \u01eb) \u00d7 B(u0 , \u01eb)),\nfor some \u03b4 > 0 to be adjusted. Note that, for \u03b4 sufficiently small (compared to \u01eb), there exists\n\u03c6 > 0 such that, for (x, u) \u2208 D3 , the arguments of x and u are in (\u03c6, 2\u03c0 \u2212 \u03c6), that is, x and u are\naway from the positive real axis. Since H(x, u) has nonnegative coefficients, for \u03b4 small enough,\nwe have |H(x, u)| < t0 \u2212 \u03b7 for some \u03b7 > 0, where t0 = H(x0 , u0 )). Since C(t, u) has non-negative\ncoefficients, its singularity function R(u) satisfies R(u) \u2265 R(u0 + \u03b4) for |u| \u2264 u0 + \u03b4. Reducing\nagain \u03b4 so that R(u0 + \u03b4) > t0 \u2212 \u03b7/2, we conclude that |H(x, u)| < R(u) for (x, u) \u2208 D3 . Hence\nC(t, u) is analytic at (H(x, u), u), and so M (x, u) is analytic at any (x, u) \u2208 D3 .\n7\n\n\fWe need some further definitions. Given two series f1 and f2 in the same number of variables,\nwrite f1 \u0016 f2 if f2 \u2212 f1 has non-negative coefficients. A bivariate series f (x, u) is said to be of\napproximate-singular order \u03b1 at (x0 , u0 ) if there are two series D(x, u) and E(x, u) such that\nD(x, u) \u2212 E(x, u) \u0016 f (x, u) \u0016 D(x, u),\nwhere D(x, u) has a singular expansion of order \u03b1 and E(x, u) has a singular expansion of order\n\u03b2 > \u03b1 around (x0 , u0 ), and D(x, u) and E(x, u) have the same singularity function. This common\nsingularity function is called the singularity function of f (x, u). The function f (x, u) is said to be\nof strong approximate-singular order \u03b1 if the singular expansions of D(x, u) and E(x, u) are strong.\nSince the singular order of D(x, u) dominates the singular order of E(x, u), the asymptotic\nestimate of the coefficients of f (x, u) is dictated by the estimate of D(x, u), and we have the\nfollowing basic result.\nCorollary 2.7. Let f (x, u) be a series of strong approximate-singular order \u03b1 \u2208 21 Z around each\nsingular point of f (x, u), and let \u03c1(u) be the singularity function of f (x, u). Then fn = [xn ]f (x, 1)\nsatisfies\nfn \u223c c n\u2212\u03b1\u22121 \u03b3 n ,\nwhere c > 0 is a constant and \u03b3 = 1/\u03c1(1).\nAssume that \u03bc(u) = \u2212u\u03c1\u2032 (u)/\u03c1(u) is strictly increasing, and define a = \u03bc(0+ ), b = limu\u2192\u221e \u03bc(u).\nFor each \u03bc \u2208 (a, b), let u0 be the positive value such that \u03bc(u0 ) = \u03bc, and let \u03b3(\u03bc) = 1/\u03c1(u0 ). Then\nthere exists a constant c(\u03bc) > 0 such that\nfn,\u230a\u03bcn\u230b \u223c c(\u03bc) n\u2212\u03b1\u22123/2 \u03b3(\u03bc)n when n \u2192 \u221e.\nWe also have a corollary regarding approximate-singular orders of critical compositions. The\nfollowing result follows directly from Lemma 2.6, but notice that the statement is not the same,\nsince we are now dealing with approximate-singular orders (which is precisely what is needed later\non).\nCorollary 2.8. Let M (x, u), H(x, u), C(t, u) be non-zero series with non-negative coefficients\nlinked by the equation\nM (x, u) = C(H(x, u), u).\nAssume that H(x, u) has a log-free strong singular expansion of order 3/2 around (x0 , u0 ) -call\n\u03c1(u) the singularity function of H(x, u)-, C(t, u) is of strong approximate-singular order \u03b1 at\n(t0 , u0 ), with t0 = H(x0 , u0 ), and the singularity function R(u) of C(t, u) coincides with H(\u03c1(u), u)\n(the composition is critical).\nThen M (x, u) is of strong approximate-singular order \u03b1 around (x0 , u0 ) with singularity function \u03c1(u).\n\n3\n\nMaps of genus g via quadrangulations\n\nWe recall that a map is a graph G embedded in a surface S in such a way that the faces are\nhomeomorphic to topological disks. If S = Sg we say that the map is of genus g. We have a similar\ndefinition for the non-orientable surface Nh of genus h. Loops and multiple edges are allowed. A\nmap is rooted if it has a marked edge that is given a direction. If g = 0 (planar maps), the face\n8\n\n\fon the right of the root is called the outer face, and the other faces are called inner faces. Vertices\nand edges incident to the outer face are said to be outer vertices (edges, resp.), the other ones are\ncalled inner vertices (edges, resp.).\nIn this section we obtain the asymptotic enumeration of a family of maps Sg that is closely\nrelated to 3-connected graphs of genus g. To enumerate Sg we follow the scheme of Bender et\nal. [9], and use a classical correspondence between maps and quadrangulations (maps in which\nevery face has degree four). We decompose quadrangulations successively at contractible 2-cycles\nand then at contractible 4-cycles. Along this way we encounter near-simple and near-irreducible\nquadrangulations.\nHowever, in our treatment, quadrangulations are labelled at edges and are allowed to be unrooted (classically, in map enumeration maps are unlabelled and rooted). Since each rooted quadrangulation with 2n edges corresponds to exactly (2n \u2212 1)! labelled quadrangulations, the ordinary\ngenerating function of rooted objects is given by the derivative of the exponential generating function of the labelled ones. We believe this approach yields simplified decompositions and equations.\nNote that the corresponding generating functions have to be exponential to take into account the\nlabelling of the edges. Subsections 3.1 and 3.2 contain the basic concepts and definitions. In\nSubsection 3.3 we obtain singular expansions that are essential for the enumeration of graphs in\nSection 4.\n\n3.1\n\nMaps and quadrangulations, face-width and edge-width\n\nA map is bipartite if there is a partition of the vertices into black and white vertices such that\neach edge connects a black vertex with a white vertex. Whenever we work with bipartite maps we\nconsider the partition as given. A quadrangulation is a map such that all faces have degree four.\nIn this article we consider only bipartite quadrangulations. (Note that in positive genus not all\nquadrangulations are bipartite; for instance, a toroidal grid Cp \u00d7 Cq is a quadrangulation but it\nhas odd cycles if either p or q are odd.) Here, by a quadrangulation we always mean a bipartite\nquadrangulation.\nWe recall here a well-known correspondence, for any fixed genus g \u2265 0, between maps and\nquadrangulations. Given a map M , whose vertices are depicted as black, consider the following\noperations:\n\u2022 insert a white vertex in each face of M ,\n\u2022 for each corner \u03b8 of M , with v the incident vertex and f the incident face of \u03b8, insert an edge\nthat connects v to the white vertex corresponding to f . Such an edge is called a corner-edge.\nThe embedded graph Q consisting of all vertices (black and white) and of all corner-edges is a\n(bipartite) quadrangulation, which is called the quadrangulation of M . A correspondence between\nthe parameters of M and the parameters of Q is listed in the following table:\nM\ncorner\nedge\nvertex\nface\n\nQ\nedge\nface\nblack vertex\nwhite vertex\n\n9\n\n\fLet us now define the face-width and the edge-width of a map M in a surface S of genus\ng \u2265 0. The face-width fw(M ) of M is the minimum number of intersections of M with a simple\nnon-contractible curve C on S. It is easy to see that this minimum is achieved when C meets M\nonly at vertices. The edge-width ew(M ) of M is the minimum length of a non-contractible cycle\nof M . (For genus 0, the edge-width and the face-width are defined to be +\u221e since every curve is\ncontractible.) Let Q be the quadrangulation of M . Since a closed curve such that |C \u2229 M | = l\nyields a non-contractible cycle of Q of length 2l and vice versa, we have (see [25])\new(Q) = 2 fw(M ).\n\n3.2\n\n(4)\n\nFamilies of quadrangulations and links between them\n\nAgain, all quadrangulations are assumed to be bipartite. In addition, a quadrangulation is assumed\nto have its 2m edges labelled {1, 2, . . . , 2m}. This is not the standard procedure with maps but, as\nexplained earlier, in our context it is easier to work with unrooted maps, and in this case we must\nlabel the edges in order to avoid caring about automorphisms.\nA quadrangulation is called near-simple if it has no contractible 2-cycle, and is called simple\nif it has no 2-cycle at all, that is, no multiple edges. A quadrangulation is called near-irreducible\nif it is simple and every contractible 4-cycle delimits a face, and is called irreducible if it is simple\nand every 4-cycle delimits a face. Note that a near-simple quadrangulation Q is simple if and only\nif ew(Q) > 2, and a near-irreducible quadrangulation Q is irreducible if and only if ew(Q) > 4.\nFor g \u2265 0, the families of (bipartite) quadrangulations, near-simple quadrangulations, and nearirreducible quadrangulations of genus g are denoted, respectively, by Qg , Rg and Sg . If F is a\nfamily of quadrangulations with labelled edges, let F[n, m] be the set of elements in F with n black\nvertices and m faces, and let\nF (x, u) =\n\nX\nn,m\n\nF[n, m] xn\n\num\n.\n(2m)!\n\nIn other words, F (x, u) enumerates the family F according to black vertices and faces, and the\nfactor (2m)! in the denominator takes account of the fact that the 2m edges are labelled. We also\ndefine F \u2032 (x, u) as the series \u2202u F (x, u), that is, differentiation with respect to the second variable.\nLet us recall how one extracts, for g > 0, a near-simple core R \u2208 Rg from Q \u2208 Qg , and a nearirreducible core S \u2208 Sg from R \u2208 Rg , as described in [9]. The contractible 2-cycles of Q \u2208 Qg are\nordered by inclusion, that is, given two 2-cycles c and c\u2032 , one has c \u2264 c\u2032 if the disc inside c is included\nin the disc inside c\u2032 . The near-simple core R of Q is obtained by collapsing all maximal contractible\n2-cycles into edges. Conversely, every Q \u2208 Qg is obtained from some R \u2208 Rg , where each edge\nis possibly \"opened\" into a 2-cycle that is to be filled with a (rooted) planar quadrangulation.\nTherefore, for g > 0 we have\nQg (x, u) = Rg (x, V (x, u)),\n\nwhere V (x, u) = u(1 +\n\n\u2032\n2\n2u\nx Q0 (x, u)) .\n\n(5)\n\nSimilarly, the contractible 4-cycles of R \u2208 Rg are partially ordered according to the analogous\ninclusion relation. The near-irreducible core S of R \u2208 Rg is obtained by emptying the disc within\neach maximal contractible 4-cycle, that is, the disc inside a maximal 4-cycle is replaced by a face.\nConversely, every R \u2208 Rg is obtained from some S \u2208 Sg , where one might insert in each face a\n10\n\n\fplanar simple quadrangulation (the \"degenerate\" simple planar quadrangulation with only 2 edges\nis not allowed for insertion). Therefore, for g > 0 we have\nRg (x, v) = Sg (x, W (x, v)),\n\n3.3\n\nwhere W (x, v) =\n\n1\n(2vR0\u2032 (x, v) \u2212 xv \u2212 x2 v).\nx2 v\n\n(6)\n\nSingular expansions\n\nThroughout this section, we associate to genus g the value\n\u03b1 = 52 (1 \u2212 g).\n\n(7)\n\n\u2212\n\u2192\nRooted maps. For g \u2265 0, let M g (x, u) be the series counting rooted maps of genus g where x\nmarks vertices and u marks edges. According to the correspondence between maps and quadrangulations, we have\n\u2212\n\u2192\n2uQ\u2032g (x, u) = M g (x, u).\n(8)\nLet p = p(x, u) and q = q(x, u) be the algebraic bivariate series defined by the system\n\u001a\np = xu + 2pq + p2 ,\nq = u + 2pq + q 2 ,\n\n(9)\n\nand let \u2206 = \u2206(p, q) = (1 \u2212 2p \u2212 2q)2 \u2212 4pq be the Jacobian determinant of the system. Singular\npoints of p(x, u) and q(x, u) are the same: for x0 > 0 the corresponding singular point (x0 , u0 ) is\nsuch that u0 is the smallest positive u satisfying \u2206(p, q) = 0 where p = p(x0 , u) and q = q(x0 , u).\nSuch a pair (x0 , u0 ) is called a singular point of (9).\nDefine a bivariate series f (x, u) to be (p, q)-rational if it admits a rational expression in terms\nof p(x, u) and q(x, u). Note that the elementary functions (x, u) 7\u2192 x and (x, u) 7\u2192 u are (p, q)rational, since u = q \u2212 q 2 \u2212 2pq and x = (p \u2212 2pq \u2212 p2 )/(q \u2212 2pq \u2212 q 2 ). Remarkably, the series\ncounting rooted maps in any genus are (p, q)-rational. Precisely, Arqu\u00e8s has shown in [1] that\n\u2212\n\u2192\n1\np q (1 \u2212 2p \u2212 2q),\nM 0 (x, u) =\nxu2\n\n(10)\n\na result obtained formerly by Tutte under an equivalent parametrization [30]. In addition, Arqu\u00e8s\nand Giorgetti [2] have proved that, for g > 0, there is a bivariate polynomial Pg (X, Y ) such that\n\u2212\n\u2192\nPg (p, q)\n.\nM g (x, u) =\n\u22065g\u22123\n\n(11)\n\nLemma 3.1. For every singular point (x0 , u0 ) of (9), the polynomial Pg in (11) is non-zero at\n(p0 , q0 ), where p0 = p(x0 , u0 ) and q0 = q(x0 , u0 ).\n\u2192\n\u2212\nProof. Bender and Canfield showed in [5] that, for g \u2265 0, u 7\u2192 Q g (1, u) admits a singular expansion\nof order \u03b1 \u2212 1 around 1/12. In [6, proof of Theorem 2], working with similar algebraic expressions\nas (11) they provide a sketchy justification that all arguments in [5] can be extended to the bivariate\ncase. In our terminology it means that, for every singular point (x0 , u0 ) of (9), the series u 7\u2192\n\u2212\n\u2192\nM g (x0 , u) admits a singular expansion of order \u03b1 \u2212 1 around u0 . Note that, using for instance the\nmain theorem in [13], one easily shows that\np\n\u221a\n\u221a \u0001\n\u2206(p(x0 , u), q(x0 , u)) = U * h U , with U = 1 \u2212 u/u0 ,\n11\n\n\f\u2212\n\u2192\nand with h analytic and non-zero at 0. Since M g (x0 , u) = Pg (p(x0 , u), q(x0 , u))/\u22065g\u22123 is of order\n\u03b1 \u2212 1 = \u2212 12 (5g \u2212 3) at u0 and since Pg (p(x0 , u), q(x0 , u)) converges to Pg (p0 , q0 ), we conclude that\nPg (p0 , q0 ) 6= 0.\nNear-irreducible quadrangulations.\nthe following link between Qg and Sg :\n\nComposing Equation (5) with Equation (6), we obtain\n\nQg (x, u) = Sg (x, w), with w = H(x, u) = W (x, V (x, u)).\n\n(12)\n\nDifferentiating this equation with respect to u and multiplying by 2u, we obtain\n\u2212\n\u2192\nM g (x, u) = 2uH \u2032 (x, u) * Sg\u2032 (x, w), where w = H(x, u).\n\n(13)\n\nThe series H(x, u) has a combinatorial interpretation: it enumerates rooted planar quadrangulations (the outer face is the one to the right of the root edge) where the four outer vertices are\ndistinct, and where the root-edge and the opposite outer edge are simple. These are only minor\nconstraints on quadrangulations; and by elementary decompositions and calculations (see for instance [26] for similar calculations, and more recently [11, Sect.7]), H(x, u) is (p, q)-rational. So is\n2uH \u2032 (x, u) because (p, q)-rationality is stable under derivation, see [17]; call A(p, q) the algebraic\nexpression such that 2uH \u2032 (x, u) = A(p(x, u), q(x, u)). Note also the singular points of 2uH \u2032 (x, u)\nare the same as the singular points of (p, q). (Indeed, 2uH \u2032 (x, u) has the same singular points as\nH(x, u). The series H(x, u) itself is dominated coefficientwise by the series counting rooted planar\nquadrangulations, whose singular points are those of (p, q), so the singular points of H(x, u) can\nnot occur before those of (p, q).)\nDefine r = r(x, w) and s = s(x, w) as the algebraic series defined by the system\n\u001a\nr = xw(1 + s)2 ,\n(14)\ns = w(1 + r)2 .\nAs shown in [10], for x0 > 0 the radius of convergence of w 7\u2192 r(x0 , w) (and also of w 7\u2192 s(x0 , w))\nis the value w0 > 0 such that\n1 + r + s \u2212 3rs = 0.\n(15)\nSuch a solution (x0 , w0 ) is called a singular point of (14). Hence singular points of (14) are the\nsingular points of r(x, w) (and also of s(x, w)).\nLemma 3.2. For x0 , let u0 and w0 be such that (x0 , u0 ) is a singular point of (9) and (x0 , w0 )\nis a singular point of (14). Then w0 = H(x0 , u0 ), i.e., the singular points of (9) are mapped to\nsingular points of (14) by the change of variable (x, u) 7\u2192 (x, H(x, u)).\nIn addition, since u 7\u2192 H(x0 , u) is strictly increasing (by positivity of the coefficients), it maps\nthe interval (0, u0 ) to the interval (0, w0 ).\nProof. From manipulations of algebraic series (see for instance [23, Sect. 2.9] for the univariate\ncase and more recently [11, Sect. 7] for the bivariate case), one shows that, when (x, w) and (x, u)\nare related by w = H(x, u), p and q are expressed as\np=\n\n(s + 1)s\n(1 + r)r\n, q=\n,\nrs + 3s + 2s2 + 3r + 2r 2 + 1\nrs + 3s + 2s2 + 3r + 2r 2 + 1\n12\n\n(16)\n\n\fwhich implies that\ne s) := (1 + r)(1 + s)(1 + r + s \u2212 3rs) .\n\u2206(p, q) = \u2206(r,\n(1 + 3r + 3s + 2r 2 + 2s2 + rs)2\n\nLet (x0 , u0 ) \u2208 R2+ be a singular point of (9) (a solution of \u2206(p, q) = 0), and let w0 = H(x0 , u0 ).\ne s) implies 1 + r + s \u2212 3rs = 0. Since\nSince r and s are positive at (x0 , w0 ), \u2206(p, q) = 0 = \u2206(r,\nu 7\u2192 H(x0 , u) is strictly increasing by positivity of the coefficients, any w < w0 corresponds to some\ne\nu < u0 . Since (x0 , u0 ) is a singular point of (9), \u2206(p(x0 , u), q(x0 , u)) > 0. So \u2206(r(x\n0 , w), s(x0 , w)) >\n0. Hence (x0 , w0 ) is a singular point of (14).\n\n\u2212\n\u2192\nNext we get an expression for Sg\u2032 (x, w). Substituting expression (11) of M g (x, u) into (13) and\nreplacing p and q by their expressions (16), we obtain for Sg\u2032 (x, w) a rational expression in terms\nof (r, s), of the form\n1\nPeg (r, s)\nSg\u2032 (x, w) =\n,\n(17)\ne s))5g\u22123\ne s) (\u2206(r,\nA(r,\ne s) (Peg (r, s), resp.) equals A(p, q) (Pg (p, q), resp.) after substitution of p and q by their\nwhere A(r,\nexpression (16) in terms of r and s. (Note that Peg (r, s) is a rational expression, the denominator\nbeing a power of (1 + 3r + 3s + 2r 2 + 2s2 + rs).)\nLemma 3.3. For g \u2265 0, the series Sg\u2032 (x, w) admits a singular expansion of order \u03b1 \u2212 1 around\nevery singular point (x0 , w0 ) of (14).\n\nProof. Using again the main theorem in [13], one shows that r and s have square-root singular\nexpansions around (x0 , w0 ). Moreover, denoting by R(x) the singularity function of r(x, w) with\ne s) has around\nrespect to w, one easily checks, using the computer algebra system Maple, that \u2206(r,\n(x0 , w0 ) an expansion of the form\np\ne\n\u2206(r(x,\nw), s(x, w)) = W * h(X, W ), with W = 1 \u2212 w/R(x), X = x \u2212 x0 ,\n\nand where h(X, W ) is analytic at (0, 0) and h(0, 0) 6= 0. Note also that the expressions of p and q in\n\u2032\ne\nterms of r and s are positive; and A(r(x\n0 , w), s(x0 , w)) = 2uH (x0 , u) (with w and u related by w =\nH(x, u)) is positive for w \u2208 (0, w0 ) and we claim that it converges at w0 (indeed H(x, u) is dominated\ncoefficientwise by the series counting rooted planar quadrangulations, satisfying the \"universal\"\nsingular order 3/2 at every singular point, so 2uH \u2032 (x, u) is dominated coefficientwise by a series of\nsingular order 1/2, which thus converges at its singular points). Hence, looking at Expression (17) of\nSg\u2032 (x, w) and using the fact that Peg (r(x0 , w0 ), s(x0 , w0 )) = Pg (p(x0 , u0 ), q(x0 , u0 )) 6= 0, we conclude\nthat the radius of convergence of w 7\u2192 Sg\u2032 (x0 , w) must be w0 , and Sg\u2032 (x, w) must have a singular\nexpansion of order (3 \u2212 5g)/2.\nApplying Lemma 2.5 (integration) to the series Sg\u2032 (x, w), we obtain the following.\nLemma 3.4. For g \u2265 0, the series Sg (x, w) enumerating near-irreducible quadrangulations of genus\ng admits a singular expansion of order \u03b1 around every singular point of (14).\n\n13\n\n\fNear-irreducible quadrangulations with fixed edge-width. For g \u2265 0 and i \u2265 1, let Sgew=2i\nbe the family of near-irreducible quadrangulations of genus g with edge-width 2i. Define also SgC=2i\nas the family of quadrangulations from Sg that have a marked non-contractible cycle C of length\n2i that is additionally given a direction and carries a marked white vertex, called starting vertex\nof C. Denote by Sgew=2i (x, w) and SgC=2i (x, w) the series of Sgew=2i and SgC=2i . Note that SgC=2i is\na superfamily of Sgew=2i , so that Sgew=2i (x, w) \u0016 SgC=2i (x, w).\nGiven S \u2208 SgC=2i , let L = \u03a6(S) be obtained as follows:\n\u2022 Cut the surface Sg along C (whether C is surface-separating or not, two cases); this yields\ntwo cylindric ends, and a special face of degree 2i appears at the boundary of each of the two\ncylindric ends; see Figure 1 (orienting C is needed to distinguish the cylindric ends; there is\none on the left of C and one on the right of C).\n\u2022 Add a marked black vertex, called a special vertex, inside each special face, and connect this\nvertex to all white vertices on the contour of the face, see Figure 1(b). The special vertex in\nthe left (right, resp.) cylindric end is denoted vl (vr , resp.). Mark the two edges (v, vl ) and\n(v, vr ), where v is the starting vertex of C.\n\nc1\n\nc2 c\n3\n\nc4'\n\nc3'\n\nc2'\n\nc1'\n\nc1\n\n(a)\n\nvl\n\nvr\n\nc2 c\n3\n\nc4'\n\nc3'\n\nc2'\n\nc1'\n\n(b)\n\nFigure 1: Cutting along a non-contractible cycle cuts a handle and creates two cylindrical ends.\nLet L = \u03a6(SgC=2i ) be the family of well-labelled quadrangulations (i.e., with the m edges\nrelabelled so as to have distinct labels in [1..m]) obtained in this way, and let L(x, w) be the series\nof L. Note that\nxi+2 u2i * SgC=2i (x, w) = L(x, w).\n(18)\nAn object L \u2208 L is of two possible types:\n\u2022 Either L is disconnected (the original cycle C is surface-separating), in which case L has two\nconnected components L1 and L2 , each component carrying one special cycle (and one special\nvertex); in addition, the sum of genera of L1 and L2 is g;\n\u2022 or L is connected of genus g \u2212 1.\nWe denote by Lspl the subfamily of objects of L of the first type, and by Lcon the subfamily of\nobjects of L of the second type.\nLemma 3.5. For g > 0, let as before \u03b1 = 5(1 \u2212 g)/2. Then SgC=2i (x, w) is bounded coefficientwise\nby a series of singular order \u03b1 + 1/2 around every singular point (x0 , w0 ) of (14).\n14\n\n\fProof. By Equation (18), it is enough to prove the result for the series L(x, w) instead of working\nwith SgC=2i (x, w). Let S \u2208 SgC=2i , with L = \u03a6(S). Let \u03c3S = (c1 , . . . , cl , c\u2032r , . . . , c\u20321 ) be the possibly\nempty sequence of non-contractible 2- or 4-cycles homotopic to the marked cycle C of S, where\nc1 , . . . , cl are to the left of C and c\u2032r , . . . , c\u20321 are to the right of C; see Figure 1. Here we need to\nhandle with a special care the case of the torus: for g = 1, the nested cycles form only one sequence\n(arranged along a unique cylinder), and by convention we decide that all these cycles are on the\nleft part and form the sequence (c1 , . . . , cl ), while the right-sequence (c\u2032r , . . . , c\u20321 ) is empty.\nWhen cutting along C (cutting a handle), \u03c3S is cut into two (possibly empty) sequences \u03c3 =\n(c1 , . . . , cl ) and \u03c3 \u2032 = (c\u20321 , . . . , c\u2032r ) of contractible 2- or 4-cycles of L, one at each cylindric end. Note\nthat all cycles of \u03c3 and of \u03c3 \u2032 must enclose the special vertex at the corresponding cylindric end.\nCall S k the family of rooted planar bipartite maps -the root is an outer edge directed so as to\nhave the outer face on its right and a black origin- with a secondary marked vertex v, an outer\nface of degree 2, all inner faces of degree 4, and such that each 2-cycle and each non-facial 4-cycle\nencloses v in its interior. Define similarly S \u2666 , but now with the condition that the outer face is of\ndegree 4 with 4 distinct vertices.\nLet S k (x, w) and S \u2666 (x, w) be the series enumerating S k and S \u2666 , respectively, according to black\ninner vertices and inner faces. The operation of cutting the surface along the first cycle of \u03c3 (if \u03c3\nis not empty) and the first cycle of \u03c3 \u2032 (if \u03c3 \u2032 is not empty) yields\nL(x, w) \u0016 K(x, w) * (S k (x, w) + S \u2666 (x, w) + 1)2 ,\nwhere\n\nX\n\nK(x, w) := Sg\u22121\u2032\u2032 (x, w) +\n\n(19)\n\nSg1\u2032 (x, w)Sg2\u2032 (x, w).\n\ng1 +g2 =g\ng1 >0,g2 >0\n\nIndeed, each of the two sequences \u03c3, \u03c3 \u2032 , if not empty, yields a piece either in S k (say, if \u03c3 starts\nwith a 2-cycle) or in S \u2666 (if \u03c3 starts with a 4-cycle) at the corresponding cylindric end. Now let us\nobtain a singular expansion for S \u2666 (x, w) (the method for S k (x, w) is similar)1 :\nClaim A. The series S \u2666 (x, w) admits a singular expansion of positive half-integer order around\nevery singular point (x0 , w0 ) of (14).\nProof of the claim. Let R\u2666 be the family of rooted quadrangulations defined as S \u2666 , except that\nany type of non-facial 4-cycle is allowed; and let Q\u2666 be the family of rooted quadrangulations with\n4 distinct outer vertices and a secondary marked vertex v0 . One extracts from Q \u2208 Q\u2666 a core\nR \u2208 R\u2666 by collapsing all 2-cycles not strictly enclosing v0 . Hence, similarly as in Equation (5), the\nseries Q\u2666 (x, v) and R\u2666 (x, u) enumerating R\u2666 and Q\u2666 by black inner vertices and inner faces are\nrelated by\nV (x, u) \u2666\nR (x, V (x, u)),\nQ\u2666 (x, u) =\nu\nwhere V (x, u) is defined in (5). Similarly one extracts from R \u2208 R\u2666 a core S \u2208 S \u2666 by emptying all\n4-cycles that are not strictly enclosing v0 . Hence, similarly as in Equation (6), the series R\u2666 (x, v)\nand S \u2666 (x, w) are related by\nR\u2666 (x, v) = S \u2666 (x, W (x, v)),\n1\nIn the univariate case, Bender et al. [9] count S k and S \u2666 by characterizing the pieces between two successive\ncycles of \u03c3. Instead, our approach to count these classes relies on a composition scheme.\n\n15\n\n\fwhere W (x, v) is defined in (6). Hence we obtain, with H(x, u) = W (x, V (x, u)),\nu\nQ\u2666 (x, u) = S \u2666 (x, w), where w = H(x, u).\nV (x, u)\n\n(20)\n\nOne easily shows (from elementary manipulations similar as in [17]) that Q\u2666 (x, u) and V (x, u) are\nexpressed rationally in terms of the series p and q defined in (9), and that the singular order of\nQ\u2666 (x, u) is 1/2 at each singular point, whereas the singular order of V (x, u) is 3/2 at each singular\npoint. The reason is that the series of rooted quadrangulations with four distinct outer vertices\nis of singular order 3/2, as any series counting a \"natural\" family of rooted maps; so Q\u2666 (x, u) is\nof singular order 1/2 by derivation effect. And V (x, u) is equal to 2u(1 + Q\u20320 (x, u))2 /x, so has the\nsame singular order as Q\u20320 (x, u), i.e., 3/2.\nReplacing p and q by their expressions (16), one gets a rational expression for S \u2666 (x, w) in terms\nof r and s. As already discussed in Section 3.3, the singular points of (9) are mapped by H(x, u)\ninto the singular points of (14). Since Q\u2666 (x, u) and V (x, u) converge to positive constants at every\nsingular point (x0 , u0 ) of (9), S \u2666 (x, w) converges at every singular point (x0 , w0 ) of (14). Since\nS \u2666 (x, w) is rationally expressed in terms of r and s, which have square-root singular expansion\naround (x0 , w0 ), we conclude that S \u2666 (x, w) admits a singular expansion of order (2k + 1)/2 around\n(x0 , w0 ), with k a non-negative integer.\n\u25b3\n\nSimilarly, one proves that for every singular point (x0 , w0 ) of (14), S k (x, w) has a singular\nexpansion of positive half-integer order around every singular point of (14).\nClaim B. The series K(x, w) admits a singular expansion of order \u03b1 + 1/2 around every singular\npoint (x0 , w0 ) of (14).\n\nProof of the claim. Let h = g \u2212 1. Since Sh (x, w) has a singular expansion of order 52 (1 \u2212 h), by\nLemma 2.5 Sh\u2032\u2032 (x, w) has a singular expansion of order 52 (1 \u2212 h) \u2212 2 = \u03b1 + 1/2 around (x0 , w0 ).\nMoreover for each pair g1 , g2 of positive integers adding up to g, the series Sg1\u2032 (x, w) and Sg2\u2032 (x, w)\nhave singular expansions of respective orders 5(1 \u2212 g1 )/2 \u2212 1 and 5(1 \u2212 g2 )/2 \u2212 1 around (x0 , w0 ).\nHence, by Lemma 2.2, Sg1\u2032 (x, w)Sg2\u2032 (x, w) has a singular expansion of order 3 \u2212 5g/2 = \u03b1 + 1/2. \u25b3\nWe now conclude the proof of Lemma 3.5. Since K(x, w) has a singular expansion of order\n\u03b1 + 1/2 and S k (x, w) + S \u2666 (x, w) has a converging singular expansion around (x0 , w0 ), then by\nLemma 2.2 the product of these two series (which dominates coefficientwise L(x, w) according\nto (19)) admits a singular expansion of order \u03b1 + 1/2.\n\n4\n\nCounting graphs of genus g asymptotically\n\nThe genus of a graph G is the minimum genus of a surface in which G can be embedded. So\nplanar graphs are graphs of genus 0. The face-width of a graph G of genus g \u2265 0 is the maximum\nface-width over all embeddings of G in Sg . Note that the face-width is +\u221e in genus 0 since all\ncurves in the sphere are contractible.\n\n4.1\n\nNotations for graph families and counting series\n\nGraph families of connectivity 1, 2, 3 are denoted by the letters C, B, and T , respectively. The\ngenus g is indicated as a subscript, and the face-width is indicated as a superscript. For instance\nCgfw\u22652 is the family of connected graphs of genus g with face-width at least 2. Unless explicitly\n16\n\n\fmentioned, all generating functions count graph families according to vertices and edges, marked\nrespectively by variables x and y. Since vertices are labelled, these series are exponential in the\nfirst variable. For instance, if cn,k is the number of connected graphs of genus g with n vertices and\nk edges, then\nX\nxn\nCg (x, y) =\ncn,k y k .\nn!\nIn the rest of the paper (as opposed to the previous section) the derivative of a series G(x, y)\naccording to the first variable is denoted by G\u2032 (x, y).\nGiven a graph family G, the derived class is the class G \u2032 of graphs from G with one marked\nvertex that is unlabelled and all the other n vertices being as usual labelled by [1..n]. Similarly the\ndoubly derived class G \u2032\u2032 is the class of graphs from G with two marked vertices that are unlabelled\n(distinguished as a first and a second marked vertex), all the other n vertices being labelled in\n[1..n]. The counting series of G \u2032 and G \u2032\u2032 are exponential in the number of labelled vertices, that\nis, each graph with n labelled vertices and k edges has weight xn y k /n! in the counting series. If\nG(x, y) is the counting series of G, it is well known that the counting series of G \u2032 is G\u2032 (x, y) and the\ncounting series of G \u2032\u2032 is G\u2032\u2032 (x, y).\n\n4.2\n\nTutte's decomposition of graphs\n\nWe recall here a well-known decomposition of a graph into 3-connected components, as formalized\nby Tutte [31]. For k \u2265 1, a k-connected graph is a graph of order at least k + 1 in which at\nleast k vertices need to be deleted to disconnect it. A connected graph is decomposed into 2connected components, also called blocks, that are articulated around cut vertices, so that the\nincidences between the 2-connected components and the separating vertices form a tree. Similarly,\na 2-connected graph G is decomposed at its separating pairs of vertices into a tree with three kinds\nof nodes: polygons, multiple edges, and 3-connected graphs with at least four vertices. The latter\ntype are called the 3-connected components of G. See [21] for a detailed discussion in the context\nof graph enumeration.\nRobertson and Vitray proved the following result.\nTheorem 4.1 (Robertson and Vitray [28]). A connected graph G of genus g > 0 has face-width\nk \u2265 2 if and only if G has a unique 2-connected component of genus g and face-width k, and all\nthe other 2-connected components are planar.\nA 2-connected graph G of genus g > 0 has face-width k \u2265 3 if and only if G has a unique\n3-connected component of genus g and face-width k, and all the other 3-connected components are\nplanar.\nLet F (x, y) = xC \u2032 (x, y) be the series counting vertex-pointed connected planar graphs (the\npointed vertex being labelled). Then the first part of Theorem 4.1 yields, for g > 0,\nCgfw\u22652 (x, y) = Bgfw\u22652 (F (x, y), y).\n\n(21)\n\nA network, as defined in [33], is a connected planar graph with two special vertices, called the\npoles, such that adding an edge connecting the poles gives a 2-connected planar graph. Let D(x, y)\nbe the series counting networks (the poles are not labelled and not counted by the variable x).\nThen the second part of Theorem 4.1 yields, for g > 0,\nBgfw\u22653 (x, y) = Tgfw\u22653 (x, D(x, y)).\n17\n\n(22)\n\n\f4.3\n\nSingular expansions\n\nAgain, to genus g \u2265 0 we associate the quantity\n\u03b1 = 25 (1 \u2212 g).\nOur goal is to show that the series enumerating 3-, 2-, and 1-connected graphs of genus g are of\napproximate-singular order \u03b1.\n4.3.1\n\n3-connected graphs of genus g\n\nWe start with 3-connected graphs and use the result for maps from the previous section. In\nparticular, we use the fact [28] (see [24] for an alternative proof) that if a 3-connected graph of\ngenus g has face-width at least 2k + 3, then it has a unique embedding in the surface Sg .\nLemma 4.2 (3-connected graphs of genus g and fw \u2265 3). For g \u2265 0, the series Tgfw\u22653 (x, w) is\napproximate-singular of order \u03b1 around every singular point (x0 , w0 ) of (14).\nProof. The proof relies again on results by Robertson and Vitray [28]. We use the letter E to\ndenote the series of embedded 3-connected graphs, that is, 3-connected maps. In this case we label\nmaps at vertices and use variable w for marking edges, so that\nX\nxn\nE(x, w) =\nEn,m wm .\nn!\nNote that a 3-connected graph yields at least two embeddings (an embedding and its reflection),\nhence\n2 Tg (x, w) \u0016 Eg (x, w).\nIt is shown in [28] that the quadrangulation of a 3-connected map is near-irreducible, hence\nEg (x, w) \u0016 Sg (x, w).\nThere is a technical point here that we clarify. In the previous section, near-irreducible quadrangulations (counted by the series Sg ) were labelled at edges, which correspond to corners of the 3connected maps. But here we are labelling 3-connected maps at vertices, which correspond to black\nvertices in quadrangulations. But in near-irreducible quadrangulations labelling at edges is equivalent to labelling at black vertices, in the following sense. If Sn,m is the number of near-irreducible\nquadrangulations with n black vertices and m faces, labelled at edges with {1, 2, . . . , 2m}, and Sen,m\nis the number of near-irreducible quadrangulations labelled at black vertices with {1, 2, . . . , n}, then\nwe have\nSn,mn! = Sen,m (2m)!,\nsince the previous quantity is the number of quadrangulations labelled both at vertices and edges.\nThe important point is that labelling near-irreducible quadrangulations at either black vertices or\nedges is enough to avoid symmetries. In order to avoid unnecessary\ncomplications,P\nwe use the notaP\ntion Sg as in Section 3, but taking into account that Sg = Sn,m xn wm /(2m)! = Sen,mwm xn /n!.\nIt is also shown in [28] that a map is 3-connected of face-width k \u2265 3 if and only if the associated\nquadrangulation is irreducible of edge-width 2k. Hence, for k \u2265 3, we have\nX\nX\nEgfw\u2265k = Sg \u2212\nSgew=2i \u0017 Sg \u2212\nSgC=2i .\ni<k\n\ni<k\n\n18\n\n\fFinally it is shown in [28] that if the face-width of a 3-connected graph is at least 2g + 3, then the\nembedding is unique up to reflection, hence\nX\n2 Tgfw\u22652g+3 = Egfw\u22652g+3 = Sg \u2212\nSgC=2i .\ni<2g+3\n\nSince\nTgfw\u22652g+3 \u0016 Tgfw\u22653 \u0016 Tg ,\n\nwe obtain\nSg \u2212\n\nX\n\ni<2g+3\n\nSgC=2i \u0016 2 Tgfw\u22653 \u0016 Sg .\n\n(23)\n\nBy Lemma 3.4, Sg has a singular expansion of order \u03b1 around every singular point (x0 , w0 ) of (14);\nand by Lemma 3.5, for i \u2265 1, SgC=2i is bounded coefficient-wise by a series Pg that admits a singular\nexpansion of order \u03b1 + 1/2 around (x0 , w0 ). Hence Tgfw\u22653 is of approximate-singular order \u03b1 at\n(x0 , w0 ).\n4.3.2\n\n2-connected graphs of genus g\n\nLemma 4.3 (2-connected graphs of genus g and fw \u2265 3). For g \u2265 0, the series Bgfw\u22653 (x, y) is of\nstrong approximate-singular order \u03b1 around every singular point (x0 , y0 ) of the series D(x, y) of\nplanar networks.\nProof. By Equation (22) we have Bgfw\u22653 (x, y) = Tgfw\u22653 (x, D(x, y)). Bender et al. [8] have shown\nthat, if (x0 , y0 ) is a singular point of D(x, y), then (x0 , w0 ) -where w0 = D(x0 , y0 )- is a singular\npoint of (14), i.e., is a singular point of Tgfw\u22653 (x, w). Hence the composition scheme is critical. In\naddition, as proved in [8], D(x, y) admits a log-free singular expansion of order 3/2 around (x0 , y0 ).\nHence by Corollary 2.8, Bgfw\u22653 (x, y) is of strong approximate-singular order \u03b1 around every singular\npoint (x0 , y0 ) of D(x, y).\nLemma 4.4 (2-connected graphs of genus g and fw \u2265 2). For every singular pair (x0 , y0 ) of D(x, y),\nthe series Bgfw=2 (x, y) is bounded coefficient-wise by a series of strong singular order \u03b1 + 1/2 at\n(x0 , y0 ).\nAnd the series Bgfw\u22652 (x, y) is of strong approximate-singular order \u03b1 around (x0 , y0 ).\nProof. The proof works by induction on g. The first assertion is clearly true for g = 0 since the\nface-width is infinite by convention. The second assertion has been shown by Gim\u00e9nez and Noy for\nplanar graphs in [20].\nLet g > 0, and assume the property is true up to g \u2212 1. Let Eg be the family of well-labelled\ngraphs with two connected components: the first one in Bgfw=2 , the second one an oriented edge\n(the second component is only an artifact to have a reserve of two labelled vertices). Note that the\nseries of Eg is\nEg (x, y) = x2 yBgfw=2 (x, y)\nLet Fg be the family of graphs with two ordered connected components of positive genera adding up\nto g, each connected component being a 2-connected graph of face-width at least 2 with additionally\na marked directed edge. Note that the series of Fg satisfies\nX\n\u2202\n\u2202\n(x, y) * 2y Bgfw\u22652\n(x, y).\nFg (x, y) =\n2y Bgfw\u22652\n1\n\u2202y\n\u2202y 2\ng +g =g\n1\n\n2\n\ng1 >0,g2 >0\n\n19\n\n\fAnd let Hg be the family of 2-connected graphs of genus at most g and face-width at least 2 and\nhaving two (a first and a second) marked directed edges. Note that the series of Hg satisfies\nHg (x, y) =\n\nX \u22022\nB fw\u22652 .\n\u2202y 2 g\nh\u2264g\n\nWe are going to show an injection from Eg to Fg + Hg\u22121 (since Fg and Hg\u22121 only involve family of\n2-connected graphs of smaller genus, this will allow us to conclude the proof by induction).\nLet (G, e) \u2208 Eg . Let M be an embedding of G of face-width 2 and let C be a non-contractible\ncycle intersecting M at two vertices v and v \u2032 , C being additionally directed. Cut the surface along\nC as in Figure 1, making two cylindric ends appear (one on the left of C, on one the right of C).\nIn the tip of each cylindric end, add an edge directed from v to v \u2032 . So v (v \u2032 , resp.) is split into two\nvertices: the one on the left cylindric end keeps the label of v (of v \u2032 , resp.), the one on the right\ncylindric end receives the label of the origin (end, resp.) of the edge-component e 2 . Let M \u2032 be the\nresulting embedded graph and G\u2032 the underlying graph. Note that if C is surface-separating G\u2032 has\ntwo ordered connected components (the first one contains the left cylindric end) of positive genera\nadding up to g, each connected component having additionally a marked directed edge. If C is not\nsurface-separating, G\u2032 has one connected components of genus at most g \u2212 1 and has additionally\ntwo marked directed edges. Clearly the mapping from (G, e) to G\u2032 is injective, since G is recovered\nfrom G\u2032 by identifying the two marked directed edges: the merged edge receives the labels of the\nfirst marked edge, and e receives the labels of the second marked edge.\nWe now claim that the image of Eg is included in Fg +Hg\u22121 , i.e., that the connected components\nof the graph associated with G \u2208 Eg are 2-connected of face-width at least 2. This is best seen\nby going to quadrangulations. Take the case where C is not surface-separating (the other case\nworks similarly). With the notations above, let Q be the quadrangulation associated with M , and\nQ\u2032 the quadrangulation associated with M \u2032 . The effect of cutting along C is the same as cutting\nalong a 4-cycle c of Q, so Q\u2032 is obtained from Q by cutting along c. Recall that simple bipartite\nquadrangulations of genus g exactly correspond to 2-connected maps of face-width at least 2. Since\nM is 2-connected of face-width at least 2, Q is a simple quadrangulation, so Q\u2032 is also a simple\nquadrangulation, so M \u2032 is a 2-connected map of face-width at least 2 (and genus g \u2212 1). Since M \u2032\nhas face-width at least 2 and genus g \u2212 1, G\u2032 has face-width at least 2 and genus at most g \u2212 1.\nThanks to the injective mapping we have constructed it is an easy matter to conclude the proof\nby induction. By injectivity we have\nx2 yBgfw=2 (x, y) = Eg (x, y) \u0016 Fg (x, y) + Hg\u22121 (x, y).\nBy induction, each series Bhfw\u22652 (x, y) for h < g is of strong approximate-singular order 5/2(1 \u2212 h)\nat every singular point (x0 , y0 ) of D(x, y). Hence the partial derivative according to y of such a\nseries is of order 3/2 \u2212 5/2h. Hence, for g1 + g2 = g, the product of such two series is of order\n3 \u2212 5/2g, so Fg (x, y) is also of order 3 \u2212 5/2g = \u03b1 + 1/2. Similarly, Hg\u22121 (x, y) is of order \u03b1 + 1/2,\nso the sum of Fg and Hg\u22121 , which dominates Bgfw=2 , is of order \u03b1 + 1/2. Finally, the series\nBgfw\u22652 = Bgfw\u22653 + Bgfw=2 is the sum of two series respectively of strong approximate-singular orders\n\u03b1 (according to Lemma 4.3) and \u03b1+ 1/2 (as just shown), so the second term is negligible and Bgfw\u22652\nis thus of strong approximate-singular order \u03b1.\n2\n\nThe edge-component is only used to make the resulting graph well-labelled.\n\n20\n\n\fEven if only Lemma 4.4 is needed to do the asymptotics of connected graphs of genus g, we\nadd here for the sake of completeness a lemma (bounding the series of 2-connected graphs of facewidth 1) in order to have a theorem on the asymptotic enumeration of 2-connected graphs of genus\ng (Theorem 4.6 at the end of this section).\nLemma 4.5 (2-connected graphs of genus g). For every singular pair (x0 , y0 ) of D(x, y), the series\nBgfw=1 (x, y) is bounded coefficient-wise by a series of strong singular order \u03b1 + 1/2 at (x0 , y0 ).\nAnd the series Bgfw\u22651 (x, y) = Bg (x, y) is of strong approximate-singular order \u03b1 around (x0 , y0 ).\nProof. Similarly as in Lemma 4.4 we reason by induction on g. The stated assertions are true for\ng = 0 (the first assertion is trivial, the second assertion is proved in [20]).\nLet g > 0, and assume the stated properties are true up to genus g \u2212 1. Given a 2-connected\ngraph G of genus g and face-width 1, let M be an embedding of G on Sg with face-width 1, and\nlet C be a non-contractible closed curve intersecting M at a single vertex, call it v. Cutting along\nC splits v into two \"marked\" vertices and yields a connected graph M \u2032 embedded on Sg\u22121 and\nwith two marked vertices (the case of C surface-separating is excluded, since it would contradict\nthe 2-connectivity of G). Let G\u2032 be the underlying connected graph, so G\u2032 has genus at most\ng \u2212 1. Note that even after forgetting the embedding, G can be recovered from G\u2032 by merging the 2\nmarked vertices of G\u2032 . So the mapping from G to G\u2032 and its two marked vertices is injective (upon\nusing a similar artifact as in Lemma 4.4 to make G\u2032 well-labelled). The graph G\u2032 is not necessarily\n2-connected, but close to. We use the following easy claim:\nClaim A. Let G be a 2-connected graph, let v be a vertex of G and (E1 , E2 ) a partition of the\nedges incident to v into 2 non-empty parts. Let G\u2032 be the graph obtained from G by splitting\nv into 2 vertices v1 and v2 , vi keeping as incident edges the edges in Ei for i \u2208 {1, 2}. Then the\nblock-structure of G\u2032 is a chain of 2-connected components B1 , . . . , Bk , i.e., each Bi has two distinct\nmarked vertices wi , wi\u2032 such that w1 = v1 , wk = v2 , and wi\u2032 = wi+1 for i \u2208 [1..k \u2212 1].\nHence the graph G\u2032 obtained from G is a chain of bi-pointed 2-connected graphs with sum of\ngenera strictly smaller than g (because the genus of a graph is the sum of genera of its blocks). For\neach composition \u03ba of k \u2264 g \u2212 1 as a sum of positive integers i1 , . . . , ij , let S (\u03ba) be the family of\nconnected graphs G\u2032 made of a chain of blocks, so that the blocks of positive genera in the chain\nhave genera i1 , . . . , ij and there are two unlabelled marked vertices in G\u2032 contained respectively\nin the first and in the last block of the chain. Note that (with Z marking a labelled vertex, Seq\ndenoting the sequence construction, and \u22c6 denoting the labelled product in the sense of [16])\nS (\u03ba) = Bi1\u2032\u2032 \u22c6 * * * \u22c6 Bij\u2032\u2032 \u22c6 Seq(Z \u22c6 B0\u2032\u2032 )j+1 .\nClaim B. Let \u03ba = i1 + * * * + ij be a composition of k < g by positive integers. Then the generating\nseries S (\u03ba) (x, y) of S (\u03ba) is of strong approximate-singular order j/2 \u2212 5/2k at every singular point\n(x0 , y0 ) of D(x, y).\nProof of the claim. By induction, for h < g, each series Bh\u2032\u2032 (x, y) is of strong approximate-singular\norder 1/2 \u2212 5/2h at (x0 , y0 ). Hence, by Lemma 2.2, Bi1\u2032\u2032 (x, y) * * * Bij\u2032\u2032 (x, y) is of strong approximatesingular order j/2 \u2212 5/2k. To conclude the proof of the claim we just have to show that the series\nS(x, y) of Seq(Z \u22c6 B0 )\u2032\u2032 is of (strong) positive approximate-singular order; we show it is of order\n1/2. Since B0 (x, y) is of order 5/2 at (x0 , y0 ), B0\u2032\u2032 (x, y) is of order 1/2, so 1/(1 \u2212 xB0\u2032\u2032 (x, y)) is either\n21\n\n\fof order 1/2 (if x0 B0\u2032\u2032 (x0 , y0 ) = 1) or is of order \u22121/2 (if x0 B0\u2032\u2032 (x0 , y0 ) < 1), so proving that S(x, y)\nis of order 1/2 reduces to proving that 1/(1 \u2212 x0 B0\u2032\u2032 (x0 , y0 )) is finite. Recall the equation\nF (z, y) = z exp(B0\u2032 (F (z, y), y))\nrelating the series F (z, y) of pointed connected planar graphs and the series B0 (x, y) of 2-connected\nplanar graphs. Differentiating this equation with respect to z yields\nF \u2032 (z, y) = F (z, y)F \u2032 (z, y)B0\u2032\u2032 (F (z, y), y) + F (z, y)/z,\nso\nF \u2032 (z, y) =\n\n1\nx\n, where x = F (z, y).\nz 1 \u2212 xB0\u2032\u2032 (x, y)\n\nLet z0 be the positive value such that (z0 , y0 ) is a singular point of F (z, y). As proved in [20], the\ncomposition scheme from 2-connected to connected planar graphs is critical, i.e., x0 = F (z0 , y0 ).\nMoreover, it is shown in [20] that F (z, y) is of singular order 3/2 at (x0 , y0 ), so F \u2032 (z, y) is of order\n1/2. Hence F \u2032 (z, y) converges at (z0 , y0 ), which implies that 1/(1\u2212xB0\u2032\u2032 (x, y)) converges at (x0 , y0 ),\nand thus is of singular order 1/2. Observe that the same argument shows that the denominator\n1 \u2212 xB0\u2032\u2032 (x, y) does not vanish before we reach the singular point (x0 , y0 ). This concludes the proof\nof the claim.\n\u25b3\nfw=1\nThe injection presented in the beginning of the proof of the lemma ensures that Bg\n(x, y) is\nbounded coefficientwise by the sum of series B (\u03ba) (x, y), where \u03ba runs over compositions of integers\nstrictly smaller than g. By Claim B, each series B (\u03ba) (x, y) is of strong approximate-singular order\nat least 1/2 \u2212 5/2(g \u2212 1) = \u03b1 + 1/2 (the least singular order of B (\u03ba) (x, y) is attained for \u03ba the\ncomposition of g \u2212 1 with a single part). This completes the proof of the first assertion of the\nlemma.\nThe second assertion follows straightforwardly. The series Bgfw\u22651 (x, y) = Bg (x, y) is the sum of\nBgfw\u22652 (x, y) and Bgfw=1 , the first term being of strong approximate-singular order \u03b1 by Lemma 4.4,\nand the second term being bounded coefficientwise by a series of strong approximate-singular order\n\u03b1 + 1/2, hence of negligible contribution. Hence Bg (x, y) is also of strong approximate-singular\norder \u03b1 at (x0 , y0 ).\nApplying the transfer theorems stated in Section 2 to the series counting 2-connected graphs of\ngenus g, we obtain:\n(g)\n\nTheorem 4.6. For g \u2265 0, the number bn of 2-connected graphs with n vertices that can be\nembedded in the orientable surface Sg of genus g satisfies\nbn(g) \u223c d(g) n5(g\u22121)/2\u22121 \u03b3 n n!\n\n(24)\n\nwhere d(g) is a positive constant and \u03b3 is the exponential growth constant of 2-connected planar\ngraphs.\n(g)\nFor \u03bc \u2208 (1, 3), the number bn,m of graphs with n vertices and m = \u230a\u03bcn\u230b edges that can be\nembedded in Sg satisfies\n(g)\n\u223c d\u03bc(g) n5g/2\u22124 (\u03b3\u03bc )n n! when n \u2192 \u221e,\nbn,m\n(g)\n\nwhere d\u03bc is a positive constant and \u03b3\u03bc is the exponential growth constant of planar graphs with\nratio edges/vertices tending to \u03bc (\u03b3 and \u03b3(\u03bc) are characterized analytically in [20]).\n22\n\n\f4.3.3\n\nConnected graphs of genus g\n\nLemma 4.7 (Connected graphs of genus g and fw \u2265 2). For g \u2265 0, the series Cgfw\u22652 (x, y) is\nof strong approximate-singular order \u03b1 around every singular pair (x0 , y0 ) of the series G0 (x, y)\ncounting planar graphs.\nProof. In this proof the first variable of the series of 2-connected graph families is denoted by z\nto avoid confusion. Recall Equation (21): Cgfw\u22652 (x, y) = Bgfw\u22652 (F (x, y), y). Gim\u00e9nez and Noy [20]\nhave shown that, if (x0 , y0 ) is a singular point of G0 (x, y), then (z0 , y0 ) -where z0 = F (x0 , y0 )-\nis a singular point of D(z, y). Hence, according to Lemma 4.4, (z0 , y0 ) is also a singular point of\nBgfw\u22652 (z, y) (precisely, is a singular point of the two series bounding Bgfw\u22652 (z, y) from above and\nbelow). Hence the composition scheme is critical. In addition, as proved in [20], F (x, y) admits a\nlog-free singular expansion of order 3/2 around (x0 , y0 ). Hence by Corollary 2.8, Cgfw\u22652 (x, y) is of\nstrong approximate-singular order \u03b1 around every singular point (x0 , y0 ) of F (x, y).\nLemma 4.8 (Connected graphs of genus g, and with fixed face-width). For g \u2265 0 and k \u2265 0,\nthe series Cgfw=k (x, y) is bounded coefficientwise by a series that is of strong approximate-singular\norder \u03b1 + 1/2 around every singular point (x0 , y0 ) of the series G0 (x, y) counting planar graphs.\nAnd the series Cg (x, y) is of strong approximate-singular order \u03b1 around (x0 , y0 ).\nProof. As in Lemma 4.4 (and using similar notations), the proof works by induction on g. The\nstated properties are true when g = 0 since by convention the face-width of any planar graph is\n(k)\ninfinite. Assume the property is true up to g \u2212 1, for g > 0. Let Eg be the family of graphs (as\nusual well-labelled, the vertices have distinct labels in [1..n]) made of two connected components,\nthe first one in Cgfw=k , the second one an oriented path of k vertices (again the second component is\n(k)\n\njust an artifact to have a reserve of k labelled vertices). Note that the series of Eg is xk Cgfw=k (x, y).\nLet Fg be the family of graphs with two connected components of positive genera (g1 , g2 ) adding\nup to g, each connected component having a marked vertex that is unlabelled; so the series of Fg\nsatisfies\nX\nFg (x, y) =\nCg1\u2032 (x, y)Cg2\u2032 (x, y).\ng1 +g2 =g\ng1 >0,g2 >0\n\nAnd let Hg be the doubly derived family of connected graphs of genus at most g (i.e., with two\nmarked unlabelled vertices): Hg = \u222ah\u2264g Ch\u2032\u2032 , so the series of Hg satisfies\nX\nHg (x, y) =\nCh\u2032\u2032 (x, y).\nh\u2264g\n\nDenote by Sk the group of permutations of k elements. We are going to define an injective mapping\n(k)\nfrom Eg to (Fg + Hg\u22121 ) \u00d7 Sk2 . (Note that Fg and Hg\u22121 only involve families of connected graphs\nof genus smaller than g, which will allow us to use induction to conclude the proof).\nLet (G, p) \u2208 Egk . Associate with G an embedding M (map of genus g) of face-width k. Let C\nbe an oriented non-contractible curve intersecting M at k vertices, one of which is marked as the\n\"starting vertex\" of C. Cut M along C, thus creating two cylindric ends, as in Figure 1. When\ndoing this, each vertex along C is split into two vertices, one in each cylindric end; to make the\nresulting graph well-labelled, the vertices (v1 , . . . , vk ) of the contour of C (with v1 the starting\nvertex) on the right tip are labelled according to p, i.e., vi receives the label of the ith vertex on\nthe path p.\n23\n\n\fThis process either yields two maps whose genera add up to g (case where C is surfaceseparating) or cuts a handle and yields a map of genus g \u2212 1. Add a special vertex vleft (vright ,\nresp.) in the tip-area of the left (right, resp.) cylindric end, and connect the special vertex to the k\nvertices on the contour of the tip-area (in Figure 1 a similar operation occurs, but the special vertex\nis only connected to the white vertices of the contour). Let G\u2032 be the graph (with two components\nif C is surface-separating, with one component otherwise) obtained after this process and forgetting\nthe embedding. Note that the k neighbours of vleft and the k neighbours of vright were matched in\nG along C; record this matching by two permutations (\u03c3, \u03c3 \u2032 ) \u2208 Sk defined as follows: if (v1 , . . . , vk )\nis the occurrence of C on the left (right, resp.) tip, then \u03c3(i) = j (\u03c3 \u2032 (i) = j, resp.) means that vi\nhas the jth smallest label among v1 , . . . , vk .\nWe claim that the mapping from (G, p) to (G\u2032 , \u03c3, \u03c3 \u2032 ) is injective. Indeed (G, p) can be recovered\nfrom (G\u2032 , \u03c3, \u03c3 \u2032 ) as follows:\n\u2022 For i \u2208 [1..k], let ui be the neighbour of vleft in G\u2032 with \u03c3(i)th smallest label, and let u\u2032i be the\nneighbour of vright in G\u2032 with \u03c3 \u2032 (i)th smallest label. Then G is recovered from G\u2032 by merging\nui with u\u2032i for i \u2208 [1..k] (the merged vertex keeps the label of ui ) and then by removing the\nspecial vertices vleft and vright and their incident edges.\n\u2022 And p is recovered as the oriented path of k vertices, where for i \u2208 [1..k] the ith vertex of p\nreceives the label of u\u2032i .\nSince the construction is injective, we have\nxk Cgfw=k (x, y) = Eg(k) (x, y) \u0016 (Fg (x, y) + Hg\u22121 (x, y)) * k!2 .\nBy induction, for h < g, Ch (x, y) is of strong approximate-singular order 5/2(1 \u2212 h) at any singular\npoint (x0 , y0 ) of G0 (x, y) (series counting connected planar graphs), hence Ch\u2032 (x, y) (Ch\u2032\u2032 (x, y),\nresp.) is of strong approximate-singular order 3/2 \u2212 5/2h (1/2 \u2212 5/2h, resp.). Hence Fg (x, y) (by\nLemma 2.2) and Hg (x, y) are both of strong approximate-singular order 3 \u2212 5/2g = \u03b1 + 1/2 at\n(x0 , y0 ). This proves the first assertion.\nThe second assertion follows easily. Indeed Cg = Cgfw\u22652 + Cgfw=1 . By Lemma 4.7, the first term\nis of strong approximate-singular order \u03b1. And the second term is negligible -bounded by a series\nof strong approximate-singular order \u03b1 + 1/2 at (x0 , y0 )- according to the first assertion applied\nto k = 1.\n4.3.4\n\nGraphs of genus g\n\nLemma 4.9 (Graphs of genus g). For g \u2265 0, the series Gg (x, y) counting graphs of genus g is\nof strong approximate-singular order \u03b1 around every singular point (x0 , y0 ) of the series G0 (x, y)\ncounting planar graphs.\nProof. Again the proof works by induction on g. The result has been proved by Gim\u00e9nez and\nNoy [20] for g = 0. Let g > 0, and assume the stated property is true up to genus g \u2212 1. The genera\nof the connected components of a genus g graph G add up to g. If two connected components are\nnon-planar then there is a partition of G into two non-planar graphs G1 , G2 whose genera add up\nto g\nGg (x, y) = Cg (x, y)G0 (x, y) + Kg (x, y),\n(25)\n\n24\n\n\fwhere\nKg (x, y) \u0016\n\nX\n\nGg1 (x, y)Gg2 (x, y).\n\ng1 +g2 =g\ng1 >0,g2 >0\n\nBy induction, for h < g, Gh (x, y) is of strong approximate-singular order 5(1\u2212h)/2 around (x0 , y0 ).\nHence, for g1 > 0, g2 > 0 such that g1 +g2 = g, Lemma 2.2 ensures that the series Gg1 (x, y)Gg2 (x, y)\nis of strong approximate-singular order 5/2(1 \u2212 g1 ) + 5/2(1 \u2212 g2 ) = \u03b1 + 5/2 around (x0 , y0 ). Thus\nthe dominating part of Gg (x, y) is Cg (x, y)G0 (x, y), which by Lemma 2.2 is of strong approximatesingular order \u03b1 around (x0 , y0 ) (indeed Cg (x, y) is of approximate-singular order \u03b1 by Lemma 4.8\nand G0 (x, y) is of approximate-singular order 5/2, as proved in [20]).\nLemma 4.10 (Graphs embeddable on Sg ). For g \u2265 0, the series Fg counting graphs embeddable on\nthe genus g surface is of strong approximate-singular order \u03b1 around every singular point (x0 , y0 )\nof the series C(x, y) counting connected planar graphs.\nProof. Note that a graph embeddable on Sg has genus at most g, hence\nFg (x, y) =\n\ng\nX\n\nGi (x, y).\n\ni=0\n\nBy Lemma 4.9, each series Gi (x, y) in the sum is of strong approximate-singular order 5(1 \u2212 i)/2,\nhence the dominating series in the sum is Gg (x, y), which is of strong approximate-singular order\n5(1 \u2212 g)/2 = \u03b1.\nTo conclude, applying the transfer theorems (Corollary 2.7) to the singular expansions of the\nseries counting graphs embeddable on Sg (Lemma 4.10), we obtain the asymptotic enumeration\nresults stated in Theorem 1.1.\n\n4.4\n\nThe non-orientable case\n\nThe proof of Theorem 1.2 follows the same lines as the proof of Theorem 1.1. Here, we explain\nthe mild differences and how to adapt the proof at those points. Let h > 0 and let Nh be the\nnon-orientable surface with h crosscaps. In this section, we use the same notations as before for\nthe generating series of maps and graphs, but with a different meaning: all series will refer to\nnon-orientable surfaces, and the subscript in the notation will refer to the non-orientable genus h\n(whereas in previous sections it referred to the oriented genus). For example, the generating series\nof near-irreducible quadrangulations on the surface Nh will be denoted by Sh (x, w).\nBefore giving the outline of the proof of Theorem 1.2, let us give some definitions. The nonorientable genus of a graph G is the smallest h such that G can be embedded in the non-orientable\nsurface Nh , and the non-orientable face-width of G is the largest face-width among all the embeddings of G on Nh . Since we will have to consider at the same time orientable and non-orientable surfaces, it makes sense to introduce the Euler genus \u03ba of a surface S, which is defined as \u03ba = 2\u2212 \u03c7(S),\nwhere \u03c7(S) is the Euler characteristic of S. Therefore \u03ba = 2g for the orientable surface Sg , and\n\u03ba = h for the non-orientable surface Nh . The Euler genus of a graph is the minimal Euler genus of\na surface (orientable or non-orientable) in which G can be embedded.\nWe now define \u03b1 = 52 (1 \u2212 h/2) (as we will see, the singular exponent for a given surface depends\nonly on its Euler genus, and h plays the same role here as 2g in the orientable case). The bijection\n25\n\n\fbetween maps and bipartite quadrangulations also works on the non-orientable surface Nh , and the\nextraction of a near-irreducible core works in the same way, so the equation relating rooted maps\nand near-simple quadrangulations on Nh is the same as for Sg (Equation (13)). The only difference\n\u2212\n\u2192\nis in the expression of the series M h (x, u) of rooted maps on Nh ; Arqu\u00e8s and Giorgetti have shown\nin [3] that there exists a trivariate polynomial Ph (X, Y, Z) such that\n\u221a\n\u2212\n\u2192\nPh (p, q, \u2206)\n,\nM h (x, u) =\n\u22065h/2\u22123\n\u221a\ni.e., the numerator-polynomial has \u2206 as additional parameter, where \u2206 is as beforep\nthe Jacobian\nof (9).\n\u221a Recall that around a singular point of (9), \u2206(p(x, u), q(x, u)) is of the order of 1 \u2212 x/\u03c1(u),\nso \u2206 is of the order of (1 \u2212 x/\u03c1(u))1/4 . Hence, in the non-orientable case singular expansions\ne = (1 \u2212 x/\u03c1(u))1/4 instead of\nare of the same form as in the orientable case, but in terms of X\nX = (1 \u2212 x/\u03c1(u))1/2 , which is a mild extension of the definition given in Section 2. The definition\nof the order of a singular expansion is also readily extended.\nSimilarly as in the orientable case, the sketch of proof in [6] ensures that Ph is non-zero at a\n\u2212\n\u2192\nsingular point (x0 , u0 ) for (p, q), so M h (x, u) admits a singular expansion of order \u03b1 at (x0 , u0 ).\nAdapting Equation (17), the expression of the series Sh\u2032 of rooted near-simple quadrangulations on\nNh is of the form\nq\n\u0011\n\u0010\ne s)\ne\n\u2206(r,\nr,\ns,\nP\ng\n1\n.\nSh\u2032 (x, w) =\ne s))5g\u22123\ne\n(\u2206(r,\nA(r, s)\np\ne in the numeratorAll the arguments of Lemma 3.3 still apply, even with the extra parameter \u2206\npolynomial, so Sh has a singular expansion of order \u03b1 at every singular point of (14). In the\nstatement of Lemma 3.5, \u03b1 + 1/2 has to be changed to \u03b1 + 1/4 (this is no problem, the contribution\nof near-irreducible quadrangulations of a fixed edge-width is still negligible since the singular order\nis larger than the one of near-irreducible quadrangulations). This is due to the fact that there is\none more case to consider in the proof: that the marked cycle C of length 2i crosses a crosscap.\nIn that case, cutting along C removes the crosscap, and yields a surface of Euler genus h \u2212 1. So\nwe obtain either a quadrangulation on Nh\u22121 or a quadrangulation on the orientable surface Sg ,\nwhere g = h\u22121\n2 (the latter case may only appear if h is odd). In both cases, C yields a boundary\nof length 4i delimiting a \"hole\" in the surface. Filling this hole with a disk and placing a marked\nblack vertex connected to all white vertices on the contour, we obtain a quadrangulation on Nh\u22121\nor Sg with a marked black vertex. This quadrangulation may not be near-irreducible. However, any\ncontractible 2-cycle or 4-cycle bounds a disk that contains the marked black vertex. These cycles\nare therefore nested around the marked vertex. Hence by similar arguments as in Lemma 3.5, the\ncontribution of \"C crossing a crosscap\" is bounded by a series of the same singular order as the\nseries counting near-irreducible quadrangulations on Nh\u22121 with a marked vertex, plus those on Sg\n(when h is odd). By induction, the latter series with no marked vertex is of singular order \u03b1 + 5/4\n(since \u03b1 + 5/4 = 25 (1 \u2212 (h \u2212 1)/2) = 25 (1 \u2212 g)). The effect of marking a vertex is to decrease the\norder by 1, so the bounding series is actually of order \u03b1 + 1/4. The other two cases (C being\nsurface-separating and C cutting a handle) still yield contributions bounded by a series of singular\norder \u03b1 + 1/2. Let us remark that in these cases we may also end up with an orientable surface\nSg\u2032 but since for each g\u2032 the singular orders for Sg\u2032 and N2g\u2032 are the same, the orientability of the\nsurface obtained after cutting along C has no effect on the singular order of the corresponding\nbounding series.\n26\n\n\fThe next step is to go to 3-connected graphs of non-orientable genus h via 3-connected maps on\nNh . By Proposition 5.5.12 in [25], a map on Nh is 3-connected if the associated quadrangulation is\nirreducible (no 2-cycles and no non-facial 4-cycles at all). Conversely, the quadrangulation associated with a 3-connected map of face-width \u2265 2 is near-irreducible (no 2-cycles and no contractible\nnon-facial 4-cycles). So 3-connected maps on Nh have the same approximate-singular expansion\nas near-irreducible quadrangulations. Since a 3-connected graph of non-orientable genus h has a\nunique embedding if the face width is at least 2h + 3 [28], one shows that the corresponding series is of strong approximate-singular order \u03b1 similarly as in Lemma 4.2. Finally, one proceeds\nwith 2-connected graphs of non-orientable genus h and then with connected graphs and arbitrary\ngraphs similarly as in the orientable case, since the statements in Theorem 4.1 also hold with the\nnon-orientable genus. Again in Lemmas 3.5, 4.4, 4.5, and 4.8, the bounding series for graphs with\nfixed face-width is of strong approximate-singular order \u03b1 + 1/4 instead of \u03b1 + 1/2 (which is still\nfine as long as the order is larger than \u03b1), since there is a third case where the distinguished\nnon-contractible curve crosses a crosscap.\n(\u03ba)\n\nEuler genus. Our results also show that, for each integer \u03ba \u2265 0 the number en of graphs with\nn vertices and Euler genus \u03ba satisfies:\nen(\u03ba) \u223c \u0109(\u03ba) n5(\u03ba\u22122)/4\u22121 \u03b3 n n!\n\n(26)\n\nwhere \u0109(\u03ba) = c\u0303(\u03ba) if \u03ba is odd, and \u0109(\u03ba) = c(\u03ba/2) + c\u0303(\u03ba) if \u03ba is even. This result follows from Lemma 4.8,\nfrom the analogous result for non-orientable surfaces, and from the fact (shown in [28]) that for\neach \u03ba every graph of Euler genus \u03ba and face-width more than 2\u03ba + 3 can be embedded either in\nthe non-orientable surface N\u03ba or in the orientable surface S\u03ba/2 , but not both.\n\n5\n\nRandom graphs of genus g\n\nIn this section we analyze several fundamental parameters of graphs of genus g and derive limit\ndistribution laws for them. In all cases the limit laws do not depend on the genus, a phenomenon\nthat has been observed previously for maps on surfaces (see, for instance, [18]). When we say that\nan event holds with high probability we mean that the probability of the event tends to 1 as n tends\nto infinity. The variance of a random variable X is denoted by \u03c3 2 (X), and a sequence of random\nvariables (Xn )n\u22651 is called asymptotically normal if (Xn \u2212 E[Xn ])/\u03c3 2 (Xn ) converges in distribution\nto a standard Gaussian random variable N (0, 1) (see [16, Part C]).\nWe start with two basic parameters in order to motivate the general analysis. We show that,\nas for planar graphs, the number of edges is asymptotically normal and the number of connected\ncomponents is asymptotically Poisson distributed.\nTheorem 5.1. The number of edges Xn in a random graph of fixed genus g with n vertices is\nasymptotically normal and\nE(Xn ) \u223c \u03ban,\n\u03c3 2 (Xn ) \u223c \u03bbn\nwhere \u03ba \u2248 2.21326 and \u03bb \u2248 0.43034 are the same constants as for planar graphs.\nP\nProof. By Lemma 4.9, the generating function Gg (x, y) =\ngn,k y k xn /n! of graphs of genus g\ncounted according to the number of vertices and edges is of approximate-singular order \u03b1. This\n27\n\n\fmeans that there exist sequences fn,k and hn,k with\nfn,k \u2264 gn,k \u2264 hn,k\nP\nP\nsuch that f (x, y) =\nfn,k y k xn /n! and h(x, y) =\nhn,k y k xn /n! have singular expansions of order\n\u03b1 with same singularity function and the same leading coefficients. By the Quasi-powers Theorem\n[16], the random variables with probability generating functions\n[xn ]h(x, y)\n.\n[xn ]h(x, 1)\n\n[xn ]f (x, y)\n,\n[xn ]f (x, 1)\n\nare asymptotically normal. It follows that Xn , whose distribution is given by [xn ]G(x, y)/[xn ]G(x, 1),\nalso converges to a normal law. The expectation and variance are determined by the singularity\nfunction \u03c1(y) as\n\u0012 \u2032 \u00132\n\u03c1 (1)\n\u03c1\u2032\u2032 (1) \u03c1\u2032 (1)\n\u03c1\u2032 (1)\n2\n.\n,\n\u03c3 =\u2212\n\u2212\n+\n\u03bc=\u2212\n\u03c1(1)\n\u03c1(1)\n\u03c1(1)\n\u03c1(1)\nBy Lemma 4.9, \u03c1(y) is independent of the genus and we are done.\nFollowing the lines of the former proof, one can also show that several basic parameters, such as\nthe number of blocks, the number of cut vertices, and the number of appearances of a fixed planar\ngraph (see [20] for a precise definition), follow a normal law with the same moments as for planar\ngraphs [22]. In order to avoid repetition we omit the corresponding proofs. We remark in particular\nthat, given a fixed planar graph H, a random graph of genus g contains a subgraph isomorphic to\nH with high probability; in fact, it contains a linear number of disjoint copies of H.\nTheorem 5.2. The number of connected components in a random graph of fixed genus g is distributed asymptotically as 1 + X, where X is a Poisson law with parameter \u03bd \u2248 0.037439, same\nas for planar graphs. In particular, the probability that a random graph of genus g is connected is\nasymptotically e\u2212\u03bd .\nProof. As shown in the proof of Theorem 4.9, a graph of genus g has a unique connected component\nof genus g with high probability, and the remaining components are planar. Hence, in order to\nstudy the number of components it is enough to work with the generating function\nuCg (x)euC0 (x) ,\nthe first two factors encoding the component of genus g, the exponential term encoding the\nplanar components. The generating function of graphs with exactly k + 1 components is then\nCg (x)C0 (x)k /k!. By Lemma 4.8, the series Cg (x) is dominated coefficientwise by series having a\nsingular expansion of the form\naX \u03b1 + O(X \u03b1+1 ),\np\nwhere X = 1 \u2212 x/\u03c1. On the other hand, we have C0 (x) = C0 + O(X) (see [20]; because \u03b1 < 0 we\nonly need the constant term in the singular expansion of C0 ). Then the probability of a random\ngraph having exactly k + 1 components is asymptotically equal to\nk\n[xn ]Cg (x)C0 (x)k /k!\naC0k /k!\n\u2212C0 C0\n\u223c\n.\n=\ne\naeC0\nk!\n[xn ]Cg (x)eC0 (x)\n\nThis is precisely a Poisson distribution with parameter C0 , as for planar graphs.\n28\n\n\fA similar analysis as that in the previous proof shows that there is a unique giant component\nof genus g.\nTheorem 5.3. Let Ln denote the size of the largest connected component in a random graph of\nfixed genus g with n vertices, and let Mn = Ln \u2212 n be the number of vertices not in the largest\ncomponent. Then\n\u03b3 \u2212k\n,\nP(Mn = k) \u223c p * gk\nk!\nwhere p is the probability of a random planar graph being connected, gk is the number of planar\ngraphs with k vertices, and \u03b3 is the planar growth constant.\nProof. According to the results of the previous section, the number Gn of graphs of genus g grows\nlike\nGn \u223c G * n\u2212\u03b1\u22121 \u03b3 n n!,\nand the number Cn of connected graphs of genus g grows like\nCn \u223c C * n\u2212\u03b1\u22121 \u03b3 n n!.\nUsing again the fact that there is a unique component of genus g with high probability, we find\nthat the probability that Mn = k is asymptotically equal to\n\u0012 \u0013\nn Cn\u2212k gk\n,\nGn\nk\n\u0001\nsince there are nk ways of choosing the labels of the vertices not in the largest component, Cn\u2212k\nways of choosing the largest component, and gk ways of choosing the complement. Using the\nprevious estimates we get\nC \u03b3 \u2212k\n.\nP(Mn = k) \u223c gk\nG\nk!\nBut C/G is the asymptotic probability of a graph of genus g being connected, and by Theorem 5.2\nit is the same as for planar graphs.\nIn the next two results we analyze the size of the largest block and the size of the largest 3connected component. For the precise form of the Airy law of map type, a continuous distribution\ndefined in terms of the Airy function, and the computation of the parameters for planar graphs,\nwe refer to [4] and [22, Section 5].\nTheorem 5.4. The size Xn of the largest block in a random connected graph of fixed genus g with\nn vertices follows asymptotically an Airy law of the map type, with the same parameters as for\nplanar graphs. In particular\nE(Xn ) \u223c \u03b1n,\n2\n\nwhere \u03b1 \u2248 0.9598, and the size of the second largest block is o(n 3 +\u01eb ), for any \u01eb > 0. Moreover the\nlargest block has genus g with high probability.\nProof. By the results of the previous section, we know that with high probability a connected graph\nof genus g has a unique block of genus g, and the remaining blocks are planar. As we are going to\nshow, the unique block of genus g is the largest block with high probability.\n29\n\n\fEquation (21) encodes precisely this statement. Since almost all 2-connected graphs have facewidth \u2265 2, it is enough to consider the simplified composition scheme Bg (F (x)), where F (x) =\nxC \u2032 (x) is the generating function of vertex-pointed connected planar graphs. In the terminology\nof [4] this scheme is critical (see Lemma 2.6), since the evaluation F (\u03c1) of F (x) at its singularity\nis equal to the singularity of Bg (x), which is the same as the singularity of B0 (x).\nBy general principles (see Theorem 12 and Appendix D in [4]) it follows that the size of the block\nof genus g follows a continuous Airy law. The parameters of the law depend only on the singular\ncoefficients of F (x), hence they are the same as for planar graphs. In particular E(Xn ) \u223c \u03b1n,\nwhere \u03b1 = \u2212F0 /F2 and F (x) = F0 + F2 (1 \u2212 x/\u03c1) + O(1 \u2212 x/\u03c1)3/2 is the singular expansion of F (x)\nat \u03c1.\nWe can also adapt the proof in [22] for the largest 3-connected component. The key point is that\nnow the relevant composition scheme is Tg (x, D(x, y)), instead of T0 (x, D(x, y)) as for planar graphs.\nAgain, this is because with high probability a 2-connected graph of genus g has face-width \u2265 3,\nhence it has a unique 3-connected component of genus g and the remaining 3-connected components\nare planar. The most technical part of the proof in the planar case is to prove that two different\nprobability distributions for 2-connected planar graphs are asymptotically equal, as the number of\nvertices and edges tends to infinity at a given ratio (see [22, Section 6.3]). One distribution comes\nfrom planar networks counted by the number of edges with an appropriate weight on vertices, but\nsince we replace edges of the 3-connected component of genus g by planar networks, we are dealing\nwith the same probability distribution. The second distribution comes from extracting the largest\nblock in random planar graphs with a given number of vertices. But we have shown in the previous\ntheorem that the distribution of the largest block is asymptotically independent of the genus.\nThe rest of the proof (see [22, Section 6.4]) is easily adapted. For computing the moments we\nneed the asymptotic expected number of edges in a random 3-connected graph of genus g, but this\nis the same as for 3-connected planar graphs, since it depends only on the singularity function of\nTg (x, z), which we have proved does not depend on g. In conclusion, we obtain the following result,\nwhich is analogous to Theorem 6.1 from [22].\nTheorem 5.5. The size Xn of the largest 3-connected component in a random connected graph\nof fixed genus g with n vertices follows asymptotically an Airy law of the map type, with the same\nparameters as for planar graphs. In particular\nE(Xn ) \u223c \u03b12 n,\n2\n\nwhere \u03b12 \u2248 0.7346, and the size of the second largest 3-connected component is o(n 3 +\u01eb ), for any\n\u01eb > 0. Moreover the largest 3-connected component has genus g with high probability.\nWe conclude with the chromatic number of a random graph of genus g. According to Lemma 4.8,\nasymptotically almost surely a random graph of genus g has face-width greater than any fixed\nnumber k(g). Taking k(g) = 214g+6 this implies that it is 5-colorable by a result of Thomassen [29].\nMoreover, as mentioned just before Theorem 5.2, a random graph of genus g has a linear number\nof copies of K4 with high probability, in particular has chromatic number at least 4. Consequently:\nTheorem 5.6. The chromatic number of a random graph of fixed genus g with n vertices is asymptotically almost surely in {4, 5}.\nUnfortunately, we do not know if both values 4 and 5 appear on a positive proportion of graphs\nof genus g. However, we conjecture the following:\n30\n\n\fConjecture 5.1. The chromatic number of a random graph of fixed genus g with n vertices is\nasymptotically almost surely equal to 4.\nMore precise results hold for the list-chromatic number: as shown in [12], a graph of fixed genus\nis 5-choosable provided its face-width is large enough. Moreover, there exist planar graphs that are\nnot 4-choosable [32]. If we fix any of them, then it is asymptotically almost surely contained in a\nrandom graph of genus g. Therefore we have:\nTheorem 5.7. The list-chromatic number of a random graph of fixed genus g with n vertices is\nasymptotically almost surely equal to 5.\nRemark. All these result also hold for the random graph of fixed non-orientable genus h, with\nexactly the same ingredients. Since a random graph with n vertices embeddable on Sg is asymptotically almost surely of genus g, and a random graph with n vertices embeddable on Nh is\nasymptotically almost surely of non-orientable genus h, these results hold also for the random\ngraph embeddable on Sg and for the random graph embeddable on Nh .\n\nReferences\n[1] D. Arques. Relations fonctionnelles et d\u00e9nombrement de cartes point\u00e9es sur le tore. J. Combin.\nTheory Ser. B, 43:253\u2013274, 1987.\n[2] D. Arques, A. Giorgetti. \u00c9num\u00e9ration des cartes point\u00e9es sur une surface orientable de genre\nquelconque en fonction des nombres de sommets et de faces. J. Combin. Theory Ser. B,\n77(1):1\u201324, 1999.\n[3] D. Arques, A. Giorgetti. Counting rooted maps on a surface. Theoret. Comput. Sci., 234:255\u2013\n272, 2000.\n[4] C. Banderier, P. Flajolet, G. Schaeffer, M. Soria, Random maps, coalescing saddles, singularity\nanalysis, and Airy phenomena. Random Structures Algorithms 19:194\u2013246, 2001.\n[5] E. A. Bender, E. R. Canfield. The asymptotic number of rooted maps on a surface. J. Combin.\nTheory Ser. A, 43:244\u2013257, 1986.\n[6] E. A. Bender, E. R. Canfield, L. B. Richmond. The asymptotic number of rooted maps on\nsurfaces. II. Enumeration by vertices and faces. J. Combin. Theory Ser. A, 63(2):318\u2013329,\n1993.\n[7] E. Bender, Z. Gao.\narXiv:0912.4670.\n\nAsymptotic enumeration of labelled graphs with a given genus.\n\n[8] E. Bender, Z. Gao, N. Wormald. The number of labeled 2-connected planar graphs. Electron.\nJ. Combin., 9:R43, 2002.\n[9] E. A. Bender, Z. Gao, L. B. Richmond, N. Wormald. Asymptotic properties of rooted 3connected maps on surfaces. J. Austral. Math. Soc., Series A, 60:31\u201341, 1996.\n[10] E. A. Bender, L. B. Richmond. The asymptotic enumeration of rooted convex polyhedra. J.\nCombin. Theory Ser. B, 36(3):276\u2013283, 1984.\n31\n\n\f[11] G. Chapuy, \u00c9. Fusy, M. Kang, B. Shoilekova. A complete grammar for decomposing a family\nof graphs into 3-connected components. Electron. J. Combin., 15(1):R148, 2008.\n[12] M. Devos, K. Kawarabayashi, B. Mohar. Locally planar graphs are 5-choosable, J. Combin.\nTheory Ser. B, 98:1215\u20131232, 2008.\n[13] M. Drmota. Systems of functional equations. Random Structures Algorithms, 10(1-2):103\u2013124,\n1997.\n[14] M. Drmota, O. Gim\u00e9nez, M. Noy. Vertices of given degree in series-parallel graphs, to appear\nin Random Structures Algorithms.\n[15] M. Drmota, O. Gim\u00e9nez, M. Noy.\narXiv:0911.4331\n\nDegree distribution in random planar graphs.\n\n[16] P. Flajolet, R. Sedgewick. Analytic Combinatorics. Cambridge University Press, 2009.\n[17] \u00c9. Fusy.\nEnumeration of unrooted maps using tree-decomposition.\nS\u00e9minaire\nLotharingien de Combinatoire,\nB54Al,\n2007.\n44 pages. Available at\nhttp://www.emis.de/journals/SLC/wpapers/s54Afusy.pdf.\n[18] Z. Gao, B. L. Richmond, Root vertex valency distributions of rooted maps and rooted triangulations. European J. Combin. 15 (1994), 483\u2013490.\n[19] S. Gerke, C. McDiarmid, A. Steger, A. Weissl, Random planar graphs with given average\ndegree. In Combinatorics, complexity, and chance, pp. 83\u2013102, Oxford Lecture Ser. Math.\nAppl., 34, Oxford Univ. Press, 2007.\n[20] O. Gim\u00e9nez, M. Noy. Asymptotic enumeration and limit laws of planar graphs. J. Amer.\nMath. Soc. 22 (2009), 309\u2013329.\n[21] O. Gim\u00e9nez, M. Noy. Counting planar graphs and related families of graphs. In Survey in\nCombinatorics 2009, pp. 169\u2013210, Cambridge University Press, Cambridge, 2009\n[22] O. Gim\u00e9nez, M. Noy, J. Ru\u00e9. Graph classes with given 3-connected components: asymptotic\nenumeration and random graphs. arXiv:0907.0376\n[23] I. P. Goulden, D. M. Jackson. Combinatorial Enumeration. John Wiley, New York, 1983.\n[24] B. Mohar. Combinatorial local planarity and the width of graph embeddings. Canad. J. Math.\n44 (1992), 1272\u20131288.\n[25] B. Mohar, C. Thomassen. Graphs on Surfaces. Johns Hopkins University Press, 2001.\n[26] R.C. Mullin, P.J. Schellenberg. The enumeration of c-nets via quadrangulations. J. Combin.\nTheory, 4:259\u2013276, 1968.\n[27] C. McDiarmid. Random graphs on surfaces. J. Combin. Theory Ser. B, 98:778\u2013797, 2008.\n[28] N. Robertson, R. P. Vitray. Representativity of surface embedding. In Paths, Flows, and\nVLSI-layout, Eds: B. Korte, L. Lov\u00e1sz, H. J. Pr\u00f6mel, A. Schrijver, pp. 293\u2013328, Springer,\nBerlin, 1990.\n32\n\n\f[29] C. Thomassen. 5-coloring maps on surfaces. J. Combin. Theory Ser. B, 59:89\u2013105, 1993.\n[30] W.T. Tutte. A census of planar maps. Canad. J. Math., 15:249\u2013271, 1963.\n[31] W.T. Tutte. Connectivity in Graphs. Oxford U.P, 1966.\n[32] M. Voigt. List colourings of planar graphs. Discrete Math., 120:215\u2013219, 1993.\n[33] T. R. S. Walsh. Counting labelled three-connected and homeomorphically irreducible twoconnected graphs. J. Combin. Theory Ser. B, 32:1\u201311, 1982.\n\n33\n\n\f"}