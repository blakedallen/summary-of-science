{"id": "http://arxiv.org/abs/1104.1038v2", "guidislink": true, "updated": "2011-09-27T12:43:55Z", "updated_parsed": [2011, 9, 27, 12, 43, 55, 1, 270, 0], "published": "2011-04-06T08:51:52Z", "published_parsed": [2011, 4, 6, 8, 51, 52, 2, 96, 0], "title": "Comparison of methods to extract an asymmetry parameter from data", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.4633%2C1104.3340%2C1104.1284%2C1104.4656%2C1104.1526%2C1104.3975%2C1104.3627%2C1104.1401%2C1104.0006%2C1104.0159%2C1104.1875%2C1104.2375%2C1104.4295%2C1104.0244%2C1104.1613%2C1104.0337%2C1104.4515%2C1104.0801%2C1104.5336%2C1104.1493%2C1104.3810%2C1104.1941%2C1104.2038%2C1104.2534%2C1104.2146%2C1104.1794%2C1104.0345%2C1104.0390%2C1104.3930%2C1104.4346%2C1104.3329%2C1104.4573%2C1104.1712%2C1104.5522%2C1104.4638%2C1104.3623%2C1104.2520%2C1104.5049%2C1104.3959%2C1104.0072%2C1104.2358%2C1104.4729%2C1104.4977%2C1104.3784%2C1104.1323%2C1104.3774%2C1104.2690%2C1104.0818%2C1104.1498%2C1104.1279%2C1104.5539%2C1104.4870%2C1104.5682%2C1104.1507%2C1104.0613%2C1104.4509%2C1104.1038%2C1104.2134%2C1104.2233%2C1104.2485%2C1104.1851%2C1104.4815%2C1104.4362%2C1104.5656%2C1104.2198%2C1104.4136%2C1104.0430%2C1104.2389%2C1104.1928%2C1104.2977%2C1104.2378%2C1104.0011%2C1104.4044%2C1104.3944%2C1104.4042%2C1104.1819%2C1104.2130%2C1104.4538%2C1104.1119%2C1104.0207%2C1104.5239%2C1104.3010%2C1104.2213%2C1104.1662%2C1104.3354%2C1104.2599%2C1104.4105%2C1104.2281%2C1104.3300%2C1104.4793%2C1104.3699%2C1104.5008%2C1104.0861%2C1104.3809%2C1104.2211%2C1104.3709%2C1104.2954%2C1104.1547%2C1104.1528%2C1104.0637%2C1104.4966&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Comparison of methods to extract an asymmetry parameter from data"}, "summary": "Several methods to extract an asymmetry parameter in an event distribution\nfunction are discussed and compared in terms of statistical precision and\napplicability. These methods are: simple counting rate asymmetries, event\nweighting procedures and the unbinned extended maximum likelihood method. It is\nknown that weighting methods reach the same figure of merit (FOM) as the\nlikelihood method in the limit of vanishing asymmetries. This article presents\nan improved weighting procedure reaching the FOM of the likelihood method for\narbitrary asymmetries. Cases where the maximum likelihood method is not\napplicable are also discussed.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1104.4633%2C1104.3340%2C1104.1284%2C1104.4656%2C1104.1526%2C1104.3975%2C1104.3627%2C1104.1401%2C1104.0006%2C1104.0159%2C1104.1875%2C1104.2375%2C1104.4295%2C1104.0244%2C1104.1613%2C1104.0337%2C1104.4515%2C1104.0801%2C1104.5336%2C1104.1493%2C1104.3810%2C1104.1941%2C1104.2038%2C1104.2534%2C1104.2146%2C1104.1794%2C1104.0345%2C1104.0390%2C1104.3930%2C1104.4346%2C1104.3329%2C1104.4573%2C1104.1712%2C1104.5522%2C1104.4638%2C1104.3623%2C1104.2520%2C1104.5049%2C1104.3959%2C1104.0072%2C1104.2358%2C1104.4729%2C1104.4977%2C1104.3784%2C1104.1323%2C1104.3774%2C1104.2690%2C1104.0818%2C1104.1498%2C1104.1279%2C1104.5539%2C1104.4870%2C1104.5682%2C1104.1507%2C1104.0613%2C1104.4509%2C1104.1038%2C1104.2134%2C1104.2233%2C1104.2485%2C1104.1851%2C1104.4815%2C1104.4362%2C1104.5656%2C1104.2198%2C1104.4136%2C1104.0430%2C1104.2389%2C1104.1928%2C1104.2977%2C1104.2378%2C1104.0011%2C1104.4044%2C1104.3944%2C1104.4042%2C1104.1819%2C1104.2130%2C1104.4538%2C1104.1119%2C1104.0207%2C1104.5239%2C1104.3010%2C1104.2213%2C1104.1662%2C1104.3354%2C1104.2599%2C1104.4105%2C1104.2281%2C1104.3300%2C1104.4793%2C1104.3699%2C1104.5008%2C1104.0861%2C1104.3809%2C1104.2211%2C1104.3709%2C1104.2954%2C1104.1547%2C1104.1528%2C1104.0637%2C1104.4966&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Several methods to extract an asymmetry parameter in an event distribution\nfunction are discussed and compared in terms of statistical precision and\napplicability. These methods are: simple counting rate asymmetries, event\nweighting procedures and the unbinned extended maximum likelihood method. It is\nknown that weighting methods reach the same figure of merit (FOM) as the\nlikelihood method in the limit of vanishing asymmetries. This article presents\nan improved weighting procedure reaching the FOM of the likelihood method for\narbitrary asymmetries. Cases where the maximum likelihood method is not\napplicable are also discussed."}, "authors": ["J\u00f6rg Pretz"], "author_detail": {"name": "J\u00f6rg Pretz"}, "author": "J\u00f6rg Pretz", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/j.nima.2011.08.036", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/1104.1038v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1104.1038v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "17 pages, 7 figures", "arxiv_primary_category": {"term": "physics.data-an", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "physics.data-an", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "hep-ex", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.ST", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "stat.TH", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1104.1038v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1104.1038v2", "journal_reference": null, "doi": "10.1016/j.nima.2011.08.036", "fulltext": "arXiv:1104.1038v2 [physics.data-an] 27 Sep 2011\n\nComparison of methods to extract an\nasymmetry parameter from data\nJ\u00f6rg Pretz \u2217\nPhysikalisches Institut, Universit\u00e4t Bonn, 53115 Bonn, Germany\n\nAbstract\nSeveral methods to extract an asymmetry parameter in an event distribution function are discussed and compared in terms of statistical precision and applicability.\nThese methods are: simple counting rate asymmetries, event weighting procedures\nand the unbinned extended maximum likelihood method. It is known that weighting methods reach the same figure of merit (FOM) as the likelihood method in the\nlimit of vanishing asymmetries. This article presents an improved weighting procedure reaching the FOM of the likelihood method for arbitrary asymmetries. Cases\nwhere the maximum likelihood method is not applicable are also discussed.\nKey words: event weighting, minimal variance bound, Cram\u00e9r-Rao inequality,\nasymmetry extraction, optimal observables, parameter determination, maximum\nlikelihood\nPACS: 02.70.Rr, 13.88.+e\n\n1\n\nIntroduction\n\nWe consider two differential event distributions n\u00b1 (x) following the functional\nform\nn\u00b1 (x) = \u03b1(x)(1 \u00b1 \u03b2(x)A) .\n\n(1)\n\nIn a typical experimental situation encountered in particle physics \u03b1(x) includes a flux and acceptance factor and \u03b2(x) is an analyzing power. Both\ndepend on a set of kinematic variables here denoted by x. Concrete examples\n\u2217 corresponding author\nEmail address: jorg.pretz@cern.ch (J\u00f6rg Pretz).\n\nPreprint submitted to Elsevier\n\n29 October 2018\n\n\fare spin cross section asymmetries and muon decay. In the latter case the\nasymmetry corresponds to the muon polarization. The two data sets (+ and\n\u2212) are for example obtained by changing the sign of a polarization. The goal is\nto extract the parameter A by measuring the event distributions n\u00b1 (x). This\nwould be an easy task if both \u03b1(x) and \u03b2(x) were known. However in many\napplications the factor \u03b1(x) is not known, or not accurately enough known\nand only \u03b2(x) is given.\nSection 2 presents various methods to extract the parameter A: The simplest\nmethod, based on counting rate asymmetries, the more efficient extended unbinned maximum likelihood (EML) method and finally methods based on\nevent weighting are discussed. While in Section 2 we assume that the factor\n\u03b1(x) is the same for both data sets, Section 3 extends the discussion to the\ncase where one has two different factors. Up to Section 3 we assume that the\nnumber of observed events is large enough so that averages can be replaced by\nthe corresponding expectation values. Effects occurring at low statistics event\nsamples are discussed in Section 4. A summary and conclusions are given in\nSection 5.\n\n2\n\nDifferent Methods to extract A\n\n2.1 Determining A from counting rate asymmetry\nThe expectation value of the number of events for the two data sets reads\nD\n\nE\n\nN\u00b1 =\n\nZ\n\nR\n\nn\u00b1 (x)dx = (1 \u00b1 h\u03b2i A)\n\nZ\n\n\u03b1(x)dx\n\n(2)\n\nR\n\nwith h\u03b2i = \u03b1\u03b2dx/ \u03b1dx. The integrals run over the kinematic\nrange of x.\nR\nThe asymmetry A can be extracted without the knowledge of \u03b1(x)dx:\nA=\n\n1 hN + i \u2212 hN \u2212 i\n.\nh\u03b2i hN + i + hN \u2212 i\n\n(3)\n\nEq. (3) leads to following estimator for A:\n\u00c2cnt = P\n\nN+ \u2212 N\u2212\nN+ + N\u2212\nN+ \u2212 N\u2212\n=\nP\nP\nP\n+\n\u2212\n\u2212 \u03b2i N + N\n\u2212 \u03b2i\n+ \u03b2i +\n+ \u03b2i +\n\nwhere \u03b2i \u2261 \u03b2(xi ), N + and N \u2212 are the numbers of observed events. The sums\nP\nP\n+ and\n\u2212 run over all events in the corresponding data set (+ or \u2212).\n2\n\n\fAs shown in Section 2.3 and App. A, the figure of merit (FOM), i.e. the inverse\nof the variance on \u00c2cnt , is\nFOM\u00c2cnt = N\n\nh\u03b2i2\n1 \u2212 A2 h\u03b2 2 i\n\n(4)\n\nwhere N = N + + N \u2212 denotes the total number of events.\nThis figure of merit may be increased if a cut is set to remove some data with\nlow values of \u03b2. However, it will not reach the FOM of the unbinned extended\nlikelihood method discussed now, unless \u03b2(x) is constant.\n2.2 Extended Maximum Likelihood (EML) Method\nWe now turn to the unbinned extended maximum likelihood (EML) method[1,2]\nwhich is known to reach the Cram\u00e9r-Rao limit of the lowest possible statistical\nerror. The log-likelihood function derived from Eq. (1) reads\nl=\n\nX\n\nln (\u03b1i (1 + \u03b2i A)) \u2212 hN + i(A) +\n\n+\n\nX\n\nln (\u03b1i (1 \u2212 \u03b2i A)) \u2212 hN \u2212 i(A) .\n\n\u2212\n\nUsing the expression in Eq. (2) for the expectation values hN \u00b1 i results in\n\nl=\n\nX\n\nln (1 + \u03b2i A) +\n\n+\n\nX\n\nln (1 \u2212 \u03b2i A) \u2212 2\n\n\u2212\n\nZ\n\n\u03b1(x)dx \u2212\n\nX\n\nln \u03b1i .\n\n(5)\n\n+,\u2212\n\nThe last two terms do not depend on A and can be ignored in the likelihood\nmaximization. The asymmetry A can thus be determined without knowledge\nof \u03b1(x). For small values of \u03b2A one can even derive an analytic expression for\n\u00c2LH which reads\n\u00c2LH\n\n\u03b2i\n\u03b2i \u2212\n= P 2 P\u2212 2 .\n\u2212 \u03b2i\n+ \u03b2i +\nP\n\n+\n\nP\n\n(6)\n\nFor arbitrary asymmetries the maximization has to be done numerically. Note,\nthat this requires CPU intensive sums over all events in the maximization\nprocedure.\nThe figure of merit (FOM) is given by\nFOM\u00c2LH\n\nX\nX\n\u03b2i2\n\u03b2i2\n\u22022l\n+\n.\n=\u2212 2 =\n2\n2\n\u2202A\n+ (1 + \u03b2i A)\n\u2212 (1 \u2212 \u03b2i A)\n\n3\n\n\fReplacing the sum over events by integrals one finds\n\u03b1(1 + \u03b2A)\u03b2 2\ndx +\n(1 + \u03b2A)2\nZ\n2\u03b1\u03b2 2\n=\ndx .\n1 \u2212 \u03b2 2 A2\n\nFOM\u00c2LH =\n\nZ\n\nZ\n\n\u03b1(1 \u2212 \u03b2A)\u03b2 2\ndx\n(1 \u2212 \u03b2A)2\n(7)\n\nNoting, that for an arbitrary function f (x) the average is defined by\nhf i =\n\nR\n\nf (x)(n+ (x) + n\u2212 (x))dx\nR\n=\nn+ (x) + n\u2212 (x)dx\n\nR\n\n\u03b1(x)f (x)dx\nR\n,\n\u03b1(x)dx\n\nthe figure of merit can be written as\nFOM\u00c2LH = N\n\n*\n\n\u03b22\n1 \u2212 \u03b2 2 A2\n\n+\n\n.\n\n(8)\n\n2.3 Weighting Method\nNext, consider the following estimator\nwi \u2212 \u2212 wi\n\u00c2w = P\nP\n\u2212 wi \u03b2i\n+ wi \u03b2i +\nP\n\nP\n\n+\n\n(9)\n\nwhere wi \u2261 w(xi ) is a, for the moment arbitrary, weight factor assigned to\nevery event. The expectation value of \u00c2w equals A independently of the weight\nfunction w(x) used. App. A shows that\nFOM\u00c2w = N\n\nhw\u03b2i2\n.\nhw 2 (1 \u2212 A2 \u03b2 2 )i\n\n(10)\n\nTwo cases are of interest:\n1.) Setting w = 1 corresponds to the counting rate asymmetry discussed in\nSection 2.1 and proves Eq. (4) for the FOM.\n2.) In the case w = \u03b2 the FOM is\nFOM\u00c2w=\u03b2 = N\n\nh\u03b2 2 i\n4\n\ni\n1 \u2212 A2 h\u03b2\nh\u03b2 2 i\n\n.\n\nA comparison with Eq. (8) indicates that FOM\u00c2w=\u03b2 coincides with the FOM\nof the likelihood method for vanishing A. Actually, in this case, the two es4\n\n\ftimators are identical as can be seen by comparing Eq. (9) with w \u2261 \u03b2 and\nEq. (6). Note that the estimator \u00c2w can be applied for arbitrary asymmetries\nas well, accepting a decrease of the FOM compared the EML estimator as\ndiscussed in Section 2.5.\nSuch a weighting procedure has been used for example in Refs. [3,4] to extract\nspin asymmetries in the case where h\u03b2i A \u226a 1. In Ref. [5] a weighting method\nis discussed to simultaneously extract signal and background asymmetries.\nThe fact that a weighting procedure reaches the same FOM as the EML\nmethod was first discussed in Ref. [7] in the context of signal and background\nextractions. The next section shows that one can find a weight factor reaching\nthe FOM of the EML method even in the case of non-vanishing asymmetries.\n\n2.4 Improved Weighting Method\n\nVariational calculus shows (s. App. B) that the maximum FOM is reached\nusing a weight factor\nw=\n\n\u03b2\n.\n1 \u2212 \u03b2 2 A20\n\n(11)\n\nHere, A0 is a first estimate of the asymmetry A obtained for example from\nthe weighting method presented in Section 2.3. The weighting factor defined\nin Eq. (11) leads to the following estimator (the index iw stands for improved\nweight)\n\nP\n\n\u03b2i\n+ 1\u2212\u03b2 2 A2\ni 0\n\n\u2212\n\n\u03b2i2\n+ 1\u2212\u03b2 2 A2\ni 0\n\n+\n\n\u00c2iw = P\n\nP\n\nP\n\n\u03b2i\n\u2212 1\u2212\u03b2 2 A2\ni 0\n\n\u03b2i2\n\u2212 1\u2212\u03b2 2 A2\ni 0\n\n.\n\n(12)\n\nEq. (10) gives\n\nD\n\nE2\n\u03b22\n2\n1\u2212\u03b2 2 A0\n\nE.\nFOM\u00c2iw = N D\n1\u2212\u03b2 2 A2\n\u03b2 2 (1\u2212\u03b2\n2 A2 )2\n\n(13)\n\n0\n\nThus given a good estimate A0 \u2248 A, we get FOM\u00c2iw = FOM\u00c2LH , i.e. the\nimproved weighting method reaches the same FOM as the EML method for\narbitrary asymmetries as well with the advantage that no CPU consuming\nmaximization procedure is needed.\n5\n\n\fFigure of merit\nN\n\nCounting rate\n\nweighting\n\nLikelihood\n\nImproved weighting\n\nasymmetry\n\nmethod\n\nmethod\n\nmethod\n\nh\u03b2 2 i\n\nh\u03b2i2\n1\u2212A2 h\u03b2 2 i\n\n1\u2212A2\n\nh\u03b2 4 i\nh\u03b2 2 i\n\nD\n\n\u03b22\n1\u2212\u03b2 2 A2\n\nE\n\nTable 1\nThe ratio FOM/N for various methods discussed.\n\nBefore we move to a comparison of the different methods, we note that the\nestimator\n\u03b2i+ \u2212 \u2212 \u03b2i\u2212\n\u00c2 = P\nP\n\u2212 2 + A0\n+ 2\n\u2212 (\u03b2i )\n+ (\u03b2i ) +\n\u03b2\n\u03b2\u00b1 =\n1 \u00b1 \u03b2A0\nP\n\n+\n\nP\n\nwith\n(14)\n\nreaches as well the FOM of the EML for A \u2248 A0 , In contrast to \u00c2iw its\nexpectation value only equals A if A0 \u2248 A. For \u03c4 decays the optimal weight\nfactor in Eq. (14) is discussed in Ref. [6].\n\n2.5 Comparison of different methods\nTab. 1 summarizes the FOM of the various estimators proposed. Fig. 1 shows\nthe figure of merit of the different estimators vs. A for the choice\n\u03b1(x) = const. = 2500\n\nand\n\n\u03b2(x) = x,\n\n0 < x < 1.\n\n(15)\n\nThe curves are analytic calculations. The points are results of simulations.\nFor each value of the asymmetry 10000 configurations with \u03b1 = 2500, which\ncorresponds on average to 5000 events, were simulated. One configuration\nconsists of a plus and minus data set used to evaluate an asymmetry. For each\nof the 10000 configurations simulated, the asymmetries were calculated using\nthe estimators discussed above. The FOM was determined from the RMS of\nthe asymmetry distributions.\nThe results are in perfect agreement with the analytic calculations. The statistical errors of the simulations are of the order of the size of the points.\nNote, that for all methods no bias was found for the asymmetry. The question\nof bias and the range of validity of the expressions for the FOM will be discussed in more detail in Section 4. The weighting methods are superior to the\n6\n\n\fFOM\n\n5000\n\ncounting rate\n\n4500\n\nweighting\n\n4000\n\nimproved weighing\nLikelihood\n\n3500\n3000\n2500\n2000\n1500\n1000\n500\n0\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nA\n\nFig. 1. Figure of merit for different methods as a function of the asymmetry A.\n\nmethod using simply the counting rates. As expected the improved weighting\nor the EML method reach a higher FOM than the simple weighting method\nthe larger the asymmetry A. The results depend of course on the shape of\n\u03b1(x) and \u03b2(x). The gain in FOM using weighted events compared to counting\nrates depends on the spread of \u03b2(x). For A = 0 for example it is h\u03b2 2 i / h\u03b2i2\nas can be derived from Eq. (10).\nFig. 2 shows the influence of the choice of A0 on the FOM in the improved\nweighting method for the factors \u03b1 and \u03b2 as given in Eq. (15) and an asymmetry A = 0.8. Choosing A0 in a range 0.7\u20130.86, one reaches at least 99% of\nFOM\u00c2LH . The normal weighting method corresponds to A0 = 0.\n\n3\n\nDifferent acceptance/flux factor in the two data sets\n\nWe now turn to the case where the acceptance and flux factor \u03b1 is not the\nsame in the two data sets. We assume that they differ by a known factor c\nwhich is independent of x. In this case the differential event distributions are\ngiven by\n2c\n\u03b1(x)(1 + \u03b2(x)A) and\n1+c\n2\nn\u2212 (x) =\n\u03b1(x)(1 \u2212 \u03b2(x)A) .\n1+c\nn+ (x) =\n\n7\n\n(16)\n(17)\n\n\fAiw\n\n/FOM\nFOM\n\nALH\n\n1\n\n0.98\n\n0.96\n\n0.94\n\n0.92\n\n0.9\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\nA0\n\nFig. 2. FOM\u00c2iw /FOM\u00c2LH for A = 0.8 as a function of A0 .\n\nThe factor 2/(1+c) has been introduced in order to normalize the distributions\nto the same number of events for all values of c at A = 0. The log likelihood\nfunction reads\nE\nD\n2c\n\u03b1i (1 + \u03b2i A) \u2212 N + (A) +\nl=\nln\n1+c\n+\n\u0012\n\u0013\nX\n2\nln\n\u03b1i (1 \u2212 \u03b2i A) \u2212 hN \u2212 i(A)\n1+c\n\u2212\n\n=\n\nX\n\n\u0013\n\n\u0012\n\nX\n\nln (1 + \u03b2i A) +\n\n+\n\nX\n\nln (1 \u2212 \u03b2i A)\n\n\u2212\n\nX\n2c\n2\n\u03b1i +\n\u03b1i\nln\n1+c\n1+c\n+\n\u2212\nZ\nc\u22121 Z\n\u03b1\u03b2dx .\n\u22122 \u03b1dx \u2212 2A\n1+c\n\n+\n\nX\n\nln\n\n(18)\n\nHere the last term cannot be ignored because it contains the parameter A and\nthus\nthe likelihood method cannot be applied without knowledge of the factor\nR\n\u03b1\u03b2dx. The weighting method on the other hand can be applied with a small\nmodification:\n\u00c2w,c\n\nwi \u2212 c \u2212 wi\n=P\n.\nP\n+ wi \u03b2i + c\n\u2212 wi \u03b2i\nP\n\n+\n\nP\n\n(19)\n\nThe expectation value of \u00c2w,c equals again A. The figure of merit reads (deriva8\n\n\fFOM\n\n5000\n\nc=1\n\n4500\n\nc=2\n4000\n\nc=3\n3500\n3000\n2500\n2000\n1500\n1000\n500\n0\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nA\n\nFig. 3. Figure of merit for three different values of c as a function of the asymmetry\nA, assuming the same number of events in the case A = 0.\n\ntion see s. App. C)\nFOM\u00c2w,c\n\nhw\u03b2i2\n4c\nD\n\u0010\n\u0011E .\n=N\n(1 + c)2 w 2 (1 \u2212 \u03b2 2 A2 ) 1 \u2212 \u03b2A 1\u2212c\n1+c\n\n(20)\n\nThe FOM is shown in Fig. 3 for different values of c for the improved weighting\nmethod. As in Fig. 1 the lines correspond to an analytic calculation using\nEq. (20), the points are results of simulations. Note, that for arbitrary c the\nweight reaching the highest FOM is\nw=\n\n\u03b2\n\u0010\n\n1\u2212c\n(1 \u2212 \u03b2 2 A2 ) 1 \u2212 \u03b2A 1+c\n\n\u0011\n\n.\n\nR\n\nThe EML method could be used for c 6= 1, if one uses an estimate for \u03b1\u03b2dx \u2248\nP\nP\n\u2212 \u03b2(xi ) from data. Simulations showed that the FOM of this\n+ \u03b2(xi ) + c\nmodified EML method equals the one of the improved weighting method.\n\n4\n\nValidity at low number of events\n\nIn this section we discuss the validity of the equations derived for the various\nFOMs and possible biases of the estimators. The formulas were derived us9\n\n\fasymmetry\n\nasymmetry\nlarger configuration\n\nsmall\nconfig.\n+ - + - + - + - + - + - + - + - + - + - + - + - + time\n\nFig. 4. Combining data in different configurations. The boxes denote the plus and\nminus data sets.\n\ning usual error propagation and can thus only be approximations which are\nthe better the higher N. In the simulations presented in Section 2.5 for every\nvalue of the asymmetry 10000 configurations were simulated with on average\n5000 events (corresponding to \u03b1 = 2500 in Eq. (15)). In each of these configurations the asymmetry was determined using the various estimators. In this\nsection we discuss effects occurring if the asymmetries are extracted in smaller\nconfigurations, as indicated in Fig. 4.\nFor lower number of events in one configuration one reaches a point where due\nto statistical fluctuations the estimated asymmetry in a given configuration\ncan be larger than 1 or smaller than \u22121. In this case the EML method is no\nmore applicable since the term (1 \u00b1 \u03b2A) can get negative. For \u03b1 = 250 this\nhappens in about 1% of the configurations for an asymmetry of A = 0.8.\nDividing the sample further in many smaller configurations one reaches a\npoint where one has only 0 or 1 event in one configuration. This limit can\nalso be obtained by dividing the sample in many narrow bins of \u03b2 having at\nmost one event in a bin. In this case the remaining estimators are identical:\n\u00c2cnt \u2261 \u00c2w=\u03b2 \u2261 \u00c2iw = \u00b11/\u03b2i . The sign depends\nthe D\neventE occurred\nD whether\nE\nin the plus or the minus data set. One finds \u00c2iw = A and \u00c22iw = 1/\u03b2i2 ,\nthus the FOM for this event reads\n\u03b2i2\n1\nFOMi = D\n.\nE2\nE =\nD\n1 \u2212 \u03b2i2 A2\n\u00c2iw \u2212 \u00c22iw\nNote that A is not the estimated asymmetry from a single event but rather\ntaken from a larger event sample. Combining all the asymmetries determined\non single events leads to\nP\n\ni\n\n\u00b1 \u03b21i * FOMi\nP\n\ni\n\nFOMi\n\n=\n\n\u03b2i2\n1\n+ \u03b2i 1\u2212\u03b2 2 A2\ni\n\n\u2212\n\n\u03b2i2\n+ 1\u2212\u03b2 2 A2\ni\n\n+\n\nP\n\nP\n\nP\n\nP\n\n10\n\n\u03b2i2\n1\n\u2212 \u03b2i 1\u2212\u03b2 2 A2\ni\n\n\u03b2i2\n\u2212 1\u2212\u03b2 2 A2\ni\n\n.\n\n(21)\n\n\fAssuming A = A0 , Eq. (21) is nothing but the estimator of the improved\nweighting method, \u00c2iw , defined in Eq. (12). In other words, for the improved\nweighting method it makes no differences whether the data are analyzed in\none large configuration or in many small ones. The improved weighting is\nalso equivalent to using an infinite number of bins in \u03b2 and evaluating the\nasymmetries in every bin and then combining the results. The advantage of\nthe improved weighting method is that this binning has not to be performed.\nThe observations discussed above are confirmed by simulations. In total 109\nconfigurations with \u03b1 = 0.025 were simulated. The simulated data were analyzed as follows. First the asymmetries were calculated in the approximately\n5% of the configurations actually containing at least one event. Then the\nweighted average of these asymmetries is calculated. The same data were analyzed in a different way by combining 10 configurations and calculating the\nasymmetries in these larger configurations corresponding to \u03b1 = 0.25. This\nprocedure was repeated until reaching 104 configurations with \u03b1 = 2500. Fig. 4\nillustrates the procedure. These simulations were performed for an asymmetry\nof 0.8 generating events in the range 0.01 < \u03b2(x) < 0.99 .\nFig. 5 shows the mean value of the asymmetries and the statistical error for\nthe various estimators for the different values of \u03b1. As expected the estimator\n\u00c2iw gives the same result independent of \u03b1. No bias is observed within the\nstatistical error which is of the order of 10\u22124 . The asymmetry for the EML\nmethod is only shown for \u03b1 = 2500 since at lower values, as explained above,\nthe EML method is no more applicable.\nFig. 6 shows the distribution of the asymmetry \u00c2iw for different values of \u03b1.\nThe entries in the histograms in Fig. 6 are weighted by their corresponding\nFOM. In the case \u03b1 = 2500 this would not be necessary because all entries\nhave essentially the same FOM for a given method since the relative variation\nP\nof the number of events N and the averages like \u00b1 \u03b2i2 /N entering the FOM\nvary only very little from configuration to configuration. At lower values of \u03b1,\nhowever, this is no more the case. Taking again the extreme case where the\nasymmetries is calculated from single events, the FOM depends on the value\nof \u03b2 for this event. This explains why the number of entries is smaller than\n1 in some bins of the histograms. At \u03b1 = 0.025 the number of configurations\nis 109 . The corresponding histogram has only approximately 4.9 * 107 entries\nreflecting the fact that in most of the configuration there is no event.\nFinally, Fig. 7 shows the FOM/N calculated from the RMS of the asymmetry\ndistributions presented in Fig. 6 for different values of \u03b1. The three lines\ncorrespond to FOM\u00c2iw /N, FOM\u00c2w=\u03b2 /N and FOM\u00c2cnt /N calculated using the\nexpressions given in Tab. 1. For \u03b1 \u2265 25 there is good agreement with the\nFOM derived in Section 2 since the points coincide with the corresponding\nlines. At lower values of \u03b1 the FOM of the weighting and the counting rate\n11\n\n\fasymmetry A\n\n0.8005\ncounting rate\n\n0.8004\n0.8003\n\nweighting\nimproved weighing\nLikelihood\n\n0.8002\n0.8001\n0.8\n0.7999\n0.7998\n0.7997\n0.7996\n0.7995\n10-2\n\n10-1\n\n1\n\n10\n\n102\n\n103\n\n\u03b1\n\nFig. 5. Results for the asymmetry of the simulations as a function of\nthe average number of events in one configuration. The points are at\n\u03b1 = 0.025, 0.25, 2.5, 25, 250, 2500, respectively. For a given value of \u03b1 they are\nslightly displaced on the horizontal axis for better readability. Note, that values\nat different values of \u03b1 are correlated since the same data were used.\n\nmethod start to increase and finally reach as expected FOM\u00c2iw at \u03b1 = 0.025,\nwhere the three estimators are practically identical.\n\n5\n\nSummary & Conclusions\n\nWe presented several estimators to extract an asymmetry parameter A in\na number density function. These estimators were based on counting rates,\nevent weighting and the unbinned extended maximum likelihood method. A\nweighting procedure was derived that reaches the same figure of merit as the\nunbinned maximum likelihood method, known to reach the minimal variance\nbound. This weighting estimator is given as an analytic expression, whereas in\nthe EML method the maximization of the likelihood function has to be done\nnumerically. Moreover this estimator can be used (with a small modification)\n12\n\n\fMean = 0.7999\nRMS = 1.3111\n\n104\n\n107 \u03b1=0.25\n\nMean = 0.7999\n\n105\n\nRMS = 1.1776\n\n103\n\n107 \u03b1=2.5\n\nEntries = 9.93e+06\nMean = 0.7999\n\n104\n\nRMS = 0.5915\n\n10\n\n10\n-50\n\n0\n\n106 \u03b1=25\n\n50\n\n100\nAw=\u03b2\n\nEntries = 1000000\nMean = 0.7999\nRMS = 0.1877\n\n4\n\n10\n\nnb. of entries\n\n-100\n\n10-2\n\n10-1\n-100\n\n106\n\n-50\n\n\u03b1=250\n\n0\n\n50\n\nEntries = 100000\nMean = 0.7999\nRMS = 0.0595\n\n105\n104\n\n2\n\n10\n\n-50\n\n0\n\n106 \u03b1=2500\n\n50\n\n100\nAw=\u03b2\n\nEntries = 10000\nMean = 0.7999\nRMS = 0.0187\n\n5\n\n10\n\n104\n\n103\n\n-1 -0.5 0 0.5 1 1.5 2 2.5 3\nAw=\u03b2\n\n-100\n\n100\nAw=\u03b2\nnb. of entries\n\n10\n\nnb. of entries\n\nEntries = 3.93e+07\n\nnb. of entries\n\nEntries = 4.88e+07\n\nnb. of entries\n\nnb. of entries\n\n107 \u03b1=0.025\n\n0.2 0.4 0.6 0.8 1 1.2 1.4\nAw=\u03b2\n\n0.7\n\n0.75\n\n0.8\n\n0.85\n\n0.9\nAw=\u03b2\n\nFOM/N\n\nFig. 6. Distributions of the estimated asymmetries \u00c2iw for different values of \u03b1.\n\n0.6\n\n0.55\n\n0.5\n\n0.45\n\n0.4\ncounting rate\n\n0.35\n\nweighting\nimproved weighing\nLikelihood\n\n0.3\n10-2\n\n10-1\n\n1\n\n10\n\n102\n\n103\n\n\u03b1\n\nFig. 7. Figure of merit per event for different methods as a function of \u03b1 for an\nasymmetry A = 0.8. The lines show the expectation calculated from the expressions\ngiven in Tab. 1.\n\n13\n\n\fin cases where the EML method cannot be applied because of an incomplete\nknowledge of event distribution function.\nAcknowledgments: I am grateful to Jean-Marc Le Goff for numerous discussions on the subject, verifying the calculations and for carefully reading the\nmanuscript.\n\n14\n\n\fA\n\nFigure of merit of \u00c2w\n\nTo calculate the FOM of \u00c2w defined in Eq. (9), one needs \u03c3 2 ( wi ), \u03c3 2 ( wi \u03b2i )\nP\nP\nand cov( wi , wi \u03b2i ). For two arbitrary quantities f and g the covariance\nP\nP\nbetween fi and gi is\nP\n\ncov(\n\nX\n\nX\n\ngj )\n\nfi gi +\n\nX\n\nfi ,\n\n=\n\nX\n\n(A.1)\n\nj\n\ni\n\n*\n\nP\n\ni=j\n\n+\n\nfi gj \u2212\n\ni6=j\n\n*\nX\n\nfi\n\ni\n\n+*\n\nX\n\ngj\n\nj\n\n+\n\n= hNi hf gi + hN(N \u2212 1)i hf i hgi \u2212 hNi2 hf i hgi\n= hNi hf gi +\n\n\u0010D\n\nE\n\nN 2 \u2212 hNi \u2212 hNi\n\n2\n\n\u0011\n\nhf i hgi .\n\n(A.2)\n(A.3)\n(A.4)\n\nIf the number of events N is Poisson distributed, i.e. hN 2 i \u2212 hNi \u2212 hNi2 = 0,\none finds\ncov(\n\nX\ni\n\nfi ,\n\nX\n\ngj ) = hNi hf gi \u2248\n\nX\n\nfi gi .\n\n(A.5)\n\ni\n\nj\n\nSetting f = g = w, f = g = w\u03b2 and f = w, g = w\u03b2 results in\n\u03c32(\n\u03c32(\ncov(\n\nX\n\nwi ,\n\nX\n\nX\n\nX\n\nD\n\nE\n\nwi ) = hNi w 2 ,\nD\n\n(A.6)\nE\n\nwi \u03b2i ) = hNi (w\u03b2)2 ,\nD\n\nE\n\nwi \u03b2i ) = hNi w 2 \u03b2 .\n\n(A.7)\n(A.8)\n\nSimple error propagation in Eq. (9) finally leads to Eq. (10) for the figure of\nmerit.\n\nB\n\nOptimal weight\n\nDenoting the weight factor which maximizes the FOM by w0 , we consider\nsmall deviation from this optimum by\nw(x) = w0 (x) + \u01eb \u03b7(x)\n\n(B.1)\n\nwhere \u03b7(x) is arbitrary and \u01eb \u226a1.\n15\n\n\fInserting Eq. (B.1) in Eq. (10) keeping terms of 1st order in \u01eb one finds\n(hw0 \u03b2i + \u01eb h\u03b7\u03b2i)2\nFOM =\n.\nh(w02 + 2\u01ebw0 \u03b7) (1 \u2212 \u03b2 2 A2 )i\n\n(B.2)\n\nThe condition \u2202FOM/\u2202\u01eb = 0 gives\nw0 =\n\nC\n\n\u03b2\n.\n1 \u2212 \u03b2 2 A2\n\nFOM for the case c 6= 1\n\nThe error for the estimator defined in Eq. (19) is obtained by simple error\nP\nP\npropagation taking into account the correlations between w\u03b2 and w.\n\u0010\n\nFOM\u00c2w,c\n\n\u0011\u22121\n\n= ~v T C ~v\n\nwith\n\u2202 \u00c2w,c\n\u2202 \u00c2w,c\n\u2202 \u00c2w,c\n\u2202 \u00c2w,c\n, P\n, P\n, P\n,\n~v =\nP\n\u2202( + wi ) \u2202( \u2212 wi ) \u2202( + wi \u03b2i ) \u2202( \u2212 wi \u03b2i )\n1\n=P\n(1, \u2212c, \u2212A, \u2212cA)\nP\n\u2212 wi \u03b2i\n+ wi \u03b2i + c\nT\n\nand\n\n\uf8eb\n\nC=\n\nP\n\n+\n\nwi2\n\n0\n\nP\n\n+\n\nwi2 \u03b2i\n\n0\n\n\u2212\n\nwi \u03b2i\n\n.\n\n\u2212 (wi \u03b2i )\n\n0\n\nThis leads to Eq. (20).\n\nReferences\n[1] R. J. Barlow, Statistics, Wiley 1989\n[2] R. J. Barlow, Nucl. Instrum. Meth. A 297 (1990) 496.\n\n16\n\n(C.1)\n\n\uf8f6\n\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ec\nP\nP\n\uf8f7\n\uf8ec\n2\n2\n0\nw\n0\nw\n\u03b2\n\uf8ec\n\u2212 i\n\u2212 i i \uf8f7\n\uf8f7\n\uf8ec\n\uf8f7\n\uf8ecP\nP\n2\n2\n\uf8f7\n\uf8ec\n0\n0\n+ (wi \u03b2i )\n\uf8f7\n\uf8ec + wi \u03b2i\n\uf8f8\n\uf8ed\nP\nP\n2\n2\n\n0\n\n!\n\n(C.2)\n\n\f[3] D. Adams et al. [Spin Muon Collaboration (SMC)], Phys. Rev. D 56 (1997)\n5330\n[4] E. S. Ageev et al. [COMPASS Collaboration], Phys. Lett. B 612 (2005) 154\n[5] J. Pretz and J. M. Le Goff, Nucl. Instrum. Meth. A 602 (2009) 594\n[6] M. Davier, L. Duflot, F. Le Diberder and A. Rouge, Phys. Lett. B 306 (1993)\n411.\n[7] R. J. Barlow, J. Comput. Phys. 72 (1987) 202.\n\n17\n\n\f"}