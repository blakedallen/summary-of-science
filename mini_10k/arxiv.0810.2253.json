{"id": "http://arxiv.org/abs/0810.2253v1", "guidislink": true, "updated": "2008-10-13T15:16:17Z", "updated_parsed": [2008, 10, 13, 15, 16, 17, 0, 287, 0], "published": "2008-10-13T15:16:17Z", "published_parsed": [2008, 10, 13, 15, 16, 17, 0, 287, 0], "title": "The Geometry of Filtering", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0810.0624%2C0810.4342%2C0810.5699%2C0810.1083%2C0810.3758%2C0810.4563%2C0810.5240%2C0810.1037%2C0810.2471%2C0810.1778%2C0810.3790%2C0810.2914%2C0810.4429%2C0810.4854%2C0810.5474%2C0810.1135%2C0810.1777%2C0810.4867%2C0810.1036%2C0810.1824%2C0810.0116%2C0810.3556%2C0810.2887%2C0810.3266%2C0810.0123%2C0810.1441%2C0810.4364%2C0810.2054%2C0810.4047%2C0810.0838%2C0810.5294%2C0810.2253%2C0810.0173%2C0810.0434%2C0810.4809%2C0810.1124%2C0810.0053%2C0810.5375%2C0810.1494%2C0810.3785%2C0810.0846%2C0810.0197%2C0810.2508%2C0810.1014%2C0810.0552%2C0810.5035%2C0810.4663%2C0810.2297%2C0810.1947%2C0810.0860%2C0810.3530%2C0810.2413%2C0810.5264%2C0810.4268%2C0810.1154%2C0810.5701%2C0810.2906%2C0810.4787%2C0810.5192%2C0810.2205%2C0810.2363%2C0810.3378%2C0810.0626%2C0810.3409%2C0810.1538%2C0810.5573%2C0810.2246%2C0810.0591%2C0810.0344%2C0810.4467%2C0810.0967%2C0810.0230%2C0810.4153%2C0810.4775%2C0810.1226%2C0810.0167%2C0810.5134%2C0810.1130%2C0810.2380%2C0810.4664%2C0810.1991%2C0810.2774%2C0810.0768%2C0810.0410%2C0810.5460%2C0810.1133%2C0810.2680%2C0810.2463%2C0810.3251%2C0810.0145%2C0810.4328%2C0810.0538%2C0810.1091%2C0810.4560%2C0810.5751%2C0810.5043%2C0810.2835%2C0810.3260%2C0810.0730%2C0810.5667%2C0810.2531&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "The Geometry of Filtering"}, "summary": "Geometry arising from two diffusion operators (smooth semi-elliptic, second\norder differential operators) on different spaces but intertwined by a smooth\nmap is described. Particular cases arise from Riemannian submersions when the\noperators are Laplace-Beltrami operators, from equivariant operators on the\ntotal space of a principal bundle, and for the operators on the diffeomorphism\ngroup arising from stochastic flows. Classical non-linear filtering problems\nalso lead to such conffigurations. A basic tool is the, possibly, non-linear\n\"semi-connection\" induced by this set up, leading to a canonical decomposition\nof the operator on the domain space. Topics discussed include: generalised\nWietzenbock curvatures arising in the equivariant case, skew -product\ndecompositions of diffusion processes, conditioned processes, classical\nfiltering, decomposition of stochastic flows, and connections determined by\nstochastic differential equations.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0810.0624%2C0810.4342%2C0810.5699%2C0810.1083%2C0810.3758%2C0810.4563%2C0810.5240%2C0810.1037%2C0810.2471%2C0810.1778%2C0810.3790%2C0810.2914%2C0810.4429%2C0810.4854%2C0810.5474%2C0810.1135%2C0810.1777%2C0810.4867%2C0810.1036%2C0810.1824%2C0810.0116%2C0810.3556%2C0810.2887%2C0810.3266%2C0810.0123%2C0810.1441%2C0810.4364%2C0810.2054%2C0810.4047%2C0810.0838%2C0810.5294%2C0810.2253%2C0810.0173%2C0810.0434%2C0810.4809%2C0810.1124%2C0810.0053%2C0810.5375%2C0810.1494%2C0810.3785%2C0810.0846%2C0810.0197%2C0810.2508%2C0810.1014%2C0810.0552%2C0810.5035%2C0810.4663%2C0810.2297%2C0810.1947%2C0810.0860%2C0810.3530%2C0810.2413%2C0810.5264%2C0810.4268%2C0810.1154%2C0810.5701%2C0810.2906%2C0810.4787%2C0810.5192%2C0810.2205%2C0810.2363%2C0810.3378%2C0810.0626%2C0810.3409%2C0810.1538%2C0810.5573%2C0810.2246%2C0810.0591%2C0810.0344%2C0810.4467%2C0810.0967%2C0810.0230%2C0810.4153%2C0810.4775%2C0810.1226%2C0810.0167%2C0810.5134%2C0810.1130%2C0810.2380%2C0810.4664%2C0810.1991%2C0810.2774%2C0810.0768%2C0810.0410%2C0810.5460%2C0810.1133%2C0810.2680%2C0810.2463%2C0810.3251%2C0810.0145%2C0810.4328%2C0810.0538%2C0810.1091%2C0810.4560%2C0810.5751%2C0810.5043%2C0810.2835%2C0810.3260%2C0810.0730%2C0810.5667%2C0810.2531&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Geometry arising from two diffusion operators (smooth semi-elliptic, second\norder differential operators) on different spaces but intertwined by a smooth\nmap is described. Particular cases arise from Riemannian submersions when the\noperators are Laplace-Beltrami operators, from equivariant operators on the\ntotal space of a principal bundle, and for the operators on the diffeomorphism\ngroup arising from stochastic flows. Classical non-linear filtering problems\nalso lead to such conffigurations. A basic tool is the, possibly, non-linear\n\"semi-connection\" induced by this set up, leading to a canonical decomposition\nof the operator on the domain space. Topics discussed include: generalised\nWietzenbock curvatures arising in the equivariant case, skew -product\ndecompositions of diffusion processes, conditioned processes, classical\nfiltering, decomposition of stochastic flows, and connections determined by\nstochastic differential equations."}, "authors": ["K. D. Elworthy", "Y. LeJan", "Xue-Mei Li"], "author_detail": {"name": "Xue-Mei Li"}, "author": "Xue-Mei Li", "arxiv_comment": "149 pages; preliminary version of monograph", "links": [{"href": "http://arxiv.org/abs/0810.2253v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0810.2253v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.DG", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.DG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.PR", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "58J65, 53C07, 60H10, 60J60, 93E11", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0810.2253v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0810.2253v1", "journal_reference": "ISBN 978-3-0346-0176-4, Frontiers in Mathematics, Birkhauser, 2010", "doi": null, "fulltext": "arXiv:0810.2253v1 [math.DG] 13 Oct 2008\n\nThe Geometry of Filtering\n(Preliminary Version)\nK. D. Elworthy, Yves Le Jan, and Xue-Mei Li\nMay 28, 2018\n\n\f2\n\n\fIntroduction\nFiltering is the science of finding the law of a process given a partial observation of it. The main objects we study here are diffusion processes. These are naturally associated with second order linear differential operators which are semielliptic and so introduce a possibly degenerate Riemannian structure on the state\nspace. In fact much of what we discuss is simply about two such operators intertwined by a smooth map, the \"projection from the state space to the observations\nspace\", and does not involve any stochastic analysis.\nFrom the point of view of stochastic processes our purpose is to present and\nto study the underlying geometric structure which allows us to perform the filtering in a Markovian framework with the resulting conditional law being that of a\nMarkov process. This geometry is determined by the symbol of the operator on\nthe state space which projects to a symbol on the observation space. The projectible symbol induces a (possibly non-linear and partially defined) connection\nwhich lifts the observation process to the state space and gives a decomposition\nof the operator on the state space and of the noise. As is standard we can recover\nthe classical filtering theory in which the observations are not usually Markovian\nby application of the Girsanov-Maruyama-Cameron -Martin Theorem.\nThis structure we have is examined in relation to a number of geometrical topics. In one direction this leads to a generalisation of Hermann's theorem on the\nfibre bundle structure of certain Riemannian submersions. In another it gives a\nnovel description of generalised Weitzenb\u00f6ck curvature. It also applies to infinite\ndimensional state spaces such as arise naturally for stochastic flows of diffeoK. D. Elworthy, Mathematics Institute, University of Warwick, Coventry CV4 7AL, U.K.\nE-mail: K.D.Elworthy@warwick.ac.uk\nXue-Mei Li, Mathematics Institute, University of Warwick, Coventry CV4 7AL, U.K. E-mail:\nXue-Mei.Hairer@warwick.ac.uk\nY. LeJan, D\u00e9partment de Mathematques, Universit\u00e9 Paris Sud 11, 91405 Orsay, France. Email: Yves.LeJan@math.u-psud.fr\n\n3\n\n\f4\nmorphisms defined by stochastic differential equations, and for certain stochastic\npartial differential equations.\nLet M be a smooth manifold. Consider a smooth second order semi-elliptic\ndifferential operator L such that L1 \u2261 0. In a local chart, such an operator takes\nthe following form\nn\nX \u2202\n1 X ij \u2202 \u2202\nL=\na\n+\nbi i\n2 i,j=1 \u2202xi \u2202xj\n\u2202x\n\n(1)\n\nwhere the aij 's and bi 's are smooth functions and the matrix (aij ) is positive semidefinite.\nSuch differential operators are called diffusion operators. An elliptic diffusion\noperator induces a Riemannian metric on M. In the degenerate case we shall have\nto assume that the \"symbol\" of L (essentially the matrix [aij ] in the representation\n(1)) has constant rank and so determines a sub-bundle E of the tangent bundle\nT M together with a Riemannian metric on E. In Elworthy-LeJan-Li [26] and\n[27] it was shown that a diffusion operator in H\u00f6rmander form, satisfying this\ncondition, induces a linear connection on E which is adapted to the Riemannian\nmetric induced on E, but not necessarily torsion free. It was also shown that\nall metric connections on E can be constructed by some choice of H\u00f6rmander\nform for a given L in this way. The use of such connections has turned out to be\ninstrumental in the decomposition of noise and calculation of covariant derivatives\nof the derivative flows.\nA related construction of connections can extend to principal fibre bundles\nP , indeed to more general situations, such as foliated manifolds and stratified\nmanifolds. An equivariant differential operator on P induces naturally a diffusion operator on the base manifold. Conversely given a connection on P one can\nlift horizontally a diffusion operator on the base manifold of the form of sum of\nsquares of vector fields by simply lifting up the vector fields. It still need to be\nshown that the lift is independent of choices of its H\u00f6rmander form. Consider\nnow a diffusion operator not given in H\u00f6rmander form. Since it has no zero order\nterm we can associate with it an operator \u03b4 which send differential one forms to\nfunctions. In Proposition 1.2.1 a class of such operators are described, each of\nwhich determines a diffusion operator. Horizontal lifts of diffusion operators can\nthen be defined in terms of the \u03b4 operator. This construction extends to situations\nwhere there is no equivariance and we have only partially defined and non-linear\nconnections.\n\n\f5\nThe connections discussed here arise in much more general situations, including for foliations though these are not discussed in this volume, We show that\ngiven a smooth p : N \u2192 M: a diffusion operator B on N which lies over a\ndiffusion operator A on M satisfying a \"cohesiveness\" property gives rise to a\nsemi-connection, a partially defined, non-linear, connection which can be characterised by the property that, with respect to it, B can be written as the direct sum of\nthe horizontal lift of its induced operator and a vertical diffusion operator. Of particular importance are examples where p : N \u2192 M is a principal bundle. In that\ncase the vertical component of B induces differential operators on spaces of sections of associated vector bundles: we observe that these are zero-order operators,\nand can have geometric significance.\nThis geometric significance and the relationship between these partially defined connections and the metric connections determined by the H\u00f6rmander form\nas in [26] and [27] is seen when taking B to be the generator of the diffusion\ngiven on the frame bundle GLM of M by the action of the derivative flow of a\nstochastic differential equation on M. The semi- connection determined by B is\nthen equivariant and is the adjoint of the metric connection induced by the SDE in\na sense extending that of Driver [17] and described in [27]. The zero-order operators induced on differential forms as mentioned above turn out to be generalised\nWeitzenb\u00f6ck curvature operators,in the sense of [27], reducing to the classical\nones when M is Riemannian for particular choices of stochastic differential equations for Brownian motion on M. Our filtering then reproduces the conditioning\nresults for derivatives of stochastic flows in [29]and [27].\nOur approach is also applied to the case where M is compact and N is its\ndiffeomorphism group, Diff(M) , with P evaluation at a chosen point of M. The\noperator B is taken to be the generator of the diffusion process on Diff(M) arising\nfrom a stochastic flow. However our constructions can be made in terms of the\nreproducing Hilbert space of vector fields on M defined by the flow. From this we\nsee that stochastic flows are essentially determined by a class of semi-connections\non the bundle p : Diff(M) \u2192 M and smooth stochastic flows whose one point\nmotions have a cohesive generator determine semi- connections on all natural\nbundles over M. Apart from these geometrical aspects of stochastic flows we\nalso obtain a skew product decomposition which, for example, can be used to find\nconditional expectations of functionals of such flows given knowledge of the one\npoint motion from our chosen point in M.\nA feature of our approach is that in general we use canonical processes as solutions of martingale problems to describe our processes, rather than stochastic\ndifferential equations and semi-martingale calculus, unless we are explicitly deal-\n\n\f6\ning with the latter. This leads to some some new constructions, for example of\nintegrals along the paths of our diffusions in Section 4.1, which are valid more\ngenerally than in the very regular cases we discuss here.\nIn more detail: In Chapter One we describe various representations of diffusion operators and when they are available. We also define the notion of such\nan operator being along a distribution. In Chapter Two we introduce the notion\nof semi-connection which is fundamental for what follows, show how these are\ninduced by certain intertwined pairs of diffusion operators and how they relate\nto a canonical decomposition of such operators. We also have a first look at the\ntopological consequences on p : N \u2192 M of having B on N over some A on M\nwhich posses hypo-ellipticity type properties. This is a minor extension of part of\nHermann's theorem, [37], for Riemannian submersions. In Chapter Three we specialise to the case of principal bundles, introduce the example of derivative flow,\nand show how the generalised Wietzenbock curvatures arise.\nIt is not really until Chapter Four that stochastic analysis plays a major role.\nHere we describe methods of conditioning functionals of the B-process given information about its projection onto M. We also use our decomposition of B and\nresulting decomposition of the B-process to describe the conditional B-process.\nIn the equivariant case of principal bundles the decomposition of the process can\nbe considered as a skew product decomposition. In Chapter 5 we show how our\nconstructions can apply to classical filtering problems, where the projection of the\nB-process is non-Markovian. We can follow the classical approach and obtain, in\nTheorem 5.9, a version of Kushner's formula for non-linear filtering in somewhat\ngreater generality than is standard. This requires some discussion of analogues of\ninnovations processes in our setting.\nWe return to more geometrical analysis in Chapter Six, giving further extensions of Hermann's theorem and analysing the consequences of the horizontal lift\nof A commuting with B, thereby extending the discussion in [7]. In particular we\nsee that such commutativity, plus hypo-ellipticity conditions on A, gives a bundle\nstructure and a diffusion operator on the fibre which is preserved by the trivialisations of the bundle structure. This leads to an extension of the \"skew-product\"\ndecomposition given in [24] for Brownian motions on the total space of Riemannian submersions with totally geodesic fibres. In fact the well known theory for\nRiemann submersions, and the special case arising from Riemannian symmetric\nspaces is presented in Chapter Seven.\nChapter Eight is where we describe the theory for the diffeomorphism bundle\np : Diff(M) \u2192 M with a stochastic flow of diffeomorphism on M. Initially this\nis done independently of stochastic analysis and in terms of reproducing kernel\n\n\f7\nHilbert spaces of vector fields on M. The correspondence between such Hilbert\nspaces and stochastic flows is then used to get results for flows and in particular\nskew-product decompositions of them.\nIn the Appendices we present the Girsanov Theorem in a way which does not\nrely on having to use conditions such as Novikov's criteria for it to remain valid.\nThis has been known for a long time, but does not appear to be as well known\nas it deserves. We also look at conditions for degenerate, but smooth, diffusion\noperators to have smooth H\u00f6rmander forms, and so to have stochastic differential\nequation representations for their associated processes. Finally we discuss semimartingales and \u0393-martingales along a sub-bundle of the tangent bundle with a\nconnection.\nFor Brownian motions on the total spaces of Riemannian submersions much\nof our basic discussion, as in the first two and a half Chapters, of skew-product\ndecompositions is very close to that in [24] which was taken further by Liao in\n[48]. A major difference from Liao's work is that for degenerate diffusions we\nuse the semi-connection determined by our operators rather than an arbitrary one,\nso obtaining canonical decompositions. The same holds for the very recent work\nof Lazaro-Cami & Ortega, [44] where they are motivated by the reduction and\nreconstruction of Hamiltonian systems and consider similar decompositions for\nsemi-martingales. An extension of [24] in a different direction, to shed light on\nthe Fadeev-Popov procedure for gauge theories in theoretical physics was given\nby Arnaudon &Paycha in [1]. Much of the equivariant theory presented here was\nannounced with some sketched proofs in [25].\n\nKey Words\nsemi-elliptic, second order differential operator, H\u00f6rmander forms, connection,\nsemi-connection, diffusion processes, Girsanov theorem, intertwined diffusions,\nconditioned laws, filtering, Weitzenb\u00f6ck curvature, skew-product decomposition,\nstochastic flows, manifolds, Riemannian submersions, bundles, principal bundles,\nDiffeomorphism bundles.\n\n\f8\n\n\fContents\n1\n\n.\n.\n.\n.\n\n11\n11\n13\n14\n16\n\n.\n.\n.\n.\n.\n.\n\n19\n19\n23\n24\n28\n31\n32\n\n3\n\nEquivariant Diffusions on Principal Bundles\n3.1 Invariant Semi-connections on Principal Bundles . . . . . . . . .\n3.2 Decompositions of Equivariant Operators . . . . . . . . . . . . .\n3.3 Derivative Flows and Adjoint Connections . . . . . . . . . . . . .\n3.4 Associated Vector Bundles & Generalised Weitzenb\u00f6ck Formulae\n\n35\n35\n38\n41\n46\n\n4\n\nProjectible Diffusion Processes\n4.1 Integration of predictable processes\n4.2 Horizontality and filtrations . . . . .\n4.3 The Filtering Equation . . . . . . .\n4.4 A family of Markovian kernels . . .\n4.5 The filtering equation . . . . . . . .\n4.6 Approximations . . . . . . . . . . .\n4.7 Krylov-Veretennikov Expansion . .\n\n59\n60\n64\n65\n69\n70\n72\n73\n\n2\n\nDiffusion Operators\n1.1 Representations of Diffusion Operators .\n1.2 The Associated First Order Operator . . .\n1.3 Diffusion Operators Along a Distribution\n1.4 Lifts of Diffusion Operators . . . . . . .\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\nDecomposition of Diffusion Operators\n2.1 The Horizontal Lift Map . . . . . . . . . . . . . . . . . . .\n2.2 Example: The Horizontal Lift Map of SDEs . . . . . . . . .\n2.3 Lifts of Cohesive Operators & Decomposition Theorem . .\n2.4 Diffusion Operators with Projectible Symbols . . . . . . . .\n2.5 Horizontal lift of paths & completeness of semi-connections\n2.6 Topological Implications . . . . . . . . . . . . . . . . . . .\n\n9\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n\n\fCONTENTS\n\n10\n\n5\n\n4.8 Conditional Laws . . . . . . . . . . . . . . . . . . . . . . . . . .\n4.9 Equivariant case: skew product decomposition . . . . . . . . . . .\n4.10 Induced processes on vector bundles . . . . . . . . . . . . . . . .\n\n74\n78\n80\n\nFiltering with non-Markovian Observations\n5.1 Signals with Projectible Symbol . . . . .\n5.2 Innovations and innovations processes . .\n5.3 Classical Filtering . . . . . . . . . . . . .\n5.4 Examples . . . . . . . . . . . . . . . . .\n\n83\n84\n88\n91\n93\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n.\n.\n.\n.\n\n6 The Commutation Property\n97\n6.1 Commutativity of Diffusion Semigroups . . . . . . . . . . . . . . 99\n6.2 Consequences for the Horizontal Flow . . . . . . . . . . . . . . . 101\n7 Example: Riemannian Submersions & Symmetric Spaces\n113\n7.1 Riemannian Submersions . . . . . . . . . . . . . . . . . . . . . . 113\n7.2 Riemannian Symmetric Spaces . . . . . . . . . . . . . . . . . . . 115\n8 Example: Stochastic Flows\n119\n8.1 Semi-connections on the Bundle of Diffeomorphisms . . . . . . . 119\n8.2 Semi-connections Induced by Stochastic Flows . . . . . . . . . . 123\n8.3 Semi-connections on Natural Bundles . . . . . . . . . . . . . . . 130\n9 Appendices\n133\n9.1 Girsanov-Maruyama-Cameron-Martin Theorem . . . . . . . . . . 133\n9.2 Stochastic differential equations for degenerate diffusions . . . . . 135\n9.3 Semi-martingales & \u0393-martingales along a Sub-bundle . . . . . . 137\n\n\fChapter 1\nDiffusion Operators\nIf L is a second order differential operator on a manifold M, denote by \u03c3 L : T \u2217 M \u2192 T M\nits symbol determined by\n\u0001 1\n1\n1\ndf \u03c3 L (dg) = L (f g) \u2212 (Lf )g \u2212 f (Lg),\n2\n2\n2\n\nfor C 2 functions f, g. We will often write \u03c3 L (l1 , l2 ) for l1 \u03c3 L (l2 ) and consider \u03c3 L\nas a bilinear form on T \u2217 M. Note that it is symmetric. The operator is said to be\nsemi-elliptic if \u03c3 L (l1 , l2 ) > 0 for all l1 , l2 \u2208 Tu M \u2217 , all u \u2208 M, and elliptic if the\ninequality holds strictly. Ellipticity is equivalent to \u03c3 L being onto.\nDefinition 1.0.1 A semi-elliptic smooth second order differential operator L is\nsaid to be a diffusion operator if L1 = 0.\n\n1.1 Representations of Diffusion Operators\nApart from local representations as given by equation 1 there are several global\nways to represent a diffusion operator L. One is to take a connection \u2207 on\nT M. Recall that a connection on T M gives, or is given by, a covariant derivative operator \u2207 acting on vector fields. For each C r vector field U on M it\ngives a C r\u22121 section \u2207\u2212 U of L(T M; T M). In other words for each x \u2208 M\nwe have a linear map v 7\u2192 \u2207v U of Tx M to itself. This covariant derivative\nof U in the direction v satisfies the usual rules. In particular it is a derivation\nwith respect to multiplication by differentiable functions f : M \u2192 R, so that\n\u2207v f U = df (v)U(x) + f (x)\u2207v U. Given any smooth vector bundle \u03c4 E \u2192 M\n11\n\n\fCHAPTER 1. DIFFUSION OPERATORS\n\n12\n\nover M a connection on E gives a similar covariant derivative acting on sections\nU of E. This time v \u2192 \u2207v U is in L(Tx M; Ex ), where Ex is the fibre over x for\nx \u2208 M. Such connections always exist.\nThen we can write\nLf (x) = traceTx M \u2207\u2212 (\u03c3 L (df )) + df (V 0 (x))\n\n(1.1)\n\nfor some smooth vector field V 0 on M. The trace is that of the mapping v 7\u2192\n\u2207v (\u03c3 L (df )) from Tx M to itself. To see this it is only necessary to check that the\nright hand side has the correct symbol since the symbol determines the diffusion\noperator up to a first order term.\nIf a smooth 'square root' to 2\u03c3 L can be found we have a H\u00f6rmander representation. The 'square root' is a smooth X : M \u00d7 Rm \u2192 T M with each\nX(x) \u2261 X(x, \u2212) : Rm \u2192 Tx M linear, such that\n2\u03c3xL = X(x)X(x)\u2217 : Tx\u2217 M \u2192 Tx M.\nThus there is a smooth vector field A with\nm\n\n1X\nLX j LX j + LA ,\nL=\n2 j=1\n\n(1.2)\n\nwhere LV denotes Lie differentiation with respect to a vector field V , so LV f (x) =\ndfx (V (x)), and X j (x) = X(x)(ej ) for {ej } an orthonormal basis of Rm . If \u03c3 L\nhas constant rank such X may be found. Otherwise it is only known that locally Lipschitz square roots exist (see the discussions in Appendix A). In that\ncase LX j LX j is only defined almost surely everywhere and the vector field A can\nonly be assumed measurable and locally bounded. Nevertheless uniqueness of the\nmartingale problem still holds (see below). Also there is still the hybrid representation, given a connection \u2207 on T M:\nm\n\n1X\n\u2207X j (x) (df )(X j (x)) + df (V 0 (x)).\nLf (x) =\n2 j=1\n\n(1.3)\n\nfor V 0 locally Lipschitz.\nThe choice of a H\u00f6rmander representation for a diffusion operator, if it exists,\ndetermines a locally defined stochastic flow of diffeomorphisms {\u03bet : 0 6 t < \u03b6}\nwhose one point motion solves the martingale problem for the diffusion operator.\n\n\f1.2. THE ASSOCIATED FIRST ORDER OPERATOR\n\n13\n\nIn particular on bounded measurable compactly supported f : M \u2192 R the associated (sub)Markovian semigroup is given by Pt f = E(f \u25e6 \u03bet ). See also Appendix\nII.\nDespite the discussion above we can always write L in the following form:\nL=\n\nN\nX\n\naij (*)LX i LX j + LX 0 ,\n\n(1.4)\n\nij=1\n\nwhere N is a finite number, aij and X k are respectively smooth functions and\nsmooth vector fields with aij = aji .\n\n1.2 The Associated First Order Operator\nDenote by C r \u039bp \u2261 C r \u039bp T \u2217 M, r > 0, the space of C r smooth differential pforms on a manifold N. To each diffusion operator L we shall associate an operator \u03b4 L , see Elworthy-LeJan-Li [26], [27] c.f. Eberle [19]. The horizontal lift of L\nwill then be defined in terms of a lift of \u03b4 L .\nProposition 1.2.1 For each diffusion operator L there is a unique smooth linear\ndifferential operator \u03b4 L : C r+1 \u039b1 \u2192 C r \u039b0 such that\n(1) \u03b4 L (f \u03c6) = df \u03c3 L (\u03c6) + f * \u03b4 L (\u03c6)\n(2) \u03b4 L (df ) = Lf.\nEquivalently \u03b4 L is determined by either one of the following:\n\u03b4 L (f dg) = \u03c3 L (df, dg) + f Lg\n1\n1\n1\nL(f g) \u2212 gLf + f Lg.\n\u03b4 L (f dg) =\n2\n2\n2\n\n(1.5)\n(1.6)\n\nProof. Take a connection \u2207 on T M then, as in (1.1), L can be written as Lf =\ntrace \u2207\u03c3 L (df ) + LV 0 f for some smooth vector field V 0 . Set\n\u03b4 L \u03c6 = trace \u2207(\u03c3 L \u03c6) + \u03c6(V 0 ).\nThen \u03b4 L (df ) = Lf and\n\u03b4 L (f \u03c6) = trace \u2207(f (\u03c3 L \u03c6)) + f \u03c6(V 0 ) = f \u03b4 L \u03c6 + df (\u03c3 L \u03c6).\n\n\fCHAPTER 1. DIFFUSION OPERATORS\n\n14\n\nP\nNote that a general C r 1-form \u03c6 can be written as \u03c6 = kj=1 fi dgi for some C r\nfunction fi and smooth gi , for example, by taking (g 1 , . . . , g m) : M \u2192 Rm to be\nan immersion. This shows that (1) and (2) determine \u03b4 L uniquely. Moreover since\nL is a smooth operator so is \u03b4 L .\nRemark 1.2.2 If the diffusion operator L has a representation\nL=\n\nm\nX\n\naij LX j LX j + LX 0\n\nj=1\n\nfor some smooth vector fields X i and smooth functions aij , i, j = 0, 1, . . . , m\nthen\nm\nX\nL\naij LX j \u03b9X j + \u03b9X 0 ,\n\u03b4 =\nj=1\n\nwhere \u03b9A denotes the interior product of the vector field A with a differential form.\nOne can check directly that \u03b4 L (df ) = Lf and that (1) holds. In particular in a local\nchart, for the representation given in equation (1) we see that \u03b4 L is given by\n\u03b4L\u03c6 =\n\nm\nX\nj=1\n\naij\n\nX\n\u2202\n\u03c6j (x) +\nbi \u03c6i (x)\n\u2202xi\n\nwhere \u03c6 has the representation\n\u03c6x =\n\nX\n\n\u03c6j (x) dxi\n\n1.3 Diffusion Operators Along a Distribution\nLet N be a smooth manifold. By a distribution S in N we mean a family {Su :\nu \u2208 N} where Su is a linear subspace of Tu N; for example S could be a subbundle of T N. Given such a distribution S let S 0 = \u222au Su0 for Su0 the annihilator\nof Su in Tu\u2217 N.\nDefinition 1.3.1\nLet S be a distribution in T N. Denote by C r S 0 the set of C r 1-forms which\nvanish on S. A diffusion operator L on N is said to be along S if \u03b4 L \u03c6 = 0 for\n\u03c6 \u2208 C 1S 0.\n\n\f1.3. DIFFUSION OPERATORS ALONG A DISTRIBUTION\n\n15\n\nSuppose L is along S and take \u03c6 \u2208 C r S 0 . By Proposition 1.2.1 and the\nsymmetry of \u03c3 L , 0 = (df )(\u03c3 L (\u03c6)) = \u03c6(\u03c3 L (df ) giving \u03c6x \u2208 Image[\u03c3xL ]0 . This\nproves Remark 1.3.2 (i):\nRemark 1.3.2 (i) if \u03b4 L \u03c6 = 0 for all \u03c6 \u2208 C 1 S 0 , then \u03c3 L \u03c6 = 0 for all such \u03c6\nand Image[\u03c3xL ] \u2282 \u2229\u03c6\u2208C 1 S 0 [ker \u03c6x ] for all x \u2208 N.\n(ii) If S is a sub-bundle of T N and L is along S then without ambiguity we\ncan define \u03b4 L \u03c6 for \u03c6 a C 0 section of S \u2217 by \u03b4 L \u03c6 := \u03b4 L \u03c6\u0303 for any 1-form\n\u03c6\u0303 extending \u03c6. Recall that S \u2217 is canonically isomorphic to the quotient\nT \u2217 N/S 0 .\nDefinition 1.3.3 If\nSx = \u2229\u03c6\u2208C 1 S 0 [ker \u03c6x ]\n\nfor all x we say S is a regular distribution.\nClearly sub-bundles are regular.\n\nProposition 1.3.4 (1) Let S be a regular distribution of N and L an operator\nwritten in H\u00f6rmander form:\nm\n\n1X\nL=\nLY j LY j + LY 0\n2 j=1\n\n(1.7)\n\nwhere the vector fields Y 0 and Y j , j = 1, . . . , m are C 0 and C 1 respectively.\nThen L is along S if and only if Y i are sections of S.\n(2) If B is along a smooth sub-bundle S of T N then for any connection \u2207S on\nS we can write B as\n\u0001\nBf = traceSx \u2207S\u2212 \u03c3 B (df ) + LX 0 f.\n\nAlso we can find smooth sections X 0 , . . . , X m of S and smooth functions\naij such that\nX\nB=\naij (*)LX i LX j + LX 0 .\ni,j\n\nProof. For part (1), if Y i are sections of S, take \u03c6 \u2208 C 1 S 0 then\nm\n\n\u03b4L\u03c6 =\n\n1X\nLY j \u03c6(Y j ) + \u03c6(Y 0 ) = 0\n2 j=1\n\n\fCHAPTER 1. DIFFUSION OPERATORS\n\n16\n\nand so L is along S.\nConversely\nL is along S. Define a C 1 bundle map Y : Rm \u2192 T N by\nPmsuppose\nm\nY (x)(e) = j=1 Y j (x)ej for {ej }m\nj=1 an orthonormal base of R . Then\n2\u03c3xL = Y (x)Y (x)\u2217\n\nand\nby Remark 1.3.2. Now\n\nImage[Y (x)] = Image[\u03c3xL ] \u2282 S,\n\n1X\nLY j (\u03c6(Y j )) + \u03c6(Y 0 ) = \u03c6(Y 0 ),\n2\nwhich can only vanish for all \u03c6 \u2208 C 1 S 0 if Y 0 is a section of S. Thus Y 1 , . . . , Y m ,\nand Y 0 are all sections of S.\nFor part (2), we use (1.1) and take \u2207 there to be the direct sum of \u2207S with an\narbitrary connection on a complementary bundle, obtaining \u03c3 B has image in S by\nRemark 1.3.2(i).\n\u03b4L\u03c6 =\n\n1.4 Lifts of Diffusion Operators\nLet p : N \u2192 M be a smooth map and E a sub-bundle of T M. Let S be a subbundle of T N transversal to the fibre of p, i.e. V Tu N \u2229 S = {0} all u \u2208 N and\nsuch that Ty p maps Sy isomorphically onto Ep(y) , for each y.\nLemma 1.4.1 Every smooth 1-form on N can be written as a linear combination\nof sections of the form \u03c8 + \u03bbp\u2217 (\u03c6) for \u03bb : N \u2192 R smooth, \u03c6 a 1-form on M,\nand \u03c8 annihilates S. In particular any 1-form annihilating V T N is of the form\n\u03bbp\u2217 (\u03c6). If E = T M then \u03c8 is uniquely determined.\nProof. Take Riemannian metrics on M and N such that the isomorphism between\nS and p\u2217 (E) given by T p is isometric. Fix y0 \u2208 N. Take a neighbourhood V of\np(y0 ) in M over which E is trivializable. Let v 1 , v 2 , . . . , v p be a trivialising family\nof sections over V . Set U = p\u22121 (V ). If \u03c6j = (v j )\u2217 , the dual 1-form to v j , j = 1\nto p, over V then {p\u2217 (\u03c6j )# , j = 1 to p} gives a trivialization of S over U. [Indeed\np\u2217 (\u03c6j )y (\u2212) = \u03c6jp(y) (Ty p\u2212) = h(Ty p)\u2217 (v j ), \u2212i.] Since any vector field over V\ncan therefore be written as one orthogonal to S plus a linear combination of the\np\u2217 (\u03c6j )# , by duality the result holds for forms with support in U. The global result\nfollows using a partition of unity.\nFor the uniqueness note that if E = T M then T N = V T N + S.\n\n\f1.4. LIFTS OF DIFFUSION OPERATORS\n\n17\n\nProposition 1.4.2 Let A be a diffusion operator on M along the sub-bundle E\nof T M. There is a unique lift of A to a smooth diffusion generator AS along the\nS\ntransversal bundle S. Write \u03b4\u0304 = \u03b4 A . Then AS is determined by\n(i) \u03b4\u0304(\u03c8) = 0 if \u03c8 annihilates S.\n(ii) \u03b4\u0304 (p\u2217 \u03c6) = (\u03b4 A \u03c6) \u25e6 p,\n\nfor \u03c6 \u2208 \u03a91 (M).\n\nMoreover (iii) for y \u2208 N let hy : Ep(y) \u2192 Ty N be the right inverse of Ty p with\nimage Sy . Then\nS\n\n(a) \u03c3yA = hy \u03c3 A h\u2217y\n(b) If A is given by\nA=\n\nN\nX\n\naij LX i LX j + LX 0\n\n(1.8)\n\ni,j=1\n\nwhere X 1 , . . . , X N and X 0 are sections of E then\nS\n\nA =\n\nN\nX\n\n(aij \u25e6 p) LX\u0304 i LX\u0304 j + LX\u0304 0\n\n(1.9)\n\ni,j=1\n\nfor X\u0304 j (y) = hy (X j (p(y)).\nProof. Lemma 1.4.1 ensures that (i) and (ii) determine \u03b4\u0304 uniquely as a smooth\noperator on smooth 1-forms if it exists. On the other hand we can represent A\nS\nas in (1.8) and define AS be (1.9). It is straightforward to check that then \u03b4 A\nsatisfies (i) and (ii).\nBy definition and the observation after (1.9) this must be the horizontal lift, if\nit is a diffusion generator. On the other hand if A is given by (1.8) we use it to\nS\nS\ndefine AS by (1.9). It is easy to see that \u03b4 A satisfies (i) and (ii) and so \u03b4 A = \u03b4\u0304.\nFrom this \u0100 = AS and AS is a smooth diffusion generator.\nIn the terminology of section 1.3 Su = ker[Tu p], sometimes written as V Tu N,\nis a distribution.\nDefinition 1.4.3 When an operator B is along the vertical distribution ker[T p] we\nsay B is vertical, and when there is a horizontal distribution such as {Hu : u \u2208 N}\nas given by Proposition 2.1.2 below and B is along that horizontal distribution we\nsay B is horizontal .\n\n\fCHAPTER 1. DIFFUSION OPERATORS\n\n18\n\nProposition 1.4.4 Let B be a smooth diffusion operator on N and p : N \u2192 M\nany smooth map, then the following conditions are equivalent:\n(1) The operator B is vertical.\n\nP\nij\n(2) The operator B has a expression of the form of m\nj=1 a LY i LY j + LY 0\nwhere aij are smooth functions and Y j are smooth sections of the vertical\ntangent bundle of T N.\n(3) B(f \u25e6 p) = 0 for all C 2 f : M \u2192 R.\nProof. (a). From (1) to (3) is trivial. From (3) to (1) note that every \u03c6 which vanishes on vertical vectors is a linear combination of elements of the form f p\u2217 (dg)\nfor some smooth g : M \u2192 R by Lemma 1.4.1. To show that B is vertical we only\nneed to show that \u03b4 B (f p\u2217 (dg)) = 0. But B(g \u25e6 p) = 0 implies \u03b4 B (p\u2217 (dg)) = 0\nand also p\u2217 (dg)\u03c3 B (p\u2217 (dg)) = 21 B(g \u25e6 p)2 \u2212 (g \u25e6 p)B(g \u25e6 p) = 0. By semiellipticity of B, \u03c3 B (p\u2217 (dg)) = 0. Thus assertion (1) follows since \u03b4 B (f p\u2217 (dg)) =\ndf \u03c3 B (p\u2217 (dg)) + f * \u03b4 B (p\u2217 (dg)) from Proposition 1.2.1(1), and so (1) and (3) are\nequivalent.\nEquivalence of (1) and (2) follows from Proposition 1.3.4.\nRemark 1.4.5 (1) If B is vertical, then by Proposition 1.2.1, for all C 2 functions f1 on N and f2 on M, B (f1 (f2 \u25e6 p)) = (f2 \u25e6 p)Bf1 ;\n(2) If B and B\u2032 are both over a diffusion operator A of constant rank nonzero\nrank such that A is along the image of \u03c3 A , then B \u2212 B\u2032 is not in general\nvertical, although (B \u2212 B\u2032 )(f \u25e6 p) = 0 for all C 2 function f : M \u2192 R,\nsince it may not be semi-elliptic. For example take p : R2 \u2192 R to be\n\u22022\n\u22022\n\u22022\n\u2032\nthe projection p(x, y) = x with A = \u2202x\n=\n2 , B = \u2202x2 + \u2202y 2 . Let B\n\u22022\n\u2202x2\n\n2\n\n2\n\n2\n\n\u2202\n\u2202\n\u2202\n\u2032\n+ \u2202y\n2 + \u2202x\u2202y . Then B is also over A but B \u2212 B = \u2212 \u2202x\u2202y is not vertical.\n\n\fChapter 2\nDecomposition of Diffusion\nOperators\nConsider a smooth map p : N \u2192 M between smooth manifolds M and N. By a\nlift of a diffusion operator A on M over p we mean a diffusion operator B on N\nsuch that\nB(f \u25e6 p) = (Af ) \u25e6 p\n(2.1)\n\nfor all C 2 functions f on M. In this situation we adopt the following terminology:\nDefinition 2.0.6 If (2.1) holds we say that B is over A, or that A and B are\nintertwined by p. A diffusion operator B on N is said to be projectible (over p),\nor p-projectible, if it is over some diffusion operator A.\nRecall that the pull back p\u2217 \u03c6 of a 1-form \u03c6 is defined by\n\np\u2217 (\u03c6)u = \u03c6p(u) (T p(\u2212)) = (T p)\u2217 \u03c6p(u) .\nFor our map p : N \u2192 M, a diffusion operator B is over A if and only if\n\u03b4 B (p\u2217 \u03c6)) = (\u03b4 A \u03c6)(p),\n\n(2.2)\n\nfor all \u03c6 \u2208 C 1 \u22271 T \u2217 M.\n\n2.1 The Horizontal Lift Map\nLemma 2.1.1 Suppose that B is over A. Let \u03c3 B and \u03c3 A be respectively the symbols for B and A. Then\nA\n(Tu p)\u03c3uB (Tu p)\u2217 = \u03c3p(u)\n,\n\n19\n\n\u2200u \u2208 N,\n\n(2.3)\n\n\f20\n\nCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\n\ni.e. the following diagram is commutative :\nTu\u2217 N\n\n\u03c3uB\n\n\u2732\n\nTu N\n\n\u273b\n\n(Tu p)\u2217\n\u2217\nTp(u)\nM\n\nTu p\nA\n\u03c3p(u)\n\n\u2744\n\u2732 Tp(u) M.\n\nProof. Let f and g be two smooth functions on M. Then for u \u2208 N, x = p(u),\n1\n1\n1\nA(f g)(x) \u2212 (f Ag)(x) \u2212 (gAf )(x)\n2\n2\n2\n1\n1\n1\nB ((f g) \u25e6 p) (u) \u2212 f \u25e6 pB(g \u25e6 p)(u) \u2212 g \u25e6 pB(f \u25e6 p)(u)\n=\n2\n2\n2\nB\n= d (g \u25e6 p)u \u03c3u (d (f \u25e6 p)u )\n= (dg \u25e6 Tu p) \u03c3uB (df \u25e6 Tu p) ,\n\n(dfx ) \u03c3xA (dgx ) =\n\nwhich gives the desired equality.\nFor x in M, set Ex := Image[\u03c3xA ] \u2282 Tx M. If \u03c3 A has constant rank, i.e.\ndim[Ex ] is independent of x, then E := \u222ax Ex is a smooth sub-bundle of T M.\nProposition 2.1.2 Assume \u03c3 A has constant rank and B is over A. Then there is a\nunique, smooth, horizontal lift map hu : Ep(u) \u2192 Tu N, u \u2208 N, characterised by\nA\nhu \u25e6 \u03c3p(u)\n= \u03c3uB (Tu p)\u2217 .\n\n(2.4)\n\nhu (v) = \u03c3uB ((Tu p)\u2217 \u03b1)\n\n(2.5)\n\nIn particular\n\u2217\nA\nwhere \u03b1 \u2208 Tp(u)\nM satisfies \u03c3p(u)\n(\u03b1) = v.\n\nProof. Clearly (2.5) implies (2.4) by Lemma 2.1.1 and so it suffices to prove hu\nis well defined by (2.5). For this we only need to show \u03c3 B ((Tu p)\u2217 (\u03b1)) = 0 for\nA\nevery \u03b1 in ker[\u03c3p(u)\n]. Now \u03c3 A \u03b1 = 0 implies that\n(T p)\u2217 (\u03b1)\u03c3 B ((T p)\u2217 \u03b1) = 0,\nby Lemma 2.1.1. Considering \u03c3 B as a semi-definite bilinear form this implies\n\u03c3uB (Tu p)\u2217 \u03b1 vanishes as required.\n\n\f2.1. THE HORIZONTAL LIFT MAP\n\n21\n\nNote that the vertical distribution ker[T p] is regular as ker[T p] is annihilated\nby all differential 1-forms of the form \u03b8 \u25e6 T p.\nLet Hu = Image[hu ] and H = \u2294u Hu . Set Fu = (Tu p)\u22121 [Ep(u) ] so we have a\nsplitting\nFu = Hu + V Tu N\n(2.6)\nwhere V Tu N = ker[Tu P ] the 'vertical' tangent space at u to N. In the elliptic\ncase p is a submersion, the vertical tangent spaces have constant rank, and F :=\n\u2294u Fu is a smooth sub-bundle of T N. In this case we have a splitting of T N,\na connection in the terminology of Kolar-Michor-Slovak [42]. In general we\nwill define a semi-connection on E to be a sub-bundle Hu of T N such that Tu p\nmaps each fibre Hu isomorphically to Ep(u) . In the equivariant case considered in\nChapter 3 such objects are called E-connections by Gromov. For the case when\n: N \u2192 M is the tangent bundle projection , or the orthonormal frame bundle\nnote that the \"partial connections\" as defined by Ge in [35] are rather different\nfrom the semi-connections we would have: they give parallel translations along\nE-horizontal paths which send vectors in E to vectors in E, and preserve the\nRiemannian metric of E , whereas the parallel transports of our semi-connections\ndo not in general preserve the fibres of E, nor any Riemannian metric, and they\nact on all tangent vectors.\nLemma 2.1.3 Assume \u03c3 A has constant rank and B is over A. For all u \u2208 N the\nimage of \u03c3uB is in Fu .\nProof. Suppose \u03b1 \u2208 Tu\u2217 N with \u0001\u03c3 B (\u03b1) 6\u2208 Fu . Then there exists k in the annihilator\nof Ep(u) such that k Tu p \u03c3 B (\u03b1) 6= 0. However\n\u0001\n\u0001\nA\nk Tu p \u03c3 B (\u03b1) = \u03b1 \u03c3 B ((Tu p)\u2217 (k)) = \u03b1 hu \u03c3p(u)\n(k)\n\nA\n\u2217\n(k) = 0 because for all \u03b2 \u2208 Tp(u)\nM,\nby Proposition 2.1.2; while \u03c3p(u)\nA\nA\n\u03b2 \u03c3p(u)\n(k) = k \u03c3p(u)\n(\u03b2) = 0\n\ngiving a contradiction.\nProposition 2.1.4 Let A be a diffusion operator on M with \u03c3 A of constant rank.\nFor i \u2208 {1, 2}, let pi : N i \u2192 M be smooth maps and Bi be diffusion operators\non N i over A. Let F : N 1 \u2192 N 2 be a smooth map with p2 \u25e6 F = p1 . Assume F\n\n\f22\n\nCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\n\nintertwines B1 and B2 . Let h1 , h2 be the horizontal lift maps determined by A, B1\nand A, B2 . Then\nh2F (u) = Tu F (h1u ),\nu \u2208 N 1;\n(2.7)\ni.e. the diagram\nTu F\n\nTu N 1\n\n\u2732\n\nTF (u) N 2\n\n\u2712\n\n\u2745\n\u25a0\n\u2745\nh1u\u2745\n\u2745\n\u2745\n\nh2F (u)\n\nEp1 (u)\ncommutes for all u \u2208 N.\nProof. Since F intertwines B1 and B2 , Lemma 2.1.1 gives\n2\n\n1\n\n\u03c3FB (u) = Tu F \u25e6 \u03c3uB \u25e6 (Tu F )\u2217 .\nNow take \u03b1 \u2208 Tp\u22171 (u) M with \u03c3pA1 (u) (\u03b1) = v, some given v \u2208 Ep1 (u) . From (2.5)\n2\n\nh2F (u) (v) = \u03c3FB (u) ((T p2 )\u2217 \u03b1)\n1\n\n= Tu F \u25e6 \u03c3uB \u25e6 (Tu F )\u2217 (T p2 )\u2217 \u03b1\n1\n\n= Tu F \u25e6 \u03c3uB (Tu p1 )\u2217 \u03b1\n= Tu h1u (v)\n\nas required.\nDefinition 2.1.5 A diffusion operator B on N will be said to have projectible\nsymbol for p : N \u2192 M if there exists a map \u03b7 : T \u2217 M \u2192 T M such that for all\nu \u2208 N the diagram:\nTu\u2217 N\n\n\u03c3uB\n\n\u2732\n\nTu N\n\n\u273b\n\n(Tu p)\u2217\n\u2217\nTp(u)\nM\n\nTu p\n\u03b7p(u)\n\n\u2744\n\u2732 Tp(u) M.\n\ncommutes, i.e. if (Tu p)\u03c3uB (Tu p)\u2217 depends only on p(u).\n\n\f2.2. EXAMPLE: THE HORIZONTAL LIFT MAP OF SDES\n\n23\n\nIn this case we also get a uniquely defined horizontal lift map as in Proposition\n2.1.4 defined by equation (2.7) using \u03b7 instead of the symbol of A. This situation\narises naturally in the standard non-linear filtering literature as described later see\nchapter 5.\n\n2.2 Example: The Horizontal Lift Map of SDEs\nLet us consider the horizontal lift connection in more detail when B and A are\ngiven by stochastic differential equations. For this write A and B in H\u00f6rmander\nform corresponding to factorisations \u03c3xA = X(x)X(x)\u2217 and \u03c3xB = X\u0303(x)X\u0303(x)\u2217\nfor\nX(x) : Rm \u2192 Tx M,\nx\u2208M\nX\u0303(u) : Rm\u0303 \u2192 Tu N,\n\nu \u2208 N.\n\nThen X(x) maps onto Ex for each x \u2208 M. Define Yx : Ex \u2192 Rm to be its right\ni\u22121\nh\ninverse: Y (x) = X(x) ker X(x)\u22a5\n.\n\nLemma 2.2.1 For each u \u2208 N there is a unique linear lu : Rm \u2192 Rm\u0303 such that\nker lu = ker X(x) and the diagram\n\nTu\u2217 N\n\nX\u0303(u)\u2217\n\n\u2732\n\n\u273b\n\nX\u0303(u)\n\n\u2732Tu N\n\n\u273b\n\n(Tu p)\u2217\nTx\u2217 M\n\nRm\u0303\nlu\n\n\u2732\n\nRm\n\nTu p\n\u2744\n\u2732Tx M\n\nX(x)\nX(x)\u2217\nA\nB\ncommutes, for x = p(u), i.e. \u03c3x = Tu p \u25e6 \u03c3x (Tu p)\u2217 and X(x) = Tu p \u25e6 X\u0303(u) \u25e6 lu .\nIn particular the horizontal lift map is given by hu = X\u0303(u)lu Y (p(u)).\nProof. The larger square commutes by Lemma 2.1.1. For the rest we need to\nconstruct lu . It suffices to define lu on [ker X(x)]\u22a5 . Note that [ker X(x)]\u22a5 =\nImage X(x)\u2217 in Rm . We only have to show that \u03b1 \u2208 ker X(x)\u2217 implies\nX\u0303(u)\u2217 (Tu p)\u2217 \u03b1 = 0.\n\n\fCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\n\n24\n\nIn fact for such \u03b1 the proof of part (i) of Proposition 2.1.2 is valid and therefore\n(Tu p)\u2217 \u03b1 \u2208 ker \u03c3uB . However since X\u0303(u) is injective on the image of X\u0303(u)\u2217 we\nsee ker \u03c3uB = ker X\u0303(u). . Thus lu is defined with kerlu = ker X(x) and such that\nthe left hand square of the diagram commutes. Since the perimeter commutes it\nis easy to see from the construction of lu that the right hand side also commutes.\nThe uniqueness of lu with kernel equal that of X(x) is clear since on [ker X(x)]\u22a5\nlu (e) = X\u0303(u)\u2217 (Tu p)\u2217 X(x)(e).\nNote. The horizontal lift of X(x), which can be used to construct a H\u00f6rmander\nform representation X V of AH , as in Proposition 2.3.5 and Theorem 3.2.1 below\nis given by:\nX V (u) : Rm \u2192 Tu P\nX V (u) = hu X(u) = X\u0303(u)lu\n\nsince Yx X(x) is the projection onto ker X(x)\u22a5 . (In the terminology of ElworthyLeJan-Li [27] X V does not involve the 'redundant noise'.) Furthermore consider\nthe special case that m\u0303 = m and also that X\u0303 and X are p-related, i.e.\nTu p(X\u0303(u)e) = X(p(u))e,\n\nu \u2208 N, e \u2208 Rm .\n\nThen lu is the projection of Rm onto [ker X(p(u))]\u22a5 :\nlu = Y (p(u))X(p(u))\ngiving\nhu = X\u0303(u)Y (p(u))\n\n(2.8)\n\nIn this case the 'diffusion coefficients' X V , above, is obtained from X\u0303 by restriction to the 'relevant noise' for X.\n\n2.3 Lifts of Cohesive Operators & Decomposition\nTheorem\nA diffusion generator L on a manifold is said to be cohesive if\n(i) \u03c3xL , x \u2208 X, has constant non-zero rank and\n(ii) L is along the image of \u03c3 L .\n\n\f2.3. LIFTS OF COHESIVE OPERATORS & DECOMPOSITION THEOREM 25\nRemark 2.3.1 From Theorem 2.1.1 in Elworthy-LeJan-Li [27] we see that if the\nrank of \u03c3xL is bigger than 1 for all x then L is cohesive if and only if it has a\nrepresentation\nm\n1X\nL=\nLX j LX j\n2 j=1\nwhere Ex = span{X 1 (x), . . . X m (x)} has constant rank.\n\nProposition 2.3.2 Let B be a smooth diffusion operator on N over A with A\ncohesive. The following are equivalent:\n(i) B = AH\n(ii) B is cohesive and Tu p is injective on the image of \u03c3uB for all u \u2208 N.\n(iii) B can be written as\nm\n\n1X\nL j L j + LX\u0303 0\nB=\n2 j=1 X\u0303 X\u0303\nwhere X\u0303 0 , . . . , X\u0303 m are smooth vector fields on N lying over smooth vector\nfields X 0 , . . . , X m on M, i.e. Tu p(X\u0303 j (u)) = X j (p(u)) for u \u2208 N for all j.\nP\nProof. If (i) holds take smooth X 1 , . . . X m with A = 12 m\nj=1 LX j LX j + LX 0 , by\nj\nj\nProposition 1.3.4, and set X\u0303 (u) = hu X (p(u)) to see (iii) holds. Clearly (iii)\nimplies (ii) and (ii) implies (i), so the three statements are equivalent.\nDefinition 2.3.3 If any of the equivalent conditions of the proposition holds we\nsay that B has no vertical part.\nRecall that is S is a distribution, S 0 denotes the set of annihilators of S.\nLemma 2.3.4 For l \u2208 Hu0 and k \u2208 (Vu T N)0 , some u \u2208 N we have:\nA. l\u03c3 B (k) = 0\nH\n\nB. \u03c3 B (k) = \u03c3 A (k)\nH\n\nC. \u03c3 A (l) = 0.\nIn particular Hu is the orthogonal complement of V Tu N\u2229Image(\u03c3uB ) in Image(\u03c3uB )\nwith its inner product induced by \u03c3uB .\n\n\f26\n\nCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\n\nProof. Set x = p(u). For part A and part B it suffices to take k = \u03c6 \u25e6 Tu p some\n\u03c6 \u2208 Tx\u2217 M. Then by (2.4), \u03c3uB (\u03c6 \u25e6 Tu p) = hu \u25e6 \u03c3xA (\u03c6) giving part A, and also part\nB by Proposition 1.4.2 (iii)(a) since \u03c6 = h\u2217u (\u03c6 \u25e6 Tu p), part C comes directly from\nProposition 1.4.2 (iii)(a).\nTheorem 2.3.5 For B over A with A cohesive there is a unique decomposition\nB = B1 + BV\nwhere B1 and BV are smooth diffusion generators with BV vertical and B1 over A\nhaving no vertical part. In this decomposition B1 = AH , the horizontal lift of A\nto H.\nProof. Set BV = B \u2212 AH . To see that BV is semi-elliptic take u \u2208 N and observe\nthat any element of Tu\u2217 N can be written as l + k where l \u2208 Hu0 and k \u2208 (V Tu N)0\nby Lemma 2.3.4 and\n(l + k)\u03c3 B (l + k) = l\u03c3 B (l) > 0.\nSince BV (f \u25e6 p) = 0 any f \u2208 C 2 (M; R) Proposition 1.4.4 implies BV is vertical.\nUniqueness holds since the semi-connections determined by B and B\u2032 are the\nsame by Remark 1.3.2(i) applied to BV and so by Proposition 2.3.2 we must have\nB 1 = AH .\nFor p a Riemannian submersion and B the Laplacian, Berard-Bergery and Bourguignon [7] define BV directly by BV f (u) = \u2206Nx (f |Nx )(u) for x = p(u) and\nNx = p\u22121 (x) with \u2206Nx the Laplace-Beltrami operator of Nx .\nExample 2.3.6\n1. Take N = S 1 \u00d7 S 1 and M = S 1 with p the projection on\nthe first factor. Let\nB=\n\n1 \u22022\n\u22022\n\u22022\n+\n)\n+\ntan\n\u03b1\n.\n2 \u2202x2 \u2202y 2\n\u2202x\u2202y\n2\n\n\u2202\nHere 0 < \u03b1 < \u03c04 so that B is elliptic. Then A = 21 \u2202x\n2\n2\n2\n\u2202\n1 \u2202\n\u22022\n\u22022\nH\nwith\nA\n=\n(\n+(tan\n\u03b1)2 \u2202y\nand BV = 12 (1\u2212(tan \u03b1)2 ) \u2202y\n2\n2 )+tan \u03b1 \u2202x\u2202y .\n2 \u2202x2\nThis is easily checked since, with this definition AH has H\u00f6rmander form\n\n\u2202\n1 \u2202\n+ tan \u03b1 )2\nAH = (\n2 \u2202x\n\u2202y\n\n\f2.3. LIFTS OF COHESIVE OPERATORS & DECOMPOSITION THEOREM 27\nand so is a diffusion operator which has no vertical part. Also BV is clearly\nvertical and elliptic. Note that this is an example of a Riemannian submersion: several more of a similar type can be found in [7]. In this case\nthe horizontal distribution is integrable and if \u03b1 is irrational the foliation it\ndetermines has dense leaves.\n2. Take N = R3 with Heisenberg group structure. This is defined by\n\u0001\n1\n(x, y, z) * (x\u2032 , y \u2032, z \u2032 ) = x + x\u2032 , y + y \u2032, z + z \u2032 + (xy \u2032 \u2212 yx\u2032 ) .\n2\n\nLet X, Y, Z be the left-invariant vector fields which give the standard basis\nfor R3 at the origin. As operators:\n1 \u2202\n\u2202\n\u2212 y ,\n\u2202x 2 \u2202z\n\u2202\nZ(x, y, z) =\n.\n\u2202z\n\nX(x, y, z) =\n\nY (x, y, z) =\n\n\u2202\n1 \u2202\n+ x\n\u2202y 2 \u2202z\n\nTake B to be half the sum of the squares of X, Y , and Z. This is half the\nleft invariant Laplacian:\n\u0012\n\u0013\n\u22022\n1 2\n\u22022\n1\n\u22022\n\u22022\n1 \u22022\n2\n+\n+ (1 + (x + y )) 2 + (x\n\u2212y\n) .\nB=\n2 \u2202x2 \u2202y 2\n4\n\u2202z\n2 \u2202y\u2202z\n\u2202x\u2202z\nTake M = R2 and p : R3 \u2192 R2 to be the projection on the first 2 coordinates. Then\n1 \u22022\n\u22022\n( 2 + 2 ),\n2 \u2202x\n\u2202y\n1 2 1 \u22022\n=\nZ =\n.\n2\n2 \u2202z 2\n\nA =\nBV\n\n1\nAH = (X 2 + Y 2 );\n2\n\nNote that the horizontal lift \u03c3\u0303, of a smooth curve \u03c3 : [0, T ] \u2192 M with\n\u03c3(0) = 0, is given by\n\u0013\n\u0012\nZ\n\u0001\n1 t 1\n2\n2\n1\n1\n2\n\u03c3 (t)d\u03c3 (t) \u2212 \u03c3 (t)d\u03c3 (t) .\n(2.9)\n\u03c3\u0303(t) = \u03c3 (t), \u03c3 (t),\n2 0\n\nThus the \"vertical\" component of the horizontal lift is the area integral of\nthe curve. Equation (2.9) remains valid for the horizontal lift of Brownian motion on R2 , or more generally for any continuous semi-martingale,\n\n\f28\n\nCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\nprovided it is interpreted as a Stratonovich equation ( or equivalently an\nIto equation in the Brownian motion case). This example is also that of\na Riemannian submersion. In this case the horizontal distributions are not\nintegrable. Indeed the Lie brackets satisfy [X, Y ] = Z and H\u00f6rmander's\ncondition for hypoellipticity: a diffusion operator L satisfies H\u00f6rmander's\ncondition if for some (and hence all) H\u00f6rmander form representation such\nas in equation (1.7) the vector fields Y 1 , . . . , Y m together with their iterated Lie brackets span the tangent space at each point of the manifold. For\nan enjoyable discussion of the Heisenberg group and the relevance of this\nexample to \"Dido's problem\" see [52]. See also [3],[9], and [36].\n\nRecall that F \u2261 \u2294u Fu = \u222au (Tu p)\u22121 [Ep(u) ], we can now strengthen Lemma\n2.1.3 which states that Image[\u03c3uB ] \u2282 Fu .\nCorollary 2.3.7 If B is over A with A cohesive, then B is along F .\nProof. Since Hu \u2208 Fu and V Tu N \u2282 Fu both B1 and B V are along F .\n\n2.4 Diffusion Operators with Projectible Symbols\nGiven p : N \u2192 M as before, suppose now that we have a diffusion operator B\non M with a projectible symbol, c.f. Definition 2.1.5. This means that \u03c3 B lies\nover some positive semi-definite linear map \u03b7 : T \u2217 M \u2192 T M. Assume that \u03b7 has\nconstant rank. We will show that in this case we also have a decomposition of B.\nTo do this first choose some cohesive diffusion operator A on M with \u03c3 A = \u03b7. In\ngeneral there is no canonical way to do this, though if \u03b7 were non-degenerate we\ncould choose A to be a multiple of the Laplace-Beltrami operator of the induced\nmetric on M.\nFrom above we also have an induced semi-connection with horizontal subbundle H, say, of T N.\nDefinition 2.4.1 We will say that B descends cohesively (over p) if it has a projectible symbol and there exists a horizontal vector field, bH , such that\nB \u2212 LbH\nis projectible over p.\n\n\f2.4. DIFFUSION OPERATORS WITH PROJECTIBLE SYMBOLS\n\n29\n\nThe following is a useful observation. Its proof is immediate from the two lemmas\nand proposition which are given after it:\nProposition 2.4.2 If B descends cohesively then for each choice of A satisfying\nA\n\u03c3p(u)\n= Tu p\u03c3uB (Tu p)\u2217 there is a horizontal vector field bH such that B \u2212 LbH lies\nover A.\nLemma 2.4.3 Assume that \u03b7 has constant rank. If f is a function on M let f \u0303 =\nf \u25e6 p. For any choice of A with symbol \u03b7 the map\n])\nf 7\u2192 B(f \u0303) \u2212 A(f\nis a derivation from C \u221e M to C \u221e N where any f \u2208 C \u221e M acts on C \u221e N by\nmultiplication by f \u0303.\nProof. The map is clearly linear and for smooth f, g : M \u2192 R we have\n^\n\u03b7(df,\ndg) = \u03c3 B (df \u0303, dg\u0303)\nso by definition of symbols:\n^\n])g\u0303 \u2212 A(g)\n] f \u0303\nB(f \u0303g\u0303) \u2212 A(f\ng) = B(f \u0303)g\u0303 + B(g\u0303)f \u0303 \u2212 A(f\nas required.\nLet D denote the space of derivations from C \u221e M to C \u221e N using the above action.\nNote that for p\u2217 T M \u2192 N the pull back of T M over p, the space C \u221e \u0393p\u2217 T M of\nsmooth sections of p\u2217 T M can be considered as the space of smooth functions\nV : N \u2192 T M with V (u) \u2208 Tp(u) M for all u \u2208 N. We can then define\n\u0398 : C \u221e \u0393p\u2217 T M \u2192 D\nby\n\u0398(V )(f )(u) = dfp(u) (V (u)).\nLemma 2.4.4 Assume that \u03b7 has constant rank The map \u0398 : C \u221e \u0393p\u2217 T M \u2192 D is\na linear bijection.\n\n\f30\n\nCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\n\nProof. Let d \u2208 D. Fix u \u2208 N. The map from C \u221e M to R given by f 7\u2192 df (u)\nis a derivation at p(u), here the action of any f \u2208 C \u221e M on R is multiplication\nby f (p(u)), and so corresponds to a tangent vector, V (u) say, in Tp(u) M. Then\ndf (u) = dfp(u) (V (u)). By assumption df (u) is smooth in u, and so by suitable\nchoices of f we see that V is smooth. Thus \u0398(V ) = d and \u0398 has an inverse.\n\nFrom these lemmas we see there exists b \u2208 C \u221e \u0393p\u2217 T M with the property that\n\u0010\n\u0011\n\u0001\nf (u) = dfp(u) b(u)\nBf \u0303 \u2212 Af\n(2.10)\n\nfor all u \u2208 N and f \u2208 C \u221e M. Assume that b has image in the subbundle E of\nT M determined by \u03b7. Using the horizontal lift map h determined by B define a\nvector field bH on N:\n\u0001\nbH (u) = hu b(u) .\n\nProposition 2.4.5 Assume that \u03b7 has constant rank and that b has image in the\nsubbundle E determined by \u03b7. The vector field bH is such that B \u2212 bH is over A.\nProof. For f \u2208 C \u221e M,\nf + df (b(\u2212)) \u2212 df \u25e6 T p(bH (\u2212)) = Af\nf\n(B \u2212 bH )(f \u0303) = Af\n\u0001\nusing the fact that T p bH (\u2212) = b(\u2212).\n\nWe can now extend the decomposition theorem:\n\nTheorem 2.4.6 Let B be a diffusion operator on N which descends cohesively\nover p : N \u2192 M. Then B has a unique decomposition:\nB = BH + BV\ninto the sum of diffusion operators such that\n(i) BV is vertical\nH\n\n(ii) BH is cohesive and Tu p is injective on the image of \u03c3uB for all u \u2208 N.\nWith respect to the induced semi-connection BH is horizontal.\n\n\f2.5. HORIZONTAL LIFT OF PATHS & COMPLETENESS OF SEMI-CONNECTIONS 31\nProof. Using the notation of the previous proposition we know that B \u2212 bH is\nover a cohesive diffusion operator A. By Theorem 2.3.5 we have a canonical\ndecomposition\nB \u2212 bH = B1 + BV ,\nleading to\nB = (bH + B1 ) + BV .\n\nIf we set BH = bH + B1 we have a decomposition as required. On the other hand\nif we have two such decompositions of B we get two decompositions of B \u2212 bH .\nBoth components of the latter must agree by the uniqueness in Theorem 2.3.5, and\nso we obtain uniqueness in our situation.\nExtending Definition 2.3.3 we could say that a diffusion operator BH satisfying\ncondition (ii) in the theorem has no vertical part.\nNote that if we drop the hypothesis that bH is horizontal, or equivalently that\nb in Proposition 2.4.5 has image in E, we still get a decomposition by taking an\narbitrary lift of b to be bH but we will no longer have uniqueness.\n\n2.5 Horizontal lift of paths & completeness of semiconnections\nA semi-connection on p : N \u2192 M over a sub-bundle E of T M gives a procedure\nfor horizontally lifting paths on M to paths on N as for ordinary connections but\nnow we require the original path to have derivatives in E; such paths may be\ncalled E-horizontal.\nDefinition 2.5.1 A Lipschitz path \u03c3\u0303 in N is said to be a horizontal lift of a path\n\u03c3 in M if\n\u2022 p \u25e6 \u03c3\u0303 = \u03c3\n\u2022 The derivative of \u03c3\u0303 almost surely takes values in the horizontal subbundle\nH of T N.\nNote that a Lipschitz path \u03c3 : [a, b] \u2192 M with \u03c3\u0307(t) \u2208 E\u03c3(t) for almost all\na 6 t 6 b has at most one horizontal lift from any starting point ua in p\u22121 (\u03c3(a)).\nTo see this first note that any such lift must satisfy\n \u0307\n\u03c3\u0303(t)\n= h\u03c3\u0303(t) \u03c3\u0307(t).\n\n(2.11)\n\n\f32\n\nCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\n\nThis equation can be extended to give an ordinary differential equation on all of\nN. For example take a smooth embedding j : M \u2192 Rm into some Euclidean\nspace. Set \u03b2(t) = j(\u03c3(t)). Let X(x) : Rm \u2192 Ex be the adjoint of the restriction\nof the derivative Tx j of j to Ex , using some Riemannian metric on E. Then \u03c3\nsatisfies the differential equation\n\u1e8b(t) = X(x(t))(\u03b2\u0307(t))\n\n(2.12)\n\nand it is easy to see that the horizontal lifts of \u03c3 are precisely the solutions of\nu\u0307(t) = hu(t) X(p(u(t)))(\u03b2\u0307(t))\nstarting from points above \u03c3(a) and lasting until time b.\nIn the generality in which we are working there may not be any such solutions, for example because of \"holes\" in N. We define the semi-connection to\nbe complete if every Lipschitz path \u03c3 with derivatives in E almost surely, has a\nhorizontal lift starting from any point above the starting point of \u03c3.\nNote that completeness is assured if the fibres of N are compact, or if an X,\nwith values in E, and \u03b2, can be found so that \u03c3 is a solution to equation (2.12) and\nthere is a complete metric on N for which the horizontal lift of X is bounded on\nthe inverse image of \u03c3 under p. In particular the latter will hold if p is a principal\nbundle and we have an equivariant semi-connection as in the next chapter. It will\nalso hold if there is a complete metric on N for which the horizontal lift map\nhu \u2208 L(Ep(u) ; Tu N) is uniformly bounded for u in the image of \u03c3.\n\n2.6 Topological Implications\nAlthough our set up of intertwining diffusions with a cohesive A seems quite\ngeneral it implies strong topological restrictions if the manifolds are compact and\nmore generally. Here we partially extend the approach Hermann used for Riemannian submersions in [37] with a more detailed discussion in Chapter 6 below.\nFor this let D 0 (x) be the set of points z \u2208 M which can be reached by Lipschitz curves \u03c3 : [0, t] \u2192 M with \u03c3(0) = x0 and \u03c3(t) = z with derivative in E\nalmost surely. Its closure D \u2032 (x) relates to the propagation set for the maximum\nprinciple for A, and to the support of the A- diffusion as in Stroock-Varadhan\n[66], see Taira[70].\nTheorem 2.6.1 For B and A as before with A cohesive take x0 \u2208 M and z \u2208\nD 0 (x0 ). Assume the induced semi-connection is complete. Then if p\u22121 (x0 ) is a\n\n\f2.6. TOPOLOGICAL IMPLICATIONS\n\n33\n\nsubmanifold of N so is p\u22121 (z) and they are diffeomorphic. Also if z is a regular\nvalue of p so is x.\nProof. Let \u03c3; [0, T ] \u2192 M be a Lipschitz E-horizontal path from x to z. There\nis a smooth factorisation \u03c3xA = X(x)X(x)\u2217 for X(x) \u2208 L(Rm; Tx M), x \u2208 M.\nTake the horizontal lift X\u0303 : R, \u2192 T N of X.\nBy the completeness hypothesis the time dependent ODE on N,\n\u0010\n\u0011\u22121\ndys\n= X\u0303(ys )X \u03c3(s)|[ker X(x0 )]\u22a5\n(\u03c3\u0307(s))\nds\nwill have solutions from each point above \u03c3(0) defined up to time T and so a\nflow giving the required diffeomorphism of fibres. Moreover, by the usual lower\nsemi-continuity property of the \"explosion time\", this holonomy flow gives a diffeomorphism of a neighbourhood of p\u22121 (x) in N with a neighbourhood of the\nfibre above z. The diffeomorphism commutes with p. Thus if one of x and z is a\nregular value so is the other.\nCorollary 2.6.2 Assume the conditions of the theorem and that E satisfies the\nstandard H\u00f6rmander condition that the Lie algebra of vector fields generated by\nsections of E spans each tangent space Ty M after evaluation at y. Then p is a\nsubmersion all of whose fibres are diffeomorphic.\nProof. The H\u00f6rmander condition implies that D 0 (x) = M for all x \u2208 M by\nChow's theorem (e.g. see Sussmann [69] or [36]. In [36] Gromov shows that\nunder this condition any two points of M can be joined by a smooth E-horizontal\ncurve.\nCorollary 2.6.3 Assume the conditions of the theorem and that D 0 (x) is dense in\nM for all x \u2208 M and p : N \u2192 M is proper. Then p is a locally trivial bundle over\nM.\nProof. Take x \u2208 M. The set Reg(p) of regular values of p is open by our properness assumption. It is also non-empty, even dense in M, by Sard's theorem, and\nso since D 0 (x) is dense, there exists a regular value z which is in D 0 (x). It follows\nfrom the theorem that x \u2208 Reg(p), and so p is a submersion. However it is a well\nknown consequence of the inverse function theorem that a proper submersion is a\nlocally trivial bundle.\nNote that we only need Reg(p) to be open, rather than p proper, to ensure that\np is a submersion. The density of D 0 (x) can hold because of global behaviour,\nfor example if M is a torus and E is tangent to the foliation given by an irrational\nflow.\n\n\f34\n\nCHAPTER 2. DECOMPOSITION OF DIFFUSION OPERATORS\n\n\fChapter 3\nEquivariant Diffusions on Principal\nBundles\nLet M be a smooth finite dimensional manifold and P (M, G) a principal fibre\nbundle over M with structure group G a Lie group. Denote by \u03c0 : P \u2192 M the\nprojection and Ra right translation by a. Consider on P a diffusion generator B,\nwhich is equivariant, i.e. for all f \u2208 C 2 (P ; R),\nBf \u25e6 Ra = B(f \u25e6 Ra ),\n\na \u2208 G.\n\nSet f a (u) = f (ua). Then the above equality can be written as Bf a = (Bf )a . The\noperator B induces an operator A on the base manifold M. Set\nu \u2208 \u03c0 \u22121 (x), f \u2208 C 2 (M),\n\nAf (x) = B (f \u25e6 \u03c0) (u),\n\n(3.1)\n\nwhich is well defined since\nB (f \u25e6 \u03c0) (u * a) = B ((f \u25e6 \u03c0)a ) (u) = B ((f \u25e6 \u03c0)) (u).\n\n3.1 Invariant Semi-connections on Principal Bundles\nDefinition 3.1.1 Let E be a sub-bundle of T M and \u03c0 : P \u2192 M a principal Gbundle. An invariant semi-connection over E, or principal semi-connection\nin the terminology of Michor, on \u03c0 : P \u2192 M is a smooth sub-bundle H E T P of\nT P such that\n35\n\n\f36 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\n(i) Tu \u03c0 maps the fibres H E Tu P bijectively onto E\u03c0(u) for all u \u2208 P .\n(ii) H E T P is G-invariant.\nNotes.\n1. Such a semi-connection determines and is determined by, a smooth horizontal lift:\nhu : E\u03c0(u) \u2192 Tu P\nsuch that (i). Tu \u03c0 \u25e6 hu (v) = v, for all v \u2208 Ex \u2282 Tx M;\n(ii). hu*a = Tu Ra \u25e6 hu .\n2. The action of G on P induces a homomorphism of the Lie algebra g of G\nwith the algebra of left invariant vector fields on P : if A \u2208 g,\nA\u2217 (u) =\n\nd\ndt\n\nu exp(tA),\nt=0\n\nu \u2208 P,\n\nand A\u2217 is called the fundamental vector field corresponding to A.\nUsing the splitting (2.6) of Fu our semi-connection determines, (and is determined by), a 'semi-connection one-form' \u031f \u2208 L(H + V T N; g) which\nvanishes on H and has \u031f(A\u2217(u)) = A.\n3. Let F be an associated vector bundle to P with fibre V . An E semiconnection on P gives a covariant derivative \u2207w Z \u2208 Fx for w \u2208 Ex , x \u2208 M\nwhere Z is a section of F . This is defined, as usual for connections, by\n\u0001\n\u2207w Z = u d(Z\u0303)(hu (w)) ,\nu \u2208 \u03c0 \u22121 (x). Here Z\u0303 : P \u2192 V is\n\nZ\u0303(u) = u\u22121Z (\u03c0(u))\nconsidering u as an isomorphism u : V \u2192 F\u03c0(u) . This agrees with the\n'semi-connections on E' defined in Elworthy-LeJan-Li [27] when P is taken\nto be the linear frame bundle of T M and F = T M.\nTheorem 3.1.2 Assume \u03c3 A has constant rank. Then \u03c3 B gives rise to an invariant\nsemi-connection on the principal bundle P whose horizontal map is given by (2.5).\n\n\f3.1. INVARIANT SEMI-CONNECTIONS ON PRINCIPAL BUNDLES\n\n37\n\nProof. It has been shown that hu is well defined by (2.5). Next we show hu\ndefines a semi-connection. As noted earlier, h defines a semi-connection if (i)\nTu \u03c0 \u25e6 hu (v) = v, v \u2208 Ex \u2282 Tx M and (ii) hu*a = Tu Ra \u25e6 hu . The first is immediate\nby Lemma 2.1.1 and for the second observe \u03c0 \u25e6 Ra = \u03c0. So T \u03c0 \u25e6 T Ra = T \u03c0 and\n(T \u03c0)\u2217 = (T Ra )\u2217 * (T \u03c0)\u2217 while the following diagram\n\nTu\u2217 P\n\n\u03c3uB\n\n\u2732 Tu P\n\n\u273b\n\n(Tu Ra )\u2217\n\u2217\nTu*a\nP\n\nTu Ra\n\u2732\n\n\u2744\n\nTua P\n\nB\n\u03c3u*a\ncommutes by equivariance of B. Therefore\n\nTu Ra \u25e6 hu = Tu Ra * \u03c3uB (Tu \u03c0)\u2217 \u25e6 \u03c3xA\n\n\u0001\u22121\n\n= Tu Ra * \u03c3uB \u25e6 (Tu Ra )\u2217 \u25e6 (Tu*a \u03c0)\u2217 \u25e6 \u03c3xA\n\u0001\u22121\nB\n= \u03c3u*a\n\u25e6 (Tu*a \u03c0)\u2217 \u25e6 \u03c3xA\n= hu*a .\n\n\u0001\u22121\n\nCurvature forms and holonomy groups etc for semi-connections are defined\nanalogously to those associated two connections, we note the following:\nProposition 3.1.3 In the situation of Proposition 2.1.4 suppose A is elliptic, p1 ,\np2 are principal bundles with groups G1 and G2 respectively, and F is a homomorphism of principal bundles with corresponding homomorphism f : G1 \u2192 G2 .\nLet \u03931 and \u03932 be the semi-connections on N 1 , N 2 determined by B1 and B2 . Then\n(i) \u03932 is the unique semi-connection on p2 : N 2 \u2192 M such that T F maps the\nhorizontal subspaces of T N 1 into those of T N 2 .\n\n(ii) If \u03c9 j , \u03a9j are the semi-connection and curvature form of \u0393j , for j = 1, 2,\nthen\nF \u2217 (\u03c9 2 ) = f\u2217 \u25e6 \u03c9 1\nand\n\nF \u2217 (\u03a92 ) = f\u2217 \u25e6 \u03a91\n\n\f38 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nfor f\u2217 : g 1 \u2192 g 2 the homomorphism of Lie algebras induced by f .\n(iii) Moreover f : G1 \u2192 G2 maps the \u03931 holonomy group at u \u2208 N 1 onto the\n\u03932 holonomy group at F (u) for each u \u2208 N 1 and similarly for the restricted\nholonomy groups.\nProof. Proposition 2.1.4 assures us that T F maps horizontal to horizontal. Uniqueness together with (ii), (iii) come as in Kobayashi-Nomizu [41] (Proposition 6.1\non p79).\n\n3.2 Decompositions of Equivariant Operators\nTake a basis A1 , . . . , An of g with corresponding\nfields {A\u2217i }.\nP kfundamental vector\nWrite the semi-connection 1-form as \u031f =\n\u031f Ak so that \u031f k are real valued,\npartially defined, 1-forms on P .\nIn our equivariant situation we can give a more detailed description of the\ndecomposition in Proposition 2.3.5.\nTheorem 3.2.1 Let B be an equivariant operator on P and A be the induced operator on the base manifold. Assume that A is cohesive and let B = AH +BV be the\ndecomposition\nof Proposition\n2.3.5. Then BV has a unique expression of the form\nX\nX\n\u03b1ij LA\u2217i LA\u2217j +\n\u03b2 k LA\u2217k , where \u03b1ij and \u03b2 k are smooth functions on P , given\n\u0001\nby \u03b1kl = \u031f k \u03c3 B (\u031f l ) , and \u03b2 l = \u03b4 B (\u031f l ) for \u031f the semi-connection 1-form on\nP . Define \u03b1 : P \u2192 g \u2297 g and \u03b2 : P \u2192 g by\nX\nX\n\u03b1(u) =\n\u03b1ij (u)Ai \u2297 Aj ,\n\u03b2(u) =\n\u03b2 k (u)Ak .\n(3.2)\nThese are independent of the choices of basis of g and are equivariant:\n\u03b1(ug) = (ad(g) \u2297 ad(g)) \u03b1(u)\nand\n\u03b2(ug) = ad(g)\u03b2(u).\nProof. Since every vertical vector field is a linear combination of the fundamental\nvertical vector fields, Proposition 1.4.4, shows that\nX\nX\nBV =\n\u03b1i,j LA\u2217i LA\u2217j +\n\u03b2 k LA\u2217k\n\n\f3.2. DECOMPOSITIONS OF EQUIVARIANT OPERATORS\n\n39\nH\n\nfor certain functions \u03b1ij , \u03b2 k . For f, g : P \u2192 R setting \u03c3 := \u03c3 B\u2212A ,\n\n1 X i,j\n1 X i,j\n\u03b1 LA\u2217i LA\u2217j (f g) \u2212\ng\u03b1 LA\u2217i LA\u2217j (f )\n2\n2\n1 X i,j\nf \u03b1 LA\u2217i LA\u2217j (g)\n\u2212\n2\nX\n=\n\u03b1i,j LA\u2217i (f )LA\u2217j (g)\nX\n=\n\u03b1i,j df (Ai \u2217 )dg(Aj \u2217 ).\n\ndf (\u03c3(dg)) =\n\nSince \u031f(A\u2217k ) = Ak , we see that \u031f k (A\u2217l ) = \u03b4kl and\nX\n\u031f k (\u03c3(\u031f l )) =\n\u03b1i,j \u03b4ik \u03b4jl = \u03b1kl .\nH\n\nSince AH is horizontal \u03c3 A has image in the horizontal tangent bundle and so is\nannihilated by \u031f k . Thus\n\u0001\n\u03b1kl = \u031f k \u03c3 B (\u031f l ) .\n(3.3)\nNote that by the characterisation, Proposition 1.2.1,\nX\nX\nV\n\u03b4B =\n\u03b1i,j LAi \u2217 \u03b9Aj \u2217 +\n\u03b2 k \u03b9Ak \u2217 .\nV\n\nH\n\nSince \u031f l (A\u2217 l ) is identically 1, it follows that \u03b4 B (\u031f) = \u03b2 l . Again \u03b4 A (\u031f l ) = 0\nand so\n\u03b2 l = \u03b4 B (\u031f l )\n(3.4)\nas required.\nFor the last part \u03b1 and \u03b2 can be considered as obtained from the extension\nof the symbol \u03c3 B and \u03b4 B to g-valued two and one forms respectively: \u03b1 =\n\u031f(\u2212)\u03c3 B \u031f(\u2212) and \u03b2 = \u03b4 B (\u031f(\u2212)). To make this precise consider \u03c3uB as a bilinear form and so as a linear map\n\u03c3uB : Tu\u2217 P \u2297 Tu\u2217 P \u2192 R.\nThe extension is the trivial one given by\n\u03c3uB \u2297 1 \u2297 1 : Tu\u2217 P \u2297 Tu\u2217 P \u2297 g \u2297 g \u2192 R \u2297 g \u2297 g \u2243 g \u2297 g\nusing the identification of Tu\u2217 P \u2297 g with L(Tu P ; g). Similarly the extension of \u03b4 B\nis\n\u03b4uB \u2297 1 : Tu\u2217 P \u2297 g \u2192 R \u2297 g \u2243 g.\n\n\f40 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nThus\n\n\u0001\n\u03b1(u)(\u03c9 \u2297 \u03c9) = \u03c3 B \u2297 1 \u2297 1 (P23 \u03c9 \u2297 \u03c9)\n\nwhere P23 : T \u2217 P \u2297g\u2297T \u2217 P \u2297g \u2192 T \u2217 P \u2297T \u2217 P \u2297g\u2297g is the standard permutation\nand \u03b2u (\u03c9) = (\u03b4uB \u2297 1)(\u03c9).\nThe equivariance of \u031f\n(Rg )\u2217 \u031f = ad(g \u22121 )(\u031f),\n\ng\u2208G\n\nis equivalent to the invariance of \u031f when considered as a section of T \u2217 M \u2297 g\nunder\nT Rg \u2297 ad(g) : T \u2217 M \u2297 g \u2192 T \u2217 M \u2297 g,\ng \u2208 G.\nP\nRemark 3.2.2 (a) For any equivariant operator of the form B = i,j \u03b1ij LA\u2217i LA\u2217j +\nP k\n\u03b2 LA\u2217k with (\u03b1ij (u)) positive semi-definite for each u \u2208 P we can define maps \u03b1 and \u03b2 by (3.2). Note that \u03b1(u) is essentially the symbol of B\nrestricted to the fibre P\u03c0(u) through u:\n\u03c3uB |P\u03c0(u) : Tu\u2217 P\u03c0(u) \u2192 Tu P\u03c0(u)\nwith \u031fu identifying Tu P\u03c0(u) with g. Similarly \u03b2 determines \u03b4 B on a basis\nof sections of (V T P )\u2217.\n(b) Let {ut : 0 6 t 6 \u03b6} be\n2\u03b1kl (ut ) is the\nD Ra B-diffusionRon P . By (3.3),\nE\n*\n*\nderivative of the bracket\n\u031fuks \u25e6 dus , 0 \u031ful s \u25e6 dus of the integrals of\n0\n\u03c9 k and \u03c9 l along {ut : 0 6 t < \u03b6}. See chapter 4 below for a detailed\ndiscussion. Thus \u03b1(ut) is the derivative of the tensor quadratic variation:\nZ\n\u0011\n1 d t\u0010\n\u03b1(ut ) =\n\u031fut \u25e6 dut \u2297 \u031fut \u25e6 dut .\n2 dt 0\nRt\nMoreover by (3.4) and Lemma 4.1.2 below 0 \u03b2(us )ds is the bounded variRt\nation part of 0 \u031fus \u25e6 dus .\n\n(c) If we fix u0 \u2208 P and take an inner product on g we can diagonalise \u03b1(u0 )\nto write\nX\n\u03b1(u0 ) =\n\u03bcn An \u2297 An\nn\n\n\f3.3. DERIVATIVE FLOWS AND ADJOINT CONNECTIONS\n\n41\n\nwhere {An : n = 1, . . . dim(g)} is an orthonormal basis. The \u03bcn are the\neigenvalues of \u03b1(u0)# : g \u2192 g obtained using the isomorphism:\ng \u2297 g \u2192 L(g; g)\na \u2297 b 7\u2192 (a \u2297 b)# ,\nwhere (a \u2297 b)# (v) = hb, via.\n\nP\nNote that for g \u2208 G, \u03b1(u0 *g) = n \u03bcn ad(g)An \u2297ad(g)An . When the inner\ndim(g)\nproduct is ad(G)-invariant then {ad(g)An }n=1 is still orthonomal and the\n{\u03bcn }n are the eigenvalues of \u03b1(u0 * g)# . They are therefore independent of\nthe choice of u0 in a given fibre, (but depend on the inner product chosen).\n\n3.3 Derivative Flows and Adjoint Connections\nLet A on M be given in H\u00f6rmander form\nm\n\n1X\nLX j LX j + LA\nA=\n2 j=1\n\n(3.5)\n\nfor some smooth vector fields X 1 , . . . X m , A. As before let Ex = span{X 1 (x), . . . , X m (x)}\nand assume dim Ex is constant, denoted by p, giving a sub-bundle E \u2282 T M. The\nvector fields {X 1 (x), . . . , X m (x)} determine a vector bundle map\nX : Rm \u2192 T M\nwith \u03c3 A = X(x)X(x)\u2217 .\nWe can, and will, consider X as a map X : Rm \u2192 E. Let Yx be the right\ninverse [X(x)|ker X(x)\u22a5 ]\u22121 of X(x) and h, ix the inner product, induced on Ex by\n \u0306 on E\nYx . Then X projects the flat connection on Rm to a metric connection \u2207\ndefined by\n \u0306 v U = X(x)d[y 7\u2192 Yy U(y)](v),\n\u2207\n\nU \u2208 C 1 \u0393E, v \u2208 Ty M,\n\n(3.6)\n\n(In [27] we have studied the properties of this construction together with the SDE\n \u0306 is referred as the LW connection for the SDE.) Moreinduced by X, and there \u2207\nover any connection \u2207 on a subbundle E of T M has an adjoint semi-connection\n\u2207\u2032 on T M over E defined by\n\u2207\u2032U V = \u2207V U + [U, V ],\n\nU \u2208 \u0393E, V \u2208 \u0393T M.\n\n\f42 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nLet \u03c0 : GLM \u2192 M be the frame bundle of M, so u \u2208 \u03c0 \u22121 (x) is a linear\nisomorphism u : Rn \u2192 Tx M. It is a principal bundle with group GL(n). If\ng \u2208 GL(n) and \u03c0(u) = x then u * g : Rn \u2192 Tx M is just the composition of u\nwith g.\nAny smooth vector field A on M determines smooth vector fields AT M and\nGL\nA on T M and GLM respectively as follows: Let \u03b7t : t \u2208 (\u2212\u01eb, \u01eb) be a (partial)\nflow for A and T \u03b7t its derivative. Then v 7\u2192 T \u03b7t (v) is a partial flow on T M and\nu 7\u2192 T \u03b7t \u25e6 u one on GLM, Let AT M and AGL be the vector fields generating\nthese flows. In fact AT M is \u03c4 \u25e6 T A : T M \u2192 T T M where \u03c4 : T T M \u2192 T T M is\nthe canonical twisting map:\n\u03c4 (x, v, w, v \u2032) = (x, v, v \u2032 , w)\nin local coordinates.\nUsing this, the choice of our H\u00f6rmander form representation induces a diffusion operator B on GLM by setting\n1X\nL(X j )GL L(X j )GL + LAGL .\nB=\n2\nThen \u03c0 intertwines B and A. For w \u2208 Ex , set\nZ w (y) = X(y)Yx(w).\n\nTheorem 3.3.1 Assume the diffusion operator A given by (3.5) is cohesive and\nlet B be the operator on GLM determined by A. Let E be the image of \u03c3 A , a\nvector bundle.\n \u0306 given by (3.6).\n(a) The semi-connection \u2207 induced by B is the adjoint of \u2207\nConsequently \u2207w V = LZ w V for any vector field V and w \u2208 Ex ,\n(b) For u \u2208 GLM, identifying gl(n) with L(Rn ; Rn ),\n\u0011\n\u0011 \u0010\n1 X \u0010 \u22121\n\u22121\np\np\n \u0306\n \u0306\n\u03b1(u) =\nu (\u2212)\u2207u(\u2212) X \u2297 u (\u2212)\u2207u(\u2212) X ,\n2\n1 X \u22121  \u0306\n1\n \u0306 u(\u2212) A.\n\u03b2(u) = \u2212\nu \u2207\u2207 \u0306 u(\u2212) X p X p \u2212 u\u22121 Ric# u(\u2212) + u\u22121 \u2207\n2\n2\n \u0306 considered as an operator\nHere Ric# : T M \u2192 E is the Ricci curvature of \u2207\nfrom T M to E, defined by\nm\nX\n\u0001\nRic# (v) =\nR\u0306 v, X j (x) X j (x)\nj=1\n\n \u0306\nfor R\u0306 the curvature operator of \u2207.\n\n\f3.3. DERIVATIVE FLOWS AND ADJOINT CONNECTIONS\n\n43\n\nProof. The first part can be deduced from the stochastic flow results in chapter 8\nbut we give a direct proof here. Let \u03c0te be the flow of X(*)(e). It induces a linear\nmap X\u0303(u) : Rm \u2192 Tu GLM on the general linear bundle GLM:\nX\u0303(*)e = [X(*)(e)]GL\nd\n(T Ste \u25e6 u)|t=0 ,\nX\u0303(u)(e) =\ndt\n\nu \u2208 GLM.\n\nWe can apply lemma 2.2.1 with R\u0303m = Rm and so lu = Y (p(u))X(p(u)). If\nx = p(u) and e \u22a5 ker[X(x)] then the horizontal lift map hu defined by Theorem\n3.1.2 is\nd\nhu (X(x)(e)) = X\u0303(u) (lu (e)) =\n(T \u03c0te \u25e6 u) .\n(3.7)\ndt t=0\nNote this will not hold in general if e \u2208 ker[X(x)].\nLet \u03c3 : [0, T ] \u2192 M be a C 1 curve with \u03c3\u0307(t) \u2208 E\u03c3(t) each t. Then\nZ \u03c3\u0307(t) (x) := X(x)Y\u03c3(t) \u03c3\u0307(t).\n\u03c3\nLet Ss,t\nbe the flow, from time s to time t, of the time dependent vector field Z \u03c3\u0307(t) .\n\u03c3\nNow Ss,t\n(\u03c3(s)) = \u03c3(t) for 0 6 s 6 t 6 T . Also, for any torsion free connection\nand any v \u2208 T\u03c3(s) M\n\nD\ndt\n\nt=s\n\n\u0001\n\u03c3\n\u03c3\nT Ss,t\n(v) = \u2207Z \u03c3\u0307(t) T Ss,t\n(v) |t=s = \u2207v Z \u03c3\u0307(s) .\n\nThus\n\nD\n\u03c3\n\u03c3\u0307(t)\n\u03c3 Z\nT S0,t\n(v) = \u2207T S0,t\n.\ndt\nIf \u031f is the connection form of this torsion free connection then\n\u0013\n\u0012\n\u0001\u22121 D\nD\n\u03c3\n\u03c3\n\u03c3\nT S0,t \u25e6 u0\n= [e 7\u2192 T S0,t\n\u25e6 u0\nT S0,t\n(u0(e))]\n\u031f\ndt\ndt\n\u0001\u22121\n\u03c3\n\u03c3\u0307(t)\n\u03c3 u (e) Z\n= [e 7\u2192 T S0,t\n\u25e6 u0\n\u2207T S0,t\n]\n0\n\u0010\n\u0011\n\u03c3 \u25e6u (\u03c3\u0307(t))\n= \u031f hT S0,t\n0\n\nby (3.7), showing that the vertical parts of\nequal.\n\nd\ndt\n\n\u0001\n\u03c3\n\u03c3 \u25e6u (\u03c3\u0307(t))\nT S0,t\n\u25e6 u0 and hT S0,t\n0\n\n\f44 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nOn the other\n\u0001 hand, using this auxiliary connection, the horizontal parts of\n\u03c3\n\u03c3 \u25e6u (\u03c3\u0307(t)) are both equal to the horizontal lift of \u03c3\u0307(t).\nT S0,t \u25e6 u0 and hT S0,t\n0\nThus\n\u0001\nd\n\u03c3\n\u03c3 \u25e6u (\u03c3\u0307(t))\nT S0,t\n\u25e6 u0 = hT S0,t\n0\ndt\nd\ndt\n\n\u03c3\nand so {T S0,t\n\u25e6 u0 : 0 6 t 6 T } is the horizontal lift of {\u03c3(t) : 0 6 t 6 T }\nwith respect to the semi-connection induced by B. However by Lemma 1.3.4 in\n\u03c3\n\u03c3\nElworthy-LeJan-Li [27], T S0,t\n(v) of S0,t\nis the parallel translation of v along \u03c3 by\n\u02c6 of the LeJan-Watanabe connection on E associated\nthe adjoint semi-connection \u2207\n\u03c3\nto X and {T S0,t \u25e6 u0 : 0 6 t 6 T } is the horizontal lift of {\u03c3(t) : 0 6 t 6 T }\n\u02c6 This proves the first claim. And \u2207w V = LZ w V by Lemma\nwith respect to \u2207.\n1.3.4 of Elworthy-LeJan-Li [27].\nFor the last part let \u031f : H \u2295 V T GLM \u2192 g = L(Rn ; Rn ) be the semiconnection 1-form. For u0 \u2208 GLM, set ut = T \u03bet \u25e6 u0 where {\u03bet } is a local flow\nfor the stochastic differential equation\n\ndxt = X(xt ) \u25e6 dBt + A(xt )dt\n\n(3.8)\n\non M where {Bt } is a Brownian motion on Rm . (This defines the derivative flow\non GLM.)\nAs for ordinary connections\n\u031f(\u25e6dut) = u\u22121\nt\n\nD\u0302\n(ut \u2212) \u2208 L(Rn ; Rn ).\ndt\n\nHere, on the right hand side ut is differentiated as a process of linear maps ut \u2208\nL(Rn ; Txt M) over (xt ). [It suffices to check the equality for C 1 curves (ut ) with\nxt = \u03c0(ut ) having \u1e8bt \u2208 Ext , t > 0. For this we can write ut = x\u0303t * gt for x\u0303t a\nD\u0302\nhorizontal lift of {xt } and gt \u2208 G. Then observe that dt\n(ut \u2212) = x\u0303t dtd (x\u0303\u22121\nt ut \u2212).]\nHowever as in [27],\nu\u22121\nt\n\nD\u0302\n\u22121  \u0306\n \u0306\n(ut \u2212) = u\u22121\nt \u2207ut \u2212 X \u25e6 dBt + ut \u2207ut \u2212 Adt.\ndt\n\nFrom this the formula for \u03b1(u) follows\nR tby Remark 3.2.2(b). For \u03b2(u) we need\nto identify the bounded variation part of 0 \u031f(\u25e6dut). For this write\n\u22121\n\u22121 \u02c6\n\u02c6 \u22121  \u0306\n \u0306\nu\u22121\nt \u2207ut \u2212 X \u25e6 dBt = u0 Tx0 \u03bet //t \u25e6 //t \u2207T \u03bet \u25e6u0 X \u25e6 dBt\n\n\f3.3. DERIVATIVE FLOWS AND ADJOINT CONNECTIONS\n\n45\n\nwhere /\u02c6/t is the parallel translation along {\u03bes (x0 ) : 0 6 s 6 t} using our semi \u0306 by Theorem 3.3.1. As in [27]\nconnection, which is the adjoint of \u2207\n\u22121\n \u0306 T \u03bet u0 XdBt \u2212 1 /\u02c6/t \u22121 Ric# (T \u03bet \u25e6 u0 \u2212)dt\n \u0306 T \u03bet \u25e6u0 X \u25e6 dBt = /\u02c6/t \u22121 \u2207\n/\u02c6/t \u2207\n2\n\nwhile\n\u22121 \u02c6\nu\u22121\n0 T \u03bet //t\n\n=\n\nu\u22121\n0\n\n\u2212\n\nZ\n\n0\n\nt\n\n\u22121  \u0306\nu\u22121\n0 T \u03bes \u2207//\u02c6s \u2212 X\n\n\u25e6 dBs \u2212\n\nZ\n\n0\n\nt\n\n\u22121  \u0306\nu\u22121\n0 T \u03bes \u2207//\u02c6 \u2212 Ads\ns\n\ngiving the formula claimed for \u03b2.\nExample: Gradient Brownian SDE\nAn isometric immersion j : M \u2192 Rm of a Riemannian manifold M determines\na stochastic differential equation on M:\ndxt = X(xt ) \u25e6 dBt\nwhere X(x) : Rm \u2192 Tx M is the orthogonal projection and B. is a Brownian\nmotion on Rm . More precisely\nX(x)(e) = \u2207[y 7\u2192 hj(y), i](x).\nIt is well known that the solutions of the SDE are Brownian motions on M, see\n[21],[63], [22], and the equation is often called a \"gradient Brownian SDE\" .\nMoreover the LW connection given by equation (3.6) is the Levi-Civita connection\n, (by the classical construction of the latter), see [27]. Since the adjoint of the LevCivita connection is itself, Theorem 3.3.1, shows that our connection induced on\nGLM by the derivative flow of a gradient Brownian system is also the Levi-Civita\nconnection. Almost by definition,\nh\u2207v X p , wiRm = ha(v, w), ep iRm\n\n(3.9)\n\nwhere a : T M \u00d7 T M \u2192 Rm is the second fundamental form of the immersion\nwith\n\u2207v X(e) = A(v, nx e)\nv \u2208 Tx M, x \u2208 M, e \u2208 Rm\n(3.10)\nfor nx : Rm \u2192 Tx M \u22a5 the projection and A : T M \u2295 T M \u22a5 \u2192 T M the shape\noperator given by\nhA(v, e), wiRm = ha(v, w), ep iRm .\n\n\f46 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nHere T M \u22a5 refers to the normal bundle of M and Tx M \u22a5 to the normal space at x\nto M, though we are considering its elements as being in the ambient space Rm .\nThus the vertical operator in the decomposition of the generator of the derivative\nflow on GLM for gradient flows is given by Theorem 3.3.1 with\nm\u2212n\n1 X \u22121\nu A(u\u2212, lj ) \u2297 u\u22121 A(u\u2212, lj )\n\u03b1(u) =\n2 j=1\nm\u2212n\n1X\n1\n\u03b2(u) = \u2212\nA(A(u\u2212, lj ), lj ) \u2212 u\u22121 Ric# (u\u2212)\n2 j=1\n2\n\nat a frame u over a point x. Here l1 , ..., lm\u2212n denotes an orthonormal base for\nTx M \u22a5\nFor the standard embedding of S n in Rn+1 we have\na(u, v) = hu, vix\nfor u, v \u2208 Tx S n . Also the Ricci curvature is given by Ric# (v) = (n \u2212 1)v for all\nv \u2208 T M. Thus for the standard gradient SDE on S n , at any frame u we have\n1\nId \u2297 Id\n2\n1\n\u03b2(u) = \u2212 n Id.\n2\n\n\u03b1(u) =\n\n(3.11)\n(3.12)\n\n3.4 Associated Vector Bundles & Generalised Weitzenb\u00f6ck\nFormulae\nAs before let \u03c0 : P \u2192 M be a smooth principal G-bundle and \u03c1 : G \u2192 L(V ; V )\na C \u221e representation of G on some separable Banach space V . There is then the\n(possibly weakly) associated vector bundle \u03c0 \u03c1 : F \u2192 M where F = P \u00d7 V / \u223c\nfor the equivalence relation given by (u, e) \u223c (ug, \u03c1(g \u22121)e) for u \u2208 P , e \u2208 V ,\ng \u2208 G. If [(u, e)] \u2208 F denotes the equivalence class of (u, e) we can identify any\nu \u2208 P with a linear isomorphism\n\u016b : V \u2192 F\u03c0(u)\nby\n\u016b(e) = [(u, e)].\n\n(3.13)\n\n\f3.4. ASSOCIATED VECTOR BUNDLES & GENERALISED WEITZENB\u00d6CK FORMULAE 47\nConsider the set of smooth maps from P to V , equivariant by \u03c1:\nM\u03c1 (P ; V ) = {smooth Z : P \u2192 V, Z(ug) = \u03c1(g)\u22121Z(u), u \u2208 P, g \u2208 G}.\nThere is the standard bijective correspondence F\u03c1 between M\u03c1 (P, V ) and \u0393(F ),\nthe space of smooth sections of F defined by\nF\u03c1 (Z)(x) = \u016b[Z(u)],\n\nu \u2208 \u03c0 \u22121 (x), Z \u2208 M\u03c1 (P ; V ).\n\nVia this map, an equivariant diffusion generator B on P induces a differential\noperator B\u03c1 \u2261 F\u03c1 (B) on \u0393(F ), of order at most 2, by\nF\u03c1 (B)(F\u03c1 (Z)) = F\u03c1 [B(Z)],\n\nZ \u2208 M\u03c1 (P ; V ).\n\n(3.14)\n\nHere B has been extended trivially to act on V -valued functions. Note that the\ndefinition makes sense since,\n\u0001\nB(Z)(ug) = B (Z \u25e6 Rg ) (u) = B \u03c1(g)\u22121 Z (u) = \u03c1(g)\u22121 B(Z)(u).\nFor such a representation \u03c1 let\n\n\u03c1\u2217 : g \u2192 L(V ; V )\nbe the induced representation of the Lie algebra g (the derivative of \u03c1 at the identity).\nTheorem 3.4.1 When B is a vertical equivariant diffusion generator the induced\noperator on sections of any associated vector bundle is a zero order operator. With\nthe notation of Theorem 3.2.1, the zero order operator in \u0393(F ) induced by B is\nrepresented by \u03bb\u03c1 : P \u2192 L(V ; V ) for\n\u03bb\u03c1 (u) = \u03c1\u2217 (\u03b2(u)) + Comp \u25e6(\u03c1\u2217 \u2297 \u03c1\u2217 )(\u03b1(u)),\n\nu\u2208P\n\n(3.15)\n\nfor Comp : L(V ; V ) \u2297 L(V ; V ) \u2192 L(V ; V ) the composition map A \u2297 B 7\u2192 AB.\nProof. The operator B\u03c1 is a zero order operator if F \u03c1 (B)(S)(x0 ) = F \u03c1 (B)(S \u2032 )\nwhenever two sections S and S \u2032 of F agree at x0 . This holds if B(f Z) = f B(Z)\nfor any invariant function f : P \u2192 R and V -valued function Z on P . But this\nholds by Remark 1.4.5.\nFor the representation (3.15), suppose Z : P \u2192 V is equivariant:\nZ(u \u25e6 g) = \u03c1(g)\u22121 Z(u),\n\ng \u2208 G.\n\n\f48 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nThen\nd\nZ(u * eAj t ))|t=0\ndt\nd\n\u03c1(e\u2212Aj t )Z(u)|t=0\n=\ndt\n= \u2212\u03c1\u2217 (Aj )Z(u).\n\nLA\u2217j (Z)(u) =\n\nIterating we have\nB(Z)(u) =\nproving (3.15).\n\nX\n\n\u03b1ij (u)\u03c1\u2217 (Aj )\u03c1\u2217 (Ai )Z(u) +\n\nX\n\n\u03b2k \u03c1\u2217 (Ak )Z(u)\n\nFrom this theorem we easily have the following estimate, which combined\nwith the discussions below, when applied to the associated bundle \u2227F to the orthonormal bundle, shows that the Weitzenb\u00f6ck curvature is positive if the curvature is.\nCorollary 3.4.2 If \u03c1 is an orthogonal representation, \u0131.e. (\u03c1\u2217 (\u03b1))\u2217 = \u2212\u03c1\u2217 (\u03b1) for\nall \u03b1 \u2208 g, then \u03bb\u03c1 (v, v) 6 0 for all v \u2208 V .\nP\nProof. Write \u03b1 = k \u03bck Ak \u2297 Ak where {Ak } is as in Remark 3.2.2(c). Then for\nv \u2208 F,\nX\nhComp \u25e6(\u03c1\u2217 \u2297 \u03c1\u2217 )(\u03b1(u))(v), vi = h\n\u03bck [\u03c1\u2217 Ak ]2 (v), vi\nX\n= \u2212\n\u03bck h\u03c1\u2217 (Ak )(v), \u03c1\u2217 (Ak )(v)i 6 0,\n\nsince \u03bck 6 0. The result follows from (3.15) since \u03c1\u2217 (\u03b2(u)) is skew symmetric.\n\nThe situation of Corollary 3.4.2 arises when considering the derivative flow\nfor an SDE on a Riemannian manifold whose flow consists of isometries ; for\nexample canonical SDE's on symmetric spaces as in [27].\nQuantitative estimates can be obtained by some representation theory. For\nexample suppose G = O(n) with \u03c1 the standard representation on Rn . Consider\nthe representation \u2227k \u03c1 on \u2227k Rn .\nWe use the following conventions, as in [27]. Let V be an N dimensional real\ninner product space. For 1 6 i 6 n,\n1 X\na1 \u2227 * * * \u2227 an =\nsgn (\u03c0)a\u03c0(1) \u2297 * * * \u2297 a\u03c0(n) ,\nn! \u03c0\n\n\f3.4. ASSOCIATED VECTOR BUNDLES & GENERALISED WEITZENB\u00d6CK FORMULAE 49\n\u03b9v (u1 \u2227 * * * \u2227 uq ) =\n\nq\nX\nj=1\n\n(\u22121)j+1 hv, uj iu1 \u2227 * * * \u2227 ubj \u2227 * * * \u2227 uq\n\n(3.16)\n\nh\u2297ai , \u2297bi i = n!\u03a0i hai , bi i, and h\u2227ai , \u2227bi i = det(hai , bj i). Let \u2227V stand for the\nexterior algebra of V and a\u2217j the \"creation operator\"on \u2227V given by a\u2217j v = ej \u2227 v\nfor (e1 , . . . , eN ) an orthonormal basis for \u2227V . Let aj be its adjoint, the \"annihilation operator\" given by aj = \u0131ej . Note the commutation law:\nai a\u2217j + a\u2217j ai = dij\n\n(3.17)\n\nFor linear forms we have the corresponding operators: (aj )\u2217 \u03c6(v) = \u03c6(aj v)\nand (aj \u03c6)(v) = \u03c6(a\u2217j v). In particular aj \u03c6(v) = \u03c6(ej \u2227 v) and (aj )\u2217 \u03c6(v) = e\u2217j \u2227 \u03c6.\nIf A : V \u2192 V is a linear map on V , there are the operators \u2227A and (d\u039b)(A)\non \u2227V , which restricted to \u2227p V are:\n(d\u039b)(A) (u1 \u2227 * * * \u2227 up ) =\n\np\nX\n1\n\nu1 \u2227 * * * \u2227 uj\u22121 \u2227 Auj \u2227 uj+1 \u2227 * * * \u2227 up ,\n\nand also\n(\u2227A)(u1 \u2227 * * * \u2227 up ) = Au1 \u2227 * * * \u2227 Aup .\n\nNote that since \u03b1(u) is symmetric, (\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u) : V \u2297 V \u2192 V \u2297 V has\nX\n(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)(v 1 \u2227 v 2 ) =\n\u03b1ij (u)\u03c1\u2217 (Ai ) \u2297 \u03c1\u2217 (Aj )(v 1 \u2227 v 2 ) (3.18)\ni,j\n\n=\n\nX\nij\n\n\u03b1ij (u)Ai v 1 \u2227 Aj v 2 .\n\n(3.19)\n\nand so (\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u) restricts to a map of \u22272 V to itself.\nCorollary 3.4.3 Take the Hilbert-Schmidt inner product on so(n) and let 0 6\n\u03bc1 (x) 6 * * * 6 \u03bc(x) 1 n(n\u22121) be the eigenvalues of \u03b1 on the fibre p\u22121 (x), x \u2208 M,\n2\nas described in Remark 3.2.2(c). Then for all V \u2208 \u2227k Rn ,\nD k\nE\n1\n1\n\u2212 k(n \u2212 k)\u03bc 1 n(n\u22121) (x) 6 \u03bb\u2227 (u)V, V 6 \u2212 k(n \u2212 k)\u03bc1 (x).\n2\n2\n2\n\nProof. Following Humphreys [38], \u00a76.2, consider the bilinear form \u03b2 on so(n)\ngiven by\n\u0010\n\u0011\n(n \u2212 2)!\nk\nk\ntrace(AB)\n\u03b2(A, B) = trace (d\u2227 )(A), (d\u2227 )(B) =\n(k \u2212 1)!(n \u2212 k \u2212 1)!\n\n\f50 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nby a short calculation using elementary matrices. By Remark 3.2.2(c) since our\ninner product on so(n) is ad(O(n))-invariant we can write\n1\nn(n\u22121)\n2\n\n\u03b1(u) =\n\nX\nl=1\n\n\u03bcl (x)Al (u) \u2297 Al (u)\n\nwith x = p(u) and {Al (u)}l an orthonormal base for so(n) at each u \u2208 P .\nFor each u \u2208 P , set\nA\u2032l (u) =\n\n(k \u2212 1)!(n \u2212 k \u2212 1)!\nAl (u)\n(n \u2212 2)!\n\nto ensure \u03b2(A\u2032l (u), Aj (u)) = \u03b4lj for each u.\nThen\nD\nE X\nD\nE\n\u2227k\n\u2227k\nk\nk\nComp \u25e6(\u03c1\u2217 \u2297 \u03c1\u2217 )(\u03b1(u)V, V =\n\u03bcl (x) (d\u2227 )Al (u) \u25e6 (d\u2227 )Al (u)V, V\nE\nh (k \u2212 1)!(n \u2212 k \u2212 1)! i\u22121 D\n(d\u2227k )Al (u) \u25e6 (d\u2227k )A\u2032l (u)V, V\n=\n(n \u2212 2)!\n(n \u2212 2)!\nc\u2227k V, V ,\n\u2264 \u2212\n(k \u2212 1)!(n \u2212 k \u2212 1)!\nwhere\nc\u2227k = (d\u2227k )Al (u) \u25e6 (d\u2227k )A\u2032l (u),\n\nthe Casimir element of our representation d\u2227k of so(n). Since the representation\nis irreducible, (for example see [10] Theorem 15.1 page 278),\nthis element is a scalar, and we have, see Humphreys [38]\nc\u2227k =\n\ndim so(n)\n1\nn(n \u2212 1) . . . (n \u2212 k + 1)\n=\nn(n\n\u2212\n1)/\n.\ndim \u2227k Rn\n2\nk!\n\nk\n\nThus \u03bb\u2227 (u) 6 \u2212 21 k(n\u2212k)\u03bc1 . The lower bound follows in the same way.\nWhen B has an equivariant H\u00f6rmander form representation the zero order operator F \u03c1(V ) can be given in a simple way by (3.20) below. This was noted for\nthe classical Weitzenb\u00f6ck curvature terms using derivative flows in Elworthy [23].\nProposition 3.4.4 Suppose\nPB lies over aPcohesive operator A and has a smooth\n1\nH\u00f6rmander form: B = 2 LY j LY j + \u03b2k LY 0 with the vector fields Y j , j =\n\n\f3.4. ASSOCIATED VECTOR BUNDLES & GENERALISED WEITZENB\u00d6CK FORMULAE 51\n1, . . . , m, being G-invariant. Let (\u03b7tj ) be the flow of Y j . For a representation \u03c1\nof G with associated vector bundle \u03c0 \u03c1 : F \u2192 M the zero order operator F \u03c1 (BV )\ncorresponding to the vertical component of B is given by\nm\n\n1 X D2 j\n\u03b7 (u0 )\nF (B )(x0 ) =\n2 j=1 dt2 t\n\u03c1\n\nV\n\nt=0\n\n\u25e6 (\u016b0 )\u22121 +\n\nD 0\n\u03b7 (u0 )\ndt t\n\nt=0\n\n\u25e6 (\u016b0 )\u22121\n\n(3.20)\n\nfor any u0 \u2208 \u03c0 \u22121 (x0 ).\nProof. Set ujt = \u03b7tj (u0 ) \u2208 P and \u03c3(t) = \u03c0(ujt ) so \u016bjt \u2208 L(V ; F\u03c3(t) ). From Remark\n3.2.2(b)\nm\n1X\n\u031f(Y j (u0 )) \u2297 \u031f(Y j (u0 ))\n\u03b1(u0 ) =\n2 j=1\nand so\nm\n\n1X\nD\n(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u0) =\n(\u016b0 )\u22121 \u016bjt\n2 j=1\ndt\n\nt=0\n\n\u2297 (\u016b0 )\u22121\n\nD j\n\u016b\ndt t\n\nt=0\n\nas in the proof of Theorem 3.3.1.\nAlso from equation (3.4)\n\u0011\n\u0011\n1\n1X\nj\n0\nLY j \u031f(Y (\u2212) (u0 ) + \u031f(Y (\u2212) (u0 ).\n\u03b2(u0 ) =\n2 j=1\n2\nm\n\nLet (//t ) denotes parallel translation in F along \u03c3. Then\n\u0011\n\u03c1\u2217 LY j \u031f(Y j (\u2212) (u0 ) =\n\n\u0010\n\u0011\nd\n\u03c1\u2217 \u031f Y j (ujt )\ndt\nt=0\n\u0010\n\u0011\nd\nD\n=\n(\u016bjt )\u22121 \u016bjt\ndt\ndt\nt=0\nd \u0010 \u22121 j \u22121 \u22121 D j \u0011\nu\n(//t ut ) //t\n=\ndt\ndt t t=0\n2\nD j\n\u22121 D j\n\u22121 D\n= \u2212\u016b\u22121\nu\nu\nuj\n\u25e6\n\u016b\n+\n\u016b\n0\n0\n0\ndt t t=0\ndt t t=0\ndt2 t\n\nleading to the required result via Theorem 3.4.1.\n\nt=0\n\n\f52 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nTo examine particular examples we will need to have detailed information\nabout the zero order operators determined by a vertical diffusion generator. For\nthis suppose B is vertical and given by\nB=\n\nX\n1 X ij\n\u03b1 LA\u2217i LA\u2217j +\n\u03b2k LA\u2217k\n2\n\nfor \u03b1 : P \u2192 g \u2297 g and \u03b2 : P \u2192 g as in Theorem 3.2.1 and (3.2).\nMotivated by the Weitzenb\u00f6ck formula for the Hodge-Kodaira Laplacian on\ndifferential forms, see Corollary 3.4.8 below, [64], [15], we shall examine in more\ndetail the case of the exterior power \u2227\u03c1 : G \u2192 L(\u2227V ; \u2227V ) of a fixed representation \u03c1 showing that \u03bb\u2227\u03c1 has expressions in terms of annihilation and creation\noperators which are structurally the same as these of the Weitzenb\u00f6ck curvature\n(which are shown to be a special case in Corollary 3.4.8).\nLemma 3.4.5 If B is a vertical operator on P and (ei , i = 1, 2, . . . , N) is an\northonormal basis of V , the zero order operator on the associated bundle \u2227F \u2192\nM is represented by \u03bb\u2227\u03c1 : P \u2192 L(\u2227p V ; \u2227p V ) with\nN\n1 X\nh((\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)) (ej \u2297 el ), ei \u2297 ek i a\u2217i aj a\u2217k al\n\u03bb (u) =\n2 i,j,k,l=1\n\u2227\u03c1\n\n+\n\nN\nX\n\nh(\u03c1\u2217 \u03b2(u))ej , ei ia\u2217i aj ,\n\ni,j=1\n\nu\u2208P\n\nProof. Recall that if A \u2208 L(V ; V ) then\nd\u039b(A) =\n\nN\nX\n\nhAej , ei ia\u2217i aj ,\n\n(3.21)\n\ni,j=1\n\ne.g. see Cycon-Froese-Kirsch-Simon [15]. Consequently\nd\u039b(\u03c1\u2217 \u03b2(u)) =\n\nN\nX\n\nh\u03c1\u2217 \u03b2(u)ej , ei ia\u2217i aj\n\ni,j=1\n\nOn the other hand by Theorem 3.2.1 and (3.2), we can represent \u03b1 as:\nX\n\u03b1(u) =\nan,m (u)An \u2297 Am\nn,m\n\n(3.22)\n\n\f3.4. ASSOCIATED VECTOR BUNDLES & GENERALISED WEITZENB\u00d6CK FORMULAE 53\nwhere {Ai }N\ni=1 is a basis of g. So\nComp \u25e6(\u2227\u03c1\u2217 \u2297 \u2227\u03c1\u2217 )(\u03b1(u))\nX\n= Comp \u25e6\nan,m (u) d\u039b(\u03c1\u2217Am ) \u2297 d\u039b(\u03c1\u2217 An )\n=\n\nX\nm,n\n\n=\n\nX\n\nm,n\n\nan,m (u)d\u039b(\u03c1\u2217Am ) \u25e6 d\u039b(\u03c1\u2217 An )\nan,m (u)\n\nm,n\n\n=\n\nN\nX\n\nh\u03c1\u2217 Am ej , ei ih\u03c1\u2217 An el , ek ia\u2217i aj a\u2217k al\n\ni,j,k,l=1\n\nN\nX\n1X\nh(\u03c1\u2217 Am \u2297 \u03c1\u2217 An ) (ej \u2297 el ), ei \u2297 ek i a\u2217i aj a\u2217k al\nan,m (u)\n2 m,n\ni,j,k,l=1\n\n=\n\nN\nX\n\n1\nh(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)(ej \u2297 el ), ei \u2297 ek i a\u2217i aj a\u2217k al ,\n2 i,j,k,l=1\n\nsince our convention for the inner product on tensor products gives\nhu1 \u2297 v1 , u2 \u2297 v2 i = 2hu1, u2 ihv1 , v2 i.\nThe desired conclusion follows.\nTheorem 3.4.6 Let R(u) : \u22272 V \u2192 \u22272 V be the restriction of (\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u) :\nV \u2297 V \u2192 V \u2297 V , then\nX\nhR(u)(ej \u2227 el ), ei \u2227 ek i a\u2217i a\u2217k aj al\n\u03bb\u2227\u03c1 (u) = \u2212\ni<k,j<l\n\n+\n\nN\nX\n1 X\nh\u03c1\u2217 \u03b2(u)ej , ei i (ai )\u2217 aj .\nh(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)(ej \u2297 el ), ei \u2297 ej i a\u2217i al +\n2 i,j,l=1\ni,j\n\nThis can be rewritten as:\nX\n1\n\u03bb\u2227\u03c1 (u) = \u2212\nhR(u)(ej \u2227 el ), ei \u2227 ek i a\u2217i a\u2217k aj al + d\u2227(Z \u03c1 (u))+d\u2227(\u03c1\u2217 \u03b2(u)).\n2\ni<k,j<l\n(3.23)\nwhere Z \u03c1 (u) \u2208 L(V ; V ) is defined by\n\u03c1\n\nhZ (v1 ), v2 i =\n\nN\nX\nj=1\n\n(\u03c1\u2217 \u2297 \u03c1\u2217 )(\u03b1(u))(ej \u2297 v1 ), v2 \u2297 ej\n\nV \u2297V\n\n.\n\n\f54 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nProof. This follows from Lemma 3.4.5 since\nN\n1 X\nh(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)(ej \u2297 el ), ei \u2297 ek i a\u2217i aj a\u2217k al\n2\ni,j,k,l=1\n\n=\n\nN\n1 X\n\u2212\nh(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)(ej \u2297 el ), ei \u2297 ek i a\u2217i a\u2217k aj al\n2 i,j,k,l=1\n\n+\n\nN\n1 X\nh(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)(ej \u2297 el ), ei \u2297 ej i a\u2217i al\n2\ni,j,l=1\n\n=\n\n\u2212\n\nN\nX\n\nj<l;i<k\n\nhR(u)(ej \u2227 el ), ei \u2227 ek i a\u2217i a\u2217k aj al\n\nN\n1 X\n+\nh(\u03c1\u2217 \u2297 \u03c1\u2217 )\u03b1(u)(ej \u2297 el ), ei \u2297 ej i a\u2217i al .\n2\ni,j,l=1\n\nRemark 3.4.7 (a) Note that the second term in (3.23) in general depends on\nthe symmetric part of (\u03c1\u2217 \u2297 \u03c1\u2217 )(\u03b1(u)) as well as on R.\n(b) If we write\n\u03b1(u) =\n\nX\n\n\u03bck (u)Ak (u) \u2297 Ak (u)\n\nas in Remark 3.2.2(c), Then Z \u03c1 (u) in (3.23) has\n\u0010\n\u0011\nX\n\u03c1\nZ (u) = 2\n\u03bck (u) \u03c1\u2217 (Ak (u))\u03c1\u2217 (Ak (u)) .\nk\n\nCorollary 3.4.8 For the derivative process in GLM of a cohesive generator A\ngiven in H\u00f6rmander form without a drift, the zero order operator induced by the\nvertical diffusion on the exterior bundles \u2227T M is the generalized Weitzenb\u00f6ck\ncurvature given by:\nX\n1\n\u2212 d \u2227q (Ric# )(V ) \u2212\nRikjl a\u2217l a\u2217j ak ai V\n2\n16i6k6n\n\n(3.24)\n\n16j<l6p\n\nfor all V \u2208 \u2227q T M. Here Rikjl = hR(ei , ek )el , ej i , 1 6 i, k 6 n, 1 6 j, l 6 p for\nR the curvature tensor of the associated connection.\n\n\f3.4. ASSOCIATED VECTOR BUNDLES & GENERALISED WEITZENB\u00d6CK FORMULAE 55\nProof. By Theorem 3.3.1,\n\u0001\n\u0001\n1 X \u22121\nu \u2207u(\u2212) X p \u2297 u\u22121 \u2207u(\u2212) X p ,\n\u03b1(u) =\n2\n\nu \u2208 GLM.\n\nBy Corollary C.5 in [27] the restriction of \u03b1 to anti-symmetric tensors is 12 R.\nBy the relation between the curvature tensor and the curvature oeprator:\nhR(u \u2227 v), w \u2227 zi = hR(u, v)z, wi,\nthe first term in \u03bb\u03c1 (u) of Lemma 3.4.5 is:\n\u22122\n\nN\nX\n\ni<k,j<l\n\nhR(u)(ej \u2227 el ), ei \u2227 ek i a\u2217i a\u2217k aj al = \u22122\n\nN\nX\n\nRjlki a\u2217i a\u2217k aj al .\n\ni<k,j<l\n\nBy (ii) of Remark 3.4.7, the second term is\n1 q\nd\u2227\n2\n\nm\nX\np=1\n\n!\n\nu\u22121 \u2207\u2207u(\u2212) X p X p .\n\nThe required result follows since\n\u0011 1\n\u0001\n1 X \u22121 \u0010\n\u2207\u2207u(\u2212) X p X p \u2212 u\u22121 Ric# u(\u2212) .\nu\n\u03b2(u) = \u2212\n2 p=1\n2\nm\n\nCorollary 3.4.8 reflects the results in [27], Theorem 2.4.2, concerning Weitzenb\u00f6ck\nformula for H\u00f6rmander form operators on differential forms. In particular it gives\n \u0306 is the Levi-Civita connection, as holds\nanother approach to the result that when \u2207\nfor gradient stochastic differential equations, the generator induced on differential\nforms by the derivative process is the Hodge-Kodaira Laplacian up to a first order\nterm.\nNote that if B is the operator on GLM determined by the H\u00f6rmander form\n(3.5) of A then for a representation \u03c1 : GL(M) \u2192 L(V ; V ) with associated\n\u03c0 \u03c1 : GL(n) \u2192 L(V ; V ) the induced\noperator F \u03c1 (B) on sections of \u03c0 \u03c1 is also\nP\ngiven by the 'H\u00f6rmander form' 21 j LX j LX j + LA , where for any C 1 vector\nfield Y on M and any C 1 section U of \u03c0 \u03c1 the Lie derivative LY U \u2208 \u0393F is given\nby\n\u0011\u22121 \u0010\n\u0011\nd\u0010 Y\n(LY U)(x) = \u016b\nT\u03b7t \u25e6 u\nU \u03b7tY (x)\ndt\nt=0\n\n\f56 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nfor x \u2208 M, u a frame at x, and (\u03b7tY ) the flow of Y , using the notation of (3.13).\nIndeed by (3.13), for Z(u) = \u016bU(\u03c0(u)), so U = F \u03c1 (Z),\nh\u0010 1 X\n\u0011\ni\nF \u03c1 (B)(U) = F \u03c1\nL(X j )GL L(X j )GL + LAGL (Z)\n2 j\nwhile L(X j )GL (Z)(u) =\n\nj\nd\nZ(T \u03b7tX\ndt\n\n\u25e6 u)\n\nt=0\n\nso that\n\nh\ni\nd\nj\nF \u03c1 L(X j )GL (Z) (x) = \u016b Z(T \u03b7tX \u25e6 u)\ndt\n\nt=0\n\n= LX j (U)(x).\n\nThis representation of F \u03c1 (B) was noted in the case of the operator induced on\ndifferential forms by a stochastic flow indexflow!on differential forms in [27], and\nfor the case of the Hodge-Kodaira Laplacian in Elworthy [23].\nExample 3.4.9 Let P be the orthonormal frame bundle for a Riemannian metric\non M. Let C : Rn \u2192 Rn be a symmetric map, define\nX\n\u03b1=\ntracehC(Ai \u2212), Aj \u2212iAi \u2297 Aj ,\ni,j\n\nwhere {Ai =\n\n\u221a\n\n2ei \u2227 ej } is an orthonormal basis of so(n). Then\n1\n1\nComp \u25e6\u03b1 = \u2212 (trace C)id + (2 \u2212 n)C.\n4\n4\n\nLet Ric# : T M \u2192 T M be the Ricci curvature (for the Levi-Civita connection,\n\u22121\nsay). When applied to C(u) = u Ric#\n\u03c0(u) (u \u2212) for u \u2208 P with Ric positive, we\nsee it defines a vertical operator on the orthonormal frame bundle with coefficients\n\u03b1 as given above, \u03b2 = 0. Its associated zero order term on vertical fields is then\n1\n1\n(2 \u2212 n) Ric#\n\u03c0(u) \u2212 4 k, where k is the scalar curvature.\n4\nProof. First observe that\n\u0001 X\n1\nd \u22972 C\nAi \u2297 Ai\n\u03b1=\n2\ni\n\n!\n\n.\n\nThen we use the elementary fact about elementary matrices {Eij }:\nEij CEi\u2032 j \u2032 = Cji\u2032 Eij \u2032\n\u221a\nand take the basis of g to be { 2ei \u2227ej , i < j}. Recall that ei \u2227ej = 1/2(Eij \u2212Eji ).\n\n\f3.4. ASSOCIATED VECTOR BUNDLES & GENERALISED WEITZENB\u00d6CK FORMULAE 57\nRemark 3.4.10 We have seen in Corollary 3.4.8 that there is zero order operator\non the associated bundle \u2227F \u2192 M represented by the Weitzenb\u00f6ck curvature of\na given connection. On the other hand given a curvature operator R of a metric\nconnection, or more generally an operator which has the same symmetry properties as a curvature tensor, is there a canonical vertical diffusion operator on GLM\nwhich induces zero order operators on differential forms which have the form of\nthe Weitzenb\u00f6ck curvatures of R? A vertical operator with such a zero order term\nalways exist since we can take R in a diagonal form:\nR(u) =\n\nN\nX\nn=1\n\nAn (u) \u2227 An (u),\n\n(3.25)\n\nfor some An : GLM \u2192 gl(n) which are ad(G)-invariant, e.g. by taking an\nisometric embedding (e.g. see [27]. In this case let (ej ) be a basis of E\u03c0(u) define\nP\n\u03b1(u) = 12 N\nn=1 An (u) \u2297 An (u),P\nP\np\n1\n2\nj j\n\u03b2(u) = \u2212 21 N\nn=1 (An (u)) \u2212 2\nj=1 R(\u2212, e )e ,\n\n(3.26)\n\nsee Remark 3.4.7(b). Then \u03b1 is positive and we can define an operator with its\ncoefficients \u03b1 and \u03b2 given as above.\nFor a discussion of the representation of R in the form of (3.25) see KobayashiNomizu [41] (Notes 17 and 18). In particular there is a discussion there of the\nnumber N required and of a rigidity theorem originating from Chern, See also\nBerger-Bryant-Griffiths [8].\nWhen M is Riemannian with positive semi-definite curvature operator R :\n2\n\u2227 T M \u2192 \u22272 T M there is a canonical construction. For this take the orthonormal\nframe bundle \u03c0 : OM \u2192 M, with G = O(n). We will use the isomorphism\nof \u22272 Rn with so(n) under which ep \u2227 eq corresponds to 21 (E[p,q] \u2212 E[q,p] ) for\ne1 , . . . , en a fixed basis of Rn and E[p,q] the elementary matrix so E[p,q](v) = vq ep .\nSet A[p,q] = \u221a12 [E[p,q] \u2212 E[q,p]] so {A[p,q] : 1 6 p < q 6 n} forms an orthonormal\nbasis for so(n). Define\n\u03b1 : OM \u2192 so(n) \u00d7 so(n)\nby\n\u03b1(u) =\n\nX\n\n16p6q6n,16p\u2032 6q \u2032 6n\n\nD\n\nR(\u22272 (u)(ep \u2227eq )), \u22272 (u)(ep\u2032 \u2227eq\u2032 ))\n\nE\n\n\u03c0(u)\n\nA[p,q]\u2297A[p\u2032 ,q\u2032 ] .\n\n\f58 CHAPTER 3. EQUIVARIANT DIFFUSIONS ON PRINCIPAL BUNDLES\nOur representation \u03c1 is just the identity map and, by (3.19) and Bianchi's identity,\nthe restriction of \u03b1(u) : Rn \u2297 Rn \u2192 Rn \u2297 Rn to \u22272 Rn is just R itself. In the\nnotation of (3.23) we see\nhZ \u03c1 (v 1 ), v 2 i = \u22124 Ric(v 1 , v 2 ).\nIf we take \u03b2 = 0, we obtain from (3.23) that\nX\n\u03c1\nRjlik a\u2217i a\u2217k aj al \u2212 2 (d\u2227)Ric# .\n\u03bb\u2227 (u) = \u2212\ni<k,j<l\n\nTo get the full Weitzenb\u00f6ck term, extend \u03b1 over GLM by equivariance and define\n\u03b2(u), for u \u2208 GLM, by \u03b2(u) = 32 u\u22121 Ric# (u\u2212) as in (3.26).\n\n\fChapter 4\nProjectible Diffusion Processes\nLet M + be the Alexandrov one point compactification of a smooth manifold M.\nConsider the space Cy0 M + of processes (yt ) with life time \u03b6 on N + such that\nt \u2192 yt is continuous with yt = \u2206 when t > \u03b6. Let L be a diffusion operator on\nM and let {Py0 , y0 \u2208 M + } be the family of L-diffusion measures in the sense\nof [39], i.e. the solution to the martingale problem on C(M + ) so the canonical\nprocess (yt , 0 6 t < \u03b6) with the system of diffusion measures {PLy0 , y0 \u2208 N + }\nis a strong Markov process on M + . Denote by E mathematical expectation with\nrespect to the measure Py0 . We may add to these notations the relevant subscripts\nor superscripts indicating the diffusion operator or the Markov process concerned,\ne.g. {PLy0 }, \u03b6 L, EL,y0 or even Ey0 .\nFor y0 \u2208 M and f \u2208 Cc\u221e M, the space of smooth functions on M with compact\nsupport, let\nMtdf\n\n:=\n\nMtdf,L\n\n:= f (yt\u2227\u03b6 ) \u2212 f (y0 ) \u2212\n\nZ\n\n0\n\nt\u2227\u03b6\n\nLf (ys )ds\n\n(4.1)\n\nThen (Mtdf : 0 6 t < \u221e) is a martingale on the probability space (C(M), PLy0 )\nwith respect to the {Fty0 }, where Fty0 = \u03c3{ys ; 0 6 s 6 t}. Moreover it has\nbracket\nZ t\u2227\u03b6\ndf\nhM it = 2\n\u03c3 L ((df )ys , (df )ys )ds.\n0\n\nThis definition extends to the case of C 2 functions f but then Mtdf is only defined\nfor 0 6 t < \u03b6 L and is a local martingale.\n59\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n60\n\n4.1 Integration of predictable processes\nProposition 4.1.1 Let \u03c4 be a stopping time with \u03c4 < \u03b6 and let {\u03b1t : 0 6 t < \u03c4 }\nbe a F\u2217y0 predictable process in T \u2217 M such that \u03b1t \u2208 Ty\u2217t M for each t \u2208 [0, \u03c4 ), and\nfor each compact subset of M we have\nZ \u03c4\n\u03c7K (ys )\u03b1s (\u03c3 L \u03b1s ) ds < \u221e\n0\n\nalmost surely.\nThen there is a unique local martingale {Mt\u03b1 : 0 \u2264 t < \u03c4 } such that for all\nf \u2208 Cc\u221e M,\n\u03b1\n\nM ,M\n\ndf\nt\n\n=2\n\nZ\n\nt\n\n\u03c3 L (\u03b1s , (df )ys ) ds,\n\nt < \u03b6.\n\n(4.2)\n\n0\n\nProof. We can write\n\u03b1t =\n\nm\nX\nj=1\n\ngtj * dfj (yt ),\n\n(4.3)\n\nwhere the functions g j are predictable real valued processes, e.g. P\nby taking (f1 , . . . , fm ) :\nj\ni\nm\nj\nM \u2192 R to be an embedding and gt = \u03b1t \u25e6 X , for X(x) = m\ni=1 X (x)ei the\nm\nprojection from R to Tx M. Using a partition of unity, at the cost of having an\ninfinite, but locally finite sum, we can assume that the fj in the representation are\nall in Cc\u221e M. Define\nXZ t\n\u03b1\nMt :=\ngsj dMsdfj .\n(4.4)\nj\n\n0\n\nClearly (4.2) holds. For uniqueness suppose K is a local martingale orthogonal to\nM df for all f \u2208 Cc\u221e M.\nThen K vanishes since the martingale problem for L is well posed by an argument attributed to Dellach\u00e9rie (see Rogers-Williams [63], the end of the proof of\ntheorem 2.5.1). In fact it it were not zero we could take a suitable stopping time \u03c4\nto ensure (1 + K\u03c40\u2227t )PLx0 solves the martingale problem up to time t since\nK\u03c40\u2227t Msdf\n\n\u2261\n\nK\u03c40\u2227t\n\n\u0012\n\u0013\nZ s\nf (xs ) \u2212 f (x0 ) \u2212\nLf (xs )ds ,\n\nis a uniformly integrable martingale.\n\n0\n\n06s6t\n\n\f4.1. INTEGRATION OF PREDICTABLE PROCESSES\nWe will often write\nMt\u03b1\n\n=\n\nZ\n\n61\n\nt\n\n\u03b1s d{ys }\n\n0\n\n(4.5)\n\nRt\nbringing out the fact it is the martingale part of the Stratonovitch integral 0 \u03b1s \u25e6\ndys of (\u03b1t ) along the diffusion process (yt ) when that integral is defined e.g. when\n(\u03b1t ) is a continuous semi-martingale. Indeed\nLemma 4.1.2 Let \u03b1 be a C 2 1-form then\nZ t\nZ t\n\u0001\n\u03b1\nMt =\n\u03b1ys \u25e6 dys \u2212\n\u03b4 L \u03b1 (ys )ds,\n0\n\n0 6 t < \u03b6.\n\n(4.6)\n\n0\n\nProof. This is clear for an exact 1-form. Suppose \u03bb : M \u2192 R is C 2 and \u03b1 is\nexact, then for t < \u03b6,\n\u001cZ *\n\u001d\nZ t\nZ t\n1\n\u03b1\n\u03bb\u03b1\n\u03b1\n\u03b1\nd\u03bb(ys )dys , M*\nMt\n=\n\u03bb(ys )dMs =\n\u03bb(ys ) \u25e6 dMs \u2212\n2\n0\n0\n0\nt\nZ t\nZ t\n\u0001\n1\n=\n\u03bb(ys ) \u03b1ys \u25e6 dys \u2212\n\u03bb(ys ) \u03b4 L \u03b1 (ys )ds \u2212 hM*d\u03bb , M*\u03b1 it\n2\nZ0 t\nZ0 t\n=\n\u03bb(ys ) \u03b1ys \u25e6 dys \u2212\n\u03b4 L (\u03bb\u03b1)(ys)ds\n0\n\n0\n\nsince M d\u03bb is the martingale part of \u03bb(ys ) and\nd\u03bb\n\n\u03b1\n\nhM , M it = 2\n\nZ\n\nt\n\n\u03c3 L (d\u03bbs , \u03b1s )ds.\n\n0\n\nThis proves the result for general \u03b1 by taking a suitable representation.\nLet Sx be the image of \u03c3xL in Tx M and let S := \u222ax Sx . By a predictable S \u2217 valued process (\u03b1t ) over (yt : 0 6 t < \u03b6) we mean a process (\u03b1t : 0 6 t) such\nthat\n(i) \u03b1t \u2208 Sy\u2217t for all 0 6 t < \u03b6\n(ii) (\u03b1t \u25e6 \u03c3yLt , 0 6 t < \u03b6) is a predictable process in T M, canonically identified\nwith T \u2217\u2217 M.\nNote that condition (ii) is equivalent to\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n62\n\n(ii)' there exists a predictable (\u1fb1t ) in T \u2217 M over (yt ) such that \u1fb1t |Syt = \u03b1t for all\n0 6 t < \u03b6.\nThat (ii') implies (ii) is immediate. To see (ii) implies (ii') first note that \u03b1t \u25e6 \u03c3yLt \u2208\nSyt for each t since \u03b1t \u25e6 \u03c3yLt = \u03c3yLt (\u03b1\u0303t ) for any extension \u03b1\u0303t of \u03b1t to Ty\u2217t M. We\ncan then choose a measurable selection \u1fb1t in Ty\u2217t M with \u03c3yLt (\u1fb1t ) = \u03b1t \u25e6 \u03c3yLt . This\nprocess \u1fb1t will satisfy the requirements of (ii') since\n\u1fb1t \u03c3yLt = \u03c3yLt \u1fb1t = \u03b1t \u03c3yLt .\n\n(4.7)\n\nIn fact (4.7) is a reflection of the fact that \u03c3yL extends to a linear isomorphism\n\u03c3yL : Sy\u2217 \u2192 Sy canonically. In particular \u03c3yLt (\u03b1t ) is well defined.\nDefinition 4.1.3 If (\u03b1t ) satisfies (i) and (ii) we will say it is in L2L if\nZ t\n\u03b1s \u03c3yLs (\u03b1s )ds < \u221e\n0\n\nfor all t > 0, and will say it is in L2L,loc if for any compact subset K of M\nZ t\u2227\u03b6\nE\n\u03c7K (ys )\u03b1s (\u03c3 L \u03b1s ) ds < \u221e\n0\n\nfor all t > 0.\nRemark 4.1.4 Suppose the processes associated to diffusion operators L and L +\nLb are both non-explosive, where b is a locally bounded measurable vector field on\nM. Assume that there exists a T \u2217 M- valued process b#\n. defined on the canonical\nL\nprobabilty space Cy0 M such that P -almost surely:\n1. 2\u03c3 L (b#\ns ) = b(ys )\nRt\nL #\n2. 0 b#\ns \u03c3 (bs )ds < \u221e\n\nThen, by the GMCM-theorem, as in the Appendix section 9.1, we have on C([0, T ]; M),\nPL+Lb = Zt PL\nRt\n#\nL #\nwhere Zt = exp{Mtb \u2212 0 b#\ns \u03c3 (bs )ds}. In an obvious notation, for suitable \u03b1,\nas canonical processes we have, almost surely,\nZ t\nZ t\nZ t\nL\nL+Lb\n\u03b1s d{ys } =\n\u03b1s d{ys}\n\u2212\n\u03b1(b(us ))ds.\n0\n\n0\n\n0\n\n\f4.1. INTEGRATION OF PREDICTABLE PROCESSES\n\n63\n\nLemma 4.1.5 Suppose \u03c3 L has image in a subset S of T M. Then (Mt\u03b1 ) depends\nonly on the restriction of \u03b1s in L(Tys M; R) to Sys , 0 6 s < \u03b6. In particular (4.2)\ndefines uniquely a local martingale for each predictable S \u2217 -valued process (\u03b1t )\nover (yt )for which the right hand side of (4.2) is always finite almost surely.\nProof. For T \u2217 M-valued F\u2217y0 predictable processes (\u03b1t1 , 0 6 t < \u03b6) and (\u03b1t2 , 0 6\nt < \u03b6) over (yt , 0 6 t < \u03b6) which agree on S we see\nZ t\u2227\u03b6\n\u03b11\n\u03b12\ndf\nhM \u2212 M , M it = 2\n\u03c3(\u03b1s1 \u2212 \u03b1s2 , (df )ys ) ds = 0\n0\n\n\u03b11\n\n2\n\nfor all f \u2208 Cc\u221e M. Therefore M = M \u03b1 . On the other hand this also shows\nthat if \u03b1s \u2208 Sy\u2217s for all s, we can use condition (ii)' above to choose a predictable\nprocess {\u1fb1s : 0 6 s < \u03b6} with values in T \u2217 M over (yt ) and set M*\u03b1 = M*\u1fb1\nwithout ambiguity.\nExample 4.1.6 Canonical Brownian motion associated to a cohesive diffusion.\nFor simplicity assume that our L-diffusion from a given point y0 is non-explosive.\nIf L is cohesive with sub-bundle E of TM, take a metric connection \u0393 for E, using\nthe metric determined by 2\u03c3 L . Let\n\u03b1s (\u03c3) := (//\u03c3s )\u22121 : E\u03c3(s) \u2192 Ey0\nbe the inverse of parallel translation, //\u03c3s , along \u03c3 from E\u03c3(0) to E\u03c3(s) , for Py0\nalmost all paths \u03c3 in M. Each component of this with respect to an orthonormal\nbasis for Ey0 clearly lies in L2L . With the obvious extension of our notation to the\nvector space valued case define an Ey0 -valued process Bt : t > 0 by\nZ t\n\u03b1\nBt = Mt =\n(//)\u22121 d{ys }.\n0\n\nIt is easy to check from its quadratic variation that it is a Brownian motion on the\ninner product space Ey0 . Moreover (as described in [27]) it has the same filtration\nas the canonical process on Cy0 M up to sets of measure zero. It is the martingale\nRt\npart of the stochastic anti-development 0 (//s )\u22121 dys of our L-diffusion from y0 .\nThe use of a different metric connection would change it by\b a random rotation, so\nthis process is defined on the canonical probability space Cy0 M, F y0 , Py0 and\nup to such rotations depends only on it. We have, for \u03b1 as usual:\nZ t\nZ t\n\u03b1s d{ys } =\n(\u03b1s \u25e6 //s ) dBs .\n(4.8)\n0\n\n0\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n64\n\nUsing the definitions in the Appendix 9.3 we see that if our diffusion process y. is\na \u0393-martingale then\nZ t\nZ\n\u0001 t\n\u03b1s d{ys } = \u0393\n\u03b1s dys .\n(4.9)\n0\n\n0\n\nNote that there is always some metric connection \u0393 on E for which a cohesive\ndiffusion process is a \u0393-martingale, by section 2.1 of [27].\n\n4.2 Horizontality and filtrations\nWe can characterise horizontality of a diffusion operator or process in terms of\nfiltrations using the following lemma:\nLemma 4.2.1 Suppose p : N \u2192 M is a smooth map, B a smooth diffusion\noperator over a smooth diffusion operator A, and also\n(i) \u03c3 A and \u03c3 B have constant rank and\n(ii) the filtration generated by u* and p(u* ) agree up to sets of PBu0 -measure zero\nfor some u0 \u2208 N.\nA\n, all u \u2208 N.\nThen rank \u03c3uB = rank \u03c3p(u)\n\nProof. Set p = rank \u03c3xA and p\u0303 = rank \u03c3uB . By assumption p and p\u0303 do not depend\non x \u2208 M and u \u2208 N. Take connections on Image \u03c3 B and Image \u03c3 A which are\nmetric for the metrics induced by the symbols. Extend these connections to T N\nand T M. The martingale part of the stochastic anti-development of (u* ) will be a\nBrownian motion stopped at \u03b6 B of dimension p\u0303 and that of (p(u* )) will be one of\ndimension p. By (ii) these have the same filtration up to sets of measure zero. But\nthis implies p = p\u0303 by the martingale representation theorem, as required.\nProposition 4.2.2 The following are equivalent for B over A when A is cohesive:\n(a) B = AH\n\n(b) B is cohesive and the filtration generated by its associated diffusion (u* )\nagrees with that of p(u* ) up to sets of PBu0 -measure zero for given u0 in N.\nProof. If (b) holds, Lemma 4.2.1 shows that Image[\u03c3uB ] = Hu for each u \u2208 N,\nsince by (2.4) we always have Hu \u2282 Image[\u03c3uB ]. Thus (b) implies criterion (ii) of\nProposition 2.3.2. Also (b) follows from (iii) of Proposition 2.3.2 by considering\nthe stochastic differential equation driven by horizontal lifts X\u0303 0 , . . . , X\u0303 m .\n\n\f4.3. THE FILTERING EQUATION\n\n65\n\n4.3 The Filtering Equation\nLet p : N \u2192 M be a smooth surjective map. Suppose that B is over A. However\nwe do not assume \u03c3 A of constant rank. Let {PBu0 } and {PA\nx0 } be, respectively, the\nsolutions to the martingale problem for B and A on the canonical spaces C(M + )\nand C(N + ). Denote by (ut ) and (xt ) the corresponding canonical processes with\nlife time \u03b6 N and \u03b6 M respectively. Note that \u03b6 B 6 \u03b6 A \u25e6 p almost surely with respect\nto PBu0 . We shall assume that the paths of the diffusion on N do not explode before\ntheir projections on M do, more precisely \u03b6 M \u25e6 p = \u03b6 N almost surely with respect\nto PBu0 for each u0 , equivalently,\n\u2022 Assumption S.\n\nCup0 M + := {\u03c3 : [0, \u221e) \u2192 M + : lim p(ut ) = \u2206 when \u03b6 B < \u221e}\nt\u2192\u03b6 B\n\nhas full PBu0 measure for each u0 \u2208 N.\n\nDenote by the following the filtrations induced by the processes indicated:\nFtu0 = \u03c3(us , 0 6 s 6 t),\nFtx0 = \u03c3(xs , 0 6 s 6 t),\n\np(u0 )\n\nFt\n\n= \u03c3(p(us ), 0 6 s 6 t),\n\nF u0 = \u03c3(ys , 0 6 s < \u221e)\nF x0 = \u03c3(xs , 0 6 s < \u221e)\n\nF x0 = \u03c3(p(us ), 0 6 s < \u221e).\n\nB\nProposition 4.3.1 Under Assumption S, p\u2217 (PBu0 ) = PA\np(u0 ) and Pt (f \u25e6 p) =\nPtA (f \u25e6 p) for all f \u2208 Cc\u221e (M).\n\n\u221e\nProof. If p(u0 ) = x0 , f \u2208 CK\n(M), we only need to show that Mtdf,A is a martingale with respect to p\u2217 (PBu0 ). Using Assumption S,\nZ t\ndf,A\nMt (p(u)) = f (p(ut)) \u2212 f (p(u0 )) \u2212\nAf \u25e6 p(us ))ds\n0\nZ t\n= f (p(ut)) \u2212 f (p(u0 )) \u2212\n(B(f \u25e6 p)) (us )ds\n0\n\n=\n\nd(f \u25e6p),B\nMt\n\nis a martingale with respect to (Ftu0 ) and PBu0 . Take s 6 t and let G be a Fsx0 measurable function. Then\nn\no\nn\no\ndf,A\ndf,A\np\u2217 (PB\nPB\nu0 )\nu0\nMt (p(u* ))G(p(u* ))\nE\nMt G = E\nn\no\nB \b\nB\nd(f \u25e6p),B\nG \u25e6 p = EPu0 Msd(f \u25e6p),B G \u25e6 p)\n= EPu0 Mt\n\b\nB\n= Ep\u2217 (Pu0 ) Msdf,A G\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n66\n\nand the result follows from the uniqueness of the martingale problem.\nWe will need the following elementary lemma:\nLemma 4.3.2 Let (\u03a9, F , Ft, P} be a filtered probability space and G\u2217 a subfiltration of F\u2217 with the property that for all s > 0,\nE{A|Gs } = E{E{A|Fs}|G},\n\n\u2200A \u2208 F ,\n\n(4.10)\n\nwhere G = \u2228s Gs . Then\n(i) (E{Mt |G}, t > 0) is a G\u2217 -martingale whenever (Mt : t > 0) is an F\u2217 martingale;\n(ii) For all G-measurable and integrable H\n\b\nE H|Fs } = E{H|Gs };\n\n\b\n\b\n(iii) E E{A|Fs}|G = E E{A|G}|Fs ,\n\n\u2200A \u2208 F .\n\nProof. For (i) set Nt = E{Mt |G}, 0 6 t < \u221e. By (4.10), (Nt ) is Gt measurable. For s 6 t suppose that f is Gs -measurable and bounded. Then E(Nt f ) =\nE(Mt f ) = E(Ms f ) = E(Ns f ). For (ii), let H and F be bounded measurable\nfunctions with G-measurable and Fs -measurable representations. Then\n\b\n\b\n\b\n\b\n\b\n\b\n\b\nE H|F = E H|E F |G = E H|E F |Gs = E H|E F |G\n\b\nusing (4.10). Thus\b E H|Fs} = E{H|Gs } as required. Part (iii) follows from (ii)\non taking H = E E{A|G} and using equation (4.3.2).\np(u0 )\n\nPart (ii) of the following proposition says that the filtration F\u2217\nthe filtration F\u2217u0 in the terminology of Tsirelson [71].\n\nis immersed in\n\nProposition 4.3.3 (i) For fixed t > 0 let f be a bounded Ftu0 -measurable function. Then\no\nn\n\b\np(u )\nE f |F p(u0) = E f |Ft 0 .\np(u )\n\n(ii) All F\u2217 0 martingales are F\u2217u0 martingales. In fact if f = G \u25e6 p for G an\nintegrable functional on C(M + ) with respect to PA , we have\np(u0 )\n\nEu0 {f |Ft\n\n} = Eu0 {f |Ftu0 }.\n\n\f4.3. THE FILTERING EQUATION\n\n67\n\nProof. (i) Write f = F (us : 0 6 s 6 t) for F a bounded measurable function\non C(N + ). Let G be bounded measurable functions of {p(us ) : 0 6 s 6 t} and\ng 1 , . . . , g k bounded Borel functions on M, with h1 , . . . , hk positive real numbers.\nBy the Markov property of u* and of p(u* ),\n\u0001\nE F (us : 0 6 s 6 t) G g 1 \u25e6 p(ut+h1 ) * * * * * g k \u25e6 p(ut+h1 +***+hk )\n\u0001\n\u0001\n=\nE F (us : 0 6 s 6 t)G PhA1 g 1 PhA2 (g 2 . . . PhAk g k ) (p(ut )) .\nTherefore,\n\no\nn\n\b\np(u)\nE F (us : 0 6 s 6 t)|F p(u) = E F (us : 0 6 s 6 t)|Ft\n\nas required.\nPart (ii) is immediate from (i) by Lemma 4.3.2.\n\nAs in \u00a72.1 set Ex = Image \u03c3xA with hu : Ep(u) \u2192 Tu N the horizontal lift\ndefined by (2.4), although now we have no constant rank assumption and so no\nsmoothness of h. Also let EuB = Image \u03c3uB . For an F\u2217x0 -predictable E \u2217 -valued\nprocess \u03c6t := \u03c6t (\u03c3* ), 0 6 t < \u03b6 A along (\u03c3t : 0 6 t < \u03b6 A ) let (p\u2217 (\u03c6t ) :\n0 6 t < \u03b6 B ) be the pull back restricted to be an (E B )\u2217 -valued process along\n(ut : 0 6 t < \u03b6 B ) defined by\np\u2217 (\u03c6t )(u* ) = \u03c6t (p(u)) \u25e6 Tut p : E B ut \u2192 R.\nSince \u03c6t has a predictable extension \u03c6\u0304t so does p\u2217 (\u03c6t ) and so the latter is predictable. Moreover p\u2217 (\u03c6t )\u03c3 B (p\u2217 \u03c6t ) = \u03c6t \u03c3 A (\u03c6t ) by Lemma 2.1.1 showing \u03c6* is in\nL2A if and only if p\u2217 (\u03c6* ) is in L2B . For such \u03c6 we have the following intertwining:\nProposition 4.3.4 Let \u03c6 be a predictable L2A -valued process.\n\nB,p\u2217 (\u03c6)\n\n(1) For PBu0 almost surely all sample paths, MtA,\u03c6 \u25e6 p = Mt\n\nfor t < \u03b6 B .\n\n(2) If \u03b1 \u2208 L2B with \u03b1t \u25e6 ht = 0 almost surely, then hMt\u03b1 , Mtdf \u25e6T p i = 0 and\nEB,u0 {Mt\u03b1 |F p(u0) } = 0 for all C 1 functions f on M .\nProof. For \u03c6 = df , (1) follows from p\u2217 (df )u = d(f \u25e6 p)u as in the proof of\nProposition\nFor general \u03c6, taking a predictable extension if necessary, write\nP4.3.1.\nm i\n\u03c6t (x) = 1 gt (x* )(df j )xt for smooth functions f j : M \u2192 R and real valued\npredictable {gtj : 0 6 t < \u03b6 A}. Therefore\nm Z t\nX\nB,p\u2217 (df j )\nB,p\u2217 (\u03c6)\nA,\u03c6\nMt \u25e6 p =\ngsj (p(u* )) dMt\n= Mt\nj=1\n\n0\n\n\f68\n\nCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\nfor all t < \u03b6 B , giving (1). For (2) let F : N \u2192 R be a smooth measurable\nfunction with respect to F p(u0 ) . Then F = f (p(u* )) for some measurable function\nf : M \u2192 R.\nZ\n1 B,u0\n1 B,u0 t B\ndf \u25e6T p\nB,u0\n\u03b1\n\u03b1\nE\n(Mt f (p(u* ))) =\n\u03c3 (\u03b1s , df \u25e6 T p(us ))ds.\nE hMt , Mt\ni= E\n2\n2\n0\nIf \u03b1t hut = 0 almost surely for all t, we apply (2.4) to see\n\u0010\n\u0011\nA\ndf = 0\n\u03c3 B (\u03b1s , df \u25e6 T p(us )) = \u03b1s \u03c3uBs T \u2217 p(df ) = \u03b1s hus \u03c3p(u\ns)\nand thus EB,u0 (Mt\u03b1 f (p(u* ))) = 0 giving (2).\n\nFor \u03b1 \u2208 L2B define \u03b2s \u2261 EB,u0 {\u03b1s \u25e6 hus |p(u* ) = x* }, 0 6 s < \u03b6 to be the\nunique, up to equivalence, element of L2A such that\n\u0010\n\u0011\n\u0011\n\u0010\n(4.11)\nEB,u0 \u03b1a \u25e6 hus \u03c3 A (\u03c6s (p(u* ))) = EA,p(u0 ) \u03b2s \u03c3 A (\u03c6s ) .\n\nfor any \u03c6 \u2208 L2A . To see such an element exists and is unique recall that\nA\n= \u03b1s \u03c3uBs (tus p)\u2217\n\u03b1s \u25e6 hus \u03c3p(u\ns)\n\nwhich is an F\u2217u0 -predictable process with values in Ep(us ) \u2282 Tp(us ) M at each time\ns, and by Proposition 4.3.3, (4.11) is equivalent to\no\nn\n\u2217\np(u0 )\nA\nB,u0\nB\np)\n|F\n(4.12)\n(T\n\u03b2s (p(u* ))\u03c3p(u\n=\nE\n\u03b1\n\u03c3\nu\ns\ns\nus\ns)\n\nin the sense of Elworthy-LeJan-Li [27]. The predictable projection theorem and\nthe results of [27] shows that there is a unique, up to indistinguishability, F p(u* ) predictable T M versiob {\u03b3t : 0 6 t < \u03b6} say, over {p(ut ) : 0 6 t < \u03b6}, of\nthe right hand side of (4.12). By applying the uniqueness part of this projection\np(u )\ntheorem to {\u03c6s (\u03b3s ) : 0 6 s < \u03b6} when \u03c6* is F\u2217 * -predictable, T \u2217 M-valued\nover p(u* ) and \u03c6t vanishes on Ep(ut ) for all 0 6 t < \u03c1 with probability 1, we see\nA\n\u03b3t \u2208 Ep(uu ) for all 0 6 t < \u03b6 almost surely. Now set \u03b2s (p(u* )) = [\u03c3p(u\n]\u22121 \u03b3s in\ns)\n\u2217\nEp(us ) .\nProposition 4.3.5 For any \u03b1* in L2B we have\nZ T\nB,u0\n\u03b1\nE\n{Mt | p(u* ) = x* } =\nEB,u0 {\u03b1s \u25e6 hus | p(u* ) = x* } d{xs }.\n0\n\n\f4.4. A FAMILY OF MARKOVIAN KERNELS\n\n69\n\nProof. Set Nt = E{Mt\u03b1 | F p(u0) } and write Nt (u) = N\u0304t (p(u)) for {N\u0304t } a Ftx0 p(u )\nmeasurable function. By Proposition 4.3.3, (Nt ) is an F\u2217 * -martingale and we\nsee (N\u0304t ) is an F\u2217x martingale. Take g \u2208 Cc\u221e M then by Proposition 4.3.4,\no\nn\np(u )\nhN\u0304, M A,dg it \u25e6 p(u) = EB,u0 hM \u03b1 , M d(g\u25e6p) it |Ft 0 (u)\no\nn\np(u )\n= EB,u0 \u03c3uBt (\u03b1t , (Tut p)\u2217 (dg)) |Ft 0\no\nn\np(u0)\nA\n(dg)|F\n= EB,u0 \u03b1t \u25e6 hut \u03c3p(u\nt\nt)\n\nby equation (2.4). By Proposition 4.1.1 and the definition\n\b above of the conditional\nexpectation, N\u0304t (p(u* )) = M A,\u03b2 for \u03b2 \u25e6 p(u* ) = EB,u0 \u03b1t \u25e6 hut |F p(u0) and so\nZ t\nN\u0304t (x* ) =\nE {\u03b1s \u25e6 hus |p(u* ) = x* } d{xs }\n0\n\nas required.\n\n4.4 A family of Markovian kernels\nFor a probability measure \u03bc0 on N + let the measures \u03bct on N + be the flow of ut\nunder PB\u03bc0 and set \u03bdt = p\u2217 (\u03bct ) on M + . Let \u03b7\u03bc0 be the law of u* 7\u2192 (p(u* ), u0 ) on\nC(M + ) \u00d7 N + under PB\u03bc0 so\nZ\ny\nA \u2208 B(M + ), \u0393 \u2208 B(N + )\nPA\n\u03b7\u03bc0 (A, \u0393) =\ny (A) \u03c1\u03bc0 (\u0393) \u03bd(dy),\ny\u2208M +\n\nwhere \u03c1y\u03bc0 arises from a disintegration of \u03bc0\nZ\n\u03bc0 (\u0393) =\n\u03c1y\u03bc0 (\u0393) \u03bd(dy),\ny\u2208M +\n\n\u0393 \u2208 B(N + ).\n\nFor a measurable f : N + \u2192 R, integrable with respect to \u03bct set\n\u03c0t\u03bc0 ,\u03c3 f (v) = EB\u03bc0 {f (ut )|p(u0) = \u03c3, u0 = v}.\n\n(4.13)\n\nIt is defined for \u03b7\u03bc0 almost all (\u03c3, v) in C(M + ) \u00d7N + . In particular for PA\n\u03bd0 -almost\n\u03c3(0)\nall \u03c3 it is defined for \u03c1\u03bc0 -almost all v \u2208 N + . We could use the convention that\n\u03c0t\u03bc0 ,\u03c3 f (v) = 0\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n70\n\nif p(v) 6= \u03c3(0). With this convention, if we define \u03b8t \u03c3(s) = \u03c3(t + s) we see that\n\u03bct ,\u03b8t \u03c3\nfor PA\nf (y) is defined for \u03bct -almost all y in N + .\nv0 -almost all \u03c3 the map y 7\u2192 \u03c0t\nFurther for u0 \u2208 N and f : N + \u2192 R bounded measurable define\n\u03c0t f (u0 ) : Cp(u0 ) M + \u2192 R,\nPA\np(u0 ) -almost surely, by\nn\no\n\u03b4u ,\u03c3\n\u03c0t f (u0 )(\u03c3) = E f (ut )|p(u* ) = \u03c3 = \u03c0t 0 f (u0 ).\n\n(4.14)\n\nThis can be extended, as in [27], to the case of predictable process in vector bundles over N, and to define\n\u03c0t (\u03b1 \u25e6 hu* )(u0) : Cp(u0 ) M + \u2192 R\nas EB,u0 {\u03b1s hus |p(u* ) = x* }, defined above.\n\n4.5 The filtering equation\nTheorem 4.5.1 (1) If f is Cc2 N, or more generally if f is C 2 with Bf and\n\u03c3 B (df, df ) \u25e6 h bounded, then\n\u03c0t f (u0 ) = f (u0 ) +\n\nZ\n\nt\n\n\u03c0s (Bf )(u0 )ds +\n\n0\n\nZ\n\n0\n\nt\n\n\u03c0s (df \u25e6 hu* )(u0 )d{xs }. (4.15)\np(u0 )\n\nIn particular {\u03c0t f (u0 ) : t > 0} is a continuous F\u2217\n\nsemi-martingale.\n\n+\n(2) For bounded measurable f : M + \u2192 R and PA\nv0 almost all \u03c3 in C(M ), for\neach s, t > 0\n\u03bc0 ,\u03c3\nSt+s\nf (v) = \u03c0t\u03bc0 ,\u03c3 \u03c0s\u03b8t \u03c3, \u03bct f (v)\n(4.16)\n\u03c3(0)\n\nfor \u03c1\u03bc0 almost all v in N + .\n(3) Moreover there exists a family of probability measures Q\u03bc\u03bd 0 ,\u03c3 on C(N + )\ndefine for \u03b7u0 -almost surely all (\u03c3, v) such that if F : C(N + ) \u2192 R is of the\nform\nF (u* ) = f1 (ut1 ) . . . fn (utn )\n\n\f4.5. THE FILTERING EQUATION\n\n71\n\nsome 0 6 t1 < t2 < . . . tn and bounded measurable fj : N + \u2192 R,\nj = 1, 2, . . . , n then\nZ\n\u0011\n\u0010\n\u0010\n\u03bctn ,\u03b8tn\u22121 \u03c3\n\u03bc 1 ,\u03b8t1 \u03c3\nF (u)Q\u03bcv 0 ,\u03c3 (du) = St\u03bc10 ,\u03c3 f1 St2t\u2212t\nf\nf\n.\n.\n.\nS\nn (v)\n2\ntn \u2212tn\u22121\n1\nu\u2208C(N + )\n\n= EB\u03bc0 {F (u* )|p(u* ) = \u03c30 }\n\n\u03b7\u03bcs -almost surely in (\u03c3, v).\nProof. (1). By definition of M df we have\nZ t\nf (ut ) = f (u0 ) +\nBf (us )ds + Mtdf\n0\n\nso\n\n\u03c0t f (u0 ) = f (u0) +\n\nZ\n\n0\n\nt\n\nn\no\ndf,B\n\u03c0s Bf (u0 )ds + E Mt | p(u*) = x\n\n(4.17)\n\nand part (1) follows from Proposition 4.3.5.\n(2). We observed above that the right hand side of (4.16) is well defined for\nPA\n\u03bc0 almost all \u03c3. The equation then follows from the Markov property.\n(3). The existence of regular conditional probabilities in our situation implies\nthe existence of the probabilities Q\u03bc\u03bd 0 ,\u03c3 as required, together with a standard use\nof the Markov property.\nRemark 4.5.2 A description of the Q\u03bcv 0 ,\u03c3 is given in the next section, in the case\nwhere A is cohesive.\nRecall we have the decomposition Fu = Hu + V Tu N for each u \u2208 N, and\nF = \u2294Fu . If l \u2208 Fu\u2217 there is a corresponding decomposition\nl = lH + lV \u2208 Fu\u2217 ,\nwhere lH vanishes on V Tu N and lV on Hu . For l \u2208 Tu\u2217 N write lV = (l|Fu )V\nand lH = (l|Fu )H .\nCorollary 4.5.3 Suppose A is cohesive. If f is Cc3 N then there is the Stratonovitch\nequation\nZ t\nZ t\nV\n\u03c0t f (u0)(x* ) = f (u0) +\n\u03c0s (B f )(u0)ds +\n\u03c0s (dfu0 \u25e6 huo ) \u25e6 dxs .\n0\n\n0\n\n(4.18)\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n72\n\nProof. We use (4.17). By Proposition 4.3.5,\nH\n\nE{Mtdf | p(u* ) = x* } = E{Mtdf | p(u* ) = x* }.\nNote that\nH\nMtdf\n\n=\n\nZ\n\nt\nH\n\n0\n\n(df )us \u25e6 dus \u2212\n\nby Lemma 4.1.2. Furthermore\nV\n\nH\n\nZ\n\nt\n\n\u03b4 B (df H )(us )ds\n\n0\n\nH\n\nH\n\n\u03b4 B (df H ) = \u03b4 B (df H ) + \u03b4 A (df H ) = \u03b4 A (df H ) = \u03b4 A (df ) = AH (f )\nsince df H vanishes on vertical vectors and df = df H + df V while df V vanishes\nH\non horizontal vectors, so \u03b4 A (df V ) = 0. This gives\n\u001b\n\u001aZ t\nZ t\nV\nH\n\u03c0t f (u0)(x* ) = f (u0)+ \u03c0s (B f )(u0 )(x* )ds+E\n(df )us \u25e6 dus p(u* ) = x*\n0\n\n0\n\nFinally (4.18) follows since dfuH = p\u2217 (df \u25e6hu ) = df \u25e6hu \u25e6Tu p and Tu p\u25e6dut = \u25e6dxt .\n\n4.6 Approximations\nAssume now that the law of ut under PA\nu0 is given by\nZ\nA\nPt (u0 , A) =\nPtA (u0 , v)dv,\nA \u2208 B(M)\nA\n\nfor pA\nt (u0 , v) a smooth density with respect to some fixed, smooth, strictly positive\nmeasure on M to which 'dv' refers. This is the case if A is hypoelliptic.\nConsider the conditional probability\nqtu0 ,b (V ) = PBu0 {ut \u2208 V |p(ut ) = b},\n\nV \u2208 B(N)\n\ndefined for pA\nt (u0 , \u2212) almost sure all b in M. There is the disintegration of\npBt (u0 , \u2212)\nZ\nB\npt (u0 , V ) =\nqtu0 ,b (V )pA\nt (p(u0 ), db)\nb\u2208M\n\nand the formula\n\n\u03bc\u03bct 0 ,b (V\n\n)=\n\n\u22121\nlim(pA\nt (p(u0 ), b)]\n\u01eb\u21930\n\nZ\n\nV\n\npBt\u2212\u01eb (u0 , dv)pA\n\u01eb (p(v), b).\n\n\f4.7. KRYLOV-VERETENNIKOV EXPANSION\n\n73\n\nTake a nested sequence {\u03a0l }\u221e\nl=1 of partitions of [0, t]\n\u03a0l = {0 = tl0 < tl1 < * * * < tlkl = t},\nsay, with union dense in [0, t]. For any continuous bounded f : N + \u2192 R there is\nthe following approximation scheme to complete \u03c0t f (u0):\nProposition 4.6.1\nZ\n\nu ,\u03c3(tl )\n\nv ,\u03c3(tl )\n\nvk\n\n\u22121 ,\u03c3(t)\n\nqtl0 1 (dv1 )qtl1\u2212tl 2 (dv2 ) . . . qtl l\u2212tl \u22121 (dvkl )f (vkl )\nk\nk\n1\n2\n1\nl\u2192\u221e\n\b\n1 6 j 6 kl }.\n= lim EBu0 f (ut) | p(ultj ) = \u03c3(tlj ),\n\n\u03c0t f (u0 )(\u03c3) = lim\n\nl\u2192\u221e\n\nProof. The two versions of the right hand sides are equal before taking limits. For\nl = 1, 2, . . . ,, set\n\b\nS l f (\u03c3) = Eu0 f (ut ) | p(utlj ) = \u03c3(tlj ), 1 6 j 6 kl }.\n\n+\nl\nIt is defined for PA\nx0 -almost all \u03c3 in C(M ), where x0 = p(u0 ). Let Q be the\n+\nl\nl\n\u03c3-algebra on C(M ) generated by \u03c3 7\u2192 (\u03c3(t1 ), . . . , \u03c3(tj )). Directly from the\ndefinitions we see\n\u03c0tl f = E{\u03c0t (f )(u0 ) | Ql },\n\n\u2217\nA\nand so {S l f }\u221e\nl=1 is an Q -martingale. it is bounded and so converges Px0 -almost\nsurely. Since \u2228l Ql is the Borel \u03c3-algebra the limit is \u03c0t f (u0) as required.\n\n4.7 Krylov-Veretennikov Expansion\nP\nj m\nSuppose A = m\nj=1 LX j LX j + LA for smooth vector fields {X }j=1 and A. We\nwill now take {xt : 0 6 t < \u03b6} to be the solution to the stochastic differential\nequation\ndxt = X(xt ) \u25e6 dBt + A(xt )dt,\n(4.19)\nwith x0 given, for a Brownian motion B* on Rm , rather than the canonical process.\nHere X(x) : Rm \u2192 Tx M is the map given by\nX(x)(a1 , . . . , am ) =\n\nm\nX\nj=1\n\naj X j (x),\n\nx \u2208 M.\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n74\n\nLet {Pt : t > 0} be the sub-Markovian semi-group generated by B. Let f \u2208\nCc\u221e N. Assume Pt f \u2208 C \u221e N.\nAs in the proof Theorem 4.5.1, from\nZ s\nPt\u2212s f (us ) = Pt f (u0 ) +\nd(Pt\u2212r f )ur d{ur }, 0 6 s 6 t\n0\n\nwe obtain\n\u03c0s Pt\u2212s (f )(u0)(x* ) = Pt f (u0) +\n= Pt f (u0) +\n\nZ\n\nZ\n\ns\n0\n\n0\n\nE {d(Pt\u2212r f )ur \u25e6 hur | p(u* ) = x* } d{xr }\ns\n\nE {d(Pt\u2212r f )ur \u25e6 hur | p(u* ) = x* } X(xr )dBr\n\nso that \u03c0s Pt\u2212s f (u0), 0 6 s 6 t, is a continuous F\u2217x0 semi-martingale. Therefore\nZ t\n\u03c0t f (u0 ) \u2212 Pt f (u0 ) =\nds (\u03c0s Pt\u2212s f (us ))\n0\nZ t\n=\nE {d(Pt\u2212r f ) \u25e6 hur | p(u* ) = x* } X(xr )dBr\n0\nZ t\n\u0002\n\u0003\n=\nSr d(Pt\u2212r f ) \u25e6 h\u2212 \u25e6 X k (p(\u2212)) (u0 )dBrk\n0\n\ngiving a 'Clark-Ocone' formula for \u03c0t f (u0 ). Iterating this procedure formally,\nZ t\n\u0002\n\u0003\n\u03c0t f (u0) = Pt f (u0 ) +\nSr d(Pt\u2212r f ) \u25e6 h\u2212 \u25e6 X(p(\u2212)) (u0 )dBr\n0\nZ tZ r h\ni\n\u0002\n\u0003\nk\nj\n+\n\u03c0s dPr\u2212s d(Pt\u2212r f ) \u25e6 h\u2212 \u25e6 X (p(\u2212)) h\u2212 \u25e6 X (p(\u2212) dBsj dBrk\n0\n\n= ...,\n\n0\n\nwe obtain the Wiener chaos expansion of \u03c0t f (u0)(x* ).\n\n4.8 Conditional Laws\nIt will be convenient to extend the notation of section 4.3. For 0 6 l < r < \u221e\nlet C(l, r; N + ) and C(l, r; M + ) be respectively the space of continuous paths u :\n[l, r] \u2192 N + and x : [l, r] \u2192 M + which remain at \u2206 from the time of explosion; and Cu0 (l, r; N + ) and Cx0 (l, r; M + ) the paths from u0 \u2208 N + and x0 \u2208 M +\n(l,r),B\n(l,r),A\nrespectively, Let {Pu0 } and {Px0 } be the associated diffusion measures.\n\n\f4.8. CONDITIONAL LAWS\n\n75\n\nThe conditional law of {us : l 6 s 6 r} given {p(us ) : l 6 s 6 r} will\n(l,r);A\nbe given by probability kernels \u03c3 7\u2192 Ql,r\nalmost surely from\n\u03c3,u0 defined P\n+\np\n+\np\nCp(u0 ) (l, r; M ) to Cu0 (l, r; N ) for each u0 \u2208 N, where Cu0 (l, r; N + ) is the subspace of Cu0 (l, r; N + ) whose paths satisfy Assumption S. The defining property\nis that for integrable f : Cu0 (l, r; N + ) \u2192 R\nZ\nf (y)dQl,r\n(4.20)\nE {f (u* ) | p(us ) = \u03c3s , l 6 s 6 r} =\n\u03c3,u0 (y).\ny\u2208Cu0 (l,r;N + )\n\nTo obtain the conditional law take the decomposition B = AH +BV of Proposition\n2.3.5. Represent the diffusion corresponding to A by a stochastic differential\nequation\ndx\u2032t = X(x\u2032t ) \u25e6 dBt + X 0 (x\u2032t )dt.\n(4.21)\nTake a connection \u2207V on V T N and let\n(\u2207V )\n\ndzt = V (zt )dWt + V 0 (zt )dt\n\n(4.22)\n\nbe an It\u00f4 equation whose solutions are BV -diffusions. Here (Wt ) is the canonical\nBrownian motion on Rm for some m, independent of (B* ), the map V : M \u00d7\nRm \u2192 T M takes values in ker[T p], and V and V 0 are locally Lipschitz. For such\na representation of BV diffusions see the Appendix B. Let X\u0303 : N \u00d7 Rm \u2192 H and\nX\u0303 0 : N \u2192 H be the horizontal lifts of X and X 0 respectively using Proposition\n2.1.2. The solution to\n(\u2207V )\n(l,r),B\n\nhas law Pu0\n\ndyt = X\u0303(yt ) \u25e6 dBt + X\u0303 0 (yt )dt + V (yt )dWt + V 0 (yt )dt,\nyl = u0 ,\nu0 \u2208 N, l 6 t 6 r.\n. Noting that X\u0303(u) = hu X(p(u)) for u \u2208 M,\n\n(\u2207V )\n\ndyt = hyt \u25e6 dx\u2032t + V (yt )dWt + V 0 (yt )dt,\nyl = u0, l 6 t 6 r,\n\n(4.23)\n\nwhere x\u2032t = p(yt ) so that (x\u2032t ) is a solution to (4.21) starting from p(u0 ) at time\nl. Without changing the law of y* we can replace x\u2032 by the canonical process x* .\nThen\nTheorem 4.8.1 Consider the solution (yt ) as a process defined on the probability\nspace Cp(u0 ) (l, r; M + ) \u00d7 C0 Rm with product measure,\ny : [l, r] \u00d7 Cp(u0 ) (l, r; M + ) \u00d7 C0 Rm \u2192 N + ,\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n76\n\nm\n+\nand define Ql,r\n\u03c3,u0 to be the law of y(\u03c3, \u2212) : C0 R \u2192 Cu0 (l, r; N ). For bounded\nmeasurable f : Cu0 (l, r; N + ),\nZ\nf (y)dQl,r\nE {f (u* ) | p(us ) = \u03c3s , l 6 s 6 r} =\n\u03c3,u0 (y).\ny\u2208Cu0 (l,r;N + )\n\nProof. Take a measurable function \u03b1 : Cp(u0 ) (l, r; M + ) \u2192 R. Then\n!\nZ\nB\n\nEPu0\n\n= E\n\nPA\np(u\n\n\u03b1(p(u))\n\n0)\n\n\u03b1(x)\n\nZ\n\ny\u2208Cu0\n\ny\u2208Cu\n\n(l,r;N + )\n\n(l,r;N + )\n\nf (y) dQl,r\np(u),u0 (y)\n\nf (y) dQl,r\nx,u0 (y)\n\n!\n\n0\n\u0012\n\u0013\nZ\nPA\np(u0 )\n\u03b1(x)\nf (y(x, \u03c9)) dP(\u03c9))\n= E\nC0 Rm\nZ\n\u0001\n=\n\u03b1(x)f (y(x, \u03c9)) dPA\np(u0) dP(\u03c9))\n\nCp(u0 ) (l,r;M + )\u00d7C0 Rm\n\n= Ef (u)\u03b1(p(u)),\nas required.\n\nNote that Theorem 4.8.1 is equivalent to the statement that \u03c9 7\u2192 Ql,r\np(\u03c9),u0 ,\n(l,r),B\n\n\u03c9 \u2208 Cu0 (l, r; N + ), is a regular conditional probability of Pu0\n\ngiven p.\n\nRemark 4.8.2 Let (\u03betl (*, *), l 6 t < \u221e) be a measurable flow for (4.21) and\n(\u03b7tl (\u03c3, *, ), 0 6 t < \u221e) one for (4.23) with x\u2032 replaced by \u03c3 \u2208 Cp(u0 ) (l, r; M + ).\nFor \u03c9 \u2208 \u03a9, the underlying probability space for the Brownian motion B, define\n+\nQl,r\n\u03c9 , from the space of bounded measurable functions on N to itself, by\n\u0001\nl l\nQl,r\n\u03c9 (f )(u0 ) = Ef \u03b7r (\u03ber (p(u0 ), \u03c9), u0 ) .\nA direct calculation shows that\n\nr,s\nl,s\nQl,r\n\u03c9 Q\u03c9 = Q\u03c9\n\nfor 0 6 l 6 r 6 s < \u221e. Thus their adjoints on a suitable dual space would form\nan evolution.\nMore generally, letting Borel(X) stand for the Borel \u03c3-algebra of a topological\nspace X:\n\n\f4.8. CONDITIONAL LAWS\n\n77\n\nProposition 4.8.3 Let \u03c6 be a measurable map from Cx0 (l, r; M + ) to some measure space, and let\nP(l,r),\u03c6\n: Cx0 (l, r; M + ) \u00d7 Borel(Cx0 (l, r; M + )) \u2192 [0, 1]\nx0\n(l,r)\n\nbe a regular conditional probability for Px0 given \u03c6. For u0 with p(u0 ) = x0 set\nZ\n(l,r),\u03c6\nl,r,\u03c6\u25e6p\nQl,r\n(p(\u03c9), d\u03c3)\nQu0 (\u03c9, A) =\n\u03c3,u0 (A)Px0\nCx0 (l,r;M + )\n\nfor \u03c9 \u2208 Cu0 (l, r; N + ) and A \u2208 Borel (Cu0 (l, r; N + )). Then Ql,r,\u03c6\u25e6p\nis a regular\nu0\n(l,r),B\nconditional probability of Pu0\ngiven \u03c6 \u25e6 p.\nProof. By definition\nn\no\nl,r\n(l,r),A,x0\nQl,r,\u03c6\u25e6p\n(\u03c9,\nA)\n=\nE\nQ\n(A)|\u03c6\np(\u03c9)\nu0\np(\u2212),u0\n\b\n= E(l,r),A,x0 E(l,r),B,u0 {\u03c7A |p = \u2212}|\u03c6 p(\u03c9)\n= E(l,r),B,u0 {\u03c7A |\u03c6 \u25e6 p}(\u03c9).\n\nCorollary 4.8.4 For \u03c6 as in Theorem 4.8.3 suppose that the canonical process\n(0,T ),\u03c6\non M + with law Px0\n(\u03c3, \u2212) is a semi-martingale for almost all \u03c3, in its own\n(0,T ),A\nx0\nalmost all \u03c3. Then the solution y(\u03c3, \u2212) to\nfiltration Ft , 0 6 t 6 T , for Px0\nthe equation\n(\u2207V )\n\ndyt = hyt \u25e6 d\u03c3t + V (yt )dWt + V 0 (yt )dt,\nyl = u0 , 0 6 t 6 T\n(0,T ),\u03c6\n\nwhere \u03c3t , 0 6 t 6 T is run with law Px0\nfrom u0 conditioned by \u03c6 \u25e6 p.\n\n(4.24)\n\n(\u03c3, \u2212), is a version of the B-diffusion\n\nProof. That the law of the solution is as required follows from the discussion at\nthe beginning of this section together with Proposition 4.8.3 and Fubini's theorem.\nConditions under which conditioned processes are semi-martingales are discussed by Baudoin [2]. In particular bridge processes derived from elliptic diffusions are, so we obtain the following version of Carverhill's result [12]:\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n78\n\nCorollary 4.8.5 Suppose A is elliptic and let bt : 0 6 t 6 T be a version of the\nA-bridge going from x0 to z in time T , some z \u2208 M. Then the solutions to\n(\u2207V )\n\ndyt = hyt \u25e6 dbt + V (yt )dWt + V 0 (yt )dt,\ny0 = u0 , 0 6 t 6 T\n\n(4.25)\n\ngive a version of the B diffusion from u0 conditioned on p(uT ) = z.\n\n4.9 Equivariant case: skew product decomposition\nIn the equivariant case, when N is the total space P of a principal bundle\n\u03c0 : P \u2192 M as in \u00a75, a version of Theorem 4.8.1 is given in [25] which reflects\nthe additional structure. In particular the following is proved there:\nProposition 4.9.1 Let B be an equivariant diffusion operator on P which induces\na cohesive diffusion operator A on M. Let {yt : 0 6 t < \u03b6} be a B-diffusion on\nP \u2217 . Then\nyt = x\u0303t * gtx\u0303* ,\nwhere\n(i) {x\u0303t : 0 6 t < \u03b6} is the horizontal lift of p(y* ), starting at y0 , using the\nsemi-connection induced by B\n(ii) {gt\u03c3 : 0 6 t < \u03b6(\u03c3)} is a diffusion independent of {p(yt ) : 0 6 t < \u03b6} on\nG starting at the identity with time dependent generator L\u03c3t given by\nX\nX\nL\u03c3t f (g) =\n\u03b1ij (\u03c3(t) * g)LA\u2217i LA\u2217j f (g) +\n\u03b2 k (\u03c3(t)g)LA\u2217k f (g),\ni,j\n\nfor any \u03c3 \u2208 GP + , 0 6 t < \u03b6(\u03c3), where A\u22171 , . . . , A\u2217k are the left invariant\nvector fields on G corresponding to a basis of g and the \u03b1ij and \u03b2 k are the\ncoefficients for BV as in Theorem 3.2.1.\nNote that for each t the operator L\u03c3t is conjugate to the restriction of BV to the\nfibre through \u03c3(t) by the map\ng \u2192\n7\np\u22121 (p(\u03c3(t)))\ng \u2192\n7\n\u03c3(t)g.\nIt is a right invariant operator.\n\n\f4.9. EQUIVARIANT CASE: SKEW PRODUCT DECOMPOSITION\n\n79\n\nRemark 4.9.2 Note that by the equivariance of L\u03c3* there will be no explosion\nof the process (gt\u03c3 ) before that of \u03c3* . Consequently Assumption S of \u00a74.3 holds\nautomatically.\nBelow we give the equivariant version of Proposition 4.8.1. We shall use the\nnotation of \u00a74.8. However we replace the one point compactification P + of P\nby P\u0304 = P \u222a \u2206 with the smallest topology agreeing with that of P and such that\n\u03c0 : P\u0304 \u2192 M + is continuous. Also let G+ be the one point compactification G \u222a \u2206\nof G with group multiplication and action of G extended so that\nu * \u2206 = \u2206, \u2206 * g = g * \u2206 = \u2206,\n\n\u2200u \u2208 P\u0304 , g \u2208 \u1e20.\n\nFor 0 6 l < r < \u221e if y \u2208 C(l, r; P\u0304 ), we write ly = l and ry = r. Let C(\u2217, \u2217; P\u0304 )\nbe the union of such spaces C(l, r; P\u0304 ). It has the standard additive structure under\nconcatenation: if y and y \u2032 are two paths with ry = ly\u2032 and y(ry ) = y \u2032 (ly\u2032 ) let y + y \u2032\nbe the corresponding element in C(ly , ry\u2032 ; P\u0304 ). The basic \u03c3-algebra of C(\u2217, \u2217, P\u0304 )\nis defined to be the pull back by \u03c0 of the usual Borel \u03c3-algebra on C(\u2217, \u2217; M + ).\nGiven an equivariant diffusion operator B on P consider the laws {Pa(l,r),B : a \u2208 P }\nas a kernel from P to C(l, r; P\u0304 ). The right action Rg by g in G+ extends to give a\nright action, also written Rg , of G+ on C(\u2217, \u2217, P\u0304 ). Equivariance of B is equivalent\nto\n(l,r),B\nPag\n= (Rg )\u2217 Pa(l,r),B\n(l,r),B\n\nfor all 0 6 l 6 r and a \u2208 P . Therefore \u03c0\u2217 (Pa\n) depends only on \u03c0(a),\nl, r and gives the law of the induced diffusion A on M. We say that such a\ndiffusion B is basic if for all a \u2208 P and 0 6 l < r < \u221e the basic \u03c3-algebra on\n(l,r),B\nC(l, r; P\u0304 ) contains all Borel sets up to Pa\nnegligible sets, i.e. for all a \u2208 P\nand Borel subsets B of C(l, r; P\u0304 ) there exists a Borel subset A of C(l, r, M + ) s.t.\n\u0001\n(l,r),B\nPa\n\u03c0 \u22121 (A)\u2206B = 0.\nFor paths in G it is more convenient to consider the space C \u0303id (l, r; G+ ) of\ncadlag paths \u03c3 : [l, r] \u2192 G+ with \u03c3(l) = id such that \u03c3 is continuous until it\nleaves G and stays at \u2206 from then on. It has a multiplication\nC \u0303id (s, t; G+ ) \u00d7 C \u0303id (t, u; G+ ) \u2212\u2192 C \u0303id (s, u; G+ )\n(g, g \u2032) 7\u2192 g \u00d7 g \u2032\n\nwhere (g \u00d7 g \u2032 )(r) = g(r) for r \u2208 [s, t] and (g \u00d7 g \u2032)(r) = g(t)g \u2032(r) for r \u2208 [t, u].\nGiven probability measures Q, Q\u2032 on C \u0303id (s, t; G+ ) and C \u0303id (t, u; G+ ) respectively this determines a convolution Q \u2217 Q\u2032 of Q with Q\u2032 which is a probability\nmeasure on C \u0303id (s, u; G+ ).\n\n\f80\n\nCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n(l,r),B\n\nTheorem 4.9.3 Given the laws {Pa\n: a \u2208 P, 0 6 l < r < \u221e} of an equivariant diffusion B over a cohesive A there exist probability kernels {PH,l,r\n: a \u2208 P}\na\nl,r\nl,r\nfrom P to C(l, r; P\u0304 ), 0 6 l < r < \u221e and y 7\u2192 Qy , defined P a.s. from\nC(l, r; P\u0304 ) to C \u0303id (l, r; G+ ) such that\n(i) {PH,l,r\n: a \u2208 P } is equivariant, basic and determining a cohesive generator.\na\n(ii) y 7\u2192 Ql,r\ny satisfies\n\nly ,r\n\n\u2032\n\nl \u2032 ,ry \u2032\n\nQy+yy\u2032 = Qlyy ,ry \u2217 Qyy\u2032\n\nfor Ply ,ry \u2297 Ply\u2032 ,ry\u2032 almost all y, y \u2032 with ry = ly\u2032 .\n(iii) For U a Borel subset of C(l, r; P\u0304 ),\nZ\nZ\nl,r\nPa (U) =\nC(l,r;P\u0304 )\n\n+)\n \u0303\nC(l,r;G\n\nH,l,r\n\u03c7U (y* * g* )Ql,r\n(dy).\ny (dg)Pa\n\nThe kernels PH,l,r\nare uniquely determined as are the {Ql,r\na\ny : y \u2208 C(l, r; P\u0304 )},\nl,r\nPH,l,r\na.s.\nin\ny\nfor\nall\na\nin\nP\n.\nFurthermore\nQ\ndepends\non\ny only through its\na\ny\nprojection \u03c0(y) and its initial point yl .\nThe proof of this theorem is as that of Theorem 2.5 in [25] (although there the\nprocesses are assumed to have no explosion).\nStochastic differential equations can be given for (x\u0303t ) and (gt\u03c3 ) as in \u00a74.8,\nfrom which the decomposition can be proved via It\u00f4's formula; see Theorem 8.2.5\nbelow for details of a special case.\nProposition 4.9.1 extends results for Riemannian submersions by ElworthyKendall [24] and related results by Liao[48]. A rich supply of examples of skewproduct decomposition of Brownian motions, with a general discussion, is given\nin Pauwels-Rogers[58].\nFor a special class of derivative flows, considered as GLM-valued process as\nin \u00a73.3 there is a different decomposition by Liao [49], see also Ruffino [65].\n\n4.10 Induced processes on vector bundles\nIn the notation of \u00a73.4 let \u03c1 : G \u2192 L(V, V ) be a C \u221e representation with \u03a0\u03c1 :\nF \u2192 M the associated bundle. A B-diffusion {yt : 0 6 t < \u03b6} on P determines\n\n\f4.10. INDUCED PROCESSES ON VECTOR BUNDLES\n\n81\n\na family of {\u03c8t : 0 6 t < \u03b6} of random linear map Wt from Fx0 \u2192 Fxt , where\nxt = \u03c0(yt ). By definition,\n\u03c8t [(y0 , e)] = [(yt , e)].\nAssuming A is cohesive we have the parallel translation //t : Fx0 \u2192 Fxt along\n{xt : 0 6 t < \u03b6} determined by our semi-connection. This is given by\n//t [(y0 , e)] = [(x\u0303t , e)]\nwhere x\u0303* is the horizontal lift of x, starting at y0 .\nWhen taken together with Corollary 3.4.8 the following extends results for derivative flows in Elworthy-Yor[29], Li[47], Elworthy-Rosenberg [28], and ElworthyLeJan-Li[27].\nTheorem 4.10.1 Let \u03c1 : G \u2192 L(V ; V ) be a representation of G on a Banach\nspace V and \u03a0\u03c1 : F \u2192 M the associated vector bundle. Let {yt : 0 6 t < \u03b6}\nbe a B-diffusion for an equivariant diffusion operator B over a cohesive diffusion\noperator A. Set xt = p(yt ) and let \u03a8t : Fx0 \u2192 Fxt , 0 6 t < \u03b6 be the induced\ntransformations on F . Then the local conditional expectation {\u03a8\u0304t : 0 6 t < \u03b6},\nfor \u03a8\u0304t = E{\u03a8t |\u03c3{xs : 0 6 s < \u03b6} exists and is the solution of the covariant\nequation along {xt : 0 6 t < \u03b6}:\nD\n\u03a8\u0304t = \u039b\u03c1 \u25e6 \u03a8\u0304t\n\u2202t\nwith \u03a80 the identity map, \u039b\u03c1 : F \u2192 F given by \u03bb\u03c1 in Theorem 3.4.1 and where\nD\nrefers to the semi-connection determined by B.\n\u2202t\nProof. From above and Proposition 4.9.1 we have\n\u03a8t [(y0 , e)] = [(x\u0303t \u25e6 gtx\u0303 , e)] = [(x\u0303t , \u03c1(gtx\u0303 )\u22121 e]\nand so //t\u22121 \u03c8t [(y0 , e)] = [(y0 , \u03c1(gtx\u0303 )\u22121 e)]. Now from the right invariance of Gt\u03c3 , for\nfixed path \u03c3 and time t, we can apply Baxendale's integrability theorem for the\nright action\nG \u00d7 L(V ; V ) \u2192 L(V ; V )\n(g, T ) 7\u2192 \u03c1(gt\u03c3 )\u22121 \u25e6 T\n\n\fCHAPTER 4. PROJECTIBLE DIFFUSION PROCESSES\n\n82\n\nto see E|\u03c1(gt\u03c3 )\u22121 |L(V ;V ) < \u221e for each \u03c3, t and we have E(\u03c3)t \u2208 L(V ; V ) given\nby\nE(\u03c3)t e = E\u03c1(gt\u03c3 )\u22121 e.\nBy considering (1 + E|\u03c1(gt\u03c3 )\u22121 //t\u22121 \u03c8t for \u03c3 = x* . We see the local conditional\nexpectation \u03a8\u0304t exists in L(Fx0 ; Fxt ) and\n\u03a8\u0304t [(y0 , e)] = [(x\u0303t , E(x* )t e)].\nThe computation in Theorem 3.4.1 shows that\nd\nd \u22121\n//t \u03a8\u0304t [(y0 , e)] = [(y0 , E(x* )t e)] = [(y0 , \u03bb\u03c1 (x\u0303t )E(x* )t e)]\ndt\ndt\ngiving\nD\n\u03a8\u0304t [(y0 , e)] = [(x\u0303t , \u03bb\u03c1 (x\u0303t )E(x* )t e)] = \u039b\u03c1 (x* )\u03a8\u0304t [(y0 , e)]\ndt\nas required.\nRemark 4.10.2 Theorem 4.10.1 could also be used to identify the generator of the\noperator induced on sections of F \u2217 , reproving Theorem 3.4.1, since if \u03c6 \u2208 \u03b3F \u2217\nthen E\u03c6 \u25e6 \u03a8t \u03c7t<\u03b6 = E\u03c6 \u25e6 \u03a8\u0304t \u03c7t<\u03b6 if the expectations exist, by Corollary 3.3.5 of\n[27]. The extra information in Theorem 4.10.1 is the existence of the conditional\nexpectation. Baxendales' integrability theorem used for this applies in sufficiently\ngenerality to give corresponding results for infinite dimensional G, for example in\nthe situation arising in chapter 8 below.\n\n\fChapter 5\nFiltering with non-Markovian\nObservations\nSo far we have considered smooth maps p : N \u2192 Mwith a diffusion process u.\non N mapping to a diffusion process x. = p(u. ) on M. From the point of view\nof filtering we have considered u. as the signal and x. as the observation process.\nHowever the standard set up for filtering does not assume Markovianity of the\nobservation process. Classically we have a signal z. , a diffusion process on Rd or\na more general space, and an observation process x. on some Rn given by an SDE\nof the form\ndxt = a(t, xt , zt )dt + b(t, xt , zt )dBt\n(5.1)\nwhere B. is a Brownian motion independent of the signal. To fit this into our\ndiscussion we will need to assume that the noise coefficient of the observation\nSDE does not depend on the signal other than through the observations, as well\nas the usual cohesiveness assumptions. We can take N = Rd \u00d7 Rn and M = Rn\nwith p the projection and ut = (zt , xt ). To reduce to our Markovian case we can\nuse the standard technique of applying the Girsanov-Maruyama theorem. Here\nwe first carry this out in the general context of diffusions with basic symbols, as\ndiscussed in Section 2.4 and then show how it fits in with the classical situation.\nFor simplicity we shall assume that the signal is a time homogeneous diffusion,\nand that the coefficients in the observation SDE are also independent of time. The\nstate spaces are taken to be smooth manifolds and the standard non-degeneracy\nassumptions on the observation process somewhat relaxed.\nFor other discussions about filtering with processes which have values in a\nmanifold see [18], [59], and [32].\n83\n\n\f84 CHAPTER 5. FILTERING WITH NON-MARKOVIAN OBSERVATIONS\n\n5.1 Signals with Projectible Symbol\nUsing the notation and terminology of Section 2.4 suppose that our diffusion operator B on N is conservative and descends cohesively over p : N \u2192 M so that\nfor a horizontal vector field bH on N the diffusion operator B\u0303 := B \u2212 bH lies over\nsome cohesive A. Choose such an A so that B\u0303, and so A, is also conservative:\nwe assume that this is possible. Also choose a locally bounded one-form b# on N\nwith 2\u03c3 B (b# ) = bH . This is possible since bH is horizontal, and we can, and will,\nchoose b# to vanish on vertical tangent vectors and satisfy\nH\nB # #\nH\n2\nb#\ny (b (y)) = 2\u03c3y (by , by ) = |b (y)|y\n\ny\u2208N\n\n(5.2)\n\nwhere |bH (y)|y refers to the Riemannian metric on the horizontal tangent space\nH\ninduced by 2\u03c3 A . This can be achieved by first choosing some smooth b\u0303 : N \u2192\nA\nT \u2217 M such that, in the notation of equation (2.10), \u03c3p(y)\n(b\u0303(y)) = b(y) for y \u2208 N;\n#\nand then taking b to be the pull back of b\u0303 by p:\nb#\ny (v) = b\u0303(y)(Ty p(v))\nNow set\nZt = exp{\u2212Mt\u03b1 \u2212\n\ny\u2208N\n\n1\nhM \u03b1 it }\n2\n\nfor \u03b1t (u. ) = b#\nut where u \u2208 C([0, T ]; N), our canonical probability space furnished with measures P := PB and P\u0303 := PB\u0303 and corresponding expectation\noperators E and \u1ebc.\nHere and below we are using the notation of proposition 4.1.1 with\nM \u03b1 etc\nR\nt\nreferring to taking martingale parts with respect to P while M\u0303 \u03b1 and 0 \u03b1s d{ys }\nare with respect to P\u0303.\nFrom the Girsanov-Maruyana-Cameron-Martin theorem (see the Appendix, Section 9.1), we know that Z. is a martingale under P and the two measures are\nequivalent with\ndPB\u0303y0\n= ZT .\ndPBy0\nSuppose f : N \u2192 R is bounded and measurable. We wish to find \u03c0t (f ) : N \u2192\nR, 0 6 t 6 T where\n\b\n\u03c0t (f )(y0) = Ey0 f (ut)|p(us ), 0 6 s 6 t .\n\n\f5.1. SIGNALS WITH PROJECTIBLE SYMBOL\n\n85\n\nFollowing the approach due to Zakai, consider the unnormalised filtering process\n\u03c0\u0302t (f ) : N \u2192 R given by\n\b\n\u03c0\u0302t (f )(u0 ) = \u1ebcu0 f (ut )Zt\u22121 | p(us ), 0 6 s 6 t .\nFor completeness we state and prove the Kallianpur-Striebel formula , a version\nof Bayes' formula:\nLemma 5.1.1\n\u03c0t (f )(u0 ) =\n\n\u03c0\u0302t (f )(u0)\n\u03c0\u0302t (1)(u0)\n\nPu0 \u2212 as.\n\nProof. Set x0 = p(u0 ). Let g : Cu0 ([0, T ]; N) \u2192 R be Ftx0 -measurable. Then\n1\nf (ut)g(u. )}\nZt\n1\n= \u1ebc{\u1ebc{ f (ut )|Ftu0 }g(u.)}\nZt\n1\n= E{Zt \u1ebc{ f (ut )|Ftu0 }g(u.)}.\nZt\n\nEu0 {f (ut )g(u.)} = \u1ebc{\n\n(5.3)\n\nThus\n\u03c0t (f )(u0 ) = E{Zt |Ftu0 }\u03c0\u0302t (f )(u0 ).\n\nTaking f constant shows that E{Zt |Ftuo }\u03c0\u0302t (1)(u0) = 1 and the result follows.\nWe can now go on to obtain the analogue of the Duncan-Mortensen-Zakai (DMZ)\nequation for the unnormalized filtering process, using the results of Section 4.8 on\nconditional laws:\nTheorem 5.1.2 For any C 2 function f : N \u2192 R, under P\u0303,\nRt\n\u0001\nRt\n\u0001\n\u03c0\u0302t f (u0 ) = f (u0 ) + 0 \u03c0\u0302s Bf (u0 ) ds + 0 \u03c0\u0302s f b# (\u2212)h\u2212 (u0)d{xs }\nRt\n\u0001\n+ 0 \u03c0\u0302s df\u2212 h\u2212 (u0 )d{xs };\n\u0001\nRt\nRt\n\u03c0\u0302t f (u0 ) = f (u0 ) + 0 \u03c0\u0302s Bf (u0 ) ds + 0 h\u03c0\u0302s (f b)(u0 ), d{xs }ixs\n\u0001\nRt\n+ 0 \u03c0\u0302s df\u2212 h\u2212 (u0 )d{xs }.\n\n(5.4)\n\n(5.5)\n\n\f86 CHAPTER 5. FILTERING WITH NON-MARKOVIAN OBSERVATIONS\nwhere xs = p(us ), 0 6 s 6 \u221e is the projection to M of the canonical process\nfrom u0 on N, and h the horizontal lift map for the induced semi-connection.\nUsing an alternative notation:\n\u0001\n\u0001\nZ t\n\u03c0\u0302. df \u25e6hu. ,A\n\u03c0 f b# \u25e6hu. ,A\n+\n+ Mt\n\u03c0\u0302t f = \u03c0\u03020 f + Mt\n\u03c0\u0302s (Bf )ds.\n(5.6)\n0\n\n#\n\n# ,B\u0303\n\nProof. Since we are working with P\u0303 we will write M b for M b\nsatisfies:\n\n, etc. Also Zt\u22121\n\n#\n\ndZt\u22121 = Zt\u22121 dMtb\nwhile\n\ndf (ut) = dMtdf + B\u0303(f )(ut)dt\ngiving\n\u0001\nd Zt\u22121 f (ut ) =\n\nZt\u22121 dMtdf + Zt\u22121 B\u0303(f )(ut )dt\n#\n\n+f (ut )Zt\u22121 dMtb + Zt\u22121 + dfut (bH (ut ))dt\n\n\u0001\n#\nsince dMtdf dMtb = \u03c3 B\u0303 dfut , b# = dfu. (bH (ut )). Thus\n\n\u0001\n#\nd Zt\u22121 f (ut ) = Zt\u22121 dMtdf + Zt\u22121 B(f )(ut )dt + f (ut )Zt\u22121 dMtb + Zt\u22121 .\n\nWe can now take conditional expectations using proposition 4.3.5 since B \u2212 LbH\nis over the cohesive operator A to complete the proof.\nLemma 5.1.3 There are the following formulae for angle brackets:\ndh\u03c0\u0302(1)it = h\u03c0\u0302t (b), \u03c0\u0302t (b)iE\nxt dt\n\n(5.7)\n\ndh\u03c0\u0302(1), \u03c0\u0302(f )it = h\u03c0\u0302t (f b), \u03c0\u0302t (b)iE\nxt dt + \u03c0\u0302t (df \u25e6 hu. ) \u25e6 \u03c0\u0302t (b(u. ))dt\nProof. From the previous theorem\n\u03c0\u0302(f b# \u25e6h),A\n\nh\u03c0\u0302(1), \u03c0\u0302(f )idt = dMt\n\n\u03c0\u0302 (df \u25e6hu. ),A \u0001\n\n+ dMt .\n\n\u03c0(b# \u25e6h),A\n\ndMt\n\n\u0001\n\u0001\n= 2\u03c3 A \u03c0\u0302t (f b# \u25e6 h), \u03c0\u0302t (b# \u25e6 h) dt + 2\u03c3 A \u03c0\u0302t (df \u25e6 hu. ), \u03c0\u0302t (b# \u25e6 h) dt\n= h\u03c0\u0302t (f b), \u03c0\u0302t (b)ixt dt + \u03c0\u0302t (df \u25e6 hu. ) \u25e6 \u03c0\u0302t (b(u. ))dt\n\n(5.8)\n\n\f5.1. SIGNALS WITH PROJECTIBLE SYMBOL\n\n87\n\nsince for any one form \u03c6 on M we have:\n\u0001\n\u2217\u0001\n\u03c3 A \u03c6, \u03c0\u0302t (b# \u25e6 h) = \u03c0\u0302t h\u03c6|E , b# \u25e6 hiE\n.\n\u0001\n1\n\u03c0\u0302t \u03c6(b)\n=\n2\n1\n=\n\u03c6(\u03c0\u0302t (b)).\n2\nThis gives the second formula, from which comes the first.\nWe can now give a version of Kushner's formula in our context:\nTheorem 5.1.4 In terms of the probability measure P\u0303\n\n\u03c0t f = \u03c00 f +\n\nZ\n\n0\n\nt\n\nZ\n\nt\n\u0001\n\u03c0s B(f )ds +\n\u03c0s df \u25e6 hu. [d{xs } \u2212 \u03c0s (b(u. ))s ds] (5.9)\nZ t 0\n+ h\u03c0s (f b) \u2212 \u03c0s (f )\u03c0s (b), d{xs } \u2212 \u03c0s (b)ixs .\n0\n\nProof. From the definition and then Ito's formula:\n\u0013\n\u03c0\u0302t (f )\nd\u03c0t (f ) = d\n\u03c0\u0302t (1)\nd\u03c0\u0302t (f ) \u03c0\u0302t (f )d\u03c0\u0302t (1) d\u03c0\u0302t (f )d\u03c0\u0302t (1)\n=\n\u2212\n\u2212\n\u03c0\u0302t (1)\n(\u03c0\u0302t (1))2\n(\u03c0\u0302t (1))2\n\u03c0\u0302t (f )d\u03c0\u0302t (1)d\u03c0\u0302t (1)\n.\n+\n(\u03c0\u0302t (1))3\n\u0012\n\nNow substitute in the second formula of Theorem 5.1.2 and use the previous\nlemma.\nNote that \u03c0\u0302t (f ), b, and P\u0303, depend on the choice of A. We would like to have\na version of formula 5.9 which is independent of such choices. First note that if\nH\nB \u2212 bH\n1 is over A1 , and B \u2212 b2 is over A2 , then the difference of the two vector\nfields on N descends to a vector field on M: if g : M \u2192 R is smooth and\ng\u0303 = g \u25e6 p : N \u2192 R then\nH\nH  \u0303\nH\n(bH\n2 \u2212 b1 )g\u0303 = (B \u2212 b1 )f \u2212 (B \u2212 b1 )g\u0303 = (A1 \u2212 A2 )g.\n\n\f88 CHAPTER 5. FILTERING WITH NON-MARKOVIAN OBSERVATIONS\nH\nTherefore if we set b0 (z) = Ty p(bH\n2 (y) \u2212 b1 (y)) for p(y) = z, z \u2208 M then\nA1 = A2 + Lb0 , and by Remark 4.1.4\n\nd{xs }A2 = d{xs }A1 + b0 ds\n\n(5.10)\n\nFrom this we see immediately that the symbols d{xs } \u2212 \u03c0s (b)ds, and \u03c0s (f b) \u2212\n\u03c0s (f )\u03c0s (b) in formula 5.9 are in fact independent of the choice we made of A. To\nrelate to now classical concepts we next discuss the first of these in more detail.\n\n5.2 Innovations and innovations processes\nKeeping the notation above, for \u03b1 \u2208 L2A , so \u03b1t \u2208 Tx\u2217t M for 0 6 t < \u221e, define a\nreal valued process It\u03b1 : 0 6 t < \u221e, the \u03b1-innovations process by\nZ t\n\u0001\n\u03b1\nIt =\n\u03b1s d{xs }A \u2212 \u03c0s b(u. )ds\n(5.11)\n0\n\nA generalisation of a standard result about innovations processes is:\n\nProposition 5.2.1 The process I.\u03b1 is independent of the choice of A. Under PB,u0\nit is an F\u2217x0 martingale.\nProof. The observations just made show it is independent of the choice of A. It\nis clearly also adapted to F\u2217x0 . To prove the martingale property note first that by\nProposition 4.3.4 and formula (5.10)\nZ t\nZ t\nA\n\u03b1s d{xs } =\np\u2217 (\u03b1s )d{us}B\u2212LbH\n0\nZ0 t\nZ t\n\u2217\nB\n=\np (\u03b1s )d{us} \u2212\np\u2217 (\u03b1s )bH (us )ds\nZ0 t\nZ0 t\n=\np\u2217 (\u03b1s )d{us}B \u2212\n\u03b1s (b(us ))ds.\n0\n\n0\n\nFrom this we see that if 0 < r < t and Z \u2208 \u03c3{xs : 0 6 s 6 r} then\n(Z\n)\nt\n\u0001\nEB \u03c7Z\n\u03b1s d{xs }A \u2212 \u03c0s b(u. ) ds\nr\n\n= EB \u03c7Z\ngiving the required result.\n\n(Z\n\nt\n\nr\n\n\u03b1s (b(us ) \u2212 \u03c0s b(u. )) ds\n\n)\n\n=0\n\n\f5.2. INNOVATIONS AND INNOVATIONS PROCESSES\n\n89\n\nIf we fix a metric connection, \u0393, on E, as described in Example 4.1.6 we can take\nthe canonical Brownian motion, B \u0393,A say, on Ex0 determined by A and \u0393. Then,\n\u2032\nby equation (4.8), we can write d{xs }A \u2212 \u03c0s (b(u. ))ds = //s dB \u0393 A \u2212 \u03c0s (b(u. ))ds.\nIn terms of the the P Brownian motion, B \u0393 , on Ex0 , which is the martingale part\nunder P of the \u0393- stochastic anti-development of x. we can define an Ex0 -valued\nprocess, zt\u0393 : 0 6 t < \u221e, by\nzt\u0393\n\n=\n\nBt\u0393\n\n+\n\nZ\n\nt\n\n(//s )\u22121 (b(us ) \u2212 \u03c0s (b(u. ))ds.\n\n0\n\n(5.12)\n\nA candidate for the innovations process of our signal -observation system is\nthe stochastic development , \u03bd.\u0393 say, of z.\u0393 . under \u0393. This can be defined by using\nthe canonical sde on the orthonormal frame bundle of E, namely\nd\u03bd\u0303t = X(\u03bd\u0303t )(\u03bd \u03030 )\u22121 \u25e6 dzt\nfor a fixed frame \u03bd0 for Ex0 . Here\nX(\u03bc)(e) = h\u0393\u03bc (\u03bc(e)).\nfor \u03bc : Rp \u2192 Em a frame in at some point m \u2208 M, and e \u2208 Rp , for p the fibre\ndimension of E. The process \u03bd.\u0393 is then the projection of \u03bd\u0303. on M. For example\nsee [22]. It will satisfy the Stratonovich equation\nd\u03bdt\u0393 = //t \u25e6 dzt\n\n(5.13)\n\nwhere the parallel translation is now along the paths of \u03bd.\u0393 . Let \u0398 : C0 (M) \u2192\nC0 (M) be the map given by \u0398( \u03c3)t = \u03bd \u0393 (\u03c3)t , treating z.\u0393 as defined on C0 (M).\nLet D = D \u0393 : C0 (Tx0 M \u2192 Cx0 M be the stochastic development using \u0393 with\ninverse D \u22121 . We will continue to assume that there is no explosion so that these\nmaps are well defined. For example,\nz(x. ) = D \u22121 \u0398(x. ).\nWe define a semi-martingale, on M to be a \u0393-martingale if it is the stochastic\ndeveloment using \u0393 of a local martingale, see the Appendix, Section9.3.\nTheorem 5.2.2 For each metric connection \u0393 on E the innovations process \u03bd \u0393 is\na \u0393-martingale. If \u0393 is chosen so that the A-diffusion process is a \u0393-martingale\n\n\f90 CHAPTER 5. FILTERING WITH NON-MARKOVIAN OBSERVATIONS\nunder PA then for \u03b1 : [0, \u03c4 ) \u00d7 Cx0 M \u2192 T \u2217 M which is predictable and lives over\nx. , provided the integrals exist,\nZ\nZ .\n\u0001 .\n\u03b1\n\u0393\n\u0393\n(5.14)\nI \u25e6 \u0398(x. ) = \u0393\n\u03b1(\u03bd (x. ). )sd\u03bd (x. )s \u2212\n\u03b1(x. )s b(x. )s ds\n0\n\n0\n\nwhere b(\u2212)s : Cx0 \u2192 T M is the conditional expectation,\nbs = E{b(us )|p(u. ) = x. },\nand has b(x. )s \u2208 Txs almost surely for all s.\n\nProof. The fact that \u03bd \u0393 is a \u0393-martingale is immediate from the definition and\nProposition 5.2.1. To prove the claimed identity note that our extra assumption on\n\u0393 implies that //s\u22121 d{xs }A = d(D \u22121(x. ))s . Therefore\nZ .\nZ .\n\u03b1\n\u22121\nI (x. ) =\n\u03b1s (x. )//s dD (x. )s \u2212\n\u03b1s (x. )b\u0304(x. )s ds\n(5.15)\n0\n\n0\n\nwhile by definition\nZ\nZ .\n\u0001 .\n\u0001\n\u0393\n\u0393\n\u0393\n\u03b1s d\u03bds (x. ) =\n\u03b1s (\u03bds\u0393 (x. ))//s\u03bd. (x. ) d D \u22121 (\u03bd \u0393 (x. )) s\n0\n\n(5.16)\n\n0\n\nwhere the superscript on the parallel translation symbol indicates that it is along\nthe paths \u03bd.\u0393 (x. ). Our identity follows.\nRemark 5.2.3 (1) For \u0393 such that the A-process is a \u0393 martingale we can easily see that \u0398 has an adapted inverse. Indeed its inverse is defined almost\nsurely by\nA\n\u0398\u22121 = D \u25e6 MartP \u25e6 D \u22121\nA\n\nwhere MartP denotes the operation of taking the martingale part under the\nprobability measure PA .\n\n(2) If we are given a connection \u0393 on E we could make our choice of A so that\nits diffusion process gives a \u0393 martingale. This specifies A uniquely and\nmight be more natural sometimes, for example in the classical case with\nM = Rn .\n(3) The results and earlier discussion still hold if \u0393 is not a metric connection.\nHowever then B.\u0393,A cannot be expected to be a Brownian motion. The connection could even be on T M rather than on E in which case B.\u0393,A will be a\nlocal martingale in Tx0 M. This will be a natural procedure when N = Rn ,\nusing the standard flat connection.\n\n\f5.3. CLASSICAL FILTERING\n\n91\n\n5.3 Classical Filtering\nFor an example of the situation treated above consider a signal process (zt , 0 6\nt 6 T ) on Rd satisfying an SDE\ndzt = V (zt , xt )dWt + \u03b2(zt , xt )dt\n\n(5.17)\n\nwith (xt , 0 6 t 6 T ), the observation process, taking values in Rn and satisfying:\ndxt = X (1) (xt )dBt + X (2) (xt )dWt + b(zt , xt )dt.\n\n(5.18)\n\nHere B. and W. are independent Brownian motions of dimension q and p respectively. We then take N = Rd \u00d7Rn and M = Rn , with p : N \u2192 M the projection.\nWe set ut = (zt , xt ) so that\nBf (z, x) =\n\n1 2\nD f (V i (z, x), V i (z, x)) + D1 f (\u03b2(z, x))\n2 1,1\n2\n2\n+ 21 D2,2\nf (X (1),i (x), X (1),i (x)) + 21 D2,2\nf (X (2),j (x), X (2),j (x))\n2\ni\n+D2 f (z, x)(b(z, x)) + D1,2 f (z, x)(V (z, x), X (1),i (z, x))\n\n(5.19)\nusing the repeated summation convention where i goes from 1 to p and j from 1\nto q, with the V j referring to the components of V and similarly for X (1),i and\n2\nX (2),j . Also Dl,m\nrefers to the second partial Frechet derivative, mixed if l 6= m,\netc.\nThe filtering problem would be to find E{g(zt) | xs : 0 6 s 6 t} for suitable\ng : Rd \u2192 R. This would fit in with the discussion above by defining f : Rd \u00d7\nRn \u2192 R by f (z, x) = g(z). Note that we have allowed feedback from the signal\nto the observation; usually only the special case where V and \u03b2 are independent\nof x is considered. Also we have allowed the noise driving the signal to also affect\nthe observations (\"correlated noise\"). This can give a non-trivial connection, in\nwhich case the terms involving horizontal derivatives of f will not vanish even for\nf independent of x. This vanishing would occur otherwise (i.e. for uncorrelated\nnoise) so that in that case the formula in Theorem 5.1.2 reduces to the usual DMZ\nequation, for example as in [56] or [57].\nOur basic assumptions are smoothness of the coefficients, non-explosion (for\nsimplicity of exposition), and the cohesiveness of our observation process. By the\nlatter we mean that for all x \u2208 Rn and z \u2208 Rd the image of the map (e1 , e2 ) 7\u2192\nX 1 (x)(e1 ) + X 2 (X)(e2 ) from Rq \u00d7 Rp to Rn contains b(z, x) and has dimension\nindependent of x. Some bounds are needed on b to ensure the existence of its\nconditional expectations.\n\n\f92 CHAPTER 5. FILTERING WITH NON-MARKOVIAN OBSERVATIONS\nTo carry out the procedure for the signal and observation given above we must\nfirst identify the horizontal lift operator determined by B. For this for each x \u2208 M\nlet Yx : Rn \u2192 Rp+q be the inverse of the restriction of the map (e1 , e2 ) 7\u2192\nX 1 (x)(e1 )+X 2 (X)(e2 ), from Rq \u00d7Rp to Rn , to the orthogonal complement of its\nkernel. Then from Lemma 2.2.1 we see that the horizontal lift hu : Rn \u2192 Rd \u00d7Rn\nis given by\nhu (v) = (V (z, x) \u25e6 Yx (v), v) u = (z, x) \u2208 Rd \u00d7 Rn .\n\n(5.20)\n\nA natural choice of A is\n\u0001 1 2\n\u0001\n1 2\nA(f )(x) = D2,2\nf X (1),i (x), X (1),i (x) + D2,2\nf X (2),j (x), X (2),j (x) .\n2\n2\nHaving done that the 'b' of our general discussion is just the drift b : Rd \u00d7 Rn \u2192\nRn of our observation's stochastic differential equation. Moreover for suitable\nT \u2217 M-valued processes \u03b1. we have the \u03b1-innovations process\nIt\u03b1\n\n=\n\nZ\n\nt\n\n\u03b1(xs ) X\n\n(1)\n\n(xs )dBs + X\n\n(2)\n\n\u0001\n\n(xs )dWs +\n\n0\n\nZ\n\n0\n\nt\n\n\u0001\n\u03b1(xs ) b(zs , xs ) \u2212 b\u0304(x)s ds,\n\nwhere b\u0304(\u03c3) = EB {b(zs , xs ) | xr = \u03c3r 0 6 r 6 s}.\nFrom Theorem 5.9 , Kushner's formula , given smooth g : Rd \u2192 R, one has\n\u03c0t g = g(z0 ) +\n\nRt\n0\n\n\u0001\n2\ng(\u2212)(V i (\u2212), V i (\u2212)) + \u03c0s D1 g(\u2212)(\u03b2(\u2212)) ds\n\u03c0s 21 D1,1\n\u0001\n\u03c0s dg(\u2212)V (\u2212)\u25e6Y\n \u0304 \u2212\u1e21 b\u0304 ,\u2212i\nhgb\n+ It s s s x s .\n+It\n\nThis can be compared, for example, with the formula given in the remark on page\n85 of [57], following the proof of Proposition 2.2.5 there. Alternatively see [56].\nUsing the standard flat connection of Rn we get the innovations process given by\n\u03bdt = x0 +\n\nZ\n\n0\n\nt\n\nX\n\n(1)\n\n(xs )dBs + X\n\n(2)\n\n\u0001\n\n(xs )dWs +\n\nZ\n\n0\n\nt\n\n\u0001\nb(zs , xs ) \u2212 b\u0304(x)s ds.\n\n\f5.4. EXAMPLES\n\n93\n\n5.4 Examples\nConsider the stochastic partial differential equation on L2 ([0, 1]; Rp):\ndut(x) = \u2206ut (x) +\n\nm\nX\n\n\u03a6i (x, ut (x))dBti\n\ni=1\n\nwhere (Bti ) are independent Brownian motions. For p > 1 it can be considered\nas a system of equations. One natural question is to find the law of ut given that\nof us (x0 ), 0 6 s 6 t for some given point x0 , or to find the conditional law of ut\ngiven us (x0 ), 0 6 s 6 t. Here we indicate briefly how the approach we have been\nfollowing may sometimes be applied to this or similar problems. For simplicity\nwe take p = 1, so our \"observations\" process is one dimensional; M = R.\nLet yt = ut (x0 ). It satisfies:\ndyt = (\u2206ut )(x0 )dt +\n\nm\nX\n\n\u03a6i (x0 , yt )dBti .\n\ni=1\n\nBecause of the drift term we cannot expect this to be Markovian so we will have\nto remove the term (\u2206ut )(x0 )dt by a Girsanov transformation.\nLet (ei ) be the standard orthonormal base of Rm . Define\n\u03a6 : L2 ([0, 1]; R) \u00d7 Rm \u2192 L2 ([0, 1]; R)\nand\n\u03a6\u0303 : R \u2192 L(Rm; R)\nby\n\u03a6(u)(e)(x) =\n\nm\nX\ni=1\n\nand\n\u03a6\u0303(z)(e) :=\n\nm\nX\ni=1\n\n\u03a6i (x, u(x))he, ei i\n\n\u03a6i (x0 , z)he, ei i,\n\nrespectively. Consider Tz R, identified with R and furnished with the metric induced by \u03a6\u0303(z):\nv1 v2\n.\nhv1 , v2 iz = Pm\n2\n(\n\u03a6\u0303\n(z))\ni\ni=1\n\n\f94 CHAPTER 5. FILTERING WITH NON-MARKOVIAN OBSERVATIONS\nTo have cohesivity and to be able to apply the Girsanov-Maruyama-CameronMartin theorem this must be well defined, i.e. the denominator must never vanish,\nand it must determine a non-explosive Brownian motion. If these conditions hold,\nwe still have to be sure that the Girsanov transformed S.P.D.E has solutions existing for all time and that we can apply the martingale method approach used in\nthe proof of 9.1.3. Alternatively we can try to apply one of the standard tests to\nshow that the local martingale which arises is a true martingale. First we apply\nLemma 2.2.1 to obtain the horizontal lift map. For this we need the dual map\n\u03a6\u0303\u2217 (z) : R \u2192 Rm is given by:\nm\nX\n1\n\u03a6 (z)(1) = Pm\n\u03a6j (x0 , z)ej .\n2\ni=1 (\u03a6i (x0 , z)) j=1\n\u2217\n\nThen from equation (2.8) the horizontal lift hu : Tu(x0 ) R \u2192 L2 ([0, 1]; R) at a\nfunction u is given by\nhu (1)(x) = \u03a6(x, u(x)) \u25e6 \u03a6\u0303\u2217 (u(x0 )).\nIn particular a natural choice of drift bh to remove by the Girsanov-MaruyamaCameron-Martin theorem, namely bh (u) = hu (\u25b3u(x0 )), is given by\nPm\nj=1 \u03a6j (x0 , u(x0 ))\u03a6j (x0 , u(x))\nPn\n\u25b3u(x0 ).\n(5.21)\nbh (u)(x) =\n2\nk=1 (\u03a6k (x0 , u(x0 )))\n\nMaking the change of probability to P\u0303 we see that our SPDE becomes\nPm\nm\nX\nj=1 \u03a6j (x0 , ut (x0 ))\u03a6j (x, ut (x))\nPn\ndut (x) = \u2206ut (x)\u2212\n\u25b3u\n(x\n)+\n\u03a6i (x, ut (x))dB\u0303ti\nt 0\n2\n(\u03a6\n(x\n,\nu\n(x\n)))\nk 0\nt 0\nk=1\ni=1\nfor new, independent Brownian motions B\u0303 1 , ...B\u0303 m and has the decomposition\nPm\nj=1 \u03a6j (x0 , ut (x0 ))\u03a6j (x, ut (x))\nPn\n\u03a6i (x0 , ut (x0 ))B\u0303ti ]\ndut (x) = [\n2\nk=1 (\u03a6k (x0 , ut (x0 )))\n!\nPm\nj=1 \u03a6j (x0 , ut (x0 ))\u03a6j (x, ut (x))\nPn\n\u25b3ut(x0 ) dt\n+[ \u25b3ut(x) \u2212\n2\nk=1 (\u03a6k (x0 , ut (x0 )))\n!\nPm\nm\nX\nj=1 \u03a6j (x0 , ut (x0 ))\u03a6j (x, ut (x))\nPn\n+\n\u03a6i (x, u(x)t ) \u2212\n\u03a6i (x0 , ut (x0 )) dB\u0303ti ].\n2\n(\u03a6\n(x\n,\nu\n(x\n)))\nk\n0\nt\n0\nk=1\ni=1\n\n\f5.4. EXAMPLES\n\n95\n\nIn this decomposition the term in the first square brackets relates to the horizontal\nlift of the A-process , while that in the second is the vertical component. They are\nindependent (under P\u0303), given u at x0 .\nWe could continue by applying the Kallianpur -Striebel formula, Lemma 5.1.1\nor go directly to our version of Kushner's formula, Theorem 5.9. In that formula\nthe operator B will be the infinite dimensional diffusion operator on L2 ([0, 1]; R)\nwhich is the generator of the solution of our SPDE, so there are extra analytical\nproblems. However there are cases where the situation is fairly straightforward.\nFor example:\n(1) \u03a6i (z, u) = \u03c6i (z), where the vector {\u03c61 (z), . . . , \u03c6m (z)} never vanishes for\nany z. In this case yt is basically Gaussian.\n(2) \u03a6(z, u) = u with one dimensional noise Bt , in which case the solution of\nthe SPDE is ut (x) =\n\n2\n\n2\n\nt\nx\n\u221a 1 e\u2212 2t eBt \u2212 2\n2\u03c0t\n\n.\n\n\f96 CHAPTER 5. FILTERING WITH NON-MARKOVIAN OBSERVATIONS\n\n\fChapter 6\nThe Commutation Property\nIn certain cases the filtering is in a sense trivial: the process decomposes into the\nobservable and an independent process. From the geometric point of view this\nmeans the commutation of the vertical operator B V and the horizontal operator\nAH . See Theorem 6.2.8 below.\nFor p a Riemannian submersion (defined in Chapter 7 below) with totally geodesic\nfibres and B the Laplacian, Berard-Bergery & Bourguignon [7] show that AH and\nBV commute. Their proof is based on the result of R.Hermann [37]\nTheorem 6.0.1 [R.Hermann] A Riemannian submersion p : N \u2192 M has totally\ngeodesic fibres iff the Laplace-Beltrami operator of N commutes with all Lie\nderivations by horizontal lifts of vector fields on M.\nFrom this, and the H\u00f6rmander form representation of AH , it follows immediately\nthat AH with BV will commute in their situation. In this section we consider some\nextensions of this and their consequences.\nFirst, for p : N \u2192 M with a diffusion operator B over a cohesive A, as usual,\nwe will say that a vector field on N is basic if it is the horizontal lift of a section of E. From our H\u00f6rmander form representation of AH we get the following\nextension of Berard-Bergery& Bourguignon's result:\nTheorem 6.0.2 For a diffusion operator B over a cohesive diffusion operator A\nthe following are equivalent:\n\u2022 [i] BV commutes with all Lie derivations by smooth basic vector fields of\nN;\n\u2022 [ii]the operators B, BV , and AH commute (on C 4 functions);\n97\n\n\fCHAPTER 6. THE COMMUTATION PROPERTY\n\n98\n\n\u2022 [iii] the operator BV commutes with the horizontal lifts of the vector fields\nwhich appear in one H\u00f6rmander form representation of A.\nProof. It is clear that [i] implies [iii], and [iii] implies\nTo show [ii] implies [i]\nPm [ii].\nj\nA\nobserve that every section of P\nE has the form \u03c3 ( 1 \u03bb dfj ) since every one form\nj\nj\non M has can be written as m\n1 \u03bb dfj for \u03bb : M \u2192 R and fj : M \u2192 R and\nsome integer m. By definition\nconnection this shows that every basic vector\nPm jof the\nAH\nfield on N has the form 1 \u03bb \u1e57\u03c3 (p\u2217 dfj ). It will therefore suffice to show that\nH\nif [ii] holds then BV commutes with Lie differentiation by \u03bb\u1e57\u03c3 A (p\u2217 df ) for all\nsmooth \u03bb, f : M \u2192 R.\nFor this assume [ii] holds and take a smooth g : N \u2192 R. By definition of the\nsymbol and Remark 1.4.5:\n\u0010\n\u0011\n\u0010 H\n\u0011\nV\nAH \u2217\nV\nA\n\u2217\n2B dg \u03bb\u1e57\u03c3 (p df ) = 2\u03bb\u1e57B dg \u03c3 (p df )\n\u0001\n= \u03bb\u1e57BV AH (f \u1e57g) \u2212 f \u1e57AH (g) \u2212 gAH (f \u1e57)\n\u0001\n= \u03bb\u1e57 AH (f \u1e57)BV g \u2212 f \u1e57AH BV g \u2212 (Af )\u1e57BV g\nH\n\n= 2\u03bb\u1e57d(BV g)\u03c3 A (p\u2217 df )\nH\n\n= 2d(BV g)\u03c3 A (\u03bb\u1e57p\u2217 df )\nas required.\nFor the special case of an equivariant diffusion on a principal bundle as considered in Chapter 3 we can obtain a working criterion for commutativity: see also\nExample 6.2.12.\nCorollary 6.0.3 In the notation of Theorem 3.2.1 commutativity of BV and AH\nholds if and only if both \u03b1 and \u03b2 are constant along all horizontal curves. This\nholds if and only if AH (\u03b1i,j ) = 0 and AH (\u03b2 k ) = 0 for all i, j, k.\nProof. First note that each vector field A\u2217k commutes with all basic vector fields.\nIndeed if V is basic it is equivariant and so\n(Rexp tAk )\u22c6 (V ) = V\n\nt > 0.\n\nDifferentiating in t at t = 0 gives the required commutativity. Thus the operators\nLA\u2217k are invariant under flows of basic vector fields and so for BV to commute with\nbasic vector fields the coefficients \u03b1 and \u03b2 must be constant along their flows. By\n\n\f6.1. COMMUTATIVITY OF DIFFUSION SEMIGROUPS\n\n99\n\nthe theorem this gives the first result since any horizontal curve can be considered\nas an integral curve of a (possible time dependent) basic vector field.\nClearly, from the H\u00f6rmander form of AH , if this holds both \u03b1 and \u03b2 are AH harmonic. The converse holds since from above AH commutes with all of the\nvertical vector fields L\u2217Ak .\nThe Corollary is applied to derivative flows in Example 6.2.12 of Section 6.2\nbelow.\nHermann proved that a Riemannian submersion with totally geodesic fibres\nhas the natural structure of a fibre bundle with group the isometry group of a\ntypical fibre.\nTheorem 6.0.4 (Hermann) If N is a complete Riemannian manifold and \u03c6 :\nN \u2192 M is a C \u221e Riemannian submersion then \u03c6 is a locally trivial fibre space.\nIf in addition the fibres of \u03c6 are totally geodesic submanifolds of N, \u03c6 is a fibre\nbundle with structure group the Lie group of isometries of the fibre.\nAn analogous result given the hypothesis of theorem 6.0.2 together with some\ncompleteness and hypoellipticity conditions is proved in Theorem 6.2.8 below.\nBefore that we consider when the associated semi-groups commute.\n\n6.1 Commutativity of Diffusion Semigroups\nIt is well known that in general the commutativity of two diffusion generators (on\nC 4 functions) does not imply that of their associated semi-groups. One reference\nis [61] page 273 where an example they ascribe to Nelson is given. Here is a\nminor modification of that construction:\nCut R2 along the positive x-axis. Take a copy A, say, of (0, \u221e) \u00d7(\u2212\u221e, 0] and\nglue it along the cut to the upper part of the cut plane, identifying (0, \u221e) \u00d7 {0} in\nA with the positive x-axis. Similarly glue a copy ,B, of (0, \u221e) \u00d7 (0, \u221e) along the\ncut to the lower part of the cut plane. This gives a version of the plane but with\ntwo copies of the upper and lower quadrants, and with the origin missing. On this\n\u2202\n\u2202\nwe have naturally defined vector fields X 1 given by \u2202x\nand X 2 given by \u2202y\n. These\ncertainly commute. However their associated semi-groups do not, as can be seen\nby starting at the point (\u22121, \u22121) moving along the X1 -trajectory for time 2 and\nthen along the X 2 trajectory for the same amount of time. We end up at the point\n(1, 1) of copy B. However if we had changed the order of the vector fields we\nwould be at (1, 1) of copy A. A more geometrically satisfying construction would\n\n\f100\n\nCHAPTER 6. THE COMMUTATION PROPERTY\n\nbe, as Nelson, to use the double covering of the punctured plane as state space\nwith similarly behaved vector fields. Here is an easy positive result:\nProposition 6.1.1 Let A1 and A2 be diffusion operators with associated semigroups {Pt1}t>0 and {Pt2 }t>0 acting as strongly continuous semi-groups on a Banach space E of functions which contains the C 2 functions with compact support.\nLet G1 and G2 be the corresponding generators , (closed extensions of the restrictions of A1 and A2 to the space of C 2 functions with compact support). Assume\nthere is a core C2 for G2 consisting of bounded C \u221e functions such that for f \u2208 C2 :\n[i] For all t > 0 the function Pt1 f is C 4 .\n[ii] A2 1t (Pt1 f \u2212 f ) is uniformly bounded in t \u2208 (0, 1) and in space, and it\nconverges pointwise to A2 A1 Pt1 f as t \u2192 0+.\n[iii] A2 Pt1 f is uniformly bounded in t \u2208 (0, 1) and in space.\nThen commutativity of Pt1 with Ps2 , 0 6 s, 0 6 t follows from commutativity of\nA1 with A2 on C 2 functions. Moreover if this holds the semi-group {PtA1+A2 }t>0\nassociated to A1 + A2 satisfies\nPtA1 +A2 = Pt1 Pt2 .\nProof. Let f : M \u2192 R be in C2 .\nWe show first that\nA2 Pt1 f = Pt1 A2 f\n\n(6.1)\n\nFor this set Vt = A2 Pt1 f . Then, by hypothesis [ii],\n\u2202\nVt = A2 A1 Pt1 f\n\u2202t\n= A1 Vt\n\n(6.2)\n\nby commutativity. By assumption [ii] we know Vs is bounded uniformly in s \u2208\n[0, t] for any t > 0. However there is a unique C 2 and uniformly bounded solution,\nP 1 V0 , to any diffusion equations such as (6.2) with given smooth bounded initial\ncondition V0 (as is easily seen by the standard use of It\u00f4's formula applied to Vt\u2212s\nacting on a diffusion process with generator A1 ). This gives\nA2 Pt1 f = Pt1V0 = Pt1 A2 f\n\n\f6.2. CONSEQUENCES FOR THE HORIZONTAL FLOW\n\n101\n\nas required. Now suppose f \u2208 Dom(G2 ). By assumption there is a sequence\n{fn }n of functions in C2 converging in G2 -graph norm to f . Then Pt1 A2 fn \u2192\nPt1 G2 f and Pt1 fn \u2192 Pt1 f . Equation (6.1) therefore shows that Pt1 f \u2208 Dom(G2 )\nand we have\nG2 Pt1 \u2283 Pt1 G2 .\n(6.3)\n\nNext, for f \u2208 Dom(G2 ), and our fixed t > 0 set Ws = Pt1 Ps2 f . Since the\n2\nconvergence of 1\u01eb {Ps+\u01eb\nf \u2212 Ps2 f } to G2 Ps2 f is in E we see, using equation (6.3),\n\u2202\nWs = Pt1 G2 Ps2 f = G2 Pt1 Ps2 f = G2 Ws\n\u2202s\n\nsince Ps2 f \u2208 Dom(G2 ). In particular Ws \u2208 Dom(G2 ).\nAlthough now it is not clear that W is C 2 we see from this that\nfor 0 < u < s, giving\n\n\u2202\nP 2Ws\u2212u\n\u2202u u\n\n=0\n\nPt1 Ps2f = P02 Ws = Ps2 W0 = Ps2 Pt1 f\nfor 0 6 s 6 t. For s > t it is now only necessary to use the semigroup property\nof P 2 , to commute with Pt1 portion by portion.\nFinally since Pt2 f \u2208 Dom(G2 ) the above gives\n\u2202 1 2\nP P f = A1 Pt1 Pt2f + Pt1 A2 Pt2 f\n\u2202t t t\n= (A1 + A2 )Pt1 Pt2 f\nand we can repeat the second arguement showing uniqueness of solutions of the\ndiffusion equation to obtain PtA1 +A2 f = Pt1 Pt2 f .\nRemark 6.1.2 Condition [i] does not always hold. A simple example is when the\n\u22022\nstate space is R2 \u2212 {(0, 1)} and the operator is \u2202x\n2 . The standard positive result\nn\nfor degenerate operators on R is due to Ole\u01d0nik, [54].\n\n6.2 Consequences for the Horizontal Flow\nFor our standard set up of p : N \u2192 M with diffusion operator B over a cohesive\nA, let P V and P H denote the semi-groups generated by the vertical and horizontal\ncomponents of B, and let pVt (u, \u2212), t 6 0, u \u2208 N, be the transition probabilities of\nP V . If we set Nx = p\u22121 (x) for x \u2208 M then pVt (u, \u2212) will be a probability measure\n\n\fCHAPTER 6. THE COMMUTATION PROPERTY\n\n102\n\n+\n+\non Np(u)\n, the union of Np(u) with \u2206. For and For PA\nx0 -almost all \u03c3 \u2208 Cx0 M for\neach x0 \u2208 M there are measurable maps\n\n//\u03c3t : Nx+0 \u2192 N\u03c3+t\nsuch that for each u \u2208 Nx0 the process (t, \u03c3) 7\u2192 //\u03c3t (u) is an AH -diffusion and\nis over \u03c3. These can be obtained, for example, by taking a stochastic differential\nequation, as equation (4.21),\ndxt = X(xt ) \u25e6 dBt + A(xt )dt\nfor our A-diffusion. Let Yx : Ex \u2192 Rm be the adjoint (and right inverse) of X(x),\neach x \u2208 M. Then consider the SDE on N\ndyt = X\u0303(yt )Y (\u03c3t ) \u25e6 d\u03c3t\nand let (t, \u03c3) 7\u2192 //\u03c3t be the restriction of its flow to Nx0 , augmented by mapping\nthe coffin state, \u2206, to itself. This SDE is canonical since it can be rewritten as\ndyt = hyt \u25e6 d\u03c3t\nfor h the horizontal lift map of Proposition 2.1.2.\nWe will often need to assume that the lifetime of this diffusion is the same as\nthat of its projection on M:\nDefinition 6.2.1 The semi-connection induced by B is said to be stochastically\ncomplete if\nCup0 M + := {\u03c3 : [0, \u221e) \u2192 M + : lim p(ut ) = \u2206 when \u03b6(u) < \u221e}\nt\u2192\u03b6\n\nH\n\nhas full PA\nu0 measure for each u0 \u2208 N or equivalently if the lifetimes satisfy\n\u03b6(u) = \u03b6(p(u))\nH\n\nfor PA\nu0 -almost all paths u.\nThe semi-connection is said to be strongly stochastically complete if also we\ncan choose a version of //\u03c3t : N\u03c3(0) \u2192 N\u03c3(t) which is a smooth diffeomorphism\nwhenever \u03c3(0) is a regular value of p and t < \u03b6(\u03c3).\nNote that strong stochastic completeness of the connection will hold whenever\nthe fibres of p are compact by the basic properties of the domains of local flows of\nSDE, [43], [21]. This also holds if the stochastic horizontal differential equation\nis strongly p-complete in the sense of Li [47] for p = dim(N) \u2212 dim(M).\n\n\f6.2. CONSEQUENCES FOR THE HORIZONTAL FLOW\n\n103\n\nProposition 6.2.2 Suppose the semi-groups P V and P H commute and stochastic\ncompleteness of the connection holds. Then the horizontal flow preserves the\nvertical transition probabilities in the sense that for all positive s and 0 < t < \u03b6(\u03c3),\n(//\u03c3t )\u2217 pVs (u0 , \u2212) = pVs (//\u03c3t (u0 , \u2212)\n\n(6.4)\n\nfor all u0 \u2208 N\u03c3 for PA -almost all \u03c3. Equivalently for any bounded measurable\nh : N \u2192 R we have PA -almost surely;\nPsV (h \u25e6 //\u03c3t ) (u0 ) = PsV h(//\u03c3t (u0 ))\n\n(6.5)\n\nProof. It suffices to show that given any finite sequence 0 6 t1 6 t2 6 * * * 6\ntk < t, bounded measurable fj : M \u2192 R, j = 1, ..., k and bounded measurable\nh : N \u2192 R, if u0 \u2208 Nx0 then\nEx0 {f1 (\u03c3t1 )...fk (\u03c3tk )\u03c7t<\u03b6(\u03c3) PsV (h \u25e6 //\u03c3t )(u0 )}\n= Ex0 {f1 (\u03c3t1 )...fk (\u03c3tk )\u03c7t<\u03b6(\u03c3) PsV (h)(//\u03c3t (u0 ))}.\n\n(6.6)\n\nwhere \u03c7Z denotes the indicator function of a set Z. To see this set f \u0303j = fj \u25e6 p :\nN \u2192 R. Then the left hand side of (6.6) is\nEx0 {f \u03031 (//\u03c3t1 (u0 ))...f \u0303k (//tk (u0 ))\u03c7t<\u03b6(\u03c3) PsV (h \u25e6 \u03c6t )(u0)}\n\u0010\n\u0011\n= Ex0 {PsV f \u03031 (//\u03c3t1 (u0 ))...f \u0303k (//\u03c3tk (u0 ))\u03c7t<\u03b6(\u03c3) h(//\u03c3t (u0 )) }\n\u0011\n\u0010\nH\nh\n(u0 )\n= PsV PtH1 f \u03031 ...PtHk \u2212tk\u22121 f \u0303k Pt\u2212t\nk\n\u0011\n\u0010\nH\nP V h (u0 )\n= PtH1 f \u03031 ...PtHk \u2212tk\u22121 f \u0303k Pt\u2212t\nk s\n\nwhich reduces to the right hand side of (6.6).\n\nRemark 6.2.3 Assuming strong stochastic completeness of our semi-connection\nlet {zt : 0 6 t < \u03b6(p(u.)} be a semi-martingale in N with p(zt ) = xt := p(ut ) :\n0 6 t < \u03b6(p(u.)). If x0 is a regular value of p we have the Stratonovich equation:\nd//t\u22121 zt = T //t\u22121 \u25e6 T //t\u22121 (hzt \u25e6 dxt )\n\n(6.7)\n\nwhere //t refers to //tx. . To see this, for example set bt = //t\u22121 zt and observe that\ndzt = d(//t bt ) = T //t \u25e6 dbt + h/t bt \u25e6 dxt .\n\n\fCHAPTER 6. THE COMMUTATION PROPERTY\n\n104\n\nNow assume that our induced semi-connection is strongly stochastically complete. For a regular value x0 of p and u0 \u2208 Nx0 define a process \u03b1u0 : [0, \u221e) \u00d7\nCu0 N + \u2192 Nx+0 by\np(u) \u22121\n\n\u03b1tu0 (u) = \u03b1t (u) = (//t\n\n) ut\n\n(6.8)\n\nif u \u2208 Cuo N with t < \u03b6(u) and define \u03b1tu0 (u) = \u25b3 if t > \u03b6(u). Note that \u03b1t may\nnot go out to infinity in Nx0 as t increases to its extinction time.\nAlso define\n//s\u2217 (BV )(f ) = BV (f \u25e6 //s ) \u25e6 //t\u22121\nto obtain a random time dependent diffusion operator //s\u2217 (BV ) on each fibre over\na regular value of p.\nLemma 6.2.4 In the notation of equation (4.23) we have the It\u00f4 equation for\n\u03b1t := \u03b1tu0 :\n\u2207V\n\nd\u03b1t = T //t\u22121 V (//t \u03b1t )dWt + T //t\u22121 V 0 (//t \u03b1t )dt.\n\nIn particular for f : N \u2192 R in C 2\nMtdf,\u03b1\n\n:= f (\u03b1t ) \u2212\n\nZ\n\n0\n\n(6.9)\n\nt\n\n//s\u2217 (BV )(f )(\u03b1s )ds\n\n(6.10)\n\nis a local martingale.\nProof. Formula ( 6.9) is immediate from equations (4.23) and (6.7). That M.df,\u03b1\nis a local martingale follows immediately using the properties of pull-backs under diffeomorphisms of Lie derivatives when V is C 1 , and by going to local coordinates otherwise.\nLemma 6.2.5 At all points above regular values of p we have:\nd\nE{//s\u2217 (BV )}|s=0 = [AH , BV ]\nds\nProof. This is an exercise in the use of Ito's formula. For example write A in the\nH\u00f6rmander form\nm\n1X\nLX j LX j + L0X\nA=\n2 j=1\n\n\f6.2. CONSEQUENCES FOR THE HORIZONTAL FLOW\n\n105\n\nso that //s is the flow of the SDE\ndzs =\n\nm\nX\nj=1\n\nfj (zs )dB j + X\nf0 (zs )\nX\n\nusing the horizontal lifts of the vector fields X j . From the Ito formula in lemma\n9B Chapter VII of [21] we have\nm\n\nd\n1 X d2 j \u2217 V\nd 0 \u2217 V\nE{//s\u2217(BV )}|s=0 =\n(/\n/\n)\n(B\n)}|\n+\n(// ) B |s=0\ns=0\ns\nds\n2 j=1 ds2\nds s\nfj . Since\nwhere //i is the flow of the vector field X\n\nd j\n(// ) \u2217 (BV ) = [LXfj , (//sj )\u2217 BV ]\nds s\n\nwe have the result.\nDefinition 6.2.6 For a regular value x0 of p. We say BV is stochastically holonomy invariant at x0 if on Nx0 we have //t\u2217 (BV ) = BV for all 0 6 t < \u03b6 x. with\nprobability one. If this holds for all all regular values x0 then we say BV is\nstochastically holonomy invariant. Similarly we say B V is holonomy invariant\nat x0 if the corresponding result holds for parallel translation along any piecewise\nC 1 curve starting at x0 in M, and is holonomy invariant if this holds for all regular\nvalues x0 .\nRemark 6.2.7\n1. If the A-diffusion on M is represented by a stochastic differential equation we can lift that equation to N and obtain a local flow\n\u03b7tH : 0 6 t < \u03b6 H (\u2212) where \u03b6 H (y) : y \u2208 N gives its explosion times;\nso that with probability one \u03b7 t is defined and smooth on the open set {y \u2208\nN : t 6 \u03b6 H (y), see [43] or [21]. We can say that BV is invariant under the\nhorizontal flow if for all C 2 functions f : N \u2192 R we have\nBV (f ) \u25e6 \u03b7t = BV (f \u25e6 \u03b7t )\n\non {y \u2208 N : t 6 \u03b6 H (y), almost surely, for all t > 0. This does not require\nstrong stochastic completeness of the semi-connection, nor do we have to\nrestrict attention to fibres over regular values. On the other hand if it holds,\nand given such strong stochastic completeness, if x0 is a regular value it\nfollows that Nx0 lies in {y \u2208 N : t 6 \u03b6 H (y) for all t < \u03b6 M (x0 ) and that we\nhave stochastic holonomy invariance at x0 .\n\n\f106\n\nCHAPTER 6. THE COMMUTATION PROPERTY\n\n2. Assume completeness of the semi-connection. If A satisfies the standard\nH\u00f6rmander condition, or more generally if the space D 0 (x0 ), as in Section\n2.6 is all of M, then holonomy invariance at x0 implies holonomy invariance. This follows since concatenation of paths gives composition of the\ncorresponding parallel translations and the conditions imply that any two\npoints can be joined by a smooth path with derivatives in E. Moreover\nby Theorem 2.6.1 every point is a regular value and so given also strong\nstochastic completeness of the connection from the theorem below we see\nthat holonomy invariance of B V at one point implies it is invariant under the\nhorizontal flow induced by any SDE on M which gives one point motions\nwith generator A. The same holds for stochastic holonomy invariance: see\nTheorem 6.2.8 below.\nTheorem 6.2.8 Suppose the induced semi-connection is complete and strongly\nstochastically complete, and x0 is a regular value of p. Then the following are\nequivalent:\n[ix0 ] For all u0 \u2208 Nx0 and for any F \u03b1 -stopping time \u03c4 with \u03c4 (\u03b1(u)) < \u03b6(p(u)),\nthe process {\u03b1t : 0 6 t < \u03c4 } is independent of F x0 ;\n[iix0 ] BV is stochastically holonomy invariant at x0 ;\n[iiix0 ] BV is holonomy invariant at x0 ;\n[ivx0 ] BV and AH commute at all points of D 0 (x0 );\n[vx0 ] P.V and P.H commute at all points of D 0 (x0 ).\nIf the above hold at some regular value x0 they hold for all elements in D 0 (x0 ).\nMoreover \u03b1.u0 is a Markov process on Nx0 with generator BV .\nProof. We will show that [ix0 ] is equivalent to [iix0 ] which implies [ivx0 ]. Then\n[iv] implies [iiiy] for all y \u2208 D 0 (x0 ) which implies [v]. Finally we show [v]\nimplies [iiy] for all y \u2208 D 0 (x0 ).\nAssume [ix0 ] holds. Let f : Nx0 \u2192 R be smooth with compact support.\nThen the local martingale M df,\u03b1 given by formula (6.10) is a martingale and from\nequation (6.9) we see that\nE{M df,\u03b1 |F x0 } = f (u0 ).\n\n\f6.2. CONSEQUENCES FOR THE HORIZONTAL FLOW\n\n107\n\nTherefore for Px0 -almost all \u03c3 in Cx0 M\nE{f (\u03b1t )} = E{f (\u03b1t)|p(u. ) = \u03c3} = f (u0 ) +\n\nZ\n\n0\n\nt\n\nE{(//s\u03c3 )\u2217 (BV )(f )(\u03b1s )}ds.\n\n(6.11)\nAlso, in the notation of equation (6.9), with the obvious notation for the filtrations\ngenerated by our processes, we have Ft\u03b1. \u2282 FtW. \u2227 Ftx0 and FtW. \u2282 Ft\u03b1. \u2227 Ftx0\nso our assumption implies that FtW. = Ft\u03b1. , for all positive t, after stopping W.\nat the explosion time of \u03b1. . From this, and equation (6.9) we see that if we set\nM\u0304tdf,\u03b1 = E{Mtdf,\u03b1 |F \u03b1t } we obtain a martingale with respect to F\u2217\u03b1 and\nZ t\ndf,\u03b1\nf (\u03b1t ) = M\u0304t +\n//s\u2217 BV (f )(\u03b1s )ds\n(6.12)\n0\n\nwhere //s\u2217 BV = E{//s\u2217BV }. Thus by the usual martingale characterisation of\nMarkov processes we see that \u03b1. is Markov with (possibly time dependent) generator //s\u2217 BV at time s. However equation (6.11) then implies, for example by\n[62] Proposition(2.2), Chapter VII, that the generator is given by (//s\u03c3 )\u2217 (BV ) for\narbitrary \u03c3 in a set of full measure in Cx0 M. Thus [ix0 ] implies the stochastic\nholonomy invariance [iix0 ].\nConversely if [iix0 ] holds, equation (6.10) gives\nZ t\ndf,\u03b1\nf (\u03b1t ) = Mt +\nBV (f )(\u03b1s )ds.\n0\n\nThen M.df,\u03b1 is an F\u2217\u03b1. -martingale and again we see that \u03b1. is Markov, with generator BV . It is therefore independent of x. giving [ix0 ]. Moreover, in an obvious\nnotation, if 0 6 s 6 t, by the flow property of parallel translations, on Nx0 ,\nBV = //t\u2217 (BV ) = //s\u2217 (//ts )\u2217 (BV ),\nand so, almost surely, at all points of Nxs we have\n(//ts )\u2217 (BV ) = (//s\u2217 )\u22121 BV = BV .\n\u2217\nSince (//ts )\u2217 (BV ) has the same law as //t\u2212s\n(BV )and is independent of Fsx0 this\nA\nshows that [iiy] holds for ps (x0 , \u2212)-almost all y \u2208 M for all s > 0.\nOn the other hand [iiy] implies that BV and A commute on Ny by Lemma\n6.2.5. Thus by continuity of [BV , AH ], and the support theorem we see that [iix0 ]\nimplies [iv].\n\n\f108\n\nCHAPTER 6. THE COMMUTATION PROPERTY\n\nFurthermore as in Theorem 6.0.2 we see that [iv] implies that BV commutes\nwith basic vector fields at all points over D 0 (x0 ). From this the holonomy invariance [iiiy] holds for all y \u2208 D 0 (x0 ).\nNow assume [iiix0 ] and so by Remark 6.2.7(2.) we have [iiiy] for all y \u2208\n0\nD (x0 ). Since //t\u03c3 (u0 ) stays above D 0 (x0 ) for any suitable piecewise smooth \u03c3\nwe find the solution to the martingale problem of BV for any point u0 of Nx0 is\nholonomy invariant at u0 , i.e. along piecewise smooth curves \u03c3 in M starting at\nx0 ,\nPtV (f \u25e6 //s\u03c3 \u2212)(u0 ) = PtV (f )(//s\u03c3 u0 ).\nBy Wong-Zakai approximations we see that stochastic holonomy invariance\nV\nof P B holds over x0 and hence on taking expectations we get [vx0 ]. As observed\nwe also get [vy] for all y \u2208 D 0 (x0 ) and hence by continuity for all y \u2208 D 0 (x0 ).\nThus [iiix0 ] implies [v].\nFinally assuming [v] we can apply Proposition 6.2.2, observing that the proof\nstill holds since it only involves points in D 0 (x0 ). Differentiating equation (6.5)\nin s at s = 0 gives the stochastic holonomy invariance [iiy] for all y \u2208 D 0 (x0 )\nRemark 6.2.9 From the proof and Theorem 6.0.2 we see that the stochastic completeness of the connection is not needed to ensure that [ivx0 ] and [iiix0 ] are equivalent.\nWe can now go further than our Theorem 2.6.1 in extending Hermann's result,\nTheorem6.0.1. For this we will need some extra hypoellipticity conditions to deal\nwith the case of non-compact fibres. Take a H\u00f6rmander form A corresponding to\na smooth factorisation\n\u03c3xA = X(x)X(x)\u2217\nwith X(x) \u2208 L(Rm : Tx M for x \u2208 M. Let H denote the usual Cameron -Martin\nm\nspace of finite energy paths H = L2,1\n0 ([0, 1]; R ). For h \u2208 H and x \u2208 M let\n\u03c6ht (x), 0 6 t 6 1 be the solution at time t \u2208 [0, 1] to the ordinary differential\nequation\n\u017c(t) = X(z(t))(\u1e23)\n(6.13)\nwith \u03c6h0 (x) = x. In particular we assume such a solution exists up to time t =\n1. For each x \u2208 M this gives a smooth mapping \u03c6\u2212\n1 (x) : H \u2192 M, namely\nh 7\u2192 \u03c6h1 (x). Let C h,x : Ex \u2192 Ex be the deterministic Malliavin covariance\noperator, see [9], given by\n\u2212\n\u2217\nC h,x = Th \u03c6\u2212\n1 (x)(Th \u03c61 (x)) .\n\n\f6.2. CONSEQUENCES FOR THE HORIZONTAL FLOW\n\n109\n\nh,x\nThen \u03c6\u2212\nis non1 (x) is a submersion in a neighbourhood of h if and only if C\ndegenerate. It is shown in [9] that this condition is independent of the choice of\nH\u00f6rmander form for A, and follows from the standard H\u00f6rmander condition that\nX 1 , . . . , X m and their iterated Lie brackets span Tx M when evaluated at the point\nx. A more intrinsic formulation of it can me made in terms of the manifold of\nE-horizontal paths of finite energy, as described in [52].\n\nTheorem 6.2.10 Consider a smooth map p : N \u2192 M with diffusion operator B\non N over a cohesive diffusion operator A. Suppose that the connection induced\nby B is complete. Also assume that D 0 (x) is dense in M for all x \u2208 M and that\neither the fibres of p are compact or that the solutions to equation (6.13) exist up\nto time 1 and there exists h0 \u2208 H and x0 \u2208 M such that C h0 ,x0 is non-degenerate.\nThen p : N \u2192 M is a locally trivial bundle.\nIf also B and AH commute we can take Nx0 , the fibre over x0 , to be the model\nfibre and choose the local trivialisations\n\u03c4 : U \u00d7 Nx0 \u2192 p\u22121 (U)\nto satisfy\n\u03c4 (x, \u2212)\u2217 (BV |Nx ) = BV |Nx0 .\nProof. The local triviality given compactness of the fibres is a special case of\nCorollary 2.6.3 so we will only consider the other case.\nFor this set y = \u03c6h1 0 (x0 ). Our assumption on the covariance operator together\nwith the smoothness of h 7\u2192 \u03c6h1 (x0 ) implies by the inverse function theorem that\nthere is a neighbourhood Uy of y in M and a smooth immersion s : Uy \u2192 H with\ns(x)\ns(y) = h0 and \u03c61 (x0 ) = x for x \u2208 Uy .\nWe know from Theorem 2.6.1 that p is a submersion so all its fibres are submanifolds of N. Define \u03c4Uy : Uy \u00d7Nx0 \u2192 p\u22121 (Uy ) by using the parallel translation\ns(x)\nalong the curves \u03c6t : 0 6 t \u2264 1 that is:\n\u03c6s(x)\n\n\u03c4Uy (x, v) = //1 .\n\n(v)\n\n(x, v) \u2208 (Uy \u00d7 Nx0 ).\n\n(6.14)\n\nFor a general point x of M we can find an x\u2032 \u2208 Uy \u2229 D 0 (x) and argue as in\nthe proof of Theorem 2.6.1 to obtain open neighbourhoods Ux of x in M and Ux\u2032 \u2032\nof x\u2032 in Ux0 and a fibrewise diffeomorphism of p\u22121 (Ux\u2032 \u2032 ) with p\u22121 (Ux ) obtained\nfrom parallel translations. This can be composed with a restriction of \u03c4Ux0 to give\na trivialisation near x. This proves local triviality. The rest follows directly from\nRemark 6.2.9 since our trivialisations came from parallel translations.\n\n\fCHAPTER 6. THE COMMUTATION PROPERTY\n\n110\nRemark 6.2.11 Set\n\nG(BxV0 ) = {\u03b1 \u2208 Diff(Nx0 ) : \u03b1\u2217 (BV |Nx0 ) = BV |Nx0 }.\n\n(6.15)\n\nThen assuming the commutativity in the theorem we can consider G(BxV0 ) as a\nstructure group for our bundle though unless the fibres of p are compact it is not\nclear if we have a smooth fibre bundle with this as group in the usual sense, since\nthis requires smoothness into G(BxV0 ) of the transition maps between overlapping\ntrivialisations. See the next section and Michor [51] section 13.\nNote that elements of G(BxV0 ) preserve the symbol of BV and so if that symbol\nV\nhas constant rank preserve the inner product induced on the image of \u03c3 B . In\nparticular if BV is elliptic they are isometries of the Riemannian structure induced\non the fibre Nx0 . This is the situation arising from Riemannian submersions as\nin Hermann's Theorem 6.0.4 and described in detail in Chapter 7 below. The\nspace of isometries of a Riemannian manifold with compact- open topology is\nwell known to form a Lie group, for example see [40]. However there appears\nto be no detailed proof that the same holds in degenerate cases even when the\nH\u00f6rmander condition holds at each point. When H\u00f6rmander's condition holds the\nCaratheodory metric on the manifold determines the standard manifold topology,\ne.g. see [52] Theorem 2.3, which is locally compact, and the group of isometries\nof a connected locally compact metric space is locally compact in the compactopen topology, see [40], Chapter 1, Theorem 4.7. Thus in this case G(BxV0 ) will\nbe locally compact.\nIn general preserving the possibly degenerate Riemannian structure determined\nby its symbol will not be enough to characterise G(BxV0 ). Even in the elliptic case\nthere may be a \"drift vector\" which needs to be preserved as well and this may lead\nto G(BxV0 ) being very small. For example if Nx0 is R2 and BV = 21 \u25b3 \u2212 |x|2 \u2202x\u2202 1\nthe group is trivial.\nExample 6.2.12\n1. As an example consider the situation described in Section 3.3 of the derivative flow of a stochastic differential equation (3.8) on\nM acting on the frame bundle GLM to produce a diffusion operator B on\nGLM. Assume that M is Riemannian and complete, and that the one point\nmotions are Brownian motions, so that A = 12 \u25b3 . Assume also that the\nconnection induced is the Levi-Civita connection. Then if B and AH commute, by Corollary co:equ-comm , we see that the co-efficients \u03b1 and \u03b2 of\nBV described in Theorem 3.3.1 must be constant along horizontal curves.\nHowever as pointed out in the proof of Corollary 3.4.8, the restriction of\n\n\f6.2. CONSEQUENCES FOR THE HORIZONTAL FLOW\n\n111\n\n\u03b1(u) for u \u2208 GLM to anti-symmetric tensors is essentially (one half of)\nthe curvature operator. It follows that the curvature is parallel , \u2207R = 0. In\nturn this implies, [40] page 303, that M is a local symmetric space and so\nif simply connected, a symmetric space. In Section 7.2 we show how such\nstochastic differential equations arise on any symmetric space. Also from\nExample 3.3 we see that the standard gradient SDE for Brownian motion\non spheres also give derivative flows with this property.\n2. For the apparently weaker property of commutativity for the derivative flow\nT \u03bet of our SDE (3.8) acting directly on the tangent bundle T M recall first\nthat if the generator A is cohesive (and even if it just happens that the symbol of A has constant rank, see [27]) then for vt = T \u03bet (v0 ) some v0 \u2208 Tx0 M\nwe have the covariant SDE\n \u0306 vt XdBt \u2212 1 Ric\n \u0306 # (vt )dt + \u2207\n \u0306 vt Adt.\nD\u0302vt = \u2207\n2\n\n(6.16)\n\nFrom this we see that if A is cohesive the process \u03b1. defined by \u03b1t =\n\u22121\n/\u02c6/t T \u03bet (v0 ) satisfies the SDE\n\u0012\n\u0013\n\u22121\n1  \u0306 # \u02c6\n\u02c6\n \u0306\n \u0306\nd\u03b1t = //t\n\u2207/\u02c6t \u03b1t XdBt \u2212 Ric (//t \u03b1t )dt + \u2207/\u02c6t \u03b1t Adt .\n2\nSuppose also that A = 0. We see that \u03b1. is independent of \u03be. (x0 ) if and only\n \u0306 \u2212 X and Ric\n \u0306 # are holonomy invariant. If M is Riemannian and the\nif both \u2207\nsolutions of the SDE are Brownian motions and the induced connection is\nthe Levi-Civita connection we can deduce, as above, using Theorem 6.2.8,\nthat commutativity of the the vertical and horizontal diffusions operators on\nT M holds only if M is locally symmetric .\n\n\f112\n\nCHAPTER 6. THE COMMUTATION PROPERTY\n\n\fChapter 7\nExample: Riemannian Submersions\n& Symmetric Spaces\n7.1 Riemannian Submersions\nRecall that when N and M are Riemannian manifolds a smooth surjection p :\nN \u2192 M is a Riemannian submersion if for each u in N the map Tu p is an\northogonal projection onto Tp(u) M, i.e. restricted to the orthogonal complement\nof its kernel it is an isometry. Note that if p : N \u2192 M is a submersion and\nM is Riemannian we can choose a Riemannian structure for N which makes p\na Riemannian submersion. If a diffusion operator B on N which has projectible\nsymbol for p : N \u2192 M is also elliptic its symbol induces Riemannian metrics\non N and M for which p becomes a Riemannian submersion. A well studied\nsituation is when p is a Riemannian submersion and B is the Laplacian, or 12 \u25b3N ,\non N. The basic geometry of Riemannian submersions was set out by O'Neill in\n[55]; he ascribes the term 'submersion' to Alfred Gray. In this section we shall\nmainly be relating the work of B\u0155ard-Bergery & Bourguignon [7], Hermann, [37],\nElworthy& Kendall, [24], and Liao, [48], to the discussion above. The book [33]\nshows the breadth of geometric structures which can be considered in association\nwith Riemannian submersions.\nA simple example of a Riemannian submersion is the map p : Rn \u2212 {0} \u2192 \u221e\ngiven by p(x) = |x|. Then, for n > 1, Brownian motion on Rn \u2212{0} is mapped to\nd2\nn\u22121 d\nthe Bessel process on (0, \u221e) with generator A = 12 dx\n2 + 2x dx . Thus in this case\n1\n1\n\u25b3 is projectible but its projection is not 2 \u25b3M . The well known criterion for\n2 N\nthe latter to hold is that p has minimal fibres as we show below. See also [21],and\n113\n\n\f114CHAPTER 7. EXAMPLE: RIEMANNIAN SUBMERSIONS & SYMMETRIC SPACES\n[48].\nTo examine this in more detail we follow Liao,[48].Suppose that p is a Riemannian submersion. The horizontal subbundle on N is just the orthogonal complement of the vertical bundle. Working locally take an orthonormal family of\nvector fields X 1 , . . . , X n in a neighbourhood of of a given point x0 of M. Let\nX\u0303 1 , . . . , X\u0303 n be their horizontal lifts to a neighbourhood of some u0 above x0 , and\nlet V 1 , . . . , V p be a locally defined orthonormal family of vertical vector fields\naround u0 . Then near u0 , using the summation convention over j = 1, . . . , n,\n\u03b1 = 1, . . . , p, we have\n\u25b3N = X\u0303 j X\u0303 j + V \u03b1 V \u03b1 \u2212 \u2207N\nX\u0303 j \u2212 \u2207V \u03b1 V \u03b1\nX\u0303 j\n\n(7.1)\n\nj\n\u25b3 M = X j X j \u2212 \u2207N\nXj X .\n\n(7.2)\n\nwhile\nHere \u2207M , \u2207N refer to the Levi-Civita connections on M and N, and we are\nidentifying the vector fields with the Lie differentiation in their directions.\nNow X\u0303 j X\u0303 j lies over X j X j while V \u03b1 V \u03b1 is vertical. Also the horizontal component of the sum \u2207V \u03b1 V \u03b1 at a point u \u2208 Nis the trace of the second fundamental\nform of the fibre Np(u) of p through u, denoted by TV \u03b1 V \u03b1 in O'Neill's notation,\nwhile 12 \u25b3N lies over \u2207X j X j by Lemma 1 of [55].\nThus we see that 12 \u25b3N is projectible if and only if the trace of the second\nfundamental form, trace T , of each fibre p\u22121 (x) is constant along the fibre in the\nsense of being the horizontal lift of a fixed tangent vector, 2A(x) \u2208 Tx M. If so\n1\n\u25b3 lies over 21 \u25b3M \u2212 A. In particular A = 0, or equivalently p maps Brownian\n2 N\nmotion to Brownian motion, if and only if p has minimal fibres.\nIn general to relate to the discussion in Section 2.4 we can set bH (u) =\n\u2212 21 trace T (u), with b(u) = Tu pbH (u) in Tp(U ) M. Let \u25b3V be the vertical operator on N which restricts to the Laplacian on each fibre, and let \u25b3H be the\nhorizontal lift of 21 \u25b3M . Our decomposition in Theorem 2.4.6 becomes\n1\n\u25b3N =\n2\n\n\u0012\n\n1 H 1\n\u25b3 \u2212 trace T\n2\n2\n\n\u0013\n\n1\n+ \u25b3V\n2\n\n(7.3)\n\nsince the vertical part of \u2207V \u03b1 V \u03b1 is just \u2207VV \u03b1 V \u03b1 where \u2207V refers to the connection\non the vertical bundle which restricts to the Levi-Civita of the fibres, and also the\nvertical part of X\u0303 j X\u0303 j vanishes because by Lemma 2 of [55] the vertical part of\nX\u0303 j X\u0303 k is the vertical part of 12 [X\u0303 j , X\u0303 k ].\n\n\f7.2. RIEMANNIAN SYMMETRIC SPACES\n\n115\n\n7.2 Riemannian Symmetric Spaces\nLet K be a Lie group with bi-invariant metric and let M be a Riemannian manifold\nwith a symmetric space structure given by a triple (K, G, \u03c3). This means that there\nis a smooth left action K \u00d7 M \u2192 M, (k, x) 7\u2192 Lk (x) of K on M by isometries\nsuch that if we fix a point x0 of M and define p : K \u2192 M by p(k) = Lk (x0 ) then\np is a Riemannian submersion and a principal bundle with group the subgroup\nKx0 of K which fixes x0 . Write G for Kx0 . Thus M is diffeomorphic to K/G.\nMoreover if g denotes the Lie algebra of G, and k that of K, (identified with the\ntangent spaces at the identity to G and K respectively), there is an orthogonal and\nadG - invariant decomposition\nk=g+m\nwhere m is a linear subspace of Tid K. Further \u03c3 is an involution on K and g\nand m are, respectively, the +1 and the \u22121 eigenspaces of the involution on Tid K\ninduced by \u03c3. See Note 7, page 301, of Kobayashi & Nomizu Volume I, [40], for\ndefinitions and basic properties, and Volume II, [41], for a detailed treatment.\nWe shall also let \u03c3 denote the involutions induced by \u03c3 on k and on M, and by\ndifferentiation on T M and OM. On M it is an isometry, so it does act on OM.\nNote that on Tx0 M it acts as v 7\u2192 \u2212v.\nSince G fixes x0 the derivative of the left action Lk at x0 gives a representation\nof G by isometries of Tx0 M. The linear isotropy representation. We shall assume\nit to be faithful, i.e. injective. As a consequence the action of K on M is effective,\nso that K can be considered as a sub-group of the diffeomorphism group of M,\nand also the action of K on the frame bundle of M is free, i.e the only element of\nK which fixes a frame is the identity element. See page 187 and the remark on\npage 198 of [41] for a discussion of this, and how the condition can be avoided.\nTaking a fixed orthonormal frame u0 : Rn \u2192 Tx0 M , say, at x0 , we can consider\nG as acting by isometries on Rn by\ng * e = u\u22121\n0 T Lg u0 (e).\n\n(7.4)\n\nLet \u03c1 : G \u2192 O(n) denote this representation. We then have the well known\nidentification of K as a subbundle of the orthonormal frame bundle of M:\nProposition 7.2.1 Let \u03a6 : K \u2192 OM be defined by \u03a6(k)(e) = T Lk (u0e) for\ne \u2208 Rn . Then \u03a6 is an injective homomorphism of principle bundles. Moreover \u03a6\nis equivariant for the actions of \u03c3 on K and OM.\n\n\f116CHAPTER 7. EXAMPLE: RIEMANNIAN SUBMERSIONS & SYMMETRIC SPACES\nProof. To see that \u03a6 is a bundle homomorphism it is only necessary to check that\n\u03a6 commutes with the actions of G. For this take e \u2208 Rn and g \u2208 G. Then, for\nk \u2208 K,\n\u03a6(k * g)(e) = T Lk T Lg u0 (e)\n= \u03a6(k)T Lg u0 (e) = \u03a6(k)u0 (g * e)\nas required. For the equivariance with respect to \u03c3 observe that by definition,\n\u03c3(Lk x0 ) = L\u03c3(k) x0 so that acting on the frame \u03a6(k) we have\n\u03c3(\u03a6(k)) = \u03c3(T Lk \u25e6 u0 )\n= T L\u03c3(k) u0 = \u03a6(\u03c3(k)).\n\nIt is easy to see that p : K \u2192 M has totally geodesic fibres. We can therefore\ntake B = 21 \u25b3K to have B lying over 21 \u25b3M . Moreover in the decomposition\nof B the vertical component 12 \u25b3V restricts to the one half the Laplacian of G\non the fibre p\u22121 (x0 ). The induced connection has horizontal subspace m at the\nidentity element of K. It is clearly left K-invariant and so Hk = T Lk [m] for\ngeneral k \u2208 K. From the equivariance under the right action of G it is a principle\nconnection: T Rg [Hk ] = Hkg . Since Hkg = T Lk T Lg [m] = T Rk T Lk adg [m] this\nholds because of the adG -invariance of m. This is the canonical connection.\nThe connnection on K extends to one on OM as described in Proposition\n3.1.3.This is known as the canonical linear connection. Since the connection\non K is invariant under \u03c3, by the equivariance of \u03a6 so is the canonical linear\nconnection. As in [41] we have:\nProposition 7.2.2 The canonical linear connection is the Levi-Civita connection.\nProof. It is only necessary to check that its torsion T vanishes. By left invariance\nit is enough to do that at the point x0 . Let u, v \u2208 Tx0 M. However by invariance\nunder \u03c3 we see\nT (u, v) = \u03c3T (\u03c3(u), \u03c3(v)) = \u2212T (\u2212u, \u2212v) = \u2212T (u, v),\nas required.\n\n\f7.2. RIEMANNIAN SYMMETRIC SPACES\n\n117\n\nLet kt , t > 0 be the canonical Brownian motion on K starting at the identity,\nid, and let Bt be the Brownian motion on the Euclidean space k given by the right\nflat anti-development:\nZ t\nBt =\nT Rk\u22121\nd{ks }.\ns\n0\n\nDefine \u03bet : M \u2192 M by \u03bet (x) = Lkt x, for t > 0, x \u2208 M.\nProposition 7.2.3 The diffeomorphism group valued process \u03bet , t > 0 is the flow\nof the sde\ndxt = X(xt ) \u25e6 dBt\nwhere\nX(x)\u03b1 =\n\nd\nLexp t\u03b1 x|t=0\ndt\n\nProof. Observe that k. satisfies the right invariant SDE\ndkt = T Rkt \u25e6 dBt\nwhich is p-related to the given SDE on M.\nRemark 7.2.4 The last two propositions relate to the discussion of connections\ndetermined by stochastic flows in the next section, and to the discussion about\ncanonical SDE on symmetric spaces in [27]. In [27] it was shown that the connection determined by our SDE is the Levi-Civita connection. In Proposition 8.1.3\nbelow, and in Theorem 3.1 of [25], it is shown that the connection determined by\na flow (in this case the canonical linear connection) is the adjoint of that induced\nby its SDE. this is confirmed in our special case since the adjoint of a Levi-Civita\nconnection is itself.\nWe can also apply our analysis of the vertical operators and Weitzenb\u00f6ck formulae to our situation, For this it is simplest to assume the symmetric space is\nirreducible. This means that the restricted linear holonomy group of the canonical\nconnection on p : K \u2192 M is irreducible i.e. for every g \u2208 G there is a nullhomotopic loop based at x0 whose horizontal lift starting at id \u2208 K ends at the\npoint g. The definition in [41] is that [m, m] acts irreducibly on m via the adjoint\naction, and it is shown there, page 252, that this implies that g = [m, m]. As a\nconsequence the linear isotropy representation of G on Tx0 M is irreducible, and\nequivalently so is our representation \u03c1.\n\n\f118CHAPTER 7. EXAMPLE: RIEMANNIAN SUBMERSIONS & SYMMETRIC SPACES\nThe vertical operators determined by BV on the bundles associated to p via\nour representation \u03c1 and its exterior powers \u2227k \u03c1 are given in Theorem 3.4.1 by\nk\nthe function \u03bb\u2227 \u03c1 : K \u2192 L(\u2227k Rn ; \u2227k Rn ). By Corollary 3.4.8 and the discussion\nabove they correspond to the Weitzenb\u00f6ck curvatures of the Levi-Civita connection, and so in particular are symmetric. To calculate them using Theorem\nX 3.4.1\n1\n1\nV\nG\n\u22121\nfirst use the fact that B restricts to 2 \u25b3 on p (x0 ) to represent it as 2\nLA\u2217j LA\u2217j\n\u2217\nfor Aj as in Section 3.2. The computation in the proof of Corollary 3.4.3 shows\nthat\n(n \u2212 2)!\nk\n\u03bb\u2227 \u03c1 (u) = \u2212\n(7.5)\nc k (u),\n(k \u2212 1)!(n \u2212 k \u2212 1)! \u2227\nfor\n\nc\u2227k (u) = (d\u2227k )Al (u) \u25e6 (d\u2227k )A\u2032l (u)\n\nthe Casimir element of our representation \u2227k \u03c1 of G.\nIf \u2227k \u03c1 is irreducible then c\u2227k (u) is constant scalar. As remarked in Corollary\n3.4.3 this happens when G = SO(n), given our irreducibility hypothesis\u221aon the\n\u03c1 and then it is just 12 n(n \u2212 1)/ n(n\u22121)...(n\u2212k+1)\n. Thus for the sphere S n ( 2) of\nk!\n\u221a\nradius 2, considered as SO(n + 1)/SO(n) we have\n1\nk\n\u03bb\u2227 \u03c1 (u) = \u2212 k(n \u2212 k).\n4\n\n(7.6)\n\n\fChapter 8\nExample: Stochastic Flows\nBefore analysing stochastic flows by the methods of the previous paragraphs we\ndescribe some purely geometric constructions which will enable us to identify the\nsemi-connections which arise in that analysis.\n\n8.1 Semi-connections on the Bundle of Diffeomorphisms\nAssume that M is compact. For r \u2208 {1, 2, . . . } and s > r + dim M/2 let D s =\nD s (M) be the space of diffeomorphisms of M of Sobolev class H s . See, for\nexample, Ebin-Marsden [20] and Elworthy [21] for the detailed structure of this\nspace. Elements of D s are then C r diffeomorphisms. The space is a topological\ngroup under composition, and has a natural Hilbert manifold structure for which\nthe tangent space T\u03b8 D s at \u03b8 \u2208 D s can be identified with the space of H s maps\nv : M \u2192 T M with v(x) \u2208 T\u03b8(x) M, all x \u2208 M. In particular Tid D s can be\nidentified with the space H s \u0393(T M) of H s vector fields on M. For each h \u2208 D s\nthe right translation\nRh : D s \u2192 D s\nRh (f ) = f \u25e6 h\nis C \u221e . However the joint map\nD s+r \u00d7 D s \u2192 D s\nis C r rather than C \u221e for each r in {0, 1, 2, . . . }.\n119\n\n(8.1)\n\n\f120\n\nCHAPTER 8. EXAMPLE: STOCHASTIC FLOWS\n\nFor x0 \u2208 M fixed, define \u03c0 : D s \u2192 M by\n\u03c0(\u03b8) = \u03b8(x0 ).\n\n(8.2)\n\nThe fibre \u03c0 \u22121 (y) at y \u2208 M is given by: {\u03b8 \u2208 D s : \u03b8(x0 ) = y}. Set Dxs 0 :=\n\u03c0 \u22121 (x0 ). Then the elements of Dxs 0 act on the right as C \u221e diffeomorphisms of\nD s . We can consider this as giving a principal bundle structure to \u03c0 : D s \u2192 M\nwith group Dxs 0 , although there is the lack of regularity noted in equation (8.1).\nA smooth semi-connection on \u03c0 : D s \u2192 M over a sub-bundle E of T M consists\nof a family of linear horizontal lift maps h\u03b8 : E\u03c0(\u03b8) \u2192 T\u03b8 D s , \u03b8 \u2208 D s , which is\nsmooth in the sense that it determines a C \u221e section of L(\u03c0 \u2217 E; T D s ) \u2192 D s . In\nparticular we have\nh\u03b8 (u) : M \u2192 T M\nwith\nh\u03b8 (u)(y) \u2208 T\u03b8(y) M,\nu \u2208 E\u03b8(x0 ) , \u03b8 \u2208 D s , y \u2208 M.\nWe shall relate semi-connections on D s \u2192 M to certain reproducing kernel\nHilbert spaces. For this let E be a smooth sub-bundle of T M and H a Hilbert\nspace which consists of smooth section of E such that the inclusion H \u2192 C 0 \u0393E\nis continuous (from which comes the continuity into Hs \u0393E for all s > 0). Such\na Hilbert space determines and is determined by its reproducing kernel k, a C \u221e\nsection of the bundle L(E \u2217 ; E) \u2192 M \u00d7 M with fibre L(Ex\u2217 ; Ey ) at (x, y), see [4].\nBy definition,\nk(x, \u2212) = \u03c1\u2217x : Ex\u2217 \u2192 H\nwhere \u03c1x : H \u2192 Ex is the evaluation map at x, and so\nk(x, y) = \u03c1y \u03c1\u2217x : Ex\u2217 \u2192 Ey .\nAssume H spans E in the sense that for each x in M, \u03c1x : H \u2192 Ex is surjective. It then induces an inner product h, iH\nx on Ex for each x via the isomorphism\n\u03c1x \u03c1\u2217x : Ex\u2217 \u2192 Ex .\nUsing the metric on E the reproducing kernel k induces linear maps\nk # (x, y) : Ex \u2192 Ey ,\nwith k # (x, x) = id.\n\nx, y \u2208 M,\n\n\f8.1. SEMI-CONNECTIONS ON THE BUNDLE OF DIFFEOMORPHISMS121\nProposition 8.1.1 A Hilbert space H of smooth sections of a sub-bundle E of\nT M which spans E determines a smooth semi-connection hH on \u03c0 : D s \u2192 M\nover E by\n\u0010\n\u0011\n#\nhH\n(u)(y)\n=\nk\n\u03b8(x\n),\n\u03b8(y)\n(u),\n\u03b8 \u2208 D s , u \u2208 E\u03b8(x0 ) , y \u2208 M,\n(8.3)\n0\n\u03b8\n\nfor k # derived from the reproducing kernel of H as above. In particular the horizontal lift \u03b1\u0303 starting from \u03b1\u0303(0) = id, of a curve \u03b1 : [0, T ] \u2192 M, \u03b1(0) = x0 with\n\u03b1\u0307(t) \u2208 E\u03b1(t) for all t, is the flow of the non-autonomous ODE on M\n\u0010\n\u0011\n#\n\u017ct = k \u03b1(t), zt \u03b1\u0307(t).\n(8.4)\n\nThe mapping H 7\u2192 (hH , h, iH) from such Hilbert spaces to semi-connections over\nE and Riemannian metrics on E is injective.\nProof. From the definition of k # we see hH\n\u03b8 (u)(y), as given by (8.3), takes values\nin T\u03b8(y) M, is linear in u \u2208 E\u03b8(x0 ) into T\u03b8 D s , and is Dxs 0 -invariant. Moreover,\nT\u03b8 \u03c0 \u25e6\n\nhH\n\u03b8 (u)\n\n=\n\nhH\n\u03b8 (u)(x0 )\n\n=k\n\n#\n\n\u0010\n\n\u0011\n\n\u03b8(x0 ), \u03b8(x0 ) (u) = u\n\nfor u \u2208 E\u03b8(x0 ) and so hH\n\u03b8 is a 'lift'.\n\u221e\nTo see that h is C as a section of L(\u03c0 \u2217 E; T D s) \u2192 D s note that for each\nr \u2208 {0, 1, 2, . . . } the composition map\nTid D r+s \u00d7 D s \u2192 T D s\n(V, \u03b8) 7\u2192 T R\u03b8 (V )\nis a C r\u22121 vector bundle map over D s , being a partial derivative of the composition\nD r+s \u00d7 D s \u2192 D s . Therefore it induces a C r\u22121 vector bundle map Z 7\u2192 T R\u03b8 \u25e6 Z,\nfor Z : E\u03b8(x0 ) \u2192 H and for H the trivial H-bundle over D s , by composition\n\u2732\n\nL(\u03c0 \u2217 E; H)\n\u25d7\n\nL(\u03c0 \u2217 E; T D s )\n\n\u2711\n\u2711\n\u25d7\n\u2711\n\u25d7\n\u25d7\u25d7\n\u2711\u2711\ns \u2730\n\nDs\n\n\fCHAPTER 8. EXAMPLE: STOCHASTIC FLOWS\n\n122\n\nOn the other hand y 7\u2192 k(y, \u2212) can be considered as a C \u221e section of L(E; H\u03b3 ) \u2192\nM and so \u03b8 7\u2192 k(\u03b8(x0 ), \u2212) as a C \u221e section of L(\u03c0 \u2217 E; H \u03b3 ). This proves the\nregularity of h.\nThat the horizontal lift \u03b1\u0303 is the flow of (8.4) is immediate. To see that the claimed\n#\ninjectivity holds, given hH\n\u03b8 observe that (8.3) determines k : this is because given\n\u221e\nany x in M there exists a C diffeomorphism \u03b8 such that \u03b8(x0 ) = x and for such\n\u03b8\n\u22121\nk # (x, z)(u) = hH\n(8.5)\n\u03b8 (u)(\u03b8 z).\nRemark 8.1.2 We cannot expect surjectivity of the map H \u2192 hH into the space\nof semi-connections on \u03c0 : D s \u2192 M. Indeed for k # defined by (8.5) to be the\nreproducing kernel for some Hilbert space of sections of E we need\n1) hH\n\u03b8 (u)(y) \u2208 E\u03b8(y) for u \u2208 E\u03b8(x0 ) , y \u2208 M, and a metric h, i on E with respect\nto which the following holds:\n2) for x, y \u2208 M,\n\n#\n\n\u0010\n\n#\n\n\u0011\u2217\n\nk (x, y) = k (y, x) ,\n\n3) For any finite set S of points of M and {\u03bea } \u2208 Ea , a \u2208 S\nE\nXD\nk # (a, b)\u03bea , \u03beb > 0.\n\nFor each frame u0 : Rn \u2192 Tx0 M there is a homomorphism of principal bundles\n\u03a8u0 : D s \u2192 GLM\n\u03b8\n7\u2192 Tx0 \u03b8 \u25e6 u0 .\n\n(8.6)\n\nAs with connections such a homeomorphism maps a semi-connection on D s over\nE to one on GLM. The horizontal lift maps are related by\nT\u03b8 \u03a8u0 \u2732\nT\u03a8u0 (\u03b8) GLM\nT\u03b8 D s\n\u25d7\n\u2766\n\u2738\n\u2711\n\u25d7\n\u2711\n\u25d7\n\u2711\n\u2711 h\u03a8u0 (\u03b8)\nh\u03b8 \u25d7\n\u25d7\n\u2711\n\u25d7 \u2711\n\nE\u03b8(x0 )\nand if \u03b1\u0303 : [0, T ] \u2192 D s is a horizontal lift of \u03b1 : [0, T ] \u2192 M then\n\u03a8u0 (\u03b1\u0303(t)) = Tx0 \u03b1\u0303(t) \u25e6 u0 ,\n\nis a horizontal lift of \u03b1 to GLM.\n\n06t6T\n\n\f8.2. SEMI-CONNECTIONS INDUCED BY STOCHASTIC FLOWS\n\n123\n\nTheorem 8.1.3 Let hH be the semi-connection on \u03c0 : D s \u2192 M over E determined by some H as in Proposition 8.1.1. Then the semi-connection induced on\n\u02c6 of the metric\nGLM, and so on T M, by the homeomorphism \u03a8u0 is the adjoint \u2207\nH\nconnection which is projected on (E, h, i ) by the evaluation map (x, e) 7\u2192 \u03c1x (e)\nfrom M \u00d7 H \u2192 E, c.f. (1.1.10) in [27]. In particular every semi-connection on\nT M with metric adjoint connection arises this way from some, even finite dimensional, choice of H.\nProof. Let \u03b1 : [0, T ] \u2192 M be a C 1 curve with \u03b1\u0307(t) \u2208 E\u03b1(t) for each t. By\nProposition 8.1.1 its horizontal lift \u03b1\u0303 to D s starting from \u03b8 \u2208 \u03c0 \u22121 (\u03b1(0)) is the\nsolution to\n\u0010\n\u0011\nd\u03b1\u0303\n= k # \u03b1\u0303(t)(x0 ), \u03b1\u0303(t) \u2212 \u03b1\u0307(t)\n(8.7)\ndt\n\u03b1\u0303(0) = \u03b8.\n(8.8)\nThe horizontal lift to GLM is t 7\u2192 Tx0 \u03b1\u0303(t) \u25e6 u0 and to T M through v0 \u2208 T\u03b8(x0 ) M,\ni.e. the parallel translation {//t (v0 ) : 0 6 t 6 T } of v0 along \u03b1, is given by\n\u0011\n\u0010\n\u22121\n\u22121\n(v0 ).\n//t (v0 ) = Tx0 \u03b1\u0303(t) \u25e6 (Tx0 \u03b8) (v0 ) = T\u03b1(0) \u03b1\u0303(t) \u25e6 \u03b8\nHowever this is T\u03b1(0) \u03c0t (v0 ) for {\u03c0t : 0 6 t 6 T } the solution flow of\n\u0010\n\u0011\ndzt\n= k # \u03b1(t), z(t) \u03b1\u0307(t)\ndt\n\nwhich by Lemma 1.3.4 of [27] is the parallel translation of the adjoint of the\nassociated connection (in [27] k # is denoted by k).\nThe fact that all such semi-connections on T M arise from some finite dimensional H comes from Narasimhan-Ramanan [53] as described in [27], or more\ndirectly from Quillen [60]\n\n8.2 Semi-connections Induced by Stochastic Flows\nFrom Baxendale [5] we know that a C \u221e stochastic flow {\u03bet : t > 0} on M, i.e.\na Wiener process on D \u221e := \u2229s D s , can be considered as the solution flow of a\nstochastic differential equation on M driven by a possibly infinite dimensional\nnoise. Its one point motions form a diffusion process on M with generator A,\nsay. The noise comes from the Brownian motion {Wt : t > 0} on Hs \u0393(T M)\n\n\fCHAPTER 8. EXAMPLE: STOCHASTIC FLOWS\n\n124\n\ndetermined by a Gaussian measure \u03b3 on Hs \u0393(T M). (In our C \u221e case they lie on\nH\u221e (T M) := \u2229s Hs \u0393(T M).) We will take \u03b3 to be mean zero and so we may have\na drift A in H\u221e (T M). The stochastic flow {\u03bet : t > 0} can then be taken to be\nthe solution of the right invariant stochastic differential equation on D s\nd\u03b8t = T R\u03b8t \u25e6 dWt + T R\u03b8t (A)dt\n\n(8.9)\n\nwith \u03be0 the identity map id. In particular it determines a right invariant generator\nB on D s .\nFor fixed x0 in M the one point motion xt := \u03bet (x0 ) solves\ndxt = \u25e6dWt (xt ) + A(xt )dt.\n\n(8.10)\n\ndxt = \u03c1xt \u25e6 dWt + A(xt )dt.\n\n(8.11)\n\nWe can write (8.10) as\n\nThus \u03c0(\u03bet ) = \u03bet (x0 ) = xt . For a map \u03b8 in D s , the solution \u03bet \u25e6 \u03b8 to (8.9)\nstarting at \u03b8 has \u03c0(\u03bet \u25e6 \u03b8) = \u03bet (\u03c0(\u03b8)), the solution to (8.11) starting from \u03c0(\u03b8), and\nwe see that the diffusions are \u03c0-related (c.f. [21]), and A and B are intertwined\nby \u03c0.\nThe measure \u03b3 corresponds to a reproducing kernel Hilbert space, H\u03b3 say, or\nequivalently to an abstract Wiener space structure i : H\u03b3 \u2192 Hs \u0393(T M) with i the\ninclusion (although i may not have dense image). Then\n\u03c3\u03b8B : (T\u03b8 D s )\u2217 \u2192 T\u03b8 D s\nis right invariant and determined at \u03b8 = id by the canonical isomorphism H\u03b3\u2217 \u2243\nH\u03b3 through the usual map j = i\u2217\nj\n\ni\n\n(Hs \u0393(T M))\u2217 \u0592\u2192 H\u03b3\u2217 \u2243 H\u03b3 \u0592\u2192 Hs \u0393(T M),\ni.e.\nB\n\u03c3id\n= i \u25e6 j.\nB\nwith induced metric. In this situation our coheThis shows H\u03b3 is the image of \u03c3id\nsiveness condition on A becomes the assumption that there is a C \u221e subbundle E\nof T M such that H\u03b3 consists of sections of E and spans E, and A is a section of\nE. Let h, iy be the inner product on Ey induces by H\u03b3 .\n\n\f8.2. SEMI-CONNECTIONS INDUCED BY STOCHASTIC FLOWS\n\n125\n\nThe reproducing kernel k of H\u03b3 is the covariance of \u03b3 and :\nZ\nD\nE\n#\nk (x, y)v =\nU(x), v U(y) d\u03b3(U),\nv \u2208 Ex ; x, y \u2208 M.\nx\n\nU \u2208Hs \u0393(E)\n\nAnalogously to Lemma 2.2.1 we have the commutative diagram\n(T\u03b8 D s )\u2217\n\nj \u25e6 (T R\u03b8 )\u2217\n\n\u2732\n\nH\u03b3\n\n\u273b\n\n\u273b\n\n(T\u03b8 \u03c0)\u2217\n\u2217\nT\u03b8(x\nM\ns)\n\n\u2192\n\n\u2217\nE\u03b8(x\n0)\n\nT R\u03b8 \u25e6 i\n\n\u2732T\u03b8 D s\n\nl\u03b8\nk(\u03b8(x0 ), \u2212)\n\n\u2732\n\nH\u03b3\n\nT\u03b8 \u03c0 = \u03c1x0\n\n\u03c1\u03b8(x0 )\n\n\u2732\n\n\u2744\n\nE\u03b8(x0 ) \u0592\u2192 Tx0 M\n\nwith l\u03b8 uniquely determined under the extra condition\nker l\u03b8 = ker\u03c1\u03b8(x0 ) .\nWriting K : M \u2192 L(H\u03b3 ; H\u03b3 ) for the map giving the projection K(x) of H\u03b3\nonto ker \u03c1x for each x in M and letting K \u22a5 (x) be the projection onto [ker \u03c1x ]\u22a5 we\nhave\n\u0001\nl\u03b8 = K \u22a5 \u03b8(x0 ) ,\n(agreeing with the note following Lemma 2.2.1), and so\n\u0010\n\u0011\nU \u2208 H\u03b3 .\nl\u03b8 (U) = k # \u03b8(x0 ), \u2212 U(\u03b8(x0 )),\n\nNote that the formula\n\nK \u22a5 (y)(U) = k # (y, \u2212)U(y)\n\nfor U in H\u03b3 determines an extension K \u22a5 (y) : \u0393E \u2192 H\u03b3 . We then define\nK(y)U = U \u2212 K \u22a5 (y)U. Note that \u03c1y (K(y)U) = 0 for all U in \u0393E.\nThe horizontal lift map determined by B as in Proposition 2.1.2 is therefore\ngiven by\nh\u03b8 : E\u03b8(x0 ) \u2192 T R\u03b8 (H\u03b3 )\n\u2282 T\u03b8 D s\nh\ni\n(8.12)\nh\u03b8 (u) = T R\u03b8 l\u03b8 k # (\u03b8(x0 ), \u2212)u ,\nfor \u03b8 \u2208 D s . Consequently\n\n\u0010\n\u0011\nh\u03b8 (u)(y) = k # \u03b8(x0 ), \u03b8(y) (u).\n\nComparing this with formula (8.3) we have\n\n(8.13)\n\n\f126\n\nCHAPTER 8. EXAMPLE: STOCHASTIC FLOWS\n\nProposition 8.2.1 The semi-connection h determined on \u03c0 : D s \u2192 M by the\nequivariant diffusion operator B is just that given by the reproducing kernel Hilbert\nspace H\u03b3 of the stochastic flow which determines B, i.e.\nh = hH\u03b3 .\nThe horizontal lift {x\u0303t : t > 0} of the one point motion {xt : t > 0} with\nx\u03030 = id is the solution to\n\u0010\n\u0011\ndx\u0303t = k # x\u0303t (x0 ), x\u0303t \u2212 \u25e6 dxt ;\n(8.14)\n\nwhich in a more revealing notation is:\n\u0010\n\u0011\n\u0010\n\u0011\n\u22a5\n\u22a5\ndx\u0303t = T Rx\u0303t K (x\u0303t (x0 )) \u25e6 dWt + T Rx\u0303t K (x\u0303t (x0 ))A .\n\n(8.15)\n\nEquivalently {x\u0303t : t > 0} can be considered as the solution flow of the nonautonomous stochastic differential equation on M\n\u0001\ndyt = k # xt , yt \u25e6 dxt\ni.e.\n\n\u0010\n\u0011\ndyt = K \u22a5 (xt ) \u25e6 dWt (yt ) + K \u22a5 (xt )(A)(yt ).\n\n(8.16)\n\nThe standard fact that the solution to such equation as (8.16) starting at x0 is\njust {xt : t > 0}, i.e. that x\u0303t (x0 ) = xt reflects the fact that x\u0303* is a lift of x* . The\nlift through \u03c6 \u2208 Dxs 0 is just {x\u0303t \u25e6 \u03c6 : t > 0}.\nRemark 8.2.2 If our solution flow is that of an SDE\ndxt = X(xt ) \u25e6 dBt + A(xt )dt\nfor X(x) : Rm \u2192 T M arising, for example, from H\u00f6rmander form representation of A as in \u00a74.7 above the relationships with the notation in this section is as\nfollows: H\u03b3 = {X(*)e : e \u2208 Rm } with inner product induced by the surjection\nRm \u2192 H\u03b3 . If Yx = [X(x)|ker X(x)\u22a5 ]\u22121 then k # (y, \u2212) : Ey \u2192 H\u03b3 is\nk # (y, \u2212)u = X(\u2212)Yy (u),\n\nu \u2208 Ey .\n\nAlso K \u22a5 (y) : \u0393E \u2192 H\u03b3 is K \u22a5 (y)U = X(\u2212)Yy (U(y)).\n\n\f8.2. SEMI-CONNECTIONS INDUCED BY STOCHASTIC FLOWS\n\n127\n\nRemark 8.2.3 The reproducing kernel Hilbert space H\u03b3 determines the stochastic flow and so by the injectivity part of Proposition 8.1.1 the semi-connection\ntogether with the generator A of the one-point motion determines the flow, or\nequivalently the operator B. This is because the symbol of A again gives the metric on E which together with the semi-connection determines H\u03b3 by Proposition\n8.1.1. The generator A then determines the drift A. A consequence is that the\nhorizontal lift AH of A to D s determines the flow (and hence B, so BV really is\nredundant).\nTo see this directly note that given any cohesive A on M and Dxs 0 -equivariant\nAH on D s over A, with no vertical part, there is at most one vertical BV such that\nAH + BV is right invariant. This follows from the following lemma\nLemma 8.2.4 Suppose B1 is a diffusion operator on D s which is vertical and right\ninvariant then B1 = 0.\n\u2032\n\nProof. By Remark 1.3.2 (i) the image E\u03b8 , say, of \u03c3\u03b8B lies in V T\u03b8 D s for \u03b8 \u2208 D s and\nso if V \u2208 E\u03b8 . On the other hand, by right invariance E\u03b8 = T R\u03b8 (Eid). Therefore\nif V \u2208 Eid then V (\u03b8x0 ) = 0 all \u03b8 \u2208 D s and so V \u2261 0. Thus Eid = {0} and by\nright invariance, B1 must be given by some vector field Z on D s . But Z must be\nvertical and right invariant, so again we see Z \u2261 0.\nProposition 3.1.3 applies to the homomorphism \u03a8u0 : D s \u2192 GL(M) of (8.6).\nFrom this and Theorem 8.1.3 we see that the semi-connection \u2207 on GLM de\u02c6 of the\ntermined by the generator of the derivative flow in \u00a73.3 is the adjoint \u2207\n \u0306\nconnection \u2207, so giving an alternative proof of Theorem 3.3.1 above. Proposition\n\u02c6\n3.1.3 also gives a relationship between the curvature and holonomy group of \u2207\n\u03c1x0\nand those of the connection induced by the flow on D s \u2192 M.\nWe can summarize our decomposition results as applied to these stochastic\nflows in the following theorem. The skew product decomposition was already\ndescribed in [25] for the case of solution flows of SDE of the form (4.19), and in\nparticular with finite dimensional noise: however the difference is essentially that\nof notation, see Remark 8.2.2 above.\nTheorem 8.2.5 Let {\u03bet : t > 0} be a C \u221e stochastic flow on a compact manifold\nM. Let A be the generator of the one point motion on M and B the generator\nof the right invariant diffusion on D s determined by {\u03bet : t > 0}. Assume A\nis strongly cohesive. Then there is a unique decomposition B = AH + BV for\nAH a diffusion operator which has no vertical part in the sense of definition 2.3.3\n\n\fCHAPTER 8. EXAMPLE: STOCHASTIC FLOWS\n\n128\n\nand BV a diffusion operator which is along the fibres of \u03c1x0 , both invariant under\nthe right action of Dxs 0 . The diffusion process {\u03b8t : t > 0} and {\u03c6t : t > 0}\ncorresponding to AH and BV respectively can be represented as solutions to\n\u0010\n\u0011\n\u0010\n\u0011\n(8.17)\nd\u03b8t = T R\u03b8t K \u22a5 (\u03b8t (x0 )) \u25e6 dWt + T R\u03b8t K \u22a5 (\u03b8t (x0 ))A\nand\n\n\u0010\n\u0011\n\u0010\n\u0011\nd\u03c6t = T R\u03c6t K(z0 ) \u25e6 dWt + T R\u03c6t K(z0 )A\n\n(8.18)\n\nfor z0 = \u03c60 (x0 ) = \u03c6t (x0 ). There is the corresponding skew-product decomposition of the given stochastic flow\n\u03bet = x\u0303t gtx* , 0 6 t < \u221e\nwhere {x\u0303t : t > 0} is the horizontal lift of the one point notion {\u03bet (x0 ) : t > 0}\n\u03c3\nwith x\u03030 = idM and for PA\nx0 -almost all \u03c3 : [0, \u221e) \u2192 M, {gt : t > 0} is a\nDxs 0 -valued process independent of {x\u0303t : t > 0} and satisfying\ndgt\u03c3\n\n=\n\nT \u03c3\u0303t\u22121 \u03c1(\u03c3\u0303t gt\u03c3 \u2212)\n\n\u03c3\u03030 = idM\n\n\u0010\n\n\u0011\n\nK(\u03c3t ) \u25e6 dWt +\n\nT \u03c3\u0303t\u22121 \u03c1(\u03c3\u0303t gt\u03c3 \u2212)\n\n\u0010\n\n\u0011\nK(\u03c3t )A\n\nwhere \u03c3\u0303 is the horizontal lift of \u03c3\u0303 to D s with \u03c3\u0303* in the horizontal life of \u03c3\u0303 to D s\nwith \u03c3\u03030 = idM .\nRemark 8.2.6 As in [27] we could rewrite the terms such as K(\u03c3t ) \u25e6 dWt and\nK \u22a5 (\u03c3t ) \u25e6 dWt above as It\u00f4 differentials which can be written as\nK(\u03c3t )dWt = /\u0303/t (\u03c3* ) d\u03b2t\n\nK \u22a5 (\u03c3t )dWt = /\u0303/t (\u03c3* ) dB\u0303t\nwhere / \u0303/t (\u03c3* ) : H\u03b3 \u2192 H\u03b3 , 0 6 t < \u221e, is a family of orthogonal transformations\nmapping ker \u03c1x0 \u2192 ker \u03c1\u03c3t defined for PA\nx0 -almost all \u03c3 : [0, \u221e) \u2192 M and\n{\u03b2t : t > 0}, {B\u0303t : t > 0} are independent Brownian motions, (\u03b2t could be\ncylindrical), on ker \u03c1x0 and [ker \u03c1x0 ]\u22a5 respectively.\nProof. Our general result give the decomposition B = AH + BV into horizontal\nand vertical parts. We have just proved the representation (8.17) for AH . To show\n\n\f8.2. SEMI-CONNECTIONS INDUCED BY STOCHASTIC FLOWS\n\n129\n\nthat B \u2212 AH corresponds to (8.18) take an orthonormal base {X j } for H\u03b3 . Then,\non a suitable domain,\n1X\n(8.19)\nLXj LXj + LA\nB=\n2 j\n\nfor Xj (\u03b8) = T R\u03b8 (X j ) and A = T R\u03b8 (A), while, by (8.17),\nAH =\n\n1X\nLYj LYj + LB\n2 j\n\n(8.20)\n\n\u0001\nfor Yj (\u03b8) = T R\u03b8 K \u22a5 (\u03b8(x0 )X j , B = T R\u03b8 (K \u22a5 (\u03b8(x0 ))A).\nDefine vector fields Zj , C on D s by\n\u0001\nZj (\u03c6) = T R\u03c6 K(\u03c6(x0 ))X j ,\nand\nC(\u03c6) = T R\u03c6 (K(\u03c6(x0 ))A) ,\nfor \u03c6 \u2208 D s .\nThen A = B + C and Xj = Yj + Zj each j. Moreover\nX\nX\nLYj LZj +\nLZj LYj = 0\nj\n\nj\n\nby Lemma 8.2.7 which follows below. This shows that\n1X\nBV =\nLZj LZj + LC .\n2 j\n\n(8.21)\n\nThus the diffusion process from \u03c60 corresponding to BV can be represented by the\nsolution to\nd\u03c6t = T R\u03c6t (K(\u03c6t (x0 ) \u25e6 dWt )) + T R\u03c6t (K(\u03c6t (x0 )A)) dt.\n\n(8.22)\n\nIf we set zt = \u03c1x0 (\u03c6t ) = \u03c6t (x0 ). We obtain, via It\u00f4's formula\nzt = \u03c1zt (K(zt ) \u25e6 dWt ) + \u03c1zt (K(zt )A) ,\ni.e. dzt = 0. Thus \u03c6t (x0 ) = z0 and (8.18) holds.\nThe skew product formula is seen to hold by calculating the stochastic differential of x\u0303t gtx\u0303 using (8.15) to see it satisfies the SDE (8.9) for {\u03bet : t > 0}.\nLemma 8.2.7\n\nX\nj\n\nLYj LZj + LZj LYj = 0.\n\n\fCHAPTER 8. EXAMPLE: STOCHASTIC FLOWS\n\n130\n\nProof. Since, for fixed \u03b8, we can choose our basis {X j }, such that either Yj (\u03b8) =\n0 or Xj (\u03b8) = 0, and since for f : D s \u2192 R we can write\n\u0011\n\u0010\n\u0011 \u0010\n\u0011\u0010\ndf Zj (\u03b8) = df \u25e6 T R\u03b8 K(\u03b8(x0 ))X j\nand\n\n\u0011\n\u0010\ndf (Yj (\u03b8)) = (df \u25e6 T R\u03b8 ) K \u22a5 (\u03b8(x0 ))X j ,\n\n\u03b8 \u2208 Ds ,\n\nit suffices to show that\n\u0010\n\u0011\nXn\n\u0001 o\n(dK \u22a5 )\u03b8(x0 ) Zj (\u03b8)(x0 ) X j + (dK)\u03b8(x0 ) Yj (\u03b8)(x0 ) X j = 0,\n\n(8.23)\n\nj\n\nfor all \u03b8 \u2208 D s .\nNow K \u22a5 (y)K(y) = 0 for all y \u2208 M. Therefore\n(dK \u22a5 )y (v)K(y) + K \u22a5 (y)(dK)y (v) = 0,\nWriting\n\n\u2200v \u2208 Tx M, x \u2208 M.\n\n\u0001\n\u0001\nX j = K \u03b8(x0 ) X j + K \u22a5 \u03b8(x0 ) X j\n\nthis reduces the right hand side of (8.23) to\n\u0011\n\u0010\n\u0011\u0010\nX\n\u0001\ndK \u22a5 \u03b8(x0 ) Zj (\u03b8)(x0 ) K \u22a5 (\u03b8(x0 ))X j\nj\n\n\u0010\n\nj\n\n+(dK)\u03b8(x0 ) Y (\u03b8)(x0 )\n\n\u0011\u0010\n\nK(\u03b8(x0 ))X\n\nwith our choice of basis this clearly vanishes, as required.\n\nj\n\n\u0011\n\n=0\n\n8.3 Semi-connections on Natural Bundles\nOur bundle \u03c0 : Diff M \u2192 M can be considered as a universal natural bundles\nover M, and a connection on it induces a connection on each natural bundle over\nM. Natural bundles are discussed in Kolar-Michor-Slovak [42]), they include\nbundles such as jet bundles as well as the standard tensor bundles. For example\nlet Grn be the Lie group of r-jets of diffeomorphisms \u03b8 : Rn \u2192 Rn with \u03b8(0) = 0\nfor positive integer r. An 'r-th order frame' u at a point x of M is the r-jet at 0\nof some \u03c8 : U \u2192 M which maps an open set U of Rn diffeomorphically onto an\nopen subset of M with 0 \u2208 U and \u03c8(0) = x. Clearly Grn acts on the right of such\n\n\f8.3. SEMI-CONNECTIONS ON NATURAL BUNDLES\n\n131\n\njets, by composition. From this we can define the rth order frame bundle Grn M of\nM with group Grn .\nIf we fix an rth order frame u0 at x0 we obtain a homomorphism of principal\nbundles\n\u03a8u0 : D s \u2192 Grn M\n\u03b8 7\u2192 jxr0 (\u03b8) \u25e6 u0\nas for GLM (which is the case r = 1) with associated group homomorphism\nr\nDxs 0 \u2192 Gn given by \u03b8 \u2192 u\u22121\n0 \u25e6 jx0 (\u03b8) \u25e6 u0 . As for the case r = 1 there is a\ndiffusion operator induced by the flow on Grn M and we are in the situation of\nProposition 8.1.3. The behaviour of the flow induced on G2n M is essentially that\nof jx20 (\u03bet ) and so relevant to the effect on the curvature of sub-manifolds of M as\nthey are moved by the flow e.g. see Cranston-LeJan [14], Lemaire [46].\nAlternatively rather having to choose some u0 we see that Grn M is (weakly)\nassociated to \u03c0 : D s \u2192 M by taking the action of Dxs 0 on (Grx M)x0 by\n(\u03b8, \u03b1) 7\u2192 jxr0 (\u03b8) \u25e6 \u03b1.\nAs a geometrical conclusion we can observe\nTheorem 8.3.1 Any classifying bundle homomorphism\n\u03a6\n\nOM \u2192 V (n, m \u2212 n)\n\u2192\n\nM \u03a60 G(n, m \u2212 n)\n\nfor the tangent bundle to a compact Riemannian manifold M, (where G(n, m \u2212\nn) is the Grassmannian of n-planes in Rm and V (n, m \u2212 n) the corresponding\nStiefel manifold) induces not only a metric connection on T M as the pull back of\nNarasimhan and Ramanan's universal connection \u031fU , but also a connection on \u03a0 :\nD s \u2192 M. The latter induces a connection on each natural bundle over M to form\na consistent family; that induced on the tangent bundle is the adjoint of \u03a6\u2217 (\u031fU ).\nThe above also holds with smooth stochastic flows replacing classifying bundle\nhomomorphisms, and the resulting map from stochastic flows to connections on\n\u03c0 : D s \u2192 M is injective.\nProof. It is only necessary to observe that \u03a6 determines and is determined by a\nsurjective vector bundle map X : M \u00d7 Rm \u2192 T M (e.g. see [27], Appendix 1).\nThis in turn determines a Hilbert space H of sections of T M as in Remark 8.2.2\nso we can apply Proposition 8.1.1 and 8.1.3.\n\n\f132\n\nCHAPTER 8. EXAMPLE: STOCHASTIC FLOWS\n\nSome of the conclusions of Theorem 8.3.1 are explored further in [30].\nRemark 8.3.2 This injectivity result in Proposition 8.3.1 implies that all properties of the flow can, at least theoretically, be obtainable from the induced connection on D s .\nFlows on Non-compact Manifolds\nIn general if M is not compact we will not be able to use the Hilbert manifolds\nD s , or other Banach manifolds without growth conditions on the coefficients of\nour flow. One possibility could be use the space Diff M of all smooth diffeomorphisms using the Fr\u00f6licher-Kriegl differential calculus as in Michor [51]. In order\nto do any stochastic calculus we would have to localize and use Hilbert manifolds\n(or possibly rough path theory). The geometric structures would nevertheless be\non Diff M. This was essentially what was happening in the compact case. However it is useful to include partial flows of stochastic differential equations which\nare not strongly complete, see Kunita [43] or Elworthy[21]. For the partial solution flow {\u03bet : t < \u03c4 } of an SDE as in Remark 8.2.2 we obtain the decomposition\nin Theorem 8.2.5 but now only for \u03bet (x) defined for t < \u03c4 (x, \u2212). This can be\nproved from the compact versions by localization as in Carverhill-Elworthy [13]\nor Elworthy [21].\n\n\fChapter 9\nAppendices\n9.1 Girsanov-Maruyama-Cameron-Martin Theorem\nTo apply the Girsanov-Maruyama theorem it is often thought necessary to verify\nsome condition such as Novikov's condition to ensure that the exponential (local)\nmartingale arising as Radon -Nikodym derivative is a true martingale. In fact for\nconservative diffusions this is automatic, and we give a proof of this fact here since\nit is not widely appreciated. The proof is along the lines of that given for elliptic\ndiffusions in [21] but with the uniqueness of the martingale problem replacing the\nuniqueness of minimal semi-groups used in [21]. See also [[45]]. On the way\nwe relate the expectation of the exponential local martingale to the probability\nof explosion of the trajectories of the associated diffusion process: a special case\nof this appeared in [50]. Let B be a conservative diffusion operator on a smooth\nmanifold N. For fixed T > 0 and y0 \u2208 N let Py0 . = PBy0 denote the solution to\nthe martingale problem for B on Cy0 ([0, T ]; N + ). Using the notation of chapter\n4, let b be a vector field on N for which there is a T \u2217 N-valued process \u03b1 in L2B,loc\nsuch that\n2\u03c3 B (\u03b1t ) = b(yt )\n06t6T\nfor Py0 almost all y. \u2208 Cy0 ([0, T ]; N + ). Set\n\n1\nhM \u03b1 it }\n0 6 t 6 T.\n2\nThis exists by the non-explosion of the diffusion process generated by B, and is a\nlocal martingale with EZt 6 1.\nFor bounded measurable f : N \u2192 R define Qt f (y0 ) = EBy0 [Zt f (yt )] for\ny0 \u2208 N. Since the pair (y. , Z. ) is Markovian this determines a semi-group on the\nZt = exp{Mt\u03b1 \u2212\n\n133\n\n\fCHAPTER 9. APPENDICES\n\n134\n\nspace of bounded measurable functions with corresponding probability measures\n{Qy0 }y0 \u2208N .\nProposition 9.1.1 The family {Qy0 }y0 \u2208N is a solution to the martingale problem\nfor the operator B + b.\n\nProof. Let f : N \u2192 R be C \u221e with compact support. We must show, for arbitrary\ny0 \u2208 N, that\nZ t\nf (yt ) \u2212 f (y0) \u2212\n(B + b)f (ys )ds\n0\u2264t6T\n0\n\nis a local martingale under Qy0 . For this first note that Z. satisfies the usual\nstochastic equation which in our notation becomes:\nZt = 1 + MtZ\u03b1 ,\n\n06t6T\n\nNow use Ito's formula and the definition of M \u03b1 to see that\nf (yt)Zt = f (y0 ) +\n\nZ(df )y.\nMt\n\n+\n\nMtf Z\u03b1\n\nZ\n\n+\n\nt\n\n0\n\nNow\ndf\n\nM ,M\n\nZ\u03b1\nt\n\nZ\n\nBf (ys )Zs ds + M df , M Z\u03b1 t . (9.1)\n\nt\n\n\u0001\n= 2\ndf \u03c3yBs (Zs \u03b1s ) ds\nZ t0\n\u0001\n=\ndf Zs b(ys ) ds.\n\n(9.2)\n(9.3)\n\n0\n\nThus\nf (yt )Zt \u2212 f (y0) \u2212\n\nZ\n\n0\n\nt\n\nBf (ys )Zs ds \u2212\n\nZ\n\nt\n0\n\n\u0001\ndf Zs b(ys ) ds,\n\n0 \u2264 t 6 T,\n\nis a local martingale under PBy0 and so there is a sequence {\u03c4n }n of stopping times,\nincreasing to T , such that if \u03c6 : Cy0 ([0, T ]; N + ) \u2192 R is Fry0 -measurable and\nbounded then, using the definition of Q and Fubini's theorem, if 0 6 r 6 t 6 T ,\n\u0013 \u0015\n\u0014\u0012\nZ t\u2227\u03c4n\nQ\n(B + b)(f )(ys )ds \u03c6\nf (yt\u2227\u03c4n ) \u2212\nE y0\n0\n\u0013 \u0015\n\u0014\u0012\nZ t\u2227\u03c4n\nB\n(B + b)(f )(ys )Zs ds \u03c6\nf (yt\u2227\u03c4n )Zt\u2227\u03c4n \u2212\n= E y0\n0\n\u0013 \u0015\n\u0014\u0012\nZ r\u2227\u03c4n\nB\n(B + b)(f )(ys )Zs ds \u03c6 .\nf (yr\u2227\u03c4n )Zr\u2227\u03c4n \u2212\n= E y0\n0\n\n\f9.2. STOCHASTIC DIFFERENTIAL EQUATIONS FOR DEGENERATE DIFFUSIONS135\ngiving the required martingale property.\nSince Qt (1) = EZt we immediately obtain the following corollary and a theorem:\nCorollary 9.1.2 . Suppose further that uniqueness of the martingale problem\nholds for B + b, e.g suppose b is locally Lipschitz [39]. Then\nEBy0 Zt\nis the probability that the diffusion process from y0 generated by B + b has not\nexploded by time t.\nTheorem 9.1.3 Suppose the diffusion operator B and its perturbation B + b by a\nlocally Lipschitz vector field b on N are both conservative. Assume that B + b is\ncohesive or more generally that there is a locally bounded, measurable one-form\nb# on N such that\n2\u03c3yB (b#\ny \u2208 N.\ny ) = b(y),\nThen\n\n\u0001\n1\n#\nMb t ,\n06t6T\n2\nis a martingale under PB and for each y0 \u2208 N the measures PBy0 and PyB+b\non\n0\nCy0 ([0, T ]; N) are equivalent with\n#\n\nexp Mtb \u2212\n\ndPyB+b\n1\n#\n#\n0\n= exp MTb \u2212 M b\nB\ndPy0\n2\n\nT\n\n\u0001\n\n.\n\n9.2 Stochastic differential equations for degenerate\ndiffusions\nLet B be a (smooth) diffusion diffusion operator on N. If its symbol \u03c3 B : T \u2217 N \u2192\nT N does not have constant rank there may be no smooth, or even C 2 , factorisation\nX\u2217\n\nX\n\nT \u2217 N \u2192 Rm \u2192 T N\nof \u03c3xB into X(x)X \u2217 (x) for X : N \u00d7 Rm \u2192 T N, as usual, for any finite dimensional m. []. A factorisation with X : N \u00d7 H \u2192 T N, for H a separable\nHilbert space, can be found following Stroock and Varadhan, Appendix in [68].\n, with the property that X is continuous and each vector field X j is C \u221e , where\n\n\fCHAPTER 9. APPENDICES\n\n136\n\nX j (x) = X(x)(ej ) for an orthonormal basis (ej )\u221e\nj=1 of H. However it seems\nunclear if such an X can be found with each x 7\u2192 X(x)e, e \u2208 H, smooth. The\nfollowing is well known:\nTheorem 9.2.1 Let \u03c3 : Rd \u2192 L+ (Rm ; Rm\u221a\n) be a C 2 map into the symmetric\npositive semi-definite (m\u00d7m)-matrices then \u03c3 : Rd \u2192 L+ (Rm ; Rm ) is locally\nLipschitz .\nFor a proof see Freidlin [34], page 97 in [67] or Ikeda-Watanabe [39].\nCorollary 9.2.2 For a C 2 diffusion operator B on N there is a locally Lipschitz\nX : Rm \u2192 T N with \u03c3 B = XX \u2217 for some m.\ni\n\nProof. Take a smooth inclusion T N \u2192 Rm + as a sub-bundle \u0001(e.g. by embedding\nN in Rm ) and extend \u03c3 B trivially to \u03c3xB : N \u2192 L (Rm )\u2217 ; Rm by\ni\u2217\n\nx\nTx\u2217 N\n(Rm )\u2217 \u2192\n\n\u03c3B\n\nx\n\u2192\nTx N\n\ni\n\nx\n\u2192\nRm\n\nidentifying (Rm )\u2217 with Rm and take the square root.\nLet \u2207 be a connection on a sub-bundle G of T N and let X : Rm \u2192 G be a\nlocally Lipschitz bundle map. Let A be a locally Lipschitz vector field on N. As\nin Elworthy [21] (p184) we can form the It\u00f4 stochastic differential equation on N\n(\u2207)\n\ndxt = X(xt )dBt + A(xt )dt\n\nwhere (Bt ) is a Brownian motion on Rm . For given x0 \u2208 N there will be a unique\nmaximal solution {xt : 0 6 t < \u03b6 x0 } as usual, where by a solution we mean a\nsample continuous adapted process such that for all C 2 functions f : N \u2192 R\nZ t\nZ t\nf (xt ) = f (x0 ) +\n(df )xs X(xs )dBs +\n(df )xs A(xs )ds\n=\n\nZ tX\nm\n0\n\nj=1\n\n0\n\n0\n\n\u2207X j (xs ) (df |G )X j (xs )ds.\n\nIndeed in a local coordinate (U, \u03c6) system the equation is represented by\n\u0010\n\u0011\u0010\n\u0011\n1X\n\u0393\u03c6 (x\u03c6t ) X\u03c6j (x\u03c6t ) X\u03c6j (x\u03c6t ) dt + A\u03c6 (x\u03c6t )dt,\n2 j=1\nm\n\ndx\u03c6t = X\u03c6 (x\u03c6t )dBt \u2212\n\n\f9.3. SEMI-MARTINGALES & \u0393-MARTINGALES ALONG A SUB-BUNDLE 137\nwhere X\u03c6 , X\u03c6i , and A\u03c6 are the local representations of X, X i and A, and \u0393\u03c6 is the\nChristoffel symbol.\nNote that the generator of the solution process has symbol \u03c3x = X(x)X(x)\u2217 ,\nx \u2208 N, and so a Lipschitz factorisation of \u03c3 B together with a suitable choice of A\nwill give a diffusion process with generator B.\nIf in addition we have another generator G on N given in H\u00f6rmander form\nG=\n\np\nX\n\nLY k LY k + LY 0\n\nk=1\n\nfor Y 0 , Y 1 , . . . , Y k vector fields of class C 2 we can consider an SDE of mixed\ntype\n(\u2207)\n\ndxt =\n\np\nX\nk=1\n\nY k (xt ) \u25e6 dB\u0303tk + X(xt )dBt + (Y 0 (xt ) + A(xt ))dt\n\nfor B\u0303 1 , . . . , B\u0303 k independent Brownian motions on R independent of (Bt ). For a\nC 2 map f : N \u2192 R, a solution {xt : 0 6 t < \u03b6 x0 } will satisfy\nZ t\nZ tX\nn\nf (xt ) = f (x0 ) +\n(df )xs X(xs )dBs +\n(df )xs (X k (xs ))dB\u0303sk\n=\n\nZ\n\n0\n\n0 k=1\n\nt\n\n(B + G)f (xs )ds,\n\nt < \u03b6 x0 ,\n\n0\n\ngiving the unique solution to the martingale problem for B + G. These SDE's fit\ninto the general frame work of the 'It\u00f4 bundle' approach of Belopolskaya-Dalecky\n[6], see the Appendix of Brzezniak-Elworthy[11]; also see Emery [31](section\n6.33, page 85) for a more semi-martingale oriented approach.\n\n9.3 Semi-martingales & \u0393-martingales along a Subbundle\nSeveral of the concepts we have defined for diffusions also have versions for semimartingales, and these are relevant to the discussion of non-Markovian observations in Chapter 5. Only continuous semi-martingales will be considered. Let S\ndenote a sub-bundle of the tangent bundle T M to a smooth manifold M.\n\n\fCHAPTER 9. APPENDICES\n\n138\n\nDefinition 9.3.1 A semi-martingale ys , 0 6 s < \u03c4 is said to be along S if whenever \u03c6 is a C 2 one-form on M which annihilates S we have vanishing of the\nStratonovich integral of \u03c6 along y. :\nZ t\n\u03c6ys \u25e6 dys = 0 0 < t < \u03c4.\n0\n\nFor simplicity take y0 to be a point of M.\nProposition 9.3.2 The following are equivalent:\n1. the semi-martingale y. is along S;\n2. if \u03b1s : 0 6 s < \u03c4 is a semi-martingale with values in the annihilator of S in\nT \u2217 M, lying over y. , then\nZ t\n\u03b1ys \u25e6 dys = 0 0 < t < \u03c4 ;\n0\n\n3. for some, and hence any, connection \u0393 on S the process y. is the stochastic\ndevelopment of a semi-martingale ys\u0393, 0 6 s < \u03c4 on the fibre Sy0 of S above\ny0 .\nIf L is a diffusion operator then the associated diffusion processes are all along\nS if and only if L is along S in the sense of Section 1.3.\nProof. Let //. denote the parallel translation along the paths of y. using \u0393. If (3)\nholds then\ndy. = //. \u25e6 dy.\u0393\nand it is immediate that (2) is true. Also (2) trivially implies (1).\nNow suppose that (1) holds. Let \u0393 be a connection on E and \u03930 some extension of it to a connection on T M, so that the corresponding parallel translation\n0\n//0 will preserve S and some complementary sub- bundle of T M. Let y \u0393 be the\nstochastic anti-development of y. using this connection. To show (3) holds it suf0\nfices to show that y \u0393 takes values in Sy0 . For this choose a smooth vector bundle\nmap \u03a6 : T M \u2192 M \u00d7 Rm whose kernel is precisely S and let \u03c6 : T M \u2192 Rm\ndenote its principal part and \u03c6j , j = 1, ..., m the components of \u03c6. These are\none-forms which annihilates S. Then, for each j\nZ t\nZ t\n0\n0=\n\u03c6s \u25e6 dys =\n\u03c6s //0s \u25e6 dys\u0393 0 < t < \u03c4.\n0\n\n0\n\n\f9.3. SEMI-MARTINGALES & \u0393-MARTINGALES ALONG A SUB-BUNDLE 139\n0\n\nBy the lemma below we see that ys\u0393 \u2208 Sy0 for each s, almost surely, and the result\nfollows .\nFinally suppose that y. is a diffusion process with generator L. By lemma\n4.1.2 we have\nZ t\nZ t\n\u0001\n\u03b1\nMt =\n\u03b1ys \u25e6 dys \u2212\n\u03b4 L \u03b1 (ys )ds,\n0 6 t < \u03b6.\n(9.4)\n0\n\n0\n\nfor any C 2 one form \u03b1. Suppose \u03b1 annihilates\nS. Then if y. is along S\u0001 both the\nR.\nmartingale and finite variation parts of 0 \u03b1ys \u25e6 dys vanish and so \u03b4 L \u03b1 (ys ) = 0\nalmost surely for almost all 0 6 s < \u03c4 . If this is true for all starting points we see\nL is along S. On the other hand if L is along S and \u03b1 annihilates S we see that\nM \u03b1 vanishes by its characterisation in Proposition 4.1.1, Rsince \u03c3 L takes values in\n.\nS. Thus both the martingale and finite variation parts of 0 \u03b1ys \u25e6 dys vanish, and\nso the integral itself vanishes and the diffusion processes are along S.\n\nLemma 9.3.3 Suppose z. and \u039b. are semi-martingales with values in a finite dimensional vector space V and the space of linear maps L(V ; W ) of V into a finite\ndimensional vector space W , respectively. Let V0 denote the kernel of \u039bs which\nis assumed non-random and independent of s > 0 . Assume\nZ .\n\u039bs \u25e6 dzs = 0.\n0\n\nThen z. lies in V0 almost surely.\nProof. : We can quotient out by V0 to assume that V0 = 0, so we need to show that\nz. vanishes. Giving W an inner product, let Ps : W \u2192 \u039bs [V ] be the orthogonal\nprojection. Compose this with the inverse of \u039bs considered as taking values in\n\u039bs [V ], to obtain an L(W ; V )-valued semi-martingale \u039b\u0303. formed by left inverses\nof \u039b. . By the composition law for Stratonovich integrals\nZ t\nZ t\nZ t\nZ s\n\u0001\nzt =\ndzs =\n\u039b\u0303s \u039bs \u25e6 dzs =\n\u039b\u0303s \u25e6 d\n\u039br \u25e6 dzr = 0\n(9.5)\n0\n\n0\n\n0\n\n0\n\nas required.\n\nLet \u0393 be a connection on S. Note that by the previous proposition any semimartingale y. which is along S has a well defined anti-development y \u0393 , say , which\nis a semi-martingale in Sy0 .\n\n\fCHAPTER 9. APPENDICES\n\n140\n\nDefinition 9.3.4 An M -valued semi-martingale is said to be a \u0393-martingale if its\nanti-development using \u0393 is a local martingale.\nAlso we can make the following definition of an Ito integral of a differential form,\nusing the analogue of a characterisation by Darling, [16], for the case S = T M;\n\u2217\nDefinition 9.3.5 If \u03b1. is a predictable process\u0001 with\nR t values in T M, lying over our\nsemi-martingale y. , define its Ito integral, \u0393 0 \u03b1s dys along the paths of y. with\nrespect to \u0393 by\nZ\nZ t\n\u0001 t\n\u0393\n\u03b1s dys =\n\u03b1s //s dy \u0393\n(9.6)\n0\n\n0\n\nwhenever the (standard) Ito integral on the right hand side exists.\n\nAs usual this Ito integral is a local martingale for all suitable integrands \u03b1. if and\nonly if the process y. is a \u0393-martingale.\n\n\fBibliography\n[1] M. Arnaudon and S. Paycha. Factorisation of semi-martingales on principal\nfibre bundles and the Faddeev-Popov procedure in gauge theories. Stochastics Stochastics Rep., 53(1-2):81\u2013107, 1995.\n[2] F. Baudoin. Conditioning and initial enlargement of filtration on a Riemannian manifold. Ann. Probab., 32(3A):2286\u20132303, 2004.\n[3] Fabrice Baudoin. An introduction to the geometry of stochastic flows. Imperial College Press, London, 2004.\n[4] P. Baxendale. Gaussian measures on function spaces. Amer. J. Math.,\n98(4):891\u2013952, 1976.\n[5] P. Baxendale. Brownian motions in the diffeomorphism groups I. Compositio Math., 53:19\u201350, 1984.\n[6] Ya. I. Belopolskaya and Yu. L. Dalecky. Stochastic equations and differential\ngeometry, volume 30 of Mathematics and its Applications (Soviet Series).\nKluwer Academic Publishers Group, Dordrecht, 1990. Translated from the\nRussian.\n[7] L. B\u00e9rard-Bergery and J.-P. Bourguignon. Laplacians and Riemannian submersions with totally geodesic fibres. Illinois J. Math., 26(2):181\u2013200, 1982.\n[8] E. Berger, R. Bryant, and P. Griffiths. The Gauss equations and rigidity of\nisometric embeddings. Duke Math. J., 50(3):803\u2013892, 1983.\n[9] Jean-Michel Bismut. Large deviations and the Malliavin calculus, volume 45 of Progress in Mathematics. Birkh\u00e4user Boston Inc., Boston, MA,\n1984.\n141\n\n\f142\n\nBIBLIOGRAPHY\n\n[10] Hermann Boerner. Representations of groups. With special consideration for\nthe needs of modern physics. Translated from the German by P. G. Murphy in\ncooperation with J. Mayer-Kalkschmidt and P. Carr. Second English edition.\nNorth-Holland Publishing Co., Amsterdam, 1970.\n[11] Z. Brze\u017aniak and K. D. Elworthy. Stochastic differential equations on Banach manifolds. Methods Funct. Anal. Topology, 6(1):43\u201384, 2000.\n[12] A. Carverhill. Conditioning a lifted stochastic system in a product space.\nAnn. Probab., 16(4):1840\u20131853, 1988.\n[13] A. P. Carverhill and K. D. Elworthy. Flows of stochastic dynamical systems:\nthe functional analytic approach. Z. Wahrsch. Verw. Gebiete, 65(2):245\u2013267,\n1983.\n[14] Michael Cranston and Yves Le Jan. Asymptotic curvature for stochastic\ndynamical systems. In Stochastic dynamics (Bremen, 1997), pages 327\u2013338.\nSpringer, New York, 1999.\n[15] H. L. Cycon, R. G. Froese, W. Kirsch, and B. Simon. Schr\u00f6dinger operators\nwith application to quantum mechanics and global geometry. Texts and\nMonographs in Physics. Springer-Verlag, Berlin, study edition, 1987.\n[16] R. W. R. Darling. Approximating Ito integrals of differential forms and\ngeodesic deviation. Z. Wahrsch. Verw. Gebiete, 65(4):563\u2013572, 1984.\n[17] B. K. Driver. A Cameron-Martin type quasi-invariance theorem for Brownian motion on a compact Riemannian manifold. J. Functional Analysis,\n100:272\u2013377, 1992.\n[18] T. E. Duncan. Some filtering results in Riemann manifolds. Information and\nControl, 35(3):182\u2013195, 1977.\n[19] A. Eberle. Uniqueness and non-uniqueness of semigroups generated by singular diffusion operators, volume 1718 of Lecture Notes in Mathematics.\nSpringer-Verlag, Berlin, 1999.\n[20] D. G. Ebin and J. Marsden. Groups of diffeomorphisms and the motion of\nan incompressible fluid. Ann. Math., pages 102\u2013163, 1970.\n[21] K. D. Elworthy. Stochastic Differential Equations on Manifolds. LMS Lecture Notes Series 70, Cambridge University Press, 1982.\n\n\fBIBLIOGRAPHY\n\n143\n\n[22] K. D. Elworthy. Geometric aspects of diffusions on manifolds. In P. L. Hennequin, editor, Ecole d'Et\u00e9 de Probabilit\u00e9s de Saint-Flour XV-XVII, 19851987. Lecture Notes in Mathematics 1362, volume 1362, pages 276\u2013425.\nSpringer-Verlag, 1988.\n[23] K. D. Elworthy. Stochastic flows on Riemannian manifolds. In Diffusion\nprocesses and related problems in analysis, Vol. II (Charlotte, NC, 1990),\nvolume 27 of Progr. Probab., pages 37\u201372. Birkh\u00e4user Boston, Boston, MA,\n1992.\n[24] K. D. Elworthy and W. S. Kendall. Factorization of harmonic maps and\nBrownian motions. In From local times to global geometry, control and\nphysics (Coventry, 1984/85), Pitman Res. Notes Math. Ser., 150, pages 75\u2013\n83. Longman Sci. Tech., Harlow, 1986.\n[25] K. D. Elworthy, Y. Le Jan, and Xue-Mei Li. Equivariant diffusions on principal bundles. In Stochastic analysis and related topics in Kyoto, volume 41\nof Adv. Stud. Pure Math., pages 31\u201347. Math. Soc. Japan, Tokyo, 2004.\n[26] K. D. Elworthy, Y. LeJan, and Xue-Mei Li. Concerning the geometry\nof stochastic differential equations and stochastic flows. In 'New Trends\nin stochastic Analysis', Proc. Taniguchi Symposium, Sept. 1994, Charingworth, ed. K. D. Elworthy and S. Kusuoka, I. Shigekawa. World Scientific\nPress, 1996.\n[27] K. D. Elworthy, Y. LeJan, and Xue-Mei Li. On the geometry of diffusion operators and stochastic flows, Lecture Notes in Mathematics 1720. Springer,\n1999.\n[28] K. D. Elworthy and S. Rosenberg. Homotopy and homology vanishing theorems and the stability of stochastic flows. Geom. Funct. Anal., 6(1):51\u201378,\n1996.\n[29] K. D. Elworthy and M. Yor. Conditional expectations for derivatives of certain stochastic flows. In J. Az\u00e9ma, P.A. Meyer, and M. Yor, editors, Sem.\nde Prob. XXVII. Lecture Notes in Maths. 1557, pages 159\u2013172. SpringerVerlag, 1993.\n[30] K. David Elworthy. The space of stochastic differential equations. In\nStochastic analysis and applications, volume 2 of Abel Symp., pages 327\u2013\n337. Springer, Berlin, 2007.\n\n\f144\n\nBIBLIOGRAPHY\n\n[31] M. \u00c9mery. Stochastic calculus in manifolds. Universitext. Springer-Verlag,\nBerlin, 1989. With an appendix by P.-A. Meyer.\n[32] A. Estrade, M. Pontier, and P. Florchinger. Filtrage avec observation discontinue sur une vari\u00e9t\u00e9. Existence d'une densit\u00e9 r\u00e9guli\u00e8re. Stochastics Stochastics Rep., 56(1-2):33\u201351, 1996.\n[33] Maria Falcitelli, Stere Ianus, and Anna Maria Pastore. Riemannian submersions and related topics. World Scientific Publishing Co. Inc., River Edge,\nNJ, 2004.\n[34] M. Freidlin. Functional integration and partial differential equations, volume 109 of Annals of Mathematics Studies. Princeton University Press,\nPrinceton, NJ, 1985.\n[35] Zhong Ge. Betti numbers, characteristic classes and sub-Riemannian geometry. Illinois J. Math., 36(3):372\u2013403, 1992.\n[36] Mikhael Gromov. Carnot-Carath\u00e9odory spaces seen from within. In\nSub-Riemannian geometry, volume 144 of Progr. Math., pages 79\u2013323.\nBirkh\u00e4user, Basel, 1996.\n[37] Robert Hermann. A sufficient condition that a mapping of Riemannian manifolds be a fibre bundle. Proc. Amer. Math. Soc., 11:236\u2013242, 1960.\n[38] J. E. Humphreys. Introduction to Lie algebras and representation theory,\nvolume 9 of Graduate Texts in Mathematics. Springer-Verlag, New York,\n1978. Second printing, revised.\n[39] N. Ikeda and S. Watanabe. Stochastic Differential Equations and Diffusion\nProcesses , second edition. North-Holland, 1989.\n[40] S. Kobayashi and K. Nomizu. Foundations of differential geometry, Vol. I.\nInterscience Publishers, 1969.\n[41] S. Kobayashi and K. Nomizu. Foundations of differential geometry, Vol. II.\nInterscience Publishers, 1969.\n[42] I. Kol\u00e1\u0159, P. W. Michor, and J. Slov\u00e1k. Natural operations in differential\ngeometry. Springer-Verlag, Berlin, 1993.\n\n\fBIBLIOGRAPHY\n\n145\n\n[43] Hiroshi Kunita. Stochastic flows and stochastic differential equations, volume 24 of Cambridge Studies in Advanced Mathematics. Cambridge University Press, Cambridge, 1990.\n[44] Joan-Andreu Lazaro-Cami and Juan-Pablo Ortega. Reduction, reconstruction, and skew-product decomposition of symmetric stochastic differential\nequations. arXiv:0705.3156v2 [math.PR].\n[45] Remi Leandre. Applications of the Malliavin calculus of Bismut type without probability. WSEAS Trans. Math., 5(11):1205\u20131210, 2006.\n[46] S. Lemaire. Invariant jets of a smooth dynamical system. Bull. Soc. Math.\nFrance, 129(3):379\u2013448, 2001.\n[47] Xue-Mei Li. Stochastic differential equations on noncompact manifolds:\nmoment stability and its topological consequences. Probab. Theory Related\nFields, 100(4):417\u2013428, 1994.\n[48] M. Liao. Factorization of diffusions on fibre bundles. Trans. Amer. Math.\nSoc., 311(2):813\u2013827, (1989).\n[49] Ming Liao. Decomposition of stochastic flows and Lyapunov exponents.\nProbab. Theory Related Fields, 117(4):589\u2013607, 2000.\n[50] Henry P. McKean. Stochastic integrals. AMS Chelsea Publishing, Providence, RI, 2005. Reprint of the 1969 edition, with errata.\n[51] P. W. Michor. Gauge theory for fiber bundles, volume 19 of Monographs and\nTextbooks in Physical Science. Lecture Notes. Bibliopolis, Naples, 1991.\n[52] Richard Montgomery. A tour of subriemannian geometries, their geodesics\nand applications, volume 91 of Mathematical Surveys and Monographs.\nAmerican Mathematical Society, Providence, RI, 2002.\n[53] M. S. Narasimhan and S. Ramanan. Existence of universal connections.\nAmerican J. Math., 83, 1961.\n[54] O. A. Ole\u0131\u0306nik. On linear equations of the second order with a non-negative\ncharacteristic form. Mat. Sb. (N.S.), 69 (111):111\u2013140, 1966.\n[55] Barrett O'Neill. The fundamental equations of a submersion. Michigan\nMath. J., 13:459\u2013469, 1966.\n\n\f146\n\nBIBLIOGRAPHY\n\n[56] E. Pardoux. Nonlinear filtering, prediction and smoothing. In Stochastic systems: the mathematics of filtering and identification and applications (Les\nArcs, 1980), volume 78 of NATO Adv. Study Inst. Ser. C: Math. Phys. Sci.,\npages 529\u2013557. Reidel, Dordrecht, 1981.\n[57] \u00c9tienne Pardoux. Filtrage non lin\u00e9aire et \u00e9quations aux d\u00e9riv\u00e9es partielles\nstochastiques associ\u00e9es. In \u00c9cole d'\u00c9t\u00e9 de Probabilit\u00e9s de Saint-Flour XIX-\n1989, volume 1464 of Lecture Notes in Math., pages 67\u2013163. Springer,\nBerlin, 1991.\n[58] E. J. Pauwels and L. C. G. Rogers. Skew-product decompositions of Brownian motions. In Geometry of random motion (Ithaca, N.Y., 1987), volume 73\nof Contemp. Math., pages 237\u2013262. Amer. Math. Soc., 1988.\n[59] Monique Pontier and Jacques Szpirglas. Filtering with observations on a\nRiemannian symmetric space. In Stochastic differential systems (Bad Honnef, 1985), volume 78 of Lecture Notes in Control and Inform. Sci., pages\n316\u2013329. Springer, Berlin, 1986.\n[60] D. Quillen. Superconnection character forms and the Cayley transform.\nTopology, 27(2):211\u2013238, 1988.\n[61] Michael Reed and Barry Simon. Methods of modern mathematical physics.\nI. Academic Press Inc. [Harcourt Brace Jovanovich Publishers], New York,\nsecond edition, 1980. Functional analysis.\n[62] Daniel Revuz and Marc Yor. Continuous martingales and Brownian motion,\nvolume 293 of Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-Verlag, Berlin, third\nedition, 1999.\n[63] L. C. G. Rogers and D. Williams. Diffusions, Markov processes, and martingales. Vol. 2. Cambridge Mathematical Library. Cambridge University\nPress, Cambridge, 2000.\n[64] S. Rosenberg. The Laplacian on a Riemannian manifold, volume 31 of London Mathematical Society Student Texts. Cambridge University Press, Cambridge, 1997. An introduction to analysis on manifolds.\n[65] Paulo R. C. Ruffino. Decomposition of stochastic flows and rotation matrix.\nStoch. Dyn., 2(1):93\u2013107, 2002.\n\n\fBIBLIOGRAPHY\n\n147\n\n[66] D. Stroock and S. R. S. Varadhan. On degenerate elliptic-parabolic operators\nof second order and their associated diffusions. Comm. Pure Appl. Math.,\n25:651\u2013713, 1972.\n[67] D. W. Stroock. Lectures on stochastic analysis: diffusion theory, volume 6\nof London Mathematical Society Student Texts. Cambridge University Press,\nCambridge, 1987.\n[68] D. W. Stroock and S. R. S. Varadhan. Multidimensional diffusion processes,\nvolume 233 of Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-Verlag, Berlin, 1979.\n[69] H. J. Sussmann. Orbits of families of vector fields and integrability of distributions. Trans. Amer. Math. Soc., 180:171\u2013188, 1973.\n[70] Kazuaki Taira. Diffusion processes and partial differential equations. Academic Press Inc., Boston, MA, 1988.\n[71] B Tsirelson. Filtrations of random processes in the light of classification\ntheory. (i). a topological zero-one law. arXiv:math.PR/0107121, 2001.\n\n\fIndex\nGLM, 42\nD \u2032 (x), 32\nD 0 (x), 32\n\u0393-martingale, 89, 140\ncohesive\ndescends, 28\nconnection\nLW, 45\nadjoint\nsemi-connection, 41\nalong S\ndiffusion operator, 14\nsemi-martingale, 138\n\nderivative\nflow, 46\ndevelopment\nstochastic, 138\ndiffusion\nmeasure, 59\noperator, 11\ndistribution, 14\nregular, 15\nDuncan-Mortensen-Zakai equation, 85\nflow\nderivative, 44, 45, 48, 81\ngradient, 46\nholonomy, 33\nof isometries, 48\nof SDE, 44\nstochastic, 119\nframe bundle, 42\n\nconnection\ncomplete, 32\nLevi-Civita, 45\nLW, 41\nsemi-, 21\nGradient Brownian\nstochastically complete, 102\nSDE, 45\nstrongly stochastically complete, 102\nconnections\nH\u00f6rmander\ndetermined by stochastic flows, 117\ncondition, 106, 109, 110\ncurvature\nform, 4, 23, 24, 26, 41, 50, 55, 97,\nform, 37\n98, 104, 108, 109, 126, 137\nrepresentation, 12\noperator, 42, 57\nHeisenberg group, 27\nparallel, 111\nRicci, 42, 46, 56\nholonomy group, 37\nWeitzenb\u00f6ck, 48, 52, 54, 57\nhorizontal, 17\n148\n\n\fINDEX\ninnovations process, 88\nKallianpur-Striebel formula, 85\nLW connection, 41\noperator\ncurvature, 42\ndiffusion, 11\nsemi-elliptic, 11\nsymbol, 11\nreproducing kernel, 120, 125\nsecond fundamental form, 45\nsemi-elliptic, 11\nshape operator, 45\nstochastic partial differential equation,\n93\nsymbol, 11\nprojectible, 22\nvertical, 17\n\n149\n\n\f"}