{"id": "http://arxiv.org/abs/math/0402397v2", "guidislink": true, "updated": "2004-02-26T19:00:03Z", "updated_parsed": [2004, 2, 26, 19, 0, 3, 3, 57, 0], "published": "2004-02-24T21:09:18Z", "published_parsed": [2004, 2, 24, 21, 9, 18, 1, 55, 0], "title": "A Unified Approach to Combinatorial Formulas for Schubert Polynomials", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0402006%2Cmath%2F0402213%2Cmath%2F0402414%2Cmath%2F0402308%2Cmath%2F0402029%2Cmath%2F0402059%2Cmath%2F0402355%2Cmath%2F0402071%2Cmath%2F0402075%2Cmath%2F0402227%2Cmath%2F0402307%2Cmath%2F0402464%2Cmath%2F0402286%2Cmath%2F0402330%2Cmath%2F0402397%2Cmath%2F0402222%2Cmath%2F0402127%2Cmath%2F0402168%2Cmath%2F0402149%2Cmath%2F0402297%2Cmath%2F0402221%2Cmath%2F0402252%2Cmath%2F0402023%2Cmath%2F0402204%2Cmath%2F0402054%2Cmath%2F0402012%2Cmath%2F0402089%2Cmath%2F0402051%2Cmath%2F0402009%2Cmath%2F0402236%2Cmath%2F0402243%2Cmath%2F0402233%2Cmath%2F0402354%2Cmath%2F0402194%2Cmath%2F0402390%2Cmath%2F0402270%2Cmath%2F0402219%2Cmath%2F0402081%2Cmath%2F0402368%2Cmath%2F0402090%2Cmath%2F0402079%2Cmath%2F0402205%2Cmath%2F0402436%2Cmath%2F0402312%2Cmath%2F0402405%2Cmath%2F0402036%2Cmath%2F0402280%2Cmath%2F0402135%2Cmath%2F0402447%2Cmath%2F0402335%2Cmath%2F0402165%2Cmath%2F0402444%2Cmath%2F0402045%2Cmath%2F0402268%2Cmath%2F0402084%2Cmath%2F0402060%2Cmath%2F0402352%2Cmath%2F0402018%2Cmath%2F0402380%2Cmath%2F0402348%2Cmath%2F0402091%2Cmath%2F0402350%2Cmath%2F0402299%2Cmath%2F0402349%2Cmath%2F0402404%2Cmath%2F0402142%2Cmath%2F0402328%2Cmath%2F0402452%2Cmath%2F0402139%2Cmath%2F0402040%2Cmath%2F0402191%2Cmath%2F0402391%2Cmath%2F0402251%2Cmath%2F0402226%2Cmath%2F0402266%2Cmath%2F0402159%2Cmath%2F0402449%2Cmath%2F0402005%2Cmath%2F0402367%2Cmath%2F0402283%2Cmath%2F0402309%2Cmath%2F0402022%2Cmath%2F0402014%2Cmath%2F0402273%2Cmath%2F0402171%2Cmath%2F0402103%2Cmath%2F0402187%2Cmath%2F0402182%2Cmath%2F0402188%2Cmath%2F0402324%2Cmath%2F0402126%2Cmath%2F0402306%2Cmath%2F0402112%2Cmath%2F0402394%2Cmath%2F0402257%2Cmath%2F0402078%2Cmath%2F0402432%2Cmath%2F0402321%2Cmath%2F0402152%2Cmath%2F0402160%2Cmath%2F0402129&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Unified Approach to Combinatorial Formulas for Schubert Polynomials"}, "summary": "Schubert polynomials were introduced in the context of the geometry of flag\nvarieties. This paper investigates some of the connections not yet understood\nbetween several combinatorial structures for the construction of Schubert\npolynomials; we also present simplifications in some of the existing approaches\nto this area. We designate certain line diagrams known as rc-graphs as the main\nstructure. The other structures in the literature we study include:\nsemistandard Young tableaux, Kohnert diagrams, and balanced labelings of the\ndiagram of a permutation. The main tools in our investigation are certain\noperations on rc-graphs, which correspond to the coplactic operations on\ntableaux, and thus define a crystal graph structure on rc-graphs; a new\ndefinition of these operations is presented. One application of these\noperations is a straightforward, purely combinatorial proof of a recent formula\n(due to Buch, Kresch, Tamvakis, and Yong), which expresses Schubert polynomials\nin terms of products of Schur polynomials. In spite of the fact that it refers\nto many objects and results related to them, the paper is mostly\nself-contained.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0402006%2Cmath%2F0402213%2Cmath%2F0402414%2Cmath%2F0402308%2Cmath%2F0402029%2Cmath%2F0402059%2Cmath%2F0402355%2Cmath%2F0402071%2Cmath%2F0402075%2Cmath%2F0402227%2Cmath%2F0402307%2Cmath%2F0402464%2Cmath%2F0402286%2Cmath%2F0402330%2Cmath%2F0402397%2Cmath%2F0402222%2Cmath%2F0402127%2Cmath%2F0402168%2Cmath%2F0402149%2Cmath%2F0402297%2Cmath%2F0402221%2Cmath%2F0402252%2Cmath%2F0402023%2Cmath%2F0402204%2Cmath%2F0402054%2Cmath%2F0402012%2Cmath%2F0402089%2Cmath%2F0402051%2Cmath%2F0402009%2Cmath%2F0402236%2Cmath%2F0402243%2Cmath%2F0402233%2Cmath%2F0402354%2Cmath%2F0402194%2Cmath%2F0402390%2Cmath%2F0402270%2Cmath%2F0402219%2Cmath%2F0402081%2Cmath%2F0402368%2Cmath%2F0402090%2Cmath%2F0402079%2Cmath%2F0402205%2Cmath%2F0402436%2Cmath%2F0402312%2Cmath%2F0402405%2Cmath%2F0402036%2Cmath%2F0402280%2Cmath%2F0402135%2Cmath%2F0402447%2Cmath%2F0402335%2Cmath%2F0402165%2Cmath%2F0402444%2Cmath%2F0402045%2Cmath%2F0402268%2Cmath%2F0402084%2Cmath%2F0402060%2Cmath%2F0402352%2Cmath%2F0402018%2Cmath%2F0402380%2Cmath%2F0402348%2Cmath%2F0402091%2Cmath%2F0402350%2Cmath%2F0402299%2Cmath%2F0402349%2Cmath%2F0402404%2Cmath%2F0402142%2Cmath%2F0402328%2Cmath%2F0402452%2Cmath%2F0402139%2Cmath%2F0402040%2Cmath%2F0402191%2Cmath%2F0402391%2Cmath%2F0402251%2Cmath%2F0402226%2Cmath%2F0402266%2Cmath%2F0402159%2Cmath%2F0402449%2Cmath%2F0402005%2Cmath%2F0402367%2Cmath%2F0402283%2Cmath%2F0402309%2Cmath%2F0402022%2Cmath%2F0402014%2Cmath%2F0402273%2Cmath%2F0402171%2Cmath%2F0402103%2Cmath%2F0402187%2Cmath%2F0402182%2Cmath%2F0402188%2Cmath%2F0402324%2Cmath%2F0402126%2Cmath%2F0402306%2Cmath%2F0402112%2Cmath%2F0402394%2Cmath%2F0402257%2Cmath%2F0402078%2Cmath%2F0402432%2Cmath%2F0402321%2Cmath%2F0402152%2Cmath%2F0402160%2Cmath%2F0402129&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Schubert polynomials were introduced in the context of the geometry of flag\nvarieties. This paper investigates some of the connections not yet understood\nbetween several combinatorial structures for the construction of Schubert\npolynomials; we also present simplifications in some of the existing approaches\nto this area. We designate certain line diagrams known as rc-graphs as the main\nstructure. The other structures in the literature we study include:\nsemistandard Young tableaux, Kohnert diagrams, and balanced labelings of the\ndiagram of a permutation. The main tools in our investigation are certain\noperations on rc-graphs, which correspond to the coplactic operations on\ntableaux, and thus define a crystal graph structure on rc-graphs; a new\ndefinition of these operations is presented. One application of these\noperations is a straightforward, purely combinatorial proof of a recent formula\n(due to Buch, Kresch, Tamvakis, and Yong), which expresses Schubert polynomials\nin terms of products of Schur polynomials. In spite of the fact that it refers\nto many objects and results related to them, the paper is mostly\nself-contained."}, "authors": ["Cristian Lenart"], "author_detail": {"name": "Cristian Lenart"}, "author": "Cristian Lenart", "links": [{"href": "http://arxiv.org/abs/math/0402397v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0402397v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.AG", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05E99; 14M15", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0402397v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0402397v2", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0402397v2 [math.CO] 26 Feb 2004\n\nA UNIFIED APPROACH TO COMBINATORIAL FORMULAS FOR SCHUBERT\nPOLYNOMIALS\nCRISTIAN LENART\n\nAbstract. Schubert polynomials were introduced in the context of the geometry of flag varieties.\nThis paper investigates some of the connections not yet understood between several combinatorial\nstructures for the construction of Schubert polynomials; we also present simplifications in some of the\nexisting approaches to this area. We designate certain line diagrams known as rc-graphs as the main\nstructure. The other structures in the literature we study include: semistandard Young tableaux,\nKohnert diagrams, and balanced labelings of the diagram of a permutation. The main tools in our\ninvestigation are certain operations on rc-graphs, which correspond to the coplactic operations on\ntableaux, and thus define a crystal graph structure on rc-graphs; a new definition of these operations\nis presented. One application of these operations is a straightforward, purely combinatorial proof of a\nrecent formula (due to Buch, Kresch, Tamvakis, and Yong), which expresses Schubert polynomials in\nterms of products of Schur polynomials. In spite of the fact that it refers to many objects and results\nrelated to them, the paper is mostly self-contained.\n\n1. Introduction\nSchubert polynomials are relevant to the geometry of flag varieties, and their study leads to some\nsubtle combinatorics, generalizing the combinatorics of semistandard Young tableaux (SSYT) related\nto Schur polynomials (which are special cases). Schubert polynomials were defined and investigated by\nLascoux and Sch\u00fctzenberger in a series of papers, including [14, 22, 23, 24, 25, 26]. The combinatorics\nrelated to Schubert polynomials attracted the interest of many people in algebraic combinatorics (see the\nreferences). Several combinatorial constructions of Schubert polynomials appeared in the literature in\nthe last decade, together with many generalizations of them (such as generalizations to other Lie groups,\nto the K-theory and the quantum cohomology of flag varieties etc.). While all these generalizations\nappeared, the connections between the existing structures for the construction of Schubert polynomials\nthemselves were not fully understood. In this paper we attempt to elucidate some of the connections\nnot yet understood, and to present simplifications in some of the existing approaches to this area.\nWe start with a brief introduction to the theory of Schubert polynomials; for more information,\nwe refer the reader to [13, 31, 32]. Let F ln be the variety of complete flags (0 = V0 \u2282\u0001 V1 \u2282 . . . \u2282\nVn\u22121 \u2282 Vn = Cn ) in Cn . This is an irreducible algebraic variety of complex dimension n2 . Its integral\ncohomology ring H \u2217 (F ln ) is isomorphic to Z[x1 , . . . , xn ]/In , where In is the ideal generated by symmetric\npolynomials in x1 , . . . , xn with constant term 0; the elements xi are identified here with the Chern classes\nof the dual line bundles L\u2217i , where Li := Vi /Vi\u22121 are tautological line bundles. The variety F ln is a\ndisjoint union of cells indexed by permutations w in the symmetric group Sn . Their closures are the\nSchubert varieties Xw , of complex dimension l(w); here l(w) denotes the length of w, that is, the number\nof its inversions. The Schubert polynomial Sw (X) (defined below) is a certain polynomial representative\nfor the cohomology class corresponding to Xw . It is a homogeneous polynomial in x1 , . . . , xn\u22121 of degree\nl(w) with nonnegative integer coefficients.\nNote that the above structure theorem for H \u2217 (F ln ) holds, more generally, for flag bundles F l(V )\ncorresponding to a vector bundle V of finite rank n on a variety X. In this case, H \u2217 (F l(V )) is a free\nmodule over H \u2217 (X) with basis given by Schubert polynomials.\nThe construction of Schubert polynomials is based on divided difference operators \u2202i , which were\noriginally introduced in the context of generalized flag varieties [4, 19]. As operators on Z[x1 , x2 , . . .],\nMost of this work was done while the author was supported by Max-Planck-Institut f\u00fcr Mathematik.\n1\n\n\f2\n\nCRISTIAN LENART\n\nthese are defined as follows:\n1 \u2212 si\n;\nxi \u2212 xi+1\nhere si is the adjacent transposition ti,i+1 acting in the obvious way on the polynomial algebra, 1 is the\nidentity on this algebra, and xi denotes multiplication by this variable.\n\n(1.1)\n\n\u2202i :=\n\nSchubert polynomials are defined inductively for each w in Sn by setting Sw0n (X) := x1n\u22121 x2n\u22122 . . . xn\u22121\nfor w0n := n(n \u2212 1) . . . 1 the longest permutation in Sn (we use the one-line notation for permutations\nthroughout, unless otherwise specified), and by letting\n(1.2)\n\nSwsi (X) := \u2202i (Sw (X)) ,\n\nif l(wsi ) = l(w) \u2212 1 .\n\nThe definition of Schubert polynomials does not depend on the chosen chain in the weak order on Sn\nfrom w0n to w because the operators \u2202i satisfy the braid relations\n\u2202i \u2202j = \u2202j \u2202i\n\nif |i \u2212 j| \u2265 2 ,\n\n\u2202i \u2202i+1 \u2202i = \u2202i+1 \u2202i \u2202i+1 .\nIn addition, we have \u2202i2 = 0. Also note that Schubert polynomials have a stability property,\nSin the sense\nthat their definition does not depend on n; this allows one to define them for w in S\u221e := n Sn , where\nSn \u0592\u2192 Sn+1 is the usual inclusion. In fact, the Schubert polynomials Sw (X) for w in S\u221e form a basis\nof Z[x1 , x2 , . . .].\nAs we mentioned above, there are several combinatorial constructions of Schubert polynomials. We\ndesignate certain line diagrams for permutations introduced in [11] and called rc-graphs in [2] (see Section\n2) as the main combinatorial structure for the construction of Schubert polynomials. The other structures\nin the literature we study include: semistandard Young tableaux [14, 25, 26, 34] (Sections 3-5), Kohnert\ndiagrams [18, 36, 37] (Section 6), and balanced labelings of the diagram of a permutation [10] (Section\n7). We do not mention here the construction of Schubert polynomials in terms of certain increasing\nlabeled chains in Bruhat order on the symmetric group [3]; the connection between these chains and\nrc-graphs is explored in [27]. The main tools in our investigation are certain operations on rc-graphs,\nwhich correspond to the coplactic operations on tableaux, and thus define a crystal graph structure on\nrc-graphs. A new definition of these operations is presented, and their properties are studied in Section\n3. Among the several applications of these operations is a straightforward, purely combinatorial proof\n(in Section 5) of a recent formula [7], which expresses Schubert polynomials in terms of products of\nSchur polynomials.\nAcknowledgements. The author is grateful to Sara Billey, Mark Shimozono, Ezra Miller, Anders\nBuch, Harry Tamvakis, and Alexander Yong for helpful discussions, as well as to one of the referees for\nproviding Remark 4.3.\n2. RC-Graphs\nRC-graphs are combinatorial objects associated to permutations w = w1 . . . wn in the symmetric\ngroup Sn . We let n and w be fixed throughout, unless otherwise specified. RC-graphs can be defined as\ncertain subsets of\n{(i, j) \u2208 Z>0 \u00d7 Z>0 : i + j \u2264 n} .\nGiven an arbitrary such subset of pairs R, we can define a linear order on it by setting\n(2.1)\n\n(i, j) \u2264 (i\u2032 , j \u2032 ) \u21d0\u21d2 (i < i\u2032 ) or (i = i\u2032 and j \u2265 j \u2032 ) .\n\nLet (ik , jk ) be the kth pair in this linear order, and let ak := ik + jk \u2212 1. Consider the sequences (words)\nred(R) := a1 a2 . . . ,\n\ncomp(R) := i1 i2 . . . .\n\nWe call R an rc-graph associated to w if red(R) is a reduced word for w; in this case, comp(R) is called\na compatible sequence with red(R). We denote the collection of rc-graphs associated to a permutation\nw by R(w), and the permutation corresponding to a given rc-graph R by w(R).\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n3\n\nAn alternative way to define R(w) is to consider all reduced words a1 . . . al(w) for w, and for each\nsuch word to consider all weakly increasing sequences i1 . . . il(w) of positive integers satisfying the \"compatibility\" conditions:\n(2.2)\n\nak < ak+1 implies ik < ik+1 for all 1 \u2264 k < l(w) ;\n\n(2.3)\n\nik \u2264 ak for all 1 \u2264 k \u2264 l(w) .\n\nNote that some reduced words may have no compatible sequences associated to them.\nWe can represent an rc-graph R graphically as a planar history of the inversions of w (see Example\n2.5). To this end, we draw n lines going up and to the right, such that the ith line starts at position\n(i, 1) and ends at position (1, wi ); here the positions are numbered as in a matrix, whence the first index\nis the row index, and the second one is the column index. The rule for constructing the line diagram\nis the following: two lines meeting at position (i, j) cross if (i, j) is in R; otherwise, they avoid each\nother at that position. Throughout this paper, we will use interchangeably the three representations\nof an rc-graph mentioned above (that is, as a subset of Z>0 \u00d7 Z>0 , as a pair of a reduced word and a\ncompatible sequence, and as a line diagram).\nGiven an rc-graph R, we define\nxR :=\n\nY\n\nxi .\n\n(i,j)\u2208R\n\nAccording to [2, 6, 11, 12, 23], the Schubert polynomial Sw (X) indexed by w can be expressed as\nX\nxR .\n(2.4)\nSw (X) =\nR\u2208R(w)\n\nNote that this formula was recently recovered in [15] in the algebraic and geometric context of determinantal ideals specified by rank conditions, based on the combinatorics of initial ideals for certain natural\nterm orders.\nBergeron and Billey [2] defined certain moves on rc-graphs, which they called ladder and chute moves.\nThese are the moves Lij and Cij of the following type:\nj\ni-m\n\nj+1\n\nj\n\nj+1\n\ni-m\n\nj-m\n\nj\n\nj-m\n\nj\n\ni\ni+1\n\ni\n\ni\ni\ni+1\n\nNote that Lij moves the cross in position (i, j) to some position (i \u2212 m, j + 1); we will denote it by\n(i, j) \u2192 (i \u2212 m, j + 1).\nRecall that a permutation w is determined by its code, denoted code(w), which is the sequence\n(c1 , . . . , cn\u22121 ) defined by ci = |{j : j > i and wj < wi }|. Let us also recall the rc-graphs Rbot (w) and\nRtop (w) defined by\nRbot (w) := {(i, j) : j \u2264 ci (w)} ,\n\nRtop (w) := {(i, j) : i \u2264 cj (w\u22121 )} .\n\nBergeron and Billey showed that R(w) is the transitive closure of {Rbot (w)} under ladder moves Lij\nwhich move the rightmost cross in a row (i.e., (i, l) is not in the rc-graph to which Lij is applied if l > j);\nwe call these moves, simply, L-moves. There is a dual property, namely that R(w) is the transitive\n\n\f4\n\nCRISTIAN LENART\n\nclosure of {Rtop (w)} under chute moves Cij which move the bottom cross in a row (i.e., (k, j) is not in\nthe rc-graph to which Cij is applied if k > i).\nExample 2.5. Here are two rc-graphs associated to the permutation w = 215463; the first is just\nRbot (w).\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n1\n\n1\n\n1\n\n2\n\n2\n\n3\n\n3\n\n4\n\n4\n\n5\n\n5\n\n6\n\n6\n\n2\n\n3\n\n4\n\n5\n\n6\n\nIt is useful to have a standard way of constructing a given rc-graph R for w from Rbot (w) via L-moves.\nThis can be done by applying the algorithm below, based on the Proposition following it.\nAlgorithm 2.6.\nset R\u2032 := Rbot (w);\nfor i from 1 to n \u2212 1 do\nfor j from n \u2212 i downto 1 do\nif (i, j) \u2208 R \\ R\u2032 then\nfind the position (k, l) where the lines of R\u2032 avoiding each other at (i, j) cross;\nset R\u2032 := R\u2032 \u222a {(i, j)} \\ {(k, l)};\nfi;\nod;\nod.\nProposition 2.7. In the above algorithm, each cross in position (k, l) is moved into position (i, j) by a\nsequence of L-moves.\nProof. Assume that the assertion is true for all previous moves. This implies that all crosses are left\njustified in the part of the rc-graph consisting of positions (p, q) > (i, j) in the order (2.1), that is, the\nunshaded region in the figure below.\n\nj\n\ni\n\nIt is not hard to check, based on this observation, that the two lines avoiding each other at position (i, j)\nmust follow a route of the form indicated in the figure below. Furthermore, there are no crosses to the\nright of the positions (p, q) > (i, j) where the two lines avoid each other (if any).\n\u0003\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n5\n\nExample 2.8. The standard sequence of L-moves for the second rc-graph in Example 2.5 is (4, 1) \u2192\n(2, 2), (2, 2) \u2192 (1, 3), (3, 2) \u2192 (2, 3), (5, 1) \u2192 (4, 2), (4, 2) \u2192 (3, 3).\nThe main feature of this construction is that the sequence of \"final\" positions of the crosses which\nare moved is increasing in the order defined in (2.1). We can use this idea to improve the algorithm\nof Bergeron and Billey based on L-moves, by constructing R(w) such that each rc-graph is obtained\nprecisely once. This procedure can be illustrated by constructing a tree whose root corresponds to\nRbot (w), and whose edges correspond to applying L-moves. For each rc-graph R (corresponding to a\ngiven vertex in the tree), we use the variable last(R) to record the position of the last cross moved to\na \"final\" position. We also use the variable current(R) to record the position of the last moved cross,\npossibly to a \"temporary\" position. This cross might or might not be moved by a subsequent L-move;\nif it is not moved, then it becomes the last cross moved to a \"final\" position. For Rbot (w), these two\nvariables are undefined. We can now describe the branching rule at an rc-graph R in our tree; the order\non pairs used is the one defined in (2.1).\nAlgorithm 2.9.\nfor all L-moves P \u2192 Q in R do\nif P = current(R) then\nif last(R) is undefined or Q > last(R) then\nconstruct R\u2032 by applying the move P \u2192 Q to R;\nlet current(R\u2032 ) := Q, last(R\u2032 ) := last(R);\nfi;\nelse\nif current(R) is defined then\nif Q > current(R) then\nconstruct R\u2032 by applying the move P \u2192 Q to R;\nlet current(R\u2032 ) := Q, last(R\u2032 ) := current(R);\nfi;\nelse\nconstruct R\u2032 by applying the move P \u2192 Q to R;\nlet current(R\u2032 ) := Q;\nfi;\nfi;\nod.\nWe believe this algorithm to be the most efficient one for constructing R(w) for w in Sn . Its complexity\nis clearly O(nc), where c is the cardinality of R(w). Other algorithms for constructing R(w), and thus\nthe multiset of monomials in Sw (X),\u0001appeared in [27] and [33]. As discussed in [27], their complexity is\nO(nlc), where l := l(w0n ) \u2212 l(w) = n2 \u2212 l(w).\n3. Double Crystal Graphs\nIn this section we study in more detail the double crystal graphs introduced in [14], with an eye\ntowards applications to the theory of Schubert polynomials; the results are then used in Sections 46. More precisely, we study the main properties of the generalizations of the coplactic operations on\nwords to biwords in the cases of both the plactic and the nilplactic monoid. We present a simple way\nof deducing these properties from those of the classical coplactic operations. The nilplactic case is\nthen easily reduced to the plactic one via the plactification map defined in [35]. The main feature of\nour approach, as opposed to the one in [14], is that it is centered around the concept of rc-graph (for\ninstance, we define coplactic operations directly on rc-graphs via r-pairing of crosses in two consecutive\nrows). Indeed, the construction of Schubert polynomials in terms of rc-graphs (2.4) is mentioned as a\ncorollary in the above paper, whereas, for us, it is the starting point.\n\n\f6\n\nCRISTIAN LENART\n\nWe start by recalling the setup, and we refer to [8, 13, 14, 30] for more details, including the standard\nfacts about the combinatorics of Young tableaux. This combinatorics is underlied by the plactic monoid,\nwhich is the monoid of words on a given alphabet modulo the Knuth (or plactic) equivalence; this, in\nturn, is the transitive closure of the relations\n(3.1)\n\n. . . ikj . . . \u223cK . . . kij . . .\n. . . jik . . . \u223cK . . . jki . . .\n\nfor i \u2264 j < k\nfor i < j \u2264 k .\n\nLet X and Y be two totally ordered alphabets; for convenience, we take X = Y := Z>0 . We consider\nbiwords, that is, two-rowed arrays\n\u0012 \u0013 \u0012\n\u0013\nu\nu1 . . . uk\nw :=\n=\nv1 . . . vk\nv\n\u0001\nwith ui in X and vj in Y . Recall that w is said to be in lexicographic order if its biletters uvii satisfy\n(ui < ui+1 ) or (ui = ui+1 and vi \u2264 vi+1 ) for i = 1, . . . , k \u2212 1 .\n\nOn the other hand, w is said to be in antilexicographic order if its biletters satisfy\n(ui > ui+1 ) or (ui = ui+1 and vi \u2264 vi+1 ) for i = 1, . . . , k \u2212 1 .\n\u0001\nrev \u0001\nGiven a biword w = uv , we let wrev := uvrev be the biword obtained by considering the corresponding\n\u2032\u0001\nreverse\nwords. Furthermore, we let w\u2032 = uv \u2032 be the unique biword obtained by rearranging the biletters\n\u0001\nof uv such that (w\u2032 )rev is in lexicographic order. From now, we will only consider words with no two\nidentical biletters, so the corresponding lexicographic and antilexicographic orders are strict.\n\u0001\nGiven a biword w = uv with wrev in antilexicographic order, we can associate with it a pair of SSYT\nof conjugate shapes (P (w), Q(w)); here P (w) is obtained by applying Schensted insertion to the word\nv, while Q(w) is obtained by conjugate placing the corresponding letters of u. This is a variation of\nthe Robinson-Schensted-Knuth (RSK) correspondence, which sets up a bijection between matrices of\nzeros and ones of finite support and pairs of SSYT of conjugate shapes. On the other hand, we can\nassociate a similar pair of SSYT to w\u2032 , denoted by (P (w\u2032 ), Q(w\u2032 )), with the only exception that Q(w\u2032 )\nis obtained by conjugate sliding the corresponding entries of v \u2032 . According to the symmetry property of\nthe mentioned variation of the RSK correspondence, we have that\n(3.2)\n\nP (w) = Q(w\u2032 ) and P (w\u2032 ) = Q(w) .\n\nFor more information on the above constructions we refer to [13] Appendix A.4.3.\nThe concepts of left and right strings for biwords in lexicographic order were defined in [14]; hence,\nwe have the corresponding generalizations to biwords of the coplactic operations on words,\nwhich we\n\u0001\nu\n+\n+\n\u2212\nrev\ndenote by e\u2212\nin\nr , fr , and er , fr . We now define these operations on biwords w = v with w\nl\nlp\nl1\nantilexicographic order. Write the word u in the form 1 . . . p , where i is the word with l letters equal\nto i, and v in the form col1 (w) . . . colp (w), where coli (w) are strictly decreasing sequences (columns) of\nlengths li . Given a pair of columns (u, v), we can apply jeu de taquin or inverse jeu de taquin to produce\ntwo different pairs of columns, which are denoted by jdt(u, v) and jdt\u22121 (u, v), respectively (see below).\nWith this in mind, we define\n\u0012 \u0013\n\u0012 \u0013\nu\u2191\nu\u2193\n+\ne+\n(w)\n:=\n,\nf\n(w)\n:=\n,\nr\nr\nv\u2191\nv\u2193\nwhere\nu \u2191:= 1l1 . . . rlr +1 (r + 1)lr+1 \u22121 . . . plp , u \u2193:= 1l1 . . . rlr \u22121 (r + 1)lr+1 +1 . . . plp ,\nand\nv \u2191:= col1 (w) . . . jdt(colr (w), colr+1 (w)) . . . colp (w) ,\nv \u2193:= col1 (w) . . . jdt\u22121 (colr (w), colr+1 (w)) . . . colp (w) .\nLet us now define precisely what we mean by jeu de taquin and inverse jeu de taquin on two columns\nu := (us > us\u22121 > . . . > u1 ) and v := (vt > vt\u22121 > . . . > v1 ) .\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n7\n\nWe place the two columns side by side, in a skew tableau denoted T (u, v), such that there is a maximum\noverlap between them. In other words, we find the unique i with max(0, t \u2212 s) \u2264 i \u2264 t such that the\nfollowing two conditions are satisfied (see the figure below):\n(1) uj \u2264 vi+j for 1 \u2264 j \u2264 t \u2212 i;\n(2) if i > max(0, t \u2212 s), then uk > vi+k\u22121 for some k with 1 \u2264 k \u2264 t \u2212 i + 1.\nIf i = 0, then we define jdt(u, v) := \u2205, and if i = t \u2212 s, then we define jdt\u22121 (u, v) := \u2205. If such a situation\n+\noccurs, the result of applying e+\nr or fr is defined to be the empty biword \u2205.\nExample 3.3. Here is an example of jeu de taquin on two columns.\n\n1\n3\n\ns=4\n\n2\n\n4\n\n3\n\n5\n\n6\n\n6\n\n1\ni=2\njdt\nt=5\n\n7\n\n2\n\n3\n\n3\n\n4\n\n5\n\n6\n\n6\n7\n\nThe following result is implicitly used in [14].\nLemma 3.4. There is at most one pair of columns of lengths s + 1 and t \u2212 1 in the plactic class of the\nword uv (the concatenation of u and v). If such a pair exists, then it is precisely jdt(u, v). Similarly for\njdt\u22121 (u, v).\nProof. It is well-known (see e.g. Corollary 2 on p. 62 in [13]) that the number of skew tableaux of a fixed\nshape in the plactic class of a given SSYT T \u2217 depends only on the shape of that tableau. Furthermore,\nthis number is a Littlewood-Richardson coefficient; thus, we get the same number if we transpose all\ntableaux involved. Now assume that jdt(u, v) 6= \u2205. By jeu de taquin, T (u, v) is in the plactic class of a\ntableau of shape (s + i, t \u2212 i)T with i > 0. Now let T \u2217 := U (s + i, t \u2212 i), where U (\u03bb) denotes the tableau\nof shape \u03bb with all entries in row i equal to i. It is easy to check that there is a unique skew tableaux\nof shape (s + t, t \u2212 1)/(t \u2212 1) in the plactic class of T \u2217 ; indeed, all the entries in its first rows must be\nequal to 1. The case jdt(u, v) = \u2205 is obvious. Hence the Lemma follows. A similar reasoning works for\nthe second part of the Lemma.\n\u0003\n\u2212\nLet us now recall the definition of e\u2212\nr and fr on biwords. In fact, this works for any biword w, so no\nassumption on the order of the biletters of w is needed. We simply set\n\u0012\n\u0013\n\u0012\n\u0013\nu\nu\n\u2212\n\u2212\ner (w) :=\n, fr (w) :=\n,\ner (v)\nfr (v)\n\nwhere er and fr are the usual coplactic operations on words, whose definition is based on the concept\n\u2212\nof r-pairing. If er (v) = \u2205 (resp. fr (v) = \u2205), then we set e\u2212\nr (w) := \u2205 (resp. fr (w) := \u2205).\nRecall that the r-pairing of a word u is just a set of indexed pairs (called r-pairs) (ui , uj ) such that\ni < j, ui = r + 1, and uj = r. View each r + 1 (resp. r) as a left (resp. right) paranthesis, ignoring\nthe other letters of u. The r-pairs of u are precisely the matched parantheses. The subword of unpaired\nr's and r + 1's is necessarily of the form rs (r + 1)t . Define er (u) to be the word obtained by changing\nthe leftmost unpaired r + 1 to r if t > 0; otherwise, define it to be the empty word \u2205. Similarly, fr (u)\nis defined by changing the rightmost unpaired r to r + 1 if s > 0. The operations fr define a directed\ngraph \u0393 on words in X \u2217 , whose edges are the ordered pairs (u, fr (u)), for fr (u) 6= \u2205; this is known as a\ncrystal graph.\n\n\f8\n\nCRISTIAN LENART\n\nRemark 3.5. Consider an arbitrary word u, and denote by u its subword consisting of letters r, r + 1.\nIt is easy to check that there is at most one word u \u2191 obtained from u by changing precisely one letter\nr + 1 to r such that Q(u \u2191) = Q(u). If such a word exists, then it is precisely er (u). Similarly for fr (u).\nLet us also recall at this point the operation \u03c3r , where \u03c3r (u) is defined by replacing the subword\nrs (r + 1)t with rt (r + 1)s . This gives an action of the symmetric group on words. The main properties\nof the operations er , fr , \u03c3r are summarized below.\nTheorem 3.6. [21, 30] Let h denote anyone of the operations er , fr , \u03c3r .\n(1) Let u the the row (resp. column) word of a skew tableau T . Then h(u) is the row (resp. column)\nword of a skew tableau of the same shape; this will be denoted by h(T ).\n(2) Let u and v be congruent words in the plactic monoid. Then h(u) is congruent to h(v). In particular, P (h(u)) = h(P (u)).\n(3) Let u be a word, and assume that h(u) 6= \u2205. Then Q(h(u)) = Q(u).\n(4) The connected components of \u0393 are the coplactic classes in X \u2217 . Two coplactic classes are isomorphic as subgraphs of \u0393 if and only if they are indexed by standard tableaux of the same shape.\nRemarks 3.7. (1) The first property implies that if w or wrev are in lexicographic or antilexicographic\n\u2212\norder, the same is true for e\u2212\nr (w) and fr (w) (assuming they are nonempty).\n(2) Clearly, we have\ne if and only if fr+ (w)\ne = w,\ne+\nr (w) = w\n\n\u2212\nand similarly for e\u2212\nr , fr .\n\n\u2212\n+\n+\nWe now present the relationship between the operations e\u2212\nr , fr on the one hand, and er , fr , on the\nother hand. This is mentioned in [14] in a slightly different context (of row words, rather than column\nwords). The author argues that the symmetry in the two alphabets X and Y allows one to exchange\nthe left and right strings. We make this argument explicit in the case of column words.\n\nProposition 3.8. For any biword w with wrev in antilexicographic order, we have\n\u2032\n+\n\u2032\ne\u2212\nr (w ) = (er (w)) ,\n\nand similarly for fr\u2212 , fr+ .\n\u0001\nProof. Consider a biword w = uv and its subword, denoted w, consisting of biletters with top component\n\u0001\n\u2032\u0001\nequal to r or r + 1. Denote w := uv and w\u2032 := uv \u2032 . Given a standard tableau T with n entries and a\nword v = v1 . . . vn , we denote by evac(T ) the evacuation of T , and by subs(v, T ) the array obtained by\nreplacing each entry i in T by vi .\n\u2032\nAssume that e\u2212\ne be the biword with w\nerev in antilexicographic order satisfying\nr (w ) 6= \u2205, and let w\n\u2032\n\u2212\nw\ne = er (w ). According to (3.2) and Theorem 3.6 (3), we have\n\u2032\n\n\u2032\n\u2032\nT\n\u2032\nP (w)\ne = Q(e\u2212\nr (w )) = subs(v , evac(Q (er (u ))))\n\n= subs(v \u2032 , evac(QT (u\u2032 ))) = Q(w \u2032 ) = P (w) .\n\nBy Lemma 3.4, it follows that w\ne = e+\nr (w), and thus the desired identity is proved. The only thing we\n+\n\u2032\nstill need to prove is that er (w) 6= \u2205 implies e\u2212\nr (w ) 6= \u2205. This follows using similar ideas, except that\nwe need Remark 3.5 instead of Lemma 3.4.\n\u0003\n\u0001\nIt turns out that it is convenient to identify in the obvious way a biword w = \u0001uv for which wrev\nis in antilexicographic order with a finite subset D of Z>0 \u00d7 Z>0 (each biletter uvii corresponds to a\npair (ui , vi )); this is called a diagram, and its elements are called cells. We also write u = row(D) and\nv = col(D). Note that biwords are usually identified with (0,1)-matrices of finite support, which is\nessentially the same thing, although our approach is slightly more convenient. On the other hand, the\nmatrix representation is sometimes useful, so we will use all the above representations interchangeably.\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n9\n\nIt is not hard to see that upon the above identification, we can define operations er and fr on a\n\u2032\ndiagram D such that (er (D))\u2032 = e\u2212\nr (D ), and similarly for fr . Indeed, given a diagram D, we scan its\ncells in rows r and r + 1 columnwise from left to right and from top to bottom. We mark every cell in\nrow r (resp. r + 1) as a left (resp. right) paranthesis, and match parantheses as usual. We define er (D)\nto be the diagram obtained by moving the rightmost unpaired cell in row r + 1 up by one position, if\nsuch a cell exists; otherwise, we define it to be the empty diagram \u2205. Similarly, we define fr (D) to be\nthe diagram obtained by moving the leftmost unpaired cell in row r down by one position, if such a cell\nexists; otherwise, we define it to be the empty diagram. Furthermore, we can also define \u03c3r (D) in the\nobvious way. Note that we can now restate the identity in Proposition 3.8 simply as\n(3.9)\n\ne+\nr (D) = er (D) ,\n\nand similarly for fr .\nExample 3.10. Here is an example of r-pairing on two successive rows of a diagram. The cells indicated\nwith the same symbol except those marked with a circle are r-paired. The moves corresponding to the\noperations er and fr are indicated by arrows.\n00\n11\n11\n00\n00\n0\n1\n00 11\n11\n00\n11\n0\n1\n00\n11\n11\n00\n00\n00\n0 11\n1\n00 11\n11\n00\n11\n00\n11\n00\n11\n00\n11\n00\n11\n\n00\n11\n11\n00\n00\n11\n00\n11\n00\n11\n00\n11\n\n111\n000\n000\n111\n000\n111\n\nWe now list the properties of the operations er and fr on diagrams. Also note that they define a\nb on the set of all diagrams.\ndirected graph \u0393\n\nTheorem 3.11. Let h denote anyone of the operations er , fr , \u03c3r , and let D be a diagram.\n(1) Assuming that h(D) 6= \u2205, we have P (h(D)) = P (D).\n(2) We have that Q(h(D)) = h(Q(D)).\nb consist of all the diagrams with a fixed P -tableau. Two such\n(3) The connected components of \u0393\ncomponents are isomorphic if and only if they are indexed by SSYT of the same shape.\nProof. The first property follows immediately from (3.9). The second property follows by combining\n(3.2) and Theorem 3.6 (2). The third property follows from the previous ones and Theorem 3.6 (4). \u0003\nWe now turn to the case of the nilplactic monoid, defined by the Coxeter-Knuth (or nilplactic) equivalence on reduced words for a permutation; this is the transitive closure of the relations\n. . . ikj . . . \u223cCK . . . kij . . .\n. . . jik . . . \u223cCK . . . jki . . .\n. . . i(i + 1)i . . . \u223cCK . . . (i + 1)i(i + 1) . . .\n\u0001\nwhere i < j < k. We again consider biwords w = uv with wrev in antilexicographic order, but now,\nthroughout the remaining part of this section, v is a reduced word (for some permutation). We can\ne\nagain associate with w a pair of SSYT of conjugate shapes (Pe(w), Q(w)),\nwith the only difference that\ne\nP (w) is obtained by applying the Edelman-Greene insertion procedure [8] to v. Recall that, in a similar\nway to Knuth equivalence, two reduced words are Coxeter-Knuth equivalent if and only if they have the\nsame Edelman-Greene insertion tableau. As mentioned in [14], we can define the operations ee+ and fe+\nr\n\nr\n\u22121\n\nf and its inverse (denoted by jdt\nf ).\nby using nilplactic jeu de taquin on two columns (denoted by jdt)\nHowever, due to the lack of symmetry for the current type of biwords, the only way to define an analog of\n\u2212\nthe operations e\u2212\nr and fr is via an analog of the diagram representation of a biword. The corresponding\nconstruction below is new.\n\u0001\n\u0001\nk\nWe will identify the biword w = uv = uv11 ...u\n...vk considered above with a line diagram R similar to\nan rc-graph, which we call stable rc-graph (for reasons having to do with the theory of stable Schubert\n\n\f10\n\nCRISTIAN LENART\n\npolynomials, also known as Stanley symmetric functions, cf. e.g. [12, 32]). We construct this as follows.\nLet m be the last (largest) entry of u, and let n \u2212 1 be the largest entry of v (thus, v is a reduced\nword for some permutation \u03c01 . . . \u03c0n in Sn ). The stable rc-graph R will be the subset of [m] \u0001\u00d7 [n + m]\nconsisting of the pairs (ui , vi + m \u2212 ui + 1), called crosses, which correspond to the biletters uvii of w (we\nlet [n] := {1, . . . , n} throughout this paper). This construction is best understood by considering the\ncorresponding graphical representation, which is similar to that of an rc-graph. We draw n lines going\nup and to the right, such that the ith line starts at position (m, i) and ends at position (1, \u03c0i + m); as\nfor rc-graphs, we use the matrix numbering of the positions. The rule for constructing the\u0001line diagram\nis the same as for rc-graphs (see the previous section). Given R identified with w = uv , we use the\nnotation scomp(R) for u, and red(R) for v. We call the former a semicompatible sequence, since it\nsatisfies only the first compatibility condition (2.2). We also denote by redi (R) the subword of red(R)\ncorresponding to the ith row of R, that is, to entries i in scomp(R). Note that when u is a compatible\nsequence to v, namely ui \u2264 vi for all i, cf. (2.3), then R is essentially an rc-graph.\nExample 3.12. Here is an example of a stable rc-graph. It corresponds to the biword\n\u0012\n\u0013\n1 1 3 3 4 4 4 5 5 5\n.\n3 1 4 2 3 2 1 5 4 2\nThus m = 5, n = 6, and the corresponding permutation is 542613.\n1\n\n1\n\n2\n\n3\n\n4\n\n5\n\n2\n\n3\n\n4\n\n5\n\n6\n\n6\n\n\u2212\nThe analogs eer , fer of the operations e\u2212\nr , fr above are now defined for stable rc-graphs R. We consider\nthe crosses in rows r and r +1 of R, and perform an r-pairing procedure identical to the one for diagrams.\nIn order to define eer (R), we perform an inverse chute move to the rightmost unpaired cross in row r + 1,\nif such a cross exists. Similarly, we define fer (R) by performing a chute move to the leftmost unpaired\ncross in row r, if such a cross exists. Furthermore, one can also define \u03c3\ner (R) by using a sequence of\nchute or inverse chute moves. Note that different moves on rc-graphs of the same nature were defined\nand studied recently in [33].\n\nRemarks 3.13. (1) If crosses (r, a) and (r + 1, b) form an r-pair, then all crosses (r, c) and (r + 1, c)\nwith a < c < b are r-paired (with some other crosses in such positions). Hence rows r and r + 1 in an\nrc-graph consist of a sequence of blocks of r-paired crosses shuffled with a sequence of crosses in row\nr + 1 followed by a sequence of crosses in row r.\n(2) The inverse chute move in the definition of eer is always possible if the corresponding unpaired\ncross exists. Indeed, the only way in which there is no inverse chute move applied to a cross (r + 1, a)\nis the one indicated in the figure below; namely, there is b such that the rc-graph contains the crosses\n(r, c) for a < c < b, and (r + 1, c) for a \u2264 c \u2264 b, but does not contain the cross (r, b).\n\nd\n\na\n\nb\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n11\n\nNow the cross (r + 1, b) must be r-paired with a cross (r, d), where d < a (indeed, the cross (r + 1, a) is\nthe righmost unpaired cross in row r + 1). But this is a contradiction to the fact that the cross (r + 1, a)\nis unpaired, by the previous remark. There is a similar argument involving the operation fer .\n(3) Assuming that eer (R) 6= \u2205, it is not hard to see, based on the first remark, that R and eer (R) have\nthe same r-pairing. Similarly for fer and \u03c3\ner .\nExample 3.14. Assume that rows r and r + 1 in a stable rc-graph are as in the figure below.\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10 11 12 13 14 15\n\nThe reduced word corresponding to the stable rc-graph contains the subword\n(13, 12, 11, 10, 8, 4, 3, 1, 15, 14, 9, 8, 7, 6, 4) .\nThe crosses marked with the same symbol are r-paired. The matching of certain crosses indicated\nby continuous lines is referred to in the proof of Proposition 3.18. The moves corresponding to the\noperations eer and fer are indicated by arrows.\n\nThe properties of the operations eer , fer on stable rc-graphs/biwords are easily deduced from those of\ner , fr on diagrams/biwords using the plactification map in [35]. This is a map \u03c6 from reduced words to\nwords which takes Coxeter-Knuth equivalence to Knuth equivalence. It is defined recursively by\n(3.15)\n\n\u03c6(\u2205) = \u2205 ,\n\n\u03c6(ru) = r\u03c3r (\u03c6(u)) ,\n\nwhere ru is a reduced word whose first entry is r. We summarize the properties of \u03c6 below.\nTheorem 3.16. [35] (1) A reduced word u is the row (resp. column) word of some skew tableau if and\nonly if \u03c6(u) is the row (resp. column) word of a skew tableau of the same shape.\n(2) If u and u\ne are Coxeter-Knuth equivalent words, then \u03c6(u) and \u03c6(e\nu) are Knuth equivalent. In\nother words, \u03c6(Pe(u)) = P (\u03c6(u)). In fact, more is true; namely, given reduced words u\u2032 uu\u2032\u2032 and u\u2032 u\neu\u2032\u2032\n\u2032\n\u2032\u2032\n\u2032\n\u2032\u2032\n\u2032\n\u2032\u2032\n\u2032\n\u2032\u2032\nwith u and u\ne Coxeter-Knuth equivalent, we have \u03c6(u uu ) = v vv and \u03c6(u u\neu ) = v e\nv v , where v and\nve are Knuth equivalent. In addition, the plactification map preserves the lengths of the corresponding\nsubwords.\ne\n(3) We have Q(\u03c6(u)) = Q(u)\nfor all reduced words u.\n\nNote that the second part of property (2) is not explicitly stated in [35], but easily follows using the\nargument in the proof of Lemma 20 in that paper. In fact, this argument applies to the special case\nwhen u and u\ne are three letter subwords related by a Coxeter-Knuth transformation; the general case then\neasily follows from here. We can now state the following analog of Lemma 3.4; it is a straightforward\nconsequence of this Lemma and of Theorem 3.16 (1)-(2).\n\nLemma 3.17. Given two columns (decreasing words) u, v of lengths s and t, there is at most one pair\nof columns of lengths s + 1 and t \u2212 1 in the nilplactic class of the word uv. If such a pair exists, then it\n\u22121\nf\nf (u, v).\nis precisely jdt(u,\nv). Similarly for jdt\n\nWe now show that the two types of operations (giving left and right strings) on stable rc-graphs\ncoincide. To this end, we first show that the operations eer and fer preserve the Pe-tableau.\n\nProposition 3.18. Let R be a stable rc-graph. If eer (R) 6= \u2205, then Pe (e\ner (R)) = Pe (R). Otherwise,\nf\ne\njdt(redr (R), redr+1 (R)) = \u2205. Similar statements hold for fr and \u03c3\ner .\n\n\f12\n\nCRISTIAN LENART\n\nProof. We can assume that R has crosses only in rows r and r + 1. We examine the Edelman-Greene\ninsertion procedure applied to the word (red(R))rev . It is well-known (cf. [8] Corollary 7.22) that the\nresult of the insertion is Pe T (R). Since the mentioned word is the concatenation of two rows (increasing\nwords) u, u\u2032 , the insertion procedure can be described as follows. Scan the crosses in row r from left to\nright, and match each one with the first (left-to-right) nonmatched cross in row r + 1 in the same or a\ngreater column. The matched crosses correspond to the pairs consisting of a letter in u\u2032 to be inserted\nand the letter in u it bumps; this still holds when the special bumping rule in the Edelman-Greene\ninsertion [8] applies. Hence, the second row of Pe T (R) consists of the letters of u corresponding to the\nmatched crosses in row r + 1. The first row can now be easily found, based only on the permutation\ncorresponding to R. Now let us perform the r-pairing procedure described above. Based on Remark\n3.13 (1), we deduce that the r-paired crosses in row r + 1 are precisely the previously matched crosses in\nthis row (see the figure referring to Example 3.14, where the matching is indicated by continuous lines).\nHence Pe(R) is determined by the r-paired crosses in row r + 1 and the permutation corresponding to\nR. The first part of the Proposition now follows by Remark 3.13 (3). The second part also follows;\nindeed, according to the remarks above, if all crosses in row r + 1 are r-paired, then red(R) is precisely\nthe column word of Pe(R). A similar argument holds for fer and \u03c3\ner .\n\u0003\nCombining Proposition 3.18 with Lemma 3.17, we immediately deduce the analog of (3.9), namely\nProposition 3.19 below. Note that we could have used the same type of proof in the plactic case. However,\nwe preferred the more conceptual proof based on the symmetry property of the RSK-correspondence,\nwhich does not work in the nilplactic case.\ner (R).\nProposition 3.19. For any stable rc-graph R, we have ee+\nr (R) = e\n\nWe now define \u03c6 on a stable rc-graph R to be the diagram identified with the biword\n\u0012\n\u0013\nscomp(R)\n(3.20)\n\u03c6(R) :=\n.\n\u03c6(red(R))\n\nBy Theorem 3.16 (1), we can see that the biword (\u03c6(R))rev is in antilexicographic order. In fact,\nmore can\n\u0001 be deduced using the same argument. To this end, let us first define the shape of a biword\nw = uv with wrev in antilexicographic order, which is denoted by shape(w); this is the shape of the skew\ntableau obtained by placing the columns coli (w) side by side, with a maximum overlap between every\ntwo consecutive columns, as indicated at the beginning of the section. We can see that shape(\u03c6(R)) =\nshape(R) for any stable rc-graph R.\nThe following result will be used several times below.\nProposition 3.21. For any stable rc-graph R, we have \u03c6(e\ner (R)) = er (\u03c6(R)); similarly for fer and \u03c3\ner .\nProof. This follows from Proposition 3.19, Lemma 3.17, and Theorem 3.16 (1)-(2). Note that the strong\nform of Theorem 3.16 (2) is needed. Also note that ee+\ne+\nr (R) = \u2205 if and only if e\nr (\u03c6(R)) = \u2205 because of\ne\nthe fact that shape(\u03c6(R)) = shape(R). A similar argument holds for fr and \u03c3\ner .\n\u0003\nFinally, we can prove the following analog of Theorem 3.11 (2).\ne er (R)) = er (Q(R));\ne\nProposition 3.22. For any stable rc-graph R, we have Q(e\nsimilarly for fer and \u03c3\ner .\nProof. This is a consequence of the commutativity of the diagram below; here SR denotes the set of all\nstable rc-graphs, Diag the set of all diagrams, and Tab the set of SSYT.\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\nSR\n\u2701 \u03c6\n\n\u2701\n\u2701 \u2744\n\u2701 Diag\n\u2701\n\ne\nQ\n\n\u2701\n\u2701\u2720\n\u261b\nTab\n\nQ\n\n13\n\ner ,fer ,e\ne\n\u03c3r\n\n\u2732 SR\n\u2746\n\u03c6\n\u2746\n\u2744\u2746 e\ner ,fr ,\u03c3r\n\u2732 Diag Q\n\u2746\n\u2745 \u2746\nQ \u2745\u2746\n\u2758\u2746\u276f\n\u2745\ner ,fr ,\u03c3r\n\u2732 Tab\n\nThe two triangles on the sides commute by Theorem 3.16 (3). The rectangle above commutes by\nProposition 3.21. The trapezoid below commutes by Theorem 3.11 (2).\n\u0003\n4. Key Polynomials\nIn this section we investigate in more detail the expression of a Schubert polynomial in terms of key\npolynomials given in [25]. In particular, we relate the combinatorics of key polynomials in terms of\nSSYT to the combinatorics of Schubert polynomials in terms of rc-graphs.\nKey polynomials (for the symmetric group) are certain polynomials in Z[x1 , x2 , . . .] indexed by compositions \u03b1, which interpolate between monomials and Schur polynomials. From a representation theoretic\npoint of view, they are certain \"partial\" characters of the irreducible representations of GLn (C). More\nprecisely, the key polynomial \u03ba\u03b1 (X) is defined by\n\u03ba\u03b1 (X) := \u03c0u(\u03b1) (x\u03bb(\u03b1) ) .\nHere x\u03b2 := x1\u03b21 x\u03b22 2 . . . for any composition \u03b2 = (\u03b21 , \u03b22 , . . .), and u(\u03b1) is the permutation of minimum\nlength which realizes the rearrangement \u03bb(\u03b1) of \u03b1 in weakly decreasing order via the right action \u03b1 w :=\n(\u03b1w1 , \u03b1w2 , . . .). On the other hand, \u03c0w is the isobaric divided difference operator on Z[x1 , x2 , . . .], defined\nby\n\u03c0r := \u2202r xr ;\n\u03c0w := \u03c0a1 . . . \u03c0al(w) ,\nhere \u2202r are the divided difference operators introduced in Section 1, a1 . . . al(w) is any reduced word for\nw, xr denotes multiplication by this variable, and a permutation w acts on Z[x1 , x2 , . . .] by w xr := xwr .\nIn order to study the combinatorics of key polynomials, we need the concepts of left and right keys\nof a tableau. The left key K\u2212 (T ) (resp. right key K + (T )) of a SSYT T (cf. [26]) is the tableau of the\nsame shape as T whose jth column is the first (resp. last) column of any skew tableau in the plactic\nclass of T with the following properties: (1) its sequence of column lengths is a rearrangement of the\ncorresponding sequence for T ; (2) its first (resp. last) column has the same length as the jth column of\nT . It is not obvious that this is a correct definition. An easy way to find the jth column of K\u2212 (T ) is\nto perform the reverse column insertion procedure to the entries in the jth column of T , successively.\nAlternatively, we can use jeu de taquin on pairs of successive columns to interchange the lengths of\ncolumns in T . Similar procedures apply to K+ (T ). On the other hand, by working in the nilplactic\ne \u2212 (T ) (resp. right nil key K\ne + (T )) of a\nmonoid instead of the plactic one, we can define the left nil key K\nSSYT T whose row (or column) word is a reduced word. All four types of tableaux defined above have\nthe property that the entries in any column except the first form a subset of the entries in the previous\ncolumn. Such a tableau is called a key. There is an obvious bijection between compositions and keys\ngiven by \u03b1 7\u2192 key(\u03b1), where key(\u03b1) is the SSYT of shape \u03bb(\u03b1) whose first \u03b1j columns contain the letter\nj, for all j. The inverse map is given by T 7\u2192 content(T ), where content(T ) is the composition whose jth\npart is the number of entries equal to j in T . Given a composition \u03b1, we will use the following notation\nTab(\u03b1) := { T SSYT of shape \u03bb(\u03b1) , K+ (T ) \u2264 key(\u03b1) } ;\nhere the inequality means entrywise comparison. We can now state the following combinatorial construction of key polynomials in [26].\n\n\f14\n\nCRISTIAN LENART\n\nTheorem 4.1. [26] For any composition \u03b1, we have\nX\n\u03ba\u03b1 (X) =\n\nxT ,\n\nT \u2208Tab(\u03b1)\n\nT\n\ncontent(T )\n\nwhere x := x\n\n.\n\nIn order to prove this result, Lascoux introduced combinatorial versions of the operators \u03c0r , which\nare set-valued maps from SSYT to SSYT. More precisely, given a tableau T , one defines \u03c0r (T ) to be\nthe set of tableaux {T, fr (T ), . . . , frs (T )} if the subword of unpaired r's and r + 1's in the column word\nof T is of the form rs ; otherwise it is defined to be the empty set. More generally, given a set-valued\nmap f from a set X to X and a multiset M with elements from X, one defines f (M ) to be the multiset\nunion of f (a) for each a in M , taken with its corresponding multiplicity; in particular f (\u2205) = \u2205. Given\na finite sequence of such set-valued maps, one can define the value of their composition on a multiset\nin the obvious way, using the above definition. Note that, in general, the composition \u03c0a1 . . . \u03c0ap (T )\ngives different results for different reduced words a1 . . . ap for a given permutation. We can now state\nthe following result, which is contained in the proof of Theorem 4.1 given in [26]. Recall the notation\nU (\u03bb) for the tableau of shape \u03bb with all entries in row i equal to i.\nTheorem 4.2. [26] Let \u03b1 be a composition, and let a1 . . . ap be any reduced word for u(\u03b1). Then we\nhave\nTab(\u03b1) = \u03c0a1 . . . \u03c0ap (U (\u03bb(\u03b1))) ;\nhere composition of set-valued maps is understood in the sense mentioned above.\nRemark 4.3. Littelmann has a vast generalization of Theorem 4.2 [28, 29]. His paths can be generated\nfor any Demazure module (over a symmetrizable Kac-Moody algebra) in the same kind of fashion. The\nidea of left and right key is a type A translation of the notion of a canonical lift in the standard monomial\ntheory of Lakshmibai, Musili, and Seshadri [20]. The initial direction of a Lakshmibai-Seshadri path\n(which is a special case of a Littelmann path) is the extremal weight which gives the \"right key\" of the\npath; the final direction is the \"left key\".\nConsider now the set R(w) of rc-graphs corresponding to a permutation w. We identify an rc-graph\n\u0001\ne\nR with the pair comp(R)\n. We associate to R the pair of SSYT of conjugate shapes (Pe (R), Q(R))\n(which\nred(R)\ndetermine R), as in Section 3; note that these tableaux were already considered in [6]. We denote by\nP(w) the set of row and column strict tableaux indexing the nilplactic classes of reduced words for w;\nmore explicitly, the elements of P(w) correspond to those reduced words for w which are column (or\nrow) words for a tableau. We also use the following notation:\ne\nR(P ) := {R \u2208 R(w) : Pe(R) = P } ,\nQ(P ) := {Q(R)\n: R \u2208 R(P )} .\n\nThe sets R(P ) were called crystals in [14]. They partition the set of rc-graphs R(w) into blocks indexed\ne\nby the tableaux in P(w). The map R 7\u2192 Q(R)\nis a bijection between R(P ) and Q(P ); furthermore,\ne\nR\nQ(R)\nx =x\n, so it makes sense to call the bijection monomial preserving.\n\nThe question was raised in [6] to characterize the tableaux in Q(P ). It can be proved using the\nresults and techniques in [34], cf. also [35], that a stable rc-graph R is an rc-graph (that is, the second\ncompatibility condition (2.3) is satisfied) if and only if\ne\ne \u2212 (PeT (R)) .\n(4.4)\nK+ (Q(R))\n\u2264K\n\nEssentially, the proof is a careful examination of the way in which the mentioned keys are constructed\nvia reverse column insertion. This procedure allows one to translate the compatibility condition (2.3)\ninto the language of tableaux. It follows that\ne \u2212 (P T )} = Tab(content(K\ne \u2212 (P T ))) .\n(4.5)\nQ(P ) = {Q : K+ (Q) \u2264 K\n\nHence, the set Q(P ), which is in a monomial preserving bijection with R(P ), underlies the combinatorial\nconstruction of a certain key polynomial (by Theorem 4.1). The following results about key polynomials\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n15\n\nnow immediately follow: (1) the expansion of a Schubert polynomial as a positive sum of key polynomials;\n(2) a combinatorial formula for key polynomials in terms of rc-graphs.\nTheorem 4.6. [25, 34] We have that\nSw (X) =\n\nX\n\nP \u2208P(w)\n\n\u03bacontent(K\ne \u2212 (P T )) (X) .\n\nThus, we have the following combinatorial formula for Schubert polynomials:\nX\nX\nSw (X) =\nxQ .\ne \u2212 (P T )))\nP \u2208P(w) Q\u2208Tab(content(K\n\nTheorem 4.7. [34] Given a composition \u03b1, and any SSYT P in P(w) for some permutation w, with\ne \u2212 (P T )) = \u03b1, we have\ncontent(K\nX\nxR .\n\u03ba\u03b1 (X) =\nR\u2208R(P )\n\nWe conclude this section with an investigation of the structure of the crystals R(P ). In particular,\nwe are interested in an efficient procedure to generate a crystal.\nRemark 4.8. According to Proposition 3.18, for every R in R(P ), we have that eer (R) is in R(P ) too,\ne\nunless it is \u2205. Furthermore, according to Proposition 3.22, we have that er (Q(R))\nis in Q(P ), unless it is\ne\n\u2205, and, in fact, it coincides with Q(e\ner (R)). Hence, there is a perfect correspondence between the action\nof eer on R(P ) and that of the usual coplactic operations on the tableaux in Q(P ). On the other hand,\nit is possible that fer (R) 6= \u2205 is a stable rc-graph which is not an rc-graph; indeed, assume, for instance,\nthat R has only one cross in rows r, in position (r, 1), and no crosses in row r + 1.\nThe set Q(P ) has a natural partial order by reverse entrywise comparison: Q \u0016 Q\u2032 if and only if\ne\nQ \u2265 Q\u2032 . This can be transferred to R(P ) via the bijection R 7\u2192 Q(R).\nWe have the following result.\n\nProposition 4.9. (1) The poset (R(P ), \u0016) has a maximum Rtop (P ) and a minimum Rbot (P ). These\nare determined by\ne top (P )) = U (shape(P T )) ,\ne bot (P )) = K\ne \u2212 (P T ) .\nQ(R\nQ(R\n\n(2) We have that R \u227a eer (R) whenever eer (R) 6= \u2205. Furthermore, any rc-graph in R(P ) can be obtained\nfrom Rtop (P ) by successively applying operations fer , but not all rc-graphs in this crystal can be obtained\nfrom Rbot (P ) by applying operations eer .\n\nProof. Most of the proof relies on Remark 4.8. The first part of (2) is clear. Note that it is possible to\nsuccessively apply coplactic operations er to a SSYT of shape \u03bb until we reach U (\u03bb). Since eer applied\nto an rc-graph always gives another rc-graph or \u2205, while fer might give a stable rc-graph which is not\nan rc-graph, the second part of (2) also follows (in fact, it is easy to construct an example showing that\nRbot (P ) might not be reachable from certain rc-graphs in the crystal via operations fer ). The assertion\ninvolving Rtop (P ) in (1) follows from the previous arguments. The assertion involving Rbot (P ) follows\nfrom the characterization (4.5) of Q(P ) and the fact that K+ (T ) \u2265 T for any SSYT T (this can be easily\nseen using one of the two constructions of the right key mentioned above).\n\u0003\nClearly, the rc-graphs Rtop (w) and Rbot (w) are among the rc-graphs Rtop (P ) and Rbot (P ). Notice\nthat the second part of Proposition 4.9 gives an algorithm for generating the crystal indexed by P ,\nstarting from Rtop (P ). The similar algorithm based on nilplactic jeu de taquin on two columns was\nillustrated in [14]. We will now present a more efficient algorithm, in which each rc-graph in the crystal\nis obtained precisely once. To this end, we need to define combinatorial versions of the operators \u03c0r for\nrc-graphs, which will be denoted by \u03c0\ner (to make the notation consistent). This can be done in a similar\nway to the definition of such operators on SSYT. Note that we set \u03c0\ner (R) := \u2205 unless all the unpaired\n\n\f16\n\nCRISTIAN LENART\n\ncrosses in rows r and r + 1 of R lie in the the former row. We can now transfer the result of Theorem\ne\n4.2 from Q(P ) to R(P ) via the bijection Q(R)\n7\u2192 R. Indeed, due to Proposition 3.22, the action of the\noperators \u03c0\ner on rc-graphs corresponds to that of \u03c0r on tableaux via the mentioned bijection.\n\ne \u2212 (P T ))).\nTheorem 4.10. Let P be a tableau in P(w), and let a1 . . . ap be any reduced word for u(content(K\nThen we have\neap (Rtop (P )) ;\nR(P ) = \u03c0\nea1 . . . \u03c0\n\nhere composition of set-valued maps is understood in the sense mentioned before Theorem 4.2.\n\nTheorem 4.10 gives an efficient algorithm for generating the crystal R(P ). This can be illustrated\nby constructing a tree whose root corresponds to Rtop (P ), and whose edges correspond to applying the\noperators \u03c0\ner on rc-graphs. Note that Rtop (P ) can be easily constructed by reverse Edelman-Greene\ne top (P )) = U (shape(P T )), cf. Proposition 4.9 (1). To make things\ninsertion, using the fact that Q(R\nmore explicit, we consider the example in [34].\nExample 4.11. Let w = 21543. There are three crystals corresponding to this permutation. We choose\ne \u2212 (P T ):\nthe one indexed by the tableau P indicated below, together with K\n1\n4\n\n3\n\n4\n\n1\n3\n4\n\n3\n\ne \u2212 (P T )) is (1, 0, 2, 1), and the permutation u(\u03b1) is 3142. We consider\nThe composition \u03b1 := content(K\nthe reduced word 213 for it. The construction of the crystal R(P ) is indicated in the appendix to the\npaper.\nRemarks 4.12. (1) There is a version of Theorem 4.7 in terms of words rather than reduced words\n(see [34] Theorem 5 (2) and Remark 6.4 (2)). This can be obtained by using the plactification map\nmentioned in the previous section (cf. Remark 6.4 (2)).\n(2) The permutations w for which there is a unique crystal are known as vexillary. The corresponding\nSchubert polynomials, which thus coincide with a certain key polynomial \u03ba\u03b1 (X) (in fact, \u03b1 = code(w)),\nare known to be flagged Schur polynomials (see [31, 32, 34]). The flag condition is given by a certain\nsequence called the flag of w and denoted \u03c6(w), which is defined as the weakly increasing rearrangement\nof the numbers\ndi := min {j : j > i and wj < wi } \u2212 1 .\nThe usual proof of this fact is based on algebraic manipulations with divided difference operators. We\ne\nare able to prove this fact bijectively, by showing that the map R 7\u2192 Q(R)\nis a bijection from R(w)\nto the set of SSYT of shape \u03bb(code(w)) satisfying the flag condition. More precisely, we can show\nthat the flag condition mentioned above is equivalent to the general inequality condition (4.4) by using\nthe combinatorics of vexillary permutations; in particular, we need the characterization of their code,\nas well as the construction of code(w) which inputs \u03bb(code(w)) and \u03c6(w), cf. [31] p. 13\u201316. The\nproof is somewhat technical, and therefore we decided to omit it. However, we note that this approach\nemphasizes the importance of condition (4.4), which will be mentioned later in this paper, as well (in\nRemark 6.4 (2)).\n(3) More generally, given a Schubert polynomial which is a flagged skew Schur polynomial (see Theorem\n26 in [34] for a sufficient condition), we can ask for a bijection, possibly monomial preserving, between\nthe corresponding rc-graphs and skew tableaux satisfying the flag condition. See Remark 7.1 (3) for the\ncase of 321-avoiding permutations.\n(4) It is known that the crystal graph structure on tableaux is relevant to the representation theory\nof GLn (C). On the other hand, it was shown in [34] that key polynomials are characters of certain\nrepresentations of the subgroup B of GLn (C) consisting of upper triangular matrices. The corresponding\nmodules were also constructed explicitly. The r-pairings and the operations eer , fer , \u03c0\ner on rc-graphs\nconsidered above have a clear meaning in this context, but this is not presented here.\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n17\n\n5. Splitting Schubert polynomials\nIn this section, we use the operations fer on rc-graphs to give a straightforward, purely combinatorial\nproof of a formula in [7], which expresses Schubert polynomials as linear combinations of products of\nSchur polynomials in different sets of variables. This formula is one of the main results in [7], and is\nderived in connection with quiver varieties. More precisely, it was shown that the coefficients in the\nmentioned formula are all quiver coefficients. Note that the derivation in [7] relies on a formula of Fomin\nand Greene, which gives a combinatorial interpretation for the coefficients in the expansion of stable\nSchubert polynomials (also known as Stanley symmetric functions) in the basis of Schur functions [9].\nThe result of Fomin and Greene, which is obtained as an application of their theory of noncommutative\nSchur functions, is not needed in the proof below.\nLet us now recall the setup in [7]. First recall that a permutation w is said to have a descent in\nposition i whenever wi > wi+1 . We say that a set of integers A is compatible with w if all descent\npositions of w are contained in A. The Schur polynomial indexed by a partition \u03bb in a set of variables\nX is denoted by s\u03bb (X). The column word of a SSYT T is denoted by col(T ). We let U (\u03bb, a) denote the\nSSYT of shape \u03bb with all entries in row i equal to a + i. We say that a sequence of SSYT (T1 , . . . , Tk ) is\nstrictly bounded below by a sequence (a1 , . . . , ak ) if the entries of Ti are strictly greater than ai , for each\ni.\nTheorem 5.1. [7] Suppose that w is a permutation in Sn compatible with the set of integers {0 = a0 <\na1 < . . . < am }. Then we have\nX\nSw (X) =\nc\u03bb s\u03bb1 (X1 ) . . . s\u03bbm (Xm ) ,\n\u03bb\n\nwhere Xi = {xai\u22121 +1 , . . . , xai }, and the sum is over all sequences of partitions \u03bb = (\u03bb1 , . . . , \u03bbm ). The coefficients c\u03bb are nonnegative integers; furthermore, they count the sequences of SSYT (T1 , . . . , Tm ) strictly\nbounded below by (0, a1 , . . . , am\u22121 ), such that the shape of Ti is conjugate to \u03bbi and col(T1 ) . . . col(Tm )\nis a reduced word for w.\nProof. Assume am < n. Given an rc-graph R in R(w), we can clearly split it into a sequence of rcgraphs (R1 , . . . , Rm ), where Rk := {(i, j) \u2208 R : ak\u22121 + 1 \u2264 i \u2264 ak }, for each k. Note that w(Rk ) is not\nnecessarily a permutation with a unique descent (that is, a Grassmannian permutation). We associate\ne k )), as in Section 3. It is easy to check that the above procedure\nto Rk the pair of SSYT (Pe(Rk ), Q(R\ndefines a map from R(w) to sequences of pairs of SSYT of conjugate shapes ((P1 , Q1 ), . . . , (Pm , Qm )),\nwhich satisfy the following conditions:\n(1) (P1 , . . . , Pm ) is strictly bounded below by (0, a1 , . . . , am\u22121 );\n(2) col(P1 ) . . . col(Pm ) is a reduced word for w;\n(3) the entries of Qk , for k = 1, . . . , m, are between ak\u22121 + 1 and ak .\nClearly, this map is injective, so we only need to prove surjectivity.\nConsider a sequence of pairs of tableaux ((P1 , Q1 ), . . . , (Pm , Qm )) with the above properties. This\ndetermines a sequence of stable rc-graphs (R1 , . . . , Rm ), which, in turn, determines a stable rc-graph\nfor the permutation w, by condition (2) (just by concatenating the corresponding reduced words and\ncompatible sequences, or, graphically, by stacking the relevant portions of Ri on top of each other). It\nsuffices to show that each Rk is, in fact, an rc-graph. Let \u03bbk be the shape of Qk . It is not hard to see,\nbased on the first two conditions above, that (Pk , U (\u03bbk , ak\u22121 )) determines an rc-graph Rk0 . We can get\nfrom the tableau U (\u03bbk , ak\u22121 ) to Qk by succesively applying operations fr , with ak\u22121 + 1 \u2264 r \u2264 ak \u2212 1\n(due to condition (3)). We will show that the same sequence of operations fer applied to Rk0 produces\nan rc-graph. Then we conclude that this rc-graph has to be Rk , based on Propositions 3.18 and 3.22\n(which state the compatibility of the actions of fer on rc-graphs and of fr on the associated tableaux).\n\n\f18\n\nCRISTIAN LENART\n\nNow consider the above sequence of operations fer applied to the concatenation of the rc-graphs\n0\nR10 , . . . , Rm\n, which is an rc-graph for w. Based on the properties of the operations fer discussed above,\nit suffices to show that, when applying fer to an rc-graph for w, we never obtain a stable rc-graph which\nis not an rc-graph. This could only happen if, at the beginning of rows r and r + 1, we have the\nconfiguration shown below, where the circled cross is the one moved by fer .\n\nBut this means that the permutation w has a descent in in position r, which is a contradiction with the\ncompatibility of the sequence {0 = a0 < a1 < . . . < am }.\n\u0003\nLet us note, as it is done in [7], that the classical construction of Schubert polynomials (2.4) is\nequivalent to the special case of the above theorem corresponding to the set of integers [n \u2212 1].\n6. Kohnert Diagrams\nKohnert [18] conjectured that Schubert polynomials can be constructed in terms of certain diagrams,\ncurrently known as Kohnert diagrams. These are subsets of [n] \u00d7 [n] which can be obtained from the\ndiagram of a permutation by certain moves (recall that [n] := {1, . . . , n}). The diagram D(w) of the\npermutation w is the set\nD(w) := {(i, wj ) : i < j, wi > wj } \u2286 [n] \u00d7 [n] .\nA Kohnert move (or, simply, K-move) on a Kohnert diagram picks the rightmost cell in any row i, and\nmoves it up to the first nonoccupied cell directly above it, say in row j; we indicate such a move by\ni \u2192 j. Let K(w) denote the closure of {D(w)} under all possible K-moves. Kohnert's conjecture says\nthat\nX\nxK ,\n(6.1)\nSw (X) =\nK\n\nwhere x\n\n:=\n\nQ\n\nK\u2208K(w)\n\n(i,j)\u2208K\n\nxi .\n\nBergeron [1] defined more complex moves on diagrams, called B-moves, and constructed the set of\ndiagrams B(w) as the closure of {D(w)} under all possible B-moves. He stated that\nX\nxB .\n(6.2)\nSw (X) =\nB\u2208B(w)\n\nHe used Schubert induction, starting with the longest permutation w0n in Sn , and successively applying\ncombinatorial versions of the operators \u2202r for diagrams. The definition of the latter can be easily\nrephrased using the operations fr on diagrams in Section 3. More precisely, if w 6= w0n , Bergeron\nconsidered r := min {i : wi < wi+1 }. Then, given a diagram B in B(wsr ), he considered B \u2032 := B \\\n{(r, wr )}. Finally, he defined \u2202r (B) to be the set of diagrams {B \u2032 , fr (B \u2032 ), . . . , frt (B \u2032 )} if all the t unpaired\ncells in the r-pairing for B \u2032 are in row r; otherwise, \u2202r (B) was defined to be the empty set. Bergeron\nstated the following combinatorial version of the identity Sw (X) = \u2202r (Swsr (X)) defining Schubert\npolynomials, which implies (6.2):\n(6.3)\n\nB(w) = \u2202r (B(wsr )) ;\n\nthe right-hand side is understood in the multiset sense discussed before Theorem 4.2.\nWinkel [36] announced a proof of Kohnert's conjecture (6.1) and of the fact that K(w) = B(w), which\nwas conjectured in [1]. He thus obtained (6.2) as a Corollary. This proof is still by induction, and is still\nbased on Bergeron's combinatorial \u2202r , but is very involved. The reason for this is the fact that the action\nof \u2202r on diagrams does not have a close relationship with K-moves, although it does have a closer one\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n19\n\nwith B-moves. Later, Winkel announced a shorter proof of just (6.1) in [37], based on Monk's formula\nfor Schubert polynomials. But this proof is still not transparent, using complex manipulations with\nKohnert diagrams. In fact, Winkel himself recognized that his shorter proof is \"done by an exhaustive\nstudy of cases, which establishes correctness without leading to a deeper understanding\".\nWe attempted to find a more transparent proof of Kohnert's conjecture by constructing a bijection\nbetween Kohnert diagrams and rc-graphs based on relating K-moves and L-moves. Although these moves\nlook very similar in nature, their relationship is complicated, so we failed in this attempt.\nOne of the reasons for the difficulties in all the mentioned attempts is that, as opposed to rc-graphs,\nthere is no intrinsic description of the diagrams in B(w) or K(w), just recursive constructions. We now\ninvestigate a new set of diagrams \u03a6(w), which is in a monomial preserving bijection with R(w) (thus\nproviding a combinatorial construction of Sw (X)), and which has both a recursive and a nonrecursive\nconstruction. Furthermore, we show that \u03a6(w) coincides with B(w) and K(w), if we assume the results\nof Bergeron and Winkel mentioned above. The nonrecursive construction of \u03a6(w) is very easy to state\nusing the one-to-one map \u03c6 on rc-graphs defined in (3.20), namely \u03a6(w) := \u03c6(R(w)). Clearly, \u03c6 is a\nmonomial preserving bijection from R(w) to \u03a6(w), that is, x\u03c6(R) = xR .\nRemarks 6.4. (1) In [35], the image of the plactification map on reduced words for w is characterized\nin terms of D(w\u22121 )-peelable words. Thus, we have the following nonrecursive description of \u03a6(w):\n\n(6.5)\n\n\u03a6(w) = { D \u2286 [n] \u00d7 [n] : col(D) is D(w\u22121 )-peelable and\nrow(D) \u2264 \u03c6\u22121 (col(D)) } ,\n\nwhere \u2264 means entrywise comparison. One might be able to rephrase the above inequality in an even\nmore explicit way; essentially, we are asking: what do compatible sequences for u become under the map\nu 7\u2192 \u03c6(u)?\n(2) The situation is nicer if we replace the map u 7\u2192 \u03c6(u) in the previous remark with u 7\u2192 (\u03c6(urev ))rev .\nIndeed, it turns out that the set of compatible sequences is preserved under the latter map (compatible\nsequences for arbitrary words are defined in the same way as for reduced words). Here is an easy way\nto see this: we translate the compatibility condition into the language of keys as stated in (4.4) (there\nis a similar statement for words instead of reduced words), and then we invoke the plactification map.\nWe need, of course, the properties of this map listed in Theorem 3.16, as well as the following property\ne \u2212 (P ), for SSYT P whose column word is reduced. The mentioned\nappearing in [35]: K\u2212 (\u03c6(P )) = K\nfact implies another combinatorial construction for Sw (X) (in terms of D(w)-peelable words), which\nwas stated in [35] as Theorem 31 (1).\nWe now turn to the recursive construction of \u03a6(w). The idea is to first give a recursive construction of\nR(w) based on analogs \u2202er of the operators \u2202r on diagrams defined above. Then we show that the latter\ncorrespond to the former via the bijection \u03c6. Given a permutation w 6= w0n in Sn , we let r be defined\nas above, namely r := min {i : wi < wi+1 }. Then, given an rc-graph R in R(wsr ), we proceed in the\nsame way as for diagrams by letting R\u2032 := R \\ {(r, wr )} (the rc-graph is viewed as a subset of Z>0 \u00d7 Z>0\nhere). Finally, we define \u2202er (R) to be the set of rc-graphs {R\u2032 , fer (R\u2032 ), . . . , fert (R\u2032 )} if all the t unpaired\ncrosses in the r-pairing for R\u2032 are in row r; otherwise, it is defined to be the empty set. The fact that R\u2032\nis indeed an rc-graph (i.e., its lines have no multiple intersections) can be seen by examining the figure\nbelow, which shows the form of any rc-graph in R(wsr ); the circled cross is the one to be removed. On\nthe other hand, the successive applications of the operation fer does produce rc-graphs (rather than just\nstable rc-graphs) because R\u2032 has no crosses in positions (r, wr ) and (r + 1, wr ). Hence \u2202er is a set-valued\nmap from R(wsr ) to R(w).\n\n\f20\n\nCRISTIAN LENART\n\nwr\n\ns-1\n\ns s+1\n\nr\nr+1\n\n11\n00\n00\n11\n00\n11\n\nBefore stating the next result, we introduce some notation. Given positive integers j > i, let (j..i) be\nthe reduced word j(j \u2212 1) . . . i. Given a word u = u1 . . . un , we consider the following operator on words:\n\u03c6u := u1 \u03c31 . . . un \u03c3n ; in particular, \u03c6(uv) = \u03c6u (\u03c6(v)), where \u03c6 is the plactification map (3.15), and uv is\na reduced word with subwords u and v. We need the following Remark.\nRemark 6.6. Let v be a word with all letters strictly greater than i. The effect of applying \u03c6(j..i) to v\nis to subtract 1 from the letters i + 1, . . . , j + 1 in v, while leaving the other letters unchanged. Thus,\nthe resulting word will not contain the letter j + 1.\nTheorem 6.7. We have that\nR(w) = \u2202er (R(wsr )) ,\n\n\u03a6(w) = \u2202r (\u03a6(wsr )) ,\n\nwhere the right-hand sides are understood in the multiset sense discussed before Theorem 4.2.\nProof. Any rc-graph R\u2032 in R(w) has the form shown in the figure above, except that there is no cross in\nposition (r, wr ), and there might or might not be a cross in position (r + 1, wr ). If the former situation\narises, this cross will clearly not be r-paired with a cross in row r. Hence it can be moved to row r by\nsuccessive applications of operations eer . Let R := eetr (R\u2032 ) \u222a {(r, wr )}, where t is the number of unpaired\ncrosses in row r + 1 of R\u2032 . It is not hard to check that R \u2208 R(wsr ), and that R\u2032 \u2208 \u2202er (R). The uniqueness\nof R with these properties is clear from the definition of \u2202er .\nFix R in R(wsr ), and let s := wr + r \u2212 1. In the above figure, the oblique dotted lines indicate the\ncrosses in R to which correspond identical letters (denoted s \u2212 1, s, s + 1) in red(R). Let u, u\u2032 , u\u2032\u2032 , and\nv be the subwords of red(R) corresponding to rows less than r, row r, row r + 1, and rows greater than\nr + 1, respectively. We have u = . . . (s \u2212 1..1) . . . (s \u2212 1..r \u2212 1), u\u2032 = . . . (s..r), and u\u2032\u2032 = . . . s[\n+ 1(s..r + 1),\nwhere the b indicates the absence of a letter. Let u\ne\u2032 be obtained from u\u2032 by dropping the letter s.\nAccording to Remark 6.6, we have that \u03c6(s\u22121..r) (\u03c6(u\u2032\u2032 v)) contains no letters s and s + 1. Therefore, this\nword is fixed by \u03c3s . Hence, \u03c6(e\nu\u2032 u\u2032\u2032 v) is obtained from \u03c6(u\u2032 u\u2032\u2032 v) by dropping the letter s. By applying\nRemark 6.6 repeatedly, we can see that the effect of applying \u03c6u on the letters r, . . . , s in the mentioned\nwords is to subtract r \u2212 1 from these letters; furthermore, it is not hard to check that the effect on the\nother letters is identical in the two words. We conclude that \u03c6(R \\ {(r, wr )}) = \u03c6(R) \\ {(r, wr )}. By\napplying Proposition 3.21, we can see that \u03c6(\u2202er (R)) = \u2202r (\u03c6(R)).\n\u0003\n\nHence, the set of diagrams \u03a6(w) can be recursively generated via the operators \u2202r , starting from\n\u03a6(w0n ). This process is best illustrated using a tree, in a similar way to other recursive constructions\nin this paper. Let us note that different combinatorial versions of the divided difference operators were\nrecently defined and used to recursively generate R(w) in [33]. On the other hand, one can easily show\nthat \u03a6(w0n ) = B(w0n ) = {D(w0n )}; in fact, we can prove the more general statement in Proposition 6.9\nbelow. The next result follows by Schubert induction.\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n21\n\nTheorem 6.8. Assuming Bergeron's result (6.3), we have that B(w) = \u03a6(w); hence, the map \u03c6 defines a\nbijection between R(w) and B(w). Assuming Winkel's result K(w) = B(w), we have that K(w) = \u03a6(w);\nhence, the map \u03c6 defines a bijection between R(w) and K(w).\nThe second statement was conjectured by Billey [5]. We intend to use the two characterizations of\n\u03a6(w) presented above (the nonrecursive one in Remark 6.4 (1) and the recursive one in Theorem 6.7) in\norder to find a transparent proof of Kohnert's conjecture, based on proving the stronger conjecture of\nBilley. The following two results are steps in this direction.\nProposition 6.9. We have\n\u03c6(Rbot (w)) = D(w) .\nProof. Assuming that w \u2208 Sn , we argue by induction on n. Let R\u2032 be the rc-graph obtained from\nRbot (w) by removing its first row, and let w := w(R\u2032 ) be the corresponding permutation of { 2, . . . , n }.\nWe have w = w1 w\ne2 . . . w\nen , where\n\u001a\nw i \u2212 1 if 2 \u2264 i \u2264 w1\nw\nei :=\nwi\notherwise .\n\nThus, we can see that D(w) is obtained from D(w) by inserting an extra empty column w1 , as well as\nan extra first row containing w1 \u2212 1 left justified cells. By induction, we have that \u03c6(R\u2032 ) = D(w). By\nRemark 6.6, the effect of the map \u03c6red1 (R) = \u03c6(w1 \u22121..1) on the word col(D(w)) is to subtract 1 from the\nletters 2, . . . , w1 . Therefore, the image is col(D(w)), which concludes the proof of the induction step. \u0003\nExample 6.10. Below are shown the Kohnert diagrams corresponding to the rc-graphs in Example 2.5\nvia the map \u03c6. Note that the diagram on the left is just the diagram of the permutation w = 215463. A\nsequence of Kohnert moves on this diagram which leads to the one on the right is: 4 \u2192 2, 2 \u2192 1, 5 \u2192 4,\n4 \u2192 2.\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n1\n\n1\n\n1\n\n2\n\n2\n\n3\n\n3\n\n4\n\n4\n\n5\n\n5\n\n6\n\n6\n\n2\n\n3\n\n4\n\n5\n\n6\n\nWe conclude this section by examining the special case of 321-avoiding permutations. Recall that a\npermutation w is 321-avoiding if there are no i < j < k such that wi > wj > wk . Such permutations\nwere first investigated in [6], where it was shown that the corresponding Schubert polynomials are flagged\nskew Schur polynomials; this fact is straightforwardly rederived in Remark 7.1 (3) from the construction\nof a Schubert polynomial based on balanced labelings of the diagram of the corresponding permutation.\nSpecial cases of 321-avoiding permutations are Grassmannian permutations, which are permutations with\na unique descent. The corresponding Schubert polynomials are Schur polynomials. If the permutation\nw is 321-avoiding, the bijection \u03c6 can be made more explicit. Given a cross (i, j) in an rc-graph, let\nus denote by end(i, j) the column where the line traversing it vertically ends. We need the following\nLemma, which is best seen graphically, and is straightforward.\nLemma 6.11. If the permutation w is 321-avoiding, then no rc-graph in R(w) has a line containing\nboth a cross traversed vertically and one traversed horizontally. Conversely, if w contains the pattern\n321, then all rc-graphs in R(w) have such a line.\n\n\f22\n\nCRISTIAN LENART\n\nTheorem 6.12. If w is a 321-avoiding permutation, then the bijection \u03c6 maps every rc-graph R to the\ndiagram\n{(i, end(i, j)) : (i, j) \u2208 R} .\nFurthermore, in this case we do have K(w) = \u03a6(w).\nProof. We denote the above bijection from R(w) to some set of diagrams E(w) by R 7\u2192 end(R). Let\nus show first that K(w) = E(w). We start by noting that the order of the crosses in any row of an\nrc-graph R coincides with the order of the corresponding cells in end(R); indeed, assuming that this is\nfalse contradicts the 321-avoiding property of w, by Lemma 6.11. The inclusion E(w) \u2286 K(w) is clear,\nbecause all L-moves on rc-graphs R in R(w) move crosses up by just one row (by Lemma 6.11), whence\nthey become K-moves on end(R); the previous remark is also needed here, together with the obvious\nfact end(Rbot(w) ) = D(w). The fact that E(w) is closed under K-moves is based on the following fact. If\na cell is moved past r cells in end(R) by a K-move, then the corresponding portion of R looks as in the\nfigure below (the remark at the beginning of the proof and Lemma 6.11 are needed again). Thus we can\nperform the r + 1 indicated ladder moves in R, which together correspond to the considered K-move in\nend(R).\n\n1\n..\n.\nr\n\nAssuming that w \u2208 Sn , we now show that \u03c6(R) = end(R) for any R in R(w) by induction on n.\nAssume this is true for the rc-graph R\u2032 obtained from Rbot (w) by removing its first row; the rows and\ncolumns of R\u2032 are numbered 2, . . . , n. Write the word red1 (R) as (jp ..ip ) . . . (j1 ..i1 ) with ik+1 \u2212 jk \u2265 2 for\nk = 1, . . . , p \u2212 1. By Lemma 6.11, the word col(end(R\u2032 )) = \u03c6(red(R\u2032 )) does not contain letters i1 , . . . , ip .\nHence, by Remark 6.6, the effect of \u03c6red1 (R) on this word is to subtract 1 from the letters ik +1, . . . , jk +1,\nfor k = 1, . . . , p, while leaving the other letters unchanged. We conclude that \u03c6(red(R)) = col(end(R)).\nThe example in the figure below illustrates our argument; here red1 (R) = (7..5)(2..1).\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n8\n\n0\n1\n0\n1\n0\n1\n1\n0\n0\n1\n0\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0 1\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n11\n00\n1111111\n0000000\n0 1\n1\n111111111\n000000000\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n0\n1\n1\n0\n0\n1\n0\n1\n1\n0\n1\n0\n0\n0 0\n1\n0\n1\n0 1\n1\n0\n1\n0 1\n1\n0\n1\n\n\u0003\nNote that, in general, the bijection R 7\u2192 end(R) is a monomial preserving bijection between R(w)\nand a different set of diagrams than K(w) (and \u03a6(w)).\n7. Balanced Labelings\nFomin et al. [10] present a construction of Schubert polynomials in terms of balanced column-strict\nlabelings of the diagram of a permutation which satisfy a certain flag condition. A labeling of the cells\nof the diagram D(w) is called balanced if it satisfies the following condition: if one rearranges the labels\nwithin any hook of D(w) (which contains all the cells below and to the right of a cell of D(w)) such that\nthey weakly increase from right to left and from top to bottom, then the corner label remains unchanged.\nA balanced labeling is called column-strict if no column contains two equal entries. The flag condition\nmentioned above is the requirement that all labels in row i are at most i. For convenience, we will omit\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n23\n\nthe terms \"column strict\" and \"flag condition\" for the rest of this section. With every balanced labeling\nis associated a monomial, obtained by taking the product of xi over all labels i. It was proved in [10]\nthat the Schubert polynomial Sw (X) can be obtained by summing the monomials associated with all\nbalanced labelings of D(w).\nIn [10] a monomial preserving bijection R 7\u2192 B(R) was constructed from R(w) to balanced labelings\nof D(w). The construction of the balanced labeling corresponding to an rc-graph R for w is based on\nthe reduced word red(R) = a1 . . . al(w) and the compatible sequence comp(R) = i1 . . . il(w) . The labeling\nis constructed as follows: the cell in row p and column q is labeled ir if the adjacent transposition\nsar = tar ,ar +1 in red(R) transposes q and wp , where q < wp . Note that the number of labels i is equal\nto the number of crosses in row i of the rc-graph; this means that the bijection is monomial preserving.\nFor instance, the balanced labeling of the diagram of 215463 corresponding to the second rc-graph in\nExample 2.5 is the following.\n1\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n1\n\n2\n3\n4\n5\n\n2 3\n1\n3\n\n6\n\nWe now intend to study the inverse map, from balanced labelings to rc-graphs. To this end, we\nassociate a word T (B) to a balanced labeling B, and a word T (R) to an rc-graph R. The former is\ndefined simply by sorting the entries in each row of B in (weakly) decreasing order, and by concatenating\nthe sequences obtained in this way, in increasing order of the rows. Now consider an rc-graph R in R(w).\nAssume that the permutation w = w1 . . . wn has m descents, namely in positions d1 , . . . , dm ; this means\nthat wk > wk+1 if and only if k = di for some i. We can associate a word tk = tk1 tk2 . . . with line k in R\nin the following way: follow the line starting from its left end, and to each cross traversed horizontally\nassociate a letter in tk equal to the number of the row where the cross lies. Now let Ti := tdi\u22121 +1 . . . tdi ,\nwhere i = 1, . . . , m and d0 = 0; also let T (R) = T1 . . . Tm .\nRemarks 7.1. (1) The definition of the bijection R 7\u2192 B(R) immediately implies that if B = B(R),\nthen T (B) = T (R). Therefore, we can reconstruct R from T = T (B) only; that is, R is determined by\nthe set of labels in the rows of B. The precise description of the procedure is given in Algorithm 7.3.\n(2) If we sort the columns in a balanced labeling in ascending order, we obtain a sequence of words\nwhich can be read off from the corresponding rc-graph by following its lines starting at their top end,\nand by recording the row number of each cross traversed vertically.\n(3) The entries in the rows and columns of a balanced labeling are neither increasing nor decreasing,\nin general. In fact, based on Lemma 6.11 and Remark 7.1 (1), we can easily check that if w is 321avoiding, then the entries in the rows of a balanced labeling of D(w) are weakly decreasing, and the\nentries in columns are strictly increasing. It is well-known that, by omitting empty rows and columns\nin the diagram of a 321-avoiding permutation w, we obtain a skew Young diagram \u03bb/\u03bc = \u03bb(w)/\u03bc(w)\nin French notation. Hence, the corresponding balanced labelings can be identified with the reverse\nSSYT of skew shape \u03bb/\u03bc (in English notation) satisfying a certain flag condition; the corresponding flag\nvector is clearly the decreasing sequence of integers k for which the kth entry in code(w) in nonzero.\nRecall that a filling of a skew Young diagram is called a reverse SSYT (or column-strict plane partition)\nif the entries are weakly decreasing in rows and strictly decreasing in columns. In [6], these reverse\nSSYT are reinterpreted as SSYT of the shape obtained from \u03bb/\u03bc by a 180\u25e6 rotation. Thus, we have\na straightforward way of rederiving the fact (proved in [6]) that Schubert polynomials indexed by 321avoiding permutations are flagged skew Schur polynomials.\n\n\f24\n\nCRISTIAN LENART\n\n(4) According to the previous Remark, if w is a Grassmannian permutation with descent at d, then the\nmap R 7\u2192 B(R) followed by the renumbering k 7\u2192 d+1\u2212k of the entries in B(R) is a bijection from R(w)\nto SSYT of shape \u03bb(w) with entries 1, . . . , d. This was already observed in [1, 6]. Note that the mentioned\ne\nbijection is not monomial preserving; therefore, it is different from the map R 7\u2192 Q(R)\n(discussed in\nSection 4) between the same sets as above, which is a bijection for Grassmannian permutations. Hence,\ne\nit is natural to ask about the way in which the SSYT Q(R)\nis related to the reverse SSYT B(R) of the\nsame shape. This is addressed in Theorem 7.2 below.\nTheorem 7.2. For any Grassmannian permutation w and R in R(w), we have\ne\nQ(R)\n= evac(B(R)) .\n\ne\nMore generally, if w is 321-avoiding, then Q(R)\nis the rectification of the SSYT of skew shape obtained\nfrom B(R) by a 180\u25e6 rotation.\nProof. Let w be 321-avoiding. By Theorem 3.16 (3) and (3.2), we have\n\nrecall that\n\ne\nQ(R)\n= Q(\u03c6(R)) = P (\u03c6(R)\u2032 ) ;\n\n\u0012\n\u0013\n\u03c6(red(R))\u2032\n,\ncomp(R)\u2032\ncf. (3.20) and the definition of the biword w\u2032 (corresponding to some biword w) at the beginning of\nSection 3. On the other hand, we know from Theorem 6.12 that \u03c6(R) = end(R). Therefore, by Remark\ne\n7.1 (2), we have that (comp(R)\u2032 )rev is precisely the column word of B(R). In conclusion, Q(R)\ncan be\nobtained by applying Schensted insertion to the reverse column word of B(R), and therefore coincides\nwith evac(B(R)) when w is Grassmannian.\n\u0003\n\u03c6(R)\u2032 =\n\nAlgorithm 7.3.\nfor k = 1, . . . , n do\nstart at the left end (k, 1) of line k;\nwhile not at the upper end of line k do\nlet (i, j) be the current position;\nif a previous line crosses position (i, j) horizontally then\ncross position (i, j) vertically;\nelse\nif (i, j) 6= (k, 1) then avoid position (i, j) fi;\nmove to the right past a number of lattice points\nequal to the number of labels i in the kth row of T ;\navoid the current position;\nfi;\nod;\nod.\nWe conclude with a closer look at the word T (R) associated to an rc-graph R. We view T (R) as the\nsequence of its subwords Ti = tdi\u22121 +1 . . . tdi , where i = 1, . . . , m. Note that the length of the subword tk\nis the kth entry ck in the code of w(R). Hence the lengths of tdi\u22121 +1 , . . . , tdi form a weakly increasing\nsequence. Now view Ti as a filling of a Young diagram of shape (cdi\u22121 +1 , . . . , cdi ), where the French\nconvention for such diagrams is used.\nProposition 7.4. Using the notation above, we have that T (R) is a sequence of reverse SSYT\n(T1 , . . . , Tm ).\nProof. Fix i, k such that di\u22121 + 1 \u2264 k < k + 1 \u2264 di , and consider the lines k and k + 1 in R. It is\nnot hard to see that all lines which cross line k vertically will have to cross line k + 1 vertically as well;\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n25\n\nindeed, such lines cannot cross line k twice, so they must exit the region between lines k and k + 1 by\ncrossing the latter. Now remove all crosses in the mentioned region. By following the lines which cross\nline k vertically in the new diagram, we obtain a pairing of these crosses with some crosses on line k + 1\n(see the figure below). Obviously, the row of the first cross in any pair is strictly smaller than the row\nof the second. Furthermore, we can order the pairs such that the first and second components appear in\nthe order obtained by following lines k and k + 1 from their left ends to their top ends. This essentially\nshows that the entries in the columns of Ti strictly increase.\n\nk\nk+1\n\u0003\nExample 7.5. The sequences of reverse SSYT corresponding to the two rc-graphs in Example 2.5 are\nshown below, stacked on top of each other. More precisely, there are three reverse SSYT, corresponding\nto the following sets of rows: { 1 }, { 2, 3 }, { 4, 5 } .\n1\n3\n4\n5\n\n1\n3\n\n3\n1\n3\n\n2\n\nRemark 7.6. The sequence of reverse SSYT T (R) = (T1 , . . . , Tm ) associated to an rc-graph R might\nbe useful for the important open problem of multiplying Schubert polynomials. One approach to this\nproblem, adopted in [2, 16, 17], is to define an insertion procedure for rc-graphs (i.e., to \"insert\" an rcgraph into another) which generalizes Schensted insertion. There are such procedures (see the mentioned\npapers) which \"insert\" rc-graphs R corresponding to certain Grassmannian permutations. They can be\nviewed as \"insertions\" of the corresponding words T (R), and they depend on a parameter d, which is the\nunique descent of the permutation w(R); we call such an insertion a d-insertion. Based on the results\nof the mentioned papers, we suggest that the general procedure of \"inserting\" an arbitrary rc-graph R\ninto another could be reduced to a sequence of di -insertions of the words Ti corresponding to R.\nReferences\n[1] N. Bergeron. A combinatorial construction of Schubert polynomials. J. Combin. Theory Ser. A, 60:168\u2013182, 1992.\n[2] N. Bergeron and S. Billey. RC-graphs and Schubert polynomials. Experimental Math., 2:257\u2013269, 1993.\n[3] N. Bergeron and F. Sottile. Skew Schubert functions and the Pieri formula for flag manifolds. Trans. Amer. Math.\nSoc., 354:651\u2013673, 2002.\n[4] I. N. Bernstein, I. M. Gelfand, and S. I. Gelfand. Schubert cells and cohomology of the spaces G/P . Russian Math.\nSurveys, 28:1\u201326, 1973.\n[5] S. Billey. Private communication, April 2001.\n[6] S. C. Billey, W. Jockusch, and R. P. Stanley. Some combinatorial properties of Schubert polynomials. J. Algebraic\nCombin., 2:345\u2013374, 1993.\n[7] A. Buch, A. Kresch, H. Tamvakis, and A. Yong. Schubert Polynomials and quiver formulas. Duke Math. J., to appear.\n[8] P. Edelman and C. Greene. Balanced tableaux. Adv. Math., 63:42\u201399, 1987.\n[9] S. Fomin and C. Greene. Noncommutative Schur functions and their applications. Discrete Math., 193:179\u2013200, 1998.\n[10] S. Fomin, C. Greene, V. Reiner, and M. Shimozono. Balanced labellings and Schubert polynomials. European J.\nCombin., 18:373\u2013389, 1997.\n[11] S. Fomin and A. N. Kirillov. The Yang-Baxter equation, symmetric functions, and Schubert polynomials. Discrete\nMath., 153:123\u2013143, 1996.\n\n\f26\n\nCRISTIAN LENART\n\n[12] S. Fomin and R. P. Stanley. Schubert polynomials and the nilCoxeter algebra. Adv. Math., 103:196\u2013207, 1994.\n[13] W. Fulton. Young Tableaux, volume 35 of London Math. Soc. Student Texts. Cambridge Univ. Press, Cambridge and\nNew York, 1997.\n[14] A. Joseph, A. Melnikov, and R. Rentschler (Editors). Studies in Memory of Issai Schur, chapter Double crystal graphs\n(by A. Lascoux). Progress in Mathematics. Birkh\u00e4user, Boston, MA, 2002.\n[15] A. Knutson and E. Miller. Gr\u00f6bner Geometry of Schubert Polynomials. Ann. of Math. (2), to appear.\n[16] M. Kogan. Generalization of Schensted insertion algorithm to the cases of hooks and semi-shuffles. J. Combin. Theory\nSer. A, 102:110\u2013135, 2003.\n[17] M. Kogan and A. Kumar. A proof of Pieri's formula using generalized Schensted insertion algorithm for rc-graphs.\nProc. Amer. Math. Soc., 130:2525\u20132534, 2002.\n[18] A. Kohnert. Weintrauben, Polynome, Tableaux. Bayreuther Mathematische Schriften, 38:1\u201397, 1991.\n[19] B. Kostant and S. Kumar. The nil Hecke ring and cohomology of G/P . Adv. Math., 62:187\u2013237, 1986.\n[20] V. Lakshmibai and C. S. Seshadri. Standard monomial theory. In Proceedings of the Hyderabad Conference on Algebraic Groups (Hyderabad, 1989), pages 279\u2013322, Madras, 1991. Manoj Prakashan.\n[21] A. Lascoux. Le mono\u0131\u0308de plaxique. Quad. de la Ricerca Scientifica, 109:129\u2013156, 1981.\n[22] A. Lascoux and M.-P. Sch\u00fctzenberger. Polyn\u00f4mes de Schubert. C. R. Acad. Sci. Paris S\u00e9r. I Math., 294:393\u2013396,\n1982.\n[23] A. Lascoux and M.-P. Sch\u00fctzenberger. Structure de Hopf de l'anneau de cohomologie et de l'anneau de Grothendieck\nd'une vari\u00e9t\u00e9 de drapeaux. C. R. Acad. Sci. Paris S\u00e9r. I Math., 295:629\u2013633, 1982.\n[24] A. Lascoux and M.-P. Sch\u00fctzenberger. Fonctorialit\u00e9 des polyn\u00f4mes de Schubert. In R. Fossum, W. Haboush,\nM. Hochster, and V. Lakshmibai, editors, Invariant Theory (Denton, TX, 1986), volume 88 of Contemp. Math.,\npages 585\u2013598. Amer. Math. Soc., Providence, RI, 1989.\n[25] A. Lascoux and M.-P. Sch\u00fctzenberger. Tableaux and noncommutative Schubert polynomials. Funct. Anal. Appl.,\n23:63\u201364, 1989.\n[26] A. Lascoux and M.-P. Sch\u00fctzenberger. Keys and standard bases. In D. Stanton, editor, Invariant Theory and Tableaux,\nvolume 19 of The IMA Vol. in Math. and Its Appl., pages 125\u2013144, Berlin-Heidelberg-New York, 1990. Springer-Verlag.\n[27] C. Lenart and F. Sottile. Skew Schubert polynomials. Proc. Amer. Math. Soc., 131:3319\u20133328, 2003.\n[28] P. Littelmann. A Littlewood-Richardson rule for symmetrizable Kac-Moody algebras. Invent. Math., 116:329\u2013346,\n1994.\n[29] P. Littelmann. Paths and root operators in representation theory. Ann. of Math. (2), 142:499\u2013525, 1995.\n[30] M. Lothaire. Algebraic Combinatorics on Words, chapter The plactic monoid (by A. Lascoux, B. Leclerc, and J-Y.\nThibon), pages 144\u2013172. Cambridge University Press, Cambridge, 2002.\n[31] I. G. Macdonald. Notes on Schubert Polynomials. Laboratoire de combinatoire et d'informatique math\u00e9matique\n(LACIM), Universit\u00e9 du Qu\u00e9bec \u00e0 Montr\u00e9al, Montr\u00e9al, 1991.\n[32] L. Manivel. Symmetric functions, Schubert polynomials and degeneracy loci. SMF/AMS Texts and Monographs, 6.\nCours Sp\u00e9cialis\u00e9s. American Mathematical Society, Providence, RI; Soci\u00e9t\u00e9 Math\u00e9matique de France, Paris, 2001.\nTranslated from the 1998 French original by John R. Swallow.\n[33] E. Miller. Mitosis recursion for coefficients of Schubert polynomials. J. Combin. Theory Ser. A, 103:223\u2013235, 2003.\n[34] V. Reiner and M. Shimozono. Key polynomials and a flagged Littlewood-Richardson rule. J. Combin Theory Ser. A,\n70:107\u2013143, 1995.\n[35] V. Reiner and M. Shimozono. Plactification. J. Algebraic Combin., 4:331\u2013351, 1995.\n[36] R. Winkel. Diagram rules for the generation of Schubert polynomials. J. Combin Theory Ser. A, 86:14\u201348, 1999.\n[37] R. Winkel. A derivation of Kohnert's algorithm from Monk's rule. Sem. Loth. Comb., B48f, 2003.\n\n\fCOMBINATORIAL FORMULAS FOR SCHUBERT POLYNOMIALS\n\n~\nf\n\n~\nf\n\n3\n\n27\n\n~\nf\n1\n\n2\n\n~\nf1\n\n~\nf\n2\n\n~\nf\n2\n\n~2\nf\n2\n\nAppendix. The construction of the crystal in Example 4.11.\n\nDepartment of Mathematics and Statistics, SUNY at Albany, Albany, NY 12222\nE-mail address: lenart@csc.albany.edu\n\n~\nf2\n\n\f"}