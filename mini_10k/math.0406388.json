{"id": "http://arxiv.org/abs/math/0406388v2", "guidislink": true, "updated": "2009-04-28T15:25:00Z", "updated_parsed": [2009, 4, 28, 15, 25, 0, 1, 118, 0], "published": "2004-06-19T15:18:07Z", "published_parsed": [2004, 6, 19, 15, 18, 7, 5, 171, 0], "title": "Power series expansions of modular forms and their interpolation\n  properties", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0309407%2Cmath%2F0309468%2Cmath%2F0309238%2Cmath%2F0309249%2Cmath%2F0309191%2Cmath%2F0309377%2Cmath%2F0309297%2Cmath%2F0309004%2Cmath%2F0309116%2Cmath%2F0309027%2Cmath%2F0309086%2Cmath%2F0309296%2Cmath%2F0309318%2Cmath%2F0309230%2Cmath%2F0309361%2Cmath%2F0309363%2Cmath%2F0309347%2Cmath%2F0309207%2Cmath%2F0309448%2Cmath%2F0309092%2Cmath%2F0309400%2Cmath%2F0309463%2Cmath%2F0406061%2Cmath%2F0406377%2Cmath%2F0406560%2Cmath%2F0406008%2Cmath%2F0406185%2Cmath%2F0406220%2Cmath%2F0406215%2Cmath%2F0406581%2Cmath%2F0406345%2Cmath%2F0406195%2Cmath%2F0406615%2Cmath%2F0406449%2Cmath%2F0406578%2Cmath%2F0406047%2Cmath%2F0406029%2Cmath%2F0406340%2Cmath%2F0406018%2Cmath%2F0406601%2Cmath%2F0406573%2Cmath%2F0406476%2Cmath%2F0406335%2Cmath%2F0406324%2Cmath%2F0406542%2Cmath%2F0406250%2Cmath%2F0406367%2Cmath%2F0406334%2Cmath%2F0406086%2Cmath%2F0406044%2Cmath%2F0406349%2Cmath%2F0406122%2Cmath%2F0406194%2Cmath%2F0406051%2Cmath%2F0406175%2Cmath%2F0406541%2Cmath%2F0406311%2Cmath%2F0406588%2Cmath%2F0406285%2Cmath%2F0406305%2Cmath%2F0406033%2Cmath%2F0406400%2Cmath%2F0406486%2Cmath%2F0406475%2Cmath%2F0406401%2Cmath%2F0406089%2Cmath%2F0406537%2Cmath%2F0406111%2Cmath%2F0406555%2Cmath%2F0406500%2Cmath%2F0406490%2Cmath%2F0406388%2Cmath%2F0406042%2Cmath%2F0406275%2Cmath%2F0406456%2Cmath%2F0406595%2Cmath%2F0406440%2Cmath%2F0406611%2Cmath%2F0406213%2Cmath%2F0406052%2Cmath%2F0406199%2Cmath%2F0406415%2Cmath%2F0406495%2Cmath%2F0406331%2Cmath%2F0406384%2Cmath%2F0406357%2Cmath%2F0406621%2Cmath%2F0406597%2Cmath%2F0406263%2Cmath%2F0406592%2Cmath%2F0406267%2Cmath%2F0406546%2Cmath%2F0406166%2Cmath%2F0406580%2Cmath%2F0406109%2Cmath%2F0406107%2Cmath%2F0406547%2Cmath%2F0406129%2Cmath%2F0406272%2Cmath%2F0406365%2Cmath%2F0406625&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Power series expansions of modular forms and their interpolation\n  properties"}, "summary": "Let x be a CM point on a modular or Shimura curve and p a prime of good\nreduction, split in the CM field K. We define an expansion of an holomorphic\nmodular form f in the p-adic neighborhood of x and show that the expansion\ncoefficients give information on the p-adic ring of definition of f. Also, we\nshow that letting x vary in its Galois orbit, the expansions coefficients allow\nto construct a p-adic measure whose moments squared are essentially the values\nat the centre of symmetry of L-functions of the automorphic representation\nattached to f based-changed to K and twisted by a suitable family of\nGrossencharakters for K.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0309407%2Cmath%2F0309468%2Cmath%2F0309238%2Cmath%2F0309249%2Cmath%2F0309191%2Cmath%2F0309377%2Cmath%2F0309297%2Cmath%2F0309004%2Cmath%2F0309116%2Cmath%2F0309027%2Cmath%2F0309086%2Cmath%2F0309296%2Cmath%2F0309318%2Cmath%2F0309230%2Cmath%2F0309361%2Cmath%2F0309363%2Cmath%2F0309347%2Cmath%2F0309207%2Cmath%2F0309448%2Cmath%2F0309092%2Cmath%2F0309400%2Cmath%2F0309463%2Cmath%2F0406061%2Cmath%2F0406377%2Cmath%2F0406560%2Cmath%2F0406008%2Cmath%2F0406185%2Cmath%2F0406220%2Cmath%2F0406215%2Cmath%2F0406581%2Cmath%2F0406345%2Cmath%2F0406195%2Cmath%2F0406615%2Cmath%2F0406449%2Cmath%2F0406578%2Cmath%2F0406047%2Cmath%2F0406029%2Cmath%2F0406340%2Cmath%2F0406018%2Cmath%2F0406601%2Cmath%2F0406573%2Cmath%2F0406476%2Cmath%2F0406335%2Cmath%2F0406324%2Cmath%2F0406542%2Cmath%2F0406250%2Cmath%2F0406367%2Cmath%2F0406334%2Cmath%2F0406086%2Cmath%2F0406044%2Cmath%2F0406349%2Cmath%2F0406122%2Cmath%2F0406194%2Cmath%2F0406051%2Cmath%2F0406175%2Cmath%2F0406541%2Cmath%2F0406311%2Cmath%2F0406588%2Cmath%2F0406285%2Cmath%2F0406305%2Cmath%2F0406033%2Cmath%2F0406400%2Cmath%2F0406486%2Cmath%2F0406475%2Cmath%2F0406401%2Cmath%2F0406089%2Cmath%2F0406537%2Cmath%2F0406111%2Cmath%2F0406555%2Cmath%2F0406500%2Cmath%2F0406490%2Cmath%2F0406388%2Cmath%2F0406042%2Cmath%2F0406275%2Cmath%2F0406456%2Cmath%2F0406595%2Cmath%2F0406440%2Cmath%2F0406611%2Cmath%2F0406213%2Cmath%2F0406052%2Cmath%2F0406199%2Cmath%2F0406415%2Cmath%2F0406495%2Cmath%2F0406331%2Cmath%2F0406384%2Cmath%2F0406357%2Cmath%2F0406621%2Cmath%2F0406597%2Cmath%2F0406263%2Cmath%2F0406592%2Cmath%2F0406267%2Cmath%2F0406546%2Cmath%2F0406166%2Cmath%2F0406580%2Cmath%2F0406109%2Cmath%2F0406107%2Cmath%2F0406547%2Cmath%2F0406129%2Cmath%2F0406272%2Cmath%2F0406365%2Cmath%2F0406625&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Let x be a CM point on a modular or Shimura curve and p a prime of good\nreduction, split in the CM field K. We define an expansion of an holomorphic\nmodular form f in the p-adic neighborhood of x and show that the expansion\ncoefficients give information on the p-adic ring of definition of f. Also, we\nshow that letting x vary in its Galois orbit, the expansions coefficients allow\nto construct a p-adic measure whose moments squared are essentially the values\nat the centre of symmetry of L-functions of the automorphic representation\nattached to f based-changed to K and twisted by a suitable family of\nGrossencharakters for K."}, "authors": ["Andrea Mori"], "author_detail": {"name": "Andrea Mori"}, "author": "Andrea Mori", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1142/9789812709653_0006", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/math/0406388v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0406388v2", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "45 pages. In this new version of the paper the restriction on the\n  weight in the expansion principle in the quaternionic case has been removed.\n  Also, the formula linking the square of the moment to the special value of\n  the L-function has been greatly simplified and made much more explicit", "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11F67", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0406388v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0406388v2", "journal_reference": null, "doi": "10.1142/9789812709653_0006", "fulltext": "arXiv:math/0406388v2 [math.NT] 28 Apr 2009\n\nPower Series Expansions of Modular Forms\nand Their Interpolation Properties\nAndrea Mori\nDipartimento di Matematica\nUniversit\u00e0 di Torino\nAbstract\nWe define a power series expansion of a holomorphic modular form f in the\np-adic neighborhood of a CM point x of type K for a split good prime p. The\nmodularity group can be either a classical conguence group or a group of norm\n1 elements in an order of an indefinite quaternion algebra. The expansion coefficients are shown to be closely related to the classical Maass operators and give\np-adic information on the ring of definition of f . By letting the CM point x vary\nin its Galois orbit, the r-th coefficients define a p-adic K \u00d7 -modular form in the\nsense of Hida. By coupling this form with the p-adic avatars of algebraic Hecke\ncharacters belonging to a suitable family and using a Rankin-Selberg type formula\ndue to Harris and Kudla along with some explicit computations of Watson and of\nPrasanna, we obtain in the even weight case a p-adic interpolation for the square\nroots of a family of twisted special values of the automorphic L-function associated\nwith the base change of f to K.\n2000 Mathematics Subject Classification 11F67\n\nIntroduction\nThe idea that the power series expansion of a modular form at a CM point with respect\nto a well-chosen local parameter should have an arithmetic significance goes back to the\nauthor's thesis, [33]. The goal of the thesis was to prove an expansion principle, namely a\ncharacterization of the ring of algebraic p-adic integers of definition of an elliptic modular\nform in terms of the coefficients of the expansion. Such a result would be analogous to\nthe classical q-expansion principle based on the Fourier expansion (e.g. [24]), with the\nadvantage of being generalizable in principle to groups of modularity without parabolic\nelements where Fourier series are not available. The simplest such situation is that\nof a Shimura curve attached to an indefinite non-split quaternion algebra D over Q\n(quaternionic modular forms).\nThe basic idea in [33] was to consider a prime p of good reduction for the modular\ncurve that is split in the quadratic field of complex multiplications K and use the\nSerre-Tate deformation parameter to construct a local parameter at the CM point x\ncorresponding to a fixed embedding of K in the split quaternion algebra. The coefficients\nof the resulting power series are related to the values obtained evaluating the C \u221e (r)\nmodular forms \u03b4k f at a lift \u03c4 of x in the complex upper half-plane, where k is the weight\n(r)\nof f and \u03b4k is the r-th iterate, in the automorphic sense, of the basic Maass operator\n\n\fA. Mori\n\u0010\n\u0011\n1\nd\n\u03b4k = \u2212 4\u03c0\n2i dz\n+ ky . Our first goal in this paper is to prove a version of the expansion\nprinciple valid also for quaternionic modular forms without making use of the local\ncomplex geometry and completely p-adic in nature. The realization of modular forms\nas global sections of a line bundle L suitable for the Serre-Tate theory is subtler in the\nnon-split case because for Shimura curves the Kodaira-Spencer map KS : Sym2 \u03c9 \u2192 \u03a91X\nis not an isomorphism (for a trivial reason: the push-forward \u03c9 = \u03c0\u2217 \u03a91A/X for the\nuniversal family of \"false elliptic curves\" has rank 2). This motivates the introduction\nof p-ordinary test triples (definition 1.8) that require moving to an auxiliary quadratic\nextension. The abelian variety of dimension \u2264 2 corresponding to the CM point x\ndefined over the ring of p-adic algebraic integers O(v) is either a CM curve E with\nEnd0 (E) = K or an abelian surface isogenous to a twofold product E \u00d7 E of such a CM\n\u00d7\ncurve. To it we associate a complex period \u03a9\u221e \u2208 CP\nand a p-adic period \u03a9p \u2208 Ovnr,\u00d7 .\n\u221e\nIf also the modular form is defined over O(v) and r=0 (br (x)/r!)Txr is its expansion\nobtained form the Serre-Tate theory, we establish in theorem 3.6 an equality\n(r)\n\n\u2212k\u22122r\nc(r)\n= br (x)\u03a9p\u2212k\u22122r\nv (x) = \u03b4k (f )(\u03c4 )\u03a9\u221e\n\n(1)\n\nof elements in O(v) . The expansion principle, theorem 3.8, asserts that if f is a holo(r)\n\nmorphic modular form such that the numbers cv (x) defined by the complex side of\n(r)\nthe equality (1) are in Ov and the p-adic integers \u03a92r\np cv (x) satisfy the Kummer-Serre\ncongruences, then f is defined over the integral closure of O(v) in the compositum of all\nfinite extensions of the quotient field of O(v) in which v splits completely.\nSuppose again that the holomorphic modular form f is defined over a ring O(v)\n(r)\nof p-adic integers. The numbers cv (x) are related to the coefficients of a p-integral\npower series, i.e. to a p-adic measure on Zp , naturally attached to f . One may wonder\nabout the interpolation properties of this measure. In the introduction of [15] Harris\nand Tilouine suggest that in the case of an eigenform f the author's techniques may be\nused in conjunction with the results of Waldspurger [46] to p-adically interpolate the\nsquare roots of the special values of the automorphic L-functions L(\u03c0K \u2297 \u03be, s), where\n\u03c0K is the base change to K of the GL2 -automorphic representation \u03c0 associated to f\n(possibly up to Jacquet-Langlands correspondence) and \u03be belongs to a suitable family\nof Gr\u00f6ssencharakters for K.\nOur second goal for this paper is to partially fulfill this expectation when f has even\n(r)\nweight 2\u03ba. A key observation (proposition 4.10) is that the set of values cv (x) for x\nranging in a full set of representatives of the copy of the generalized ideal class group\nbc\u00d7 embedded in the modular (or Shimura) curve extends to a Hida [17] pKA\u00d7 /K \u00d7 C\u00d7 O\nadic GL1 (K)-modular form \u0109r , which is essentially the r-th moment of a p-adic measure\non Zp with values in the unit ball of the p-adic Banach space of such p-adic forms. The\nscalar obtained by coupling the form \u0109r with the p-adic avatar of a Gr\u00f6ssencharakter\nb\u00d7 and of suitable weight twisted by a power of the idelic norm is\n\u03ber for K trivial on O\nc\nproportional to the integral\nZ\n\u03c6r (td\u221e )\u03ber (t) dt\n(2)\nJr (f, \u03ber , \u03c4 ) =\nKA\u00d7 /K \u00d7 R\u00d7\n\n(r)\n\nwhere \u03c6r is the adelic lift of \u03b42\u03ba (f ), \u03c4 \u2208 H represents x and d\u221e \u2208 SL2 (R) is the standard\nparabolic matrix such that d\u221e i = \u03c4 . When \u03ber is of the form \u03ber = \u03c7\u03be r and satisfies some\ntechnical conditions the value so obtained is essentialy the r-th moment of a p-adic\nmeasure \u03bc(f, x; \u03c7, \u03be) on Zp .\n2\n\n\fPower series expansions of modular forms\n\nOn the other hand, the square of the integral (2) is a special case of the generalized\nFourier coefficients L\u03be (\u03a6) studied by Harris and Kudla in [13]. Building on results of\nShimizu [42] and refining the techniques of Waldspurger [46], Harris and Kudla use the\nseesaw identity associated with the theta correspondence between the similitude groups\nGL2 and GO(D) and the splitting D = K \u2295 K \u22a5 to express the generalized Fourier\ncoefficients L\u03be (\u03b8\u03c6 (F )) where F \u2208 \u03c0 and \u03c6 is a split primitive Schwartz-Bruhat function\non DA as a Rankin-Selberg Euler product. Thus, we can use the explicit version of\nShimizu's theory worked out by Watson [47], the local non-archimedean computations\nof Prasanna [38] together with some local archimedean computations to obtain a formula\nrelating the square of the r-th moment of \u03bc(f, x; \u03c7, \u03be) to the values L(\u03c0K \u2297\u03c7\u03be r , 21 ) whose\nlocal correcting terms are explicit outside the primes dividing the conductor of the\nGr\u00f6ssencharakter and the primes dividing the non square-free part of the level (theorem\n4.21).\nSome natural questions arise. First of all, one would like to compute the special\nvalues of the p-adic L-function attached to the measure \u03bc(f, x; \u03c7, \u03be). Secondly, one\nmay ask if the methods can be extended to treat different or more general families of\nGr\u00f6ssencharakters, in particular if one can control the interpolation as the ramification\nat p increases. Proposition 4.15 implies that, if anything, this cannot be achieved without moving the CM point. Thus, some kind of geometric construction in the modular\ncurve may be in order, with a possible link to the question of the determination of the\naction of the Hecke operators on the Serre-Tate expansions. Another question is whether\nthe reinterpretation of the integral (2) as inner product in the space of p-adic GL1 (K)modular forms can be used to obtain an estimate of the number of non-vanishing special\nvalues L(\u03c0K \u2297 \u03be, 21 ). We hope to be able to attack these problems in a future paper.\nAcknowledgements. The idea that the power series coefficients may be used to padically interpolate the special values L(\u03c0K \u2297\u03be, 12 ) arose a long time ago in conversations\nwith Michael Harris. I wish to thank Michael Harris for sharing his intuitions and for\nmany useful suggestions.\nAlso, I wish to thank the anonymous referee of a previous version of the manuscript,\nwhose suggestions helped greatly to remove some unnecessary hypotheses.\nNotations and Conventions. The symbols Z, Q, R, C and Fq denote, as usual,\nthe integer, the rational, the real, the complex numbers and the field with q elements\nrespectively. We fix once for all an embedding \u0131 : Q \u2192 C and by a number field we mean\na finite subextension of the field Q of algebraic numbers. If L\u221ais a number field, we\ndenote OL its ring of integers and \u03b4L its discriminant. If L = Q( d) is a quadratic field,\nfor each positive\ninteger c we denote OL,c = Z \u221a\n+ cOL = Z[c\u03c9d ] its order of conductor c,\n\u221a\nwith \u03c9d = d if d \u2261 2, 3 mod 4 or \u03c9d = (1 + d)/2 if d \u2261 1 mod 4. If [L : Q] = n we\ndenote IL = {\u03c31 , . . . , \u03c3n } the set of embeddings \u03c3i : L \u2192 C and we assume \u03c31 = \u0131|L .\nIf p is a rational prime we denote Zp and Qp the p-adic integers and the p-adic\nnumbers respectively. By analogy, Q\u221e = R. If v|p is a place of the number field\nL corresponding to the maximal ideal pv \u2282 OL , we denote O(v) , Lv , Ov , k(v) the\nlocalization of OL at pv , the v-adic completion of L, the ring of v-adic integers in Lv\nand the residue field respectively. The maximal ideal in Ov is still denoted pv . Also, we\nnr\ndenote Lnr\nv the maximal unramified extension of Lv and Ov its ring of integers.\nb the profinite completion of Z and for each Z-module M we let M\nc=\nWe denote Z\nb\nM \u2297 Z. We denote A the ring of rational adeles and Af the finite adeles, so that\nb For a number field L we denote AL = A \u2297 L and L\u00d7 the\nA = R \u00d7 Af = QRZ.\nA\n3\n\n\fA. Mori\n\ncorresponding ring of adeles and group of \u0131\u0300deles respectively. If n \u2286 OK is an ideal,\n\u00d7\nwe let L\u00d7\nn = {\u03bb \u2208 L such that \u03bb \u2261 1 mod n} and denote In the group of fractional\nideals of L prime with n, Pn the subgroup of principal fractional ideals generated by the\nelements in L\u00d7\nn and Un the subgroup of finite \u0131\u0300deles product of local units congruent to\n1 modn.\nWe fix an additive character \u03c8 of A/Q, by asking that \u03c8\u221e (x) = e2\u03c0ix and \u03c8p is\n2\u03c0ix\ntrivial on Zp with\nfor x \u2208 Z[p\u22121 ] and finite p. On A we fix the Haar\nQ \u03c8p (x) = e\nmeasure dx = p\u2264\u221e dxp where the local Haar measures dxp are normalized so that the\n\u03c8p -Fourier transform is autodual. For\nQ a quaternion algebra D with reduced norm \u03bd, we\nfix on DA the Haar measure dx = p\u2264\u221e dxp where the local Haar measures dxp are\nnormalized so that the Fourier transform with respect to the norm form is autodual.\nLet\nN\n(V, h , i) be a quadratic space of dimension d over Q. We denote SA (V ) = p\u2264\u221e Sp the\nadelic Schwartz-Bruhat space, where for p finite, Sp is the space of Bruhat functions on\nV \u2297 Qp and S\u221e is the space of Schwartz functions on V \u2297 R which are finite under the\nnatural action of a (fixed) maximal compact subgroup of the similitude group GO(V ).\nThe Weil representation r\u03c8 is the representation of SL2 (A) on SA (V ) which is explicitely\ndescribed locally at p \u2264 \u221e by\n\u0012\n\u0013\n\u0012\n\u0013\n1\n1 b\nhbx, xi \u03c6(x),\n(3a)\n\u03c6(x) = \u03c8p\nr\u03c8\n0 1\n2\n\u0012\n\u0013\na\n0\nd/2\nr\u03c8\n\u03c6(x) = \u03c7V (a) |a|p \u03c6(ax)\n(3b)\n0 a\u22121\n\u0012\n\u0013\n0 1\n\u03c6(x) = \u03b3V \u03c6\u0302(x)\n(3c)\nr\u03c8\n\u22121 0\nwhere \u03b3V is an eighth root of 1 and \u03c7V is a quadratic character that are computed in\nour cases of interest\nin [21] (see also the table in [38, \u00a73.4]), while the Fourier transR\nform \u03c6\u0302(x) = V \u2297Qp \u03c6(y)\u03c8p (hx, yi) dy is computed with respect to a h , i-self dual Haar\nmeasure on V \u2297 Qp .\nIf R is a ring and M a R-module we denote M \u2228 = Hom(M, R) the dual of M . The\nsame notation applies to a sheaf of modules over a scheme. If G is a subgroup of units\nin R we say that non-zero elements x, y \u2208 M are G-equivalent and write x \u223cG y if there\nexists r \u2208 G such that rx = y.\nThe group SL2 (R)\n\u0010 acts\n\u0011 on the complex upper half-plane H by linear fractional transformations, if g =\n\nab\nc d\n\nthen g * z =\n\naz+b\ncz+d .\n\nThe automorphy factor is defined to be\n\nj(g, z) = cz + d. The action extends to an action of the group GL+\n2 (R). If \u0393 < SL2 (R)\nis a Fuchsian group of the first kind we shall denote Mk (\u0393) the space of modular forms\nof weight k \u2208 Z with respect to \u0393 i.e. the holomorphic functions f on H such that\nf (\u03b3z) = f (z)j(\u03b3, z)k for all z \u2208 H and \u03b3 \u2208 \u0393\n\nand extend holomorphically to a neighborhood of each cusp (when cusps exist). The\nsubspace of cuspforms, i.e. those modular forms that vanish at the cusps, will be denoted\nSk (\u0393). The request that a holomorphic function on H extends holomorphically to a\nneighborhood of a cusp s is equivalent to a certain growth condition as z \u2192 s. Relaxing\nholomorphicity but mantaining the growth condition yields the much bigger spaces of\nC \u221e -modular and -cuspforms, which will be denoted Mk\u221e (\u0393) and Sk\u221e (\u0393) respectively.\nWe will denote\nMk,\u03b5 (\u2206, N ),\n\n\u221e\nMk,\u03b5\n(\u2206, N ),\n\nSk,\u03b5 (\u2206, N ),\n4\n\n\u221e\nSk,\u03b5\n(\u2206, N )\n\n\fPower series expansions of modular forms\n\nthe above spaces of modular or cuspforms with respect to the groups \u0393 = \u0393\u03b5 (\u2206, N ),\n\u03b5 \u2208 {0, 1}, defined in section 1.2. It is a well-known fact that Mk,\u03b5 (\u2206, N ) is always\nfinite-dimensional and trivial for k < 0.\n\n1\n1.1\n\nModular and Shimura curves\nQuaternion algebras.\n\nLet D be a quaternion algebra over Q with reduced norm \u03bd and reduced trace tr. For\neach place l of Q let Dl = D \u2297Q Ql . Let \u03a3D be the set of places at which D is ramified,\ni. e. Dl is the unique, up to isomorphism, quaternion division algebra over Ql . If\nl\u2208\n/ \u03a3D the algebra D is split at l, i. e. Dl \u2243 M2 (Ql ). The set \u03a3D is finite and even\nand determines completely the isomorphism class of D. Moreover, every finite and even\nsubset of places of Q is the set of ramified places of some quaternion algebra over Q\n(for these and the other basic results on quaternion algebras the standard reference is\n[45]). In particular, M2 (Q) is the only quaternion algebra up to isomorphism which is\nsplit, i. e. split at all places. The discriminant \u2206 = \u2206D of D is the product of the finite\nprimes in \u03a3D if \u03a3D 6= \u2205, or \u2206 = 1 otherwise. We shall henceforth assume that D is\n\u223c\nindefinite, i. e. split at \u221e, and fix an isomorphism \u03a6\u221e : D\u221e \u2192 M2 (R) which will be\noften left implicit. There is a unique conjugacy class of maximal orders in D. Once for\n\u223c\n/ \u03a3D so\nall, choose a maximal order R1 and fix isomorphisms \u03a6l : Dl \u2192 M2 (Ql ) for l \u2208\nthat \u03a6l (R1 ) = M2 (Zl ). For an integer N prime to \u2206 let RN be the level N Eichler\norder of D such that\n\u0012\u001a\u0012\n\u0013\n\u001b\u0013\na b\n\u2208 M2 (Zl ) such that c \u2261 0 mod N\nRN \u2297Z Zl = \u03a6l \u22121\nc d\nfor l \u2208\n/ \u03a3D , and RN \u2297 Zl is the unique\nIf D = M2 (Q)\nn\u0010 \u0011maximal order in Dl for l \u2208 \u03a3D . o\nab\nwe take R1 = M2 (Z) and RN =\nc d \u2208 M2 (Z) such that c \u2261 0 mod N .\n\nThere are exactly two homomorphisms or1l , or2l : RN \u2297 Fl \u2212\u2192 Fl2 for each prime\nl|\u2206, and two homomorphisms or1l , or2l : RN \u2297 Fl \u2212\u2192 Fl 2 for each prime l|N . These\nmaps are called l-orientations and the two l-orientations are switched by the nontrivial automorphism of either Fl2 or Fl 2 . An orientation for RN is the choice of an\nl-orientation orl for all primes l|N \u2206.\nAn involution d 7\u2192 d\u2020 in D is positive if tr(dd\u2020 ) > 0 for all d \u2208 D. By the SkolemNoether theorem\n \u0304\n(4)\nd\u2020 = t\u22121 dt\n\nwhere t \u2208 D is some element such that t2 \u2208 Q<0 and d 7\u2192 d \u0304 denotes quaternionic\nconjugation, d + d \u0304 = tr(d). If t \u2208 D is such an element, let Bt be the bilinear form on\nD defined by\nBt (a, b) = tr(ab\u0304t) = tr(atb\u2020 )\nfor all a, b \u2208 D.\n(5)\nIf R \u2282 D is an order, the involution d 7\u2192 d\u2020 is called R-principal if R\u2020 = R and\nthe bilinear form Bt is skew-symmetric, non-degenerate and Z-valued on R \u00d7 R with\npfaffian equal to 1. When \u2206 > 1 an explicit model for the triple (D, RN , d 7\u2192 d\u2020 ) can be\nconstructed as follows. The condition (n, \u2212N \u2206)l = \u22121 for all l \u2208 \u03a3D on Hilbert symbols\ndefines for n a certain subset of non-zero congruence classes modulo N \u2206. Passing to\nclasses modulo 8N \u2206 and taking n > 0 we may assume that (n, \u2212N \u2206)\u221e = (n, \u2212N \u2206)p =\n1 for all primes p dividing N and also (n, \u2212N \u2206)2 = 1 if \u2206 is odd. By Dirichlet's theorem\n5\n\n\fA. Mori\n\nof primes in arithmetic progressions there exists a prime po satisfying these conditions\nand the product formula easily implies that\n(p0 , \u2212N \u2206)l = \u22121\n\nif and only if l \u2208 \u03a3D .\n\n(6)\n\nLet a \u2208 Z such that a2 N \u2206 \u2261 \u22121 mod po .\nTheorem 1.1 (Hashimoto, [16]). Let D be a quaternion algebra over Q of discriminant\n\u2206 and let t \u2208 D such that t2 \u2208 Q<0 . Then:\n1. D is isomorphic to the quaternion algebra DH = Q \u2295 Qi \u2295 Qj \u2295 Qij, where\ni2 = \u2212N \u2206, j 2 = po and ij = \u2212ji;\n2. the order RH,N = Z\u01eb1 \u2295Z\u01eb2 \u2295Z\u01eb3 \u2295Z\u01eb4 , where \u01eb1 = 1, \u01eb2 = (1+j)/2, \u01eb3 = (i+ij)/2\nand \u01eb4 = (aN \u2206j + ij)/po is an Eichler order of level N in DH ;\n3. the skew symmetric form Bt on DH is Z-valued on RH,N if and only if ti \u2208 RH,N .\nMoreover, it defines a non-degenerate pairing on RH,N \u00d7 RH,N if and only if\nti \u2208 R\u00d7\nH,N ;\n4. let t = i\u22121 . Then the elements \u03b71 = \u01eb3 \u2212 12 (po \u2212 1)\u01eb4 , \u03b72 = \u2212aN \u2206 \u2212 \u01eb4 , \u03b73 = 1\nand \u03b74 = \u01eb2 are a symplectic Z-basis of RH,N .\nWe call Hashimoto model of a quaternion algebra endowed with an Eichler order R of\nlevel N and a R-principal positive involution the triple (DH , RH,N , i\u22121 ) given in the\nabove theorem. We can fix the isomorphism \u03a6\u221e for the Hashimoto model by declaring\nthat\n\u0012\n\u0013\n\u0012 \u221a\n\u0013\npo\n0\n\u22121\n0\n\u221a\n\u03a6\u221e (i) =\n,\n\u03a6\u221e (j) =\n.\nN\u2206 0\n0\n\u2212 po\n\n1.2\n\nModuli spaces.\n\nFix a R1 -principal positive involution d 7\u2192 d\u2020 as in (4). We shall consider the groups\n\u03930 (\u2206, N ) = R1N = {\u03b3 \u2208 RN such that \u03bd(\u03b3) = 1}\nand\n\u03931 (\u2206, N ) = {\u03b3 \u2208 \u03930 (\u2206, N ) such that or\u01ebl (\u03b3r) = or\u01ebl (r) for all r \u2208 RN , l|N, \u01eb = 1, 2} .\nWhen \u2206 = 1, \u03930 (1, N ) and \u03931 (1, N ) are the classical congruence subgroup\n\u001a\u0012\n\u001b\n\u0013\na b\n\u03930 (N ) =\n\u2208 SL2 (Z) such that c \u2261 0 mod N\nc d\nand\n\u03931 (N ) =\n\n\u001a\u0012\n\na\nc\n\nb\nd\n\n\u0013\n\n\u2208 SL2 (Z) such that a, d \u2261 1 e c \u2261 0 mod N\n\n\u001b\n\nrespectively. Since D is indefinite \u0393\u03b5 (\u2206, N ) for \u03b5 \u2208 {0, 1} is, via \u03a6\u221e , a discrete subgroup of SL2 (R) acting on the complex upper half plane H. When \u2206 > 1 the quotient\nX\u03b5 (\u2206, N ) = \u0393\u03b5 (\u2206, N )\\H is a compact Riemann surface, [43, proposition 9.2]. When\n\u2206 = 1 let X\u03b5 (N ) be the standard cuspidal compactification of Y\u03b5 (N ) = \u0393\u03b5 (N )\\H.\nEach of these complete curves X has a canonical model over Q, [43]. In fact, each\nX can be reinterpreted as the set of complex points of a scheme X which is the solution\n6\n\n\fPower series expansions of modular forms\n\nof a moduli problem, defined over Z[1/N \u2206], e.g. [1, 6, 7, 32, 39]. When D = M2 (Q)\nand N > 3, the functor F1 (N ) : Z[1/N ]-Schemes \u2192 Sets defined by\n\u001a\n\u001b\nIsomorphism classes of generalized elliptic curves E = E|S\nF1 (N )(S) =\n,\nwith a section P : S \u2192 E of exact order N\nis represented by a proper and smooth Z[ N1 ]-scheme X1 (N ) such that X1 (N )(C) =\nX1 (N ). The complex elliptic curve with point P of exact order N corresponding to\nz \u2208 H is the torus Ez = C/Z \u2295 Zz with P = 1/N mod Z. Denote\n\u03c0N : EN \u2212\u2192 X1 (N )\n\n(7)\n\nthe universal generalized elliptic curve attached to the representable functor F1 (N ).\nThe scheme X0 (N ) quotient of X1 (N ) by the action of the group of diamond operators\nhai : X1 (N ) \u2192 X1 (N ), hai(E, P ) = (E, aP ) for all a \u2208 (Z/N Z)\u00d7 , is the coarse moduli\nscheme attached to the functor\n\u001a\n\u001b\nIsomorphism classes of generalized elliptic curves E = E|S\nF0 (N )(S) =\nwith a cyclic subgroup C \u2282 E of exact order N\nand a smooth Z[1/N ]-model for the curve X0 (N ).\nWhen \u2206 > 1 and N > 3, X1 (\u2206, N ) = X1 (\u2206, N )(C) for the proper and smooth\nZ[1/N \u2206]-scheme X1 (\u2206, N ) representing the functor F1 (\u2206, N ) : Z[1/N \u2206]-Schemes \u2192\nSets defined by\n\uf8f1\n\uf8fc\nIsomorphism classes of compatibly principally polarized \uf8f4\n\uf8f4\n\uf8f2\n\uf8fd\nabelian surfaces A = A|S with a ring embedding\nF1 (\u2206, N )(S) =\n.\nR1 \u0592\u2192 End(A) and an equivalence class of\n\uf8f4\n\uf8f4\n\uf8f3\n\uf8fe\nRN -orientation preserving level N structures\n\nA level N structure on an abelian surface A with R1 \u2282 End(A) is an isomorphism of\n(left) R1 -modules A[N ] \u2243 R1 \u2297 (Z/N Z). Two such structures are declared equivalent\nif they coincide on RN \u2297 (Z/N Z) and induce the same l-orientations on RN for all\nl|N . The principal polarization is compatible with the embedding R1 \u2282 End(A) if\nthe involution d 7\u2192 d\u2020 is the Rosati involution. The abelian surfaces in F1 (\u2206, N )(S)\nare called abelian surfaces with quaternionic multiplications (QM-abelian surfaces, for\nshort) or false elliptice curves. The complex QM-abelian surface corresponding to z \u2208 H\nis\nz\nAz = D\u221e\n/R1 ,\n(8)\n\nz\nwhere D\u221e\nis the real vector space\n\u0001 D\u221e endowed with the \u0001C-structure defined by the\nidentification C2 = \u03a6\u221e (D\u221e ) z1 , i.e. Az = C2 /\u03a6\u221e (R1 ) z1 . The complex uniformiza\u223c\ntion (8) defines a level structure\nN \u22121 R\u00011 /R1 = (D/R1 )[N ] \u2192 (Az )[N ] and the skew\u0001\nz\nz\nsymmetric form \u03a6\u221e (a) 1 , \u03a6\u221e (b) 1\n= Bt (a, b) for all a, b \u2208 D, where Bt is as\nin (5), extended to C2 by R-linearity is the unique Riemann form on Az with Rosati\ninvolution d 7\u2192 d\u2020 , [32, lemma 1. 1]. Denote\n\n\u03c0\u2206,N : A\u2206,N \u2212\u2192 X1 (\u2206, N )\n\n(9)\n\nthe universal QM abelian surface attached to the representable functor F1 (\u2206, N ).\nAs with the split case, a smooth Z[1/N \u2206]-model X0 (\u2206, N ) of X1 (\u2206, N ) can be\n)\n\u00d7\nobtained as quotient of X1 (\u2206, N ) by a suitable action of \u0393\u039301 (\u2206,N\n(\u2206,N ) \u2243 (Z/N Z) . It is the\n7\n\n\fA. Mori\n\ncoarse moduli space for the functor\n\uf8fc\n\uf8f1\nIsomorphism classes of compatibly principally polarized\n\uf8fd\n\uf8f2\nF0 (\u2206, N )(S) = abelian surfaces A = A|S with a ring embedding R1 \u0592\u2192 End(A)\n\uf8fe\n\uf8f3\nand an RN -equivalence class of level N structures\n\nwhere two level N structures are RN -equivalent if they coincide on RN \u2297 (Z/N Z).\n\nRemark 1.2. In order to study the reduction of the modular and Shimura curves at\nprimes dividing N \u2206 one has to extend the moduli problems described above to moduli\nproblems defined over Z, see [2, 28]. The Z-schemes thus obtained are proper but not\nsmooth. We shall not deal with primes of bad reduction and for the purposes of this\npaper the above descriptions will suffice.\n\n1.3\n\nSubfields and CM points.\n\nLet Q \u2286 L\u2032 \u2282 L be a tower of fields with [L : L\u2032 ] = 2 and assume that L splits D,\ni. e. D \u2297Q L \u2243 M2 (L) or, equivalently, that L admits an embedding in D \u2297Q L\u2032 . An\nembedding \uf6be : L \u0592\u2192 D \u2297Q L\u2032 endows D \u2297Q L\u2032 with a structure of L-vector space. Scalar\nmultiplication by \u03bb \u2208 L is left multiplication by \uf6be(\u03bb). The opposite algebra Dop acts\nL-linearly on D by right multiplication, providing a direct identification\n\u223c\n\nDop \u2297 L \u2212\u2192 EndL (D \u2297 L\u2032 ).\n\n(10)\n\nLet \u03c3 be the non-trivial element in Gal(L/L\u2032 ) and \uf6be\u03c3 (\u03bb) = \uf6be(\u03bb\u03c3 ) for all \u03bb \u2208 L. By the\nSkolem-Noether theorem there exists u \u2208 (D \u2297Q L\u2032 )\u00d7 , well defined up to a L\u00d7 -multiple,\nsuch that u\uf6be(\u03bb) = \uf6be\u03c3 (\u03bb)u for all \u03bb \u2208 L and u2 \u2208 L\u2032 . Thus, with a slight abuse of\nnotation, the embedding \uf6be defines a splitting\nD \u2297 L\u2032 = L \u2295 Lu\n\n(11)\n\nwhich can be more intrinsically seen as the eigenspace decomposition under right multiplication by \uf6be(L\u00d7 ). Also, there is an isomorphism\n\u223c\n\nD \u2212\u2192 Dop ,\n\n\u03bb1 + \u03bb2 u 7\u2192 \u03bb1 + \u03bb\u03c32 u.\n\nLet L = L\u2032 (\u03b1) with \u03b12 = A \u2208 L\u2032 . The element\n\u0012\n\u0013\n1\n1\n1 \u2297 1 + \uf6be(\u03b1) \u2297 \u03b1 \u2208 D \u2297 L\u2032\ne\uf6be =\n2\nA\n\n(12)\n\n(13)\n\nis an idempotent which is easily seen to be, under (10), (11) and (12), the projection\nz\nonto L with kernel Lu. If L \u2286 C the idempotent e\uf6be defines a projector in D\u221e\nfor all\nz \u2208 H by scalar extension.\nAn involution d 7\u2192 d\u2020 in D extends by linearity to D \u2297 L\u2032 . If \uf6be\u2020 is the embedding \uf6be\u2020 (\u03bb) = \uf6be(\u03bb)\u2020 , the explicit description (13) implies at once that e\uf6be\u2020 = e\uf6be \u2020 and in\nparticular\n\u2020\ne\uf6be \u2020 = e\uf6be if and only if \uf6be(L) = \uf6be(L) pointwise.\nWhen the involution is positive a fixed idempotent can be constructed as follows. As an\nelement of End(D) the involution (4) has determinant \u22121. Since 1\u2020 = 1 and tr(d\u2020 ) =\ntr(d) for all d \u2208 D its (\u22121)-eigenspace is a subspace of trace 0 elements of dimension\neither 1 or 3. If the dimension is 3 then the involution is the quaternionic conjugation,\n8\n\n\fPower series expansions of modular forms\n\ncontradicting the positivity assumption. Therefore there exist a non-zero element d of\ntrace 0 fixed by the involution. The subalgebra F = Q(d) \u2282 D is a quadratic field fixed\nby the involution and the corresponding idempotent e \u2208 D\u2297Q F has the desired property.\nNote that the positivity of the involution implies further that F is real quadratic.\nThe conductor of an embedding \uf6be : L \u2192 D of the quadratic field L relative to the\norder RN is the integer c = cN > 0 such that \uf6be(OL,c ) = \uf6be(L) \u2229 RN . Denote c\u0304 the\nminimal conductor, i.e. the conductor relative to the maximal order R1 . It is clear\nthat c is a multiple of c\u0304, in fact c/c\u0304 is a divisor of N because OL,c /OL,c\u0304 injects into\nR1 /RN \u2243 Z/N Z. In the following result the embedding is left implicit to simplify the\nnotation.\nProposition 1.3. Let L \u2282 D be a quadratic subfield with associated decomposition\nD = L \u2295 Lu. Let \u039b = L \u2229 RN and \u039b\u2032 = Lu \u2229 RN . Then:\n1. D is split at the prime p if and only if (u2 , \u03b4L )p = 1;\n2. if p is unramified in L and gcd(p, c) = 1 then RN \u2297Zp = \u039b\u2297Zp \u2295\u039b\u2032 \u2297Zp . Moreover,\n\u039b\u2032 \u2297 Zp = J u for some fractional ideal J \u2282 L \u2297 Qp such that N(J )\u03bd(u) = (q \u01eb )\nwith \u01eb = 1 if q|N \u2206 and \u01eb = 0 otherwise.\n\u221a\n\u221a\n\u221a\nProof. Let L = Q( d). Then {1, d, u, du} is a Q-basis of D and the local invariants\nof the norm form are det = 1 and \u01ebp = (\u22121, \u22121)p (u2 , d)p = (\u22121, \u22121)p (u2 , \u03b4L )p , thus\nproving the first part.\nFor the second part, choose u so that u2 \u2208 Z. Then there is an inclusion of orders\n\u2032\nR = OL,c \u2295 OL,c u \u2286 \u039b \u2295 \u039b\u2032 \u2286 RN . The elements {1, c\u03c9d, u, c\u03c9du} are a Z-basis of R\u2032 ,\nso that R\u2032 has reduced discriminant \u03b4L cu2 . We are thus reduced to check that when\np|u2 and gcd(p, c\u03b4L ) = 1 then there is no element x \u2208 RN of the form x = (r + r\u2032 u)/p\nwith r, r\u2032 \u2208 OL,c \u2212 pOL,c . For such an element x one must have p|tr(r) and p|N(r) from\nwhich one derives quickly a contradiction.\nThe last claim follows from the very same discriminant computation since RN has\nreduced discriminant N \u2206.\nFix a quadratic imaginary field K that splits D. Exactly one of the two embeddings\n\uf6be, \uf6be\u03c3 is normalized in the sense of [43, (4. 4. 5)]. The normalized embeddings correspond\nbijectively to a special subset of points \u03c4 \u2208 H. More precisely, there is a bijection\n\u001a\n\u001b\nn\no\n\u03c4 \u2208 H such that \u03a6\u221e (\uf6be(K \u00d7 )) =\nnormalized embeddings\n\u2190\u2192 CM\u2206,K =\n.\n\uf6be : K \u0592\u2192 D\n{\u03b3 \u2208 \u03a6\u221e (D\u00d7 ) \u2229 GL+\n2 (R) | \u03b3 * \u03c4 = \u03c4 }\nThe bijection is \u03930 (\u2206, N )-equivariant where \u03930 (\u2206, N ) acts by conjugation on the left\nset and on CM\u2206,K via its action on H. Also, the correspondence \uf6be \u2194 \u03c4 is characterized\nby the fact that the complex structure on D\u221e induced by the embedding \uf6be coincides\n\u03c4\nwith that of D\u221e\n. In the split case CM1,K = K \u2229 H.\nWe shall denote c\u03c4 = c\u03c4,N the conductor relative to the order RN of the embedding\nassociated to the point \u03c4 \u2208 CM\u2206,K and c\u0304\u03c4 its minimal conductor.\nProposition 1.4. Let \u03c4 and \u03c4 \u2032 \u2208 CM\u2206,K such that \u03c4 \u2032 = \u03b3 * \u03c4 for some \u03b3 \u2208 \u03930 (\u2206, N ).\nThen c\u03c4 \u2032 ,N = c\u03c4,N .\nProof. Let \uf6be and \uf6be\u2032 be the embeddings corresponding to \u03c4 and \u03c4 \u2032 respectively. Then\n\uf6be\u2032 = \u03b3\uf6be\u03b3 \u22121 and so \uf6be\u2032 (Oc\u03c4 \u2032 ,N ) = \uf6be\u2032 (K) \u2229 RN = \u03b3\uf6be(K)\u03b3 \u22121 \u2229 RN = \u03b3(\uf6be(K) \u2229 RN )\u03b3 \u22121 =\n\u03b3\uf6be(Oc\u03c4,N )\u03b3 \u22121 = \uf6be\u2032 (Oc\u03c4,N ).\n\n9\n\n\fA. Mori\n\nDefinition 1.5. A point x \u2208 X0 (\u2206, N ) is a CM point of type K and conductor c = cx\nif it is represented by a \u03c4 \u2208 CM\u2206,K with c\u03c4,N = c. Denote\nCM(\u2206, N ; OK,c ) = {CM points of X0 (\u2206, N ) of type K and conductor c}.\nThe following result is [4, Lemma 4.17]\nProposition 1.6. Let c > 0 be an integer such that gcd(c, N \u2206) = 1. Then the set\nCM(\u2206, N ; OK,c ) is non-empty if and only if\n\u2022 all primes l|\u2206 are inert in K, and\n\u2022 all primes l|N are split in K.\nFor \u03c4 \u2208 CM1,K the elliptic curve E\u03c4 has complex multiplications in the field K.\nWhen \u2206 > 1 and \u03c4 \u2208 CM\u2206,K the QM abelian surface A = A\u03c4 = A(C) contains\nthe elliptic curve E = K \u2297 R/OK,c\u0304 and in fact is isogenous to the product E \u00d7 E.\nIn particular there is an identification Endo (A) \u2243 D \u2297 K. Consider the left ideal\ne = End(A)\u2229Endo (A)(1\u2212e\uf6be ) where e\uf6be is the idempotent (13) attached to the embedding\n\uf6be : K \u0592\u2192 D associated to \u03c4 and let E = A[e]o be the connected component of the\nsubgroup scheme of A killed by e. Note that since \uf6be(OK,c\u0304 ) and e\uf6be commute, the order\nOK,c\u0304 acts on E.\nProposition 1.7. A = E \u2297OK,c\u0304 R1 as group schemes.\nProof. Let S be any scheme of definition for A. Over any S-scheme T there is an\nobvious map (E \u2297OK,c\u0304 R1 )(T ) \u2192 A(T ) which is surjective because E \u2297OK,c\u0304 R1 contains\ntwo independent abelian schemes of dimension 1, E and any translate of it by an r \u2208\nR1 \u2212 OK,c\u0304 . To show that the map is injective, it is enough to do so over an algebraically\nclosed field. Over C we have E(C) = E and thus (E \u2297Rc\u0304 R1 )(C) = E \u2297OK,c\u0304 R1 =\n(K \u2297 R \u2297OK,c\u0304 R1 )/R1 = A.\nDefinition 1.8. Let p be an odd prime number, gcd(p, N \u2206) = 1. A p-ordinary test\ntriple for \u0393\u03b5 (\u2206, N ) is a triple (\u03c4, v, e), where \u03c4 \u2208 CM\u2206,K , v is a finite place dividing\np in a finite extension L \u2287 Q and e \u2208 D \u2297 F is the idempotent associated to a real\nquadratic subfield F \u2282 D pointwise fixed by the positive involution, such that\n1. F K \u2286 L;\n2. the CM curve E\u03c4 or QM-abelian surface A\u03c4 has ordinary good reduction modulo\npv ;\n3. if w is the restriction of v to F then e \u2208 R1 \u2297Z O(w) .\nFurthermore, a p-ordinary test triple (\u03c4, v, e) is said split if p splits in F .\nLet us observe that:\n1. the ordinarity hypothesis implies that p splits in K;\n2. the idempotent e plays no role in the split case and can be omitted in that case;\n3. the explicit description (13) of e shows that the third condition above is equivalent\nto gcd(p, c\u0304\u03b4F ) = 1 where c\u0304 is the minimal conductor of F ;\n10\n\n\fPower series expansions of modular forms\n\n4. for a p-ordinary triple (\u03c4, v, e) for \u03931 (\u2206, N ) the point x \u2208 X1 (\u2206, N ) represented by\n\u03c4 is a smooth point in X1 (O(v) ). This is clear for D split and follows for instance\nfrom [22, T heorem 1.1] in the non-split case.\nProposition 1.9. Let p be an odd prime number, gcd(p, N \u2206) = 1. There exist split\np-ordinary triples for \u0393\u03b5 (\u2206, N ).\nProof. Since any two positive involutions (4) are conjugated in D, up to a different\nchoice of maximal order we are reduced to the Hashimoto model. Up\n\u0010 to\u0011 replacing po in\n(6) in its congruence class modulo 8N \u2206p, we may assume also that ppo = 1. Thus the\nsubfield F = Q \u2295 Qj \u2282 DH is pointwise fixed by the involution, has discriminant prime\n\u221a\nto p and p splits in it. Finally, the minimal conductor of the embedding po 7\u2192 j \u2208 F\nis prime to p since j \u2208 RH,N .\nThe decomposition D = K \u2295 Ku associated to a choice of \u03c4 \u2208 CM\u2206,K is also an\northogonal decomposition under the non-degenerate pairing (x, y)D = tr(x\u0233). Note that\nhere u2 > 0 since the norm is indefinite. We shall be concerned with the algebraic group\nof similitudes of (*, *)D , i.e.\nGO(D) = {g \u2208 GL(D) such that (gx, gy)D = \u03bd0 (g)(x, y)D for all x, y \u2208 D} .\nThe structure of the group GO(D) is well understood, e.g. [12, \u00a71.1], [13, \u00a77]. Let\n \u0304 Then GO(D) = GOo (D)\u22c9 < t >, where\nt \u2208 GO(D) be the involution t(d) = d.\no\nGO (D) is the Zariski connected component described by the short exact sequence of\nalgebraic groups\n\u033a\n1 \u2212\u2192 Gm \u2212\u2192 D\u00d7 \u00d7 D\u00d7 \u2212\u2192 GOo (D) \u2212\u2192 1\n(14)\n\nwhere Gm is embedded diagonally and \u033a(d1 , d2 )(x) = d1 xd\u22121\n2 . The norm \u03bd restricts to\nNK/Q and \u2212u2 NK/Q on K and Ku respectively, and GO(K)o \u2243 GOo (Ku) \u2243 RK/Q Gm,K\nwhere the isomorphism is given by left multiplication. Thus, the subgroup of GOo (D)\nthat preserves the splitting D = K \u2295 Ku can be identified with the group\n\b\nG(O(K) \u00d7 O(Ku))o = (k1 , k2 ) \u2208 (RK/Q Gm,K )2 such that NK/Q (k1 k2\u22121 ) = 1\nand there is a commutative diagram\n\n\u03b1\n\nK \u00d7 \u00d7 K \u00d7 \u2212\u2212\u2212\u2212\u2192 G(O(K) \u00d7 O(Ku))o\n\uf8e6\n\uf8e6\n\uf8e6\n\uf8e6\n\uf6be\u00d7\uf6bey\ny\n\u033a\n\n(15)\n\nGOo (D)\n\nD\u00d7 \u00d7 D\u00d7 \u2212\u2212\u2212\u2212\u2192\n\nwhere \u03b1(k1 , k2 ) = (k1 k2\u22121 , k1 k\u03042\u22121 ).\n\u03c4\nWe will normalize the complex coordinates\n\u221a in D\u221e = (K \u2295 Ku) \u2297 R as follows.\nst\nThe standard normalized embedding \uf6be : Q( \u22121) \u0592\u2192\n\u0001 fixed point i \u2208\u0001 H\n\u0001 M2 (Q) with\ndefines a splitting M2 (R)i = C \u2295 C\u22a5 with C = R 1 1 \u2295 R 1 \u22121 and C\u22a5 = C 1 1 =\n\u0001\n\u0001\nR 1 1 \u2295 R \u22121 1 . Define standard complex coordinates z1st , z2st in D\u221e by the identity\n\u0001\n(16)\n\u03a6\u221e (d) = z1st + z2st 1 1 .\n\nThe R-linear extensions of the embeddings\u0010 \uf6best and \u03a6\u0011\u221e \u25e6 \uf6be are conjugated in M2 (R),\ny 1/2 sy 1/2\nnamely \u03a6\u221e \u25e6 \uf6be = d\u221e \uf6best d\u22121\nand \u03c4 = s + iy. So we define\n\u221e where d\u221e =\ny \u22121/2\n\u03c4\nnormalized coordinates z1 and z2 in D\u221e by the identity\n\u22121\n\u22121\nzi (d) = zist (\u03a6\u22121\n\u221e (d\u221e )d\u03a6\u221e (d\u221e )),\n\n11\n\nfor all d \u2208 D\u221e , i = 1,2.\n\n\fA. Mori\n\n2\n2.1\n\nSome differential operators\nPreliminaries.\n\nWe briefly review some basic facts about the Kodaira-Spencer map and the Gauss-Manin\nconnection. For more details see [23, 29]. The Kodaira-Spencer class of a composition of\n\u03c0\n\u2228\nsmooth morphisms of schemes X \u2192 S \u2192 T is the element in H 1 (X, (\u03a91X/S ) \u2297 \u03c0 \u2217 \u03a91S/T )\narising from the canonical exact sequence.\n0 \u2212\u2192 \u03c0 \u2217 \u03a91S/T \u2212\u2192 \u03a91X/T \u2212\u2192 \u03a91X/S \u2212\u2192 0\n\n(17)\n\nby local freeness of the sheaves \u03a91 . The Kodaira-Spencer map is the boundary map\nKS : \u03c0\u2217 \u03a91X/S \u2212\u2192 R1 \u03c0\u2217 (\u03c0 \u2217 \u03a91S/T ) \u2243 \u03a91S/T \u2297 R1 \u03c0\u2217 OX\nin the long exact sequence of derived functors obtained from (17) by pushing down. Un\u2228\n\u2228\nder the natural maps H 1 (X, (\u03a91X/S ) \u2297 \u03c0 \u2217 \u03a91S/T ) \u2192 H 0 (S, R1 \u03c0\u2217 ((\u03a91X/S ) \u2297 \u03c0 \u2217 \u03a91S/T )) \u2192\n\u2228\n\nH 0 (S, \u03a91S/T \u2297 R1 \u03c0\u2217 OX \u2297 (\u03c0\u2217 \u03a91X/S ) ) the Kodaira-Spencer class maps to the KodairaSpencer map.\nq\nThe q-th relative de Rham cohomology sheaf of X/S is defined as HdR\n(X/S) =\nq\n\u2022\nR \u03c0\u2217 (\u03a9X/S ) (hypercohomology). Following [29], the Gauss-Manin connection\nq\nq\n(X/S).\n\u2207 : HdR\n(X/S) \u2212\u2192 \u03a91S/T \u2297OS HdR\n\n0,q\n1,q\ncan be seen as the differential d0,q\nin the spectral sequence defined by the\n1 : E1 \u2192 E1\n\u2022\u2212i\n\u2217 i\ni \u2022\nfinite filtration F \u03a9X/T = Im(\u03a9X/T \u2297OX \u03c0 \u03a9S/T \u2212\u2192 \u03a9\u2022X/T ), with associated graded\n\n\u2217 i\nobjects gri (\u03a9\u2022X/T ) = \u03a9\u2022\u2212i\nX/T \u2297OX \u03c0 \u03a9S/T .\nIf X/S = A/S is an abelian scheme with 0-section e0 and dual At /S , denote\n\u03c9 = \u03c9A/S = \u03c0\u2217 \u03a91A/S = e0 \u2217 \u03a91A/S the sheaf on S of translation invariant relative 1-forms\n1\n1\non A. The first de Rham sheaf HdR\n= HdR\n(A/S) is the central term in a short exact\nsequence\n1\n0 \u2212\u2192 \u03c9 \u2212\u2192 HdR\n\u2212\u2192 R1 \u03c0\u2217 OA \u2212\u2192 0\n(18)\n\n(called the Hodge sequence). By Serre duality\nHomOS (\u03c0\u2217 \u03a91A/S , R1 \u03c0\u2217 (\u03c0 \u2217 \u03a91S/T )) \u2243 HomOS (\u03c9 A/S \u2297 \u03c9 At /S , \u03a91S/T )\n\n(19)\n\nand the Kodaira-Spencer map can be seen as an element of the latter group. It can be\nreconstructed from the Gauss-Manin connection as the composition\n\u2207\n\n1\n1\n\u03c9 A/S \u0592\u2192 HdR\n\u2212\u2192 HdR\n\u2297 \u03a91S/T \u2212\u2192 \u03c9 At /S \u2228 \u2297 \u03a91S/T .\n\n(20)\n\nIn fact, when A/S \u2243 At /S is principally polarized, the Kodaira-Spencer map becomes\na symmetric map KS : Sym2 (\u03c9) \u2192 \u03a91S/T , [9, Section III. 9].\nLet (S \u2032 , io ) be a smooth closed reduced subscheme of S and consider the commutative\npull-back diagram of T -schemes\ni\n\nX \u2032 \u2212\u2212\u2212\u2212\u2192\n\uf8e6\n\uf8e6 \u2032\ny\u03c0\ni\n\nX\n\uf8e6\n\uf8e6\u03c0.\ny\n\nS \u2032 \u2212\u2212\u2212o\u2212\u2192 S\n12\n\n\fPower series expansions of modular forms\n\nSince also \u03c0 \u2032 is smooth, we can consider the Kodaira-Spencer class, or map, KS\u2032 attached\n\u03c0\u2032\n\nto the morphisms X \u2032 \u2192 S \u2032 \u2192 T . When X = A is a principally polarized abelian scheme,\n\u22972\n\u2217\nKS\u2032 \u2208 HomOS\u2032 (\u03c9 \u2032 , \u03a91S \u2032 /T ) as in (19), where \u03c9 \u2032 = \u03c9 A\u2032 /S \u2032 = \u03c0\u2217 \u03a91A\u2032 /S \u2032 = e\u20320 \u03a91A\u2032 /S \u2032 .\nSince i\u2217 \u03c0 \u2217 \u03a91S/T = \u03c0 \u2032 \u2217 i\u22170 \u03a91S/T and i\u2217 \u03a9X/S \u2243 \u03a9X \u2032 /S \u2032 canonically, applying i\u2217 to (17)\nyields an exact sequence\n\u2217\n\n0 \u2212\u2192 \u03c0 \u2032 i\u22170 \u03a91S/T \u2212\u2192 i\u2217 \u03a91X/T \u2212\u2192 \u03a91X \u2032 /S \u2032 \u2212\u2192 0,\ni\n\n\u2217\n\n0\nS \u2192 T\nhence an element KS\u2217 \u2208 Ext1OX \u2032 (\u03a91X \u2032 /S \u2032 , \u03c0 \u2032 i\u22170 \u03a91S/T ). The composition S \u2032 \u2192\n\u2217\n\u2217\ndefines a canonical surjective map \u03c0 \u2032 i\u22170 \u03a91S/T \u2192 \u03c0 \u2032 \u03a91S \u2032 /T . In the same way, we get a\nsurjective map i\u2217 \u03a91X/T \u2192 \u03a91X \u2032 /T . These data define a commutative diagram of OX \u2032 modules\n\n\u2217\n\n0 \u2212\u2212\u2212\u2212\u2192 \u03c0 \u2032 i\u22170 \u03a91S/T \u2212\u2212\u2212\u2212\u2192 i\u2217 \u03a91X/T \u2212\u2212\u2212\u2212\u2192 \u03a91X \u2032 /S \u2032 \u2212\u2212\u2212\u2212\u2192 0\n\uf8e6\n\uf8e6\n\uf8e6\n\uf8e6\ny\ny\n\u2217\n\n0 \u2212\u2212\u2212\u2212\u2192 \u03c0 \u2032 \u03a91S \u2032 /T \u2212\u2212\u2212\u2212\u2192 \u03a91X \u2032 /T \u2212\u2212\u2212\u2212\u2192 \u03a91X \u2032 /S \u2032 \u2212\u2212\u2212\u2212\u2192 0\n\nStandard diagram-chasing shows that KS\u2217 7\u2192 KS\u2032 under the canonical map of Ext1\ngroups. The following result follows easily from the definitions.\nProposition 2.1. Let A/S be an abelian scheme with S smooth over T , (S \u2032 , i0 ) a\nclosed T -smooth subscheme of S and A\u2032 = A \u00d7S S \u2032 . Let KS : \u03c9 \u22972 \u2192 \u03a91S/T and\n\u22972\n\nKS\u2032 : \u03c9\u2032 \u2192 \u03a91S \u2032 /T be the corresponding Kodaira-Spencer maps. Then KS\u2032 = \u03b90 \u25e6 i\u22170 KS,\nwhere \u03b90 : i\u22170 \u03a91S/T \u2192 \u03a91S \u2032 /T is the canonical pull-back map.\n\nLet again X = A be an abelian scheme, and let \u03c6 : A \u2192 A be an S-isogeny (i. e., a\nsurjective endomorphism such that \u03c0\u03c6 = \u03c0). The pull-back \u03c6\u2217 \u03a9\u2022A/T \u2192 \u03a9\u2022A/T respects\nfiltrations. Thus we have maps \u03c6\u2217 (F i /F j ) \u2192 F i /F j for all i \u2264 j because the sheaves\nF i are locally free. In particular, there is a map of short exact sequences\n0 \u2212\u2212\u2212\u2212\u2192 \u03c6\u2217 grp+1 \u2212\u2212\u2212\u2212\u2192 \u03c6\u2217 (F p /F p+2 ) \u2212\u2212\u2212\u2212\u2192 \u03c6\u2217 grp \u2212\u2212\u2212\u2212\u2192 0\n\uf8e6\n\uf8e6\n\uf8e6\n\uf8e6\n\uf8e6\n\uf8e6\ny\ny\ny\n\n0 \u2212\u2212\u2212\u2212\u2192\n\ngrp+1\n\n\u2212\u2212\u2212\u2212\u2192\n\nF p /F p+2\n\n\u2212\u2212\u2212\u2212\u2192\n\ngrp\n\n\u2212\u2212\u2212\u2212\u2192 0\n\nwhere the bottom row is the tautological exact sequence of graded objects and the top\nrow is obtained applying \u03c6\u2217 to it (again, it remains exact because the sheaves are locally\nfree). Since \u03c6 is surjective, \u03c0\u2217 \u03c6\u2217 = \u03c0\u2217 as functors and the previous diagram yields a\nmap of derived functors long exact sequences\n. . . \u2212\u2212\u2212\u2212\u2192 Rp+q \u03c0\u2217 grp \u2212\u2212\u2212\u2212\u2192 Rp+q+1 \u03c0\u2217 grp+1 \u2212\u2212\u2212\u2212\u2192 . . .\n\uf8e6\n\uf8e6\n\uf8e6[\u03c6]\n\uf8e6[\u03c6]\ny p,q\ny p+1,q\n\n(21)\n\n. . . \u2212\u2212\u2212\u2212\u2192 Rp+q \u03c0\u2217 grp \u2212\u2212\u2212\u2212\u2192 Rp+q+1 \u03c0\u2217 grp+1 \u2212\u2212\u2212\u2212\u2192 . . .\n\nProposition 2.2. Let A/S be an abelian scheme with S smooth over T . The algebra\nq\nEndS (A) acts linearly on the sheaves HdR\n(A/S). If \u03c6 \u2208 EndS (A) acts as [\u03c6], then\n\u2207 \u25e6 [\u03c6] = (1 \u2297 [\u03c6])\u2207.\n13\n\n\fA. Mori\n\nq\nProof. Let \u03c6 \u2208 EndS (A) be an isogeny. The endomorphism [\u03c6] of HdR\n(A/S) attached to \u03c6 is the vertical map [\u03c6]0,q in diagram (21) at Rq \u03c0\u2217 gr0 . Under the idenq+1\n1\n\u03c0\u2217 (\u03a9\u2022\u22121\ntification Rq+1 \u03c0\u2217 gr1 = Rq+1 \u03c0\u2217 (\u03c0 \u2217 \u03a91S/T \u2297OA \u03a9\u2022\u22121\nA/T ) =\nA/T ) = \u03a9S/T \u2297OS R\nq\n1\n\u03a9S/T \u2297OS HdR (A/S) the Gauss-Manin connection is the connecting homomorphism\nfor the tautological exact sequence of graded objects, i.e. either horizontal connecting\nhomomorphism in (21) at p = 0 and also [\u03c6]1,q = 1 \u2297 [\u03c6]0,q since \u03c6 acts trivially on S.\nThe formula follows.\nLet s \u2208 S be a geometric point and As the fiber at s. Without loss of generality we\nmay assume that S is connected and Grothendieck's rigidity lemma [35] implies that\nthe canonical map EndS (A) \u2192 End(As ) is injective. It follows that there exist division\nalgebras D1 , . . . , Dt such that EndS (A) is identified to a subring of Mn1 (D1 ) \u00d7 * * * \u00d7\nMnt (Dt ). The latter algebra is spanned over Q by the invertible elements, so the result\nfollows by linearity.\n\n2.2\n\nComputations over C\n\nIn order to compute explicitely the Kodaira-Spencer map for a complex family, i.e. when\nT = Spec(C), it is more convenient to appeal to GAGA principles, work in the analytic\ncategory and follow [25, 11]. If A/S is a principally polarized family of abelian varieties\nover the smooth complex variety S and U \u2282 S is an open set, the choice of a section\n\u2228\n\u03c3 \u2208 H 0 (U, (\u03a91S ) ) defines a map \u033a\u03c3 : H 0 (U, \u03c9) \u2192 H 0 (U, \u03c9\u2228 ) by the composition\n\u2207\n\n1\u2297\u03c3\n\n\u033a\n\n1\n1\n1\n) \u2192 H 0 (U, \u03c9\u2228 ),\n) \u2192 H 0 (U, HdR\n\u2297 \u03a91S/T ) \u2192 H 0 (U, HdR\nH 0 (U, \u03c9) \u0592\u2192 H 0 (U, HdR\n1\n1\nwhere \u033a is induced by the polarization pairing h*, *idR : HdR\n\u2297 HdR\n\u2192 OS . The associa\u2228\n1\n\u2228\ntion \u03c3 7\u2192 \u033a\u03c3 defines a map (\u03a9S/T ) \u2192 Hom(\u03c9, \u03c9 ) whose dual is the Kodaira-Spencer\nmap KS. By \u00e9tale-ness, the actual computation of the map KS can be obtained applying\nthe above procedure to the pullback of the family A/S on the universal cover of S. For\ninstance, for the universal family (7)\n\nKS(d\u03b6 \u22972 ) =\n\n1\ndz.\n2\u03c0i\n\n(22)\n\nwhere \u03b6 is the standard complex coordinate in the elliptic curve Ez = C/Z \u2295 Zz, z \u2208 H.\nWe follow this approach to compute the Kodaira-Spencer map for the universal\ncomplex family of QM abelian surfaces over X\u0393 using the Shimura family ASh /H of (8)\nin terms of the arithmetic of the maximal order R1 . Let r = {r1 , . . . , r4 } be a symplectic\nbasis of R1 . By linear extension, the real dual basis {r1 \u2228 , . . . , r4 \u2228 } of D\u221e \u2228 is a basis\n1\nz\nof Hom(R1 \u2297Z C, C) \u2243 HdR\n(D\u221e\n/R1 ). Thus, the elements r1 \u2228 , . . . , r4 \u2228 define global\n1\nC \u221e -sections of HdR\n(ASh /H) with constant periods, hence \u2207-horizontal. If H denotes\n1\nthe C-span of these sections, there is an isomorphism HdR\n(ASh /H) = H \u2297C OH . In\nterms of this trivialization, \u2207 = 1 \u2297 d, where d is the exterior differentiation. Also,\nhri \u2228 , rj \u2228 idR =\n\n1\nBt (rj , ri ),\n2\u03c0i\n\ni, j = 1, . . . , 4,\n\n(23)\n\nwhere the 2\u03c0i factor accounts for the difference of Tate twists between singular and algebraic de Rham cohomology, e. g. [5, \u00a71]. Let \u03b61 and \u03b62 denote the standard coordinates\nin C2 .\n\u0001\n1 0\n1\nProposition 2.3. (KS(d\u03b6i \u2297 d\u03b6j ))i,j=1,2 = 2\u03c0i\n0 \u2206 dz.\n14\n\n\fPower series expansions of modular forms\n\nProof. Write\n\u0012\n\nd\u03b61\nd\u03b62\n\n\u0013\n\n\uf8f6\nr1 \u2228\n\uf8f7\n\uf8ec\n= \u03a0r (z) \uf8ed ... \uf8f8\nr4 \u2228\n\uf8eb\n\nwhere \u03a0r (z) is the period matrix computed in terms of the basis r. Using (23) and the\ndefinitions we first obtain\n\uf8eb\n\uf8f6\nr1\n\u0013\n\u0012\n\u0013\n\u0012\n1 d\u03a0r (z)\n0\nI2 \uf8ec . \uf8f7\nd\u03b61\n=\n\u033a\u03c3\n\uf8ed .. \uf8f8 \u03c3(dz),\n\u2212I\n0\nd\u03b62\n2\u03c0i dz\n2\nr4\n\nand finally\n\n(KS(d\u03b6i \u2297 d\u03b6j ))i,j=1,2 =\n\n1 d\u03a0r (z)\n2\u03c0i dz\n\n\u0012\n\n0\n\u2212I2\n\nI2\n0\n\n\u0013\n\nt\n\n\u03a0r (z) dz.\n\nTo obtain the final formula, we make use of the Hashimoto model with N = 1. In terms\nof the symplectic basis \u03b7 = {\u03b71 , . . . , \u03b74 } of theorem 1.1\n\uf8f6\n\uf8eb \u031f\u2212\n1 +\n+\n+\n\u221a1\n\u221a\n2 po (\u03b1 a\u2206z + 1) \u2212 po (\u03b1 a\u2206z + 1) z\n2\u03b1 z\n\uf8f7\n\uf8ec\n(24)\n\u03a0\u03b7 (z) = \uf8ed\n\uf8f8\n+\n\u03b1\n1 \u2212\n\u221a a\u2206(z \u2212 \u03b1\u2212 )\n\u221a1 \u2206(\u2212z + \u03b1\u2212 a)\n1 2\u03b1\n2 po\npo\nwhere \u03b1\u00b1 = 1 \u00b1\n\n2.3\n\n\u221a\npo . Plugging these values into the previous formula yields the result.\n\nMaass operators.\n\nWhen D is split. the universal family (7) defines the line bundle \u03c9 = \u03c9EN /Y1 (N ) on\nthe Zariski open set Y1 (N ) complement of the cusp divisor C in X1 (N ). The Kodaira\u223c\nSpencer map KS : \u03c9\u22972 \u2192 \u03a91Y1 (N ) is an isomorphism.\nTheorem 2.4. The line bundle \u03c9 extends uniquely to a line bundle, still denoted \u03c9, on\nthe complete curve X1 (N ) and the Kodaira-Spencer isomorphism extends to an isomorphism\n\u223c\nKS : \u03c9 \u22972 \u2212\u2192 \u03a91X1 (N ) (log C).\nProof. See [24] and also [28, section 10. 13] where the extension property is discussed\nfor a general representable moduli problem.\nIf D is not split, the universal family (9) of QM-abelian surfaces defines the sheaf\n\u03c9 = \u03c9A\u2206,N /X1 (\u2206,N ) and the Kodaira-Spencer map is a surjective map KS: Sym2 \u03c9 \u2192\n\u03a91X1 (\u2206,N ) .\nLet p be a prime such that (p, N \u2206) = 1 and let v be a place of a number field\nL dividing p. The algebra R1 \u2297Z Ov acts contravariantly and Ov -linearly on \u03c9v =\n\u03c9 \u2297 Ov by pull-back. For any geometric point s \u2208 X1 (\u2206, N ) \u2297 Ov and any non-trivial\nidempotent e \u2208 R1 \u2297Z Ov there is a non-trivial decomposition H 0 (As , \u03a91As /k(s) ) =\neH 0 (As , \u03a91As /k(s) ) \u2295 (1 \u2212 e)H 0 (As , \u03a91As /k(s) ). Therefore the subsheaf e\u03c9v is a line subbundle. Let e\u03c9v \u25e6 e\u2020 \u03c9 v \u2286 Sym2 \u03c9 v be the line bundle image of e\u03c9v \u2297 e\u2020 \u03c9 v under the\n2\nnatural map \u03c9 \u22972\nv \u2192 Sym \u03c9 v .\n15\n\n\fA. Mori\n\nTheorem 2.5. If p, v and e are as above, then the Kodaira-Spencer map defines an\nisomorphism\nKS : e\u03c9v \u2297 e\u2020 \u03c9 v \u2212\u2192 \u03a91X1 (\u2206,N )/Ov\n\nof line bundles on X1 (\u2206, N ) defined over Ov .\n\nProof. We claim that the action of r \u2297 \u03bb \u2208 R1 \u2297 Ov on the universal family (9)\nbase-changed to Ov gives rise to a commutative diagram\n\u03c9v \u2212\u2212\u2212\u2212\u2192 \u03a91X1 (\u2206,N )/Ov \u2297 \u03c9v \u2228\n\uf8e6\n\uf8e6\n\uf8e6\n\uf8e6 \u2020\nyr\u2297\u03bb\ny1\u2297r \u2297\u03bb\n\n(25)\n\n\u03c9v \u2212\u2212\u2212\u2212\u2192 \u03a91X1 (\u2206,N )/Ov \u2297 \u03c9v \u2228\nIndeed, under the Serre duality identification R1 \u03c0\u2217 OA \u2243 \u03c9 A/S \u2228 for a principally polarized abelian scheme A/S the actions of EndS (A) correspond up to Rosati involution.\nThe commutativity of the diagram (25) follows from proposition 2.2 and (20).\nFor an idempotent e \u2208 R1 \u2297Z Ov , diagram (25) defines a map e\u03c9 v \u2192 \u03a91 \u2297 e\u2020 (\u03c9 v \u2228 )\nwhich can be shown to be an isomorphism by the same deformation theory argument\nin [8, Lemma 6]. This is enough to conclude, because the sheaves e\u2020 (\u03c9 v \u2228 ) and e\u2020 \u03c9 v are\ndual of each other.\nRemarks 2.6.\n1. We proved theorem 2.5 for p-adically complete rings of scalars. In\nfact the projectors onto the quadratic subfields of D are defined over the p-adic\nlocalizations of their rings of integers for almost all p. Thus, in these cases, e\u03c9\nand the Kodaira-Spencer isomorphism are defined over the subrings O(v) \u2282 C.\n2. If the e\u2032 = ded\u22121 are conjugated in R1 \u2297 B for some ring B, then the action of d\non \u03c9 \u2297 B defines an isomorphism of e\u03c9 with e\u2032 \u03c9 over B.\n3. In the complex case the isomorphism of theorem 2.5 can be checked by a straightforward application of the computation in section 2.2. For instance, in the Hashi2\nmoto model for N = 1 of theorem 1.1 let d = ai\n\u221a+ bj + cij \u2208 DH with \u03b4 = d =\n2\n2\n2\n\u2212a \u2206 + b po + c \u2206po \u2208 Q and let e \u2208 D \u2297Q Q( \u03b4) be the idempotent giving the\nprojection onto Q(d). Then\n\u0012 \u221a\n\u221a\n\u221a \u0013\n1\n\u03b4 + b po \u221a\n\u2212a + c po\ne= \u221a\n\u221a\n\u221a\n\u03b4 \u2212 b po\n(a + c po )\u2206\n2 \u03b4\nand\n\n1\ne = \u221a\n2 \u03b4\n\u2020\n\n\u0012\n\n\u221a\n\n\u0013\n\u221a\n\u221a\n\u03b4 + b po\na + c po\n\u221a\n.\n\u221a\n\u221a\n\u03b4 \u2212 b po\n(\u2212a + c po )\u2206\n\nTherefore e\u03c9 \u25e6 e\u2020 \u03c9 is generated over H by the global section\n\u221a\n\u221a\n\u221a\n\u221a\n\u221a\n( \u03b4 + b po )2 d\u03b61 \u25e6 d\u03b61 + (c2 po \u2212 a2 )d\u03b62 \u25e6 d\u03b62 + 2( \u03b4 + b po )c po d\u03b61 \u25e6 d\u03b62\nwhose image under the Kodaira-Spencer map KS is, by proposition 2.3,\n1 \u221a\n\u221a\n( \u03b4 + b po )dz \u2208 \u0393(H, \u03a91H ).\n\u03c0i\n\n(26)\n\nSince \u03b4 6= po b2 (else po = (a/c)2 \u2208 Q which is impossible) the section (26) does\nnot vanish and the Kodaira-Spencer map is an isomorphism.\n16\n\n\fPower series expansions of modular forms\n\nNotation 2.7. We will denote L either the line bundle \u03c9 v on Y1 (N ) or the line bundle\ne\u03c9v on X1 (\u2206, N ) for some choice of idempotent e satisfying the hypotheses of theorem\n2.5 and such that e\u2020 = e. In either case the Kodaira-Spencer map gives an isomorphism\n\u223c\n\nKS : L\u22972 \u2212\u2192 \u03a91 .\nWith an abuse of notation we will denote also L the pullback of the complexified bundle\nto H under the natural quotient maps.\n\u0001\n\u0001\n\u0001\n\u22121\nIf \u03b3 \u2208 \u03931 (\u2206, N ) the identities Z2 \u03b3*z\n= j(\u03b3, z) Z2 z1 and \u03a6\u221e (R1 ) \u03b3*z\n=\n1\n1\n\u0001\nj(\u03b3, z)\u22121 \u03a6\u221e (R1 ) z1 as subsets of C (in the split case) and of C2 (in the non-split\ncase) respectively, show that the natural action of \u03931 (\u2206, N ) on \u03c9 over H is scalar multiplication by the automorphy factor. Thus the \u03931 (\u2206, N )-action extends to a SL2 (R)homogeneous structure on \u03c9, and on Sym2 (\u03c9) as well. Also, in the non-split case the\nfiber identifications induced by the action are D \u2297 C-contravariant and since the line\nbundle L is defined using the D action on \u03c9, it is an homogeneous line subbundle of\nSym2 (\u03c9).\nLet n \u2208 Z and let Vn be the 1-dimensional representation of C\u00d7 given by the character\n\u03c7n (z) = z n . Let Vn = Vn \u00d7 H the homogeneous line bundle on H with action g * (v, z) =\n(\u03c7n (j(g, z))v, g * z). Since \u22121 \u2208\n/ \u03931 (\u2206, N ) and \u03931 (\u2206, N ) has no elliptic elements, the\nquotient \u03931 (\u2206, N )\\Vn is a line bundle on X1 (\u2206, N ) which we shall denote Vn again.\nPick vn \u2208 Vn , vn 6= 0, and let \u1e7dn = (vn , z) be the corresponding global constant section\nof Vn over H. Also, let s(z) be the global section of L over H, defined up to a sign,\nnormalized so that\nKS(s(z)\u22972 ) = 2\u03c0i dz.\n(27)\nThen L\u2297k = OH s(z)\u2297k for all k \u2265 1 and there are identifications of homogeneous\ncomplex line bundles over both H and X1 (\u2206, N )\n\u223c\n\nV2 \u2212\u2192 \u03a91 , \u1e7d2 7\u2192 2\u03c0i dz\n\nand\n\n\u223c\n\n\u2297k\n\nVk \u2212\u2192 L\u2297k , \u1e7dk 7\u2192 s(z)\n\n.\n\n(28)\n\nThese identifications preserve holomorphy and are compatible with tensor products and\nthe Kodaira-Spencer isomorphisms. Note that s(z) = \u00b12\u03c0i d\u03b6 in the split case by (22),\nand see remark 2.6.3 for the non-split case.\nFollowing [25], we shall define differential operators associated to splittings of the\nHodge seguence (18) where A/S is either the universal elliptic curve EN /Y1 (N ) or the\nuniversal QM-abelian surface A\u2206,N /X1 (\u2206, N ).\nOver the associated differentiable manifold, which amounts to tensoring with the\nsheaf of OS -algebras OS\u221e = C \u221e (S an ) and which will be denoted with an \u221e subscript,\n1\nthe Hodge decomposition H\u221e\n= \u03c9 \u221e \u2295 \u03c9 \u221e is a splitting of the Hodge sequence with\n1\nprojection Pr\u221e : H\u221e \u2192 \u03c9\u221e . For each k \u2265 1, let \u0398ok,\u221e be the operator defined by the\ncomposition\n1\u2297KS\u22121\n\n\u2207\n\n1\n1\n1\n)\u221e \u2297 \u03a91 \u2212\u2212\u2212\u2212\u2212\u2192 Symk (HdR\n)\u221e \u2297 L\u221e\nSymk (\u03c9 \u221e ) \u2282 Symk (HdR\n)\u221e \u2212\u2212\u2212\u2212\u2192 Symk (HdR\n\uf8e6\n\uf8e6 \u2297k\nyPr\u221e \u22971\n\nSymk (\u03c9)\u221e \u2297 L\u221e\n(29)\nwhere the Gauss-Manin connection \u2207 extends to Symk by the product rule. The composition L\u2297k \u2282 \u03c9 \u2297k \u2192 Symk (\u03c9) is injective and let \u0398k,\u221e be the restriction of \u0398ok,\u221e to\nL\u2297k\n\u221e .\n17\n\n\fA. Mori\n\n\u2297k+2\nProposition 2.8. \u0398k,\u221e is an operator L\u2297k\n\u221e \u2192 L\u221e\n\nProof. If D is split then L\u2297k = \u03c9k = Symk (\u03c9) and there is nothing to prove. If\nD is non-split, the element e\u2297k \u2208 (R1 \u2297Z O(v) )\u2297k acting componentwise defines a\nprojection \u03c9 \u2297k \u2192 L\u2297k which factors through Symk (\u03c9). By proposition 2.2 the GaussManin connection \u2207 commutes with e\u2297k and also the Hodge projection Pr\u221e is the\nidentity on L\u221e (in fact on \u03c9\u221e ). The result follows.\nThe operators \u0398k,\u221e can be computed in terms of the complex coordinate z = x+iy \u2208\nH and the identifications (28). For any (say C \u221e ) function \u03c6 on H let\n\u0012\n\u0013\nd\nk\n1\n\u03c6.\n+\n\u03b4k (\u03c6) =\n2\u03c0i dz\n2iy\nThe operator \u03b4k was introduced, together with its higher dimensional analogues by\nMaass [31] and later extensively studied by Shimura (see [18, Ch. 10] and the references\ncited therein).\nProposition 2.9. There are commutative diagrams of C \u221e -bundles and differential operators\n\u223c\nVk \u2212\u2212\u2212\u2212\u2192 L\u2297k\n\uf8e6\n\uf8e6\n\uf8e6\u0398\n\uf8e6e\ny k,\u221e\ny\u03b4k\n\u223c\n\nwhere \u03b4en (\u03c6\u1e7dn ) = \u03b4n (\u03c6)\u1e7dn+2 .\n\nVk+2 \u2212\u2212\u2212\u2212\u2192 L\u2297k+2\n\nProof. The diagram for D split is but the simplest case (dimension 1) of [11, theorem 6.5]. The computation in the non-split case is very similar. Let s be the KSnormalized section of L as in (27), \u03b7 = {\u03b71 , . . . , \u03b74 } be Hashimoto's symplectic basis of\ntheorem 1.1 and \u03a0 = \u03a0\u03b7 (z) the period matrix as in (24). Since the sections \u03b71 \u2228 , . . . , \u03b74 \u2228\nare \u2207-horizontal,\n\uf8eb\n\uf8f6\n\uf8eb\n\uf8f6\n\uf8eb \u2228 \uf8f6\n\uf8eb\n\uf8f6\u22121\n\uf8f6\n\uf8eb\nd\u03b61\nd\u03b61\n\u03b71\n\u03a0\nd\u03b61\n\uf8ec\n\uf8f7\n\uf8ec\n\uf8f7\n. \uf8f7\n\uf8f8 \uf8ec d\u03b62 \uf8f7 = (I2 , \u2212I2 ) \uf8ec d\u03b62 \uf8f7 \u2297 dz.\n\uf8f8 = d\u03a0 \uf8ec\n\u2207\uf8ed\n\uf8ed .. \uf8f8 = d\u03a0\uf8ed\n\uf8ed d\u03b6\u03041 \uf8f8\n\uf8ed\nd\u03b6\u03041 \uf8f8\nz \u2212 z\u0304\nd\u03b62\n\u03a0\n\u03b74 \u2228\nd\u03b6\u03042\nd\u03b6\u03042\n\n\u0011\n+ s0 \u2297 dz with Pr\u221e (s0 ) = 0.\n\u0011\n\u0010\n\u2297k\n\u2297k\u22121\ns\n\u2297\ndz\n+\nk\u03c6s\n\u2207(s)\nyields\nPlugging this into \u0398k,\u221e (\u03c6s\u2297k ) = Pr\u221e (1 \u2297 KS\u22121 ) d\u03c6\ndz\nthe result.\nSince s is in the C-span of d\u03b61 and d\u03b62 , \u2207(s) =\n\n\u0010\n\n1\nz\u2212z\u0304 s\n\nLet B be a p-adic algebra with (p, \u2206N ) = 1 and such that the e is defined over\nB and the isomorphism of theorem 2.5 holds for the sheaves base-changed to B. Let\nO(p) be the structure sheaf of the formal scheme S (p) = lim (S \u2297 B/pn B)p\u2212ord obtained\n\u2190n\n\ntaking out the non-ordinary points in characteristic p. Denote M(p) the tensorization\nwith O(p) of the restriction to S (p) of a sheaf M.\nIn the split case the Dwork-Katz construction [24, \u00a7A2.3] of the unique Frobenius1\n1\nstable \u2207-horizontal submodule U \u2282 HdR\n\u2297 B defines a splitting (HdR\n)(p) = \u03c9(p) \u2295 U\n1 (p)\n(p)\nwith projection Prp : (HdR ) \u2192 \u03c9 . The construction can be carried out in the non\nsplit case as well. If B \u2032 is a B-algebra and AB \u2032 is is a QM-abelian surface with ordinary\n18\n\n\fPower series expansions of modular forms\n\nreduction and canonical subgroup H (which, by ordinarity, is simply the Cartier dual of\nthe lift of the kernel of Verschiebung\u2013an \u00e8tale group), then H \u2282 A[p] with A[p]/H lifting\nan \u00e8tale group and for every \u03c6 \u2208 End(A), \u03c6(H) \u2286 H by connectedness. Thus A/H is a\nQM-abelian surface with a canonical embedding R1 \u0592\u2192 End(A/H) and the construction\n1 (p)\nof the Frobenius endomorphism of (HdR\n) and its splitting follows. Assuming that the\nline bundle L is defined over B and following the same procedure as in (29) with the\nprojection Pr\u221e replaced by Prp yields a differential operator\n\u0398ok,p : Symk (\u03c9 (p) ) \u2212\u2192 Symk (\u03c9 (p) ) \u2297 L(p) .\nLet \u0398k,p be its restriction to (L\u2297k )(p) .\nProposition 2.10. \u0398k,p is an operator (L\u2297k )(p) \u2192 (L\u2297k+2 )(p) .\nProof. The argument is the same as in the proof of proposition 2.8. The action of the\nendomorphisms commutes with the pullback of forms in the quotient A \u2192 A/H and\nso with the Frobenius endomorphism. Since U is Frobenius-stable, the endomorphisms\ncommute with the projection Prp .\nLet \u2217 \u2208 {\u221e, p}. The operators \u0398k,\u2217 can be iterated. For all r \u2265 1 let\n(r)\n\n\u0398k,\u2217 = \u0398k+2r\u22122,\u2217 \u25e6 * * * \u25e6 \u0398k,\u2217 .\nSince the kernel of the projecton Pr\u2217 is \u2207-horizontal one has in fact\n\u0001r\n(r)\n\u0398k,\u2217 = Pr\u2217 (1 \u2297 KS\u22121 )\u2207 .\n\n(r)\n\n(30)\n\nThe operators \u0398k,\u221e do not preserve holomorphy because the Hodge projection Pr\u221e is\n(r)\n\nnot holomorphic. Similarly, the operators \u0398k,p are only defined over p-adically complete\n(r)\n\nring of integers. Nonetheless, the operators \u0398k,\u2217 are algebraic over the CM locus, in\nthe following sense. Let x \u2208 X1 (\u2206, N )(O(v) ) be represented by a \u03c4 \u2208 H belonging to a\np-ordinary test triple (\u03c4, v, e). Let L(x) = x\u2217 L be the algebraic fiber at x. The choice\nof an invariant form \u03c9o on Ax which generates either H 0 (Ax , \u03a91 \u2297 O(v) ) (in the split\ncase) or eH 0 (Ax , \u03a91 \u2297 O(v) ) (in the non-split case) over O(v) identifies L(x) with a copy\nof O(v) .\nProposition 2.11. Let x \u2208 X1 (\u2206, N )(O(v) ) be a point represented by a p-ordinary test\ntriple and let \u03c9o be an invariant form on Ax as above. Then, for all r \u2265 1, the operators\n(r)\n\u0398k,\u2217 define maps\n(r)\n\n\u0398k,\u2217 (x) : H 0 (X1 (\u2206, N ) \u2297 O(v) , L\u2297k ) \u2212\u2192 L\u2297k+2r (x) \u2243 O(v) \u03c9o \u2297k+2r .\n(r)\n\n(r)\n\nMoreover \u0398k,\u221e (x) = \u0398k,p (x).\nProof. The result follows, as in [26, theorem 2.4.5], from the following observation. Let\nA be an abelian variety isogenous over O(v) to the g-fold product of elliptic curves with\ncomplex multiplications in the field K and ordinary good reduction modulo v. The CM\n1\nsplitting of the first de Rham group of A is the splitting HdR\n(A/O(v)) = H\u03c31 \u2295H\u03c32 where\nH\u03c3i is the \u03c3i -eigenspace under the action of complex multiplications, IK = {\u03c31 , \u03c32 }. The\n1\nHodge decomposition HdR\n(A) \u2297 C = H 1,0 \u2295 H 0,1 and the Dwork-Katz decomposition\n0\n1\nHdR (A) \u2297 B = H (A \u2297 B, \u03a91 ) \u2295 U for some p-adic O(v)-algebra B are both obtained\n19\n\n\fA. Mori\n\nfrom the CM splitting by a suitable tensoring. The result follows from the algebraicity of\nthe Gauss-Manin connection and the Kodaira-Spencer map, using the expression (30).\nFor all r \u2265 1 write\n(r)\n\u03b4k\n\n= \u03b4k+2r\u22122 \u25e6 * * * \u25e6 \u03b4k =\n\n\u0012\n\n1\n2\u03c0i\n\n\u0013r \u0012\n\nd\nk + 2r \u2212 2\n+\ndz\n2iy\n\n\u0013\n\n\u25e6 ***\u25e6\n\n\u0012\n\nd\nk\n+\ndz\n2iy\n\n\u0013\n\n(0)\n\nand set \u03b4k (\u03c6) = \u03c6.\n\n3\n3.1\n\nExpansions of modular forms\nSerre-Tate theory.\n\nLet k be any field, (\u039b, m) a complete local noetherian ring with residue field k and C the\ne be an abelian variety\ncategory of artinian local \u039b-algebras with residue field k. Let A\nover k of dimension g. By a fundamental result of Grothendieck [37, 2.2.1], the local\nmoduli functor M : C \u2192 Sets which associates to each B \u2208 Ob C the set of deformations\ne to B, is pro-represented by \u039b[[t1 , . . . , tg2 ]]. When k is perfect of characteristic p > 0\nof A\ne is equivalent to deforming its\nand \u039b = Wk is the ring of Witt vectors of k, deforming A\nformal group, as precised by the Serre-Tate theory [27, \u00a72]. If k is algebraically closed\ne is ordinary, an important consequence of the Serre-Tate theory is that there is a\nand A\ncanonical isomorphism of functors\n\u223c\n\nb m ),\net , G\ne \u2297 Tp A\nM \u2212\u2192 Hom(Tp A\n\n[27, theorem 2.1]. Write M = Spf(Ru ) with universal formal deformation Au over Ru .\nThe isomorphism endows M with a canonical structure of formal torus and identifies its\net . Denote\ne \u2297 Tp A\nb m ) \u2282 Ru with the group Tp A\ngroup of characters X(M) = Hom(M, G\net . For a deformation A/B of A\ne with\ne \u2297 Tp A\nqS the character corresponding to S \u2208 Tp A\nb let\n(B, mB ) \u2208 Ob C,\nb m (B) = 1 + mB\net \u2212\u2192 G\ne \u00d7 Tp A\nq(A/B ; *, *) : Tp A\n\nbe the corresponding bilinear form. When k is not algebraically closed, the group\nstructure on M \u2297 k descends to a group structure on M, for the details see [36, 1.1.14].\nLet N \u2282 M be a formal subgroup and \u03c1 : X(M) \u2192 X(N ) the restriction map. The\nZp -module N = ker(\u03c1) is called the dual of N . Via Serre-Tate theory, N \u2286 Tp A \u2297 Tp At .\nThen\n!\ne \u2297 Tp A\net\nTp A\n\u223c\nbm\nN \u2212\u2192 Hom\n,G\nN\nand\n\nN is a subtorus of M\n\n\u21d0\u21d2 X(N ) \u2243 X(M)/N is torsion-free\net .\ne \u2297 Tp A\n\u21d0\u21d2 N is a direct summand of Tp A\n\nTo simplify some of the next statements, we shall henceforth assume that p > 2.\n20\n\n\fPower series expansions of modular forms\n\ne\u2192B\ne be a morphism of ordinary abelian varieties over k.\nProposition 3.1. Let fe: A\nThe morphism fe lifts to a morphism f : A \u2192 B of deformations over B if and only if\nq(A/B ; P, fet (Q)) = q(B/B ; fe(P ), Q)\n\ne\ne and Q \u2208 Tp B.\nfor all P \u2208 Tp A\n\ne is principally polarized, the formal subscheme Mpp that classifies\ne \u03bb)\nIn particular, if (A,\ne with a lifting \u03bb of the principal polarization is a subtorus whose group\ndeformations of A\nof characters is\ne\nX(Mpp ) = Sym2 (Tp A).\n\nProof. The first part of the statement is [27, 2.1.4]. For the second part, the principal\ne identifies Tp A\net . For a deformation A/B let q \u2032 (A/B ; P, P \u2032 ) =\ne \u2243 Tp A\npolarization \u03bb\n\u2032\ne\ne\nq(A/B ; P, \u03bb(P )). Then \u03bb lifts to A if and only if q \u2032 is symmetric, and the submodule\nof symmetric maps is a direct summand.\nThe last part of the proposition can be rephrased by saying that there is a commutative diagram\n\u223c\net \u2212\u2212\u2212\ne \u2297 Tp A\n\u2212\u2192 X(M)\nTp A\n\uf8e6\n\uf8e6\n\uf8e6\npolarization \uf8e6\ny\nyrestriction\n+ quotient\n\u223c\ne \u2212\u2212\u2212\n\u2212\u2192 X(Mpp )\nSym2 (Tp A)\n\net respece and of Tp A\nConcretely, if {P1 , . . . , Pg } and {P1t , . . . , Pgt } are Zp -bases of Tp A\n2\nu\nt\nu\ntively, the g elements qi,j = q(A/Ru ; Pi , Pj ) \u2212 1 define an isomorphism R \u2243 Wk [[qi,j ]].\ne is principally polarized we may take Pi = P t under the identification Tp (A)\ne \u2243\nIf A\ni\nt\npp\npp\ne\nTp (A ). Then qi,j = qj,i on M = Spf(R ) and\npp\n]],\nRpp \u2243 Wk [[qi,j\n\npp\n= qi,j |Mpp , 1 \u2264 i \u2264 j \u2264 g.\nwith qi,j\n\nMore generally, if N = Spf(RN ) is a subtorus with n = rkZp (N ), a Zp -basis {S1 , . . . , Sn }\net . If qi =\ne \u2297 Tp A\nof N can be completed to a basis {S1 , . . . , Sn , Sn+1 , . . . , Sg2 } of Tp A\nN\nN\nN\nu\nqSi (A/Ru ) \u2212 1 and qi = qi |N , then q1 = . . . = qn = 0 by construction and RN =\nN\nWk [[qn+1\n, . . . , qgN2 ]].\n\u223c\net \u2192\nbG\nb m ) for\ne is ordinary, there is a canonical isomorphism Tp A\nHomB (A,\nSince A\ne\nany deformation A/B of A. Composition with the pulling back the standard invariant\net \u2192 \u03c9\nb m yields a functorial Zp -linear homomorphism \u03c9 : Tp A\nform dT /T on G\nA/B which\nis compatible with morphisms of abelian schemes, in the sense that if the morphism\ne\u2192B\ne of abelian varieties over k then, [27, lemma\nf : A \u2192 B lifts the morphism fe: A\n3.5.1],\net.\n(31)\nf \u2217 (\u03c9(P t )) = \u03c9(fet (P t )),\nfor all P t \u2208 Tp B\nBy functoriality, the maps \u03c9 extend to a well-defined Zp -linear homomorphism\net \u2192 \u03c9Au /M .\n\u03c9 u : Tp A\n\u223c\n\net \u2297 OM \u2192 \u03c9 u\nwhose Ru -linear extension Tp A\nA /M is an isomorphism. Thus, a choice of\nL\nsh\nt\nt\nt\ne yields an identification \u03c9 u\na Zp -basis {P , . . . , P } of Tp A\n= ( g Ru \u03c9i ) where\n1\n\nA /M\n\ng\n\ni=1\n\n\u03c9i = \u03c9 u (Pit ), i = 1, . . . , g and the superscript ( )sh denotes the sheafified module.\ne is principally polarized. Let N \u2282 Mpp be a subtorus with dual\nSuppose that A\nN and let AN be the restriction over N of the universal deformation Au /M. Let\n21\n\n\fA. Mori\n\ne such that N =\net ) = Sym2 (Tp A)\n{S1 , . . . , S g(g+1) } be a Zp -basis of Sym2 (Tp A\n(2)\n\n2\n\nLn\n\nj=1\n\nZp Sj .\n\nLet \u03c9i the pullback to AN of Sym2 (\u03c9 u )(Si ), qipp and qiN be the restriction of the local\nparameters qSi constructed above, i = 1, . . . , g(g + 1)/2.\nProposition 3.2.\n(2)\n\nKSN (\u03c9i ) =\n\n\u001a\n\n0\nd log(qipp + 1)|N\n\nfor i = 1, . . . , n\nfor i = n + 1, . . . , g(g + 1)/2\n\nProof. It is an immediate application of proposition 2.1 to Katz's computations [27, the\u0011sh\n\u0010L\n(2)\ng(g+1)/2\norem 3.7.1], because there are identifications Sym2 (\u03c9 AN /N ) =\n,\nRN \u03c9 i\ni=1\n\u0010L\n\u0011sh\n\u0011sh\n\u0010L\ng(g+1)/2\ng(g+1)/2\n\u03a91Mpp /W =\nRpp dqipp , \u03a91N /W =\nand dqiN = 0 for\nRN dqiN\ni=1\ni=n+1\ni = 1, ..., n.\nElliptic curves and false elliptic curves. Let (\u03c4, v, e) be a split p-ordinary test\ntriple and denote A the corresponding CM curve (if D is split) or principally polarized\ne its reduction modulo p. Of the two\nQM-abelian surface (if D is non split) with A\ne \u2297 Qp coincide with\nembeddings K \u0592\u2192 Qp , fix the one that makes the K action on Tp A\nits natural Qp -vector space structure.\ne If D is split, everything\nLet M be the local moduli functor corresponding to A.\npp\nhas been already implicitely described: M = M is a 1-dimensional torus and Rpp =\ne Also, if \u03c9u = \u03c9 u (P ) then\nRu = W [[q \u2212 1]] with q = qP \u2297P for a Zp -generator P of Tp A.\n2\n\u22972\nu\n\u22972\n\u03c9u = Sym (\u03c9 )(P \u25e6 P ) and KS(\u03c9u ) = d log(q).\nIf D is non-split, let N = ND be the subfunctor\n)\n(\ne with a lift of\nprincipally polarized deformations A/B of A\nND (B) =\nthe endomorphisms given by elements of the maximal order R1\ne and since e \u2208 R1 \u2297 Zp we can find a\nThe maximal order R1 acts naturally on Tp A\ne\nZp -basis {P, Q} of Tp A such that eP = P and eQ = 0.\nProposition 3.3.\n\n1. N = Spf(RN ) is a 1-dimensional subtorus of Mpp ;\n\n2. RN = Wk [[q \u2212 1]], where q = qPN\u25e6P ;\n3. if \u03c9u denotes the pullback of \u03c9 u (P ) to AN , then KS(\u03c9u\u22972 ) = d log(q).\nProof. It follows from proposition 3.1 that N (B) is identified with the set of the\ne\u2192G\nb m (B) such that q(P, r\u2020 Q) = q(rP, Q) for all\ne \u00d7 Tp A\nsymmetric bilinear forms q : Tp A\nr \u2208 R1 . This makes clear that N is a subgroup, and that its dual N is the Zp -submodule\ngenerated by the elements\n\u001a\nP1 \u2297 P2 \u2212 P2 \u2297 P1\ne and r \u2208 R1 .\nfor all P1 , P2 \u2208 Tp (A)\nrP1 \u2297 P2 \u2212 P1 \u2297 r\u2020 P2\n\nChoose u in the decomposition (11) for the subfield F \u2282 D so that u \u2208 R1 , u\u2020 = \u2212u\nand |\u03bd(u)| is minimal. In particular u2 = \u2212\u03bd(u) is a square-free integer. Pick a basis\nof D in R1 of the form {1, r, u, ru} with r2 \u2208 Z. From our choice of test triple we can\nassume that Z[r] is an order in F of conductor prime to p, in particular p does not\n22\n\n\fPower series expansions of modular forms\n\ndivide r2 . The submodule R = Z \u2295 Zr \u2295 Zu \u2295 Zru is actually an order of discriminant\n\u221216r4 u4 such that R\u2020 = R.\nSuppose that p|u2 and let y = p1 (a + br + cu + dru) with a, b, c and d \u2208 Z be an\nelement in R1 \u2212R such that \u0233 = y+R generates the unique subgroup of order p in R/R1 .\nThe conditions tr(y) \u2208 Z, \u03bd(y) \u2208 Z, and \u0233 \u2020 = \u00b1\u0233 easily imply that the coefficients a, b,\nc and d are all divisible by p and this is a contradiction. Thus R \u2297 Zp = R1 \u2297 Zp and\nthis reduces the set of generators for N to\nP \u2297Q\u2212Q\u2297P\nrP \u2297 Q \u2212 P \u2297 rQ\nuP \u2297 P + P \u2297 uP\n.\nuP \u2297 Q + P \u2297 uQ uQ \u2297 Q + Q \u2297 uQ ruP \u2297 Q \u2212 P \u2297 ruQ\nFrom the relations re = er and ue = (1 \u2212 e)u\u0010 in R1\u0011 \u2297 Zp \u0010we get\n\u0011 that the elements r\n\u03b1 0\n0\u03b2\nand u act on the basis {P, Q} as the matrices 0 \u2212\u03b1 and \u03b3 0 respectively. Since \u03b1,\n\u03b2 and \u03b3 are p-units, finally N turns out to be the Zp -module generated by\nP \u2297 Q \u2212 Q \u2297 P,\n\n\u03b3P \u2297 P + \u03b2Q \u2297 Q,\n\nP \u2297Q+Q\u2297P\n\nand\ne = N \u2295 Zp (P \u2297 P ).\ne \u2297 Tp A\nTp A\n\nThis proves points 1 and 2, and the last part follows at once from proposition 3.2.\nRemark 3.4. The fact that N is actually a subtorus can be reinterpreted, as in [36],\nin the more general context of Hodge and Tate classes.\n\n3.2\n\nPower series expansion\n\nWe shall now use the Serre-Tate theory to write a power series expansion around an\nordinary CM point of a modular form f \u2208 Mk,1 (\u2206, N ) and compute the coefficients of\nthis expansion in terms of the Maass operators studied in section 2.3. We assume that\nN > 3.\nLet SpD the full subcategory of the category of rings consisting of the rings B such\nthat R1 \u2297B \u2243 M2 (B). Note that if (\u03c4, v, e) is a p-ordinary test triple, then Ov \u2208 ObSpD .\nFor a KS-normalized section s(z) in (27) the assignment\nf (z) 7\u2192 f \u2217 (z) = f (z)s(z)\u2297k\n\n(32)\n\nsets up an identification\nMk,1 (\u2206, N ) \u2243 H 0 (X1 (\u2206, N ), L\u2297k )\ndefined up to a sign (the ambiguity obviously disappears for k even). The identification\n\u221e\nextends naturally to an identification of the bigger space Mk,\u03b5\n(\u2206, N ) of C \u221e -modular\n\u221e\nforms with the global sections of the associated C -bundle L\u2297k\n\u221e . This \"geometric\"\ninterpretation of modular forms can be used to endow the space Mk,1 (\u2206, N ) with a\ncanonical B-structure for any subring B \u2282 C of definition for L in SpD . In fact for any\nring B in SpD such that L is defined over B the space of modular forms defined over\nB may be defined as\nMk,1 (\u2206, N ; B) = H 0 (X1 (\u2206, N ) \u2297 B, L\u2297k ).\n23\n\n\fA. Mori\n\nRemark 2.6.2 shows that this B-structure does not depend on the choice of L, i.e. on the\nchoice of idempotent e. If B \u2032 is a flat B-algebra, the identification Mk,1 (\u2206, N ; B)\u2297 B \u2032 =\nMk,1 (\u2206, N ; B \u2032 ) follows from the usual properties of flat base change. By smoothness,\nif 1/N \u2206 \u2208 B \u2282 C then Mk,1 (\u2206, N ; B) \u2297 C = Mk,1 (\u2206, N ; C) = Mk,1 (\u2206, N ). In fact\nthe assignment (32) is normalized so that f \u2208 Mk,1 (N ; B) if and only if its Fourier\ncoefficients belong to B (q-expansion principle, e.g. [24, Ch. 1] [11, theorem 4.8]).\nLet A/X be either universal family (7) or (9). Let x \u2208 X (O(v) ) be represented by\na point \u03c4 \u2208 CM\u2206,K in a split p-ordinary test triple (\u03c4, v, e). Denote Ax the fiber of\nA/X over x and A\u03c4 the corresponding complex torus. We will implicitely identify the\nring Wk(v) of Witt vectors for the algebraic closure of k(v) with Ovnr . For each n \u2265 0,\nbX ,x. By smoothness, there is a nonlet Jx,n = OX ,x /mn+1\nand Jx,\u221e = lim Jx,n = O\nx\n\u2190n\n\ncanonical isomorphism Jx,\u221e \u2243 O(v) [[u]]. For n \u2208 N \u222a {\u221e} the family A/X restricts to\nabelian schemes Ax,n/Jx,n . Tautologically Ax = Ax,0 , and Ax,n = Ax,\u221e \u2297 Jx,n with\nnr\nb vnr and\nrespect to the canonical quotient map Jx,\u221e \u2192 Jx,n . Also, let Jx,n\n= Jx,n \u2297O\nnr\nnr\nAx,n = Ax,n \u2297 Jx,n .\nLet M = Spf(R) be either the full local moduli functor (in the split case) or\nits subtorus described in proposition 3.3 (in the non-split case) associated with the\nex = Ax \u2297 k v with universal formal deformation Ax /M. In either case\nreduction A\nb m ) where T is a free Zp -module of rank 1. Since the rings J nr are\nM \u2243 Hom(T, G\nx,n\npro-p-Artinian, there are classifying maps\nnr\n\u03c6x,n : R \u2212\u2192 Jx,n\n,\n\nfor all n \u2208 N \u222a {\u221e}\n\nnr\nsuch that Anr\nx,n = Ax \u2297\u03c6x,n Jx,n . Since the abelian schemes Ax,n are the restriction\nof the universal (global) family, the map \u03c6x,\u221e is an isomorphism. We will use it to\ntransport the Serre-Tate parameter qS \u2212 1 \u2208 R and the formal sections \u03c9u constructed\nin section 3.1 out of a choice of a Zp -generator S of T to the p-adic disc of points in X\nthat reduce modulo pv to the same geometric point in X \u2297 k v . Also, we can pull back\nthe parameter along the translation by x\u22121 in M to obtain a local parameter ux at x\n(depending on S), namely\nnr\nJx,\u221e\n= Ovnr [[ux ]],\n\nwith ux = qS (x)\n\n\u22121\n\nqS \u2212 1.\n\nThe complex uniformization of Ax associated with the choice of \u03c4 can be used to define\ntranscendental periods. For any \u03c9o \u2208 H 0 (Ax (C), L(x)) write\n\u03c9o = p(\u03c9o , \u03c4 )s(\u03c4 )\n\np(\u03c9o , \u03c4 ) \u2208 C,\n\nunder the isomorphism Ax (C) \u2243 A\u03c4 . For f \u2208 Mk,1 (\u2206, N ) define complex numbers\n(r)\n\nc(r) (f, x, \u03c9o ) =\n\n\u03b4k (f )(\u03c4 )\np(\u03c9o , \u03c4 )k+2r\n\nr = 0, 1, 2, . . . .\n\n(33)\n\nThe use of x in the definition (33) is justified by the following fact.\nProposition 3.5. Suppose that f \u2208 Mk (\u0393) for some Fuchsian group of the first kind\nR11 \u2265 \u0393 \u2265 \u03931 (\u2206, N ). Then the numbers c(r) (f, x, \u03c9o ) \u2208 C do not depend on the choice\nof \u03c4 in its \u0393-orbit.\nProof. For any \u03b3 \u2208 \u0393, multiplication by j(\u03b3, \u03c4 )\u22121 induces an isomorphism of complex\n\u223c\ntori A\u03c4 \u2192 A\u03b3\u03c4 . Since s is a global constant section of L over H, under the standard\nidentifications of invariant forms, s(\u03b3\u03c4 ) = s(\u03c4 )j(\u03b3, \u03c4 )\u22121 . The assertion follows at once.\n\n24\n\n\fPower series expansions of modular forms\n\nThe periods p(\u03c9o , \u03c4 ) (and conseguently the numbers c(r) (f, x, \u03c9o )) can be normalized\nby choosing \u03c9o as in proposition 2.11. For such a choice, defined up to a v-unit, set\n(r)\nc(r)\n(f, x, \u03c9o ).\nv (f, x) = c\n\n\u03a9\u221e = \u03a9\u221e (\u03c4 ) = p(\u03c9o , \u03c4 ),\n\nAlso, define the p-adic period \u03a9p = \u03a9p (x) \u2208 Ovnr,\u00d7 (again defined up to a v-unit) as\n\u03c9o = \u03a9p \u03c9u (x).\nnr\nLet f \u2208 Mk,1 (\u2206, N ; Ovnr ). Over Spf(Jx,\u221e\n) write f \u2217 = fx \u03c9u\u2297k and\n!\n\u221e\nX\nbn (f, x) n\n\u2217\n\u2217\n\u2297k\nUx \u03c9u (x)\u2297k\njetx (f ) = x jet(fx ) \u2297 \u03c9u (x) =\nn!\nn=0\n\nwhere fx is expanded at x in terms of the formal local parameter Ux = log(1 + ux ).\nTheorem 3.6. Let x \u2208 X\u2206,N (O(v) ) be represented by a split p-ordinary test triple\n(\u03c4, v, e) and f \u2208 Mk (\u2206, N ; O(v) ). Then, for all r \u2265 0,\nbr (f, x)\n= c(r)\nv (f, x) \u2208 O(v) .\n\u03a9k+2r\np\nProof. The case r = 0 is clear, so let us assume that r \u2265 1.\nWe have \u2207(f \u2217 ) = \u2207(fx \u03c9u\u2297k ) = dfx \u2297 \u03c9u\u2297k + kfx \u03c9u\u2297k\u22121 \u2207(\u03c9u ). Since \u2207(\u03c9 u (P )) \u2208\n0\ne [27, theorem 4.3.1], the term containing \u2207(\u03c9u ) is killed\nH (M, U) for each P \u2208 Tp (A),\nby the projection Prp . Also, dUx = d log(ux + 1) = d log(q + 1) doesn't depend on x\nand we obtain \u0398k,p (f \u2217 ) = (dfx /dUx )\u03c9u\u2297k+2 . Iterating the latter computation r times\nand evaluating the result at x yields\n(r)\n\n\u0398k,p (f \u2217 )(x) =\n\ndr fx\nbr (f, x)\nk+2r\n(x) = k+2r \u03c9ok+2r .\nr (x)\u03c9u\ndUx\n\u03a9p\n\nOn the other hand, applying r times the proposition 2.9 and evaluating at \u03c4 yields\n(r)\n\n(r)\n\n\u0398k,\u221e (f \u2217 )(x) = \u03b4k (f )(\u03c4 )s(\u03c4 )\u2297k+2r = c(r) (f, x, \u03c9o )\u03c9ok+2r .\nThe result follows from proposition 2.11.\nThis result has a converse. For, we need the following preliminary discussion. Let\nD be any domain of characteristic 0 and field of quotients K. The formal substitution\n1 3\n1 2\nU + 3!\nU + * * * defines a bijection between the rings of formal\nu = eU \u2212 1 = U + 2!\npower series K[[u]] and K[[U ]]. Under this bijection the ring D[[u]] is identified with a\nsubring of the ring of Hurwitz series, namely power series of the form\n\u221e\nX\n\u03b2n n\nU ,\nn!\nn=0\n\nwith \u03b2n \u2208 D for all n = 0, 1, 2, ....\n\nWe say that a power series \u03a6(U ) \u2208 K[[U ]] is u-integral if \u03a6(U ) = F (eU \u2212 1) for some\nF (u) \u2208 D[[u]]. Denote cn,r the coefficients defined by the polynomial identity\nn!\n\n\u0010 \u0011\nX\nn\n\n= X(X \u2212 1) * * * (X \u2212 n + 1) =\n\nn\nX\n\ncn,r X r .\n\nr=0\n\nThe following possibly well known result is closely related to [41, Th\u00e9or\u00e8me 13].\n25\n\n\fA. Mori\nP\u221e \u03b2n n\nis u-integral if and only if\nTheorem 3.7. A Hurwitz series \u03a6(U ) =\nn=0 n! Z\n1\n(c\n\u03b2\n+\nc\n\u03b2\n+\n*\n*\n*\n+\nc\n\u03b2\n)\n\u2208\nD\nfor\nall\nd\n=\n1,\n2,\n....\nd,2 2\nd,d d\nd! d,1 1\nProof. Let F (u) = \u03a6(log(1 + u)) \u2208 K[[u]]. For any polynomial P (X) = p0 + p1 X +\n* * * + pd X d \u2208 K[X] of degree d, an immediate chain rule computation yields\n\u0012\n\u0013\nd\nP (u + 1)\nF (u)\n= p0 \u03b20 + p1 \u03b21 + ... + pd \u03b2d .\ndu\nu=0\n\u0001\n\u0001\nd\nd\nF (u) u=0 = P (u + 1) du\nFd (u) u=0 where Fd (u) is the degree d\nAlso P (u + 1) du\nd+1\ntruncation of F (u), i.e. F (u) = Fd (u) + U\nH(u). On the space of polynomials\nof\n\u0001\nd\ndegree \u2264 d the substituition u = v \u2212 1 is defined over D and P (u + 1) du\nFd (u) u=0 =\n\u0001\n\u0001 k\nd\nd\nP v dv\nFd (v \u2212 1) v=1 . Since P v dv\nv v=1 = P (k)v k , the argument shows that if\n\u03a6(U ) is u-integral, then the expression p0 \u03b20 + p1 \u03b21 + ... + pd\u03b2d is a D-linear combination\nof the values P (0), P (1), ..., P (d).\nOn the other hand, the argument also shows that\n\u0010\n\u0011\n1\n(cd,1 \u03b21 + cd,2 \u03b22 + * * * + cd,d \u03b2d ) = v d/dv\nFd (u \u2212 1)\nd\nd!\nv=1\nis the coefficient of U d in F .\nTherefore, we obtain that \u03a6(U ) is u-integral if and only p0 \u03b20 +p1 \u03b21 +...+pd \u03b2d \u2208 D for\nevery polynomial P (X) = p0 +p1 X +* * *+pd X d \u2208 K[X] such that P (0), P (1), ..., P (d) \u2208\nD. We conclude observing that a degree d polynomial P (X) \u2208 K[X] such that P (0),\nP (1), ..., P (d) \u2208 D is necessarily numeric, i.e. P (N) \u2282 D and that the D-module of\nnumeric polynomials is free, generated by the binomial coefficients.\n\nNote that when D is a ring of algebraic integers, or one of its non-archimedean completions, the conditions of the theorem can be readily rephrased in terms of congruences,\nknown as Kummer-Serre congruences.\nDenote Lv,sc the compositum of all finite extensions L \u2286 F such that v splits comsc\npletely in F and let O(v)\nbe the integral closure of O(v) in Lv,sc .\nTheorem 3.8 (Expansion principle). Let f \u2208 Mk,1 (\u2206, N ) and x \u2208 X (\u2206, N )(O(v) ) be\n(r)\nrepresented by a split p-ordinary test triple (\u03c4, v, e) such that the numbers cv (f, x) \u2208\n(r)\nO(v) for all r \u2265 0 and the p-adic numbers \u03a92r\np cv (f, x) satisfy the Kummer-Serre consc\ngruences. Then f is defined over O(v) .\nProof. Choose a field embedding \u0131 : C \u2192 Cp to view f \u2208 Mk,1 (\u2206, N ; Cp ). For all\n(r)\nr \u2265 0 set cr = cv (f, x) and \u03b2r = cr \u03a9\u01ebpD k+2r \u2208 Cp . Unwinding the computations\n\u0011\n\u0010P\n\u03b2r r\n\u2297k\n\u2208\nU\nthat led to the equality in theorem 3.6 shows that jetx (f \u2217 ) =\nr\u22650 r! x \u03c9u (x)\nnr\n(Jx,\u221e\n\u2297 Cp )\u03c9u (x)\u2297k . We claim that jetx (f \u2217 ) is defined over Ov . Write\n\uf8eb\n\uf8f6\n\uf8f6\n\uf8eb\nX \u03b2r\nX cr\njetx (f \u2217 ) = \uf8ed\nU r \uf8f8 \u03c9u (x)\u2297k = \uf8ed\n(\u03a92 Ux )r \uf8f8 \u03c9o\u2297k .\nr! x\nr! p\nr\u22650\n\nr\u22650\n\nSince the \u03b2r are v-integral and satisfy the Kummer-Serre congruences, the first equality\nshows that jetx (f \u2217 ) is v-integral. Since the formal substitution u = eU \u2212 1 preserves\nthe field of definition, the claim follows from the second equality if we check that the\nformal local parameter \u03a92p Ux is defined over Lv . The group Aut(Cp /Lv ) acts on the\n26\n\n\fPower series expansions of modular forms\n\ne\nsection \u03c9u via the action of its quotient Gal(Lnr\nv /Lv ) \u2243 Gal(k v /kv ) on Tp (Ax ) which is\ne\nscalar because Ax is either an elliptic curve or isogenous to a product of elliptic curves.\nThus, the section \u03a9p \u03c9u , whose restriction at x is defined over Lv , is itself defined over\nLv . Therefore \u03a92p dUx = KS(\u03a92p \u03c9u\u22972 ) is defined over Lv , and so is \u03a92p Ux because it is a\npriori defined over Lnr\nv and its value at the point x, defined over Lv , is 0.\nWe can now use the very same arguments of Katz's proof [24] of the q-expansion\nprinciple to conclude that the section f \u2217 is defined over Ov . For, observe that the\nq-expansion of a modular form f at the cusp s multiplied by the right power of the\ncanonical Tate form is jets (f \u2217 ). The specific nature of a cusp in the modular curve\nplays no role in Katz's proof, which works as well when the former are replaced by any\npoint in a smooth curve.\nSince f \u2217 is defined over C and over Ov , the modular form f is defined over the integral\nclosure of O(v) in the largest subfield F \u2282 C such that \u0131(F ) \u2286 Lv . The assertion follows\nfrom the arbitrariness of the choice of \u0131, since Lsc\n(v) can be characterized as the largest\nsubfield of C whose image under all the embeddings C \u2192 Cp is contained in Lv .\n\n4\n4.1\n\np-adic interpolation\np-adic K \u00d7 -modular forms\n\nA weight for the quadratic imaginary field K is a formal linear combination w = w1 \u03c31 +\nw2 \u03c32 \u2208 Z[IK ], which will be also written w = (w1 , w2 ). Following our conventions,\nwrite z w = z w1 z\u0304 w2 for all z \u2208 C. Also, let w\u0304 = (w2 , w1 ) and |w| = w1 + w2 , so that\nw + w\u0304 = |w| 1 with 1 = (1, 1).\nDefinition 4.1 (Hida [17]). Let E \u2287 K be a subfield of C. The space Sew (n; E) of\nK \u00d7 -modular form of weight w and level n with values in E is the space of functions\nf \u0303: In \u2192 E such that\nf \u0303((\u03bb)I) = \u03bbw f \u0303(I)\nfor all \u03bb \u2208 Kn\u00d7 .\nA remarkable subset of Sew (n) = Sew (n; C) is the set of algebraic Hecke characters of type\nA0 ,\ne w (n) = Sew (n) \u2229 Hom(In , C\u00d7 ).\n\u039e\n\ne w (n) there exists a\nA well-known property noted by Weil [48] is that for every \u03be \u0303 \u2208 \u039e\nnumber field E\u03be\u0303 such that \u03be \u0303 \u2208 Sew (n; E\u03be\u0303 ). A classical construction identifies the space\nSew (n) with the space Sw (n) of functions f : K \u00d7 \u2192 C\u00d7 such that\nA\n\nf (s\u03bbzu) = z \u2212w f (s) for all \u03bb \u2208 K \u00d7 , z \u2208 C\u00d7 and u \u2208 Un .\n\n(34)\n\nIf f \u0303 \u2194 f under this identification, then\nf \u0303(I) = f (s) whenever I = [s] and sv = 1 for v = \u221e and v|n.\n\n(35)\n\nb\u00d7 , the funcThis relation can be used to recognize Sew (n; E) in Sw (n). Since UcOK < O\nK,c\nb\u00d7\ntions f : KA\u00d7 \u2192 C\u00d7 satisfying the relation in (34) for all \u03bb \u2208 K \u00d7 , z \u2208 C\u00d7 and u \u2208 O\nK,c\nform a linear subspace Sw (OK,c ) \u2282 Sw (cOK ). The subspace Sw (OK,c ) includes the\n27\n\n\fA. Mori\n\nb\u00d7 , namely \u039ew (OK,c ) = Sw (OK,c )\u2229Hom(K \u00d7 /K \u00d7 O\nb\u00d7 , C\u00d7 ).\nHecke characters trivial on O\nK,c\nA\nK,c\nDenote\nb\u00d7 .\nCn = KA\u00d7 /K \u00d7 C\u00d7 Un \u2243 In /Pn ,\nC\u266fc = KA\u00d7 /K \u00d7 C\u00d7 O\nK,c\nand let hn = |Cn | and h\u266fc = C\u266fc . Clearly h\u266fc |hc .\n\nLemma 4.2.\n\n\u00d7 w\n1. \u039ew (OK ) 6= \u2205 if and only if (OK\n) = 1.\n\n2. \u039ew (OK,2 ) = \u039ew (2OK ) and they are non-trivial if and only if |w| is even.\n3. If c > 2 then \u039ew (cOK ) 6= \u2205 and \u039ew (OK,c ) 6= \u2205 if and only if |w| is even.\n4. \u039ew (OK,c ) and \u039ew (cOK ) are bases for Sw (OK,c ) and Sw (cOK ) respectively.\nProof. Let U < U1 and CU = KA\u00d7 /K \u00d7 C\u00d7 U . Then there is a short exact sequence\n1 \u2212\u2192\nwhere HU = C\u00d7 \u2229 K \u00d7 U . The\n\uf8f1\n\u00d7\n\uf8f4\n\uf8f2OK\nHUc = {\u00b11}\n\uf8f4\n\uf8f3\n{1}\n\nK\u00d7\nC\u00d7\n\u2212\u2192 \u00d7A \u2212\u2192 CU \u2212\u2192 1\nHU\nK U\n\nfirst three points follow from the observation that\nif c = 1,\nif c = 2,\nif c > 2,\n\nHOb\u00d7 =\nK,c\n\n(\n\n\u00d7\nOK\nif c = 1,\n{\u00b11} if c \u2265 2.\n\nFor the last part, observe that multiplication by any \u03be \u2208 \u039ew (cOK ) defines, for every\n\u223c\nweight w \u2032 , an isomorphism Sw\u2032 (cOK ) \u2192 Sw+w\u2032 (cOK ) which identifies the respective\nsets of Hecke characters. When \u03be \u2208 \u039ew (OK,c ) 6= \u2205, the isomorphism restricts to an\n\u223c\nisomorphism of the subspaces Sw\u2032 (OK,c ) \u2192 Sw+w\u2032 (OK,c ). So, we are reduced to check\nthe assertion in the case of the null weight 0 = (0, 0), which is clear because S0 (cOK )\nand \u039e0 (cOK ) (respectively S0 (OK,c ) and \u039e0 (OK,c )) are the set of functions on the finite\nabelian group Cc (respectively C\u266fc ) and its Pontryagin dual.\nIf m|n the inclusion In < Im defines a natural restriction map\nSew (m) \u2192 Sew (n).\n\n(36)\n\nLemma 4.3. The restriction maps (36) are injective.\nProof. We can assume that n = mp with p prime and (p, m) = 1. Let f \u0303 \u2208 Sew (m) and\n\u00d7\nsuppose that f \u0303(I) = 0 for all ideals I \u2208 In . Let \u03bb \u2208 Km\nsuch that \u03bbOp = pOp . Then\n\u22121\n\u22121\n\u2212w  \u0303\n \u0303\n \u0303\np[\u03bb ] \u2208 In and 0 = f (p[\u03bb ]) = \u03bb f (p), i.e. f (p) = 0 proving that f \u0303 = 0 identically.\nFor f \u2208 Sw (n) and g \u2208 Sw\u2032 (n) let\n\uf8f1\nP\nP\n\u2032\n\u22121\n \u0303\n\uf8f2 h\u22121\nn\n\u03c3\u2208Cn f (I\u03c3 )g\u0303(I\u03c3 ) if w = \u2212w\n\u03c3\u2208Cn f (s\u03c3 )g(s\u03c3 ) = hn\nhf, gi =\n,\n\uf8f3\n0\nif w\u2032 6= \u2212w\n\n(37)\n\nwhere {s\u03c3 } and {I\u03c3 } are full set of representatives of Cn in KA\u00d7 and inL\nIn respectively.\nThe bilinear form h*, *i extends by linearity to a pairing on S(n) =\nw\u2208Z[IK ] Sw (n),\nL\ne\ne\nor on the corresponding space S(n) =\nSw (n), compatible with the restriction\nw\u2208Z[IK ]\n\n28\n\n\fPower series expansions of modular forms\n\nmaps (36). Note that for Hecke characters \u03be \u2208 \u039ew (n) and \u03be \u2032 \u2208 \u039e\u2212w (n) one has the\northogonality relation\n\u001a\n1 if \u03be \u2032 = \u03be \u22121\n\u2032\nh\u03be, \u03be i =\n.\n0 otherwise\nRemark 4.4. It follows at once from the definition (37) that the pairing h*, *i takes\nvalues in E on E-valued forms.\nLet p be a prime number and let F be a p-adic local field with ring of integers OF .\nFollowing [17, 44], the space of p-adic K \u00d7 -modular forms of level n with coefficients in F\nis the space S(n; F ) = C 0 (Cn , F ) of F -valued continuous functions on Cn =lim r\u22650 Cnpr .\n\nIt is a p-adic Banach space under the sup norm ||\u03c6|| = supx\u2208Cn |\u03c6(x)|\nS(n; OF ) its unit ball. Assume that E is a subfield of F (e.g. F is\nof E at a prime dividing p) and write Sew (n; F ) = Sew (n; E) \u2297 F and\nSew (OK,c ; E) \u2297 F .\n\n\u2190\n\nand we denote\nthe completion\nSew (OK,c ; F ) =\n\nProposition 4.5 ([44]). For every ideal m|n and for every ideal q with support included\nin the set of primes dividing p there is a natural embedding\nM\ne\nSew (mq; F ) \u0592\u2192 S(n; F ).\nS(mq;\nF) =\nw\u2208Z[IK ]\n\nProof.\nWe may use Lemma 4.3 to assume that mq = npa for some a \u2265 1. Since\nT\nr\u22650 Pnpr = {1} the group Inp embeds as a dense subset in Cn . The restriction of\n \u0303\nf \u2208 Sew (npa ; F ) to a coset I * Pnpa is the function I(\u03bb) 7\u2192 f \u0303(I)\u03bbw . Since w \u2208 Z[IK ] the\ncharacter \u03bbw is continuous for the p-adic topology on K \u00d7 and so extends to a character\n\u03c7w of (K \u2297 Qp )\u00d7 . Therefore f \u0303 extends locally to cosets of 1 + pa (RK \u2297 Zp ) and globally\nto the whole of Cn . The injectivity of the direct sum space S(npa ; F ) follows from the\nlinear independence of characters.\nWe shall denote fb the p-adic modular form associated to the K \u00d7 -modular form f \u0303.\nIf f \u0303 = \u03be \u0303 is an Hecke character, the p-adic form \u03beb is again a character which is sometimes\ncalled the p-adic avatar of \u03be \u0303 (or of \u03be). The density of Inp in Cn implies also that the image\nof Sew (npa ; F ) in S(n; F ) is characterized by the functional relations f \u0303(\u03bbs) = \u03bbw f \u0303(s) for\nall \u03bb \u2261 1 mod npa . Thus, the association f \u0303 7\u2192 fb identifies Sew (npa ; F ) with the closed\nlinear subspace\n\u001b\n\u001a\n\u03c6 \u2208 S(n; F ) such that \u03c6(sx) = \u03c6(s)\u03c7w (x)\n(38)\nSw,a (n; F ) =\nfor all x \u2208 1 + pa (OK \u2297 Zp )\n\nL\n(when a = 0 the domain for x is (OK \u2297 Zp )\u00d7 ). Let S(npa ; F ) = c w Sw,a (n; F ) be the\ne a ; F ) in S(n; F ). Since Sw,a (n; F ) is closed the projection onto the w-th\nclosure of S(np\nsummand extends to a projection \u03c0w,a : S(npa ; F ) \u2192 Sw,a (n; F ). Define a pairing\n[*, *] : S(npa ; F ) \u00d7 S(npa ; F ) \u2212\u2192 F\n\nas the composition\n\u03c00,a\n\nm\n\n\u03bcH\n\nS(npa ; F ) \u00d7 S(npa ; F ) \u2212\u2192 S(npa ; F ) \u2212\u2192 S0,a (n; F ) \u2212\u2192 F\nwhere m is multiplication and \u03bcH is the Haar distribution which is bounded on the space\nS0,a (n; F ).\n29\n\n\fA. Mori\n\nProposition 4.6. The pairing h*, *i extends to a continuous pairing on S(mq; F ) which\ncoincides with [*, *].\nProof. The pairing [*, *] is continuous\nD\nE as composition of continuous mappings. Thus it is\nenough to check the identity f \u0303, g\u0303 = [fb, gb] for f \u0303 \u2208 Sew (npa ; F ) and g\u0303 \u2208 Sew\u2032 (npa ; F ). It\n\nfollows from the definition (37) and the density of Inp in Cn , since on Inp the restrictions\nof f \u0303 and fb and of g\u0303 and gb coincide.\n\nRecall that a p-adic distribution on Zp with values in the p-adic Banach space W\nover F is a linear operator C 0 (Zp , F ) \u2192 W . Given two p-adic distributions on Zp with\nvalues in S(npa ; F ) we construct a new distribution \u03bc[\u03bc1 ,\u03bc2 ] with values in F as the\ncomposition\n\u03c00,a\n\u03bc1 \u2217\u03bc2\n\u03bcH\nC 0 (Zp , F ) \u2212\u2192 S(npa ; F ) \u2212\u2192 S0,a (n; F ) \u2212\u2192 F,\n\nwhere \u03bc1 \u2217 \u03bc2 is the convolution product of \u03bc1 and \u03bc2 . If \u03bc1 and \u03bc2 are measures\n(bounded distributions) \u03bc[\u03bcR1 ,\u03bc2 ] is not a measure in general since the map \u03c00,a is not\nbounded. Denote mk (\u03bc) = Zp xk d\u03bc(x), k \u2265 0 the k-th moment of the distribution \u03bc.\nLemma 4.7. Let M \u2208 N \u222a {\u221e} and suppose that there exist pairwise distinct weights\n{wk } for 0 \u2264 k < M such that mk (\u03bc1 ) \u2208 Sewk (npa ; F ) and mk (\u03bc2 ) \u2208 Se\u2212wk (npa ; F ) for\nall 0 \u2264 k < M . Then\n\u001a\n0 \u0001\nif 0 \u2264 k < M is odd,\nmk (\u03bc[\u03bc1 ,\u03bc2 ] ) =\n2l\nl [ml (\u03bc1 ), ml (\u03bc2 )] if 0 \u2264 k = 2l < M is even.\n\nIf M = \u221e the latter formulae characterize the distribution \u03bc completely.\n\u0010RR\n\u0011\nk\n(x\n+\ny)\nd\u03bc\n(x)d\u03bc\n(y)\n=\nProof. By direct computation mk (\u03bc[\u03bc1 ,\u03bc2 ] ) = \u03bcH \u25e6 \u03c00,a\n1\n2\n2\nZp\nPk \u0010 k \u0011\nPk \u0010 k \u0011\ni=0 i \u03bcH \u25e6 \u03c00,a (mi (\u03bc1 )mk\u2212i (\u03bc2 )) =\ni=0 i [mi (\u03bc1 ), mk\u2212i (\u03bc2 )] . The formula\nfollows at once from the orthogonality relations in (37) since wi = w k\u2212i only if k = 2l\nis even and i = l. The final assertion is also clear.\n\nLet \u03bc be a p-adic distribution on Zp with values in a p-adic space S of continuous\nF -valued functions on a profinite space T . For every t \u2208 T , evaluation at t defines an\nF -valued distribution \u03bc(t) on Zp , \u03bc(t)(\u03c6) = \u03bc(\u03c6)(t). Conversely, a family {\u03bct }t\u2208T of F valued distributions such that the function \u03bc(\u03c6)(t) = \u03bct (\u03c6) is in S for all \u03c6 \u2208 C 0 (Zp , F )\ndefines a p-adic distribution \u03bc on Zp with values in S and \u03bc(t) = \u03bct for all t \u2208 T , which\nis obviously unique for this property.\nLemma 4.8. Let T be a profinite space, S a p-adic space of continuous F -valued functions and \u03bc a p-adic distribution on Zp with values in S. Then \u03bc is a p-adic measure if\nand only if \u03bc(t) is a p-adic measure for all t \u2208 T .\nProof. If \u03bc is bounded, the distributions \u03bc(t) are obviously bounded.\nSuppose that \u03bc(t) is bounded for all t \u2208 T . Let {\u03c6k } k = 0, 1, 2, ... be functions in\nC 0 (Zp , F ) with ||\u03c6k || = 1 and let \u03c6k = \u03bc(\u03c6k ). If ||\u03c6k (t)|| = prk choose tk \u2208 T such that\n|\u03c6k (tk )|p = prk . If the set of values {prk } is not bounded we may assume without loss\nof generality that r1 < r2 < r3 < * * * and since each \u03bc(tk ) is bounded also that {tk } is\nan infinite set. By compactness of T , there exists t\u0304 \u2208 T , t\u0304 6= tk for all k, such that every\nneighborhood of t\u0304 meets {tk }. This contradicts the boundedness of \u03bc(t\u0304) since |\u03c6(t)|p is\nlocally constant for all \u03c6 \u2208 S.\n30\n\n\fPower series expansions of modular forms\n\nIn particular, the sequence \u03bc\n\n\u0001\u0001\n\nx\nk\n\nis bounded and \u03bc is a measure.\n\ne w (npa ) and \u03be \u0303 \u2208 \u039e\ne w\u2032 (npa ) be Hecke characters taking\nAs an application, let \u03c7\u0303 \u2208 \u039e\n\u00d7\n\u00d7\n\u2032\nvalues respectively in OF and OF \u2032 where Qp \u2286 F is a totally ramified subextension of\nF . For every x \u2208 Cn the series\n\u221e\nX\n1 bk\nb\n\u03c7\nb\u03be (x)Z k = \u03c7\nb(x)(1 + T )\u03be(x) ,\nk!\n\n1\n1\nT = eZ \u2212 1 = Z + Z 2 + Z 3 + * * * ,\n2\n3!\n\nk=0\n\nhas integral coefficients in the variable T (the corresponding measure is \u03c7\nb(x)\u2202\u03be(x)\nb , where\n\u2202t denotes the Dirac measure concentrated at t). Thus, there exists a unique measure\n\u03bc\u03c7,\u03be on Zp with values in S(n; OF ) such that mk (\u03bc\u03c7,\u03be ) = \u03c7\nb\u03bebk . When w \u2032 6= 0 the\nmoments' weights are pairwise distinct.\n\n4.2\n\nExpansions as distributions\n\nLet \uf6be : K \u0592\u2192 D a normalized embedding of conductor c = c\u03c4,N with corresponding\n\u03c4 \u2208 CM\u2206,K and x \u2208 CM(\u2206, N ; OK,c ). Let y = Im(\u03c4 ). The embedding \uf6be defines by\nscalar extension a diagram\nKA\u00d7 /K \u00d7 R\u00d7\n\u2193\nb\u00d7\nK \u00d7 /K \u00d7 R\u00d7 O\nA\n\nC\u266fc\n\n\u2243\n\nK,c\n\n\u2193\n\u00d7\n\u00d7 \u00d7 b\u00d7\nKA /K C OK,c\n\n\u2212\u2192\n\u2212\u2192\n\nD\u00d7 \\DA\u00d7 /Z\u221e\n\u2193\nb\u00d7\nD\u00d7 \\D\u00d7 /Z\u221e R\nA\n\n(39)\n\nN\n\n\u2193\n\u00d7\n\u00d7\nb\u00d7\n\u2212\u2192 D \\DA /\uf6be(C\u00d7 )R\nN\n\n\u2243\n\n\u03930 (\u2206, N )\\H\n\n\u00d7\nwhere the vertical maps are the natural quotient maps and Z\u221e is the center of D\u221e\n.\nUnder the decomposition\n\u00d7\nb\u00d7\nDA\u00d7 = DQ\nGL+\n(40)\n2 (R)RN\n\nthe idele d = do g\u221e u corresponds to the point represented by g\u221e \u03c4 . Classfield theory\nprovides an identification C\u266fc \u2243 Gal(Hc /K) where Hc is the ray classfield of conductor\nc. It is also well-known that the points in the image of the bottom map in (39) are\ndefined over Hc , so that Gal(Hc /K) acts naturally on them, and that the two actions\nare compatible (Shimura reciprocity law, [43]). In particular, if s\u03c3 \u2208 KA\u00d7 represents \u03c3 \u2208\n(\u03c3\u22121 )\n\n\u03c3\n. Write Ax (C) = A\u03c4 = C\u01eb /\u039b\u03c4 with\nGal(Hc /K),\nAx\u03c3 = Ax\n\u0001 then s\u03c3 maps to x and\n\u03c4\n2\n\u039b\u03c4 = \u039b 1 where \u01eb = 1 and \u039b = Z \u2282 C if D is split and \u01eb = 2 and \u039b = \u03a6\u221e (R1 ) \u2282 C2\nif D is non-split. The theory\nof complex multiplication implies that Ax\u03c3 (C) \u2243 C\u01eb /s\u03c3 \u039b\u03c4\n\u0001\n\u22121\n\u22121 \u03c4\nwhere s\u03c3 \u039b\u03c4 = \u039bd\u03c3 1 if s\u03c3 = d\u03c3 g\u03c3 u\u03c3 under (40). For a fixed prime p one can choose\nrepresentatives {s\u03c3 } \u2282 KA\u00d7 normalized as follows:\n\u001a\ns\u03c3,\u221e = 1,\ns\u03c3,v is v-integral at all finite places v and a v-unit at the places v|pc.\n\nFor each such representative s there is a diagram of complex tori\nj(g,\u03c4 )\n\n\u03c0\n\nAg\u03c4 = C\u01eb /\u039bg\u03c4 \u2212\u2212\u2212\u2212\u2192 C\u01eb /s\u039b\u03c4 \u2212\u2212\u2212s\u2212\u2192 C\u01eb /\u039b\u03c4\nAx\u03c3 (C)\n31\n\nAx (C)\n\n\fA. Mori\n\nwhere s = dgu under (40) and \u03c0s is the natural quotient map arising from the inclusion\ns\u039b\u03c4 \u2282 \u039b\u03c4 . The element g \u2208 GL+\n2 (R) is defined by g\u03c4 \u2208 H only up to an element in\n\u00d7\nOK,c\n. Choose p and a place v over p in a number field L large enough so that for each s\nthe triple (g\u03c4, v, e) is a p-ordinary test triple and that the isogenies \u03c0s are defined over\nL.\nLemma 4.9. With the above notations, it is possible to choose for every \u03c3 \u2208 Gal(Hc /K)\nan invariant 1-form on Ax\u03c3 that generates L(x\u03c3 ) \u2297 O(v) and for which\n1. \u03a9\u221e (g\u03c4 ) \u223cO\u00d7 j(g, \u03c4 )\u03a9\u221e (\u03c4 );\n(v)\n\n2. \u03a9p (x\u03c3 ) \u223cO\u00d7 \u03a9p (x).\n(v)\n\nProof. Take \u03c9o \u2208 H 0 (Ax (C), L(x) \u2297 C). The quotient map \u03c0s is the identity on\n(co)tangent spaces and commutes with the action of the endomorphisms. Thus \u03c9s =\n\u03c0s\u2217 (\u03c9o ) \u2208 H 0 (Ax\u03c3 (C), L(x\u03c3 )) and p(\u03c9s , g\u03c4 ) = j(g, \u03c4 )p(\u03c9o , \u03c4 ). Furthermore, p doesn't\ndivide the degree of \u03c0s and so \u03c0s\u2217 is an isomorphism between the natural p-adic structures\non the spaces of invariant forms. This proves part 1.\nFor part 2 observe that the reduction mod p of the dual map \u03c0st gives an isomorphism\nof the rank 1 tate module quotient T of \u00a73.2. Thus \u03c0s\u2217 (\u03c9u (P )) is a universal form on\nex\u03c3 by formula (31) and the equality follows.\nthe deformations of A\nb\u00d7 are two normalized\nIf s and s\u2032 = s\u03bbzu with \u03bb \u2208 K \u00d7 , z \u2208 C\u00d7 and u \u2208 O\nK,c\nrepresentants of the same \u03c3 \u2208 C\u266fc a comparison of the relations in lemma 4.9 for the\ndecompositions s = dgr and s\u2032 = (\u03bbd)(gz)(ru) shows that \u03c9s\u2032 \u223cO\u00d7 z\u03c9s . Therefore the\nK,c\n\n\u00d7\nconstruction of \u03c9s can be extended modulo OK,c\n-equivalence to all s \u2208 KA\u00d7 by setting\n\n\u03c9s\u03bbzu \u223cO\u00d7 z\u03c9s\nK,c\n\nb\u00d7 and s normalized.\nfor all \u03bb \u2208 K \u00d7 , z \u2208 C\u00d7 , u \u2208 O\nK,c\n\n(41)\n\nLet f \u2208 M2\u03ba,0 (\u2206, N ) and normalize the invariant form as in proposition 2.11. For all\n\u00d7\nintegers r \u2265 0 such that (OK,c\n)2(\u03ba+r) = 1 define a function c(r) (f, x) : KA\u00d7 \u2192 C as\n(r)\n\nc(r) (f, x)(s) =\n\n\u03b42\u03ba f (g\u03c4 )\np(\u03c9s , g\u03c4 )2(\u03ba+r)\n\nwhere s = dgu as above.\n\u00d7\nProposition 4.10. Suppose that f is defined over O(v) and assume that (OK,c\n)2(\u03ba+r) =\n1. Then c(r) (f, x) \u2208 S(2(\u03ba+r),0) (OK,c ) \u2229 S(cRK , Ov ).\n\nProof. The modular relation for c(r) (f, x) follows at once from (41) and the definition\nsince gz\u03c4 = g\u03c4 . For an idele s satisfying the conditions (35) for n = (pc) the invariant\nform \u03c9s satisfies proposition 2.11 and then theorem 3.6 together with lemma 4.9 shows\nthat as a p-adic K \u00d7 -modular form c(r) (f, x) has coefficients in Lv and in fact belongs\nto the unit ball.\n\u00d7\nAssume that OK,c\n= {\u00b11}. Let \u03bcf,x be the p-adic distribution on Zp with values in\nS(cOK ; Lv ) such that mr (\u03bcf,x ) = b\nc(r) (f, x) and let \u03bc\u03c7,\u03be be the p-adic measure associated to a choice of Gr\u00f6ssencharakters \u03c7 \u2208 \u039e(\u22122\u03ba,0) (OK,c ), \u03be \u2208 \u039e(\u22122,0) (OK,c ) as in the\ndiscussion after lemma 4.8.\n\n32\n\n\fPower series expansions of modular forms\n\nTheorem 4.11. There exist a p-adic field F and a p-adic measure \u03bc(f, x; \u03c7, \u03be) on Zp\nwith values in OF such that\n\u001a\n\u0001\n0\nif 0 \u2264 r is odd,\nmr \u03bc[\u03bcf,x ,\u03bc\u03c7,\u03be ] =\n\u22122(\u03ba+l) 2l\u0001\n(h\u266fc )\u22121 \u03a9p\nm\n(\u03bc(f,\nx;\n\u03c7,\n\u03be))\nif\n0 \u2264 r = 2l is even,\nl\nl\n\nProof. Let F be large enough to contain Lv , the field of values of \u03c7 and \u03be and the padic period \u03a9p . The expression follows from Lemma 4.7 and the fact that for a suitable\nchoice of representants for C\u266fc we have,\ncombining\nwith theorem\nh\ni the definition (37)\nP\n\u22122(\u03ba+l)\nl\n\u266f\n\u22121\n3.6, proposition 4.6 and lemma 4.9, \u03c7\nb\u03beb , b\nc(l) (f, x) = (h ) \u03a9p\n\u03c7\nb\u03bebl (s)bl (x\u03c3 ).\nc\n\n\u03c3\n\nFinally, each term \u03bebl (s)blP\n(x\u03c3 ) is the l-th moment\nof a suitable p-adic measure on Zp\nP\u221e\n\u03c3\nn\nn\nbecause the identification \u221e\nthrough the\nn=0 (bn (x )/n!)T = Pn=0 an U with an \u2208 OF P\n\u221e\n\u221e\nT\nsubstituition U = e \u2212 1 yields an identification n=0 (bn (x\u03c3 )/n!)z n T n = n=0 an V n\nwhere V = (U + 1)z \u2212 1 and this substitution preserves OF -integrality when z is a unit\nin a field with residue field Fp . Conclude using the linearity of measures.\n\n4.3\n\nSpecial L-values\n\n\u00d7\n\u221e\nb \u00d7 -invariant C \u221e lift of\nFor f \u2208 M2\u03ba,0\n(\u2206, N ), let \u03c6f \u2208 L2 (DQ\n\\DA\u00d7 ) be the usual R\nN\nf to DA\u00d7 . Namely, \u03c6f (d) = f (g\u221e * i)j(g\u221e , i)\u22122\u03ba det(g\u221e )\u03ba if d = dQ g\u221e u under (40).\n\u00d7\nThe Lie algebra g = gl2 \u2243 Lie(D\u221e\n) acts on the C-valued C \u221e functions on DA\u00d7 by\nd\n\u03c6(detA ) t=0 . By linearity and composition the action extends to the\n(A * \u03c6)(d) = dt\ncomplexified universal enveloping algebra A(g)C . Let\n\u0012\n\u0012\n\u0013\n\u0013\n\u0012\n\u0013\n1\n1 \u00b1i\n1 0\n0 \u2212i\n\u00b1\nI=\n,\nH=\n,\nX =\n\u00b1i \u22121\n0 1\ni 0\n2\n\nbe the usual eigenbasis of gC for the adjoint action of the maximal compact subgroup\n\u001a\n\u0012\n\u0013\n\u001b\ncos \u03b8 \u2212 sin \u03b8\nSO(2) = r(\u03b8) =\nsuch that \u03b8 \u2208 R .\nsin \u03b8 cos \u03b8\n\u221e\nSince Ad(r(\u03b8))X \u00b1 = e\u22132i\u03b8 X \u00b1 , we have X \u00b1 * \u03c6f \u2208 M2\u03ba\u00b12,0\n(\u2206, N ). A standard computation (e.g. [3, \u00a7\u00a72.1\u20132]) links the Lie action to the Maass operators of \u00a72.3, namely\n\nX + * \u03c6f = \u22124\u03c0\u03c6\u03b42\u03ba f .\nFor r \u2265 0 let\n\n\u0013r\n\u0012\n1 +\nr f.\n* \u03c6f = \u03c6\u03b42\u03ba\n\u03c6r = \u2212 X\n4\u03c0\n\n(42)\n\nDefinition 4.12. Let f \u2208 M2\u03ba,0 (\u2206, N ), \u03be \u2208 \u039ew (cOK ) for a weight w such that |w| = 0\nand \u03c4 = t + iy \u2208 CM\u2206,K with c\u03c4,N = c and associated normalized embedding \uf6be. For\neach r \u2265 0, let\nZ\nJr (f, \u03be, \u03c4 ) =\n\nwhere d\u221e =\n\n\u0010\n\ny 1/2 ty 1/2\n0 y \u22121/2\n\n\u0011\n\nKA\u00d7 /K \u00d7 R\u00d7\n\n\u03c6r (\uf6be(t)d\u221e )\u03be(t) dt\n\nand dt is the Haar measure on KA\u00d7 whose archimedean com-\n\nponent is normalized so that vol(C\u00d7 /R\u00d7 ) = \u03c0 and such that the local grups of units\nb\u00d7 ) = [(OK /cOK )\u00d7 : (Z/cZ)\u00d7 ]\u22121 ).\nhave volume 1 (hence mc = vol(O\nK,c\n33\n\n\fA. Mori\n\nWe show that Jr (f, \u03be, \u03c4 ) can be expressed in terms of the pairing introduced in \u00a74.1.\n\n\u00d7\nWrite wK,c = OK,c\n.\n\n\u00d7\nTheorem 4.13. Let f \u2208 M2\u03ba,0 (\u2206, N ) and \u03be \u2208 \u039e(w,\u2212w) (OK,c ). Assume that (OK,c\n)2w =\n1. Then\nE\nD\n\u03c0mc \u266f \u2212w\n\u2212w\nJr (f, \u03be, \u03c4 ) =\n.\nhc y \u03a9\u221e (\u03c4 )\u22122w c(r) (f, x), \u03be NK/Q\nwK,c\n\nb\u00d7 -invariant, we have Jr (f, \u03be, \u03c4 ) =\nProof. Since the integrand function is right O\nK,c\nR\nmc K \u00d7 /K \u00d7 R\u00d7 Ob\u00d7 \u03c6r (\uf6be(t)d\u221e )\u03be(t) dt. For a chosen set of representatives {s\u03c3 } of C\u266fc\nA\nK,c\nthere is a decomposition\n[\n\u00d7\nb\u00d7 =\nC\u00d7 s\u03c3 /R\u00d7 OK,c\n(disjoint union).\nKA\u00d7 /K \u00d7 R\u00d7 O\nK,c\n\u03c3\u2208C0c\n\nTherefore, Jr (f, \u03be, \u03c4 ) = mc\n\nP\n\n\u03c3\u2208C\u266fc\n\n\u03be(s\u03c3 )\n\nR\n\n\u00d7\nC\u00d7 /R\u00d7 OK,c\n\n\u03c6r (\uf6be(s\u03c3 z)d\u221e )\u03be\u221e (z) d\u00d7 z.\n\nSince the standard normalized embedding ofR C in M2 (R) is \u03c1ei\u03b8 7\u2192 \u03c1r(\u03b8), we can\n\u00d7\n\u03c6r (\uf6be(s\u03c3 z)d\u221e )\u03be\u221e (z) d\u00d7 z =\nwrite D\u221e\n\u220b \uf6be(z) = \u03c1d\u221e r(\u03b8)d\u22121\n\u00d7\n\u221e . Therefore C\u00d7 /R\u00d7 OK,c\nR\nR\n\u03c0\n\u03c0\n\u22121\n\u22121\nwK,c\n\u03c6r (\uf6be(s\u03c3 d\u221e )r(\u03b8))\u03be\u221e (ei\u03b8 ) d\u03b8 = wK,c\n\u03c6r (\uf6be(s\u03c3 d\u221e )) 0 e\u22122i(\u03ba+r)\u03b8 e\u22122iw\u03b8 d\u03b8 and\n0\nJr (f, \u03be, \u03c4 ) =\n\n\u001a\n\n\u22121\n\u03c0mc wK,c\n0\n\nP\n\n\u03c3\u2208C\u266fc\n\n\u03be(s\u03c3 )\u03c6r (\uf6be(s\u03c3 d\u221e ))\n\nif w = \u2212\u03ba \u2212 r\n.\notherwise\n\n(43)\n\nNote that this proves the claimed formula when w 6= \u2212\u03ba \u2212 r since the inner product in\nits right hand side vanishes in this case. Thus, we may now assume that w = \u2212\u03ba \u2212 r.\nPut I\u03c3 = \u03be(s\u03c3 )\u03c6r (s\u03c3 d\u221e ) and write s = s\u03c3 = ds gs us under (40) and \u03c4s = gs \u03c4 . Note that\n\u00d7\nNK/Q (s) = det(gs ). Under the hypothesis (OK,c\n)2(\u03ba+r) = 1 we have\nI\u03c3\n\n=\n\n(r)\n\n\u03be(s)\u03b42\u03ba f (gs d\u221e * i)j(gs d\u221e , i)\u22122(\u03ba+r) det(gs )\u03ba+r\n(r)\n\n\u03ba+r\n\n=\n\ny \u03ba+r \u03be(s)\u03b42\u03ba f (\u03c4s )j(gs , \u03c4 )\u22122(\u03ba+r) NK/Q (s)\n\n=\n\ny \u03ba+r \u03be(s)c(r) (f, x)(s)p(\u03c9s , \u03c4s )2(\u03ba+r) j(gs , \u03c4 )\u22122(\u03ba+r) NK/Q (s)\n\n=\n\ny \u03ba+r \u03be(s)c(r) (f, x)(s)p(\u03c9so , \u03c4so )2(\u03ba+r) j(gso , \u03c4 )\u22122(\u03ba+r) NK/Q (s)\n\n=\n\ny \u03ba+r \u03a9\u221e (\u03c4 )2(\u03ba+r) \u03be(s)c(r) (f, x)(s) NK/Q (s)\n\n\u03ba+r\n\u03ba+r\n\n\u03ba+r\n\nwhere so is a normalized representant. It is now clear that the formula follows.\nDefinition 4.14. Let M be a proper divisor of N , x \u2208 CM(\u2206, N ; OK,c ) and x\u2032 \u2208\nCM(\u2206, M ; OK,c\u2032 ) the image of x under the natural quotient map. A character \u03be \u2208\nb\u00d7 \u2032 .\n\u039ew (OK,c ) is called (x, M )-primitive if it is not trivial on O\nK,c\n\nFor a divisor d of N/M there is an embedding \u03b9\u2206,d : M2\u03ba,0 (\u2206, M ) \u2212\u2192 M2\u03ba,0 (\u2206, N ).\nWhen \u2206 = 1 the embedding is simply f (z) 7\u2192 f (dz). When \u2206 > 1 the explicit description of \u03b9\u2206,d is less immediate, e.g. [34, \u00a73]. We denote M2\u03ba,0 (\u2206, N )M\u2212old the span of\nthe images of the embeddings \u03b9\u2206,d for all d. After theorem 4.13 the following result can\nbe read as an orthogonality statement between primitive characters and K \u00d7 -modular\nforms arising from oldforms.\n34\n\n\fPower series expansions of modular forms\n\nProposition 4.15. Let \u03c4 \u2208 CM\u2206,K and x \u2208 CM(\u2206, N ; OK,c ) be the point represented\nby \u03c4 . Let f \u2208 M2\u03ba,0 (\u2206, N )M\u2212old and suppose that \u03be \u2208 \u039e(\u2212\u03ba\u2212r,\u03ba+r) (OK,c ) is (x, M )primitive. Then Jr (f, \u03be, \u03c4 ) = 0.\nProof. Consider again the first expression in (43). Let x\u2032 \u2208 CM(\u2206, M ; OK,c\u2032 ) the point\nimage of x and choose a system of representants {s\u03c3\u2032 } of C\u266fc\u2032 and a system of represenb \u00d7 \u2032 /O\nb \u00d7 . Then the set of products {s\u03c3 ri } is a system of representatives\ntants {ri } of O\nK,c\nK,c\nof C\u266fc and since d\u221e commutes with each ri and f is M -old we obtain the expression\n\uf8eb\n\uf8f6\uf8eb\n\uf8f6\n\u03c0m \uf8ec X\n\uf8f7\uf8ec X\n\uf8f7\n\u03be(ri )\uf8f8 \uf8ed\nJr (f, \u03be, \u03c4 ) =\n\u03be(s\u03c3\u2032 )\u03c6r (s\u03c3\u2032 d\u221e )\uf8f8\n\uf8ed\nwK,c\n\u266f\n\u00d7\n\u00d7\nb\nb\nO\n/O\nK,c\nK,c\u2032\n\n\u03c3\u2032 \u2208Cc\u2032\n\nb \u00d7 \u2032 /O\nb\u00d7 .\nwhich vanishes because \u03be is non trivial on O\nK,c\nK,c\n\nWe shall assume from now on that the modular form f is a holomorphic newform\nwith associated automorphic representation \u03c0 D = \u03c0f . Let \u03c0 be the automorphic representation of GL2 (A) corresponding to \u03c0 D under the Jacquet-Langlands correspondence.\nOther N\nthan the Weil representation r\u03c8 of SL2 (A), the adelic Schwartz-Bruhat space\nSA (D) = p\u2264\u221e Sp supports the unitary representation of GO(D)(A) given by\n\u22121\n\nL(h)\u03c6(x) = ||\u03bd0 (h)||A \u03c6(h\u22121 x),\n\nx \u2208 DA .\n\nWe assume that the archimedean space S\u221e consists only of the Schwartz functions on\n1\n1\nD\u221e which are K\u221e\n\u00d7 K\u221e\n-finite under the action of D\u00d7 \u00d7 D\u00d7 via the group GO(D)\n1\n\u00d7\n(\u00a71.3). Here K\u221e is the maximal compact subgroup of \uf6be(K \u00d7 \u2297 R) \u2282 D\u221e\n\u2243 GL2 (R). As\nexplained in [14, \u00a75], the two representations mingle into one single representation, still\ndenoted r\u03c8 , of the group R(D) = {(g, h) \u2208 GL2 \u00d7 GO(D) such that det(g) = \u03bd0 (h)}\n\u0010\n\u0011\u22121\ngiven by r\u03c8 (g, h)\u03c6 = r\u03c8 (g1 )L(h)\u03c6 where g1 = g 1 \u03bd0 (h)\n. Note that\n\u223c\n\n\u2022 the assignment (g, h) 7\u2192 (g1 , h) sets up an isomorphism R(D) \u2192 SL2 \u22c9 GO(D);\n\n\u2022 the group R(D) is naturally a subgroup of the symplectic group Sp(W ), where\nW = P \u2297 D with P the standard hyperbolic plane, via (g, h)x \u2297 y = gx \u2297 h\u22121 y.\n\nThe groups (SL2 , O(D)) form a dual reductive pair in Sp(W ) and the extended Weil\nrepresentation r\u03c8 allows to realize the theta correspondence between the similitude\ngroups. TheP\ntheta kernel associated to a choice of (g, h) \u2208 R(D) and \u03c6 \u2208 SA (D) is\n\u03b8(g, h; \u03c6) = d\u2208D r\u03c8 (g, h)\u03c6(d). The theta lift to GO(D) of a cuspidal automorphic\nform F on GL2 (A) is the automorphic form on GO(D)(A) given by\nZ\n\u03b8(gg \u2032 , h; \u03c6)F (gg \u2032 ) dg \u2032\n(44)\n\u03b8\u03c6 (F )(h) =\nSL2 (Q)\\SL2 (A)\n\nwhere det(g) = \u03bd0 (h) and dg \u2032 is induced by a choice of a Haar measure dg =\nGL2 (A). A straightforward substitution yields\n\u03b8r\u03c8 (g1 ,h1 )\u03c6 (F )(h) = \u03b8\u03c6 (\u03c0(g1\u22121 )F )(hh1 ),\n\n\u2200(g1 , h1 ) \u2208 R(D).\n\nQ\n\ndgp on\n(45)\n\nAn automorphic form \u03a6 on GO(D)(A) pulls back via the map \u033a of (15) to an automore on the product group D\u00d7 \u00d7 D\u00d7 . Let \u0398(\u03c0)\ne\nphic form \u03a6\nbe the space of automorphic\n\u00d7\n\u00d7\nforms on D \u00d7 D which are pull-backs of theta lifts (44) with F \u2208 \u03c0. If \u03c0\u030c D denotes the\ncontragredient representation of \u03c0 D the crucial result is, with a slight abuse of notation,\nthe following, [42].\n35\n\n\fA. Mori\n\ne\nTheorem 4.16 (Shimizu). \u0398(\u03c0)\n= \u03c0 D \u2297 \u03c0\u030c D .\n\nRemarks 4.17.\n\n1. In our case of interest \u03c0 D = \u03c0\u030c D .\n\n1\n1\n2. The Schwartz functions, hence the theta lifts \u03b8e\u03c6 (F ), are K\u221e\n\u00d7K\u221e\n-finite. Thus, in\nD\n1\nShimizu's theorem the representation space \u03c0 consists of K\u221e -finite automorphic\n1\nforms. Note that the functions \u03c0(d\u221e )\u03c6r are K\u221e\n-finite.\n\n3. An explicit version of Shimizu's theorem has been worked out by Watson [47], see\nalso [38, \u00a73.2] and [14, \u00a712]. Namely, if \u03c6 = \u2297p\u2264\u221e \u03c6p is chosen as\n\u03c6\u221e (z1 , z2 ) =\n\n(\u22121)\u03ba 2\u03ba \u22122\u03c0(z1 z\u03041 +z2 z\u03042 )\nz2 e\n,\n\u03c0\n\n\u03c6p =\n\nchRN \u2297Zp\nvol((RN \u2297 Zp )\u00d7 )\n\n(46)\n\nwhere z1 and z2 are the complex coordinates in D\u221e of \u00a71.3, then\n\u03c0(d\u221e )\u03c6f \u2297 \u03c0(d\u221e )\u03c6f = \u03b8e\u03c6 (F )\n\nwhere F \u2208 \u03c0 is the adelic lift of an eigenform normalized so to have an equality\nof Petersson norms h\u03c0(d\u221e )\u03c6f , \u03c0(d\u221e )\u03c6f i = hF, F i.\n\nLet \u03be = (\u03be, \u03be \u2032 ) \u2208 \u039ew (cOK ) \u00d7 \u039ew\u2032 (cOK ) thought of as a character of the torus\n\u00d7 KA\u00d7 . Let H\u0303(t) be any function on KA\u00d7 \u00d7 KA\u00d7 such that H\u0303(t)\u03be(t) is (K \u00d7 R\u00d7 )2 invariant. Following [13, \u00a714] [12, \u00a71.4] we let\nZ\nH\u0303(t)\u03be(t) dt.\nL\u03be (H\u0303) =\n\nKA\u00d7\n\n(K \u00d7 R\u00d7 \\KA\u00d7 )2\n\nIn particular, for \u03be as in definition 4.12,\nL(\u03be,\u03be) (\u03c0(d\u221e )\u03c6r \u2297 \u03c0(d\u221e )\u03c6r ) = Jr (f, \u03be, \u03c4 )2 .\nWhen \u03be = \u03be \u2032 is unitary, |w| = |w \u2032 | = 0, the integral L\u03be (\u03b8e\u03c6 (F )) can also be read,\nvia the map \u03b1 of (15), as the Petersson scalar product of two automorphic forms on\nthe similitude group T = G(O(K) \u00d7 O(K \u22a5 )) associated with the decomposition D =\nR\nK \u2295 K \u22a5 , namely L(\u03be,\u03be) (\u03b8e\u03c6 (F )) = T (Q)T (R)\\T (A) \u03b8e\u03c6 (F )((a, b))\u03be(b) d\u00d7 ad\u00d7 b, where \u03b1(t) =\n(a, b). Thus the seesaw identity [30] associated with the seesaw dual pair\nGL2 \u00d7 GL2\n\u2191\nGL2\n\n\u00d7\n\nGO(D)\n\n\u2191\nG(O(K) \u00d7 O(K \u22a5 ))\n\nidentifies, up to a renormalization of the Haar measures, the value L(\u03be,\u03be) (\u03b8e\u03c6 (F )) with a\nscalar product on GL2 ,\nZ\nt\nL\u03be (\u03b8e\u03c6 (F )) =\nF (g)\u03b8\u03c6\n(1, \u03be)(g, g) dg,\n(47)\nGL2 (Q)A\u00d7 \\GL2 (A)\n\nt\nwhere \u03b8\u03c6\ndenotes the theta lift to GL2 \u00d7 GL2 . If \u03c6 is split and primitive, i.e. admits a\ndecomposition \u03c6 = \u03c61 \u2297\u03c62 under N\nD\u221e = (K \u2295K \u22a5 )\u2297R and each component decomposes\nt\n(1, \u03be) splits as a product\nin a product of local factors, \u03c6i = p\u2264\u221e \u03c6i,p for i = 1, 2, then \u03b8\u03c6\nof two separate lifts. In fact\nt\n \u0303 2)\n\u03b8\u03c6\n(1, \u03be)(g1 , g2 ) = E(0, \u03a6, g1 )\u03b8\u03c62 (\u03be)(g\n\nwhere:\n36\n\n\fPower series expansions of modular forms\n\n\u2022 E(0, \u03a6, g) is the value at s = 0 of the holomorphic Eisenstein series attached to the\nunique flat section ([3, \u00a73.7]) extending the function \u03a6(g) = r\u03c8 (g, k)\u03c61 (0) where\nk \u2208 KA\u00d7 is such that N (k) = det(g) and r\u03c8 denotes here the extended adelic Weil\nrepresentation attached to K as a normed space (Siegel-Weil formula),\n\u2022 \u03b8\u03c62 (\u03be)(g) is a binary form in the automorphic representation \u03c0(\u03be) of GL2 attached\nto \u03be.\nThis expression yields a relation between the right hand side of (47) and the value at the\ncentre of symmetry of a Rankin-Selberg convolution integral. If the Whittaker function\nWF of F decomposes as a product of local Whittaker functions, the Rankin-Selberg\nintegral admits an Euler decomposition [20] and L(\u03be,\u03be) (\u03b8e\u03c6 (F )) is equal to the value at\ns = 12 of the analytic continuation of\n1 Y\nLq (\u03c6q , \u03beq , s),\nhK\nq\u2264\u221e\n\nwhere\nLq (\u03c6q , \u03beq , s) =\n\nZ\n\nKq\n\nZ\n\nQ\u00d7\nq\n\n\u03c8\n\nWF,qq\n\n\u0012\u0012\n\na 0\n0 1\n\n\u0012\u0012\n\u0013 \u0013\n\u0013 \u0013\n\u2212a 0\n\u03c8\nk *\nk W\u03b8\u03c6q ,q\n2\n0 1\n\u0012\u0012\n\u0013 \u0013\na 0\n\u22121\n\u03a6s\u03c61 ,q\nk |a| d\u00d7 a dkq . (48)\n0 1\n\nThe local measures are normalized so that K\u221e = SO2 (R) has volume 2\u03c0 and Kq =\nGL2 (Zq ) has volume 1 for finite q. Also W\u03b8\u03c62 is the Whittaker function and \u03a6s (g) =\n\u0001\ns\u2212 1\n||a|| 2 \u03a6(g) if g = nak under the N AK-decomposition where a b = |a/b|. Since\nthe local term (48) does not vanish and for almost all q is the local Euler factor of some\nautomorphic L-function, one obtains, as in [12, 13], a version of Waldspurger's result\n[46]. Namely,\ns\nL\u03be (\u03b8e\u03c6 (F )) = \u039b(\u03c6, \u03be, s)L(\u03c0K \u2297 \u03be, )L(\u03b7K , 2s)\u22121\n2\n\ns=1/2\n\n,\n\nwhere \u039b(\u03c6, \u03be, s) is a finite product of local integrals, \u03c0K is the base change to K of the\nautomorphic representation \u03c0 and L(\u03b7K , 2s) is the Dirichlet L-function attached to \u03b7K ,\nthe quadratic character\nassociated to K\nN\nWhen \u03c6f = p<\u221e \u03c6p and F are chosen as in Remark 4.17.3 the local non-archimedean terms in the Rankin-Selberg integral have been explicitely computed by Prasanna [38,\n\u00a73] under the simplifying assumptions that N is squarefree, c = 1 and \u03be is unramified.\nThe effect of these assumptions is that\n1. the local component of \u03be can be written either as \u03beq = (\u03beqsp , (\u03beqsp )\u22121 ) for some\nunramified character \u03beqsp of Q\u00d7\nq at a prime q split in K under the isomorphism\nin\n\u00d7\nin\n(K \u2297 Qq )\u00d7 \u2243 Q\u00d7\nq \u00d7 Qq , or as \u03beq = \u03beq \u25e6 NKq /Qq for an unramified character \u03beq of\n\u00d7\nrm\nQq at a prime q inert in K, or as \u03beq = \u03beq \u25e6 NKq /Qq at a ramified prime q where\n\u03beqrm is the unramified character of Q\u00d7\nq obtained by a trivial extension;\n2. at a prime q|N \u2206 the local component \u03c0q is equivalent to the special representation\n1\n+it\n\u2212 1 +it\n\u03c3(|*| 2 q , |*| 2 q ) with q 2itq = 1.\n37\n\n\fA. Mori\n\nNote that the former condition remains true for a split prime q that does not divide c\nand \u03be \u2208 \u039ew (RK,c ) with |w| = 0. Thus we can apply Prasanna's computations to this\nmore general case to write down a formula in which only the local factors at primes in\n\u03a3 = {q|cN \u2032 } are left implicit, where N = Nsf (N \u2032 )2 and Nsf is square-free. Namely,\n\uf8eb\n\uf8f6\nY\nV\ns\nN\nL\u03be (\u03b8e\u03c6\u221e \u2297\u03c6f (F )) =\n\u03bb\u221e (\u03c6\u221e , \u03be\u221e , s) \uf8ed\n\u03bdq (\u03beq )\uf8f8 L(\u03c0K \u2297 \u03be, )L(\u03b7K , 2s)\u22121\nhK\n2\nq\u2264\u221e\n\ns=1/2\n\n(49)\n1\nQ\n2\n\u03be\u221e (zu )\u22121 L\u221e (\u03c6\u221e , \u03be\u221e , 2s ) (zu\nwhere VN = q vol((RN \u2297 Zq )\u00d7 ), \u03bb\u221e (\u03c6\u221e , \u03be\u221e , s) = |Nu|\u221e\ndenotes the complex coordinate of u in the chosen identification (Ku) \u2297 R \u2243 C) and\n\uf8f1\n\uf8f4\nif q splits, q \u2208\n/ \u03a3, (q, Nsf ) = 1 ,\n\u03bdq (\u03beq ) = \u03beqsp (q)n1 \u2212n2\n\uf8f4\n\uf8f4\n1\n\uf8f4\n1\n+t\n+s\nsp\nn\n\u2212n\n\u2212\n\uf8f4\nq\n1\n2\n\uf8f4\nif q|Nsf ,\n\u03beq (q)\n\uf8f2\u03bdq (\u03beq ) = \u2212 q+1 q 2\nin\n\u22122n\n\u03bdq (\u03beq ) = \u03beq (q)\nif q is inert, q \u2208\n/ \u03a3,\n\uf8f4\n\uf8f4\nrm\n\u22121\n\uf8f4\n\u03bd\n(\u03be\n)\n=\n\u03be\n(\u2212Nu\n)\nif\nq\nramifies,\n\uf8f4\nq q\nq\n\uf8f4\n\uf8f4\n\uf8f3\u03bd (\u03be ) = \u03be (z )\n\u221e \u221e\n\u221e u\n\nwhere the ideal J of proposition 1.3 in K \u2297 Qq is generated by q \u2212n when q is inert and\ndecomposes as q \u2212nq,1 Zq \u00d7 q \u2212nq,2 Zq under K \u2297 Qq \u2243 Qq \u00d7 Qq when q is split.\nRemark 4.18. It is clear that \u03bdq (\u03beq ) = 1 for almost all q. The local terms \u03bbq (\u03bdq ) do\ndepend on the choice of u in (11) (replacing u with xu the local Whittaker function\n1\n\u03c8\nW\u03b8\u03c6q ,q gets modified by the factor |Nx|q\u2212 2 \u03beq (x)\u22121 ), but the quantity\n2\n\n\u03bd(\u03be, \u03c4, s) =\n\nY\n\n\u03bdq (\u03beq )\n\nq\u2264\u221e\n\ndepends only on \u03be and the chosen embedding \uf6be : K \u2192 D.\nFor a pair of non-negative integers (m, q) consider the function of two complex variables \u03c6(l,q) (z1 , z2 ) = (z1 z\u03041 )l z2q e\u22122\u03c0(z1 z\u03041 +z2 z\u03042 ) .\nLemma 4.19. Let \u03c6(z) = (z z\u0304)l e\u22122\u03c0zz\u0304 . Then the Fourier transform of \u03c6 is\n2\n\n2\n\n\u03c6\u0302(w1 + w2 i) = e\u22122\u03c0(w1 +w2 )\n\nX\n\n\u03b3(\u03b1, \u03b2; l)w12\u03b1 w22\u03b2 ,\n\n0\u2264\u03b1+\u03b2\u2264l\n\nwhere\n\u03b3(\u03b1, \u03b2; l) =\n\nX\n\nj+k=l\n\u03b1\u2264j,\u03b2\u2264k\n\n(\u22124\u03c0)\u03b1+\u03b2\u2212l\n\n\u0012 \u0013\u0012 \u0013\u0012 \u0013\nl\n2j\n2k\n(2j \u2212 2\u03b1 \u2212 1)!!(2k \u2212 2\u03b2 \u2212 1)!!\nj\n2\u03b1 2\u03b2\n\nR\n2\n2\nProof. One has \u03c6\u0302(w1 + w2 i) = 2 R2 e4\u03c0i(w1 x1 +w2 x2 ) (x21 + x22 )l e\u22122\u03c0(x1 +x2 ) dx1 dx2 =\n\u0010R\n\u0011\n\u0010\n\u0011\n\u0001\nR\nP\n2\u03c0iw1 x1 2j \u22122\u03c0x21\n2\u03c0iw2 x2 2k \u22122\u03c0x22\nx1 e\n2 j+k=l jl\nx2 e\ndx1\ndx2 and the result folRe\nRe\n\u0001\nR 4\u03c0itx\u22122\u03c0x2 2v\n2 Pv\n\u2212i 2v\n2(v\u2212i)\n.\nx dx = \u221a12 e\u22122\u03c0t\nlows from R e\ni=0 (\u22124\u03c0)\n2i (2i \u2212 1)!! t\n38\n\n\fPower series expansions of modular forms\n\nLemma 4.20. Let r \u2265 l \u2265 0 be integers, F the lift of a weight 2\u03ba eigenform and \u03be\u221e\nthe character \u03be\u221e (z) = (z/z\u0304)\u03ba+r of C\u00d7 . Then\n\uf8f1\n\uf8f20\nif l < r,\nL\u221e (\u03c6(l,2(\u03ba+r)) , \u03be\u221e , s) = (\u22121)r 2\u03c0(\u2212Nu\u22121 ) 21 \u03be\u221e (zu )r!\n\uf8f3\n\u0393(s + 2\u03ba + r \u2212 21 ) if l = r.\ns+2(\u03ba+r)\u2212 1\n(4\u03c0)\n\n2\n\n\u0001\na0\n\n\u0001\nProof. It is well known that WF\u03c8\u221e 0 1 r(\u03b8) = a\u03ba chR+ (a)e\u22122\u03c0a\u22122\u03bai\u03b8 . We compute\nthe other two terms in the integrand of (48) separately with \u03c61 (z1 ) = (z1 z\u03041 )l e\u22122\u03c0z1 z\u03041\n2(\u03ba+r) \u22122\u03c0z2 z\u03042\nand \u03c62 (z2 ) = z\u03042\ne\n.\n\u0001\n\u0001\na0\ns\n1. To compute \u03a6\u03c61 0 1 r(\u03b8) = |a|s r\u03c8\u221e (r(\u2212\u03b8))\u03c61 (0) we use the definitions (3)\ntogether with the decomposition\n\u0010\n\u0011\n\u0001 \u0010 1 \u2212 sin \u03b8 cos \u03b8 \u0011 \u0010 0 1 \u0011 \u0010 1/ cos \u03b8 0 \u0011\n\u03b8\n0 \u22121\nr(\u03b8) = 10 \u2212 tan\n(50)\n1\n1 0\n0\n1\n\u22121 0\n0\ncos \u03b8 .\nSome straightforward passages yield r\u03c8\u221e (r(\u03b8))\u03c61 (0) = (\u2212 cos \u03b8)\u03c6\u266f1 (0) where \u03c6\u266f1 (z)\n2\nis the Fourier transform of e\u22122\u03c0i cos \u03b8 sin \u03b8|z| \u03c6\u03021 ((cos \u03b8)z). Since\nZ\n2\ne\u22122\u03c0i sin \u03b8 cos \u03b8|z| \u03c6\u03021 ((cos \u03b8)z) dz\n\u03c6\u266f1 (0) =\nC\n\n(for z = x + yi and from the previous lemma)\nZ\nX\n2\n2\n2\n2(\u03b1+\u03b2)\n=2\n\u03b3(\u03b1, \u03b2; l)(cos\u03b8)\ne\u22122\u03c0(i sin \u03b8 cos +(cos \u03b8) )(x +y ) x2\u03b1 y 2\u03b2 dxdy\nR2\n\n0\u2264\u03b1+\u03b2\u2264l\n\n=\u2212\n\nX\n\n\u03b3(\u03b1, \u03b2; l)\n\n0\u2264\u03b1+\u03b2\u2264l\n\n(cos \u03b8)2(\u03b1+\u03b2)\n(2\u03b1 \u2212 1)!! (2\u03b2 \u2212 1)!!\n,\n\u03b1+\u03b2\n(4\u03c0)\n(\u2212 sin \u03b8 cos \u03b8 \u2212 (cos \u03b8)2 )\u03b1+\u03b2+1\n\neventually\n\u03a6s\u03c61\n\na0\n01\n\n\u0001\n\n\u0001\nr(\u03b8) =\n\u2212 |a|\n\ns\n\nX\n\n0\u2264\u03b1+\u03b2\u2264l\n\n\u03b3(\u03b1, \u03b2; l)(2\u03b1 \u2212 1)!!(2\u03b2 \u2212 1)!!\n(cos \u03b8)\u03b1+\u03b2 e\u2212(\u03b1+\u03b2+1)i\u03b8 .\n(\u22124\u03c0)\u03b1+\u03b2\n\n\u0001\n\u0001\n0\n2. To compute W\u03b8\u03c8\u03c6\u221e,\u221e \u2212a\n0 1 r(\u03b8) we need to use again (3) together with the de2\ncomposition (50). For, it should be noted that this time the norm in (Ku)\u2297R \u2243 C\nis \u2212NC/R (in particular, definite negative) and the main involution is z 7\u2192 \u2212z.\n\u0001\n\u0001\n\u0001\u0001\n0\n0\ni(2\u03ba+2r+1)\u03b8\nThus, we get W\u03b8\u03c8\u03c6\u221e,\u221e \u2212a\nW\u03b8\u03c8\u03c6\u221e,\u221e \u2212a\n0 1 r(\u03b8) = e\n0 1 . On the other\n2\n2\nhand, for a choice of h \u2208 C\u00d7 such that Nh = \u2212aNu\u22121 > 0,\nZ\n\u0010\u0010\n\u0011\n\u0011\n\u0001\u0001\n1\n\u2212aNu\u22121 0\n0\n,\nh\u03b8\n\u03c62 (u)\u03be\u221e (h\u03b8) d\u03b8\nr\nW\u03b8\u03c8\u03c6\u221e,\u221e \u2212a\n=\n\u03c8\n0\n1\n0 1\n2\n2\u03c0 S 1 \u221e\n1 Z\n(\u2212aNu\u22121 ) 2\n\u22121\n\u03c62 (\u2212aNu\u22121 (h\u03b8) u))\u03be\u221e (h\u03b8) d\u03b8\n=\n2\u03c0\n1\nS\n1 Z\n(\u2212aNu\u22121 ) 2\n=\n\u03c62 (h\u0304\u03b8\u22121 u)\u03be\u221e (h\u03b8) d\u03b8\n2\u03c0\nS1\n1 Z\n(\u2212aNu\u22121 ) 2\n=\n(h\u0304\u03b8\u22121 zu )2(\u03ba+r) e\u22122\u03c0a (h\u03b8)\u03ba+r (h\u0304\u03b8\u22121 )\u2212\u03ba\u2212r d\u03b8\n2\u03c0\n1\nS\n1\n\n1\n\n= (\u2212Nu\u22121 ) 2 \u03be\u221e (zu )a\u03ba+r+ 2 e\u22122\u03c0a\n39\n\n\fA. Mori\n\nPutting all the ingredients together\nL\u221e (\u03c6(l,2(\u03ba+r)) , \u03be\u221e , s) =\n1\n2\n\nZ\n\nZ\n\n1\n\n) \u03be\u221e (zu )\nas+2\u03ba+r\u2212 2 e\u22124\u03c0a ei(2\u03ba+2r+1)\u03b8\nR>0 S 1\n\uf8f6\n\uf8eb\nX \u03b3(\u03b1, \u03b2; l)(2\u03b1 \u2212 1)!!(2\u03b2 \u2212 1)!!\n(cos \u03b8)\u03b1+\u03b2 e\u2212(\u03b1+\u03b2+1)i\u03b8 \uf8f8 d\u00d7 ad\u03b8\n\u00d7\uf8ed\n(\u22124\u03c0)\u03b1+\u03b2\n0\u2264\u03b1+\u03b2\u2264l\nZ\n1\n1\nas+2\u03ba+r\u2212 2 e\u22124\u03c0a d\u00d7 a\n= \u2212(\u2212Nu\u22121 ) 2 \u03be\u221e (zu )\n>0\nR\nX \u03b3(\u03b1, \u03b2; l)(2\u03b1 \u2212 1)!!(2\u03b2 \u2212 1)!! Z\n\u00d7\n(cos \u03b8)\u03b1+\u03b2 e\u2212(\u03b1+\u03b2+1)i\u03b8 d\u03b8\n(\u22124\u03c0)\u03b1+\u03b2\n1\nS\n= \u2212(\u2212Nu\n\n\u22121\n\n0\u2264\u03b1+\u03b2\u2264l\n\nSince \u03b1 + \u03b2 \u2264 l \u2264 r we have\nZ\n\n(cos \u03b8)\u03b1+\u03b2 ei(2r\u2212\u03b1\u2212\u03b2+1)\u03b8 d\u03b8 =\n\nS1\n\n1\n2\u03b1+\u03b2\n\n\u03b1+\u03b2\nX\u0012\nj=0\n\n\u03b1+\u03b2\nj\n\n\u0013Z\n\ne\n\n2i(r\u2212j)\u03b8\n\nd\u03b8 =\n\nS1\n\n(\n\n21\u2212r \u03c0\n0\n\nif \u03b1 + \u03b2 = l = r ,\notherwise.\n\n\u0001\nhence L\u221e (\u03c6(l,2(\u03ba+r)) , \u03be\u221e , s) = 0 if l < r. When l = r, since \u03b3(j, r \u2212 j; r) = rj and\n\u0001\nPr\nr\nr\nj=0 j (2j \u2212 1)!!(2r \u2212 2j \u2212 1)!! = 2 r! as readily proved by induction, we have\n1\n\nL\u221e (\u03c6(r,2(\u03ba+r)) , \u03be\u221e , s) =\n\n2\u03c0(\u2212Nu\u22121 ) 2 \u03be\u221e (zu )r!\n(\u22124\u03c0)r\nr\n\n=\n\n\u22121\n\n1\n2\n\nZ\n\nR>0\n\n) \u03be\u221e (zu )r!\n\u0393(s\n1\ns+2(\u03ba+r)\u2212\n2\n(4\u03c0)\n\n(\u22121) 2\u03c0(\u2212Nu\n\n1\n\nas+2\u03ba+r\u2212 2 e\u22124\u03c0a d\u00d7 a\n1\n+ 2\u03ba + r \u2212 ).\n2\n\nWe shall now state and prove the main result of this section.\nTheorem 4.21. Let N be a positive integer and fix a decomposition N = \u2206No with \u2206 a\nproduct of an even number of distinct primes and (\u2206, No ) = 1. Let \u03c0 be an automorphic\ncuspidal representation for GL2 of conductor N such that\n2\u03ba\u22121\n1. \u03c0\u221e \u2243 \u03c3(\u03bc1 , \u03bc2 ), the discrete series representation with \u03bc1 \u03bc\u22121\nsgn(t).\n2 (t) = t\n\n2. \u03c0l is special for each l|\u2206.\nLet K be a quadratic imaginary field such that all l|\u2206 are inert in K and all l|No are\nsplit in K. Let c be a positive integer with (c, N ) = 1 and p an odd prime number\n\u00d7\nnot dividing N that splits in K. Assume that OK,c\n= {\u00b11}. Suppose that there exist\nGr\u00f6ssencharakters \u03c7 \u2208 \u039e(\u22122\u03ba,0) (OK,c ) and \u03be \u2208 \u039e(\u22122,0) (OK,c ) such that the p-adic avatar\n\u03beb takes values in a totally ramified extension of Qp .\nThen, there exists x \u2208 CM(\u2206, N ; OK,c ) represented by \u03c4 = t + yi \u2208 CM\u2206,K with\n40\n\n\fPower series expansions of modular forms\n\nassociated periods \u03a9\u221e and \u03a9p such that for all r \u2265 0\n\u03a9p\u22124(\u03ba+r)\n\nZ\n\nz r d\u03bc(f, x; \u03c7, \u03be) =\n\nZp\n\n2\n2\u031fVN wK,c\n(\u22121)\u03ba+r r!(2\u03ba + r)!\n1\n1\n\u03bd(\u03ber , \u03c4, )L(\u03c0K \u2297 \u03ber , )L(\u03b7K , 1)\u22121\n2\n4(\u03ba+r)\nmc hK 42\u03ba+3r \u03c0 2(\u03ba+r+1) y 2(\u03ba+r) \u03a9\u221e\n2\n2\n\nwhere \u03ber = \u03be\u03c7r NK/Q\n\n\u2212\u03ba\u2212r\n\nand \u031f is a (fixed) ratio of Petersson norms.\n\nProof. Let D be the quaternion algebra with \u2206D = \u2206. By hypothesis the representation \u03c0 is the image of an automorphic representation \u03c0 D of D\u00d7 under the JacquetLanglands correspondence and let f \u2208 S2k,0 (\u2206, No ) be a holomorphic newform in \u03c0 D .\nFor all integers r \u2265 0 let \u03c6r be as in (42).\nBy proposition 1.6 there exists x \u2208 CM(\u2206, N ; OK,c ) and choose a split p-ordinary\ntest triple (\u03c4, v, e), \u03c4 = t + iy, representing x with corresponding d\u221e \u2208 SL2 (R). By\ntaking Ov and F large enough, we can assume that f is defined over O(v) \u2282 OF , and\nthat the measure \u03bc(f, x; \u03c7, \u03be) has values in OF\nBy remark 4.17.3 we can write \u03c0(d\u221e )\u03c60 \u2297 \u03c0(d\u221e )\u03c60 = \u031f\u03b8e\u03c6 (F ) with \u03c6 = \u03c6\u221e \u2297 \u03c6f\nas in (46), F the adelization of the normalized eigenform in \u03c0 and \u031f \u2208 C\u00d7 a Petersson\nnormalization constant. We claim that for all r \u2265 0\nr\u22121\n\n\u03c0(d\u221e )\u03c6r \u2297 \u03c0(d\u221e )\u03c6r = \u031f\n\nX\n(\u22121)\u03ba e\nar,l , \u03b8e\u03c6l,2(\u03ba+r) \u2297\u03c6f (F )\n\u03b8\u03c6r,2(\u03ba+r) \u2297\u03c6f (F ) +\nr\n4 \u03c0\n\n(51)\n\nl=0\n\nwhere ar,l \u2208 \u031fZ[\u03c0]. For, the short exact sequence (14) gives a Lie algebras identification\ngo(D) \u2243 (D\u221e \u00d7D\u221e )/R and in particular o(D) = {(A, B) \u2208 D\u221e \u00d7D\u221e | trA = trB}/R \u2243\nsl2 \u00d7 sl2 . Under this identification, differentiating (45) yields\nde\n\u03b8\u03c6 (F )(h exp(tH))\n\u03b8eH\u03c6 (F ) =\ndt\n\nwith H\u03c6(x) =\nt=0\n\nd\n\u03c6(e\u2212tH1 xetH2 )\ndt\n\nt=0\n\nfor all H = (H1 , H2 ) \u2208 Lie(O(D)). If A \u2208 sl2 a repeated application of the last\nformula with A\u2032 = (A, 0) and A\u2032\u2032 = (0, A) shows that the diagonal action of A on\n\u03c0 D \u2297 \u03c0 D corresponds to the action of the second order operator A2 = A\u2032 A\u2032\u2032 = A\u2032\u2032 A\u2032 \u2208\nA(Lie(O(D))) on Schwartz functions, i.e.\nA2 \u03c6(x) =\n\n\u22022\n\u03c6(e\u2212uA xevA )\n\u2202u\u2202v\n\n.\nu=v=0\n\nWe are interested in the expression of the operator A2 in the normalized coordinates for\nA = d\u221e X + d\u22121\n\u221e . Up to conjugation, this is the same as to compute the second order operator associated to A = X + under the standard coordinates (16). A straightforward computation using the obvious real coordinates associated to the underlying\u0010real decomposi\u0011\n\u0001\n\u0001\n\u0001\n\u0001\ntion D\u221e = R 1 1 \u2295 R 1 \u22121 \u2295 R 1 1 \u2295 R \u22121 1 shows that A\u2032 = \u2212i z2 \u2202\u2202z\u03041 + z1 \u2202\u2202z\u03042\n\u0010\n\u0011\nand A\u2032\u2032 = i z2 \u2202z\u2202 1 + z\u03041 \u2202\u2202z\u03042 , so that\nA2 = z22\n\n\u2202\n\u22022\n\u22022\n\u22022\n\u22022\n+ z2\n+ z\u03041 z2\n+ z1 z2\n+ z1 z\u03041\n.\n2\n\u2202z1 \u2202 z\u03041\n\u2202 z\u03041 \u2202 z\u03042\n\u2202z1 \u2202 z\u03042\n\u2202 z\u03042\n\u2202 z\u03042\n41\n\n\fA. Mori\n\nSince\nm,q\n\nA2 \u03c6\n\n=\n\n(\n\n\u22122\u03c0\u03c60,q+2 + 4\u03c0 2 \u03c61,q+2\nm2 \u03c6m\u22121,q+2 \u2212 (4m \u2212 2)\u03c0\u03c6m,q+2 + 4\u03c0 2 \u03c6m+1,q+2\n\nif m = 0,\nif m \u2265 1,\n\nformula (51) follows from an r-fold iteration using the linearity of the theta lift and the\ndefinitions (42) and (46) of \u03c6r and \u03c6\u221e respectively.\nbc\u00d7 such that\nLet \u03c7r be a Gr\u00f6ssencharakter of weight (\u22122(\u03ba + r), 0) and trivial on R\n\u2212\u03ba\u2212r\n\u03ber = \u03c7r NK/Q\nis unitary. Combining (51) and (49) with lemma 4.20 we get\nJr (f, \u03ber , \u03c4 )2 =\n\n(\u22121)\u03ba+r 2\u031fVN r!(2\u03ba + r)!\n1\n1\n\u03bd(\u03ber , \u03c4, )L(\u03c0K \u2297 \u03ber , )L(\u03b7K , 1)\u22121 .\n42\u03ba+3r hK \u03c0 2\u03ba+2r\n2\n2\n\n(52)\n\nOn the other hand, from theorem 4.13,\nJr (f, \u03ber , \u03c4 )2 =\n\nm2c \u03c0 2 \u266f 2 2(\u03ba+r) 4(\u03ba+r)\nc(r) (f, x), \u03c7r\n(hc ) y\n\u03a9\u221e\n2\nwK,c\n\n2\n\n.\n\nWhen \u03c7r = \u03c7\u03be r we use proposition 4.6 to rewrite the last formula as\n\u03a9p\u22124(\u03ba+r) mr (\u03bc(f, x; \u03c7, \u03be))2 =\n\n2\nwK,c\n\u03a9\u22124(\u03ba+r) y \u22122(\u03ba+r) Jr (f, \u03ber , \u03c4 )2 .\nm2c \u03c0 2 \u221e\n\nSubstituting (52) into the latter formula proves the theorem.\n\nReferences\n[1] M. Bertolini and H. Darmon. Heegner points on Mumford-Tate curves. Inventiones\nMath., 126:413\u2013456, 1996.\n[2] J. F. Boutot and H. Carayol. Uniformisation p-adique des courbes de Shimura:\nles theoremes de Cerednik et de Drinfeld. In Courbes modulaires at courbes de\nShimura, volume 196 of Ast\u00e9risque, pages 45\u2013158, 1991.\n[3] D. Bump. Automorphic Forms and Representations, volume 55 of Cambridge Studies in Adv. Math.. Cambridge University Press, 1996.\n[4] H. Darmon. Rational Pooints on Modular Elliptic Curves, volume 101 of Regional\nConf. Ser. Math.. American Mathematical Society, 2004.\n[5] P. Deligne. Hodge cycles on abelian varieties. In Hodge cycles, Motives, and\nShimura varieties, volume 900 of Lecture Notes in Math., pages 9\u2013100, 1982.\n[6] P. Deligne and M. Rapoport. Les sch\u00e9mas de modules de courbes elliptiques. In\nModular Functions of One Variable II, volume 349 of Lecture Notes in Math., pages\n143\u2013316, 1973.\n[7] F. Diamond and J. Im. Modular forms and modular curves. In Seminar on Fermat's\nLast Theorem (Toronto, ON, 1993\u20131994), volume 17 of CMS Conf. Proc., pages\n39\u2013133. American Math. Soc., 1995.\n[8] F. Diamond and R. Taylor. Non-optimal levels of mod l representations. Inventiones\nMath., 115:435\u2013462, 1994.\n42\n\n\fPower series expansions of modular forms\n\n[9] G. Faltings and C.-L. Chai. Degenerations of Abelian Varieties, volume 22 of\nErgebnisse der Math. Springer, 1990.\n[10] M. Harris. A note on three lemmas of Shimura. Duke Math. J., 46:871\u2013879, 1979.\n[11] M. Harris. Special values of zeta functions attached to Siegel modular forms. Ann.\nSc. \u00c9c. Norm. Sup., 14:77\u2013120, 1981.\n[12] M. Harris. Non-vanishing of L-functions on 2 \u00d7 2 unitary groups. Forum Math.,\n5:405\u2013419, 1993.\n[13] M. Harris and S. Kudla. The central critical value of a triple product L-function.\nAnnals Math., 133:605\u2013672, 1991.\n[14] M. Harris and S. Kudla. Arithmetic automorphic forms for the nonholomorphic\ndiscrete series of GSp(2). Duke Math. J., 66:59\u2013121, 1992.\n[15] M. Harris and J. Tilouine. p-adic measures and square roots of special values of\ntriple product L-functions. Math. Ann., 320:127\u2013147, 2001.\n[16] K. Hashimoto. Explicit form of quaternion modular embeddings. Osaka J. Math.,\n32:533\u2013546, 1995.\n[17] H. Hida. Hecke algebras for GL1 and GL2 . In Seminaire de theorie des nombres,\nParis 1983\u201384, volume 63 of Progr. Math., pages 133\u2013146, 1986.\n[18] H. Hida. Elementary Theory of L-functions and Eisenstein Series, volume 26 of\nStudent Texts. London Mathematical Society, 1993.\n[19] R. Howe. Transcending classical invariant theory. J. Amer. Math. Soc, 2:536\u2013552,\n1989.\n[20] H. Jacquet. Automorphic forms on GL(2), II, volume 278 of Lecture Notes in Math.\nSpringer-Verlag, 1972.\n[21] H. Jacquet and R. P. Langlands. Automorphic forms on GL(2), volume 114 of\nLecture Notes in Math. Springer-Verlag, 1970.\n[22] B. Jordan. Points on Shimura curves rational over number fields. J. reine u. angew.\nMath., 371:92\u2013114, 1986.\n[23] N. Katz. Nilpotent connections and the monodromy theorem: applications of a\nresult of Turrittin. Publ. Math. IHES, 39:355\u2013412, 1970.\n[24] N. Katz. p-adic properties of modular schemes and modular forms. In Modular\nFunctions of One Variable III, volume 350 of Lecture Notes in Math., pages 70\u2013\n189, 1973.\n[25] N. Katz. p-adic interpolation of real analytic Eisenstein series. Annals of Math.,\n104:459\u2013571, 1976.\n[26] N. Katz. p-adic L-function for CM fields. Inventiones Math., 49:199\u2013297, 1978.\n[27] N. Katz. Serre-Tate local moduli. In Surfaces Algebraiques, volume 868 of Lecture\nNotes in Math., pages 138\u2013202, 1981.\n43\n\n\fA. Mori\n\n[28] N. Katz and B. Mazur. Arithmetic moduli of elliptic curves, volume 108 of Annals\nof Math. Studies. Princeton Univ. Press, 1985.\n[29] N. Katz and T. Oda. On the differentiation of de Rham cohomology classes with\nrespect to parameters. J. Math. Kyoto Univ., 8(2):199\u2013213, 1968.\n[30] S. Kudla. Seesaw dual reductive pairs. In Automorphic forms of several variables\n(Katata 1983), volume 46 of Progr. Math, pages 244\u2013268. Birkh\u00e4user Boston, 1984.\n[31] H. Maass. Die Differentialgleichungen in der Theorie der Siegelschen Modulfunktionen. Math. Ann., 126:44\u201368, 1953.\n[32] J. S. Milne. Points on Shimura varieties modp. In Automorphic Forms, Representations and L-functions, volume 33 of Proc. Symp. Pure Math., pages 165\u2013183,\n1979.\n[33] A. Mori. A characterization of integral elliptic automorphic forms. Ann. Sc. Norm.\nSup. Pisa, IV(21):45\u201362, 1994.\n[34] A. Mori and L. Terracini. A canonical map between Hecke algebras. Boll. Un. Mat.\nIt. Sez. B, 8(2):429\u2013452, 1999.\n[35] D. Mumford. Geometric Invariant Theory. Springer-Verlag, Heidelberg, 1965.\n[36] R. Noot. Hodge classes, Tate classes, and local moduli of abelian varieties. PhD\nthesis, Rijksuniversiteit Utrecht, 1992.\n[37] F. Oort. Finite group schemes, local moduli for abelian varieties and lifting problems. Compositio Math., 23:265\u2013296, 1971.\n[38] K. Prasanna. Integrality of a ratio of Petersson norms and level-lowering congruences. Ann. Math., 163:901\u2013967, 2006.\n[39] D. Roberts. Shimura curves analogous to X0 (N ). PhD thesis, Harvard University,\n1989.\n[40] J.-P. Serre. Endomorphismes completement continus des espaces de Banach padiques. IHES Publ. Math., 12:69\u201385, 1962.\n[41] J.-P. Serre. Formes modulaires et fonctions z\u00eata p-adiques. In Modular Functions\nof One Variable, III, volume 350 of Lecture Notes in Math., pages 191\u2013268, 1973.\n[42] H. Shimizu. Theta series and automorphic forms on GL2 . Math. Soc. Japan,\n24:638\u2013683, 1972.\n[43] G. Shimura. Introduction to the Arithmetic Theory of Automorphic Functions.\nIwanami Shoten and Princeton University Press, 1971.\n[44] J. Tilouine. Deformations of Galois representations and Hecke algebras. Narosa\nPubl. House, 1996.\n[45] M.-F. Vigneras. Arithm\u00e9tique des Alg\u00e8bres de Quaternions, volume 800 of Lecture\nNotes in Math. Springer-Verlag, 1980.\n[46] J.-L. Waldspurger. Sur les valeurs des certaines fonctions L automorphes en leur\ncentre de sym\u00e9trie. Compositio Math., 54:173\u2013242, 1985.\n44\n\n\fPower series expansions of modular forms\n\n[47] T. Watson. Rankin triple products and quantum chaos . PhD thesis, Princeton\nUniversity, 2003.\n[48] A. Weil. On a certain type of characters of the idele-class group of an algebraic\nnumber-field. In Proceedings of the international symposium on algebraic number\ntheory, Tokio & Nikko 1955, pages 1\u20137, 1956.\n\n45\n\n\f"}