{"id": "http://arxiv.org/abs/0910.5748v1", "guidislink": true, "updated": "2009-10-29T23:36:13Z", "updated_parsed": [2009, 10, 29, 23, 36, 13, 3, 302, 0], "published": "2009-10-29T23:36:13Z", "published_parsed": [2009, 10, 29, 23, 36, 13, 3, 302, 0], "title": "A Stochastic Immersed Boundary Method for Fluid-Structure Dynamics at\n  Microscopic Length Scales", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0910.2393%2C0910.4217%2C0910.4855%2C0910.5664%2C0910.5248%2C0910.3073%2C0910.3149%2C0910.5556%2C0910.4056%2C0910.1336%2C0910.5165%2C0910.4884%2C0910.3961%2C0910.3069%2C0910.5640%2C0910.1437%2C0910.5748%2C0910.4270%2C0910.3052%2C0910.1145%2C0910.4321%2C0910.0774%2C0910.3178%2C0910.0133%2C0910.2690%2C0910.5293%2C0910.0304%2C0910.2533%2C0910.0546%2C0910.3345%2C0910.5246%2C0910.1798%2C0910.2847%2C0910.5620%2C0910.0620%2C0910.2905%2C0910.1040%2C0910.4486%2C0910.4798%2C0910.5613%2C0910.3395%2C0910.5078%2C0910.1405%2C0910.3217%2C0910.0269%2C0910.0134%2C0910.4046%2C0910.0438%2C0910.0110%2C0910.0562%2C0910.0221%2C0910.1273%2C0910.5636%2C0910.2049%2C0910.4475%2C0910.5445%2C0910.5052%2C0910.4408%2C0910.1113%2C0910.4397%2C0910.5515%2C0910.0359%2C0910.5188%2C0910.1208%2C0910.1964%2C0910.5544%2C0910.2605%2C0910.2731%2C0910.2321%2C0910.4063%2C0910.1962%2C0910.3937%2C0910.0130%2C0910.4069%2C0910.3663%2C0910.0825%2C0910.0186%2C0910.0788%2C0910.4531%2C0910.2863%2C0910.1984%2C0910.2449%2C0910.1584%2C0910.0569%2C0910.0557%2C0910.2601%2C0910.4309%2C0910.3270%2C0910.0707%2C0910.2240%2C0910.3546%2C0910.0718%2C0910.3324%2C0910.5889%2C0910.0985%2C0910.4856%2C0910.1932%2C0910.3987%2C0910.1407%2C0910.5173%2C0910.3795&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "A Stochastic Immersed Boundary Method for Fluid-Structure Dynamics at\n  Microscopic Length Scales"}, "summary": "In this work it is shown how the immersed boundary method of (Peskin2002) for\nmodeling flexible structures immersed in a fluid can be extended to include\nthermal fluctuations. A stochastic numerical method is proposed which deals\nwith stiffness in the system of equations by handling systematically the\nstatistical contributions of the fastest dynamics of the fluid and immersed\nstructures over long time steps. An important feature of the numerical method\nis that time steps can be taken in which the degrees of freedom of the fluid\nare completely underresolved, partially resolved, or fully resolved while\nretaining a good level of accuracy. Error estimates in each of these regimes\nare given for the method. A number of theoretical and numerical checks are\nfurthermore performed to assess its physical fidelity. For a conservative\nforce, the method is found to simulate particles with the correct Boltzmann\nequilibrium statistics. It is shown in three dimensions that the diffusion of\nimmersed particles simulated with the method has the correct scaling in the\nphysical parameters. The method is also shown to reproduce a well-known\nhydrodynamic effect of a Brownian particle in which the velocity\nautocorrelation function exhibits an algebraic tau^(-3/2) decay for long times.\nA few preliminary results are presented for more complex systems which\ndemonstrate some potential application areas of the method.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0910.2393%2C0910.4217%2C0910.4855%2C0910.5664%2C0910.5248%2C0910.3073%2C0910.3149%2C0910.5556%2C0910.4056%2C0910.1336%2C0910.5165%2C0910.4884%2C0910.3961%2C0910.3069%2C0910.5640%2C0910.1437%2C0910.5748%2C0910.4270%2C0910.3052%2C0910.1145%2C0910.4321%2C0910.0774%2C0910.3178%2C0910.0133%2C0910.2690%2C0910.5293%2C0910.0304%2C0910.2533%2C0910.0546%2C0910.3345%2C0910.5246%2C0910.1798%2C0910.2847%2C0910.5620%2C0910.0620%2C0910.2905%2C0910.1040%2C0910.4486%2C0910.4798%2C0910.5613%2C0910.3395%2C0910.5078%2C0910.1405%2C0910.3217%2C0910.0269%2C0910.0134%2C0910.4046%2C0910.0438%2C0910.0110%2C0910.0562%2C0910.0221%2C0910.1273%2C0910.5636%2C0910.2049%2C0910.4475%2C0910.5445%2C0910.5052%2C0910.4408%2C0910.1113%2C0910.4397%2C0910.5515%2C0910.0359%2C0910.5188%2C0910.1208%2C0910.1964%2C0910.5544%2C0910.2605%2C0910.2731%2C0910.2321%2C0910.4063%2C0910.1962%2C0910.3937%2C0910.0130%2C0910.4069%2C0910.3663%2C0910.0825%2C0910.0186%2C0910.0788%2C0910.4531%2C0910.2863%2C0910.1984%2C0910.2449%2C0910.1584%2C0910.0569%2C0910.0557%2C0910.2601%2C0910.4309%2C0910.3270%2C0910.0707%2C0910.2240%2C0910.3546%2C0910.0718%2C0910.3324%2C0910.5889%2C0910.0985%2C0910.4856%2C0910.1932%2C0910.3987%2C0910.1407%2C0910.5173%2C0910.3795&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "In this work it is shown how the immersed boundary method of (Peskin2002) for\nmodeling flexible structures immersed in a fluid can be extended to include\nthermal fluctuations. A stochastic numerical method is proposed which deals\nwith stiffness in the system of equations by handling systematically the\nstatistical contributions of the fastest dynamics of the fluid and immersed\nstructures over long time steps. An important feature of the numerical method\nis that time steps can be taken in which the degrees of freedom of the fluid\nare completely underresolved, partially resolved, or fully resolved while\nretaining a good level of accuracy. Error estimates in each of these regimes\nare given for the method. A number of theoretical and numerical checks are\nfurthermore performed to assess its physical fidelity. For a conservative\nforce, the method is found to simulate particles with the correct Boltzmann\nequilibrium statistics. It is shown in three dimensions that the diffusion of\nimmersed particles simulated with the method has the correct scaling in the\nphysical parameters. The method is also shown to reproduce a well-known\nhydrodynamic effect of a Brownian particle in which the velocity\nautocorrelation function exhibits an algebraic tau^(-3/2) decay for long times.\nA few preliminary results are presented for more complex systems which\ndemonstrate some potential application areas of the method."}, "authors": ["P. J. Atzberger", "P. R. Kramer", "C. S. Peskin"], "author_detail": {"name": "C. S. Peskin"}, "author": "C. S. Peskin", "links": [{"title": "doi", "href": "http://dx.doi.org/10.1016/j.jcp.2006.11.015", "rel": "related", "type": "text/html"}, {"href": "http://arxiv.org/abs/0910.5748v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0910.5748v1", "rel": "related", "type": "application/pdf"}], "arxiv_comment": "52 pages, 11 figures, published in journal of computational physics", "arxiv_primary_category": {"term": "cond-mat.soft", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "cond-mat.soft", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.mes-hall", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "cond-mat.stat-mech", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "physics.flu-dyn", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0910.5748v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0910.5748v1", "journal_reference": "J. Comp. Phys., Vol. 224, Iss. 2, (2007)", "doi": "10.1016/j.jcp.2006.11.015", "fulltext": "A STOCHASTIC IMMERSED BOUNDARY METHOD FOR\nFLUID-STRUCTURE DYNAMICS AT MICROSCOPIC LENGTH\nSCALES\n\narXiv:0910.5748v1 [cond-mat.soft] 29 Oct 2009\n\nPAUL J. ATZBERGER\n\n\u2217,\n\nPETER R. KRAMER\n\n\u2020 , AND\n\nCHARLES S. PESKIN\n\n\u2021\n\nAbstract. In this work it is shown how the immersed boundary method of (64) for modeling\nflexible structures immersed in a fluid can be extended to include thermal fluctuations. A stochastic\nnumerical method is proposed which deals with stiffness in the system of equations by handling\nsystematically the statistical contributions of the fastest dynamics of the fluid and immersed structures over long time steps. An important feature of the numerical method is that time steps can\nbe taken in which the degrees of freedom of the fluid are completely underresolved, partially resolved, or fully resolved while retaining a good level of accuracy. Error estimates in each of these\nregimes are given for the method. A number of theoretical and numerical checks are furthermore\nperformed to assess its physical fidelity. For a conservative force, the method is found to simulate\nparticles with the correct Boltzmann equilibrium statistics. It is shown in three dimensions that\nthe diffusion of immersed particles simulated with the method has the correct scaling in the physical\nparameters. The method is also shown to reproduce a well-known hydrodynamic effect of a Brownian\nparticle in which the velocity autocorrelation function exhibits an algebraic (\u03c4 \u22123/2 ) decay for long\ntimes (6; 16; 20; 23; 37; 38; 54; 67; 78). A few preliminary results are presented for more complex\nsystems which demonstrate some potential application areas of the method.\nKey words. Stochastic Processes, Fluid Dynamics, Brownian Dynamics, Statistical Mechanics,\nImmersed Boundary Method, Brownian Ratchet, Polymer Knot, Osmotic Pressure\n\n1. Introduction. In modeling many biological systems it is important to take\ninto account the interaction of flexible structures with a fluid. The immersed boundary\nmethod of (64) has found wide use as an efficient numerical method for simulating such\nsystems. Some examples include the study of blood flow around heart valves (65),\nwave propagation in the inner ear (32), and the generation of lift in insect flight (56).\nWith experimental advances in molecular and cellular biology has come an increasing\ninterest in developing methods to model qualitatively and quantitatively microscopic\nbiological processes at the cellular and subcellular level (12; 27; 41). The immersed\nboundary method provides a promising framework for simulating such systems.\nAt the cellular level the fluid may consist of either the aqueous environment\noutside of the cell or the cytoplasm within. Some important flexible structures in the\ncellular context include the outer cell membrane, intracellular vesicles, cytoskeletal\nfibers, and molecular motor proteins. These structures play an important role in cell\nmotility or cell division among other processes (8).\nIn such systems the relevant features can span a range of length scales from\ntens of microns or more for the outer cell membrane and cytoskeletal fibers to tens\nof nanometers for individual cytoskeletal monomers and motor proteins. At these\nlength scales thermal fluctuations of the system become significant and in many cases\nappear crucial to achieve biological function. Some examples include force generation\nand progression of molecular motors along cytoskeletal fibers (1; 41; 84), osmotic\neffects such as vesicle and gel swelling (26; 33; 51; 61; 83), and polymerization effects\n\u2217 University of California, Department of Mathematics , Santa Barbara, CA 93106; e-mail:\natzberg@math.ucsb.edu; phone: 805-679-1330; Work supported by NSF Grant DMS - 9983646 and\nDMS-0635535.\n\u2020 Rensselaer Polytechnic Institute, Department of Mathematics , Troy, NY 12180; e-mail:\nkramep@rpi.edu; phone 518-276-6896; Work supported by NSF CAREER DMS - 0449717.\n\u2021 New York University, Department of Mathematics , New York, NY 10012; e-mail: peskin@cims.nyu.edu.\n\n1\n\n\f2\n\nP. ATZBERGER, P. KRAMER\n\ninvolved in force generating processes in cell motility (34; 60; 72; 81).\nModeling such complex cellular systems in molecular detail is infeasible with\nmethods such as molecular dynamics as a consequence of the immense computational\ncost required to resolve the broad range of active length and time scales. This suggests\nthat a coarse-grained numerical approach must be taken which does not resolve all of\nthe detailed physics but rather attempts to make approximations that yield effective\nequations to capture the most relevant features of the dynamical phenomenon being\nstudied. Here we discuss how the framework of the immersed boundary method can\nbe extended for use in such modeling by including thermal fluctuations to capture\ndynamical phenomena at the cellular length scale.\nThe theory of nonequilibrium statistical mechanics indicates that the influence of\nthermal fluctuations on a mechanical system can typically be represented through the\naddition of thermal forcing terms which decorrelate rapidly in time. The forcing can\nthen be represented by appropriate \"white noise\" processes. This generally involves\na nontrivial structure of correlations between the state variables in such a way that\nthere is an energy balance between the thermal forcing and dissipation of the system\nso that a corresponding fluctuation-dissipation theorem for the system is satisfied\n(47; 70).\nSeveral computational fluid dynamical schemes have been extended toward the\nmicroscale through such an inclusion of thermal forces. The most widely used approach is known as Stokesian or Brownian dynamics (15; 22; 75; 77). In this approach\nthe structures are modeled as collections of rigid \"elementary particles\" which interact through force laws derived by approximating the fluid dynamics by a quasi-steady\nStokes flow. This latter approximation is strictly appropriate only when, among other\nassumptions, the fluid density is much less than the density of the structures (19),\na condition better met in engineering applications (such as suspensions (14; 15; 77))\nthan in physiological settings (13). The result of the underlying approximations in the\nStokesian/Brownian dynamics method is a rather strongly coupled system of stochastic equations for the motion of the elementary particles. For a well-designed computation the cost of a simulation can be rendered roughly proportional to N log N ,\nwhere N is the number of elementary particles (77). In the presence of fast time\nscales arising from thermal fluctuations and possibly chemically activated processes,\nthe impact of the quasi-steady Stokes approximation and the representation of the\nelementary particles as rigid (rather than flexible) on the accuracy of the simulation\nis not yet clear (73).\nAnother approach for modeling fluids with immersed structures is Dissipative\nParticle Dynamics (9; 18; 24; 25; 35; 39; 53; 58; 63). The method is built phenomenologically in terms of \"fluid particles\" which represent a parcel of fluid along with its\ncollection of immersed structures. When thermal forces are included in the method\nthe fluid particles are simulated with a stochastic system of equations modeling their\n(soft) interactions. This method however does not readily extend to the microscopic\ndomain since the immersed structures within a parcel are not resolved in detail. Dissipative Particle Dynamics may however be appropriate for somewhat larger scale\nsimulations in which one is interested in the effects of a numerous collection of immersed polymers or other structures on the dynamics of a fluid flow.\nA different class of approaches which emphasize the role of the fluid dynamics while making other simplifications has also been proposed. These include finiteelement (76) and lattice-Boltzmann (48) methods, in which the computational fluid\ndynamics are extended to include thermal forces in the fluid equations following the\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n3\n\nframework of (49). The immersed boundary method which we shall discuss belongs to\nthis broad class of methods (45). A theoretical approach with certain similarities to\nthe immersed boundary method with thermal fluctuations has been proposed in (62),\nbut differs in how thermal forces are treated for the immersed structures. A virtue of\nthe immersed boundary method when compared to other methods is the straightforward physical manner in which it approximates the interaction of the fluid with the\nflexible structures.\nA key feature of the immersed boundary method, distinguishing it from Stokesian/Brownian dynamics, is that the dynamics of the fluid are represented in the\nimmersed boundary equations so that subtle inertial effects of the fluid can be incorporated into the thermally fluctuating dynamics. For example, as demonstrated\nin Subsection 5.2, the method captures the slow decay (\u03c4 \u22123/2 ) in the tail of the autocorrelation function of the velocity of an immersed particle. Another advantage\nof tracking the fluid dynamics is the natural way in which the immersed boundary\nmethod can respect the topology of flexible structures so that, for example, polymers\ndo not cross themselves or each other. This feature gives the immersed boundary\nmethod the potential for efficient simulation of polymer links and knots.\nA basic description of how thermal fluctuations can be incorporated within the\nimmersed boundary method was presented in (45), and theoretical analysis of the\nphysical behavior of the method through an asymptotic stochastic mode reduction\ncalculation was developed in (46). The immersed boundary method was found in\nthese theoretical works to produce generally the correct physical behavior for the\nthermal fluctuations of immersed structures.\nHere we present a derivation for the thermal fluctuations of the immersed boundary method in the context of the time dependent Stokes equations. We then present\na new numerical method developed from a novel time discretization of the stochastic\nequations. In addition, further theoretical analysis of the framework is performed to\ninvestigate the physical behavior of the method and comparisons are made between\ntheory and numerical simulations.\nFor stochastic differential equations most traditional finite difference methods,\nsuch as Runge-Kutta, achieve a lower order of accuracy than for deterministic ordinary\ndifferential equations as a consequence of the nondifferentiability of Brownian motion\nand its order t1/2 scaling in time (44). When considering the full system of equations\nof the immersed boundary method, these issues are further compounded by a wide\nrange of length and time scales that arise in many problems.\nFor small length scale systems in which the Reynolds number is small and the\nfluid flow is Stokesian to a good approximation, the time scales associated with the\nfine-scale fluid modes can be considerably faster than the time scales of the largescale fluid modes and the immersed structures. In many problems it is the dynamics\nof the immersed structures and the large-scale features of the fluid flow that are of\ninterest. The fine-scale features of the fluid are incorporated in simulations primarily\nto determine their effects on the larger scales but are often not of direct interest in\nand of themselves.\nSince the full system is rather stiff as a result of the fast time scales of the finescale fluid modes, we would like to be able to take time steps which underresolve those\nscales of the fluid which are not of primary interest in the simulation. However, we\nmust take care in how this is done, because otherwise the effects of the underresolved\nfluid modes on the more interesting degrees of freedom can be misrepresented. For\nexample, the simple use of a method such as Euler-Marayama (44) leads to poor\n\n\f4\n\nP. ATZBERGER, P. KRAMER\n\naccuracy for the stochastic dynamics when long time steps are used. In this case, the\nparticle trajectories are found to be overly diffuse in the sense that the wrong scaling\nis obtained for the mean squared distance traveled.\nAfter a presentation of the general framework of the immersed boundary method\nwithout spatiotemporal discretization in Section 2, a stochastic analysis is developed\nin Section 3 to design a numerical method which maintains accuracy over time steps\nwhich can be longer than the time scales of some or all of the fluid modes. The systematically derived numerical scheme presented here improves upon in several ways\na correction-factor approach taken in (45) to achieve long time steps. The numerical method is constructed from a new time discretization of the immersed boundary\nequations, in which the equations are integrated analytically using standard techniques from stochastic calculus under well controlled approximations. The numerical\nmethod allows for the statistical contributions of the fast stochastic dynamics of the\nfluid, which are not explicitly resolved over long time steps, to be accounted for in\nthe dynamics of the immersed structures. Moreover, the correlations in the statistics\nbetween the fluctuations of the degrees of freedom of the system are handled systematically, allowing for consistent realizations of the velocity field of the fluid and\nimmersed structures to be simulated.\nIn Section 4, error estimates are given which indicate that the method attains a\ngood level of accuracy (in a strong statistical sense (44)) whether the fluid modes are\ncompletely underresolved, partially resolved, or fully resolved. Only the degrees of\nfreedom of the immersed structures constrain the time step. The numerical method\nhandles a broad range of time steps in a unified manner, so that depending on the\napplication, the fast dynamics of the fluid can either be explicitly resolved or underresolved, with their effects correctly represented on the structural degrees of freedom.\nIn Section 5, an expression for the diffusion coefficient of immersed particles is\nderived. The predictions are compared with the results of numerical simulations\nshowing good agreement with the theory for different particle sizes and both short\nand long time steps. It is further shown that for intermediate time steps, the method\ncaptures a well-known hydrodynamic effect of a Brownian particle, in which the decay\nof the autocorrelation function of the velocity of the particle decays algebraically\n(\u03c4 \u22123/2 ) (6; 16; 20; 23; 37; 38; 54; 67; 78). Also in Section 5, numerical simulations\nare performed which confirm that the method produces the correct osmotic pressure\nand equilibrium statistical distribution for the position of particles within an external\npotential at finite temperature. To demonstrate more complex applications of the\nmethod, simulations are then presented which investigate behavior of the osmotic\npressure associated with confinement of molecular dimers and polymer knots in a\nmicroscopic chamber, as well as a basic model of a molecular motor protein immersed\nin a fluid subject to a hydrodynamic load force.\nThe physical consistencies we demonstrate in the method through our analysis\nand numerical experiments indicate that the stochastic immersed boundary method\nis a viable means to model on a coarse scale the influence of thermal fluctuations on\nthe interaction of fluids and flexible structures. This suggests that the method holds\npromise as an effective approach in modeling complex biological phenomena which\noperate at the cellular and subcellular level.\n2. Fluid-Particle Equations. For the physical systems with which we shall be\nconcerned, the relevant length scales will typically be on the order of tens of microns\nor smaller. The amplitude of the velocity fluctuations on these scales are sufficiently\nsmall, relative to the viscosity and length scale, that the Reynolds number is very\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n5\n\nsmall. This will allow us to neglect the nonlinear advection term in the Navier-Stokes\nequation for the fluid dynamics. However, we will not drop the time derivative term\n(as is often done in low Reynolds number limits (50)) because the dynamical time\nscales arising from Brownian motion and possibly certain vibrational modes of the\nimmersed structures are in general too fast to allow this. That is, the dynamics can\ngenerally exhibit time scales which are much shorter than the advection time scale\n(length scale divided by velocity scale), so we can drop the nonlinear advection term\nbut not the time derivative of the velocity. This leads us to the time-dependent Stokes\nequations for an incompressible fluid, which read\n(2.1)\n(2.2)\n\n\u03c1\n\n\u2202u(x, t)\n= \u03bc\u2206u(x, t) \u2212 \u2207p + ftotal (x, t)\n\u2202t\n\u2207 * u = 0,\n\nwhere p is the pressure arising from the incompressibility constraint, \u03c1 is the fluid\ndensity, \u03bc is the dynamic viscosity, and ftotal is the total force density acting on the\nfluid.\nThe force density acting on the fluid arises from two sources. The first source is the\nforces applied to the fluid by the immersed structures and particles. This component\nof the force density, denoted fprt , generally arises from the elastic deformations of\nimmersed structures, but they may also be applied externally and transmitted by the\nimmersed structures to the fluid. The second contribution to the force density is from\nthe thermal fluctuations of the system and is denoted by fthm . Each of these force\ndensities will be discussed in greater detail below. Together, they comprise the total\nforce density acting on the fluid\n(2.3)\n\nftotal (x, t) = fprt (x, t) + fthm (x, t).\n\nThe immersed boundary model for fluid-structure and fluid-particle coupling\ntreats the flexible structures and particles to first approximation as part of the fluid,\nrepresenting their structural properties (such as elasticity) through the force density\nterm fprt (64). All structures, such as membranes, polymers, and particles, are\nmodeled as a collection of M discrete \"elementary particles,\" with locations denoted\nby {X[j] (t)}M\nj=1 , which interact with force laws appropriate to their structural properties. For simplicity, we consider the case in which all forces can be described in\nterms of a conservative potential V ({X}) depending on the positions of the collection\nof elementary particles. More general force relations, including active forces, can be\nincluded (64). For notational convenience in the exposition, the range of indices for\nthe collection of elementary particles will often be omitted. We will often refer to the\nforces exerted by the immersed structures as \"particle forces,\" since the structures\nare represented in the numerical method as a collections of interacting particles.\nIn the immersed boundary method, elementary particles of size a are represented\nby a function \u03b4a (x) which may be thought of as a Dirac delta function smoothed\nover a length scale a in such a manner that the smoothed delta function has good\nnumerical properties (See Appendix A and (64)).\nThis smoothed delta function is used both in converting the force associated with\nan elementary particle to a localized force density acting on the fluid:\n(2.4)\n\nfprt (x, t) =\n\nM\nX\n\n\u2032\n\n(\u2212\u2207X[j\u2032 ] V )({X(t)}) \u03b4a (x \u2212 X[j ] (t))\n\nj \u2032 =1\n\n\f6\n\nP. ATZBERGER, P. KRAMER\n\nand in computing the velocity of the elementary particle by an interpolation of the\nfluid velocity in its vicinity:\nZ\ndX[j] (t)\n(2.5)\n=\n\u03b4a (x \u2212 X[j] (t))u(x, t)dx.\ndt\n\u039b\nThe integration is over the entire domain \u039b of the fluid. In the immersed boundary\nformulation, this includes the space occupied by the immersed particles and structures,\nwhich are thought of as parts of the fluid in which additional forces happen to be\napplied. In particular, the domain \u039b is independent of time, despite the motion of\nthe immersed material.\nWe also note that in the present context the parameter a is a physical parameter\nof the model, since it is supposed to represent a physical dimension of an elementary\nparticle. In particular, a is not a numerical parameter which is supposed to vanish\nalong with the meshwidth for the fluid computations as it is refined. In this respect,\nthe use of smoothed delta functions described here is different from the standard use\nof such functions in immersed boundary computations. The idea that smoothed delta\nfunctions could be used to model the physical dimensions of immersed objects was\npreviously proposed in (55) under the name \"force cloud method\".\n3. Numerical Method. We shall now discuss a numerical discretization and\nspecification of the thermal force density for the equations 2.1\u20132.5 defining the immersed boundary method. A summary of the numerical method in algorithmic form\nis given in Subsection 3.1, followed by a heuristic discussion in Subsection 3.2 and a\nmathematical derivation in Subsection 3.3.\n3.1. Summary of the Numerical Method. The numerical method is based\nupon a finite difference discretization of the differential equations 2.1\u20132.5 describing\nthe coupled dynamics of the fluid and the immersed structures. The fluid variables\n(velocity field u and pressure field p) are represented on a periodic grid with length L\nalong each direction, N grid points along each direction, and grid spacing \u2206x = L/N .\nThe values of these fields on the lattice will be denoted through subscripted variables\nsuch as um and pm , where the subscript m = (m1 , m2 , m3 ) is a vector with integer\ncomponents indicating the grid point in question (relative to some arbitrarily specified\norigin). The position of the grid point with index m is denoted by xm .\nThe Discrete Fourier Transform (DFT) of the fluid variables plays an important\nrole in the numerical simulation scheme, and is related to the physical space values\non the grid through the formulas:\n1 X\num exp (\u2212i2\u03c0k * m/N )\nN3 m\nX\n=\n\u00fbk exp (i2\u03c0k * m/N ) ,\n\n(3.1)\n\n\u00fbk =\n\n(3.2)\n\num\n\nk\n\nwhere each of the sums in the above equations runs over the N 3 lattice points\ndefined by 0 \u2264 k(l) \u2264 N \u2212 1, and 0 \u2264 m(l) \u2264 N \u2212 1, where the parenthesized\nsuperscripts l = 1, 2, 3 denote the Cartesian components of the indicated vector. In\nfact any translate of these blocks of lattice points could be used equivalently in the\nsums, due to the underlying periodicity.\nTime is discretized into time steps \u2206t, and the values of the system variables at\nthe nth time step, corresponding to the time tn = n\u2206t, are denoted with a superscript\n\n\f7\n\nSTOCHASTIC IMMERSED BOUNDARY METHOD\n\ninteger n. The procedure by which these variables are updated from one time step to\nthe next is now described:\n1. The structural forces exerted by the immersed structures are computed and\nthe lattice values of the particle force density field which is applied to the\nfluid is obtained from\n(3.3)\n\nn\nfm\n=\n\nN\nX\n\nj \u2032 =1\n\n\u2032\n\n\u2212 (\u2207X[j\u2032 ] V ) ({Xn }) \u03b4a (xm \u2212 Xn,[j ] ).\n\nHere and afterwards, we drop the subscript \"prt\" from the particle force\ndensity. The Fourier coefficients f\u0302kn of this particle force density field are\ncomputed using a Fast Fourier Transform (FFT).\n2. The Fourier coefficients of the velocity field of the fluid are updated by the\nstochastic recurrence\n(3.4)\n\n\u00fbn+1\n= e\u2212\u03b1k \u2206t \u00fbnk +\nk\n\n\u0001\n1\nn\n\u22a5 n\n1 \u2212 e\u2212\u03b1k \u2206t \u2118\u22a5\nk f\u0302k + \u2118k \u039e\u0302k ,\n\u03c1\u03b1k\n\nwhere \u2118\u22a5\nk denotes the projection orthogonal to \u011dk defined by\n(j)\n\n\u011dk = sin(2\u03c0k(j) /N )/\u2206x\n\n(3.5)\n\nwhich is used to enforce the incompressibility constraint 2.2. The factor\nn\n\u039e\u0302k = \u03c3k \u03b7\u0303 k accounts for the thermal fluctuations over the time step, where \u03b7\u0303 k\ndenotes a complex vector-valued random variable independent in k, having\nindependent real and imaginary components, each of which are Gaussian\nn\nrandom variables with mean zero and variance one. The variance of \u039e\u0302k is\ndetermined in Subsection 3.3.4 and is given by\n(3.6)\n\n\u03c3k2 =\n\nDk\n(1 \u2212 exp (\u22122\u03b1k \u2206t)) ,\n\u03b1k\n\nwhere\n(3.7)\n\n\u03b1k =\n\n3\n2\u03bc X\n(1 \u2212 cos(2\u03c0k(j) /N )))\n\u03c1\u2206x2 j=1\n\nand\n(3.8)\n\nDk =\n\n(\n\nkB T\n\u03c1L3 \u03b1k\nkB T\n2\u03c1L3 \u03b1k\n\n,k\u2208K\n,k\u2208\n6 K\n\nwith\n(3.9)\n\nn\no\nK = k | k(j) = 0 or k(j) = N/2, j = 1, 2, 3 .\n\n3. The elementary particle positions are updated by\n(3.10)\n\nXn+1,[j] \u2212 Xn,[j] =\n\nX\nm\n\n\u03b4a (xm \u2212 Xn,[j] )\u0393nm \u2206x3 ,\n\n\f8\n\nP. ATZBERGER, P. KRAMER\n\nwhere \u0393nm is the time integrated velocity field of the fluid. It is obtained by\na discrete Inverse Fast Fourier Transform (IFFT) of appropriately generated\nrandom variables \u0393\u0302nk in Fourier space:\n\u0393nm\n\n(3.11)\n\n=\n\ntn+1\n\nZ\n\num (s)ds =\n\ntn\n\nX\nk\n\n\u0393\u0302nk * exp (i2\u03c0k * m/N ) .\n\nThe \u0393\u0302nk are computed from\nn\n\n\u22a5\n\u0393\u0302nk = \u0124k + c1,k \u2118\u22a5\nk \u039e\u0302k + c2,k \u2118k \u011ck ,\n\n(3.12)\nn\n\nwhere \u039e\u0302k is obtained from step 2 and \u0124k is computed from steps 1 and 2 by\n(3.13)\n1 \u2212 exp (\u2212\u03b1k \u2206t) n\n\u0124k =\n\u00fbk +\n\u03b1k\n\n\u2206t\n+\n\u03b1k\n\n\u0012\n\n1\n\u03b1k\n\n\u00132\n\n!\n\nn\n(exp (\u2212\u03b1k \u2206t) \u2212 1) \u03c1\u22121 \u2118\u22a5\nk f\u0302k .\n\nThe random variable \u011ck is computed from scratch for each mode k by generating a complex vector-valued random variable having independent real and\nimaginary components, each of which are Gaussian random variables with\nmean zero and variance one. The constants in 3.12 are given by\n\u0013\n\u0012\n\u03b1k \u2206t\n1\n(3.14)\ntanh\nc1,k =\n\u03b1k\n2\nand\n(3.15)\n\nc2,k =\n\ns\u0012\n\n2Dk\n\u03b13k\n\n\u0013\u0012\n\u0012\n\u0013\u0013\n\u03b1k \u2206t\n\u03b1k \u2206t \u2212 2 tanh\n.\n2\n\nIn this manner the time integrated velocity field is consistently generated\nwith the correct correlations with {unk } and {un+1\n} from steps 1 and 2. For\nk\nmore details, see Subsections 3.3.5 and 3.3.6.\nThe computational complexity of the method, when excluding the application specific\nforces acting on the immersed structures, is dominated by the FFT and IFFT, which\nfor a three dimensional lattice requires O(N 3 log(N )) arithmetic steps.\n3.2. Heuristic Discussion of the Numerical Method. We now briefly discuss each step of the numerical scheme to give some intuition into how the method\noperates. A more rigorous mathematical discussion and derivation is given in Subsection 3.3.\nThe first step of the numerical scheme computes the structural forces exerted\nby the elementary particles as a function of their configuration, and computes the\ndiscrete Fourier transform of the corresponding force density field acting on the fluid.\nThe second step updates the fluid velocity in Fourier space by integrating over the\nstructural forces and thermal forces experienced over a time step. The appearance\nof the time step \u2206t in exponential factors is due to the design of the method to\nmaintain accuracy even if the fluid dynamics are partially resolved or underresolved\nby the time step, as in \"exponential time differencing\" schemes (30; 36; 42). The key\ntime scale paired against the time step in these formulas is 1/\u03b1k , which describes the\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n9\n\ntime scale of viscous damping of the Fourier mode k of the fluid, as simulated by the\nnumerical method. The first term of the stochastic recurrence equation 3.4 represents\nthe viscously dissipated contribution of the fluid velocity from the previous time step.\nThe second term represents the contribution from the structural forces during the time\nstep. Since the elementary particle dynamics are assumed to be resolved by the time\nstep, the structural force density itself appears in a simple way as effectively constant\nover the time step. The response of the fluid velocity to this force has an exponential\ndependence on the time step to account for the possible levels of resolution of the\nviscous damping. The third term accounts for the thermal\nfluctuations over the time\nn\nstep through a mean zero Gaussian random variable \u039e\u0302k with variance \u03c3k2 describing\nthe magnitude of the net contribution of the thermal fluctuations to the fluid velocity\nover the time step, see equation 3.6. Note that for time steps \u2206t long compared to\nthe relaxation time 1/\u03b1k of the velocity Fourier mode, the variance approaches the\nconstant value kB T /(\u03c1L3 ) corresponding to the equilibrium equipartition value. On\nthe other hand, for \u2206t \u226a 1/\u03b1k , the variance of the thermal velocity increment\nis\n\u221a\nproportional to \u2206t, so the magnitude of the increment is proportional to \u2206t. This\nlatter scaling is typical for the response of physical systems to noise driven by a large\nnumber of weak inputs (i.e., molecular fluctuations) (44). In both the second and third\nterms, the projection \u2118\u22a5\nk enforces the incompressibility of the fluid. The distinction\nin the definition of the factor Dk with respect to wavenumbers k, as specified by\nthe set K, is a purely technical issue related to the discrete Fourier transform; see\nSubsection 3.3.3.\nThe third step of the numerical method updates the positions of the elementary\nparticle positions composing the immersed structures. The random variable \u0393nm represents the fluid velocity at lattice point xm integrated over the time step, and is\ngenerated in Fourier space using a procedure which also ensures that the immersed\nstructures move with the correct correlations with the previously computed fluid velocity values \u00fbnk and \u00fbn+1\n. The formulas defining \u0393nm arise from an exact formula\nk\nfor integrating the fluid velocity over a time step, under the assumption that the\nstructural forces can be treated as constant over the time step.\n3.3. Derivation of the Numerical Method. The derivation first considers a\nspatial discretization of equation 2.1 while leaving the system of equations continuous\nin time to avoid technical issues associated with the continuum formulation of the\nstochastic immersed boundary method with thermal forcing (46). Since the equations\nare meant to serve as a physical model for the dynamics of the immersed structures and\nfluid, a thermal forcing is derived for the semi-discretized system which is consistent\nwith equilibrium statistical mechanics in Subsection 3.3.3. The time discretization of\nthe numerical method for both the dynamics of the fluid and immersed structures is\nthen discussed in Subsection 3.3.4 and Subsection 3.3.5. The method takes special\ncare to account for correlations between the dynamics of the fluid and immersed\nstructures, which is discussed in Subsection 3.3.6. We remark that throughout the\nderivation, the integration steps of the numerical method are designed to maintain\naccuracy even when the time step does not fully resolve the dynamics of the fluid\nmodes.\n3.3.1. Semi-discretization. The equations 2.1 and 2.2 can be discretized in\nspace by finite difference approximations for the spatial derivatives (64)\n(3.16)\n\n(l)\n(l)\n(l)\n3\n(l)\nX\num\u2212eq (t) \u2212 2um (t) + um+eq (t)\ndum\n=\u03bc\n\u03c1\ndt\n\u2206x2\nq=1\n\n\f10\n\nP. ATZBERGER, P. KRAMER\n\n\u2212\n\npm+el \u2212 pm\u2212el\n(l)\n+ ftotal (xm , t)\n2\u2206x\n\n(l)\n(l)\n3\nX\num+el (t) \u2212 um\u2212el (t)\n= 0,\n2\u2206x\n\n(3.17)\n\nl=1\n\nwhere el denotes the standard basis vector with all zero entries except for a one in\nthe lth position. The parenthesized superscripts denote the vector component.\nThe equations for the fluid-particle coupling become\n(3.18)\n\nfprt (xm , t) =\n\nM\nX\n\nj \u2032 =1\n[j]\n\n(3.19)\n(3.20)\n\n\u2032\n\n\u2212(\u2207X[j\u2032 ] V )({X(t)}) \u03b4a (xm \u2212 X[j ] (t))\n\ndX (t)\n= U(X[j] (t), t)\ndt\nX\nU(x, t) =\n\u03b4a (xm \u2212 x)u(xm , t)\u2206x3 .\nm\n\nSince we do not take the limit a \u2192 0 as the meshwidth is refined (see above),\nU(X[j] (t), t) does not become the same as u(X[j] (t), t), even in the limit \u2206x \u2192 0.\nThat is, we are not simply evaluating the fluid velocity at X[j] (t), but instead averaging it over a region of width determined by the parameter a. This averaging\nprocedure ensures that the particle velocity remains finite and well-defined in the continuum limit, in which the pointwise values of the thermally fluctuating fluid velocity\ndiverge. Indeed, according to general statistical mechanical principles for continuum\nfields (47; 49; 70) (and not from any feature particular to the numerical method), the\nthermally fluctuating fluid velocity field manifests increasingly wilder fluctuations on\nsmaller scales, and in the theoretical continuum limit approaches a sort of white noise\nstructure. This is not inherently problematic for physical interpretation, which only\nrequires that meaningful values be obtained from averages over finite volumes, such\nas the size of a probe or an immersed structure. Such averages are indeed finite, as\ncan be understood intuitively through central limit theorem considerations by viewing\nthem as averages of a large number of independent mean zero random variables due\nto the rapid spatial decorrelation of the noisy continuum velocity field. From a more\nmathematical standpoint, an application of the convolution theorem to the definition\nof U in (3.18) yields that U can be represented as a nicely convergent Fourier series\ndue to the decay of the Fourier coefficients of the smooth function \u03b4a .\nTo obtain other desirable behaviors, we also remark that it is important that we\nuse the same weight function \u03b4a in averaging the fluid velocity as we do in applying\nforce to the fluid, since this ensures that energy is properly conserved in the fluidparticle interaction. With appropriate care in the construction of \u03b4a , one can further\nensure that momentum and angular momentum are conserved as well; see (64).\n3.3.2. Fluid Equations in Fourier Space. The Stokes equation is given in\nFourier space by\n(3.21)\n(3.22)\n\nd\u00fbk\n= \u2212\u03b1k \u00fbk \u2212 i\u03c1\u22121 p\u0302k \u011dk + \u03c1\u22121 f\u0302total,k\ndt\n\u011dk * \u00fbk = 0,\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n11\n\nwhere\n(3.23)\n\n(3.24)\n\n\u03b1k =\n\n3\n2\u03bc X\n(1 \u2212 cos(2\u03c0k(j) /N )))\n\u03c1\u2206x2 j=1\n(j)\n\n\u011dk = sin(2\u03c0k(j) /N )/\u2206x.\n\nSince the velocity field of the fluid is real-valued, a further condition that must\nbe satisfied by solutions of the equations 3.21 - 3.22 is\n(3.25)\n\n\u00fbN\u2212k = \u00fbk ,\n\nwhere N is shorthand for (N, N, N )T and the overbar denotes complex conjugation.\nProvided the force is real-valued, it can be shown that if this constraint holds for the\ninitial conditions it will be satisfied for all time.\nThe Fourier coefficients p\u0302k (t) of the pressure need to be chosen in order to ensure\nthat the incompressibility constraint is satisfied. They can be determined by projecting both sides of equation 3.21 onto \u011dk . By the incompressibility constraint 3.22,\nboth of the terms involving \u00fbk and its time derivative are zero under the projection.\nThis gives at each time\n(3.26)\n\np\u0302k (t) =\n\ni\u011dk * f\u0302total,k (t)\n.\n|\u011dk |2\n\nFor those values of k that make \u011dk = 0, the incompressibility constraint is trivial,\nand by convention we shall take p\u0302k (t) = 0 for such k.\nFor future reference, let the projection in the direction \u011dk be denoted by\nk\n\n(3.27)\n\n\u2118k =\n\n\u011dk \u011dkT\n|\u011dk |2\n\nand the projection orthogonal to \u011dk be denoted by\n\u0012\n\u0013\n\u011dk \u011dkT\n\u22a5\n\u2118k = I \u2212\n(3.28)\n.\n|\u011dk |2\nFor those modes for which \u011dk = 0, the corresponding projections will be understood\nk\nto be defined \u2118k = 0 and \u2118\u22a5\nk = I. The set of indices on which \u011dk = 0 is given by\nn\no\n(3.29)\nK = k | k(j) = 0 or k(j) = N/2, j = 1, 2, 3 .\n\nFor a function wm defined over the discrete lattice sites indexed by m, the corresponding projection operations in physical space are given by\nX k\n(\u2118k w)m =\n\u2118k \u0175k exp (i2\u03c0k * m/N )\n(3.30)\nk\n\nand\n(3.31)\n\n(\u2118\u22a5 w)m =\n\nX\nk\n\n\u2118\u22a5\nk \u0175k exp (i2\u03c0k * m/N ) .\n\n\f12\n\nP. ATZBERGER, P. KRAMER\n\n3.3.3. Thermal Forcing. Following standard practice in nonequilibrium statistical mechanics (47; 70), the thermal fluctuations of the system are modeled as\nGaussian white noise. Formally, the Fourier coefficients of the thermal forcing can be\nwritten as\n(3.32)\n\nf\u0302thm,k = \u03c1\n\np\ndB\u0303k (t)\n.\n2Dk\ndt\n\nThe factor Dk (which is to be specified) describes the strength of the thermal forcing of\nthe kth mode and B\u0303k (t) denotes a complex-valued Brownian motion with the real and\nimaginary parts of each component consisting of an independent standard Brownian\nmotion (44). The dependence on k will be discussed below.\nStandard Brownian motion B(t) for our purposes will refer to the continuous\nstochastic process which is defined by the following properties:\n(i)\n(ii)\n(iii)\n(iv)\n\nB(0) = 0,\nE\u0010\n(B(t2 ) \u2212 B(t1 )) =\u00110,\n2\nE |B(t2 ) \u2212 B(t1 )| = |t2 \u2212 t1 |,\nThe increments B(t2 ) \u2212 B(t1 ) and B(t4 ) \u2212 B(t3 ) are\nindependent Gaussian random variables whenever t1 < t2 \u2264 t3 < t4 ,\n\nwhere E (*) denotes the expected value. Standard Brownian motion in d dimensions\nis defined as a stochastic process where each vector component is an independent onedimensional Brownian motion. For a further discussion of the properties of Brownian\nmotion and related technical issues, see (59) or (31).\nThe discretized Stokes equation 3.21 with only thermal forcing (no immersed\nstructural forces) can be expressed in stochastic differential notation as\n(3.33)\n(3.34)\n(3.35)\n\np\n\u0003\n\u0002\nd\u00fbk = \u2212\u03b1k \u00fbk \u2212 i\u03c1\u22121 p\u0302k \u011dk dt + 2Dk dB\u0303k (t)\n\u011dk * \u00fbk = 0\n\u00fbN\u2212k = \u00fbk ,\n\nwhere dB\u0303k (t) denotes increments of the complex-valued Brownian motion associated\nwith the kth mode. To ensure that the thermal forcing be real-valued, the Brownian\nincrements are correlated in k by the constraint\n(3.36)\n\ndB\u0303N\u2212k = dB\u0303k .\n\nAs discussed in Section 3.3.2, the pressure can be expressed in terms of the force\nacting on the fluid using 3.26. By formal substitution into 3.33, the incompressibility\nconstraint can be incorporated through an appropriate projection operation which\nallows for the two equations 3.33 and 3.34 to be expressed as the single equation\np\n(3.37)\nd\u00fbk + \u03b1k \u00fbk dt = 2Dk \u2118\u22a5\nk dB\u0303k (t).\n\nSince the incompressibility constraint is equivalent to \u2118\u22a5\nk \u00fbk = \u00fbk , the constraint\nwill be satisfied for all time provided it holds at the initial time. Consequently, when\n\u011dk 6= 0 (k 6\u2208 K as defined in 3.29), the real and imaginary part of the stochastic process\n\u00fbk (t) remain in the plane orthogonal to \u011dk for all time. When \u011dk = 0 (k \u2208 K), no\nconstraint is imposed on the real part, but the real-valuedness condition 3.25 requires\nthat the imaginary component vanish.\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n13\n\nEquation 3.37 can be solved by the method of integrating factors to obtain\nZ t\np\n\u00fbk (t) = 2Dk \u2118\u22a5\n(3.38)\ne\u2212\u03b1k (t\u2212s) dB\u0303k (s).\nk\n\u2212\u221e\n\nSince \u00fbk (t) is the projection of an Ito integral with deterministic integrand, it is at\neach time t a Gaussian random variable with mean zero.\nThe variance of \u00fbk (t) can be computed from 3.38 by\n\u0010 \u0010\n\u0011\u0011\n\u0001\nT\n(3.39) E |\u00fbk |2 = Tr E \u00fbk \u00fbk\n\u0012 Z t Z t\n\u0010\n\u0011\u0013\n\u2212\u03b1k (2t\u2212s\u2212s\u2032 )\nT (s\u2032 )\n= 2Dk Tr \u2118\u22a5\ne\nE\nd\nB\u0303\n(s)d\nB\u0303\n.\nk\nk\nk\n\u2212\u221e\n\n\u2212\u221e\n\nTo proceed further, we must distinguish between the cases k \u2208 K and k 6\u2208 K, where\nK is defined in 3.29.\nFor k \u2208 K, we have \u2118\u22a5\nk = I and from constraint 3.36 that the Brownian motion\nB\u0303k (s) is real valued. Therefore,\n\u0011\n\u0010\n(3.40)\nE dB\u0303k (s)dB\u0303Tk (s\u2032 ) = I\u03b4(s \u2212 s\u2032 )dsds\u2032 ,\nand it follows that\n\n(3.41)\n\n\u0001 3Dk\nE |\u00fbk |2 =\n\u03b1k\n\nwhen k \u2208 K.\nFor k 6\u2208 K, the Brownian motion is complex valued and \u2118\u22a5\nk is a projection onto\nthe two-dimensional subspace orthogonal to \u011dk . Therefore,\n\u0011\n\u0010\n\u2032\n\u2032\n(3.42)\nE dB\u0303k (s)dB\u0303Tk (s\u2032 ) = 2\u2118\u22a5\nk \u03b4(s \u2212 s )dsds\nand\n\n(3.43)\nfrom which it follows that\n(3.44)\n\n\u0001\nTr \u2118\u22a5\nk = 2,\n\u0001 4Dk\nE |\u00fbk |2 =\n\u03b1k\n\nfor k 6\u2208 K. We remark that the formal calculations above can be justified rigorously\nby applying Ito's Isometry directly to equation 3.39; see reference (59).\nTo determine Dk , we shall now compare these results with those that are obtained\nif we impose the condition that the immersed boundary method exhibit fluctuations\ngoverned by the Boltzmann distribution, as required by classical statistical mechanics.\nBy Parseval's Lemma, the total kinetic energy can be expressed in terms of the Fourier\nmodes of the fluid by\n\u03c1X\n(3.45)\n|um |2 \u2206x3\nE[{uk }] =\n2 m\n\u03c1X\n=\n|\u00fbk |2 L3 .\n2\nk\n\n\f14\n\nP. ATZBERGER, P. KRAMER\n\nThe density of the Boltzmann distribution is then given by\nP\n\u0013\n\u0012\n\u03c1L3 k |\u00fbk |2\n1\n\u03a8\u0303({\u00fbk }) = exp \u2212\n(3.46)\n,\n2kB T\nZ\u0303\nwhere Z\u0303 is the partition function obtained by integrating \u00fbk over the constrained\nsubspace\n(3.47)\n\n\u03a9 = {{\u00fbk} | \u011dk * \u00fbk = 0, \u00fbN\u2212k = \u00fbk }.\n\nEach degree of freedom of the fluid contributes a quadratic term to the energy of the\nsystem, giving a Boltzmann distribution which is Gaussian. Therefore, the equipartition theorem holds and each independent degree of freedom contributes on average\n1\n2 kB T to the kinetic energy.\nFor a particular wavenumber k \u2208 K, the mean contribution to the energy is\n\u03c1L3 3Dk\n,\n2 \u03b1k\n\u0001\nwhere the expression 3.41 for E |\u00fbk |2 has been used. For such wavenumbers there\nare 3 independent degrees of freedom corresponding to the 3 real components of \u00fbk .\nBy the equipartition theorem this requires\n(3.48)\n\n(3.49)\n\n3\n\u03c1L3 3Dk\n= kB T,\n2 \u03b1k\n2\n\nwhich gives\nDk = \u03b1k\n\n(3.50)\n\nkB T\n\u03c1L3\n\nwhen k \u2208 K.\nFor k 6\u2208 K, we must consider the pair (k, N \u2212 k) together, since \u00fbk = \u00fbN\u2212k . The\ncontribution to the mean energy of these two wavenumbers is\n\u03c1L3 4Dk\n,\n2 \u03b1k\n\u0001\n\u0001\nwhere the expression 3.44 for E |\u00fbk |2 and E |\u00fbN\u2212k |2 has been used. The number\nof independent degrees of freedom corresponding to the pair of wavenumbers (k, N\u2212k)\nis 4, since the real vector space orthogonal to \u011dk is two-dimensional and \u00fbk is complex\nvalued.\nThe equipartition theorem in this case requires that\n2\n\n(3.51)\n\n(3.52)\n\n2\n\n4\n\u03c1L3 4Dk\n= kB T,\n2 \u03b1k\n2\n\nwhich gives\n(3.53)\nwhen k 6\u2208 K.\n\nDk = \u03b1k\n\nkB T\n2\u03c1L3\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n15\n\nTo summarize, the following fluctuation-dissipation relation (47; 70) is obtained\nwhen considering the constraints 3.25 and 3.22 imposed on the velocity field of the\nfluid:\n(\nkB T\n,k\u2208K\n\u03c1L3 \u03b1k\nDk =\n(3.54)\nkB T\n\u03b1\n,\nk 6\u2208 K.\n3\nk\n2\u03c1L\nWe remark that the Fourier mode of the fluid associated with k = [0, 0, 0]T\ncorresponds to translation of the fluid as a whole. From 3.23 the zero mode has\n\u03b10 = 0, which indicates that the fluid has no translational damping. As a consequence\nof 3.54 the mode \u00fb0 is not thermally forced, which can also be understood physically\nby the conservation of total momentum by the internal thermal fluctuations. Thus\nfor a fluid initially at rest with no net external force on the fluid as a whole, the\ntranslational mode remains zero \u00fb0 = 0 under the thermal forcing.\n3.3.4. Numerical Method for the Fluid. To deal with the significant range\nin time scales for the modes of the fluid and immersed structures, we develop a timestepping scheme that freezes the positions and forces exerted by the elementary particles over a time step \u2206t, but otherwise integrates the dynamical equations exactly.\nWith this approximation the set of equations 3.37 can be solved analytically using\nthe methods of stochastic calculus (59). This strategy has similarities to \"exponential\ntime differencing\" or \"exact linear part\" numerical methods (30; 36; 42).\nIn stochastic differential notation, the fluid equations with both thermal and\nparticle forces can be expressed as\np\n(3.55)\n2Dk \u2118\u22a5\nd\u00fbk = \u2212\u03b1k \u00fbk dt + \u03c1\u22121 \u2118\u22a5\nk dB\u0303k (t),\nk f\u0302k dt +\nwhere to simplify the notation the subscript will be dropped for the Fourier modes of\nthe particle force density so that f\u0302k always refers to f\u0302prt,k .\nApproximating the particle force as constant over the time interval [t\u2032 , t] gives\n(3.56)\n\n\u0011\n\u2032\n\u2032\n1 \u0010\n\u2032\n1 \u2212 e\u2212\u03b1k (t\u2212t ) \u2118\u22a5\n\u00fbk (t) = e\u2212\u03b1k (t\u2212t ) \u00fbk (t\u2032 ) +\nk f\u0302k (t )\n\u03c1\u03b1k\nZ t\np\n+ 2Dk\ne\u2212\u03b1k (t\u2212s) \u2118\u22a5\nk dB\u0303k (s),\nt\u2032\n\nR \u22a5\nwhere \u2118\u22a5\n*\u2118k dB\u0303k (s) denotes intek is the projection operation defined in 3.28 and\ngration in the sense of Ito (59) over the projected complex-valued Brownian motion\nB\u0303k (t) defined in Section 3.3.3.\nTo obtain a numerical scheme for the fluid with finite time step \u2206t, each mode is\nupdated at discrete times n\u2206t using the analytic solution 3.56, yielding the stochastic\nrecurrence equation\n(3.57)\n\n\u00fbn+1\n= e\u2212\u03b1k \u2206t \u00fbnk +\nk\n\n\u0001\n1\nn\n\u22a5 n\n1 \u2212 e\u2212\u03b1k \u2206t \u2118\u22a5\nk f\u0302k + \u2118k \u039e\u0302k ,\n\u03c1\u03b1k\nn\n\nwhere \u00fbnk = \u00fbk (n\u2206t), f\u0302kn = f\u0302k (n\u2206t), and \u039e\u0302k = \u03c3k \u03b7\u0303 k .\nThe notation \u03b7\u0303 k denotes a three dimensional complex-valued random variable,\nwith each real and imaginary component being an independent Gaussian random\nn\nvariable with mean 0 and variance 1. The random variable \u039e\u0302k accounts for the\n\n\f16\n\nP. ATZBERGER, P. KRAMER\n\ncontributions of the stochastic integral in 3.56 over the time step. The variance \u03c3k2\ncan be determined by Ito's Isometry (59) and is given by\n(3.58)\n\n\u03c3k2 =\n\n\u0001\nDk\n1 \u2212 e\u22122\u03b1k \u2206t .\n\u03b1k\n\nThe constraint 3.25 that ensures the real-valuedness of the velocity field is respected by only applying the update 3.57 to one member of each complex-conjugate\npair, and then setting the new value for the partner mode as the complex conjugate of\nthe computed mode. The condition 3.25 also requires that the modes \u00fbk with indices\nk \u2208 K have zero imaginary part; this is enforced explicitly in each time step.\n3.3.5. Numerical Method for the Immersed Structures. A time-discretization\nfor the equation (3.19) is developed for the advection of the elementary particles by\nintegrating the fluid velocity field over a time step and then averaging the integrated\nvelocity over a spatial neighborhood centered on the old particle position:\n(3.59)\n\nXn+1,[j] \u2212 Xn,[j] =\n\nX\nm\n\n\u03b4a (xm \u2212 Xn,[j] )\n\nZ\n\ntn+1\n\num (s)ds\u2206x3 ,\n\ntn\n\nwhere tn = n\u2206t and Xn,[j] = X[j] (n\u2206t).\nA precise integration of the fluid velocity u is taken which allows for time steps\nwhich underresolve the dynamics of some of the Fourier modes of the fluid. This\ncapability is important due to the wide range of time scales that may be associated\nwith the fluid modes and immersed structures in applications. If the time integral is\napproximated through numerical methods built from (stochastic) Taylor expansions\nabout discrete times, such as Runge-Kutta methods and their stochastic variations\n(44; 80), then it is important that the method sufficiently resolve the fluctuations\nof the processes to capture cancellations that occur over time. For instance, if the\ncancellation is not adequately captured, the numerical value of the integral of velocity\nwill be larger in magnitude than the actual time integrated velocity. For immersed\nparticles, this leads to an overly diffuse behavior where the particles overshoot their\ncorrect positions each time step.\nFrom 3.37 the time scale associated with the dynamics of the kth mode of the\nfluid is 1/\u03b1k. For the fastest modes of the fluid relevant for the immersed particle\ndynamics, the above considerations would place a severe restriction on the time step.\nWhile there may be clever numerical methods involving (stochastic) Taylor expansions\nwhich perform better than anticipated, a different approach will be taken here.\nTo develop a method that remains accurate for a range of time steps, from those\nthat fully resolve, partially resolve, or completely underresolve the fluid modes, we\ncalculate the time integral in 3.59 by substitution of the analytical expression 3.56 for\nthe Fourier modes of the fluid velocity field. We recall that this approximation only\nassumes that the elementary particle positions and forces can be considered frozen\nover a time step. The resulting numerical scheme can therefore be expected to be\naccurate provided the time step \u2206t is chosen small compared to the time scales of\nthe immersed structures, but with no restriction on the size of the time step relative\nto the time scales of the fluid modes. We will explain this property more precisely\nthrough numerical error analysis in Section 4.\nIn updating the elementary particle positions in the numerical method, the time\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n17\n\nintegral in 3.59 will be simulated as a random variable\nZ tn+1\nX\num (s)ds =\n(3.60)\n\u0393\u0302nk exp (i2\u03c0k * m/N ) ,\n\u0393nm =\ntn\n\nk\n\n\u0393\u0302nk\n\n(3.61)\n\n=\n\nZ\n\ntn+1\n\n\u00fbk (s)ds,\ntn\n\nwith \u00fbk (s) given by (3.56).\nBy using standard techniques from stochastic calculus, the time integral can be\nevaluated by defining \u0393\u0302nk to give the Gaussian random variable\n(3.62)\n\u0393\u0302nk\n\n!\n\u0012 \u00132\n\u0001 \u22121 \u22a5 n\n\u2206t\n1\ne\u2212\u03b1k \u2206t \u2212 1 n\n\u2212\u03b1k \u2206t\n+\n\u00fbk +\ne\n\u2212 1 \u03c1 \u2118k f\u0302k\n=\u2212\n\u03b1k\n\u03b1k\n\u03b1k\n\u221a\n\u221a\nZ\n\u0011\n2Dk tn+1 \u2212\u03b1k (tn+1 \u2212r) \u22a5\n2Dk \u0010 \u22a5\n\u2212\n\u2118k B\u0303k (tn+1 ) \u2212 \u2118\u22a5\nB\u0303\n(t\n)\n.\ne\n\u2118k dB\u0303k (r) +\nk\nn\nk\n\u03b1k\n\u03b1k\ntn\n\nUsing 3.56 at times n\u2206t and (n + 1)\u2206t, this can be expressed more simply as\n\u0001\n1\n\u2118\u22a5 f\u0302 n\n\u0393\u0302nk = \u2212\n\u00fbn+1\n\u2212 \u00fbnk + \u03c1\u22121 k k \u2206t\nk\n\u03b1\n\u03b1k\n\u221a k \u0010\n\u0011\n2Dk\n\u22a5\n\u2118\u22a5\nB\u0303\n(t\n)\n\u2212\n\u2118\nB\u0303\n(t\n)\n.\n+\nk\nn+1\nk\nn\nk\nk\n\u03b1k\n\n(3.63)\n\nThe numerical scheme to update the elementary particle positions is then given\nby\nXn+1,[j] \u2212 Xn,[j] =\n\n(3.64)\n\nX\nm\n\n\u03b4a (xm \u2212 Xn,[j] )\u0393nm \u2206x3 ,\n\n\u0393nm\n\nwhere\nis generated each time step. To consistently update the particle positions\nwith the velocity field of the fluid it is required that \u0393\u0302nk be generated with the correct\ncorrelations to the fluid modes at the beginning and end of each time step, {unk } and\n{un+1\n}. In the next Subsection, a practical approach for doing so is presented.\nk\n3.3.6. Method for Generating Modes of the Time Integrated Velocity\nField. Since the modes \u0393\u0302nk of the time integrated velocity field and the modes \u00fbnk\nand \u00fbn+1\nof the velocity field evaluated at the beginning and end of a time step are\nk\nnot statistically independent, some care must be taken in generating the corresponding random variables that are used in the simulation. Since \u0393\u0302nk , \u00fbnk , and \u00fbn+1\nare\nk\njointly Gaussian distributed random variables with mean zero, we need only ensure\nthey have the correct covariances between their components. Since the real and imaginary parts of each mode are independent, we shall for clarity consider only the real\ncomponents with the understanding that the imaginary components are handled in a\nsimilar manner.\nIn deriving a method to generate the time integrated field, it is useful to express\nthe real part Re(\u0393\u0302nk ) in terms of the following random variables\n(3.65)\n\n\u22a5\n\u22a5\nRe(\u0393\u0302nk ) = \u2118\u22a5\nk A0 + \u2118k A1 + \u2118k A2 ,\n\n\f18\n\nP. ATZBERGER, P. KRAMER\n\nwith\n!\n\u0012 \u00132\n\u0001 \u22121\n1 \u2212 e\u2212\u03b1k \u2206t\n\u2206t\n1\nn\n\u2212\u03b1k \u2206t\n(3.66) A0 =\nRe(\u00fbk ) +\n+\ne\n\u2212 1 \u03c1 Re(f\u0302kn )\n\u03b1k\n\u03b1k\n\u03b1k\n\u221a\nZ\n2Dk tn+1 \u2212\u03b1k (tn+1 \u2212s)\n(3.67) A1 = \u2212\ne\nRe(dB\u0303k (s))\n\u03b1k\ntn\n1\n= \u2212 \u039enk\n\u03b1k\n\u221a\n\u0010\n\u0011\n2Dk\nRe B\u0303k (tn+1 ) \u2212 B\u0303k (tn )\n(3.68) A2 =\n\u03b1\n\u221a k Z tn+1\n2Dk\n=\nRe(dB\u0303k (s)).\n\u03b1k\ntn\nThe random variables were obtain by reorganizing the terms of 3.62.\nThis expression recasts the problem of determining the correlations of Re(\u0393\u0302nk ) to\nthe problem of determining the correlations of A0 , A1 and A2 with each other and\nthe modes of the fluid velocity. A convenient feature of this approach is that A0 is\nalready determined at the beginning of the time step, and is statistically independent\nof A1 and A2 by the independent increment property of Brownian motion. This\nreduces the problem to finding the covariance of A1 and A2 . A useful identity for Ito\nintegrals in this context is (59)\n\u0012Z t\n\u0013 Z t\nZ t\nE\n(3.69)\nf (s)g(s)ds,\nf (s)dBs\ng(r)dBr =\n0\n\n0\n\n0\n\nwhere the notation E(*) denotes expectation with respect the underlying Brownian\nmotion (59).\nUsing 3.69, the covariance is given by\n(3.70)\n\n(j)\n\n(j)\n\nE(A1 A2 ) = \u2212\n\n2Dk\n(1 \u2212 exp (\u2212\u03b1k \u2206t)) ,\n\u03b13k\n\nwhere the parenthesized superscripts denote the indices of the vector components.\n(j)\n(j \u2032 )\nWhen j 6= j \u2032 the components A1 and A2 are independent and have zero correlation.\nThe variance of the components of A1 and A2 are given by\n(3.71)\n(3.72)\n\nDk\n(1 \u2212 exp (\u22122\u03b1k \u2206t))\n\u03b13k\n2Dk\n(j)\nE(|A2 |2 ) = 2 \u2206t.\n\u03b1k\n(j)\n\nE(|A1 |2 ) =\n\nFrom the numerical updating of the fluid variables described in Subsection 3.3.4,\nA1 = \u2212 \u03b11k \u039enk is already known each time step, so only A2 need be generated. Obtaining this random variable with the correct correlations can be accomplished by\ngenerating new standard Gaussian random variables \u03b7(j) (independent in j with mean\n0 and variance 1) and by taking the linear combination of the two random variables\n(j)\nA1 and \u03b7 (j) given by\n(3.73)\n\n(j)\n\n(j)\n\nA2 = a1 A1 + a2 \u03b7 (j) ,\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n19\n\nwith\n\u0011\n\u0010\n(j) (j)\nE A1 A2\n\u0010\n\u0011\na1 =\n(j)\nE |A1 |2\n\n(3.74)\nand\n\n(3.75)\n\nv\nu \u0010\n\u00112\n\u0011\n\u0010\n\u0011 \u0010\nu\n(j) (j)\n(j)\n(j)\nu E |A1 |2 E |A2 |2 \u2212 E A1 A2\n\u0011\n\u0010\n.\na2 = u\nt\n(j)\nE |A1 |2\nn\n\nIn this manner, Re(\u0393\u0302k ) can be generated from A0 , A1 , and A2 with proper\naccounting of correlations with the modes of the velocity field. The imaginary comn\nponent Im(\u0393\u0302k ) is generated in an analogous manner.\n4. Accuracy of the Method. In this section the accuracy of the numerical\nmethod is investigated. Three asymptotic scaling regimes of the time step are considered. The first regime applies when the time step is taken sufficiently small to fully\nresolve the dynamics of the fluid. The second applies when the time step is taken\nlarge and completely underresolves the dynamics of the fluid. We finally consider the\ncase in which the time step resolves some but not all of the fluid modes.\nFormal error estimates are given which show how the numerical errors scale with\nrespect to the time step and various key parameters. While a rigorous analysis making\nuse of standard stochastic Taylor expansion approaches (44) can be carried out for\ntime steps which are small when compared to the time scales of the fluid and immersed\nstructure dynamics, a completely rigorous analysis of the numerical error when the\ntime step is large and underresolves a subset of the fluid modes is considerably more\ndifficult.\nAn important feature of the numerical method is the way in which the statistical contributions of the fluid dynamics are taken into account, even when the fluid\ndynamics are underresolved. As discussed in Subsections 3.3.4 and 3.3.5, the random\nincrements of the elementary particle positions and fluid modes are simulated in such\na way that the correct statistics and correlations are preserved over time steps which\nneed only be small compared to the time scales of the immersed structures. While\nthe time step relative to the time scale of the fastest modes of the fluid may be large,\nthis procedure helps keep the local time discretization error small. By contrast, standard finite difference schemes would generally have poor accuracy once the time step\nexceeded the time scales of the fastest fluid modes.\nTo quantify the accuracy of the method, the strong error is considered, as defined\nin (44). Let X[j] (t) denote the exact solution of equation 3.19 for the elementary\nparticles and \u00fbk (t) denote the exact solution to equation 3.16 for the Fourier modes\nof the velocity field of the fluid. Let the numerically computed trajectories of the\nelementary particles be denoted by X\u0303[j] (t) and the numerically computed fluid modes\n \u0303 k (t). Since we shall be interested in the error associated with a typical\nbe denoted by \u00fb\nelementary particle, the superscript j will be dropped throughout the discussion.\nThe strong error of the numerical method associated with the kth mode of the\nfluid is defined as\n\u0010\n\u0011\n \u0303 k (\u2206t) ,\n\u00eafld,k (\u2206t) = E \u00fbk (\u2206t) \u2212 \u00fb\n(4.1)\n\n\f20\n\nP. ATZBERGER, P. KRAMER\n\nand the strong error associated with an elementary particle is defined as\n\u0010\n\u0011\neprt (\u2206t) = E X(\u2206t) \u2212 X\u0303(\u2206t) .\n(4.2)\n\nThe error associated to the velocity field in physical space is defined as\n!\n1 X\n3\nefld (\u2206t) = E\n(4.3)\n|um (\u2206t) \u2212 \u0169m (\u2206t)| \u2206x .\nL3 m\nFor further discussion of the strong error see (44).\nThe error expressions above and the estimates given below are intended to characterize the \"typical\" error for the numerical method; in reality they will of course\ndepend on the particular configuration the elementary particles happen to be in at\nthe beginning of a time step and the details of the forces acting between them. For\nthe purposes of describing the errors incurred in the numerical method's handling of\nthe force interactions, we shall therefore concern ourselves with describing how the\nerrors scale with respect to the various numerical parameters.\nIn the derivation of the estimates we quantify the error incurred by the numerical\nmethod's representation of the stochastic (thermal) components of the structural and\nfluid dynamics. The estimates presented follow from a systematic formal analysis of\nthe errors resulting from the discretization of the stochastic and deterministic components of the dynamics, including their interaction during a time step. This calculation\nleads to a uniformly valid expression for time steps sufficiently small that the elementary particles do not move appreciably (relative to their size) during a time step; no\nassumption is made in the derivation about the magnitude of the time step relative to\nthe time scales of the fluid modes. As the resulting derivations are somewhat technical, we shall in the present paper be content to state the error estimates, discuss their\nsignificance, and confirm their validity in a few special cases by numerical simulation.\nFor a detailed derivation see (2).\n4.1. Error Estimates for Time Steps which Fully Resolve the Fluid\nDynamics. When the time step is taken sufficiently small so that the dynamics\nof all modes of the fluid are resolved by the stochastic immersed boundary method\n(\u2206t \u226a min \u03b11k ), the following error estimates can be established:\nMF\u2217 \u2217\n\u03b4\n\u03c1 a,k\n\n(4.4)\n\n\u00eafld,k (\u2206t) \u2248\n\n(4.5)\n\nMF\u2217\nefld (\u2206t) \u2248 3/2 3/2\n\u03c1a L\n\n(4.6)\n\n\u0012\n\n\u0012\n\n1\nM\n+C\nlF\na\n\n1\nM\n+C\nlF\na\n\n\u0013\n\n\u0013\n\n(C \u2032 vfrc + C \u2032\u2032 vthm ) \u2206t2\n\n(C \u2032 vfrc + C \u2032\u2032 vthm ) \u2206t2\n\n\u0001 \u2206t2\n2\n2\neprt (\u2206t) \u2248 Q1 vthm\n+ Cvfrc vthm + C \u2032 vfrc\na\n\u0013\n\u0012\nMF\u2217 M\n\u2032\u2032\u2032\n\u2032\u2032\u2032\u2032\n\u2032\u2032 1\n(C vfrc + C vthm ) \u2206t3 ,\n+C\n+\n\u03c1a3\nlF\na\n\nwhere M is the number of elementary particles, F \u2217 is the magnitude of the force\nacting on the elementary particles, and lF is the length scale associated with changes\nin the particle force of order F \u2217 . It will be assumed throughout that a . lF . The\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n21\n\n\u2217\nfactor \u03b4\u0302a,k\nis the magnitude of the Fourier coefficient for mode k of the function \u03b4a ,\n\u2217\naveraged over all shifts (see Appendix B). We remark that \u03b4\u0302a,k\n\u2248 1/L3 for |k| \u226a L/a,\n\u2217\nwhile \u03b4\u0302a,k\ndecays rapidly for |k| \u226b L/a.\nIn this notation the factors C which are superscripted with primes are approximately independent of the physical parameters, and can be thought of as order unity\nconstants. To avoid cumbersome notation and overly emphasizing the role of these\nfactors the notation is reused in each equation, with the understanding that C denotes\ndistinct factors for each estimate. The subscripted factors Q are also approximately\nindependent of the physical parameters. They are distinguished since numerical values will be estimated for these factors in order to make a comparison between the\ntheoretical estimates and numerical simulations in the case that F \u2217 = 0. p\nTo simplify the expressions the following terms are defined vthm = kB T /\u03c1a3\nand vfrc = F \u2217 /\u03bca. The factor vthm can be interpreted via the equipartition theorem\nof statistical mechanics (47; 70) as the velocity scale of thermal fluctuations of an\nelementary particle of size a, since the associated mass will be proportional to \u03c1a3 .\nThe term vfrc can be interpreted as the velocity scale associated with the motion of\na particle of size a in a viscous fluid when a force of magnitude F \u2217 is applied to the\nparticle, since the friction coefficient of a particle is generally proportional to \u03bca (15).\nThe error estimates indicate that the stochastic immersed boundary method has\nstrong first order accuracy as the time step is taken small. An error proportional\nto \u2206t3 is included in eprt (\u2206t) because its coefficient in certain circumstances can\nmake it comparable to the \u2206t2 . We remark that the reported proportionality of\nthe errors with respect to M , the number of elementary particles, is based on a\nworst-case scenario where all M particles are clustered near each other. In general\nthe error is expected to scale with a smaller factor reflecting the actual number of\nparticles clustered in a region. Since this depends on details of the force interaction\nbetween particles, obtaining a more precise error estimate is technically involved and\nsomewhat application dependent. While in practice the actual numerical error will\nlikely be somewhat better than these factors indicate, we leave further refinements to\nfuture work in the context of specific applications.\nAn important observation is that in the absence of forces on the immersed structures (F \u2217 = 0), the fluid modes are simulated exactly (for the reasons discussed\nin Subsection 3.3.4). Only the elementary particle dynamics incur a temporal discretization error in this case (see Subsection 3.3.5), with the strong error incurred\nbeing of first order. A more conventional time stepping scheme based on finite differences would typically incur an error for the velocity mode \u00fbk which includes a\ncontribution which scales as CN \u22123/2 vthm (\u03b1k \u2206t)n+1/2 for some integer n. Such an\nerror fails to remain small compared to the actual velocity change over a time step\nas soon as \u2206t & 1/\u03b1k . For the numerical method developed in Section 3, the exact\nrepresentation of the stochastic fluid dynamics, apart from the response to the forces\nexerted by the immersed structures, maintains better accuracy even as the time step\nunderresolves the fluid dynamics.\nAs demonstrated in Figure 4.1, the theoretical error estimate for the elementary particles agrees well with numerical simulations in the absence of particle forces\n(F \u2217 = 0). The numerical results were obtained from simulations of the fluid-particle\nsystem with physical parameters in Table 4.2. In the comparison, the factors Q were\ncomputed from theoretical expressions arising in the derivation of the estimates, and\ntheir numerical values are given in Appendix D. It should be emphasized that the\nerror estimates are stated as formal approximations, not as upper bounds. In the case\n\n\f22\n\nP. ATZBERGER, P. KRAMER\n\nthat there are particle forces, the discretization error depends on a number of details\nof the force structure, and therefore numerical comparison with simulations is left to\nfuture work in the context of specific applications.\n\u22125\n\nx 10\n12\n\nerror (nm)\n\n10\n8\n6\n4\n2\n0\n0\n\n0.2\n\n0.4\n\u2206t (ns)\n\n0.6\n\n0.8\n\nFig. 4.1. A comparison of the analytic error estimate for the elementary particle positions\neprt (\u2206t) given in equation 4.6 with a numerical estimation of the error for the small to intermediate\ntime step regime \u2206t \u226a \u03c1a2 /\u03bc with F \u2217 = 0 and parameter values given in Table 4.2. The dashed line\ndenotes eprt (\u2206t). The data points denote the error as estimated from numerical simulations using\nthe method. The error bars indicate one standard deviation of the sampled values. To compute\nthe numerical estimates of the error, simulations were performed with each given time step \u2206t\nand compared with an ensemble of reference trajectories obtained from a high resolution simulation\nsufficient to resolve the dynamics of all N 3 modes of the fluid. The high resolution simulation had\na time step of \u2206t = 10\u22123 ns < min 1/\u03b1k , where min 1/\u03b1k = 3.94 \u00d7 10\u22122 ns for the parameter values\ngiven in Table 4.2. From the results, we see that the estimate given in equation 4.6 quantifies the\nerror well for \u2206t \u226a \u03c1a2 /\u03bc = 0.976ns.\n\n4.2. Error Estimates for Time Steps which Underresolve All Fluid\nModes. We now present estimates for the error of the numerical method when the\ntime step is taken large enough to underresolve all modes of the fluid, but always\nsmall enough to resolve the elementary particle dynamics:\n(4.7)\n\nmax\n\n1\n\u226a \u2206t \u226a \u03c4mov (a).\n\u03b1k\n\nThe notation \u03c4mov (a) denotes the time required for an elementary particle to move\na displacement equal to its size a either by advection or diffusion. In this regime the\nfollowing error estimates can be established:\n(4.8)\nM F \u2217 L2 \u2217\n\u03b4\n\u00eafld,k (\u2206t) \u2248\n\u03bc|k|2 a,k\n\n\u0012\n\n1\nM\n+C\nlF\na\n\n\u0013\u0010\n\n\u0011\n\u221a\nC \u2032 vfrc \u2206t + C \u2032\u2032 D\u2206t1/2\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n23\n\n(4.9)\nefld (\u2206t) \u2248\n\nr\n\na MF\u2217\nL \u03bcL\n\n\u0012\n\nM\n1\n+C\nlF\na\n\n\u0013\u0010\n\u0011\n\u221a\nC \u2032 vfrc \u2206t + C \u2032\u2032 D\u2206t1/2\n\n(4.10)\nD\neprt (\u2206t) \u2248 Q2 \u2206t\n\u0012 a\n\u0013\n\u0011\nM\n1 \u0010\u221a\n2\nDvfrc \u2206t3/2 + vfrc\n\u2206t2 ,\n+ C\n+ C\u2032\nlF\na\nwhere D denotes the diffusion coefficient of an immersed particle (see Section 5.1)\nand the factors C and Q denote order unity nondimensional constants as discussed in\nSubsection 4.1. The other terms are the same as in Subsection 4.1.\nThe smaller powers of \u2206t appearing in the error estimates may suggest that the\naccuracy is deteriorating more rapidly with respect to the time step in the underresolved regime under discussion, but in fact the opposite is true. The error estimates\nreported above are in fact, for the range of time steps defining the underresolved\nregime, considerably smaller than the extrapolation of the error estimates in Subsection 4.1 which are valid only for the fully resolved regime. Indeed, the ratio of terms\nappearing in the above estimates to corresponding terms in the equations in Subsection 4.1 involve ratios such as \u03c1L2 /(\u03bc|k|2 \u2206t), D1/2 /(vthm \u2206t1/2 ), and L1/2 a3/2 \u03c1/\u03bc\u2206t,\nall of which are much smaller than one in the asymptotic regime 4.7.\nA more important point is that the numerical errors remain small relative to\nthe changes in the system variables throughout this range of time steps, so that the\nnumerical method maintains accuracy for all \u2206t . \u03c4mov (a). This can be seen by\nobserving that the changes in the system variables over a time step falling in the\nregime 4.7 can be estimated as\n(4.11)\n(4.12)\n(4.13)\n\n\u2217\nM F \u2217 \u03b4a,k\nv\n+ C \u2032 thm\n,\n\u03c1\u03b1k\nN 3/2\n|\u03b4u| \u2248 Cvfrc + C \u2032 vthm ,\n\u221a\n|\u03b4X| \u2248 C D\u2206t + C \u2032 vfrc \u2206t,\n\n|\u03b4 \u00fbk | \u2248 C\n\nwhere the factors C denote order unity nondimensional constants as discussed in\nSubsection 4.1. The notation |\u03b4[*]| indicates the absolute value of an increment of a\nvariable over the time step.\nSince the velocity field of the fluid is completely underresolved, it changes by\nan amount comparable to its equilibrium value independently of the size of the time\nstep. The ratios of the error estimates to the corresponding true changes in the\nsystem \u221a\nvariables in 4.13 can be bounded by sums and products of the nondimensional\ngroups D\u2206t/a, vfrc \u2206t/a, M La , and M laF . The former two nondimensional groups\ninvolving the time step are both small by definition of the constraint \u2206t \u226a \u03c4mov (a)\ndetermining the asymptotic regime 4.7 under consideration. The nondimensional\nparameters M La and M laF will be order unity or smaller when the system involves\na small number of elementary particles. When the system contains a large number\nof elementary particles, these nondimensional groups can become large and the error\n\n\f24\n\nP. ATZBERGER, P. KRAMER\n\nestimates become worse. While it is certainly to be expected that the presence of more\ncomplex structures involving more elementary particles will generally incur more error\nin the numerical simulation, we stress that the scaling of our errors with large M are\nsurely too pessimistic. We therefore do not lay undue emphasis on the behavior of\nthe errors for large M , which in any event will depend heavily on the details of the\nforce structure.\nWe emphasize that unlike traditional numerical analysis the presence of terms\nproportional to \u2206t in the error estimate 4.10 does not imply that the method is\ninconsistent. It must be remembered that these error estimates are appropriate not in\nthe \u2206t \u2193 0 limit, but rather in the asymptotic regime 4.7. A more careful consideration\nof the sizes of the errors relative to the true changes in the system variables over a\ntime step shows that our numerical method does in fact remain accurate for all time\nsteps \u2206t \u226a \u03c4mov (a), even if the fluid modes are underresolved. Vital to this result\nwas the use of the stochastic integral formula 3.56 for the action of the thermal forces\non the velocity field of the fluid, and the systematic consideration in Subsection 3.3.5\nof how to correlate the stochastic component of the velocity field of the fluid with\nthe random motion of the immersed structures. Without these developments, the\nresulting numerical method could not be expected to have good accuracy for time\nsteps in the regime 4.7.\nIn Figure 4.2, the theoretical error estimate 4.10 for the elementary particle positions over a long time step is compared with the results of a numerical simulation\nin the case that there are no particle forces (F \u2217 = 0). The numerical results were obtained from simulations of the fluid-particle system with physical parameters in Table\n4.2. In the comparison, the factors Q were computed from the theoretical analysis\nwith values given in Appendix D. The numerical simulations show good quantitative\nagreement with the formal error estimate 4.10. We remark that the estimate is to be\nunderstood as an approximation and not a rigorous upper bound. This agreement is\nevidence of the validity of the formal analysis. As discussed in Section 4.1, the errors\narising in the presence of forces are not as explicitly quantifiable. We leave further\ndiscussion and verification of the estimates to future work in the context of specific\napplications.\n4.3. Error Estimates for Time Steps which Underresolve Only Some\nFluid Modes. A key feature of the stochastic numerical scheme proposed in this\nwork is that time steps can be chosen which only partially resolve the fluid dynamics.\nThat is, the method need neither resolve all of the velocity modes nor completely\nneglect the inertia of the velocity field (as in Brownian/Stokesian dynamics (15; 22; 75;\n77)). Rather, the time step can be chosen as needed to resolve the appropriate degrees\nof freedom of the fluid-particle system, having the fluid and thermal fluctuations\ninteract appropriately with the structures. The case is now discussed in which the\ntime step \u2206t falls within the intermediate regime\n(4.14)\n\nmin\n\n1\n1\n. \u2206t . max\n,\n\u03b1k\n\u03b1k\n\nwhere the dynamics of the fluid is only partially resolved. It turns out that the error\nestimates for the fully resolved regime (Subsection 4.1) and the underresolved regime\n(Subsection 4.2) each serve separately as formal upper bounds for all time steps,\nincluding the intermediate regime 4.14. Intuitively, then, one expects the numerical\nmethod to behave accurately over this intermediate range of time scales as well. To\nprovide more quantitative support for this statement, error estimates are developed\n\n\f25\n\nSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n12\n\nerror (nm)\n\n10\n8\n6\n4\n2\n0\n0\n\n0.5\n\n1\n\n1.5\n\u2206t (ns)\n\n2\n\n2.5\n4\n\nx 10\n\nFig. 4.2. A comparison of the analytic error estimate for the elementary particle positions\neprt (\u2206t) given in equation 4.10 with a numerical estimation of the error for the large time step\nregime max 1/\u03b1k \u226a \u2206t \u226a \u03c4mov with F \u2217 = 0 and parameter values given in Table 4.2. The dashed\nline denotes eprt (\u2206t). The data points denote the error as estimated from numerical simulations\nusing the method. The error bars indicate one standard deviation of the sampled values. To compute\nthe numerical estimates of the error, simulations were performed with each given time step \u2206t and\ncompared with an ensemble of reference trajectories obtained from a high resolution simulation with\na time step of \u2206t = 1.0ns < max 1/\u03b1k where max 1/\u03b1k = 25.4ns for the parameter values given in\nTable 4.2. From the results, we see that the estimate given in equation 4.10 quantifies the error well\nfor max 1/\u03b1k \u226a \u2206t \u226a \u03c4mov , where \u03c4mov \u2248 a2 /D = 1.95 \u00d7 105 ns.\n\nfor the asymptotic regime\n1\n\u03c1a2\n.\n\u226a \u2206t \u226a max\n\u03bc\n\u03b1k\n\n(4.15)\n\nThen, for fluid modes that are well resolved, we have\n(4.16)\nMF\u2217 \u2217\n\u00eafld,k (\u2206t) \u2248\n\u03b4\n\u03c1 a,k\n\n\u0012\n\nM\n1\n+C\nlF\na\n\n\u0013\u0010\n\n\u0011\n\u221a\nC \u2032 vfrc \u2206t2 + C \u2032\u2032 D\u2206t3/2\n\nif \u03b1k \u2206t \u226a 1,\n\nwhile the underresolved modes (with \u03b1k \u2206t \u226b 1) have the same error estimate 4.8 as\nin the fully underresolved case.\nThe errors incurred in the physical space variables describing the velocity and\nelementary particle positions can, in the asymptotic regime 4.15, be estimated as\n(4.17)\nefld (\u2206t) \u2248\n(4.18)\n\nMF\u2217\n\u03c1\u03bd 3/4 L3/2\n\n\u0012\n\nM\n1\n+C\nlF\na\n\n\u0013\u0010\n\u0011\n\u221a\nC \u2032 vfrc \u2206t5/4 + C \u2032\u2032 D\u2206t3/4\n\n\f26\n\nP. ATZBERGER, P. KRAMER\n\nD\neprt (\u2206t) \u2248 Q2 \u2206t\n\u0013\n\u0012 a\n\u0011\n1 \u0010\u221a\nM\n2\n+ C\u2032\n+\nDvfrc \u2206t3/2 + vfrc\n\u2206t2 ,\nlF\na\nwhere \u03bd = \u03bc/\u03c1.\nThese errors can be compared with the size of the actual changes in the system\nvariables over a time step in the regime 4.15, which can be estimated by the same\nformulas as 4.13 except that the resolved velocity modes have changes of approximate\nsize\n\u221a\n\u2217\nM F \u2217 \u03b4a,k\n\u2032 vthm \u03b1k \u2206t\n(4.19)\n.\n|\u03b4 \u00fbk | \u2248 C\n\u2206t + C\n\u03c1\nN 3/2\nThe ratio of the errors to the corresponding magnitudes of the actual changes of the\nsystem variables over\u221aa time step is controlled by sums and products of the nondimensional quantities D\u2206t/a, vfrc \u2206t/a, (\u03bd\u2206t)1/4 /L1/2 , M La , and Ma\nlF . The former\nthree remain small in the asymptotic regime 4.15 under consideration, while the last\ntwo nondimensional groups (independent of time step) are related to our somewhat\npessimistic bound on the force errors, as discussed in Subsection 4.1. The numerical\nmethod is thereby shown to remain theoretically accurate within this intermediate\nasymptotic regime. In the absence of particle forces (F \u2217 = 0), the error estimates\nbecome identical to those for the unresolved fluid regime (Subsection 4.2).\nOne could also study the intermediate asymptotic regime\n(4.20)\n\nmin\n\n\u03c1a2\n1\n\u226a \u2206t \u226a\n,\n\u03b1k\n\u03bc\n\nwhich exists only when \u2206x \u226a a. For these time steps, all error estimates presented\nin Subsection 4.1 for the fully resolved regime remain valid, except that the estimate\nfor the individual underresolved fluid modes is altered to\n\u0013\n\u0012\n1\nM F \u2217 L2 M\n(4.21)\n\u03b4 \u2217 (C \u2032 vfrc + C \u2032\u2032 vthm ) \u2206t.\n+C\n\u00eafld,k (\u2206t) \u2248\n\u03bc|k|2\nlF\na a,k\nAs with the other regimes, the errors in this regime are small relative to the magnitude\nof the changes of the actual system variables over a time step.\nBy simple extension of the above arguments for time steps falling at the transitions\nbetween the asymptotic regimes, we see that the numerical method has been designed\nto remain theoretically accurate for all time steps \u2206t \u226a \u03c4mov (a), regardless of how\nwell the fluid dynamics are resolved.\n5. Physical Behavior of the Method and Numerical Results. To ensure\nthat the immersed boundary method with thermal fluctuations serves as a plausible physical framework for modeling microscale systems, we verify that the method\nexhibits several fundamental features which are correct according to the laws of statistical physics (70). In Subsection 5.1 an expression for the diffusion coefficient of\nimmersed particles is derived, and it is shown that in three dimensions the mean\nsquared displacement scales linearly in time and inversely in the particle size. It\nis further shown in Subsection 5.2 that the stochastic immersed boundary method\ncaptures the correct \u03c4 \u22123/2 power law for the decay of the tail of the autocorrelation\nfunction of the particle velocity (6; 16; 20; 23; 37; 38; 54; 67).\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n27\n\nIn determining the thermal forcing in Subsection 3.3.3, we imposed the requirement that the degrees of freedom of the fluid obey Boltzmann statistics in thermal\nequilibrium. In fact, the complete system including immersed structures should obey\nBoltzmann statistics. In Subsection 5.3, we study the equilibrium statistics of immersed particles subject to a conservative force and show through numerical simulation that they do exhibit the correct Boltzmann statistics. To demonstrate some\napplications and as a further verification of the physical plausibility of the method,\nit is shown in Subsections 5.4 \u2013 5.6 how the method can be used to model osmotic\neffects such as the pressure of confined particles, dimers, and polymers (21; 61). In\nSubsection 5.7, another application to a basic model of a molecular motor protein\nimmersed in a fluid subjected to a hydrodynamic load force is presented (66).\n5.1. Diffusion of Immersed Particles. In this section the diffusion of particles\nin the stochastic immersed boundary method is discussed and an expression for the\ndiffusion coefficient is derived. As part of the analysis it is shown that the correct\ndiffusive scaling is obtained for three dimensional systems. To verify the validity of\nthe approximations made in the analysis and to demonstrate the applicability of these\nresults in practice, the results of the analysis are compared to the results of numerical\nsimulations.\nIn three dimensions, the diffusion coefficient for a single particle is defined as\n(5.1)\n\nD = lim\n\nt\u2192\u221e\n\n|X(t) \u2212 X(0)|2\n.\n6t\n\nIn the notation the superscripts on the particle position are suppressed since only a\nsingle immersed particle is considered.\nAn estimate for the diffusion coefficient of a single particle (with no interactions\nwith other particles) in the stochastic immersed boundary method is derived in Subsection 5.1.1 from the autocorrelation function of the velocity field of the fluid. This\nestimate can be expressed as\n(5.2)\n\nD=\n\nkB T L3 X |\u03b4\u0302a,k |2 \u03a5k\n,\n3\u03c1\n\u03b1k\nk\n\nwhere \u03a5k is defined in appendix C and \u03b4\u0302a,k is defined in appendix B. This diffusivity\nas simulated by the stochastic immersed boundary method exhibits the physically\ncorrect scaling with respect to physical parameters (45).\nThe diffusion coefficient is estimated from the numerical simulations using\n(5.3)\n\nD\u0303 \u2248\n\nn\n2\n1 X\nX\u0303m (t1 ) \u2212 X\u0303m (0) ,\n6nt1 m=1\n\nwhere n is the number of sampled trajectories of fixed duration t1 . The notation X\u0303m\ndenotes the simulated particle position from the mth trajectory.\nIn Figure 5.1, the theoretical estimate of the diffusion coefficient as given in\nequation 5.2 is compared to the numerical estimate given in equation 5.3 for particles\nwith sizes a = 1, 2, 3, 4, 5 and for a long time step which underresolves the dynamics\nof the fluid. For the parameters of the fluid-particle system used in the numerical\nsimulations, see table 4.2. For each particle size, the numerical estimates were made\nfrom n = 104 sampled trajectories with \u2206t = 103 ns and t1 = 104 ns. We remark that\nin the simulations, while the time step underresolves the fastest modes of the fluid,\n\n\f28\n\nP. ATZBERGER, P. KRAMER\n\nFig. 5.1. A comparison of the analytic estimate 5.2 for particles of the IB method with numerically estimated diffusion coefficients for the parameters given in Table 4.2. The dashed line\nindicates the analytic estimate 5.2. The data points denote estimates of the diffusion coefficient obtained from numerical simulations using the method. The error bars denote one standard deviation\nof the sampled values. In the numerical simulations long time steps satisfying max 1/\u03b1k \u226a \u2206t were\ntaken which under For the parameters values given in Table 4.2 the time step \u2206t = 103 ns was used\nin the numerical simulations, where max 1/\u03b1k = 25.4ns. The particle size k0 corresponds to the\nparameter value a = k0 \u2206x of the particle representation function \u03b4a defined in appendix A, where\nk0 controls the number of mesh-widths spanned by the \u03b4a function.\n\nthere is still good agreement between the diffusion coefficient of the simulated particle\nand the theoretical estimate 5.2. A tabulation of the theoretical diffusion coefficient\nas given in equation 5.2 for the immersed boundary method with various ratios of\na/\u2206x and a/L can be found in (45).\n5.1.1. Derivation of the Diffusion Coefficient. To derive an analytic estimate for the diffusion coefficient the semidiscretized equations 3.16 and 3.18 are\nconsidered. Alternatively, the diffusion coefficient can also be derived directly from\nthe stochastic immersed boundary equations by a stochastic mode reduction procedure (46). In equations 3.16 and 3.18 the immersed particle dynamics are given by\ndX(t)\n= U(X(t), t),\ndt\n\n(5.4)\n\nwhere U is given in Fourier space by\nX\nU(x, t) =\n(5.5)\nL3 \u03b4\u0302a,k (x)\u00fbk (t) exp (i2\u03c0x * k/L) ,\nk\n\nwith the coefficient \u03b4\u0302a,k (x) defined in appendix B.\nThe autocorrelation function of the velocity of an immersed particle is\n(5.6)\n\nR(t, t + \u03c4 ) = hU (X(t), t) * U (X (t + \u03c4 ) , t + \u03c4 )i .\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n29\n\nTo estimate this, we use the fact that the statistics of U(x, t) are approximately\nshift invariant in both t and x, with the approximation improving as the spatial grid\nis refined. We further assume that the time scale associated with the fluid velocity\nis small relative to the time scale of the immersed particle motion, so that a particle\nmoves a negligible distance relative to its size a during the correlation time of the\nfluid velocity. These approximations give\n(5.7)\n\nR(t, t + \u03c4 ) \u2248 hU(0, 0) * U(0, \u03c4 )i := R(\u03c4 ).\n\nBy applying (C.5), the autocorrelation function of the velocity of an immersed\nparticle can then be expressed as\n(5.8)\n\nR(\u03c4 ) \u2248\n\nX\n\nL6 \u03b4\u0302 a,k \u03b4\u0302a,k\u2032 huk (t) * uk\u2032 (t + \u03c4 )i\n\n=\n\nX\n\nL6 |\u03b4\u0302a,k |2 3\n\nDk \u2212\u03b1k |\u03c4 |\ne\n\u03b1k\n\nX\n\nL6 |\u03b4\u0302a,k |2 4\n\nDk \u2212\u03b1k |\u03c4 |\ne\n\u03b1k\n\nk,k\u2032\n\nk\u2208K\n\n+\n\nk6\u2208K\n\n=\n\nkB T L3 X\n|\u03b4\u0302a,k |2 \u03a5k e\u2212\u03b1k |\u03c4 | ,\n\u03c1\nk\n\nwhere \u03a5k is defined in appendix C.\nAn important point for the numerical method developed in Section 3 is that this\nstructure of the correlation function is preserved even for finite time steps, provided\nonly that the time step is small enough that the immersed elementary particles do\nnot move significantly during a time step (\u2206t \u226a \u03c4diff (a)), where \u03c4diff (a) is the time\nscale of a particle to diffuse over a distance equal to its size a. Were we to have used\ninstead a numerical method based on a stochastic Taylor expansion (44), we would\nhave to restrict the time step \u2206t to be small enough so that R(\u03c4 ) is well approximated\nby a Taylor expansion for |\u03c4 | . \u2206t, which would add the additional restriction that\n\u2206t \u226a 1/\u03b1k . Our more accurate representation for the fluid dynamics over a time\nstep allows us to obviate this other condition, as demonstrated in Figure 5.1.\nA useful identity relating the autocorrelation function to the mean squared displacement of an immersed particle is\n(5.9)\n\n|X(t) \u2212 X(0)|2 =\n\nt\n\n\u001cZ\n\n=2\n\nZ\n\n0\nt\n\ndX(s)\nds *\nds\n\nZ\n\n0\n\nt\n\ndX(r)\ndr\ndr\n\n\u001d\n\nR(r) * (t \u2212 r)dr.\n\n0\n\nThis allows for the diffusion coefficient to be estimated by the Kubo formula (47):\n(5.10)\n\n1\nD=\n3\n\nZ\n\n\u221e\n\nR(r)dr,\n\n0\n\nBy substituting the estimate 5.8 into 5.10 and evaluating the integral, the expression\n5.2 for the diffusion coefficient is obtained.\n\n\f30\n\nP. ATZBERGER, P. KRAMER\n\n5.2. Algebraic Decay of Velocity Autocorrelation Function. For immersed\nparticles diffusing in a viscous fluid, the particle motion is strongly coupled to the motion of the fluid. As a particle moves along a particular direction, fluid is dragged\nalong with it. When the particle changes direction, it is resisted by a viscous force\narising from its motion relative to the nearby fluid with momentum related to the\nrecent past of the particle's motion. This induces a somewhat stronger memory in\nthe particle velocity than a standard model based on a constant Stokes drag would\npredict. In particular, a careful analysis of physical Brownian motion, including a\nmore detailed model for the force between an immersed particle and the surrounding\nfluid, yields for D \u226a \u03bc/\u03c1 (6; 16; 20; 23; 37; 38; 54; 67; 78)\n(5.11)\n\nR(\u03c4 ) \u2248\n\nkB T \u03c11/2 \u22123/2\n\u03c4\nfor \u03c4 \u226b \u03c1a2 /\u03bc.\n4\u03bc3/2\n\nThe condition D \u226a \u03bc/\u03c1 can readily be checked to hold for typical microbiological\nsystems.\nFor the stochastic immersed boundary method, it is shown in Subsection 5.2.1\nthat this general behavior is recovered with\n\u0015\n\u0014\nkB T \u03c11/2 \u22123/2\n(5.12)\n\u03c4\nfor \u03c1a2 /\u03bc \u226a \u03c4 \u226a \u03c1L2 /\u03bc,\nR(\u03c4 ) \u2248 CIB\n\u03bc3/2\nwhere CIB = 4\u03c013/2 . The constant prefactors differ slightly due to the different ways\nparticles are represented in the physical model and immersed boundary method.\nThe restriction that \u03c4 \u226a \u03c1L2 /\u03bc for the \u03c4 \u22123/2 scaling in the immersed boundary\nmethod is a finite size effect which should have an analogue for physical Brownian\nmotion. For very long times where \u03c4 \u226b \u03c1L2 /\u03bc the correlation function R(\u03c4 ) decays\nexponentially, with rate governed by that of the lowest wavenumber modes in the\nFourier series (5.8). However, by these times the autocorrelation function would\nalready be very small so this very long time regime is of little practical interest.\nThese results show that the decay of the particle velocity autocorrelation function\nin the stochastic immersed boundary method has the correct scaling with respect to\ntime and physical parameters.\n5.2.1. Derivation of Algebraic Decay of Velocity Autocorrelation Function. In this discussion, the reference to wavenumbers k implicitly indicates the\nvalue within the equivalence class of aliased wavenumbers such that each component |k(j) | \u2264 N/2. For this purpose one can choose any scheme to select a unique\nvalue when k lies on the boundary of this set.\nFirst observe from the scaling properties of Fourier transforms and the definition\nof \u03b4a from (A.2) that\n(5.13)\n\n\u03b4\u0302a,k \u2248 \u03b4\u0302a,0 =\n\n1\nfor |k| \u226a L/a,\nL3\n\nand \u03b4\u0302a,k decays rapidly with respect to |k|a/L. Along with the fact that the high\nwavenumber components of R(\u03c4 ) decay at a faster rate \u03b1k than the low wavenumber\ncomponents, it then follows from the Fourier series representation 5.8 for the particle\nvelocity autocorrelation function that the sum will be dominated by the terms with\n|k| . L/a\nOver the intermediate asymptotic time interval indicated in 5.12, the time t is\nsmall compared to the decay time 1/\u03b1k \u223c \u03c1L2 /\u03bc of the low wavenumber modes\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n31\n\n|k| \u223c 1, but large compared to the decay time 1/\u03b1k \u223c \u03c1a2 /\u03bc of the (relatively high)\nwavenumber modes |k| \u223c L/a corresponding to the length scale of the particle. Combining these observations, there exists a time-dependent wavenumber scale kc (t) which\nsatisfies 1 \u226a kc (t) \u226a N/2 such that e\u2212\u03b1k t \u2248 1 for |k| \u226a kc (t) and e\u2212\u03b1k (t) \u2248 0 for\nwavenumbers such that |k| \u226b kc (t). Consequently, over the intermediate asymptotic\ntime interval, the Fourier series 5.8 is dominated by contributions from wavenumbers\n1 \u2264 |k| . kc (t) \u226a N/2. These observations allow us to make the following simplifying\napproximations over the time interval \u03c1a2 /\u03bc \u226a t \u226a \u03c1L2 /\u03bc:\n\u2022 The prefactors multiplying the exponential in each Fourier series term may\nbe approximated by their low wavenumber limits:\n(5.14)\n\n|\u03b4\u0302a,k |2 \u03a5k \u2248 2/L6 for |k| \u226a N/2.\n\n\u2022 The decay rate in the exponential may be approximated for |k| \u226a N/2 by its\nlow wavenumber asymptotics\n(5.15)\n\n\u03b1k \u2248 A|k|2 ; A = 4\u03c0 2 \u03bc\u03c1\u22121 L\u22122 .\n\n\u2022 The Fourier sum may be extended to the full integer lattice, because with\nthe replacement 5.15, the additional terms for large wavenumbers will be\nexponentially small and make a negligible contribution.\n\u2022 This Fourier sum over the integer lattice can be approximated by an integral\nover continuous k, because the dominant contribution comes from a large\nnumber of lattice sites 1 \u2264 |k| . kc (t), with kc (t) \u226b 1.\nApplying these simplifications and then changing to spherical coordinates with\nradial variable k = |k|, we obtain\nZ\n2kB T\n(5.16)\nexp(\u2212A|k|2 \u03c4 ) dk\nR(\u03c4 ) \u2248\n\u03c1L3\n3\nR\nZ\n8\u03c0kB T \u221e 2\n=\nk exp(\u2212Ak 2 \u03c4 ) dk\n\u03c1L3\n0\n!\nr\n1\n8\u03c0kB T 1\n1\n,\n=\n2\u03c0\n\u03c1L3 2\n2A\u03c4 2A\u03c4\nwhere the second equality follows readily by using standard facts about Gaussians.\nIn particular, the integral can be treated as the expectation of the second moment\nby introducing the standard normalization factor. Using 5.15 and simplifying the\nexpression yields 5.12.\n5.3. Equilibrium Statistics of Immersed Particles. For the particle-fluid\nsystem with the fixed temperature T , volume V , and number of elementary particles\nM , with the particles subject to a conservative force field, we have from statistical mechanics that the equilibrium probability density \u03a8 of the elementary particle positions\nshould have Boltzmann statistics:\n\u0013\n\u0012\n1\nE({X})\n\u03a8({X}) = exp \u2212\n(5.17)\n,\nZ\nkB T\nwhere E is the energy of a configuration of elementary particles. The factor Z is the\nnormalization factor so that the density integrates to one. The Boltzmann distribution\narises from the thermodynamic condition that the equilibrium probability distribution\n\n\f32\n\nP. ATZBERGER, P. KRAMER\n\n\u22123\n\nx 10\n\nsimulation\ntheory\n\nprobability density\n\n8\n\n6\n\n4\n\n2\n\n0\n0\n\n50\n\n100\n\n150\n200\nradius\n\n250\n\n300\n\n350\n\nFig. 5.2. Boltzmann Distribution vs Numerical Equilibrium Distribution. The spherical potential energy has the parameters R1 = 125, R2 = 250, c = 6kB T /(R2 \u2212 R1 ). The simulation\nwas run with the parameters N = 16, L = 1000 nm, \u2206x = L/N , \u03bc = 6.02 \u00d7 105 amu/(nm * ns),\n\u03c1 = 602 amu/nm3 , T = 300 K, \u2206t = 1000 ns. 200, 000 time steps were simulated.\n\nof the microscopic states maximize entropy while maintaining a fixed average energy\nfor the system (70).\nIn deriving the thermal forcing of the system in Subsection 3.3.3, only the energy\nassociated with the fluid modes was considered. When immersed structures are subject to a force, it is not entirely clear that the correct equilibrium distribution for the\nsystem as a whole will be attained.\nWhen formulated in continuous time, the fluid-particle coupling in the immersed\nboundary method conserves energy exactly (64). While this may suggest that the\ncorrect equilibrium statistics should be obtained (up to the appropriate definition of\nan effective temperature), the discretization of time in the numerical method could in\nprinciple disrupt it, particularly since we are not employing a symplectic method (57;\n74).\nWe now show that the numerical method from Section 3.1 appears to yield results\nconsistent with the Boltzmann distribution, at least for the statistics of the position of\na single immersed particle. For a more rigorous approach in which the Fokker-Plank\nequations associated with the stochastic immersed boundary method are analyzed,\nsee the related work (3).\nTo facilitate calculation of the equilibrium statistics, the particles are subject to\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n33\n\na radially symmetric external force depending on r = |X| with the potential energy\n\uf8f1\nr < R1\n\uf8f2 0,\n(5.18)\nV (r) =\nc * (r \u2212 R1 ),\nR1 \u2264 r \u2264 R2\n\uf8f3\nc * (R2 \u2212 R1 ), r > R2 .\n\nIt is assumed that c > 0 so that this can be thought of physically as the potential\nassociated with confining particles to a spherical chamber of radius R2 . The inner\nradius R1 is used to soften the particle-wall interactions to avoid issues of numerical\nstiffness and R2 is taken significantly smaller than the spatial period of the lattice L.\nFor a single immersed particle, the Boltzmann distribution for its radial coordinate\nis\n\u0012\n\u0013\n4\u03c0r2\nV (r)\n\u03a8\u0303(r) =\nexp \u2212\n(5.19)\n,\nkB T\nZ\u0303\nwhere Z\u0303 is the normalization factor.\nIn Figure 5.2, the equilibrium statistics of immersed particles simulated with the\nnumerical method are compared with the Boltzmann distribution 5.19. The simulations were performed with R1 = 125nm, R2 = 250nm and c = 6kB T /(R2 \u2212 R1 ) with\nthe parameters of the fluid-particle system given in Table 4.2.\n5.4. Osmotic Pressure of Confined Non-interacting Particles. Osmosis\nis a phenomenon that occurs in many microscale biological systems. When diffusing\nparticles are confined to a chamber by a boundary which is permeable to fluid but\nless permeable to particles, a pressure difference develops between the inside and the\noutside of the chamber. This difference is referred to as the \"osmotic pressure\".\nWhen the confining boundary is impermeable to particles and the system is in\nequilibrium, van't Hoff's law (70) relates the osmotic pressure to the concentration of\nthe confined particles as\n(5.20)\n\nposmosis = c\u03040 kB T,\n\nwhere c\u03040 is the number of particles per unit volume in the chamber. More precisely,\nwhen the number of confined particles is small enough that the instantaneous pressure\nfluctuates, then van't Hoff's law should describe the ensemble or time average of the\npressure difference that arises from confinement.\nOne should see a signature of van't Hoff's law in the fluid pressure when a collection of M non-interacting particles in a conservative force field with potential V are\nsimulated by the stochastic immersed boundary method, given that the method was\nshown in Subection 5.3 to produce correct Boltzmann equilibrium statistics. Indeed,\ntaking the expectation of the velocity, force, and pressure with respect to Boltzmann's\ndistribution (ensemble average) in the fluid equation 2.1 gives\n(5.21)\n\n0 = \u2212\u2207hp(x)i + hfprt (x)i.\n\nThis is obtained using that hui = 0 and hfthm i = 0. The notation h*i denotes\nthe ensemble average over the thermal fluctuations and hpi denotes the average of the\nfluid pressure field.\nThe ensemble average of the conservative force field with potential V at location\nx is\n(5.22)\n\nhfprt (x)i =\n\n\u2212M \u2207V (x) \u2212 Vk (x)\ne BT .\nZ\n\n\f34\n\nP. ATZBERGER, P. KRAMER\n\n0.08\n\nsimulation\ntheory\n\npressure\n\n0.06\n\n0.04\n\n0.02\n\n0\n0\n\n100\n\n200\nradius\n\n300\n\n400\n\nFig. 5.3. Time Averaged Radial Pressure. The spherical potential energy has the parameters\nR1 = 125, R2 = 250, c = 6kB T /(R2 \u2212 R1 ). The simulation was run with the parameters N = 16,\nL = 1000 nm, \u2206x = L/N , \u03bc = 6.02 \u00d7 105 amu/(nm * ns), \u03c1 = 602 amu/nm3 , T = 300 K,\n\u2206t = 1000 ns. 200, 000 time steps were simulated.\n\nThe average pressure hp(x)i can be determined up to an additive constant from\n5.21 and 5.22 by taking the line integral in x. From the fundamental theorem of line\nintegrals with the additive constant set to zero (to give the appropriate decay at large\nx) we have\n(5.23)\n\nhp(x)i =\n\nM \u2212 Vk (x)T\ne B kB T\nZ\n\nBy the assumption of Boltzmann statistics for the immersed particles the concentration field is\n(5.24)\n\nc0 (x) =\n\nM \u2212 Vk (x)T\ne B .\nZ\n\nSubstitution into 5.23 and integrating over the chamber gives van't Hoff's law. This\nderivation also indicates that the stochastic immersed boundary method has a fluid\npressure field which should respect the local formulation of van't Hoff's law:\n(5.25)\n\np0 (x) = c0 (x)kB T.\n\nFrom a statistical mechanical point of view of this derivation, this fluid pressure\ncan be thought of as arising from the fluctuations of the system which persistently\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n35\n\nsubject a particle to the confining forces in the vicinity of the wall with a frequency\ndetermined by the Boltzmann statistics. The forces are then transferred to the fluid by\nthe viscous particle-fluid interactions. Similar \"mesoscopic\" points of view of osmosis\nhave been used in (4; 21; 61).\nIn Figure 5.3, a comparison is made of the pressure predicted by a local van't\nHoff's law taking into account the local solute concentration and the time average of\nthe pressure field of the fluid obtained in a numerical simulation using the stochastic\nimmersed boundary method for an immersed particle confined by the spherically\nsymmetric potential given by equation 5.18.\nAnother quantification of osmotic pressure is the average force per unit area\nexerted on the walls of the chamber which confine the solute. For a spherical chamber\n\u03a9 of radius R in which the solute exerts a (generally repulsive) areal force density\nFpw (z) on a portion of the wall boundary \u2202\u03a9 at relative location z, this osmotic\npressure is given by:\nZ Z\n1\ny\npwall =\n(5.26)\nc(x) dy dx\nFpw (y \u2212 x) *\n4\u03c0R2 \u03a9 \u2202\u03a9\n|y|\nwhere c(x) denotes the average concentration of the solute particles. Note that this\nformula applies also when the solute particles interact with each other. We will\nonly be considering isotropic wall-solute interactions (and uniform distribution of wall\nmolecules) so that we can write the force density in terms of a (typically nonnegative)\nscalar function qpw (r): Fpw (z) = qpw (|z|)z/|z| and the concentration density as c(x) =\nc(|x|). The expression in equation 5.26 for the osmotic pressure on the chamber wall\ncan then be simplified by integrating over the angular degrees of freedom:\nZ R\n1\npwall = 2\n(5.27)\nh(r)c(r)r2 dr\nR 0\nwith\nh(|x|) =\n\nZ\n\n\u2202\u03a9\n\n(5.28)\n\n=\n\n\u03c0\nr\n\nZ\n\nFpw (|y \u2212 x|) *\nR+r\n\nR\u2212r\n\ny\ndy\n|y|\n\n\u0001\nqpw (\u03c1) \u03c12 + R2 \u2212 r2 d\u03c1.\n\nThe function h(r) can be interpreted as the integrated normal force applied to the\nwall by a solute particle located a distance r = |x| from the origin. The change of\nvariable used to obtain the last integral was \u03c1 = |y \u2212 x|.\nWhen the potential confining the solute is \"hard-walled,\" in the sense that the\nsolute-wall interactions occur only in a very small boundary layer of the wall, the two\nformulas 5.27 and 5.23 give the same values for the osmotic pressure, up to a small\ndifference which vanishes as the width of the boundary layer is taken to zero. For\npotentials which are \"soft-walled\" in the sense that solute molecules interact with the\nwall on a length scale comparable to the magnitude of the fluctuations of the size of the\nsolute molecules, as in Subsection 5.5, the average pressure of the fluid and the average\npressure exerted on the wall may in fact differ. In related work, we are investigating\nthe various pressures associated with osmotic phenomena and exploring the influence\nof finite wall and molecule sizes (5). For a discussion of how the osmotic pressure\ncan be used to drive fluid flow in a mesoscopic pump, see the related work (4). We\nnow present a few examples to demonstrate how more complex structures immersed\n\n\f36\n\nP. ATZBERGER, P. KRAMER\n\nin the fluid can be simulated with the stochastic immersed boundary method and to\nshow how the osmotic pressure associated with wall forces can be derived from the\nthermal fluctuations of these structures as simulated by the method.\nBefore proceeding in the following subsections to consider osmotic pressure effects\nof more complex structures, we remark that the wall pressure can be computed from\nthe average of the radial confinement force fconf (x) = \u2212fconf (|x|)x/|x| acting on the\nparticles and equation 5.26 in the case of a spherical chamber. From Newton's third\nlaw (principle of equal and opposite forces):\nZ\n(5.29)\n\u2212Fpw (y \u2212 x) dy,\nfconf (x) =\n\u2202\u03a9\n\nre-expressed using the isotropy of the forces involved, we have:\nZ\nx\ny\u2212x\n\u2212 fconf (|x|)\n(5.30)\n=\n\u2212q(|y \u2212 x|)\ndy.\n|x|\n|y\n\u2212 x|\n\u2202\u03a9\nIn spherical coordinates, this can be written:\n\u03c0R\nfconf (r) = 2\nr\n\n(5.31)\n\nZ\n\nR+r\n\nR\u2212r\n\nq(\u03c1)(r2 \u2212 R2 + \u03c12 )d\u03c1.\n\nIf the model for the solute-wall interaction force can be assumed to vanish at\nseparation distances comparable to the chamber radius, then this integral relation\nbetween q and f can be inverted to obtain:\n(5.32)\nq(\u03c1) =\n\n\u0012\n\n1\n2\u03c0R\u03c12\n\n\u0013\n\n\u03c1(R \u2212\n\n\u2032\n\u03c1)fconf\n(R\n\n\u2212 \u03c1) + (R + \u03c1)fconf (R \u2212 \u03c1) +\n\nZ\n\n0\n\nR\u2212\u03c1\n\n!\n\nfconf (s)ds .\n\nThe pressure on the wall can then be computed from the effective bulk confinement\nforce fconf (r) using 5.27, 5.28, and this inversion formula.\n5.5. Application: Simulation of Interacting Immersed Particles and Osmotic Pressure. We now discuss application of the stochastic immersed boundary\nmethod in determining the osmotic pressure when the confined particles can interact. In particular, we consider the case in which particles interact in distinct pairs\n(dimers) through a spring with non-zero rest length and are confined to an approximately 400nm spherical chamber. Note that the solute particles are confined in\na microscopic chamber, in the sense that the chamber diameter is comparable or\nsmaller than the length-scale associated with the solute particle interactions between\nthe monomers. This is in contrast to a macroscopic chamber in which solute particles\ninteract on a length-scale very much smaller than the chamber diameter and where\nthe van't Hoff law is well established with the osmotic pressure depending only on the\nnumber of solute particles and not on their physical characteristics. For example, in\nmicroscopic chambers the amplitude of the fluctuations of a solute particle's diameter\nmay be comparable to the chamber diameter and play a non-negligible role in the\nosmotic pressure associated with confinement.\nTo investigate these effects, we consider how the osmotic pressure changes as the\nbinding strength for a collection of dimers is varied. From the classical van't Hoff's\nlaw, it would be expected that the osmotic pressure for tightly bound dimers are half\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n37\n\nthat of the zero-binding case (free monomers), because a tightly bound dimer behaves\neffectively as a single particle. This concept is exploited to suggest the design of an\nosmotically driven pumping apparatus in (4). From simulations using the stochastic immersed boundary method, we can investigate how the osmotic pressure varies\nbetween the unbound and tightly bound regimes.\n\nFig. 5.4. Illustration of five distinct pairs of coupled particles confined in a spherical chamber\nwith the soft-wall potential given by equation 5.34. Simulations were performed for five pairs of\nparticles coupled with interaction energy given by equation 5.33.\n\nFig. 5.5. The geometrically weighted particle concentration c(|x| = r)r 2 of the monomers in\nthe spherical shell of radius r used in equation 5.27. As the coupling is tightened, the particle\nconcentration has more weight at smaller radii. The concentration is shown only over the boundary\nlayer over which the confinement force is exerted.\n\nEach pair of particles is coupled by a potential energy corresponding to a standard\nspring model with finite rest length l:\n(5.33)\n\n\u03a62 (X1 , X2 ) =\n\nK\n2\n(|X1 \u2212 X2 | \u2212 l) ,\n2\n\nwhere X1 and X2 denote the particle locations and K represents the spring stiffness.\nEach monomer at location x is subject to a confinement force given by the radially\n\n\f38\n\nP. ATZBERGER, P. KRAMER\n\nsymmetric potential:\n(5.34)\n\n\u03a61 (x) =\n\n\uf8f1\n\uf8f2 0,\n\uf8f3\n\nC0\n2\nC0\n2\n\n|x| \u2264 R1 ,\n2\n(|x| \u2212 R1 ) , R1 \u2264 |x| \u2264 R2\n2\n(R2 \u2212 R1 ) , |x| \u2265 R2 .\n\nThis potential can be thought of as arising from the interaction force of the confined\nsolute monomers with particles distributed uniformly over the walls of a spherical\nchamber having radius R = R2 . The formula given in equation 5.32 gives the relationship between the monomer-wall interaction force and the radial confinement\nforce. For the simulations the parameters were chosen as l = 100nm, R1 = 375nm,\nR2 = 400nm, C0 = 8kB T /(R2 \u2212 R1 )2 . The setup is depicted pictorially in Figure 5.4,\nand movies of the simulations can be found in the Supplemental Materials.\n\nFig. 5.6. The osmotic pressure for confined dimers as a function of coupling strength. As the\ncoupling strength of the dimers increases, the osmotic pressure decreases in a non-linear manner.\nThe osmotic pressure value for unbound monomers is approximately double that of the the tightly\nbound monomers, which is in accordance with what is expected under van't Hoff 's law. Deviations\nfrom van't Hoff 's law are apparent for intermediate coupling strengths for which the length scale of\nthe dimers is comparable to those of the chamber and the wall thickness.\n\nFigure 5.5 displays the results of simulations with the stochastic immersed boundary method that show that as the stiffness is increased, the particle density decreases\nfor each radius r within the region of the confining potential. The pressure consequently drops with increasing coupling stiffness, as shown in Figure 5.6. We see also\nthat, in accordance with van't Hoff's law, the pressure in the strong coupling limit,\nwhere the particle pairs behave effectively as single entities, is cut to roughtly half\nfrom the no coupling case. We observe deviations from the classical van't Hoff law\nwhen the length scale of the bound molecules is comparable to that of the wall or the\nchamber.\nAn intuitive statistical explanation for the pressure drop is that a strongly coupled particle is less likely to venture far into the confining potential because roughly\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n39\n\nhalf the time its partner will encounter the confining potential first, be repelled, and\npull its accompanying particle back away from the confining potential sooner than it\nwould have on its own. In more physical terms, the entropy of the particle pairs decreases and consequently the entropic penalty associated with confinement is reduced\nas the coupling strength increases. For coupling values that make the dimer length\nscale comparable to the microscopic chamber size, the osmotic pressure assumes an\nintermediate value which is not well described by a van't Hoff's law.\n5.6. Application: Simulation of Polymer Chains and Polymer Knots. A\nfundamental feature of the stochastic immersed boundary method is that each structure evolves according to a local average of a common fluid velocity field. The method\ntherefore automatically captures the physical phenomenon that the velocities of immersed structures become strongly correlated when they are close together in space.\nMathematically, the solution map of the immersed structures and surrounding fluid\nvolume, which maps a configuration of the fluid and structures at a reference time\nto the solution configuration at a later time t, can be viewed as a homeomorphism.\nConsequently, in the continuous-time framework, the method preserves topological\ninvariants of the immersed structures, such as the knottedness of a continuous closed\ncurve, as they evolve. This is in contrast to other simulation methods, such as Stokesian Dynamics (15; 75; 77), which would require explicit excluded volume constraints\nand/or repulsion forces between monomers to prevent topological changes.\n\nFig. 5.7. The bar graph shows the average concentration of monomers within the chamber\nin the boundary layer in which they interact with the confinement forces (Subsection 5.4). As\nthe knottedness of the polymer increases, the monomers are more restricted and concentrate on\naverage toward the chamber center spending less time interacting with the confinement forces. As a\nconsequence the concentration of monomers in the boundary layer decreases and the overall pressure\ndrops (Table 5.1). The parameters in the simulations were taken the same as in Subsection 5.4.\n\nTo demonstrate this feature of the method in practice (with finite time step) and\n\n\f40\n\nP. ATZBERGER, P. KRAMER\n\nto show how worm-like chain polymers can be simulated, the stochastic immersed\nboundary method was applied for a generic polymer chain, a polymer trefoil knot,\nand a polymer figure eight knot. From these simulations the osmotic pressure of\nconfinement was estimated for each of the polymers. The results of the average\nconcentration of the polymer monomers, which determine the average radial force\ndensity exerted on the confining wall, is given in Figure 5.7.\nAs the knottedness of the polymer increases, its constituent monomers spend less\ntime at large radii, and as seen in Table 5.1, the osmotic pressure is significantly reduced. An intuitive explanation is that as the knottedness of the polymer increases,\nthis restricts the intrinsic configurations accessible to the thermally fluctuating polymer. In physical terms, the knottedness reduces the entropic penalty of confining of\nthe polymer. Movies showing simulations of the thermally fluctuating polymer knots\ncan be found in the Supplemental Materials.\nTable 5.1\nOsmotic Pressure of Polymer Knots\n\nKnot Type\nUnknotted\nTrefoil Knot\nFigure Eight Knot\n\nOsmotic Pressure (amu/nm * ns2 )\n0.16\n0.0439\n0.0392\n\n5.7. Application: Simulation of a Basic Model for a Molecular Motor\nProtein Transporting a Membrane-Bound Cargo Vesicle . We now discuss\nhow more complex systems can be simulated with the immersed boundary method.\nOn a subcellular level motor proteins interact with cytoskeletal structures, such as\nactin and microtubules, to generate force and to transport materials within the cell.\nFor example, neurotransmitters are produced in the cell body of neurons and transported by kinesin motor proteins along axons to the vicinity of the synaptic cleft\nwhere they are packaged for future release (8). We demonstrate how the stochastic\nimmersed boundary method can be applied to simulate a basic model of a molecular\nmotor protein immersed in a fluid moving along a filament which transports a cargo\nvesicle (Figure 5.8).\n\nFig. 5.8. Illustration of the basic model of a molecular motor protein immersed in a fluid and\ntowing a cargo vesicle. As the fluid flow strengthens, the hydrodynamic drag on the cargo increases\nand a load force is exerted in opposition to the motor transport. For large opposing fluid flows, the\ncargo may significantly change shape in response to the flow.\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n41\n\nThe motor protein is modeled as a Brownian Ratchet (41; 66) and the cargo vesicle\nis modeled by a triangulated mesh which forms a membrane enclosing a spherical\nvolume. The nodes of the mesh are linked together by springs of the form given in\nequation 5.33 with non-zero rest lengths determined by the distance between nodes\nin an initial spherical configuration. The cargo is linked at the vesicle surface to the\nmotor by a spring of the form given by equation 5.33 with a non-zero rest length of\napproximately 100 nm. The spherical vesicle has a radius of 125nm and the ratcheting\nintervals (light and dark inset of Figure 5.9) are of length 100 nm.\n\nFig. 5.9. The mean motor velocity vs the hydrodynamic drag force. The data points joined by\nthe solid curve shows the mean motor velocity X\u03c4 /\u03c4 obtained from simulations over approximately\n\u03c4 = 3ms. The dashed curve shows the mean velocity for an idealized ratchet having a viscous drag\ncomparable to the spherical vesicle and subject to a constant load force the same strength as the\nhydrodynamic drag force (41; 66).\n\nTo examine how the mean velocity of transport by the motor protein behaves under different loading conditions, simulations were performed in which a hydrodynamic\ndrag force is generated on the vesicle cargo by a bulk flow of the fluid (8; 41). The mean\nvelocity for different strengths of the countering fluid flow is plotted in Figure 5.9,\nwhere we see that for significantly large opposing flow, the motor can almost be made\nto \"stall\". The stochastic immersed boundary method allows for hydrodynamic effects\nassociated with the shape and deformation of cargos to be investigated. These effects,\nnot typically considered in other numerical simulation approaches for molecular motors, may have important consequences for motor/polymerization ratchet transport\nwhen more details of the motor are taken into account or with more complex cargos\nsuch as membrane tubes, small cell organelles, or chromosomes (8; 43; 69). More\nsophisticated models can also be formulated within the stochastic immersed boundary method framework, such as the case in which multiple motor proteins transport\na common cargo, interact by crosslink cytoskeletal filaments, or include additional\nmechanical degrees of freedom of the motor protein itself. Some movies of our motor\nprotein model transport simulations can be found in the Supplemental Materials.\n\n\f42\n\nP. ATZBERGER, P. KRAMER\n\n6. Conclusion and Discussion. In this work we have discussed how thermal\nfluctuations can be incorporated into the immersed boundary method in a manner\nconsistent with the laws of statistical mechanics. A new stochastic numerical method\nwas proposed that allows for a range of time steps to be taken in which the fastest\ndegrees of freedom of the fluid-particle system are either underresolved, partially\nresolved, or fully resolved. In addition, the numerical method was designed to take into\naccount in a systematic way the statistical contributions of the thermal fluctuations\nover long time steps with the correct correlations between the particles and fluid.\nTo investigate the behavior of the immersed boundary framework and the stochastic numerical method with respect to well-known laws in statistical physics a number\nof theoretical results were obtained for the method and compared with numerical\nsimulations. In particular, it was shown that immersed particles simulated with the\nnumerical method exhibit the correct scaling in the physical parameters for the mean\nsquared displacement in three dimensions. It was also shown that the stochastic numerical method captured inertial effects of the fluid with a velocity autocorrelation\nfunction for a particle that for long times decays with algebraic order \u03c4 \u22123/2 . We\nfurther found that particles appear to have the correct Boltzmann equilibrium statistics. Moreover, the method was found to produce the van't Hoff law of osmosis for\na particle confined to a spherical chamber recovering the correct osmotic pressure.\nIn addition results were presented which showed how the osmotic pressure could be\ncomputed for interacting pairs of particles and worm-like chain polymers, including a\ntrefoil and figure eight polymer knot. A more complex application of a basic model\nof a molecular motor protein immersed in a fluid and towing a vesicle-bound cargo\nsubject to a hydrodynamic drag force was simulated and the force-velocity statistics\ncomputed.\nThese basic physical checks indicate that the stochastic immersed boundary method\nhas the capability to capture many important features of thermally fluctuating systems involving immersed structures which interact with a fluid. The results presented\nsuggest the promise of the stochastic immersed boundary method as an effective approach in modeling and simulating the mechanics of biological systems at the cellular\nand intracellular level.\n\nAcknowledgments. The author P.J.A was supported by NSF VIGRE Postdoctoral Research Fellowship Grant DMS - 9983646 and NSF Mathematical Biology\nGrant DMS - 0635535. The authors would like to thank Eric Vanden-Eijnden and\nDavid Cai for helpful discussions on analytical and physical aspects of the work, and\nTom Bringley for a careful reading of a preliminary draft. The authors also thank\nDavid McQueen for discussions concerning the immersed boundary method and Yuri\nLov for lending computational resources used to obtain some of the numerical results. We are especially indebted to George Oster, whose vision of direct numerical\nsimulation of osmotic phenomena via random forces inspired this work.\n\nAppendix A. The Representation Function \u03b4a for Immersed Particles.\nIn the immersed boundary method, it is required that a function \u03b4a be specified to\nrepresent the elementary particles. The representation of this function is often derived\nfrom the following function \u03c6 which is known to have desirable numerical properties\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n43\n\n(64):\n\n(A.1)\n\n\u03c6(r) =\n\n\uf8f1\n0\n, if r \u2264 \u22122\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u221a\n\u0001\n\uf8f4\n\uf8f4\n1\n\uf8f4\n\u22127 \u2212 12r \u2212 4r2\n, if \u22122 \u2264 r \u2264 \u22121\n\uf8f4\n8 5 + 2r \u2212\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\u221a\n\u0001\n\uf8f4\n\uf8f4\n, if \u22121 \u2264 r \u2264 0\n\uf8f2 18 3 + 2r + 1 \u2212 4r \u2212 4r2\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3\n\n1\n8\n\n3 \u2212 2r +\n\n1\n8\n\n5 \u2212 2r \u2212\n\n0\n\n\u221a\n\u221a\n\n1 + 4r \u2212 4r2\n\n\u0001\n\n\u22127 + 12r \u2212 4r2\n\n, if 0 \u2264 r \u2264 1\n\n\u0001\n\n, if 1 \u2264 r \u2264 2\n, if 2 \u2264 r.\n\nFor three dimensional systems the function \u03b4a representing elementary particles\nof size a is\n\u0012 (1) \u0013 \u0012 (2) \u0013 \u0012 (3) \u0013\nr\nr\nr\n1\n(A.2)\n\u03c6\n\u03c6\n,\n\u03b4a (r) = 3 \u03c6\na\na\na\na\nwhere the superscript indicates the index of the vector component.\nTo maintain good numerical properties, the particles are restricted to sizes a =\nn\u2206x, where n is a positive integer. For a derivation and a detailed discussion of the\nproperties of these functions see (64).\nAppendix B. The Fourier Coefficients of the Function \u03b4a Used to Represent an Immersed Particle. Throughout the paper it will be useful to consider\nthe Fourier coefficients of the function \u03b4a (x \u2212 X) used to represent an elementary\nparticle situated at position X. While the function is defined for all x \u2208 \u039b, it is\noften useful to consider the restriction of the function to the discrete lattice points\n{xm = m\u2206x|m \u2208 Z3N }.\nWe will use the following notation to denote the discrete Fourier transform of the\ndelta function restricted to the lattice:\n1 X\n\u03b4\u0302a,k (X) = 3\n(B.1)\n\u03b4a (xm \u2212 X) exp (\u2212i2\u03c0k * m/N ) .\nN m\nThe dependence of the Fourier coefficients on the particle position X (relative to the\nlattice) is explicitly noted. When the dependence on X is not explicitly noted, then\nwe will be referring implicitly to the discrete Fourier transform of the delta function\nwhen centered on a lattice point: \u03b4\u0302a,k := \u03b4\u0302a,k (0).\nAppendix C. Autocorrelation Function for the Velocity Field of the\nFluid. In this section the autocorrelation function is computed for the velocity field\nof the fluid in the absence of force fprt = 0. This is done by representing the velocity\nfield in Fourier space and computing the autocorrelation function of each mode k.\nFrom equation 3.56 and standard stochastic calculus the steady-state autocorrelation\nfunction of the kth mode when s > r is\n\u0011\n\u0010\n(C.1)\nE \u00fbk (s) * \u00fbk (r)\n\u0013\nZ r\nZ s\n\u2212\u03b1k (s\u2212q) \u22a5\n(C.2)\ne\u2212\u03b1k (r\u2212w) \u2118\u22a5\nd\nB\u0303\n(w)\n*\ne\n\u2118\nd\nB\u0303\n(q)\n,\n= 2Dk E\nk\nk\nk\nk\n\u2212\u221e\n\n\u2212\u221e\n\n\f44\n\nP. ATZBERGER, P. KRAMER\n\nwhere the notation \u2118\u22a5\nk denotes projection orthogonal to \u011dk as defined in Subsection\n3.3.2.\nBy applying Ito's Isometry to C.2, and observing the symmetry under the interchange s \u2194 r, the autocorrelation function is given by\n(\n\u0010\n\u0011\nk \u2212\u03b1k |s\u2212r|\nif k \u2208 K\n3D\n\u03b1k e\nE \u00fbk (s) * \u00fbk (r) =\n(C.3)\nDk \u2212\u03b1k |s\u2212r|\n4 \u03b1k e\nif k 6\u2208 K\n= \u03a5k\n\nkB T \u2212\u03b1k |s\u2212r|\ne\n,\n\u03c1L3\n\n\u001a\n\nk\u2208K\nk 6\u2208 K,\n\nwhere\n\u03a5k =\n\n(C.4)\n\n3,\n2,\n\nand the index set K is defined in 3.29.\nThe factor \u03a5k arises from the incompressibility constraint 3.22, the real-valuedness\nconstraint 3.25, and the dimensionality of the space orthogonal to \u011dk . See Subsection\n3.3.3 for a discussion of how the constraints affect Dk .\nThe spatio-temporal correlation function of the velocity field u is then given by\n\u0011\nXX \u0010\nE (um (s) * un (r)) =\nE \u00fbk (s) * uk\u2032 (r) exp (i2\u03c0(n * k\u2032 \u2212 m * k)/N )\nk\n\n(C.5)\n\n=\n\nX\nk\n\nk\u2032\n\n\u0010\n\u0011\nE \u00fbk (s) * \u00fbk (r) exp (i2\u03c0(n \u2212 m) * k/N )\n\nkB T X\n=\n\u03a5k e\u2212ak |s\u2212r| exp (i2\u03c0(n \u2212 m) * k/N ) .\n\u03c1L3\nk\n\nTo obtain the second equality, we used the statistical independence of the Fourier\nmodes of the velocity field when the indices k and k\u2032 are distinct and do not correspond\nto conjugate modes (see 3.25). When the indices k and k\u2032 do refer to conjugate but\ndistinct modes, then the average vanishes because a mean zero random variable Z\nwith independent and identically distributed real and imaginary components satisfies\nhZ 2 i = 0. The last equality follows by substitution from equation C.3.\nAppendix D. Constants: Accuracy and Error Estimates. The nondimensional factors Q appearing in the error estimates in Section 4 are approximately\nindependent of the physical parameters. For comparison of the theoretical error estimates with numerical simulations, it is useful to compute the factors for specific\nphysical parameters to obtain estimated values. Evaluation of the expressions for the\nQ constants for the system with parameters given in Table 4.2 gives the following\nvalues:\n(D.1)\n\nQ1 = 0.563\n\n(D.2)\n\nQ2 = 7.87.\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n45\n\nReferences.\n[1] P. J. Atzberger and C.S Peskin, A Three Dimensional Brownian Dynamics Model of Kinesin Incorporating the Coiled-Coil Cargo Tether , Bulletin of\nMathematical Biology, (to appear)\n[2] P. J. Atzberger and P. R. Kramer, Error Analysis of a Stochastic Immersed\nBoundary Method Incorporating Thermal Fluctuations, (submitted 2006)\n[3] P. J. Atzberger, Stochastic Analysis of the Immersed Boundary Method with\nThermal Fluctuations, (in preparation 2006)\n[4] P. J. Atzberger and Charles S. Peskin, Pumping Fluids with Osmotic\nEffects (in preparation 2006)\n[5] P. J. Atzberger and Peter R. Kramer, A Microscopic Theory of Osmosis\n(in preparation 2006)\n[6] B. J. Alder and T. E. Wainwright, Decay of the Velocity Autocorrelation\nFunction, Phys. Rev. A, vol. 1 num. 1 (1970), pp. 18\u201321.\n[7] R. J. Adler, On excursion sets, tube formulas and maxima of random fields,\nAnnals of Applied Probability, 10 (2000), pp. 1\u201374.\n[8] B. Alberts, A. Johnson, J. Lewis, M. Raff, K. Roberts, and\nP. Walker, Molecular Biology of the Cell, Garland Publishing, 2002.\n[9] J. B. Avalos and A. D. Mackie, Dissipative particle dynamics with energy\nconservation, Europhys. Lett., 40 (1997), pp. 141\u2013146.\n[10] D. A. Beard and T. Schlick, Inertial stochastic dynamics. II. Influence of\ninertia on slow kinetic processes of supercoiled DNA, J. Comp. Phys, 112 (2000),\npp. 7323\u20137338.\n[11] D. A. Beard and T. Schlick, Computational modeling predicts the structure\nand dynamics of chromatin fiber, Structure, 9 (2001), pp. 105\u2013114.\n[12] D. Boal, Mechanics of the Cell, Cambridge University Press, Cambridge, U.K.,\n2002.\n[13] L. Bocquet, From a stochastic to a microscopic approach to Brownian motion,\nActa Physica Polonica B, 29 (1998), pp. 1551\u20131564.\n[14] G. Bossis and J. F. Brady, Dynamic simulation of sheared suspensions. I.\nGeneral method, J. Chem. Phys., 80 (1984), pp. 5141\u20135154.\n[15] J. F. Brady and G. Bossis, Stokesian dynamics, in Annual review of fluid\nmechanics, vol. 20 of Annu. Rev. Fluid Mech., Annual Reviews, Palo Alto, CA,\n1988, pp. 111\u2013157.\n[16] E. G. D. Cohen, Fundamental Problems in Statistical Mechanics III, International Summer School on Fundamental Problems in Statistical Mechanics, (1974).\n[17] S. Corrsin, Atmospheric Diffusion and Air Pollution, edited by F. N. Frenkiel\nand P.A. Shappard, vol. 6, 1960.\n[18] W. K. Den Otter and J. H. R. Clarke, A new algorithm for dissipative\nparticle dynamics, Europhys. Lett., 53 (2001), pp. 426\u2013431.\n[19] J. M. Deutch and I. Oppenheim, The concept of Brownian motion in modern\nstatistical mechanics, in Brownian Motion, vol. 83 of Faraday Discuss. Chem.\nSoc., London, 1987, The Faraday Division of the Royal Society of Chemistry,\nThe Royal Society of Chemistry, pp. 1\u201320.\n[20] J. R. Dorfman and E. G. D. Cohen, Velocity Correlation Functions in Two\nand Three Dimensions, Phys. Rev. Lett, vol. 25, num. 18, (1970), pp. 1257\u20131260.\n[21] A. Einstein, Investigations on the Theory of the Brownian Movement, Dover\nPublishing, New York, (1956).\n[22] D. L. Ermak and J. A. McCammon, Brownian dynamics with hydrodynamic\n\n\f46\n\nP. ATZBERGER, P. KRAMER\n\ninteractions, J. Chem. Phys., 69 (1978), pp. 1352\u20131360.\n[23] M. H. Ernst and E. H. Hauge and J. M. J. van Leeuwen, Asymptotic\nTime Behavior of Correlation Functions.I. Kinetic Terms, Phys. Rev. A, vol. 4,\nnum. 5, (1971), pp. 2055\u20132065.\n[24] P. Espa\u00f1ol, Dissipative particle dynamics with energy conservation, Europhys.\nLett., 40 (1997), pp. 631\u2013636.\n[25] P. Espa\u00f1ol and P. Warren, Statistical mechanics of dissipative particle dynamics, Europhys. Lett., 30 (1995), pp. 191\u2013196.\n[26] A. Evilevitch, L. Lavelle, C. M. Knobler, E. Raspaud, and W. M.\nGelbart, Osmotic pressure inhibition of dna ejection from phage, Proceedings\nof the National Academy of Science, 100 (2003), pp. 9292\u20139295.\n[27] C. P. Fall, E. S. Marland, J. M. Wagner, and J. J. Tyson, eds., Computational cell biology, vol. 20 of Interdisciplinary Applied Mathematics, SpringerVerlag, New York, 2002.\n[28] L. J. Fauci and A. L. Fogelson, Truncated Newton Method and the Modeling\nof Complex Immersed Elastic Structures, Communication on Pure and Applied\nMathematics, XLVI (1993), pp. 787\u2013818.\n[29] L. Fradkin, Comparison of Lagrangian and Eulerian approaches to turbulent\ndiffusion, Plasma Physics and Controlled Fusion, 33 (1991), pp. 685\u2013701.\n[30] Garc\u0131\u0301a-Archilla, B. and Sanz-Serna, J. M. and Skeel, R. D., Long-timestep methods for oscillatory differential equations, SIAM Journal of Scientific\nComputing, 20 (1999), pp. 930 \u2013 963.\n[31] C. W. Gardiner, Handbook of stochastic methods, Springer Series in Synergetics, 1985\n[32] E. Givelberg and J. Bunn, Detailed simulation of the cochlea: Recent progress\nusing large shared memory parallel computers, CACR Technical Report CACR190, (2001).\n[33] N. Gov and S. A. Safran, Red-blood cell membrane fluctuations and shape\ncontrolled by ATP-induced cytoskeletal defects, Biophysical Journal BioFAST,\n(2004).\n[34] H. P. Grimm, A. B. Verkhovsky, A. Mogilner, and J. J. Meister, Analysis of actin dynamics at the leading edge of crawling cells: implications for\nthe shape of keratocyte lamellipodia, European Biophysical Journal, 32 (2003),\npp. 563 \u2013 577.\n[35] R. D. Groot and P. B. Warren, Dissipative particle dynamics: Bridging the\ngap between atomistic and mesoscopic simulation, J. Chem. Phys., 107 (1997),\npp. 4423\u20134435.\n[36] E. Hairer and C. Lubich, Long-Time Energy Conservation of Numerical\nMethods for Oscillatory Differential Equations, SIAM Journal of Numerical Analysis, 38 (2000), pp. 414 \u2013 441.\n[37] Hauge, E. H. and Martin-L\u00f6f, A., Fluctuating hydrodynamics and Brownian\nmotion, vol. 7, (1973), pp. 259\u2013281.\n[38] E. J. Hinch, Application to the Langevin Equation to Fluid Suspensions, Journal\nof Fluid Mechanics, 72, (1975), pp. 499\u2013511.\n[39] P. J. Hoogerbrugge and J. M. V. A. Koelman, Simulating microscopic\nhydrodynamic phenomena with dissipative particle dynamics, Europhys. Lett., 19\n(1992), pp. 155\u2013160.\n[40] F. C. Hoppensteadt and C. Peskin, Modeling and Simulation in Medicine\nand the Life Sciences, Springer (2002).\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n47\n\n[41] J. Howard, Mechanics of Motor Proteins and the Cytoskeleton, Sinauer Associates, Sunderland, CN, 2001.\n[42] A. Kassam and L. N. Trefethen, Fourth-Order Time-Stepping for Stiff\nPDEs, SIAM Journal of Scientific Computing, 26(4) (2005), pp. 1214\u20131233.\n[43] G. Koster and M. VanDuijn and B. Hofs and M. Dogterom, Membrane tube formation from giant vesicles by dynamic association of motor proteins, Proceedings of the National Academies of Science, 100(26) December 2003,\npp. 15583\u201315588.\n[44] P. E. Kloeden and E. Platen, Numerical solution of stochastic differential\nequations, Springer-Verlag, 1992.\n[45] P. R. Kramer and C. S. Peskin , Incorporating thermal fluctuations into\nthe immersed boundary method, Proceedings of the Second MIT Conference on\nComputational Fluid and Solid Mechanics, K. K. Bathe, ed. Elsevier, 2 (2003),\npp. 1755\u20131758.\n[46] P. R. Kramer and A. J. Majda, Stochastic mode reduction for the immersed\nboundary method, SIAM J. Appl. Math., 64 (2003/04), pp. 369\u2013400 (electronic).\n[47] R. Kubo, M. Toda, and N. Hashitsume, Statistical physics. II, SpringerVerlag, Berlin, second ed., 1991, section 4. Nonequilibrium statistical mechanics.\n[48] A. J. C. Ladd, Numerical simulations of particulate suspensions via a discretized\nboltzmann equation. Part 1. Theoretical foundation, J. Fluid Mech., 271 (1994),\npp. 285\u2013309.\n[49] L. D. Landau and E. M. Lifshitz, Course of theoretical physics. Vol. 9:\nStatistical physics, Pergamon Press, Oxford, 1980, ch. IX.\n[50] L. D. Landau and E. M. Lifshitz, Course of theoretical physics. Vol. 6: Fluid\nMechanics, Butterworth-Heinemann, Oxford, 1987, ch. II.\n[51] R. Lipowsky, Statistical Mechanics of Biocomplexity, Springer, 1999.\n[52] A. J. Majda, I. Timofeyev, and E. Vanden Eijnden, A mathematical\nframework for stochastic climate models, Comm. Pure Appl. Math., 54 (2001),\npp. 891\u2013974.\n[53] C. A. Marsh and J. M. Yeomans, Dissipative particle dynamics: The equilibrium for finite time steps, Europhys. Lett., 37 (1997), pp. 511\u2013516.\n[54] P. Mazur, Fluctuating Hydrodynamics and Renormalization of Susceptibilities\nand Transport Coefficient, Fundamental Problems in Statistical Mechanics III,\nInternational Summer School on Fundamental Problems in Statistical Mechanics,\n(1974), pp. 389\u2013414.\n[55] X. Meng, A computational model of flow through porous media at the microscale,\nPh.D. thesis, Department of Mathematics, Tulane University, New Orleans,\nLouisiana 70118. July 1998.\n[56] L. Miller and C. Peskin, When vortices stick: an aerodynamic transition in\ntiny insect flight, J Exp Biol., 207 (2004), pp. 3073\u20133088.\n[57] Milstein, G. N. and Repin, Yu. M. and Tretyakov, M. V., Numerical\nmethods for stochastic systems preserving symplectic structure, SIAM Journal of\nNumerical Analysis, 40 (2002), pp. 1583 \u2013 1604.\n[58] P. Nikunen, M. Karttunen, and I. Vattulainen, How would you integrate\nthe equations of motion in dissipative particle dynamics simulations?, Computer\nPhysics Communications, 153 (2003), pp. 407\u2013423.\n[59] B. Oksendal, Stochastic Differential Equations: An Introduction with Applications. Springer, 2000\n[60] G. Oster and A. Mogilner, Force generation by cellular polymers.\n\n\f48\n\nP. ATZBERGER, P. KRAMER\n\nSupramolecular Polymers, A. Ciferri (ed.), New York:Dekker (in press), 2005.\n[61] G. Oster and C. S. Peskin, Dynamics of osmotic fluid flow, in Swelling Mechanics: From Clays to Living Cells and Tissues, T. Karalis, ed., Springer-Verlag,\nBerlin, 1992, pp. 731\u2013742.\n[62] H.C. \u00d6ttinger and Y. Rabin, Diffusion Equation versus Coupled Langevin\nEquations Approach to Hydrodynamics of Dilute Polymer Solutions, Journal of\nRheology, 33(5) (1989), pp. 725\u2013743.\n[63] I. Pagonabarraga, M. H. J. Hagen, and D. Frenkel, Self-consistent dissipative particle dynamics algorithm, Europhys. Lett., 42 (1998), pp. 377\u2013382.\n[64] C. S. Peskin, The immersed boundary method, Acta Numerica, 11 (2002), pp. 1\u2013\n39.\n[65] C. Peskin and D. McQueen, Shared-memory parallel vector implementation\nof the immersed boundary method for the computation of blood flow in the beating\nmammalian heart., Journal of Supercomputing, 11 (1997), pp. 213\u2013236.\n[66] C. S. Peskin, Cellular Motions and Thermal Fluctuations: The Brownian\nRatchet, Biophysical Journal, 65 (1993), pp. 3161\u2013324.\n[67] Y. Pomeau and P. R\u00e9sibois, Time Dependent Correlation Functions and\nMode-Mode Coupling Theories, Phys. Rep. vol.19C, num. 2 (1975), pp.63\u2013139\n[68] W. H. Press and Saul A. Teukolsky and W. T. Vetterling and B. P.\nFlannery, Numerical Recipes, Cambridge University Press, 2002\n[69] A. Raj, The influence of chromosome flexibility on chromosome transport during anaphase A, Proceedings of National Academy of Sciences, 103(14), April\n2006, pp. 5349\u20135354.\n[70] L. E. Reichl, A modern course in statistical physics, John Wiley & Sons Inc.,\nNew York, second ed., 1998\n[71] P. Reimann, Introduction to the physics of Brownian motors, Appl. Phys A, 75\n(2002), pp. 169\u2013178.\n[72] D. N. Robinson and J. A. Spudich, Mechanics and regulation of cytokinesis,\nCurrent Opinion in Cell Biology, 16 (2004), pp. 182\u2013188.\n[73] J.-N. Roux, Brownian particles at different times scales: a new derivation of\nthe Smoluchowski equation, Phys. A, 188 (1992), pp. 526\u2013552.\n[74] J. M. Sanz-Serna and M. P. Calvo, Numerical Hamiltonian problems, Chapman & Hall, 1994\n[75] T. Schlick, Molecular Modeling and Simulation: An Interdisciplinary Guide,\nvol. 21 of Interdisciplinary Applied Mathematics, Springer-Verlag, Berlin, 2002.\n[76] N. Sharma and N. A. Patankar, Direct numerical simulation of the brownian\nmotion of particles by using fluctuating hydrodynamic equations, J. Comp. Phys,\n201 (2004), pp. 466\u2013486.\n[77] A. Sierou and J. F. Brady, Accelerated Stokesian Dynamics simulations, J.\nFluid Mech., 448 (2001), pp. 115\u2013146.\n[78] K. Berg-Sorensen and H. Flyvbjerg, The colour of thermal noise in classical Brownian motion: a feasibility study of direct experimental observation, New\nJournal of Physics, 7 (2005)\n[79] M. Talagrand, Sharper bounds for gaussian and empirical processes, Annals\nof Probability, 22 (1994), pp. 28\u201376.\n[80] D. Talay, Simulation of stochastic processes and applications in Foundations of\ncomputational mathematics, Cambridge Univ. Press, 284, (2001) pp. 345\u2013359.\n[81] J. A. Theriot, The polymerization motor, Traffic, 1 (2000), pp. 19\u201328.\n[82] J. Weinstock, Lagrangian Eulerian relation and the independence approxima-\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\n\n49\n\ntion, Physics of Fluids, 19 (1976), pp. 1702\u20131711.\n[83] C. Wolgemuth, A. Mogilner and G. Oster, The hydration dynamics of\npolyelectrolyte gels with applications to cell motility and drug delivery, European\nBiophysics Journal, 33 (2004), pp. 146\u2013158.\n[84] T. Wittman, A. Hyman, and A. Desai, The spindle: a dynamic assembly of\nmicrotubules and motors, Nature Cell Biology, 3 (2001), pp. E28 \u2013 E34.\n\n\f50\n\nP. ATZBERGER, P. KRAMER\n\nTables.\n\n\fSTOCHASTIC IMMERSED BOUNDARY METHOD\nTable 4.1\nParameters of the Method\n\nParameter\nkB\nT\nL\n\u03bc\n\u03c1\nN\n\u2206t\n\u2206x\na\n\nDescription\nBoltzmann's constant\nTemperature\nPeriod Length of Fluid Domain\nFluid Dynamic Viscosity\nFluid Density\nNumber of Grid Points in each Dimension\nTime Step\nSpace Between Grid Points\nEffective Elementary Particle Size (approximate radius)\n\nTable 4.2\nValues used in Numerical Simulations\n\nParameter\nT\nL\n\u03bc\n\u03c1\nN\n\nDescription\n300 K\n1000 nm\n6.02 \u00d7 105 amu/(nm * ns)\n602 amu/nm3\n32\n\n51\n\n\f52\n\nP. ATZBERGER, P. KRAMER\nTable 4.3\nNotation Conventions\n\nParameter\n\u03b4a\n\u03b4a,k\n\u03b1k\nDk\num\n\u00fbk\nU\nxm\nX[j]\nfprt\nfthm\nf\u0302k\n\nDescription\nRepresentation function of an immersed elementary particle of size a\nThe kth Fourier coefficient of the particle representation function\nDamping of the kth Fourier mode\nStrength of the thermal forcing of the kth Fourier mode\nFluid velocity at the mth grid point\nThe kth Fourier mode of the fluid velocity field\nSmoothed fluid velocity field for immersed elementary particles\nPosition vector of the mth Eulerian grid point\nPosition vector of the j th immersed elementary particle\nForce density arising from the immersed structures\nForce density arising from the thermal forcing\nThe kth Fourier mode of the structural force density field\n\n\f"}