{"id": "http://arxiv.org/abs/0801.0054v2", "guidislink": true, "updated": "2008-09-23T11:22:23Z", "updated_parsed": [2008, 9, 23, 11, 22, 23, 1, 267, 0], "published": "2007-12-29T11:31:42Z", "published_parsed": [2007, 12, 29, 11, 31, 42, 5, 363, 0], "title": "Statistical properties of the Calkin--Wilf tree: real an p-adic\n  distribution", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.1452%2C0801.0628%2C0801.1066%2C0801.4698%2C0801.4893%2C0801.0256%2C0801.0805%2C0801.1690%2C0801.3271%2C0801.2226%2C0801.1385%2C0801.0899%2C0801.3662%2C0801.1299%2C0801.0023%2C0801.4032%2C0801.2798%2C0801.1250%2C0801.1335%2C0801.0791%2C0801.2871%2C0801.2373%2C0801.3841%2C0801.1731%2C0801.4809%2C0801.3038%2C0801.2825%2C0801.3066%2C0801.4585%2C0801.1989%2C0801.4646%2C0801.1702%2C0801.4236%2C0801.3330%2C0801.0981%2C0801.2931%2C0801.1541%2C0801.2048%2C0801.4749%2C0801.2548%2C0801.4187%2C0801.0999%2C0801.4443%2C0801.3939%2C0801.3777%2C0801.3001%2C0801.3933%2C0801.4798%2C0801.3082%2C0801.0216%2C0801.4554%2C0801.4001%2C0801.3277%2C0801.2879%2C0801.4870%2C0801.3571%2C0801.4233%2C0801.3778%2C0801.0054%2C0801.3377%2C0801.3183%2C0801.0060%2C0801.3165%2C0801.2574%2C0801.0647%2C0801.1943%2C0801.0609%2C0801.0168%2C0801.1315%2C0801.2432%2C0801.4161%2C0801.3658%2C0801.3247%2C0801.4123%2C0801.4382%2C0801.2927%2C0801.2906%2C0801.4478%2C0801.4938%2C0801.0987%2C0801.1293%2C0801.2990%2C0801.2146%2C0801.0378%2C0801.0061%2C0801.3217%2C0801.1274%2C0801.1099%2C0801.1126%2C0801.1531%2C0801.3724%2C0801.2252%2C0801.3522%2C0801.2935%2C0801.2577%2C0801.3504%2C0801.1962%2C0801.4048%2C0801.0373%2C0801.2826%2C0801.4141&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Statistical properties of the Calkin--Wilf tree: real an p-adic\n  distribution"}, "summary": "We examine statistical properties of the Calkin--Wilf tree and give\nnumber-theoretical applications.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=0801.1452%2C0801.0628%2C0801.1066%2C0801.4698%2C0801.4893%2C0801.0256%2C0801.0805%2C0801.1690%2C0801.3271%2C0801.2226%2C0801.1385%2C0801.0899%2C0801.3662%2C0801.1299%2C0801.0023%2C0801.4032%2C0801.2798%2C0801.1250%2C0801.1335%2C0801.0791%2C0801.2871%2C0801.2373%2C0801.3841%2C0801.1731%2C0801.4809%2C0801.3038%2C0801.2825%2C0801.3066%2C0801.4585%2C0801.1989%2C0801.4646%2C0801.1702%2C0801.4236%2C0801.3330%2C0801.0981%2C0801.2931%2C0801.1541%2C0801.2048%2C0801.4749%2C0801.2548%2C0801.4187%2C0801.0999%2C0801.4443%2C0801.3939%2C0801.3777%2C0801.3001%2C0801.3933%2C0801.4798%2C0801.3082%2C0801.0216%2C0801.4554%2C0801.4001%2C0801.3277%2C0801.2879%2C0801.4870%2C0801.3571%2C0801.4233%2C0801.3778%2C0801.0054%2C0801.3377%2C0801.3183%2C0801.0060%2C0801.3165%2C0801.2574%2C0801.0647%2C0801.1943%2C0801.0609%2C0801.0168%2C0801.1315%2C0801.2432%2C0801.4161%2C0801.3658%2C0801.3247%2C0801.4123%2C0801.4382%2C0801.2927%2C0801.2906%2C0801.4478%2C0801.4938%2C0801.0987%2C0801.1293%2C0801.2990%2C0801.2146%2C0801.0378%2C0801.0061%2C0801.3217%2C0801.1274%2C0801.1099%2C0801.1126%2C0801.1531%2C0801.3724%2C0801.2252%2C0801.3522%2C0801.2935%2C0801.2577%2C0801.3504%2C0801.1962%2C0801.4048%2C0801.0373%2C0801.2826%2C0801.4141&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "We examine statistical properties of the Calkin--Wilf tree and give\nnumber-theoretical applications."}, "authors": ["Giedrius Alkauskas", "J\u00f6rn Steuding"], "author_detail": {"name": "J\u00f6rn Steuding"}, "author": "J\u00f6rn Steuding", "arxiv_comment": "19 pages (preprint). Some results of this paper are already\n  well-known, some (p-adic distribution and properties of the moments) are new\n  and will be merged into paper arXiv:0801.0051", "links": [{"href": "http://arxiv.org/abs/0801.0054v2", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/0801.0054v2", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.NT", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "11A55, 26A30", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/0801.0054v2", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/0801.0054v2", "journal_reference": null, "doi": null, "fulltext": "arXiv:0801.0054v2 [math.NT] 23 Sep 2008\n\nSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF\nTREE: REAL AN p\u2212ADIC DISTRIBUTION\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\nAbstract. We examine statistical properties of the Calkin\u2013Wilf\ntree and give number-theoretical applications.\n\n1. A mean-value related to the Calkin\u2013Wilf tree\nThe Calkin\u2013Wilf tree is generated by the iteration\na\nb\n\na\n,\na+b\n\n7\u2192\n\na+b\n,\nb\n\na\nstarting from the root 11 ; the number a+b\nis called the left child of ab\nand a+b\nthe right child; we also say that ab is the mother of its children.\nb\nRecently, Calkin & Wilf [1] have shown that this tree contains any\npositive rational number once and only once, each of which represented\nas a reduced fraction. The first iterations lead to\n\n1\n3\n1\n4\n\n\u0007\u0007\u0007\n\nu\nuu\nuu\nu\nu\n\n1\n2\n\njjj\njjjj\nj\nj\nj\nj\njjjj\nII\nII\nII\nI\n3\n2\n\n777\n4\n3\n\n3\n5\n\n\u0007\u0007\u0007\n\n1\n1\n\nTTTT\nTTTT\nTTTT\nTTT\nu\nuu\nuu\nu\nu\n2\n3\n\n777\n2\n5\n\n5\n2\n\n\u0007\u0007\u0007\n\n2\n1\n\nII\nII\nII\nI\n\n777\n5\n3\n\n3\n4\n\n\u0007\u0007\u0007\n\n3\n1\n\n777\n4\n1\n\nReading the tree line by line, the Calkin\u2013Wilf enumeration of Q+ starts\nwith\n1 1 2 1 3 2 3 1 4 3 5 2 5 3 4\n, , , , , , , , , , , , , , , ...\n1 2 1 3 2 3 1 4 3 5 2 5 3 4 1\nAs recently pointed out by Reznick [10], this sequence was already\ninvestigated by Stern [12] in 1858. This sequence satisfies also the\niteration\nx1 = 1,\n\nxn+1 = 1/(2[xn ] + 1 \u2212 xn ),\n1\n\n\f2\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\nwhere [x] denotes the largest integer \u2264 x; this observation is due to\nNewman (cf. [8]), answering a question of D.E. Knuth, resp. Vandervelde & Zagier (cf. [11]).\nThe Calkin\u2013Wilf enumeration of the positive rationals has many interesting features. For instance, it encodes the hyperbinary representations of all positive integers (see [1]). Furthermore, it can be used\nas model for the game Euclid first formulated by Cole & Davie [2]; see\nHofmann, Schuster & Steuding [5]. In this short note we are concerned\nwith statistical properties of the Calkin\u2013Wilf tree.\nWe write the nth generation of the Calkin\u2013Wilf tree as CW (n) =\n(n)\n(j)\n{xj }j , where the xn are the elements ordered according to their apS\n(n)\n.\npearance in the nth line of the Calkin\u2013Wilf tree. So Q+ = \u221e\nn=1 CW\n(n)\nn\u22121\nObviously, CW consists of 2\nelements. Denote by \u03a3(n) the sum\nof all elements of the nth generation of the Calkin\u2013Wilf tree,\n\u03a3(n) =\n\nn\u22121\n2X\n\n(n)\n\nxj .\n\nj=1\n\nOur first result gives the mean-value of the elements of the nth generation of the Calkin\u2013Wilf tree:\nTheorem 1. For any n \u2208 N,\n\n1\n\u03a3(n) = 3 * 2n\u22122 \u2212 .\n2\n(n)\n\nThis result may be interpreted as follows. We observe that x1 = n1 and\n(n)\nx2n\u22121 = n1 for all n \u2208 N, and thus CW (n) is supported on an unbounded\nset as n \u2192 \u221e. However, the average value of the 2n\u22121 elements of\nthe nth generation CW (n) is approximately 23 , which is, surprisingly,\na finite number. This has a simple explanation: in some sense, small\nvalues are taken in earlier generations than large values. For instance,\nin each generation CW (n) takes as many values form the interval (0, 1)\nas from (1, \u221e). This result was also recently proved by Reznick [10];\nhis proof differs slightly from our argument.1\n1The\n\nproblem of determining the average value of the Calkin\u2013Wilf tree was\nposed by the second named author as a problem in the problem session of the IV\nInternational conference on analytic and probabilistic number theory in Palanga\n2006; an independent solution was given by Eduard Wirsing.\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n3\n\nProof by induction on n. The statement of the theorem is correct for\nn = 1 and n = 2. Now suppose that n \u2265 3. In order to prove the\nstatement for n we first observe a symmetry in the Calkin\u2013Wilf tree\nwith respect to its middle: for n \u2265 2,\n\na\nb\n(n)\n\u21d0\u21d2\nx2n\u22121 +1\u2212j = ;\n(1)\nb\na\nthis is easily proved by another induction on n (and we leave its simple\n(n)\nverification to the reader). Further, we note that xj \u2264 1 if and only\nif j is odd; here equality holds if and only if n = 1.\nNow we start to evaluate \u03a3(n). For this purpose we compute\n(\n(n)\n(n)\nxj + x2n\u22121 \u2212j for j = 1, 2, . . . , 2n\u22122 \u2212 1,\n(n)\nyj :=\n(n)\n(n)\nxj + x2j\nfor j = 2n\u22122 ,\nP n\u22122 (n)\nand add these values over j = 1, 2, . . . , 2n\u22122 . Clearly, \u03a3(n) = 2j=1 yj .\n(n)\n\nxj\n\n=\n\n(n)\n\nFirst, assume that j is odd. Then both, xj\n\n(n)\n\nless than 1. In view of (1) the mothers of xj\nform ab and ab , respectively. Hence,\n(n)\n\n(n)\n\nxj + x2n\u22121 \u2212j =\n\n(n)\n\nand x2n\u22121 \u2212j are strictly\n(n)\n\nand x2n\u22121 \u2212j are of the\n\nb\na\n+\na+b a+b\n\n(n)\n\nand thus we find yj = 1 in this case.\n(n)\n(n)\nNext, we consider the case that j is even. Then both, xj and x2n\u22121 \u2212j\n(n)\n\nare strictly greater than 1. If the mothers of xj\n\u2032\nform ab and ab\u2032 , respectively, then\n\na+b\na\n=1+\nb\nb\nHence, we find for their sum\n(n)\n\nxj\n\n=\n\n(n)\n\nand\n\n(n)\n\nxj + x2n\u22121 \u2212j = 2 +\n(n)\n\n(n\u22121)\n\n(n)\n\nand x2n\u22121 \u2212j are of the\n\n(n)\n\nx2n\u22121 \u2212j = 1 +\n\na\u2032\n.\nb\u2032\n\na a\u2032\n+ \u2032\nb\nb\n\n(n\u22121)\n\nand so yj = 2 + yk\n, where yk\nis either the sum of two elements\n(n\u22121)\n(n\u22121)\n(n\u22121)\n(n\u22121)\nxk\nand x2n\u22122 \u2212k or the sum of x2n\u22123 and x2n\u22122 .\nIt remains to combine both evaluations. Since both cases appear\nequally often, namely each 2n\u22123 times, we obtain the recurrence formula\n\u03a3(n) = \u03a3(n \u2212 1) + (1 + 2) * 2n\u22123 ,\n\n\f4\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\nbeing valid for n \u2265 3. This implies the assertion of the theorem. \u0004\n2. An application to finite continued fractions\nTheorem 1 has a nice number-theoretical interpretation. It is wellknown that each positive rational number x has a representation as a\nfinite (regular) continued fraction\nx = a0 +\n\n1\na1 + . .\n.\n\n+ am\u221211+\n\n1\nam\n\nwith a0 \u2208 N \u222a {0} and aj \u2208 N for some m \u2208 N \u222a {0}. In order to have\na unique representation, we assume that am \u2265 2 if m \u2208 N. We shall\nuse the standard notation x = [a0 , a1 , . . . , am ]. Continued fractions are\nof special interest in the theory of diophantine approximation.\nAs Bird, Gibbons & Lester [3] showed, the nth generation of the\nCalkin\u2013Wilf tree consists exactly of those rationals having a continued\nfraction expansion [a0 , a1 , . . . , am ] for which the sum of the partial quotients aj is constant n, the continued fractions of even length in the\nleft subtree, and the continued fractions with odd length in the right\nsubtree. Thus Theorem 1 yields\nCorollary 2. For any n \u2208 N,\nX\n3\n21\u2212n\n[a0 , a1 , . . . , am ] = \u2212 2\u2212n .\n2\na +a +...+a =n\n0\n\n1\n\nm\n\nOne can use the approach via continued fractions to locate any positive\nrational in the tree. This observation is due to Bird, Gibbons & Lester\n[3] (actually, their reasoning is based on Graham, Knuth & Patasnik [4]\nwho gave such a description for the related Stern\u2013Brocot tree). Given\na reduced fraction x in the Calkin\u2013Wilf tree with continued fraction\nexpansion\nx = [a0 , a1 , . . . , am\u22122 , am\u22121 , am ],\nwe associate the path\nLam \u22121 Ram\u22121 Lam\u22122 * * * La1 Ra0 if m is odd, and\n\nRam \u22121 Lam\u22121 Ram\u22122 * * * Ra1 La0 if m is even;\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n5\n\nnote that am \u2212 1 \u2265 1 for m \u2208 N. The notation Ra with a \u2208 N \u222a {0}\nmeans: a steps to the right, whereas Lb with b \u2208 N \u222a {0} stands for b\nsteps to the left. Then, starting from the root 11 and following this path\nfrom left to right, we end up with the element x. This follows easily\nfrom the iteration with which the tree was build; notice that this claim\nis essentially already contained in Lehmer [7] (this was also observed\nby Reznick [10]).\nCorollary 3. Given any non-empty interval (\u03b1, \u03b2) in R+ , and any\nfinite path in the Calkin\u2013Wilf tree, there exists a continuation of this\npath which contains a rational number from the interval (\u03b1, \u03b2).\nProof. We expand \u03b1 and \u03b2 into continued fractions, \u03b1 = [a0 , a1 , . . .]\nand \u03b2 = [b0 , b1 , . . .], say. Let k be the least index such that ak 6= bk .\nAccording to the parity of k we have ak < bk (if k is even) or ak > bk (if\nk is odd). Without loss of generality we may assume that |bk \u2212 ak | \u2265 2\n(since otherwise we may consider a subinterval of (\u03b1, \u03b2)). Moreover\nwe may suppose that the path in question is starting from the root\nand is given in the form Lcm \u22121 Rcm\u22121 Lcm\u22122 * * * Lc1 Rc0 (the other case may\nbe treated analogously). Then we construct a rational number x by\nassigning the finite continued fraction\nx = [a0 , a1 , . . . , ak\u22121 , xk , xk+1 , c0 , c1 , . . . , cm\u22122 , cm\u22121 , cm ],\nwhere xk := min{ak , bk } + 1 and xk+1 denotes the string 1 if k is odd,\nresp. 1, 1 if k is even. Since bj = aj for 0 \u2264 j < k and\nmin{ak , bk } < xk < max{ak , bk },\nit follows that \u03b1 < x < \u03b2. Since the length of the continued fraction\nexpansion has the same parity as m (thanks to the definition of xk+1 ),\nthe element x can be reached by the path Lcm\u22121 Rcm\u22121 Lcm\u22122 * * * Lc1 Rc0 .\nThis proves the corollary. \u0004\n3. A random walk on the Calkin\u2013Wilf tree\nStarting with X1 = 11 , we define a sequence of random variables by\na\nwith probability\nthe following iteration: if Xn = ab , then Xn+1 = a+b\n1\na+b\n1\nand Xn+1 = b with probability 2 . The sequence {Xn } may be\n2\n\n\f6\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\nregarded as a random walk on the Calkin\u2013Wilf tree where n is a discrete\ntime parameter.\nTheorem 4. Let (\u03b1, \u03b2) be any non-empty interval in R+ . Then, with\nprobabilty 1, the random walk {Xn } visits the interval (\u03b1, \u03b2), i.e., with\nprobability 1, there exists m \u2208 N such that xm \u2208 (\u03b1, \u03b2).\nProof. The interval (\u03b1, \u03b2) contains a non-empty subinterval [A, B]\nsuch that for any \u03b6 \u2208 [A, B] the initial partial quotients c0 , c1 , . . . , cm\nare identical: \u03b6 = [c0 , c1 , . . . , cm , . . .]. Hence, with the interval [A, B] we\nmay associate a path pattern Lcm \u22121 Rcm\u22121 Lcm\u22122 * * * Lc1 Rc0 in the CalkinWilf tree such that any path in the tree starting from the root and\nending with Lcm\u22121 Rcm\u22121 Lcm\u22122 * * * Lc1 Rc0 points to an element in [A, B].\na\nSince the probability is 12 for both ab 7\u2192 a+b\nand ab 7\u2192 a+b\n, each pattern\nb\nof fixed length m appears with the same probability and so we may\nrestrict on the path pattern Rk .\nIn the case k = 1 we find in each generation exactly one which ends\nwith R but does not contain any R before (actually, this is Ln\u22121 R in\ngeneration n). Adding up all probabilities for these paths, we get\n\u221e \u0012 \u0013j\nX\n1\n= 1,\n2\nj=1\nand so, with probability 1, the random walk Xn will go to the right\nchild for some n. Now assume that the statement is true for k. We shall\nshow that then it is also true for k + 1. For each path of the form XRk ,\nwhere X is any combination of powers of L and R, there are two paths\nXRk L and XRk+1 , so by induction the probability that the random\nwalk eventually follows the path Rk+1 is at least 21 . However, for each\npath XRk one also has to consider the subtrees starting from XRk Ld\nfor d = 1, 2, . . ., each of which containing paths which end Rk+1 . By\nself-similarity, the probability that the random walk eventually follows\nthe path Rk+1 is\n\u221e \u0012 \u0013d\n\u221e \u0012 \u0013j X\nX\n1\n1\n= 1.\n2\n2\nj=1\nd=1\n\nThis proves the theorem. \u0004\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n7\n\n4. Statistical properties of the Calkin\u2013Wilf tree\nIn view of Corollary 2 it is interesting to have a better understanding\nof the statistics of the Calkin\u2013Wilf tree. The following theorem gives\nthe limit distribution function in explicit form.\nTheorem 5. Let Fn (x) denote the distribution function of the n\u2212th\ngeneration, i.e.,\n(n)\n\nFn (x) = 21\u2212n #{j : xj\n\n\u2264 x}.\n\nThen uniformly Fn (x) \u2192 F (x), where\nF ([a0 , a1 , a2 , a3 , ...]) = 1 \u2212 2\u2212a0 + 2\u2212(a0 +a1 ) \u2212 2\u2212(a0 +a1 +a2 ) + ...\n(for rational numbers x = [a0 , a1 , . . .] this series terminates at the last\nnon-zero partial quotient of the continued fraction). Thus, F (0) = 0,\nF (\u221e) = 1, and F (x) is a monotonically increasing function. Moreover,\nF (x) is continuous and singular, i.e., F \u2032 (x) = 0 almost everywhere.\nProof. Let x \u2265 1. One half of the fractions in the n + 1\u2212st generation\ndo not exceed 1, and hence also do not exceed x. Further,\na+b\na\n\u2264x\n\u21d0\u21d2\n\u2264 x \u2212 1.\nb\nb\nHence,\n2Fn+1 (x) = Fn (x \u2212 1) + 1, n \u2265 1.\n\nNow assume 0 < x < 1. Then\na\na\nx\n\u2264x\n\u21d0\u21d2\n\u2264\n.\na+b\nb\n1\u2212x\nTherefore,\n\u0010 x \u0011\n.\n2Fn+1 (x) = Fn\n1\u2212x\nThe distribution function F , defined in the formulation of the theorem,\nsatisfies the functional equation\n(\nF (x \u2212 1) + 1\nif x \u2265 1,\n2F (x) =\nx\nif 0 < x < 1.\nF ( 1\u2212x )\n\nt\nFor instance, the second identity is equivalent to 2F ( t+1\n) = F (t) for\nt\nall positive t. If t = [b0 , b1 , ...], then t+1 = [0, 1, b0 , b1 , ..] for t \u2265 1, and\nt\n= [0, b1 + 1, b2 , ...] for t < 1, and the statement follows immediately.\nt+1\n\n\f8\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\nNow define \u03b4n (x) = F (x)\u2212Fn (x). In order to prove the first assertion\nof the theorem, the uniform convergence Fn \u2192 F , it is sufficient to show\nthat\nsup |\u03b4n (x)| \u2264 2\u2212n .\n\n(2)\n\nx\u22650\n\nIt is easy to see that the assertion is true for n = 1. Now suppose\nthe estimate is true for n. In view of the functional equation for both\nFn (x) and F (x), we have\n\u0010 x \u0011\n2\u03b4n+1 (x) = \u03b4n\n1\u2212x\nfor 0 < x < 1, which gives sup0\u2264x<1 |\u03b4n+1 (x)| \u2264 2\u2212n\u22121 . Moreover, we\nhave\n2\u03b4n+1 (x) = \u03b4n (x \u2212 1)\nfor x \u2265 1, which yields the same bound for \u03b4n (x) in the range x \u2265 1.\nThis proves (2).\nClearly, F , as a distribution function, is monotonic; obviously, it is\nalso continuous. It remains to prove that F (x) is singular. Given an\nirrational number \u03b1 = [a0 , a1 , a2 , ...], we consider the sequence\n\u03b1n = [a0 , a1 , ..., an\u22121 , an + 1, an+1 , ...];\nobviously, \u03b1n is the real number which is defined by the continued\nfraction expansion of \u03b1, where the nth partial quotient an is replaced\nby an + 1. Depending on the parity of n, \u03b1n is less than or greater\nthan \u03b1. Thus, any real number y, which is sufficiently close to \u03b1, is\ncontained between two terms of the sequence, \u03b1L and \u03b1L+2 say. Then\nF (\u03b1L ) \u2212 F (\u03b1)\nF (y) \u2212 F (\u03b1)\n\u2264\n.\ny\u2212\u03b1\n\u03b1L+2 \u2212 \u03b1\n\nFrom the explicit form of F we deduce\n\n1\n|F (\u03b1L ) \u2212 F (\u03b1)| \u2264 2\u2212(a0 +a1 +...+aL) .\n2\nOn the other hand,\n|\u03b1L+2 \u2212 \u03b1| \u2265 ([a1 , a2 , ..., aL+2 + 1, ...] \u2212 [a1 , a2 , ..., aL+2 , ...])(a0 + 1)\u22122\n\u0010\n\u0011\u22122\n\u2265 (a0 + 1)(a1 + 1)...(aL+2 + 1)\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n9\n\nby induction. Thus,\nL+2\n\nY\nF (y) \u2212 F (\u03b1)\n\u2264 21\u2212(a0 +a1 +...+aL)\n(ai + 1)2 .\ny\u2212\u03b1\ni=1\nQ\nThe theorem of Khinchin ([9], p. 86, implies that ni=1 (ai + 1)1/n tends\nto a fixed constant limit almost everywhere. On the other hand, the\nP\nsame reasoning shows that n1 ni=1 an tends to infinity for almost all x.\nThus, almost everywhere the limit\nlim (F (y) \u2212 F (\u03b1))(y \u2212 \u03b1)\u22121\n\ny\u2192\u03b1\n\nexists and is equal 0. This finishes the proof of the theorem. \u0004\nBy the same\u221a argument as for the singular behaviour of F we can\nshow that F \u2032 ( 5+1\n) = \u221e. Actually, the terms of CW (n) are densely\n2\nconcentrated around numbers with F \u2032 (x) = \u221e and scarcely around\nthose where F \u2032 (x) = 0. The value of F (x) is rational iff x is either\nrational or quadratic irrationality, e.g.\n\u221a\n\u221a\n3\n2\n1\nF (1) = , F ( 2) = , F (( 5 + 1)/2) = .\n2\n5\n3\nThis follows immediately from Lagrange's theorem which characterizes\nthe quadratic irrationals by their eventually periodic continued fraction\nexpansion. For Euler's number e = [2, 1, 2n, 1] we find that F (e) can\nbe expressed in terms of special values of Jacobi theta functions.\n5. Characteristics of the distribution function\nIn view of Corollary 2, the mean of the distribution function F is\nSince F has a tail of exponential decay, more precisely 1 \u2212 F (x) =\nO(2\u2212x), it follows that all moments exist. For k \u2208 N0 , the kth moment\nis defined by\nZ\u221e\nMk = xk dF (x).\n3\n.\n2\n\n0\n\nIn order to give an asymptotic formula for Mk let\nZ\u221e \u0010\nx \u0011k\ndF (x)\nmk =\nx+1\n0\n\n\f10\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\nWe will see that the generating function of mk has some interesting\nproperties. Let \u03c9(x) be a continuous function of at most power growth:\n\u03c9(x) \u226a xT as x \u2192 \u221e. By the functional equation for F we find\nF (x + n) = 1 \u2212 2\u2212n + 2\u2212n F (x), x \u2265 0. Hence\nZ\u221e\n\n1\n\n\u03c9(x) dF (x) =\n\n\u221e Z\nX\n\n\u03c9(x + n) dF (x + n)\n\nn=0 0\n\n0\n\n=\n\nZ1 X\n\u221e\nn=0\n\n0\n\n\u03c9(x + n)\ndF (x);\n2n\n\nthese integrals exist in view of our assumptions and the fact that F (x)\nt\nt\nfor t \u2265 0. Since F ( t+1\n)=\nhas a tail of exponential decay. Let x = t+1\n1\nF (t), this change of variables gives\n2\nZ\u221e\n0\n\n\u221e\n\n\u221e Z\nt\nX\n\u03c9( t+1\n+ n)\n\u03c9(x) dF (x) =\ndF (t)\n2n+1\nn=0\n0\n\n(All changes of order of summation and integration are justified by the\ncondition we put on \u03c9(x)). Now let \u03c9(x) = xL for some L \u2208 N0 and\ndefine\n\u221e\nX\nns\n.\nbs =\nn+1\n2\nn=0\n\nThen\n\nZ\u221e\n\nL\n\nx dF (x) =\n\n0\n\nZ\u221e X\nL \u0010\n0\n\ni=0\n\n\u0012 \u0013\nx \u0011i L\nbL\u2212i dF (x),\ni\nx+1\n\nwhence the relation\nML =\n\nL\nX\ni=0\n\n\u0012 \u0013\nL\nbL\u2212i\nmi\ni\n\n(3)\n\nfor L \u2208 N0 . The generating function of the sequence of the bs is given\nby\n\u221e \u221e\n\u221e\n\u221e\nX\nX\n1\nbL L X X nL tL\nent\nt =\n=\n=\n.\nb(t) =\nN\n+1\nn+1\nt\nL!\n2\nL!\n2\n2\n\u2212\ne\nn=0\nL=0 n=0\nL=0\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n11\n\nDenote by M(t) and m(t) the corresponding generating functions of\nthe coefficients Mk and mk , respectively. Then we can rewrite (3) as\nM(t) =\n\n\u221e\nX\nML\nL=0\n\n\u221e\n1 X mL L\n1\nt =\nt =\nm(t).\nt\nL!\n2 \u2212 e L=0 L!\n2 \u2212 et\nL\n\nThe function m(t) is entire, and M(t) has a positive radius of convergence. This already allows us to find approximate values of the\nmoments ML .\nTheorem 6. For L \u2208 N0 ,\n\u0010\n\u0011\nm(log 2) \u0010 1 \u0011L\nML =\nL! + O\u03b5 ((4\u03c0 2 + (log 2)1/2 \u2212 \u03b5)\u2212L L!\n2 log 2 log 2\n\u0011\n\u0010 m(log 2) \u0010 1 \u0011L\n\u2212L\n+\nO(6.3\n)\nL!\n=\n2 log 2 log 2\n\nProof. By Cauchy's formula, for any sufficiently small r,\nZ\nM(z)\nL!\nML =\ndz.\n2\u03c0i |z|=r z L+1\n\nChanging the path of integration, we get by the calculus of residues\n\u0013\n\u0012\nZ\nm(z) dz\nL!\nm(z)\n\u2212\n,\nML = \u2212Resz=log 2\nz\nL+1\n(2 \u2212 e )z\n2\u03c0i |z|=R 2 \u2212 ez z L+1\nwhere R satisfies log 2 < R < | log 2 + 2\u03c0i| (which means that there is\nexactly one simple pole of the integrand located in the interior of the\ncircle |z| = R). It is easily seen that the residue coincides with the\nmain term in the formula of the lemma; the error term follows from\nestimating the integral. \u0004\nWe obtain the inverse to the linear equations (3):\n\u0012 \u0013\nL\u22121\nX\nL\nmL = ML \u2212\nMs\ns\ns=0\n\nfor L \u2208 N0 . Since b(t)(2 \u2212 et ) = 1, the coefficients bL can be calculated\nrecursively\nL\u22121 \u0012 \u0013\nX\nL\nbs .\nbL =\ns\ns=0\n\nThus, b0 = 1, b1 = 1, b2 = 3, b3 = 13, b4 = 75, b5 = 541.\n\n\f12\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\nWe proceed with a property of the function m(t) which reflects the\nsymmetry of the distribution function: F (y) + F (1/y) = 1. Unfortunately, this property is still insufficient for determining the coefficients\nmL . As a matter of fact,\nmL =\n\nZ\u221e \u0010\n0\n\nx \u0011L\ndF (x) = \u2212\nx+1\n=\n\nZ\u221e \u0010\n0\n\nZ\u221e \u0010\n0\n\n1/x \u0011L\ndF (1/x)\n1/x + 1\n\n1 \u0011L\ndF (x).\nx+1\n\nSince\nL \u0012 \u0013\n\u0010 x \u0011L \u0010 x + 1 \u2212 1 \u0011L X\n\u0010 1 \u0011L\u2212s\nL\nL\u2212s\n(\u22121)\n=\n=\n,\nx+1\nx+1\nx+1\ns\ns=0\n\nthis gives\nmL =\n\nL \u0012 \u0013\nX\nL\ns=0\n\ns\n\n(\u22121)s ms\n\nfor L \u2265 0. For example, m1 = m0 \u2212 m1 , which gives m1 = 12 (since\nm0 = 1), and thus M1 = 23 (see Theorem 1). For the other coefficients\nwe only get linear relations. Thus, 2m3 = \u2212 21 + 3m2 . In terms of m(t)\nthe recursion formula above yields the identity\nm(t) = m(\u2212t)et .\nWe conclude this chapter with the result, which uniquely determines\nthe function m(t) (along with the condition m(0) = 1).\nTheorem 7. The function m(s) satisfies the integral equation\ns\n\nm(\u2212s) = (2e \u2212 1)\n\nZ\u221e\n\n\u221a\nm\u2032 (\u2212t)J0 (2 st) dt,\n\n0\n\nwhere J0 (\u2217) stands for the Bessel function:\n1\nJ0 (z) =\n\u03c0\n\nZ\u03c0\n0\n\ncos(z sin x) dx\n\ns \u2208 R+ ,\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n13\n\nThe proof of this theorem and the solution of this integral equation,\nand thus the explicit description of the moments will be given in a\nsubsequent paper.\n\n6. p\u2212adic distribution\nIn the previous sections, we were interested in the distribution of the\nnth generation of the tree CW in the field of real numbers. Since the\nset of non-equivalent valuations of Q contains a valuation, associated\nwith any prime number p, it is natural to consider the distribution of\nthe set of each generation in the field of p\u2212adic numbers Qp . In this\ncase we have an ultrametric inequality, which implies that two circles\nare either co-centric, or do not intersect. We define\na\na\nFn (z, \u03bd) = 2\u2212n+1 #{ \u2208 CW (n) : ordp ( \u2212 z) \u2265 \u03bd},\nb\nb\n\nz \u2208 Qp ,\n\n\u03bd \u2208 Z.\n\n(When p is fixed, the subscript p in Fn is omitted). Note that in\norder to calculate Fn (z, \u03bd) we can confine to the case ordp (z) < \u03bd;\notherwise ordp ( ab \u2212 z) \u2265 \u03bd \u21d4 ordp ( ab ) \u2265 \u03bd. We shall calculate the limit\ndistribution \u03bcp (z, \u03bd) = limn\u2192\u221e Fn (z, \u03bd), and also some characteristics\nof it, e.g. the zeta function\nZ\nZp (s) =\n|u|sd\u03bcp , s \u2208 C, z \u2208 Qp ,\nu\u2208Qp\n\nwhere | \u2217 | stands for the p\u2212adic valuation.\nTo illustrate how the method works, we will calculate the value of Fn\nin two special cases. Let p = 2, and let E(n) be the number of rational\nnumbers in the nth generation with one of a or b being even, and let\nO(n) be the corresponding number fractions with both a and b odd.\na\nThen E(n) + O(n) = 2n\u22121 . Since ab in the nth generation generates a+b\nin the (n + 1)st generation, each fraction ab with one of the a, b\nand a+b\nb\neven will generate one fraction with both numerator and denominator\nodd. If both a, b are odd, then their two offsprings will not be of this\nkind. Therefore, O(n+1) = E(n). Similarly, E(n+1) = E(n)+2O(n).\nThis gives the recurrence E(n + 1) = E(n) + 2E(n \u2212 1), n \u2265 2, and\n\n\f14\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\nthis implies\n2n + 2(\u22121)n\nE(n) =\n,\n3\n\nO(n) =\n\n2n\u22121 + 2(\u22121)n\u22121\n,\n3\n\n2\n\u03bc2 (0, 0) = .\n3\n\n(For the last equality note that ab and ab simultaneously belong to\nCW (n) , and so the number of fractions with ord2 (\u2217) > 0 is E(n)/2).\nWe will generalize this example to odd prime p \u2265 3. Let Li (n) be the\npart of the fractions in the nth generations such that ab\u22121 \u2261 i mod p\nfor 0 \u2264 i \u2264 p \u2212 1 or i = \u221e (that is, b \u2261 0 mod p). Thus,\nX\nLi (n) = 1;\ni\u2208Fp \u222a\u221e\n\nin other words, Li (n) = Fn (i, 1). For our later investigations we need\na result from the theory of finite Markov chains.\nLemma 1. Let A be a matrix of a finite Markov chain with s stages.\nPs\nThat is, ai,j \u2265 0, and\nj=1 ai,j = 1 for all i. Suppose that A is\n(m)\n\nirreducible (for all pairs (i, j), and some m, the entry ai,j of the matrix\nAm is strictly positive), acyclic and recurrent (this is satisfied, if all\nentries of Am are strictly positive for some m). Then the eigenvalue 1\nis simple, if \u03bb is another eigenvalue, then |\u03bb| < 1, and Am , as m \u2192 \u221e,\ntends to the matrix B, with entries bi,j = \u03c0j , where (\u03c01 , ..., \u03c0s ) is a\nP\nunique left eigenvector with eigenvalue 1, such that sj=1 \u03c0j = 1.\nA proof of this lemma can be found in [6], Section 3.1., Theorem 1.3.\nTheorem 8. \u03bcp (z, 1) =\n\n1\np+1\n\nfor z \u2208 Zp .\n\nProof. Similarly as in the above example, a fraction ab from the nth\na\nand a+b\nin the (n + 1)st generation, and it is\ngeneration generates a+b\nb\nroutine to check that\n1\n1\nLi (n + 1) = L i (n) + Li\u22121 (n) for i \u2208 Fp \u222a {\u221e},\n2 1\u2212i\n2\n\n(4)\n\ni\nand i \u2212 1, if i = 1 or\n(Here we make a natural convention for 1\u2212i\ni\n\u221e). In this equation, it can happen that i \u2212 1 \u2261 1\u2212i\nmod p; thus,\n2\n(2i \u2212 1) \u2261 \u22123 mod p. The recurrence for this particular i is to be\nunderstood in the obvious way, Li (n + 1) = Li\u22121 (n). Therefore, if we\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n15\n\ndenote the vector-column (L\u221e (n), L0 (n), ..., Lp\u22121 (n))T by vn , and if A\nis a matrix of the system (4), then vn+1 = Avn , and hence\nvn = An\u22121 v1 ,\nwhere v1 = (0, 0, 1, 0, ..., 0)T . In any particular case, this allows us two\nfind the values of Li explicitly. For example, if p = 7, the characteristic\npolynomial is\n1\n(x \u2212 1)(2x \u2212 1)(2x2 + 1)(4x4 + 2x3 + 2x + 1).\n16\nThe list of roots is\np\n\u221a\n\u221a\ni\n1\n\u22121 \u2212 17\n1 + 17\n\u221a\n\u00b1\n\u03b11 = 1, \u03b1 = , \u03b13,4 = \u00b1 \u221a , \u03b15,6,7,8 =\n,\n2\n8\n2\n2 2\n\u221a\n(with respect to the two values for the root 17), the matrix is diagonalisible, and the Jordan normal form gives the expression\nf (x) =\n\nLi (n) =\n\n8\nX\n\nCi,s \u03b1sn .\n\ns=1\n\nNote that the elements in each row of the (p + 1) \u00d7 (p + 1) matrix A are\nnon-negative and sum up to 1, and thus, we have a matrix of a finite\nMarkov chain. We need to check that it is acyclic. Let \u03c4 (i) = i \u2212 1,\n(m)\ni\nand \u03c3(i) = 1\u2212i\nfor i \u2208 Fp \u222a {\u221e}. The entry ai,j of Am is\nX\n(m)\nai,i1 * ai1 ,i2 * ... * aim\u22121 ,j .\nai,j =\ni1 ,...,im\u22121\n\nTherefore, we need to check that for some fixed m, the composition of\nm \u03c3 \u2032 s or \u03c4 \u2032 s leads from any i to any j. One checks directly that for\nany positive k, and i, j \u2208 Fp ,\n\u03c4 p\u22121\u2212j \u25e6 \u03c3 \u25e6 \u03c4 k \u25e6 \u03c3 \u25e6 \u03c4 i\u22121 (i) = j,\n\u03c4 p\u22121\u2212j \u25e6 \u03c3 \u25e6 \u03c4 k (\u221e) = j,\n\n\u03c4 k \u25e6 \u03c3 \u25e6 \u03c4 i\u22121 (i) = \u221e;\n\n(for i = 0, we write \u03c4 \u22121 for \u03c4 p\u22121 ). For each pair (i, j), choose k in\norder the amount of compositions used to be equal (say, to m). Then\nobviously all entries of Am are positive, ant this matrix satisfies the\nconditions of lemma. Since all columns also sum up to 1, (\u03c01 , ..., \u03c0p+1 ),\n\n\f16\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\n1\n\u03c0j = p+1\n, 1 \u2264 j \u2264 p + 1, is the needed eigenvector. This proves the\ntheorem. \u0004\n\nTheorem 9. Let \u03bd \u2208 Z and z \u2208 Qp , and ordp (z) < \u03bd (or z = 0).\nThen, if z is p\u2212adic integer,\n1\n\u03bc(z, \u03bd) = \u03bd\n.\np + p\u03bd\u22121\nIf z is not integer, ordp (z) = \u2212\u03bb < 0,\n\u03bc(z, \u03bd) =\n\np\u03bd+2\u03bb\n\n1\n.\n+ p\u03bd+2\u03bb\u22121\n\nFor z = 0, \u2212\u03bd \u2264 0, we have\n\n1\n.\n+ p\u03bd\nThis theorem allows the computation of the associated zeta-function:\n\u03bc(0, \u2212\u03bd) = 1 \u2212\n\np\u03bd+1\n\nCorollary 10. For s in the strip \u22121 < Rs < 1,\nZ\n(p \u2212 1)2\n|u|s d\u03bcp =\nZp (s) =\n,\n(p \u2212 p\u2212s )(p \u2212 ps )\nu\u2208Qp\nand Zp (s) = Zp (\u2212s).\nThe proof is straightforward. It should be noted that this expression\nencodes all the values of \u03bc(0, \u03bd) for \u03bd \u2208 Z.\nProof of Theorem 9. For shortness, when p is fixed, denote ordp (\u2217)\nby v(\u2217). As before, we want a recurrence relation among the numbers\nFn (i, \u03ba), i \u2208 Q+ . For each integral \u03ba, we can confine to the case\ni < p\u03ba . If i = 0, we only consider \u03ba > 0 and call these pairs (i, \u03ba)\n\"admissible\". We also include Gn (0, \u2212\u03ba) for \u03ba \u2265 1, where these values\nare defined in the same manner as Fn , only inversing the inequality,\nconsidering ab \u2208 CW (n) , such that v( ab ) \u2264 \u2212\u03ba; the ratio of fractions\nin the nth generation outside this circle. As before, a fraction ab in\na\nand a+b\nin the (n + 1)st\nthe nth generation generates the fractions a+b\nb\n\u03ba\ngeneration. Let \u03c4 (i, \u03ba) = ((i \u2212 1) mod p , \u03ba). Then for all admissible\npairs (i, \u03ba), i 6= 0, the pair \u03c4 (i, \u03ba) is also admissible, and\nv(\n\na\na+b\n\u2212 i) = \u03ba \u21d4 v( \u2212 (i \u2212 1)) = \u03ba.\nb\nb\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\nSecond, if\n\na\na+b\n\n17\n\n= i + p\u03ba u, i 6= 1, u \u2208 Zp , and (i, \u03ba) is admissible, then\na\ni\np\u03ba u\n\u2212\n=\n.\nb 1\u2212i\n(1 \u2212 i)(1 \u2212 i \u2212 p\u03ba u)\n\ni\n) = v(i) \u2212 v(1 \u2212 i), this is 0 unless i is an integer, equals\nSince v( 1\u2212i\nto v(i) if the latter is > 0 and equals to \u2212v(1 \u2212 i) if v(1 \u2212 i) > 0.\nFurther, this difference has valuation \u2265 \u03ba0 = \u03ba, if i \u2208 Z, i 6\u2261 1 mod p,\nvaluation \u2265 \u03ba0 = \u03ba \u2212 2v(1 \u2212 i), if i \u2208 Z, i \u2261 1 mod p, and valuation\n\u2265 \u03ba0 = \u03ba \u2212 2v(i) if i is not integer. In all three cases, easy to check,\ni\nthat, if we define i0 = 1\u2212i\nmod p\u03ba0 , the pair \u03c3(i, \u03ba) =def (i0 , \u03ba0 ) is\nadmissible. For the converse, let ab = i0 + p\u03ba0 u, u \u2208 Zp . Then\n\np\u03ba 0\ni0\na\n=\n\u2212\n.\na + b 1 + i0\n(1 + i0 + p\u03ba0 u)(1 + i0 )\n\ni0\nIf i = 1+i\nis a p\u2212adic integer, i 6\u2261 1 mod p, this has a valuation\n0\n\u2265 \u03ba = \u03ba0 ; if i is a p\u2212adic integer, i \u2261 1(p), this has valuation\n\n\u2265 \u03ba = \u03ba0 \u2212 2v(i0 ) = \u03ba0 + 2v(1 \u2212 i);\nif i is not a p\u2212adic integer, this has valuation\n\u2265 \u03ba = \u03ba0 \u2212 2v(1 + i0 ) = \u03ba0 + 2v(i).\nThus,\n\na\na\n\u2212 i) \u2265 \u03ba \u21d4 v( \u2212 i0 ) \u2265 \u03ba0 .\na+b\nb\na\n= 1 + p\u03ba u, then \u03ba > 0, u \u2208 Zp , and we obtain\nLet i = 1. If a+b\na\n= \u22121 \u2212 p\u03ba1u , v( ab ) \u2264 \u2212\u03ba. Converse is also true. Finally, for \u03ba \u2265 1,\nb\nv(\n\nv(\n\na+b\na\n) \u2264 \u2212\u03ba \u21d4 v( ) \u2264 \u2212\u03ba,\nb\nb\n\nand\n\na\na\n) \u2264 \u2212\u03ba \u21d4 v( + 1) \u2265 \u03ba.\na+b\nb\nTherefore, we have the recurrence relations:\n\uf8f1\n1\n1\n\uf8f4\n\uf8f2 Fn+1 (i, \u03ba) = 2 Fn (\u03c4 (i, \u03ba)) + 2 Fn (\u03c3(i, \u03ba)), if (i, \u03ba) is admissible,\n(5)\nFn+1 (1, \u03ba) = 21 Fn (0, \u03ba) + 12 Gn (0, \u2212\u03ba), \u03ba \u2265 1,\n\uf8f4\n\uf8f3 G (0, \u2212\u03ba) = 1 G (0, \u2212\u03ba) + 1 F (\u22121, \u03ba), \u03ba \u2265 1.\nn+1\n2 n\n2 n\nv(\n\nThus, we have an infinite matrix A, which is a change matrix for the\nMarkov chain. If vn is an infinite vector-column of Fn\u2032 s and G\u2032n s, then\nvn+1 = Avn , and, as before, vn = An\u22121v1 . It is direct to check that\n\n\f18\n\nGIEDRIUS ALKAUSKAS, J\u00d6RN STEUDING\n\neach column also contains exactly two nonzero entries 12 , or one entry,\nequal to 1. In terms of Markov chains, we need to determine the classes\nof orbits. Then in proper rearranging, the matrix A looks like\n\uf8eb\n\uf8f6\nP1 0 . . . 0 . . .\n\uf8ec 0 P . . . 0 . . .\uf8f7\n2\n\uf8ec\n\uf8f7\n\uf8ec .\n..\n.. \uf8f7\n..\n\uf8ec ..\n. .\n. \uf8f7\n\uf8ec\n\uf8f7,\n\uf8ec0\n0 . . . Ps 0 \uf8f7\n\uf8ed\n\uf8f8\n..\n..\n..\n.\n.\n. ... 0\n\nwhere Ps are finite Markov matrices. Thus, we claim that the length of\neach orbit is finite, every orbit has a representative G\u2217 (0, \u2212\u03ba), \u03ba \u2265 1,\nthe length of it is p\u03ba + p\u03ba\u22121 , and the matrix is recurrent (that is, every\ntwo positions communicate). In fact, from the system above and form\nthe expression of the maps \u03c4 (i, \u03ba) and \u03c3(i, \u03ba), the direct check shows\nthat the complete list of the orbit of G\u2217 (0, \u2212\u03ba) consists of (and each\npair of states are communicating):\nG\u2217 (0, \u2212\u03ba),\n\nF\u2217 (i, \u03ba) (i = 0, 1, 2, ..., p\u03ba \u2212 1),\n\nF\u2217 (p\u2212\u03bb u, \u03ba \u2212 2\u03bb) (\u03bb = 1, 2, ..., \u03ba \u2212 1, u \u2208 N, u 6\u2261 0 mod p, u \u2264 p\u03ba\u2212\u03bb ).\nIn total, we have\n\u03ba\n\n1+p +\n\n\u03ba\u22121\nX\n\u03bb=1\n\n(p\u03ba\u2212\u03bb \u2212 p\u03ba\u2212\u03bb\u22121 ) = p\u03ba + p\u03ba\u22121\n\nmembers in the orbit. Thus, each P\u03ba in the matrix above is a finite\ndimensional l\u03ba \u00d7 l\u03ba matrix, where l\u03ba = p\u03ba + p\u03ba\u22121 . For \u03ba = 1, the\nmatrix P1 is exactly the matrix of the system (4). As noted above, the\nvector column (1, 1, ..., 1)T is the left eigen-vector. As in the previous\ntheorem, it is straightforward to check that this matrix is irreducible\nand acyclic (that is, the entries of Pn\u03ba are strictly positive for sufficiently\nlarge n). In fact, since by our observation, each two members in the\norbit communicate, and since we have a move G\u2217 (0, \u2212\u03ba) \u2192 G\u2217 (0, \u2212\u03ba),\nthe proof of the last statement is immediate: there exists n such that\nany position is reachable from another in exactly n moves, and this\ncan be achieved at the expense of the move just described. Therefore,\n\n\fSTATISTICAL PROPERTIES OF THE CALKIN\u2013WILF TREE\n\n19\n\nall entries of Pn\u03ba are strictly positive. Thus, the claim of the theorem\nfollows from the lemma above. \u0004\nAcknowledgements. The second author thanks J\u00fcrgen Sander and\nJan-Hendrik de Wiljes for their interest and valuable remarks.\nReferences\n[1] N. Calkin, H. Wilf, Recounting the rationals. Amer. Math. Monthly 107\n(2000), 360\u2013363\n[2] A.J. Cole, A.J.T. Davie, A game based on the Euclidean algorithm and a\nwinning strategy for it. Math. Gaz. 53 (1969), 354-357\n[3] R. Bird, J. Gibbons, D. Lester, Functional pearl: enumerating the rationals. J. Functional Programming 16 (2006), 281-291\n[4] R. Graham, D. Knuth, O. Patashnik, Concrete Mathematics: a foundation\nfor computer science. Addison-Wesley 1990\n[5] S. Hofmann, G. Schuster, J. Steuding, Euclid, Calkin & Wilf - Playing\nwith rationals -, Elem. Math. (to appear)\n[6] S. Karlin, A first course in stochastic processes. Academic Press, 1968\n[7] D.H. Lehmer, On Stern's diatomic series, Amer. Math. Monthly 36 (1929),\n59-67\n[8] M. Newman, Recounting the rationals, Continued. Credited in Amer. Math.\nMonthly 110 (2003), 642\u2013643\n[9] A. Ya. Khinchin, Continued fractions. The University of Chicago Press, 1964\n[10] B. Reznick, Regularity properties of the Stern enumeration of the rationals.\nPreprint available at http://de.arxiv.org/pdf/math.NT/0610601.pdf?front\n[11] N. Sloane, S. Plouffe, The On-line Encyclopedia of integer sequences,\nhttp://www.research.att.com/\u223cnjas/sequences/\n[12] M.A. Stern, \u00dcber eine zahlentheoretische Funktion. J. reine angew. Math.\n55 (1858), 193-220\n\nGiedrius Alkauskas, Department of Mathematics and Informatics, Vilnius University, Naugarduko 24, 03225 Vilnius, Lithuania\ngiedrius.alkauskas@maths.nottingham.ac.uk\nJ\u00f6rn Steuding, Department of Mathematics, W\u00fcrzburg University, Am\nHubland, 97 218 W\u00fcrzburg, Germany\nsteuding@mathematik.uni-wuerzburg.de\n\n\f"}