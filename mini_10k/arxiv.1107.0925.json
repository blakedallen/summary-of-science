{"id": "http://arxiv.org/abs/1107.0925v1", "guidislink": true, "updated": "2011-07-05T17:08:46Z", "updated_parsed": [2011, 7, 5, 17, 8, 46, 1, 186, 0], "published": "2011-07-05T17:08:46Z", "published_parsed": [2011, 7, 5, 17, 8, 46, 1, 186, 0], "title": "Deep sub electron noise readout in CCD systems using digital filtering\n  techniques", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1107.3485%2C1107.1223%2C1107.1758%2C1107.5705%2C1107.4151%2C1107.0290%2C1107.5394%2C1107.4525%2C1107.3313%2C1107.1551%2C1107.3670%2C1107.2556%2C1107.2647%2C1107.4335%2C1107.1012%2C1107.0577%2C1107.5777%2C1107.3459%2C1107.0797%2C1107.4751%2C1107.4034%2C1107.2952%2C1107.4345%2C1107.2778%2C1107.0362%2C1107.1176%2C1107.2808%2C1107.2857%2C1107.4806%2C1107.1242%2C1107.4098%2C1107.3308%2C1107.0685%2C1107.3545%2C1107.2318%2C1107.2360%2C1107.5636%2C1107.0039%2C1107.0893%2C1107.2819%2C1107.4386%2C1107.5136%2C1107.2975%2C1107.4756%2C1107.5684%2C1107.5530%2C1107.0133%2C1107.5783%2C1107.4141%2C1107.5999%2C1107.0901%2C1107.0925%2C1107.1130%2C1107.4149%2C1107.5761%2C1107.4578%2C1107.1350%2C1107.0367%2C1107.0129%2C1107.1615%2C1107.1806%2C1107.1295%2C1107.1153%2C1107.5524%2C1107.0755%2C1107.5570%2C1107.3546%2C1107.1857%2C1107.5362%2C1107.3044%2C1107.4605%2C1107.5070%2C1107.5257%2C1107.4107%2C1107.5713%2C1107.4770%2C1107.1148%2C1107.4777%2C1107.5653%2C1107.0469%2C1107.2255%2C1107.3978%2C1107.3164%2C1107.1532%2C1107.0541%2C1107.2679%2C1107.5889%2C1107.5484%2C1107.2788%2C1107.1521%2C1107.4916%2C1107.4510%2C1107.3349%2C1107.2262%2C1107.2456%2C1107.1861%2C1107.4293%2C1107.4624%2C1107.0765%2C1107.5040%2C1107.0141&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Deep sub electron noise readout in CCD systems using digital filtering\n  techniques"}, "summary": "Scientific CCDs designed in thick high resistivity silicon (Si) are excellent\ndetectors for astronomy, high energy and nuclear physics, and instrumentation.\nMany applications can benefit from CCDs ultra low noise readout systems. The\npresent work shows how sub electron noise CCD images can be achieved using\ndigital signal processing techniques. These techniques allow readout bandwidths\nof up to 10 K pixels per second and keep the full CCD spatial resolution and\nsignal dynamic range.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=1107.3485%2C1107.1223%2C1107.1758%2C1107.5705%2C1107.4151%2C1107.0290%2C1107.5394%2C1107.4525%2C1107.3313%2C1107.1551%2C1107.3670%2C1107.2556%2C1107.2647%2C1107.4335%2C1107.1012%2C1107.0577%2C1107.5777%2C1107.3459%2C1107.0797%2C1107.4751%2C1107.4034%2C1107.2952%2C1107.4345%2C1107.2778%2C1107.0362%2C1107.1176%2C1107.2808%2C1107.2857%2C1107.4806%2C1107.1242%2C1107.4098%2C1107.3308%2C1107.0685%2C1107.3545%2C1107.2318%2C1107.2360%2C1107.5636%2C1107.0039%2C1107.0893%2C1107.2819%2C1107.4386%2C1107.5136%2C1107.2975%2C1107.4756%2C1107.5684%2C1107.5530%2C1107.0133%2C1107.5783%2C1107.4141%2C1107.5999%2C1107.0901%2C1107.0925%2C1107.1130%2C1107.4149%2C1107.5761%2C1107.4578%2C1107.1350%2C1107.0367%2C1107.0129%2C1107.1615%2C1107.1806%2C1107.1295%2C1107.1153%2C1107.5524%2C1107.0755%2C1107.5570%2C1107.3546%2C1107.1857%2C1107.5362%2C1107.3044%2C1107.4605%2C1107.5070%2C1107.5257%2C1107.4107%2C1107.5713%2C1107.4770%2C1107.1148%2C1107.4777%2C1107.5653%2C1107.0469%2C1107.2255%2C1107.3978%2C1107.3164%2C1107.1532%2C1107.0541%2C1107.2679%2C1107.5889%2C1107.5484%2C1107.2788%2C1107.1521%2C1107.4916%2C1107.4510%2C1107.3349%2C1107.2262%2C1107.2456%2C1107.1861%2C1107.4293%2C1107.4624%2C1107.0765%2C1107.5040%2C1107.0141&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Scientific CCDs designed in thick high resistivity silicon (Si) are excellent\ndetectors for astronomy, high energy and nuclear physics, and instrumentation.\nMany applications can benefit from CCDs ultra low noise readout systems. The\npresent work shows how sub electron noise CCD images can be achieved using\ndigital signal processing techniques. These techniques allow readout bandwidths\nof up to 10 K pixels per second and keep the full CCD spatial resolution and\nsignal dynamic range."}, "authors": ["Gustavo Cancelo", "Juan Estrada", "Guillermo Fernandez Moroni", "Ken Treptow", "Ted Zmuda", "Tom Diehl"], "author_detail": {"name": "Tom Diehl"}, "author": "Tom Diehl", "arxiv_comment": "13 pages, 16 figures", "links": [{"href": "http://arxiv.org/abs/1107.0925v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/1107.0925v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "astro-ph.IM", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "astro-ph.IM", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/1107.0925v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/1107.0925v1", "journal_reference": null, "doi": null, "fulltext": "Deep sub electron noise readout in CCD systems using digital\nfiltering techniques.\nGustavo Cancelo1, Juan Estrada1, Guillermo Fernandez Moroni2, Ken Treptow1, Ted Zmuda1, Tom Diehl1.\n1\n\nFermi National Accelerator Laboratory, Batavia, Il 60510, USA,\nKirk Road and Pine Street, Batavia, Il 60510, USA\ncancelo@fnal.gov, estrada@fnal.gov, treptow@fnal.gov, zmuda@fnal.gov, diehl@fnal.gov.\n2\n\nInstituto de Investigaciones en Ing. El\u00e9ctrica (IIIE) \u2015Alfredo C. Desages\u2016\nDepartamento de Ingenieria El\u00e9ctrica, Universidad Nacional del Sur\nAv. Alem 1253 - (B8000CPB) Bah\u0131a Blanca, Argentina\nfmoroni.guillermo@gmail.com\n\nAbstract. Scientific CCDs designed in thick high resistivity silicon (Si) are excellent detectors for\nastronomy, high energy and nuclear physics, and instrumentation. Many applications can benefit from\nCCDs ultra low noise readout systems. The present work shows how sub electron noise CCD images can\nbe achieved using digital signal processing techniques. These techniques allow readout bandwidths of up to\n10 K pixels per second and keep the full CCD spatial resolution and signal dynamic range.\n\nKeywords. CCD, spectroscopy, dark matter, sub electron noise.\n\n1 Introduction\nCCDs were invented in 1969 (Amelio1970; Boyle 2010; Smith 2010) and today, after 4 decades of\nadvances in R&D, they have become the sensor of choice for a large number of current and future ground\nand space telescopes (Flaugher 2006; Honscheid 2008; Diehl 2008). Scientific CCDs are developed with\nhigh performance characteristics such as high quantum efficiencies above 90% in the visible and infrared\nspectrum, large photon dynamic range exceeding 100,000 e \u2212, and pixel size around 10 \u03bcm. In particular,\nCCDs designed at Lawrence Berkeley National Laboratory (Holland 2003) are made in 250 \u03bcm thick high\nresistivity Si. These detectors work fully depleted improving the quantum efficiency in the infrared up to\n1000nm. Furthermore, the 250 \u03bcm thickness makes these CCDs excellent detectors for a number of high\nenergy and nuclear physics applications. For those applications the important features, rather than optical\nperformance, are the CCD low noise which allow detection of low ionizing particles, the high spatial\nresolution, and mass. Just to mention one example, the DAMIC experiment at the Fermilab National\nAccelerator Laboratory searches for Dark Matter measuring the nuclear recoil energy of WIMPs with the Si\natom nuclei (Estrada 2008). A sub electron noise CCD readout system allows sensitivities in the few eV\nregion, which makes DAMIC the most sensitive detector for low mass WIMP search. Sub electron noise\nCCD readout systems are also important in the design of a new generation of optical spectrometers\n(Chandler 1990; Janesick 1990). In a spectrometer the required collecting area of the telescope is\nproportional to the signal to noise ratio.\nThe reminder of this paper is organized as follows. Section 2 introduces the CCD signal and noise problem.\nSection 3 shows how the correlated noise limits the CCD readout noise. Section 4 describes a new\n\n\ftechnique to lower the correlated noise. Section 5 shows the achieved sub electron noise results. Section 6\ndescribes the errors of the method and Section 7 shows the hardware implementation of a complete system.\n\n2 CCD signal and noise\nCCDs are organized in one or more arrays of small pixels (e.g. 15 x 15 micron pixels). When properly\nbiased, CCD pixels store charge in a potential well. There are several ways charge can be generated\n(Janesick 2001; McLean 2008) and once is collected, the charge can be readout by sequentially shifting it\nalong the CCD vertical columns into an horizontal serial register which is clocked out through a video\namplifier one pixel at a time. Some CCDs have multiple video outputs which allow splitting the array in\nblocks and reading them in parallel (Figure 1).\nH1 H2 H3\n\nHORIZONTAL REGISTER\n\nVERTICAL\nCLOCKS\ne- e- e-\n\nVIDEO\nAMPLIFIER\n\n3-PHASE\nARRAY CCD\n\nVERTICAL\nCLOCKS\ne- e-\n\nVIDEO\nAMPLIFIER\n\nHORIZONTAL REGISTER\n\ne-\n\nH1 H2 H3\n\nFig. 1: CCD array showing 2 sets of video channels, vertical and horizontal clocks.\nA CCD transfer function computes the analog and digital stage gains (Figure 2). At high signal levels the\nnoise is dominated by photon statistics and pixel layout uniformities. At very low signal levels the noise is\ndominated by the readout electronics. The CCD gain is defined in electrons per digital units (e -/ADUs)\nwhich is the inverse of the product of the individual block gains (Figure 2).\n\nQEI\nIncident\nPhotons\nP\n\n\u03b7I\n\nInteracting\nPhotons\n\nElectrons\nCollected\n\nIncident\nPhotons\n\nInteracting\nPhotons\n\nSV\n\nAI\nVolts\n\n+\n\nTransferred\nElectrons\n\n2\nR\n\n\u03c3\nCCD\n\nFig. 2: CCD Block diagram and transfer functions.\n\nPreamplifier\nand A/D\nconversion\nSystem\ngain\n\n\fWhen the CCDs are cooled with liquid nitrogen at temperatures of about 173 \u030aK the dark current is\nnegligible. Furthermore, the charge transfer efficiency (CTE) from pixel to pixel is better than 99.9998%\nwith a total noise contribution of about 0.1%. Hence, the main noise contributors to the CCD data are the\ninternal JFET video amplifier and the external readout system.\nThe CCD output stage generates a video signal as shown in Figure 3. A reset pulse sets a reference level\nbefore a pixel charge is transferred to the sense node capacitor via the output summing well. The video is\nsensitive to power supply and output JFET noise, in particular to their low frequency content.\nVREF\nSumming Transfer\nWell\nGate\n\nVDD\nPixel period TPIX\n\nReset\nOutput\nJFET\n\nCGS\n\nVideo Out.\ne-\n\nPixel\ncharge\n\nCs\nLoad\nResistor\n\nPedestal\n\nFig. 3: Output amplifier region and video signal showing clock feed-throughs.\nThe most common signal readout technique is called Correlated Double Sampling (CDS) which subtracts\nthe average pedestal from the average pixel signal during a predefined time window (Equation 1). Figure 4\nshows the CDS transfer function as a filter response. CDS is particularly sensitive to low frequency content\nnoise near 0.4/ T\u222b. T\u222b is the CDS integration time. The CDS differential integral has zeros at frequencies\nmultiple of T\u222b.\n\ns cds\nj \uf03d\uf0f2\n\nt1 j \uf02bT\uf0f2\n\nt oj\n\np j \uf02b ntotal (t ) dt \uf02d\uf0f2\n\nt3 j \uf02bT\uf0f2\n\nt2 j\n\ns j \uf02b ntotal (t ) dt\n\n(1)\n\nWhere pj and sj are the j-th pedestal and pixel respectively, ntotal(t) represents the total additive noise\n(correlated and uncorrelated), and toj, t1j, t2j, t3j define the limits of the integration windows.\n\nFig. 4: CDS transfer function.\n\n\fCDS is the optimal filter for a single pixel measurement. However, due to the correlated pink noise, the\nCDS variance does not monotonically decay towards zero as a function of the integration time (T \u222b). Indeed,\nthe noise variance has a minimum at some finite time and then monotonically increases due to the dominant\n1/f noise. The minimum noise achievable is related to the 1/f corner frequency and, using DeCam CCDs,\nhas been measured to be between 20 and 25 \u03bcs (Estrada 2006). Since the 1/f noise is added by the CCD\noutput amplifiers, we will show in the next sections that the 1/f noise component can be reduced by\ncomputing the correlation in a string of neighboring pixels.\n\n3 Pixel correlated noise\nModern CCD readout systems such as the Monsoon for DECam (Estrada 2006) achieve about 2e- R.M.S.\nof noise at 20Kpix/s, but it rises considerably for slower readouts due to 1/f noise. The same system\nachieves about 7 e- of noise at 250Kpix/s. This noise meets comfortably the noise specifications for the\nDES (Flaugher 2006).\nIn order to achieve lower noise numbers for the applications mentioned above, it is important to attack the\nproblem in several fronts including: the white Gaussian noise (WGN) contributions of the upstream\nsections of the readout system, the EMI contamination due to circuit resonances at high and low\nfrequencies, and the 1/f noise effect on the CDS. The later is the main subject of this paper and is achieved\nby studying the correlation of low frequency content noise in a string of pixels.\nTo lower the WGN and EMI we have designed a special flex cable with balanced video circuits to\nminimize inductive coupling. Capacitive coupling has also been improved by location and shielding of the\nvideo signals. A dV/dt of 250 V/\u03bcs produces negligible crosstalk in the video signals.\nPower supply noise compensation circuits have been applied to the most sensitive CCD analog powers (i.e.\nVDD and VR).\nThe traditional analog CDS integrator has been replaced by a sampled system. This system employs a \u03a3-\u0394\n24 bit A to D converter sampling at 20Ms/s (Analog Devices 2006). The A/D includes internal digital\nfilters. We used 2 FIR banks as a low pass filter (LPF) with a decimation ratio of 8, setting the Nyquist\nfrequency at 1.25MHz. The intrinsic noise of the 24 bit A/D system is 1.5e-/sample and contributes less\nthan 0.3e- of noise when operated in CDS at 100KHz (Figure 5). If the CCD video is pre-amplified, the\nA/D noise is further reduced by the pre-amplification factor. In our system a pre-amplification of 4 to 6 is\nused.\n\nFig. 5: \u03a3-\u0394 24 bit A/D based readout system noise.\n\n\fFigure 6 shows the noise spectrum of the digital readout system. This spectrum shows substantially lower\nWGN noise than a typical Monsoon system. However, despite efforts in lowering EMI resonances, we can\nstill see 60 Hz and harmonics in the low frequency and other resonances in the higher frequency part. It is\nworth to mention that the high frequency noise content has a small contribution to the noise when the CCD\nis readout at low speed.\n\nFig. 6: Readout system noise spectrum.\nAn example of the video signal the \u03a3-\u0394 24 bit A/D system samples is shown in Figure 7. Since the video\ndata is band limited by an anti aliasing filter and fast sampled at 20Ms/s the digital CDS nicely approaches\nthe analog CDS filtering function for the 100KHz band of interest.\n\nFig. 7: Digitized video output.\nThe digital CDS as a function of the pixel integration time T \u222b is shown in Figure 8. The system gain has\nbeen measured to be 0.025e-/ADU which shows an increased sensitivity due to the 24 bit ADC. The\nsystem's gain has been calibrated using a 55Fe source.\n\nFig. 8: Digital CDS noise as a function of the CDS integration time.\n\n\fThe minimum noise achieved is 1.1e- at 12\u03bcs of T\u222b. Longer integration times show the effect of the 1/f\nnoise. DES CCDs readout times of 4 \u03bcs find noise levels approaching 2.2e-. These numbers represent a\nreduction of about 3 times with respect to current readout systems\n\n4 Estimation of correlated noise\nAn additional for reducing noise was aimed at both estimating and filtering the low frequency noise\ncontent. The low frequency noise correlates among many pixels schematically shown in Figure 9. The\nfollowing algorithm is used to reduce 1/f or correlated noise:\n1)\n2)\n3)\n4)\n\nDigitally sample the video signal.\nEstimate the low frequency correlated (LFC) noise of a string of pixels.\nSubtract the correlated noise from the original video\nPerform the digital CDS of the filtered signal.\n\nSince the video is sampled the low frequency noise in some number of frequency bands \u0394f=f s/N can be\nestimated and subtracted. Thus fs is the sampling frequency and N the number of samples in the data set.\nFor the estimation problem we use a linear \u03c72 estimator because it does not assume a particular noise\nmodel. \u03c72 estimators are not optimal but since the noise spectrum may not be completely Gaussian other\nestimators cannot claim optimality either.\n\n2*Npix steps with N total samples, Ns samples per step\nPedestal i\n\nPixel i\n\nPedestal\n\nPixel i+1\n\ns(n) pedestals and pixels\n\nn(n) correlated noise\n\nw(n) uncorrelated noise\n\nFig. 9: Signal and noise model showing: s(n) alternated pedestals and pixels, n(n) correlated noise, and\nw(n) uncorrelated noise.\nNpix, Ns and N are the number of pixels, the number of samples per pixel and the total number of samples\nused for each correlation analysis.\nThe signal model is described by\n( )\n\n( )\n\n( )\n\n( )\n\n(2)\n\nWhere s(n) is the noise free video signal composed of pedestals and pixels, n(n) is the correlated noise, and\nw(n) is the uncorrelated noise.\nSince pedestal and pixel values are valid during a step function of uniform time we define that as:\n( )\n\n(\n\n)\n\n(\n\n(\n\n)\n\n)\n\n\fWhere U(n-n0) is the Heaviside function centered at time n0.\nThe noise free signal can be represented by:\n( )\n\n\u2211\n\n( )\n\n(3)\n\nIn equation 3 si alternatively indexes over pedestal i and pixel i from i=1 to 2Npix.\nFor the correlated noise we use a Fourier base representation limited to the number of frequency modes M\nto be estimated:\n( )\n\n\u2211\n\n\u2211\n\nThe number of parameters we need to estimate equals p pixels, p pedestals, and M complex frequencies or\n2M real frequencies (i.e. 2p+2M total). In order to reduce the number of parameters and to improve the\nestimator covariance we instead use the following input signal\n( )\n\n( )\n\nWhere \u3008 ( )\u3009\n( )\n\n( )\n\n\u3008 ( )\u3009\n\n(4)\n\nis the average of the signal inside each step Ui(n). Hence,\n\u3008 ( )\u3009\n\n( )\n\n(5)\n\nThe correlated noise averaged in each pixel is expressed by:\n\u3008 ( )\u3009\n\n\u2211\n\n*( \u2211\n\n( ))\n\n( )+\n\n(6)\n\nWe see that equation (6) is independent of the true pedestal and pixel values, which are accounted for\nseparately.\nThe estimator model becomes:\n(7)\nwhere y is Nx1 dimensional, \u03b8 is the 2M dimensional parameter vector and H is an Nx2M matrix. The H\nmatrix is generated by H=F-E where F is a Fourier base of sines and cosines and E is a matrix of step\nfunctions whose values equal to the average of Fourier modes in each pixel interval. As a consequence H\nis not orthogonal. The parameter estimation is obtained by\n\u0302\n\n(\n\n)\n\n(8)\n\nAlthough H is a long matrix in the N dimension the pseudoinverse has to be computed only once.\nThe estimation process is bounded by computing resources and numerical problems related to matrix size.\nWe have obtained excellent results using discrete data sets of 20 pixels and 20 pedestals.\nAn important step in the estimation process is to determine the number of modes to be estimated. Since the\nfiltered signal is later integrated by the CDS, the noise components are weighted by the CDS transfer\nfunction (Figure 4). Figure 10a shows a typical spectral analysis of the correlated noise for 20 pixels\nweighted by the CDS transfer function. Figure 10b shows the cumulative noise versus the number of\nspectral modes. The first 200 low frequency modes, i.e. a 20KHz total noise bandwidth, account for 85% of\nthe low frequency noise. It is worth mentioning that these plots do not take into account errors in the\nestimation process which will be analyzed in Section 6.\n\n\fFig. 10: a) Noise spectrum weighted by the CDS transfer function. b) Cumulative correlated noise as a\nfunction of the number of modes.\n\n5 Estimation results\nWe have applied the estimation and filtering algorithm described in Section 4 to numerous sets of video\ndata.\nSome data sets acquired CCD and readout system noise in the video while the CCD clocks are not\noperating or are operated in reverse. The CCD operated in reverse give us the lowest noise values. We still\nget all the video amplifier, power supply noise and clock crosstalk but we do not get any charge noise due\nto leftover charge in the CCD. We have also applied the same methods to normal CCD readout datasets.\nFigure 11 shows the RMS noise of a 2 channel DES CCD operated normally as a function of the CDS\nwindow integration time. The dotted trace video has previously processed by the estimator. The trace with\ncircles only computes the digital CDS. The processed signal achieves a minimum noise of 0.5e- at about\n70\u03bcs. This is an improvement of 3 to 4 over the digital CDS.\n\nFig. 11: Comparison of the R.M.S. noise as a function of the CDS integration time for a signal processed by\nthe estimator and the same signal not processed by the estimator.\nThe picture in Figure 12 corresponds to a 12 video channel CCD designed by Berkeley National\nLaboratory. In this case the video data does not have the CCD clocks running but still measures all the\nCCD video amplifier noise and system noise, including the 1/f noise. The plot displays the average noise of\n100 data sets and 1-\u03c3 error bars. The signal processed by the estimator has a minimum noise of 0.4e- at 120\n\u03bcs, which is a factor of 3.5 times better than the digital CDS alone. It is also interesting that the 1-\u03c3 error\n\n\fbars of the estimator processed data are 4 times smaller than the ones for the unprocessed data. The plot\nalso shows increasing noise at longer integration times due to residual 1/f noise.\n\nFig. 12: Comparison of the R.M.S. noise as a function of the CDS integration time for a signal processed by\nthe estimator and the same signal not processed by the estimator. Plot also shows 1- \u03c3 error bars.\nFigure 13 compares the noise power spectrum of the unfiltered signal and the filtered signal after the low\nfrequency estimation of 200 modes has been subtracted. On average, the LFC noise has been reduced by\nalmost an order of magnitude on average. It can also be observed that the filter works more effectively for\nthe higher estimated modes due to non-uniform estimation errors. Please note that the noise and spectrum\nplots of Figures 11 to 13 are affected by estimation errors, which are the main limitation to achieving\nfurther noise reduction.\n\nFig. 13: Noise spectrum comparison between a signal processed by the estimator and the same signal not\nprocessed by the estimator.\n\n6 Estimation error\nThe estimation errors can be computed using the \u03c72 covariance matrix\n(\n)\n(9)\nIf the uncorrelated noise is WGN~(0,\u03c32) (9) can be expressed by\n(\n)\n(10)\nThe error amplification matrix (HTH)-1 in (10) can be computed numerically. Since H in not orthogonal,\n(HTH)-1 is not diagonal and the \u03b8s will be correlated. The diag(HTH)-1 is inversely proportional to the\nnumber of samples N.\nThe main problem in the estimation of LFC noise is that due to the non orthogonality of H, the inverse\nproblem quickly becomes ill-conditioned as we increase the numbers of parameters to be estimated. Figure\n\n\f14 shows the condition number of HTH as a function of the number of modes in H for up to 200 modes. For\nlarge H small oscillations in the data produce large variations in the parameter vector \u03b8.\n\nFig. 14: Estimation error analysis. HTH condition number as a function of the number of estimated modes.\nThe estimator has been analyzed using SVD and generalized SVD techniques for several (H,L) pairs, where\nL is a linear operator. The minimization procedure was carried using Tikhonov's rule:\n*\u2016\n\n\u2016\n\n\u2016\n\n\u2016 +\n\nWe also observe that the low frequency estimation errors have a heavier weight. Figure 15 shows the error\namplification of (HTH)-1 normalized to N=1 for a 200 mode estimator versus a 20 mode estimator. The 200\nmode estimator has almost an order of magnitude more error in the first 15 modes due to mode correlation.\n\nFig. 15: Estimation error as a function of the estimated mode.\nThe low noise results shown in Figures 11 to 13 have been obtained using a slightly different approach.\nInstead of inverting a large (i.e. 200 mode matrix) a series of smaller matrices (i.e. 20 modes) are inverted\nand used for estimation. The reasoning is that LF noise modes that are far away from each other are\nuncorrelated. This method is effective and keeps the C\u03b8 small for most \u03b8i. However, as it can be seen in\nFigure 13, a few modes have a large estimation error. The optimal solution to minimize the C \u03b8 is still open\nand we will keep studying the subject.\nCurrently, the WGN \u03c3 has been improved to 1.8nV/sqrt(Hz). The total estimation error is numerically\ncomputed and shown to be about 0.1e-.\n\n\f7 Hardware implementation\nThe estimator and digital CDS reduce the CCD noise deep into the sub-electron region. The price to pay for\nlower noise is a more sophisticated readout system. The estimator requires an FPGA or processor capable\nof performing millions of multiplications per second, subtracting the estimated LFN from the original\nsignal and digitally computing the CDS of the filtered signal. However, modern FPGAs have enough\nhorsepower to process and filter several video channels.\nThe example in this paper estimates correlated noise in data sets of 20 pixels long and shows a minimum\nfor an integration time of about 120\u03bcs. The data is sampled at 20 MHz and pre-filtered and decimated,\nproducing a data steam of 125Ksamples/s. Each 20 pixel dataset is 5ms long and has 6000 samples. The\nnumber of multiplications required for the estimation of 2 times 200 modes is 2.4 million in 5ms or 480\nmillion multiplications/s. The filter reconstruction requires the same number for a total of 960 million\nmultiplications/s. Modern FPGAs have hundreds and even a couple of thousands of multipliers running up\nto 400 million multiplications/s. It is also worth mentioning that the pseudo inverse of H needs to be\ncomputed only once, so it can be computed off line and stored in memory. The memory requirements are N\nby 2M. This is 3.6MB for the current example.\nFigure 16 shows a fits image taken with the FPGA based digital CDS.\n\nFigure 16: CCD image taken with the FPGA based digital CDS.\n\n8 Conclusions and future work\nFast sampling and digital processing the CCD video signal has allowed us to reduce the low frequency\nnoise that correlates pixel to pixel. Deep sub electron noise of 0.4e - and 1-\u03c3 error bars of 0.05 e-have been\nsystematically achieved by this method. The readout bandwidth is about 4 Kpix/s. We have also achieved\n1e- of noise at 50 Kpix/s by improving EMI, crosstalk, and power supply noises. Digital CCD readout\nsystems are more sophisticated than traditional analog CDS but will allow better signal to noise ratio for\nspectrometers and will improve the sensitivity of CCD based detectors at very low energies. This is\nessential in CCD based direct Dark Matter search and neutrino experiments and also nuclear applications\nsuch as neutron imaging.\nThe complexity of the digital signal processing can be overcome with the use of FPGAs or embedded\nprocessors. Currently we are developing an FPGA based system that can accommodate several CCD video\nchannels. The goal is to obtain a sub electron noise image in fits format. The search for lower noise is not\nfinished yet. Further understanding of noise contribution in the estimator and the achievement of lower\nWGN will be pursued in the near future.\n\n\fAcknowledgements\nWe want to thank the Fermilab staff at SiDet facility, in particular Kevin Kuk, Donna Kubik, Walter\nStruemel who helped us with the operations of CCDs systems; and Stephen Holland from Lawrence\nBerkeley National Laboratory for always being available to answer our CCD questions.\n\nReferences\nAmelio, G. F. Tompsett, M. F. and Smith, G. E. (April 1970). \"Experimental Verification of the Charge\nCoupled Device Concept\". Bell Sys. Tech. J. 49 (4): 593\u2013600.\nAnalog Devices: 2.5 MSPS, 24-Bit, 100 dB Sigma-Delta ADC with On-Chip Buffer, Analog Devices 2006.\nBoyle, W.S.: Nobel Lecture: CCD-An extension of man's view. Rev. Mod. Phys., 82 (3), 2305\u20132306,\n(2010).\nChandler, C.E., Bredthauer, R.A., Janesick, J.R., Westphal, J.A., Gunn, J.E.: Sub-electron noise charge\ncoupled devices, SPIE Charge-Coupled Devices and Solid State Optical Sensors 1242 , 238\u2013251 (1990).\nDiehl, H.T., Angstadt, R., Campa, J., CeaseH., Derylo, G., Emes, J.H, Estrada, J., Kubik, D., Flaugher,\nB.L., Holland, S.E, Jonas, M., Kolbe, W., Krider, J., Kuhlmann, S., Kuk, K., Maiorino, M., Palaio, N.,\nPlazas, A., Roe, N.A., Scarpine, V., Schultz, K., Shaw, T., Spinka, H., Stuermer, W.: Characterization of\nDECam focal plane detectors, in Dorn, D.A., Holland, D. (eds), High Energy, Optical and Infrared\nDetectors for Astronomy III, Proceedings of the SPIE, 7021 , 70217 (2008).\nEstrada, J., Abbott, T., Angstadt, B., Buckley-Geer, L., Brown, M., Campa, J., Cardiel, L., Cease, H.,\nFlaugher, B., Dawson, K., Derylo, G., Diehl, H.T., Gruenendahl, S., Karliner, I., Merrit, W., Moore, P.,\nMoore, T.C., Roe, N., Scarpine, V., Schmidt, R., Schubnel, M., Shaw, T., Stuermer, W., Thaler, J.: CCD\ntesting and characterization for dark energy survey, in I.S. McLean, M. Iye (eds.) Ground-based and\nAirborne Instrumentation for Astronomy, Proceedings of the SPIE, 6269 , 62693K, (2006).\nEstrada, J., Cease, H., Diehl, T., Flaugher, B., Jones, J., Kibik, D., Sonnenschein, S.: Prospects for a direct\ndark matter search using high resistivity CCD detectors URL arXiv:0802.2872v3[hep-ex](1Jul2008)\n(2008).\nFlaugher, B.: The Dark Energy Survey instrument design, in I.S. McLean, M. Iye (eds.) Ground-based and\nAirborne Instrumentation for Astronomy, Proceedings of the SPIE, 6269 , (2006).\nHolland, S.E., Groom, D.E., Palaio, N.P., Stover, R.J., Wei, M.: Fully depleted, back-illuminated\ncharge-coupled devices fabricated on high-resistivity silicon, IEEE Trans. Electron Devices 50 (1), 225\u2013\n238 (2003).\nHonscheid, K., DePoy, D.L.: The Dark Energy Camera (DECam). A new instrument for the Dark Energy\nSurvey, IEEE Nuclear Science Symposium Conference Record NSS '08, 3357\u20133360 (2008).\nJanesick, J.R.:\n(2001).\n\nScientific Charge Coupled Devices, SPIE Publications, Bellingham, Washington,\n\n\fJanesick, J.R., Elliot, T., Dingizian, A., Bredthauer, R., Chandles, C., Westphal, J., Gunn, J.: New\nadvancements in charge-coupled device technology: sub-electron noise and 4096x4096 pixel CCDs,\nSPIE Charge-Coupled Devices and Solid State Optical Sensors 1242 , 223\u2013237 (1990).\nMcLean, I.: Electronic Imaging in Astronomy - Detectors and Instrumentation, 2nd ed., Springer-Praxis,\nBerlin (2008).\nSmith, G.E.: Nobel Lecture: The invention and early history of the CCD, Rev. Mod. Phys. 82 (3), 2307\u2013\n2312, (2010).\nWey, H.M., Guggenbuhl, W.: An improved correlated double sampling circuit for low noise charge\ncoupled devices, IEEE Trans. Circuits Syst. 37 (12), 1559\u20131565 (1990).\n\n\f"}