{"id": "http://arxiv.org/abs/math/0408053v1", "guidislink": true, "updated": "2004-08-04T16:54:09Z", "updated_parsed": [2004, 8, 4, 16, 54, 9, 2, 217, 0], "published": "2004-08-04T16:54:09Z", "published_parsed": [2004, 8, 4, 16, 54, 9, 2, 217, 0], "title": "Canonical characters on quasi-symmetric functions and bivariate Catalan\n  numbers", "title_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0610100%2Cmath%2F0610368%2Cmath%2F0610143%2Cmath%2F0610322%2Cmath%2F0610860%2Cmath%2F0610815%2Cmath%2F0610016%2Cmath%2F0610924%2Cmath%2F0610523%2Cmath%2F0610706%2Cmath%2F0610753%2Cmath%2F0610944%2Cmath%2F0610184%2Cmath%2F0610469%2Cmath%2F0610072%2Cmath%2F0610702%2Cmath%2F0610780%2Cmath%2F0610637%2Cmath%2F0610310%2Cmath%2F0610134%2Cmath%2F0408400%2Cmath%2F0408278%2Cmath%2F0408035%2Cmath%2F0408362%2Cmath%2F0408186%2Cmath%2F0408221%2Cmath%2F0408045%2Cmath%2F0408162%2Cmath%2F0408053%2Cmath%2F0408239%2Cmath%2F0408127%2Cmath%2F0408156%2Cmath%2F0408020%2Cmath%2F0408261%2Cmath%2F0408322%2Cmath%2F0408207%2Cmath%2F0408131%2Cmath%2F0408002%2Cmath%2F0408389%2Cmath%2F0408074%2Cmath%2F0408305%2Cmath%2F0408260%2Cmath%2F0408413%2Cmath%2F0408306%2Cmath%2F0408396%2Cmath%2F0408330%2Cmath%2F0408401%2Cmath%2F0408231%2Cmath%2F0408050%2Cmath%2F0408246%2Cmath%2F0408142%2Cmath%2F0408292%2Cmath%2F0408415%2Cmath%2F0408014%2Cmath%2F0408043%2Cmath%2F0408414%2Cmath%2F0408262%2Cmath%2F0408115%2Cmath%2F0408222%2Cmath%2F0408341%2Cmath%2F0408208%2Cmath%2F0408380%2Cmath%2F0408001%2Cmath%2F0408317%2Cmath%2F0408028%2Cmath%2F0408301%2Cmath%2F0408319%2Cmath%2F0408238%2Cmath%2F0408350%2Cmath%2F0408232%2Cmath%2F0408129%2Cmath%2F0408101%2Cmath%2F0408310%2Cmath%2F0408373%2Cmath%2F0408066%2Cmath%2F0408160%2Cmath%2F0408119%2Cmath%2F0408276%2Cmath%2F0408399%2Cmath%2F0408023%2Cmath%2F0408122%2Cmath%2F0408152%2Cmath%2F0408027%2Cmath%2F0408150%2Cmath%2F0408214%2Cmath%2F0408412%2Cmath%2F0408267%2Cmath%2F0408072%2Cmath%2F0408004%2Cmath%2F0408193%2Cmath%2F0408064%2Cmath%2F0408364%2Cmath%2F0408169%2Cmath%2F0408161%2Cmath%2F0408080%2Cmath%2F0408052%2Cmath%2F0408408%2Cmath%2F0408197%2Cmath%2F0408046%2Cmath%2F0408083%2Cmath%2F0408339&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Canonical characters on quasi-symmetric functions and bivariate Catalan\n  numbers"}, "summary": "Every character on a graded connected Hopf algebra decomposes uniquely as a\nproduct of an even character and an odd character (Aguiar, Bergeron, and\nSottile, math.CO/0310016).\n  We obtain explicit formulas for the even and odd parts of the universal\ncharacter on the Hopf algebra of quasi-symmetric functions. They can be\ndescribed in terms of Legendre's beta function evaluated at half-integers, or\nin terms of bivariate Catalan numbers:\n  $$ C(m,n)=\\frac{(2m)!(2n)!}{m!(m+n)!n!}. $$\n  Properties of characters and of quasi-symmetric functions are then used to\nderive several interesting identities among bivariate Catalan numbers and in\nparticular among Catalan numbers and central binomial coefficients.", "summary_detail": {"type": "text/plain", "language": null, "base": "http://export.arxiv.org/api/query?search_query=&id_list=math%2F0610100%2Cmath%2F0610368%2Cmath%2F0610143%2Cmath%2F0610322%2Cmath%2F0610860%2Cmath%2F0610815%2Cmath%2F0610016%2Cmath%2F0610924%2Cmath%2F0610523%2Cmath%2F0610706%2Cmath%2F0610753%2Cmath%2F0610944%2Cmath%2F0610184%2Cmath%2F0610469%2Cmath%2F0610072%2Cmath%2F0610702%2Cmath%2F0610780%2Cmath%2F0610637%2Cmath%2F0610310%2Cmath%2F0610134%2Cmath%2F0408400%2Cmath%2F0408278%2Cmath%2F0408035%2Cmath%2F0408362%2Cmath%2F0408186%2Cmath%2F0408221%2Cmath%2F0408045%2Cmath%2F0408162%2Cmath%2F0408053%2Cmath%2F0408239%2Cmath%2F0408127%2Cmath%2F0408156%2Cmath%2F0408020%2Cmath%2F0408261%2Cmath%2F0408322%2Cmath%2F0408207%2Cmath%2F0408131%2Cmath%2F0408002%2Cmath%2F0408389%2Cmath%2F0408074%2Cmath%2F0408305%2Cmath%2F0408260%2Cmath%2F0408413%2Cmath%2F0408306%2Cmath%2F0408396%2Cmath%2F0408330%2Cmath%2F0408401%2Cmath%2F0408231%2Cmath%2F0408050%2Cmath%2F0408246%2Cmath%2F0408142%2Cmath%2F0408292%2Cmath%2F0408415%2Cmath%2F0408014%2Cmath%2F0408043%2Cmath%2F0408414%2Cmath%2F0408262%2Cmath%2F0408115%2Cmath%2F0408222%2Cmath%2F0408341%2Cmath%2F0408208%2Cmath%2F0408380%2Cmath%2F0408001%2Cmath%2F0408317%2Cmath%2F0408028%2Cmath%2F0408301%2Cmath%2F0408319%2Cmath%2F0408238%2Cmath%2F0408350%2Cmath%2F0408232%2Cmath%2F0408129%2Cmath%2F0408101%2Cmath%2F0408310%2Cmath%2F0408373%2Cmath%2F0408066%2Cmath%2F0408160%2Cmath%2F0408119%2Cmath%2F0408276%2Cmath%2F0408399%2Cmath%2F0408023%2Cmath%2F0408122%2Cmath%2F0408152%2Cmath%2F0408027%2Cmath%2F0408150%2Cmath%2F0408214%2Cmath%2F0408412%2Cmath%2F0408267%2Cmath%2F0408072%2Cmath%2F0408004%2Cmath%2F0408193%2Cmath%2F0408064%2Cmath%2F0408364%2Cmath%2F0408169%2Cmath%2F0408161%2Cmath%2F0408080%2Cmath%2F0408052%2Cmath%2F0408408%2Cmath%2F0408197%2Cmath%2F0408046%2Cmath%2F0408083%2Cmath%2F0408339&start=0&max_results=1000&sortBy=relevance&sortOrder=descending", "value": "Every character on a graded connected Hopf algebra decomposes uniquely as a\nproduct of an even character and an odd character (Aguiar, Bergeron, and\nSottile, math.CO/0310016).\n  We obtain explicit formulas for the even and odd parts of the universal\ncharacter on the Hopf algebra of quasi-symmetric functions. They can be\ndescribed in terms of Legendre's beta function evaluated at half-integers, or\nin terms of bivariate Catalan numbers:\n  $$ C(m,n)=\\frac{(2m)!(2n)!}{m!(m+n)!n!}. $$\n  Properties of characters and of quasi-symmetric functions are then used to\nderive several interesting identities among bivariate Catalan numbers and in\nparticular among Catalan numbers and central binomial coefficients."}, "authors": ["Marcelo Aguiar", "Samuel K. Hsiao"], "author_detail": {"name": "Samuel K. Hsiao"}, "author": "Samuel K. Hsiao", "links": [{"href": "http://arxiv.org/abs/math/0408053v1", "rel": "alternate", "type": "text/html"}, {"title": "pdf", "href": "http://arxiv.org/pdf/math/0408053v1", "rel": "related", "type": "application/pdf"}], "arxiv_primary_category": {"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom"}, "tags": [{"term": "math.CO", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "math.QA", "scheme": "http://arxiv.org/schemas/atom", "label": null}, {"term": "05A15, 05E05, 16W30, 16W50", "scheme": "http://arxiv.org/schemas/atom", "label": null}], "pdf_url": "http://arxiv.org/pdf/math/0408053v1", "affiliation": "None", "arxiv_url": "http://arxiv.org/abs/math/0408053v1", "arxiv_comment": null, "journal_reference": null, "doi": null, "fulltext": "arXiv:math/0408053v1 [math.CO] 4 Aug 2004\n\nCANONICAL CHARACTERS ON QUASI-SYMMETRIC FUNCTIONS\nAND BIVARIATE CATALAN NUMBERS\nMARCELO AGUIAR AND SAMUEL K. HSIAO\nAbstract. Every character on a graded connected Hopf algebra decomposes uniquely as\na product of an even character and an odd character [2]. We obtain explicit formulas for\nthe even and odd parts of the universal character on the Hopf algebra of quasi-symmetric\nfunctions. They can be described in terms of Legendre's beta function evaluated at halfintegers, or in terms of bivariate Catalan numbers:\n(2m)!(2n)!\n.\nC(m, n) =\nm!(m + n)!n!\nProperties of characters and of quasi-symmetric functions are then used to derive several\ninteresting identities among bivariate Catalan numbers and in particular among Catalan\nnumbers and central binomial coefficients.\n\nContents\n1. Introduction\n2. Even and odd characters\n3. The canonical characters of QSym on the monomial basis\n4. Application: Identities for Catalan numbers and central binomial coefficients\n5. The canonical characters of QSym on the fundamental basis\n6. Application: Identities for bivariate Catalan numbers\n7. Identities for bivariate Catalan numbers via the Hopf algebra of permutations\n8. Inverses of canonical characters and more applications\nAppendix. Bivariate Catalan numbers as binomial coefficients\nReferences\n\n1\n4\n6\n9\n13\n21\n23\n26\n30\n32\n\n1. Introduction\nThe numbers\n(1)\n\n(2m)!(2n)!\nC(m, n) :=\n=\nm!(m + n)!n!\n\n\u0001\n\n2m 2n\nm\nn\n\u0001\nm+n\nn\n\n\u0001\n\nDate: July 23, 2004.\n2000 Mathematics Subject Classification. 05A15, 05E05, 16W30, 16W50.\nKey words and phrases. Hopf algebra, character, quasi-symmetric function, central binomial coefficient,\nCatalan number, bivariate Catalan number, super ballot number, peak of a permutation.\nAguiar supported in part by NSF grant DMS-0302423.\nHsiao supported in part by the NSF Postdoctoral Research Fellowship.\n1\n\n\f2\n\nM. AGUIAR AND S. HSIAO\n\nappeared in work of Catalan [4, p. 207], [5, Sections CV and CCXIV], [6, pp. 110-113],\nvon Szily [21, pp. 89\u201391], Riordan [16, Chapter 3, Exercise 9, p. 120], and recent work of\nGessel [11]. We call them bivariate Catalan numbers. They are integers (and except for\nC(0, 0) = 1, they are all even). Special cases include the central binomial coefficients and\nthe Catalan numbers:\n\u0012 \u0013\n\u0012 \u0013\n1\n2n\n2n\n1\nand C(1, n) =\nC(0, n) =\n.\nn\n2\nn+1 n\nIn turn, the bivariate Catalan numbers are special cases of the super ballot numbers of\nGessel [11].\nThe algebra QSym of quasi-symmetric functions was introduced in earlier work of Gessel [10] as a source of generating functions for Stanley's P -partitions [17]; since then, the\nliterature on the subject has become vast. The linear bases of QSym are indexed by compositions \u03b1 of n. Two important bases are given by the monomial and fundamental quasisymmetric functions M\u03b1 and F\u03b1 ; for more details, see [10], [15, Chapter 4], or [18, Section\n7.19].\nIn [2], an important universal property of QSym was derived. Consider the functional\n\u03b6 : QSym \u2192 k obtained by specializing one variable of a quasi-symmetric function to 1 and\nall other variables to 0. On the monomial and fundamental bases of QSym, this functional\nis given by\n\n(2)\n\n(\n1 if \u03b1 = (n) or ( ),\n\u03b6(M\u03b1 ) = \u03b6(F\u03b1) =\n0 otherwise.\n\nA character on a Hopf algebra H is a morphism of algebras \u03c6 : H \u2192 k:\n\u03c6(ab) = \u03c6(a)\u03c6(b) ,\n\n\u03c6(1) = 1 .\n\nQSym is a graded connected Hopf algebra and the functional \u03b6 is a character on QSym. The\nuniversal property states that given any graded connected Hopf algebra H and a character\n\u03c6 : H \u2192 k, there exists a unique morphism of graded Hopf algebras \u03a6 : H \u2192 QSym making\nthe following diagram commutative [2, Theorem 4.1]:\nHA\n\n\u03a6\n\nAA\nAA\n\u03c6 AAA\n\nk\n\n/\n\nQSym\n\ny\nyy\nyy\ny\ny \u03b6\ny| y\n\nFor this reason, we refer to \u03b6 as the universal character on QSym. There are other characters\non QSym canonically associated to \u03b6 that are of interest to us. In spite of the simple definition\nof \u03b6, these characters encompass important combinatorial information. Some of these were\nexplicitly described and studied in [2], and shown to be closely related to a Hopf subalgebra\nof QSym introduced by Stembridge [19], to the generalized Dehn-Sommerville relations, and\nto other combinatorial constructions. Other canonical characters, less easy to describe but\nof a more fundamental nature, are the object of this paper.\nWe review other relevant background and constructions from [2].\n\n\fCANONICAL CHARACTERS\n\n3\n\nLet H be an arbitrary Hopf algebra. The convolution product of two linear functionals\n\u03c1, \u03c8 : H \u2192 k is\n\u2206\n\n\u03c1\u2297\u03c8\n\nm\n\nH\u2212\n\u2192 H \u2297 H \u2212\u2212\u2192 k \u2297 k \u2212\n\u2192 k,\nwhere \u2206 is the coproduct of H and m is the product of the base field. We denote the\nconvolution product by \u03c1\u03c8. The set of characters on any Hopf algebra is a group under the\nconvolution product. The unit element is \u01eb : H \u2192 k, the counit map of H. The inverse of a\ncharacter \u03c6 is \u03c6\u22121 := \u03c6 \u25e6 S, where S is the antipode of H.\nSuppose that H is graded, i.e., H = \u2295n\u22650 Hn and the structure maps of H preserve this\ndecomposition. Then H carries a canonical automorphism defined on homogeneous elements\nh of degree n by h 7\u2192 h\u0304 := (\u22121)n h. If \u03c6 is a functional on H, we define a functional \u03c6\u0304 by\n\u03c6\u0304(h) = \u03c6(h\u0304). The functional \u03c6 is said to be even if\n\u03c6\u0304 = \u03c6\nand it is said to be odd if it is invertible with respect to convolution and\n\u03c6\u0304 = \u03c6\u22121 .\nSuppose now that H is graded and connected, i.e., H0 = k * 1. One of the main results of [2]\nstates that any character \u03c6 on H decomposes uniquely as a product of characters\n\u03c6 = \u03c6+ \u03c6\u2212\nwith \u03c6+ even and \u03c6\u2212 odd [2, Theorem 1.5].\nThe main purpose of this paper is to obtain explicit descriptions for the canonical characters \u03b6+ and \u03b6\u2212 of QSym. We find that the values of both characters are given in terms of\nbivariate Catalan numbers (up to signs and powers of 2). On the monomial basis, the values\nare Catalan numbers and central binomial coefficients (Theorem 3.2). On the fundamental\nbasis, general bivariate Catalan numbers intervene (Theorem 5.1). The connection with\nLegendre's beta function is given in Remark 5.2. The proofs rely on a number of identities\nfor these numbers, of which some are known and others are new. In turn, the general properties of even and odd characters imply further identities that these numbers must satisfy.\nWe obtain in this way a large supply of identities for Catalan numbers and central binomial coefficients (Section 4) and for bivariate Catalan numbers (Sections 6 and 7). As one\nshould expect, some of these identities may also be obtained by more standard combinatorial arguments, at least once one is confronted with them. Our methods, however, yield the\nidentities without any previous knowledge of their form. We mention here four of the most\nrepresentative among the identities we derive:\nX (\u22121)ke (\u03b1) \u00122\u230ako (\u03b1)/2\u230b\u0013\n(14)\n= 0;\n4\u230ako (\u03b1)/2\u230b \u230ako (\u03b1)/2\u230b\n\u03b1<\u03b2\na1 odd\n\n(40)\n\nh\nX\nj=0\n\nC3 (j)C3 (h \u2212 j) = 2\n\nh\u22121\nX\nj=0\n\nC2 (j)C1 (h \u2212 1 \u2212 j) ;\n\n\f4\n\nM. AGUIAR AND S. HSIAO\n\n(49)\n\nX\n\n\u03c3\u2208Sn\n\n\u0001\n(\u22121)p\u2212 (\u03c3) C p\u2212 (\u03c3), \u230an/2\u230b \u2212 p\u2212 (\u03c3) = 4\u230an/2\u230b ;\ns\n\n(65)\n\nX 1\n1\nC(r + 1, j) .\n2C(r) = s C(r, s + 1) +\n4\n4j\nj=1\n\nIn (14), ke (\u03b1) and ko (\u03b1) are the number of even parts and the number of odd parts of a\ncomposition \u03b1, \u03b2 = (b1 , . . . , bk ) is any fixed composition such that ke (\u03b2) \u2261 0 and b1 \u2261 bk\nmod 2, and the sum is over those compositions \u03b1 = (a1 , . . . , ah ) whose first part is odd and\nwhich are strictly refined by \u03b2. The numbers Ci (j) appearing in (40) are central Catalan\nnumbers; see (39). In (49), p\u2212 (\u03c3) denotes the number of interior peaks of the permutation\n\u03c3; see Section 7. Equation (65) expresses a Catalan number in terms of bivariate Catalan\nnumbers.\nIn Section 8 we derive explicit formulas for the even and odd characters entering in the\ndecomposition of the inverse (with respect to convolution) of the universal character, and\ndeduce some more identities, including (65).\nWe work over a field k of characteristic different from 2.\n2. Even and odd characters\nLet H be a graded connected Hopf algebra and \u03c6 : H \u2192 k a linear functional such\nthat \u03c6(1) = 1 (this holds if \u03c6 is a character). Let \u03c6n denote the restriction of \u03c6 to the\nhomogeneous component of H of degree n. By assumption, \u03c60 = \u01eb0 , where \u01eb is the counit of\nH. This guarantees that \u03c6 is invertible with respect to convolution: the inverse functional\n\u03c6\u22121 is determined by the recursion\n\u22121\n\n(\u03c6 )n = \u2212\n\nn\nX\n\n\u03c6i (\u03c6\u22121 )n\u2212i\n\ni=1\n\nwith initial condition (\u03c6\u22121 )0 = \u01eb0 .\n\nLemma 2.1. Let H be a graded connected Hopf algebra and \u03c6 : H \u2192 k a linear functional\nsuch that \u03c6(1) = 1. There are unique linear functionals \u03c1, \u03c8 : H \u2192 k such that\n(a) \u03c1(1) = \u03c8(1) = 1,\n(b) \u03c1 is even and \u03c8 is odd,\n(c) \u03c6 = \u03c1\u03c8.\nMoreover, if \u03c6 is a character then so are \u03c1 and \u03c8.\nProof. Items (a), (b), and (c) can be derived as in the proof of [2, Theorem 1.5], while [2,\nProposition 1.4] guarantees that if \u03c6 is a character then so are \u03c1 and \u03c8.\n\u0003\nIn this situation, we write \u03c6+ := \u03c1 and \u03c6\u2212 := \u03c8 and refer to them as the even part and\nthe odd part of \u03c6. According to the results cited above, \u03c6+ is uniquely determined by the\n\n\fCANONICAL CHARACTERS\n\nrecursion\n(\u22121)n \u03c6n = 2(\u03c6+ )n + (\u03c6\u22121 )n +\n\nX\n\n5\n\n(\u03c6+ )i (\u03c6\u22121 )j (\u03c6+ )k ,\n\ni+j+k=n\n0\u2264i,j,k<n\n\nand \u03c6\u2212 by\n(\u03c6\u2212 )n = \u03c6n \u2212\n\nn\nX\n\n(\u03c6+ )i (\u03c6\u2212 )n\u2212i\n\ni=1\n\nwith initial conditions (\u03c6+ )0 = (\u03c6\u2212 )0 = \u01eb.\n\nLemma 2.2. Suppose H and K are graded connected Hopf algebras, \u03c6 : H \u2192 k and \u03c8 :\nK \u2192 k are characters, and \u03a6 : H \u2192 K is a morphism of graded Hopf algebras such that\n\u03a6\n\nH?\n\n??\n??\n\u03c6 ???\n\u001f\n\nk\n\n/K\n\u007f\n\u007f\u007f\n\u007f\u007f\n\u007f\n\u007f\u007f \u007f \u03c8\n\ncommutes. Then diagrams\nH?\n\n\u03a6\n\n??\n??\n\u03c6+ ???\n\u001f\n\nk\n\n/K\n\u007f\n\u007f\n\u007f\u007f\n\u007f\u007f \u03c8+\n\u007f\n\u007f\u007f\n\nH?\n\n\u03a6\n\n??\n??\n\u03c6\u2212 ???\n\u001f\n\nk\n\n/K\n\u007f\n\u007f\n\u007f\u007f\n\u007f\u007f \u03c8\u2212\n\u007f\n\u007f\u007f\n\ncommute as well.\nProof. Composition with \u03a6 gives a morphism from the character group of K to the character\ngroup of H which preserves the canonical involution \u03c6 7\u2192 \u03c6\u0304. Thus \u03c8 = \u03c8+ \u03c8\u2212 implies\n\u03c8 \u25e6 \u03a6 = (\u03c8+ \u25e6 \u03a6)(\u03c8\u2212 \u25e6 \u03a6), \u03c8+ \u25e6 \u03a6 is even, and \u03c8\u2212 \u25e6 \u03a6 is odd. By uniqueness in Lemma 2.1,\n\u03c8+ \u25e6 \u03a6 = \u03c6+ and \u03c8\u2212 \u25e6 \u03a6 = \u03c6\u2212 .\n\u0003\nWhen H = QSym and \u03c6 = \u03b6 is the universal character (2), we refer to \u03b6+ and \u03b6\u2212 as the\ncanonical characters of QSym.\nLet \u03c1 and \u03c8 be arbitrary characters on QSym. For later use, we describe the convolution\nproduct \u03c1\u03c8 explicitly. Given a composition \u03b1 = (a1 , . . . , ak ) of a positive integer n and\n0 \u2264 i \u2264 n, let \u03b1i = (a1 , . . . , ai ) and \u03b1i = (ai+1 , . . . , ak ). We agree that \u03b10 = \u03b1k = ( ) (the\nempty composition). The coproduct of QSym is\n\u2206(M\u03b1 ) =\n\nk\nX\n\nM\u03b1i \u2297 M\u03b1i ,\n\ni=0\n\nwhere M( ) denotes the unit element 1 \u2208 QSym. It follows that\n(3)\n\n(\u03c1\u03c8)(M\u03b1 ) =\n\nk\nX\n\n\u03c1(M\u03b1i )\u03c8(M\u03b1i ) .\n\ni=0\n\nThe counit is\n\u01eb(M\u03b1 ) =\n\n(\n\n1\n0\n\nif \u03b1 = ( ),\notherwise.\n\n\f6\n\nM. AGUIAR AND S. HSIAO\n\n3. The canonical characters of QSym on the monomial basis\nFor any non-negative integer m, let\n\u0012 \u0013\n\u0012 \u0013\n2m\n1\n1\n2m\n;\nand C(m) := C(1, m) =\nB(m) := C(0, m) =\n2\nm+1 m\nm\nthese are the central binomial coefficients and the Catalan numbers.\nLemma 3.1. For any non-negative integer m,\n(4)\n\nB(m) = 2\n\nm\nX\n\nC(i \u2212 1)B(m \u2212 i) ,\n\ni=1\n\n22m =\n\n(5)\n\nm\nX\n\nB(m)B(m \u2212 i) .\n\ni=0\n\nProof. These are well-known identities. They appear in [13, Formulas (3.90) and (3.92)],\nand [16, Chapter 3, Exercise 9, p. 120, and Section 4.2, Example 2, p. 130]. For bijective\nproofs, see [8, Formulas (2) and (8)].\n\u0003\nFor a composition \u03b1, let |\u03b1| denote the sum of the parts of \u03b1, k(\u03b1) the number of parts of\n\u03b1, ke (\u03b1) the number of even parts of \u03b1, and ko (\u03b1) the number of odd parts of \u03b1. Note that\n(6)\nTheorem 3.2. Let\n\uf8f1\n\uf8f4\n\uf8f2\n(7) \u03b6\u2212 (M\u03b1 ) =\n\uf8f4\n\uf8f3\n\uf8f1\n\uf8f4\n\uf8f2\n(8) \u03b6+ (M\u03b1 ) =\n\uf8f4\n\uf8f3\n\nko (\u03b1) \u2261 |\u03b1| mod 2 .\n\u03b1 = (a1 , . . . , ak ) be a composition of a positive integer n. Then\n(\u22121)ke (\u03b1)\nC (0, \u230ako (\u03b1)/2\u230b) if ak is odd,\n22\u230ako (\u03b1)/2\u230b\n0\n\nif ak is even;\n\n(\u22121)ke (\u03b1)+1\nC (1, ko(\u03b1)/2 \u2212 1) if a1 and ak are odd and n is even,\n2ko (\u03b1)\n1\nif \u03b1 = (n) and n is even,\n0\notherwise.\n\nWe also have \u03b6\u2212 (1) = \u03b6+ (1) = 1.\n\nProof. Let \u03c1, \u03c8 : QSym \u2192 k be the linear maps defined by the proposed formula for \u03b6+ and\n\u03b6\u2212 , respectively. According to Lemma 2.1, to conclude \u03c1 = \u03b6+ and \u03c8 = \u03b6\u2212 , it suffices to\nshow that \u03c1\u03c8 = \u03b6, \u03c1\u0304 = \u03c1, and \u03c8\u0304 = \u03c8 \u22121 .\nSince \u03c1 vanishes on all compositions of n when n is odd, we have \u03c1\u0304 = \u03c1.\nWe show that \u03c1\u03c8 = \u03b6. Let ke := ke (\u03b1) and ko := ko (\u03b1).\nCase 1. Suppose that k = 1, so \u03b1 = (n). We have \u03c1(M(n) ) = 1 if n is even and 0 if n is odd;\nalso \u03c8(M(n) ) = 0 if n is even and 1 if n is odd. Thus (\u03c1\u03c8)(M(n) ) = \u03c1(M(n) ) + \u03c8(M(n) ) = 1 =\n\u03b6(M(n) ).\nIn all remaining cases k > 1 and \u03b6(M\u03b1 ) = 0 by (2).\n\n\fCANONICAL CHARACTERS\n\n7\n\nCase 2. Suppose that k > 1 and ak is even. By (3) we have\n(\u03c1\u03c8)(M\u03b1 ) =\n\nk\u22121\nX\n\n\u03c1(M\u03b1i )\u03c8(M\u03b1i ) + \u03c1(M\u03b1 ) = 0\n\ni=0\n\nby the second alternative of (7) applied to \u03b1i and the third alternative of (8) applied to \u03b1.\nCase 3. Suppose that k > 1, ak is odd, and a1 is even. In this case \u03c1(M\u03b1i ) = 0 for each\ni > 1, so by (3)\n(\u03c1\u03c8)(M\u03b1 ) = \u03c8(M\u03b1 ) + \u03c1(M(a1 ) )\u03c8(M(a2 ,...,ak ) ) =\n(\u22121)ke\n(\u22121)ke \u22121\nC(0,\n\u230ak\n/2\u230b)\n+\nC(0, \u230ako /2\u230b) = 0.\no\n22\u230ako /2\u230b\n22\u230ako /2\u230b\nCase 4. Suppose that k > 1 and ak , a1 , and n are odd. By (8), we have \u03c1(M\u03b1i ) = 0 unless\ni = 0 or ai is odd and |\u03b1i | is even. Hence\n\u0011\n\u0010\nX\nke ko \u22121\nke ko \u22121\n\u03c1(M\u03b1i )\u03c8(M\u03b1i )\n(\u22121) 2\n(\u03c1\u03c8)(M\u03b1 ) = (\u22121) 2\n\u03c8(M\u03b1 ) +\n1\u2264i\u2264k\u22121\nai odd\n|\u03b1i | even\n\n= B\n\n\u0012\n\nko (\u03b1) \u2212 1\n2\n\n\u0013\n\nX\n\n\u22122\n\n1\u2264i\u2264k\u22121\nai odd\n|\u03b1i | even\n\nC\n\n\u0012\n\n\u0013\n\u0013 \u0012\nko (\u03b1i )\nko (\u03b1i ) \u2212 1\n.\n\u22121 B\n2\n2\n\nwhen h is odd.\nWe used (6) and the fact that \u230ah/2\u230b = h\u22121\n2\nDeleting the even parts of \u03b1 and changing every odd part of \u03b1 to 1 does not change\nthe right-hand side of this equation. Thus we may assume without loss of generality that\n\u03b1 = (1, 1, . . . , 1) \u000f n = 2m + 1. In this case,\n(\u22121)ke 2ko \u22121 (\u03c1\u03c8)(M\u03b1 ) = B(m) \u2212 2\n\nm\nX\n\nC(j \u2212 1)B(m \u2212 j) = 0 ,\n\nj=1\n\nby Lemma 3.1.\nCase 5. Suppose that k > 1, ak and a1 are odd, and n is even. Then\n\u0011\n\u0010\nX\nke ko\nke ko\n\u03c1(M\u03b1i )\u03c8(M\u03b1i ) + \u03c1(M\u03b1 )\n(\u22121) 2 (\u03c1\u03c8)(M\u03b1 ) = (\u22121) 2 \u03c8(M\u03b1 ) +\n1\u2264i\u2264k\u22121\nai odd\n|\u03b1i | even\n\n=B\n\n\u0012\n\nko (\u03b1)\n2\n\n\u0013\n\n\u22122\n\nX\n\n1\u2264i\u2264k\u22121\nai odd\n|\u03b1i | even\n\nC\n\n\u0012\n\n\u0013\n\u0012\n\u0013 \u0012\n\u0013\nko (\u03b1i )\nko (\u03b1)\nko (\u03b1i )\n\u2212 2C\n\u22121 B\n\u22121 .\n2\n2\n2\n\n\f8\n\nM. AGUIAR AND S. HSIAO\n\nAs before, it suffices to consider the special case \u03b1 = (1, 1, . . . , 1) \u000f 2m. In this case,\nke ko\n\n(\u22121) 2 (\u03c1\u03c8)(M\u03b1 ) = B(m) \u2212 2\n= B(m) \u2212 2\n\nm\u22121\nX\n\nj=1\nm\nX\n\nC(j \u2212 1)B(m \u2212 j) \u2212 2C(m \u2212 1)\nC(j \u2212 1)B(m \u2212 j) = 0 ,\n\nj=1\n\nagain by Lemma 3.1.\n\nIt remains to show that \u03c8 \u22121 = \u03c8\u0304. Since \u03c8 is invertible (\u03c8(1) = 1), it suffices to show that\n\u03c8 \u03c8\u0304 = \u03b5.\nCase 1. If ak is even then \u03c8\u0304(M\u03b1i ) = 0 for every i < k and \u03c8(M\u03b1 ) = 0 by (7), so (\u03c8 \u03c8\u0304)(M\u03b1 ) =\n0.\nCase 2. Suppose ak and n are odd. In this case \u03c8\u0304(M\u03b1 ) = \u2212\u03c8(M\u03b1 ), so (\u03c8 \u03c8\u0304)(M\u03b1 ) =\nPk\u22121\ni\ni=1 \u03c8(M\u03b1i )\u03c8\u0304(M\u03b1i ). By (6), ko (\u03b1i ) + ko (\u03b1 ) = ko (\u03b1) is odd. Hence\n\u230ako (\u03b1i )/2\u230b + \u230ako (\u03b1i )/2\u230b =\n\nko (\u03b1) \u2212 1\nand ke (\u03b1i ) + ke (\u03b1i ) + |\u03b1i | \u2261 k(\u03b1) + |\u03b1i | mod 2 .\n2\n\nIt follows that\n(\u22121)k(\u03b1) 2ko (\u03b1)\u22121 (\u03c8 \u03c8\u0304)(M\u03b1 ) =\n\nX\n\n(\u22121)|\u03b1i | B(\u230ako (\u03b1i )/2\u230b)B(\u230ako (\u03b1i )/2\u230b) .\n\n1\u2264i\u2264k\u22121\nai odd\n\nAs before, we may assume \u03b1 = (1, 1, . . . , 1) \u000f n = 2m + 1, in which case the above sum\nbecomes\n2m\nX\n(\u22121)i B(\u230ai/2\u230b)B(\u230a2m + 1 \u2212 i/2\u230b) .\ni=1\n\nAs j runs from 1 to m, the terms in this sum corresponding to i = 2j and i = 2m \u2212 2j + 1\nare B(j)B(m \u2212 j) and \u2212B(m \u2212 j)B(j), respectively. Since this covers all terms, this sum is\nzero.\nCase 3. Suppose ak is odd and n is even. Similar considerations lead to\n(\u22121)k(\u03b1) 2ko (\u03b1) (\u03c8 \u03c8\u0304)(M\u03b1 ) =\n\u0010 k (\u03b1) \u0011\n\u0010 k (\u03b1 ) \u0011 \u0010 k (\u03b1i ) \u0011\nX\no\no\ni\no\nB\nB\n+\nB\n\u2212 22\n2\n2\n2\n1\u2264i\u2264k\u22121\nai odd\n|\u03b1i | even\n\nX\n\n1\u2264i\u2264k\u22121\nai odd\n|\u03b1i | odd\n\nB\n\n\u0010 k (\u03b1 ) \u2212 1 \u0011 \u0010 k (\u03b1i ) \u2212 1 \u0011\no\ni\no\nB\n.\n2\n2\n\nOnce again, we may assume \u03b1 = (1, 1, . . . , 1) \u000f n = 2m. Then showing that (\u03c8 \u03c8\u0304)(M\u03b1 ) = 0\nis equivalent to showing that\nm\nX\n\nB(i)B(m \u2212 i) = 22\n\ni=0\n\nThis equality follows from (5) in Lemma 3.1.\nThe proof is complete.\n\nm\u22121\nX\n\nB(i)B(m \u2212 1 \u2212 i) .\n\ni=0\n\n\u0003\n\n\fCANONICAL CHARACTERS\n\n9\n\n4. Application: Identities for Catalan numbers and central binomial\ncoefficients\nIn the proof of Theorem 3.2, we did not need to show that the functionals defined by (7), (8)\nare characters (morphisms of algebras); indeed, this fact follows from our argument. We may\nderive interesting identities involving Catalan numbers or central binomial coefficients from\nthis property. To this end, we first describe the product of two monomial quasi-symmetric\nfunctions. This result is known from [7, Lemma 3.3], [14], and [20, Section 5]. We present\nhere an equivalent but more convenient description due to Fares [9].\nGiven non-negative integers p and q, consider the set L(p, q) of lattice paths from (0, 0) to\n(p, q) consisting of unit steps which are either horizontal, vertical, or diagonal (usually called\nDelannoy paths). An element of L(p,\nP q) is thus a sequence L = (l1 , . . . , ls ) such that each li\nis either (1, 0), (0, 1), or (1, 1), and li = (p, q). Let h, v, and d be the number of horizontal,\nvertical, and diagonal steps in L. Then h + d = p, v + d = q, and s = h + v + d = p + q \u2212 d.\nThe number of lattice paths in L(p, q) with d diagonal steps is the multinomial coefficient\n\u0013\n\u0013 \u0012\n\u0012\np+q\u2212d\ns\n,\n=\np \u2212 d, q \u2212 d, d\nh, v, d\nsince such a path is determined by the decomposition of the set of steps into the subsets of\nhorizontal, vertical, and diagonal steps.\nGiven compositions \u03b1 = (a1 , . . . , ap ) and \u03b2 = (b1 , . . . , bq ) and L \u2208 L(p, q), we label each\nstep of L according to its horizontal and vertical projections, as indicated in the example\nbelow (p = 5, q = 4, and L is in red):\n(p,\nr\nr\nr\nr\nr\nt q)\nr a5 t\nb4\n\nb4\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nr\n\nt\n\nr\n\nr\n\nr\n\nr\n\nr\n\nb3\n\nr\n\nL\nr\n\nb2\n\na + b3\na3 r 4\n\na2 + b2\nr\n\nb1\n(0, 0) a1\n\na2\n\na3\n\na4\n\na5\n\nt\n\na1 r\n\nb1\n\nThen we obtain a composition qL (\u03b1, \u03b2) by reading off the labels along the path L in order.\nIn the example above,\nqL (\u03b1, \u03b2) = (a1 , b1 , a2 + b2 , a3 , a4 + b3 , b4 , a5 ) .\nThe composition qL (\u03b1, \u03b2) is the quasi-shuffle of \u03b1 and \u03b2 corresponding to L. If L does not\ninvolve diagonal steps, then qL (\u03b1, \u03b2) is an ordinary shuffle.\nThe product of two monomial quasi-symmetric functions is given by\nX\n(9)\nM\u03b1 * M\u03b2 =\nMqL (\u03b1,\u03b2) .\nL\u2208L(p,q)\n\nFor our first application we make use of the fact that \u03b6\u2212 is a character.\n\n\f10\n\nM. AGUIAR AND S. HSIAO\n\nCorollary 4.1. Let n, m be non-negative integers not both equal to 0. Then\nmin(n,m)\n\n(10)\n\nX\nd=0\n\n\u0013\n\u0013\u0012\n\u0012\n2\u230a(n + m \u2212 2d)/2\u230b\nn+m\u2212d\nn + m \u2212 2d\n\u230a(n + m \u2212 2d)/2\u230b\n4\u230a(n+m\u22122d)/2\u230b n + m \u2212 d n \u2212 d, m \u2212 d, d\n\u0013\n\u0013\u0012\n\u0012\n1\n2\u230an/2\u230b 2\u230am/2\u230b\n= \u230an/2\u230b+\u230am/2\u230b\n.\n\u230am/2\u230b\n\u230an/2\u230b\n4\n(\u22121)d\n\nProof. Let \u03b1 = (1, 1, . . . , 1) \u000f n and \u03b2 = (1, 1, . . . , 1) \u000f m. The set of lattice paths L(n, m)\nsplits as\nL(n, m) = LH (n, m) \u2294 LV (n, m) \u2294 LD (n, m)\naccording to whether the last step of the path is horizontal, vertical, or diagonal.\nChoose L \u2208 L(n, m), let d be the number of diagonal steps of L, and \u03b3 := qL (\u03b1, \u03b2).\nIf L \u2208 LD (n, m), the last part of \u03b3 is 2, so \u03b6\u2212 (M\u03b3 ) = 0 by (7). On the other hand, if\nL \u2208 LH (n, m) \u2294 LV (n, m) the last part of \u03b3 is 1, ke (\u03b3) = d (d parts are equal to 2), and\nko (\u03b3) = n + m \u2212 2d (all other parts are equal to 1). Hence, by (7),\n\u03b6\u2212 (M\u03b3 ) =\n\n(\u22121)d\n\nC(0, \u230a(n + m \u2212 2d)/2\u230b)\n22\u230a(n+m\u22122d)/2\u230b\nNow, the number of paths in LH (n, m) \u2294 LV (n, m) with d diagonal steps is\n\u0013\n\u0013\n\u0013 \u0012\n\u0012\n\u0012\nn + m \u2212 2d\nn+m\u22121\u2212d\nn+m\u2212d\nn\u22121+m\u2212d\n=\n.\n+\nn \u2212 d, m \u2212 1 \u2212 d, d\nn \u2212 1 \u2212 d, m \u2212 d, d\nn + m \u2212 d n \u2212 d, m \u2212 d, d\nTherefore, by (9),\nmin(n,m)\n\n\u03b6\u2212 (M\u03b1 * M\u03b2 ) =\n\nX\nd=0\n\n(\u22121)d\n\nn + m \u2212 2d\n2\u230a(n+m\u22122d)/2\u230b\n2\nn+m\u2212d\n\n\u0012\n\n\u0013\nn+m\u2212d\nC(0, \u230a(n + m \u2212 2d)/2\u230b) .\nn \u2212 d, m \u2212 d, d\n\nOn the other hand,\n\n\u03b6\u2212 (M\u03b1 ) * \u03b6\u2212 (M\u03b2 ) =\n\n1\n\nC(0, \u230an/2\u230b) *\n2\u230an/2\u230b\n\n1\n\nC(0, \u230am/2\u230b) .\n2\n22\u230am/2\u230b\nSince \u03b6\u2212 is a character, the last two quantities are equal. Equating them results in (10). \u0003\nThe special case of (10) when n \u2265 m = 1 is\n\u0013\n\u0013\n\u0013\n\u0012\n\u0012\n\u0012\nn+1\nn\u22121\n1\n2\u230a(n + 1)/2\u230b\n2\u230a(n \u2212 1)/2\u230b\n2\u230an/2\u230b\n\u2212 \u230a(n\u22121)/2\u230b\n= \u230an/2\u230b\n4\u230a(n+1)/2\u230b \u230a(n + 1)/2\u230b\n4\n\u230a(n \u2212 1)/2\u230b\n4\n\u230an/2\u230b\nwhich may be easily verified. On the other hand, when n = m \u2265 1, (10) becomes\n\u00132\n\u0013\u0012\n\u00132\n\u0012\n\u0012\nn\u22121\nX\n1\n2\u230an/2\u230b\n(\u22121)d 2n \u2212 d \u2212 1 2(n \u2212 d)\n= 2\u230an/2\u230b\n.\nn\u2212d\nd\n\u230an/2\u230b\n4n\u2212d\n4\nd=0\nWe now make use of the fact that \u03b6+ is a character to derive an identity involving Catalan\nnumbers.\n\n\fCANONICAL CHARACTERS\n\n11\n\nCorollary 4.2. Let n, m be positive integers not both equal to 1 and such that n \u2261 m mod 2.\nThen\n(11)\nmin(n,m)\n\nX\nd=0\n\n(\u22121)\n\n\u0013\n\u0012\n\u0001\n+ m \u2212 2d) (n + m \u2212 2d \u2212 1)\nn+m\u2212d\nC (n+m)/2\u2212d\u22121\n(n + m \u2212 d) (n + m \u2212 d \u2212 1) n \u2212 d, m \u2212 d, d\n(\nC(n/2 \u2212 1)C(m/2 \u2212 1) if n and m are even,\n=\n0\nif n and m are odd.\n\nd+1 2d\u22121 (n\n\n2\n\nProof. Let \u03b1 = (1, 1, . . . , 1) \u000f n and \u03b2 = (1, 1, . . . , 1) \u000f m. As in the proof of Corollary 4.1,\nwe analyze which lattice paths L \u2208 L(n, m) contribute to \u03b6+ (M\u03b1 * M\u03b2 ). Note that since\n(n, m) 6= (1, 1), the second alternative in (8) never occurs. A path which starts or ends with\na diagonal step does not contribute, by the third alternative in (8). For all remaining paths\nL, if d is the number of diagonal steps, then\n\u0001\n(\u22121)d+1\n\u03b6+ (MqL (\u03b1,\u03b2) ) = n+m\u22122d\u22121 C (n + m \u2212 2d)/2 \u2212 1\n2\nby the first alternative in (8). These paths start and end with a horizontal or vertical step,\nso their number is\n\u0013\n\u0013 \u0012\n\u0013 \u0012\n\u0012\nn+m\u22122\u2212d\nn\u22122+m\u2212d\nn\u22121+m\u22121\u2212d\n+\n+\n2\nn \u2212 d, m \u2212 2 \u2212 d, d\nn \u2212 2 \u2212 d, m \u2212 d, d\nn \u2212 1 \u2212 d, m \u2212 1 \u2212 d, d\n\u0013\n\u0012\n(n + m \u2212 2d) (n + m \u2212 2d \u2212 1)\nn+m\u2212d\n=\n.\n(n + m \u2212 d) (n + m \u2212 d \u2212 1) n \u2212 d, m \u2212 d, d\nApplying \u03b6+ to both sides of (9) leads to (11).\n\n\u0003\n\nSuppose m = 1, n = 2k + 1, k \u2265 1. In this case (11) boils down to the simple identity\n2(2k \u2212 1)\nC(k \u2212 1) .\nk+1\nIf n = m, the last term in the sum (11) is 0, because of the factor n + m \u2212 2d (so there is no\nneed to evaluate the Catalan number in this case). The formula becomes\n(\n\u0013\n\u0012\nn\u22121\nX\n2n\n\u2212\nd\n\u2212\n2\nC(n/2 \u2212 1)2 if n is even,\nC(n \u2212 d \u2212 1)2 =\n(\u22121)d+1 4d (2n \u2212 2d \u2212 1)\nd\n0\nif n is odd, n > 1.\nd=0\nC(k) =\n\nIn the proof of Theorem 3.2 we established that formula (7) defines an odd character by\nshowing that \u03b6\u2212 \u03b6\u0304\u2212 = \u01eb. Rewriting this property in terms of the antipode S of QSym leads\nto new combinatorial identities that we analyze next. First, recall that S is given by\nX\n(12)\nS(M\u03b2 ) = (\u22121)k(\u03b2)\nM\u03b1 ,\n\u03b1\u2264\u03b2\u0303\n\nwhere \u03b2\u0303 = (bk , . . . , b2 , b1 ) is the reversal of \u03b2 = (b1 , b2 , . . . , bk ) and \u03b1 \u2264 \u03b3 indicates that \u03b3 is\na refinement of \u03b1 [7, Proposition 3.4]; [15, Corollaire 4.20].\n\n\f12\n\nM. AGUIAR AND S. HSIAO\n\nCorollary 4.3. For any composition \u03b2 = (b1 , . . . , bk ),\n\u0013\n\u0012\n\uf8f1\n\u0013\n\u0012\n1\n2\u230ak\n(\u03b2)/2\u230b\no\n\uf8f2\nX (\u22121)ke (\u03b1) 2\u230ako (\u03b1)/2\u230b\n= 4\u230ako (\u03b2)/2\u230b \u230ako (\u03b2)/2\u230b\n(13)\n\u230ako (\u03b1)/2\u230b\n\uf8f3\n\u230ak\n4\no (\u03b1)/2\u230b\n\u03b1\u2264\u03b2\n0\na1 odd\n\nif bk is odd,\nif bk is even;\n\nthe sum being over those compositions \u03b1 = (a1 , . . . , ah ) whose first part is odd and which are\nrefined by \u03b2.\nProof. Since \u03b6\u2212 is an odd character, we have\n\u03b6\u2212 \u25e6 S = (\u03b6\u2212 )\u22121 = \u03b6\u0304\u2212 .\nTherefore, for any composition \u03b2 of n we have, by (12),\nX\n(\u22121)k(\u03b2)\n\u03b6\u2212 (M\u03b1 ) = (\u22121)n \u03b6\u2212 (M\u03b2 ) .\n\u03b1\u2264\u03b2\u0303\n\nHence, by (7),\n(\u22121)k(\u03b2)\n\n\uf8f1\n\uf8f2 (\u22121)n+ke (\u03b2)\nX (\u22121)ke (\u03b1)\nC(0, \u230ako (\u03b2)/2\u230b)\n2\u230ako (\u03b2)/2\u230b\nC(0, \u230ako(\u03b1)/2\u230b) =\n2\n2\u230ak\n(\u03b1)/2\u230b\no\n\uf8f30\n2\n\n\u03b1\u2264\u03b2\u0303\nah odd\n\nif bk is odd,\nif bk is even.\n\nBy (6), k(\u03b2) = ko (\u03b2) + ke (\u03b2) \u2261 n + ke (\u03b2). Replacing \u03b1 for \u03b1\u0303 in the left-hand side gives (13).\n\u0003\nSuppose that ke (\u03b2) \u2261 0 mod 2 and b1 \u2261 bk mod 2. In this case, the summand in (14)\ncorresponding to \u03b1 = \u03b2 cancels with the right-hand side. We deduce that for any such\ncomposition \u03b2,\nX (\u22121)ke (\u03b1) \u00122\u230ako (\u03b1)/2\u230b\u0013\n(14)\n= 0.\n\u230ako (\u03b1)/2\u230b\n\u230ak\n4\no (\u03b1)/2\u230b\n\u03b1<\u03b2\na1 odd\n\nSuppose now that \u03b2 = (1, 1, . . . , 1). Consider the class of compositions of n in which\nr parts are odd (including the first part) and s parts are even. Such a composition \u03b1 is\n, plus the choice of r \u2212 1 parts\ndetermined by the choice of a composition (c1 , . . . , cr+s ) of n+r\n2\nout of the parts c1 , . . . , cr+s\u22121. In fact, once these choices are made, we obtain \u03b1 by replacing\nc1 and the r \u2212 1 chosen ci 's by 2ci \u2212 1, and replacing the s remaining ci 's by 2ci . Any such\n\u03b1 arises in this way uniquely. Therefore, the number of such compositions is\n\u0012 n+r\n\u0013\n\u0013\u0012\nr+s\u22121\n\u22121\n2\n.\nr\u22121\nr+s\u22121\nCombining this with (14) we deduce\nX (\u22121)s \u0012 n+r \u2212 1 \u0013\u0012r + s \u2212 1\u0013\u00122\u230ar/2\u230b\u0013\n2\n= 0;\n\u230ar/2\u230b\nr\u22121\n4\u230ar/2\u230b r + s \u2212 1\n(r,s)\u2208Tn\n\n\fCANONICAL CHARACTERS\n\n13\n\nthe sum being over the set\nTn := {(r, s) | r \u2261 n mod 2, r + 2s \u2264 n, 0 < r < n, 0 \u2264 s} .\nWe remark that this identity is less interesting than it may seem, since for each r < n,\n\u0013\n\u0013\u0012\n\u0012 n+r\nX\nr\n+\ns\n\u2212\n1\n\u2212\n1\ns\n2\n= 0 by a Vandermonde convolution.\n(\u22121)\nr\u22121\nr\n+\ns\u22121\ns=0\nn\u2212r\n2\n\n5. The canonical characters of QSym on the fundamental basis\nFor a composition \u03b1 = (a1 , . . . , ak ) of a non-negative integer n, define\n(15)\n(16)\n\np\u2212 (\u03b1) = #{i 6= k : ai > 1},\n\u001a\n1 + #{i 6= 1, k : ai > 1} if k > 1,\np+ (\u03b1) =\n0\nif k \u2264 1.\n\nA combinatorial interpretation for these two statistics in terms of peaks of permutations is\ngiven in Section 7.\nA composition \u03b1 = (a1 , . . . , ak ) may be conveniently represented by a ribbon diagram: a\nsequence of rows of squares, each row consisting of ai squares, and with the first square in\nrow i + 1 directly below the last square in row i. For instance the diagram\n\nrepresents the composition (1, 3, 1, 2, 2). Note that p\u2212 (\u03b1) is the number of upper corners in\nthe ribbon diagram of \u03b1. To get a similar interpretation for p+ (\u03b1) one may augment the\nribbon diagram of \u03b1 by drawing an extra square to the left of the first row. Then p+ (\u03b1) is\nthe number of upper corners in the augmented diagram. For instance, p\u2212 (1, 3, 1, 2, 2) = 2\nand p+ (1, 3, 1, 2, 2) = 3, as illustrated below.\n\u2745\n\n\u2745\n\u2745\n\n\u2745\n\u2745\n\nThe fundamental and monomial bases of QSym are related by\nX\n(17)\nM\u03b1 =\n(\u22121)k(\u03b2)\u2212k(\u03b1) F\u03b2 ,\n\u03b2\u2265\u03b1\n\nwhere, as before, for compositions \u03b1 and \u03b2 of n, \u03b2 \u2265 \u03b1 indicates that \u03b2 is refinement of \u03b1.\n\n\f14\n\nM. AGUIAR AND S. HSIAO\n\nTheorem 5.1. Let \u03b1 be a composition of a non-negative integer n. Then\n(18)\n(19)\n\n(\u22121)p\u2212 (\u03b1)\nC (p\u2212 (\u03b1), \u230an/2\u230b \u2212 p\u2212 (\u03b1)) ;\n2\u230an/2\u230b\n\uf8f12\n\uf8f2 (\u22121)p+ (\u03b1)\nC (p+ (\u03b1), n/2 \u2212 p+ (\u03b1))\nn\n\u03b6+ (F\u03b1 ) =\n\uf8f3 0 2\n\n\u03b6\u2212 (F\u03b1 ) =\n\nif n is even,\nif n is odd.\n\nRemark 5.2. Up to a sign and a factor of \u03c0, the above are values of Legendre's beta function\nat half-integers. Indeed, as already remarked by Catalan [5, Section CV],\nZ\nZ\n1\n1 \u0010\n1\n1 \u0011 1 \u03c0 2p\n1 1 (1 \u2212 u)p uq\n2q\np\ndu .\n=\n(20) 2(p+q) C(p, q) = B p + , q +\nsin \u03b8 cos \u03b8 d\u03b8 =\n2\n\u03c0\n2\n2\n\u03c0 0\n\u03c0 0\n(1 \u2212 u)u\n\nRemark 5.3. Catalan shows [5, Section CCXIV], [6, pp. 110-113] that C(p, q) is an integer,\nand that the highest power of 2 that divides it equals the number of 1's in the binary\ndecomposition of p + q. Equivalently, the above fraction may be reduced as follows\nX p+q\nN\n1\nC(p,\nq)\n=\nwith\nN\nodd\nand\nk\n=\n\u230a i \u230b.\n(21)\n22(p+q)\n2k\n2\ni\u22650\nThe proof of Theorem 5.1 is given below. We need two more statistics. For \u03b1 as above,\nlet\nu(\u03b1) = #{i 6= 1 : ai > 1} and v(\u03b1) = #{i : ai > 1} .\nLemma 5.4. Let m, j be non-negative integers. Then\n\u0013\n\u0012\nX\nk(\u03b3)\nm+j \u230am/2\u230b\n;\n(a)\n(\u22121)\n= (\u22121)\nj\n\u03b3\u000fm\nv(\u03b3)=j\n\uf8f1\n\uf8f2 0\nX\n\u0013 if m is even,\n\u0012\n\u230am/2\u230b\n(b)\n(\u22121)k(\u03b3) =\nif m is odd.\n\uf8f3 (\u22121)m+j\n\u03b3\u000fm\nj\nu(\u03b3)=j\nWe thank Ira Gessel for supplying this proof.\n\nProof. The generating function for the left-hand side of (a) multiplied by y j xm is just the\nsum of weights of all compositions, where a part a > 1 is weighted by \u2212yxa and a part equal\nto 1 is weighted by \u2212x. This sum is\n1\n1\n=\n1 \u2212 (\u2212x \u2212 yx2 \u2212 yx3 + * * * )\n1+x+\n\nyx2\n1\u2212x\n\n=\n\n1\u2212x\n.\n1 \u2212 (1 \u2212 y)x2\n\nBy expanding in powers of x and y we obtain the identity (a). For (b), the first part a\nis weighted \u2212xa no matter what a is, so the generating function is \u2212x/(1 \u2212 x) times the\ngenerating function for (a), which is \u2212x/(1 \u2212 (1 \u2212 y)x2 ), which is the odd powers of x in\n(a).\n\u0003\n\n\fCANONICAL CHARACTERS\n\n15\n\nLemma 5.5. Let i, j, m be non-negative integers. Then\nm \u0012 \u0013\nX\nm\n2m\nC(i + b, m + j \u2212 b).\n2 C(i, j) =\nb\nb=0\n\nProof. In view of (20), the proposed equality is equivalent to\nZ \u03c0\nm \u0012 \u0013Z \u03c0\nX\nm\n2i\n2j\nsin2(i+b) \u03b8 cos2(m+j\u2212b) \u03b8 d\u03b8 .\nsin \u03b8 cos \u03b8 d\u03b8 =\nb\n0\n0\nb=0\nThis holds since\n\nm \u0012 \u0013\nX\nm\nb=0\n\nb\n\nsin2b \u03b8 cos2(m\u2212b) \u03b8 = (sin2 \u03b8 + cos2 \u03b8)m = 1 .\n\u0003\n\nTo facilitate the proof of Theorem 5.1, we define\nX\n(\u22121)k(\u03b2)+p\u2212 (\u03b2)+1 C (p\u2212 (\u03b2), \u230an/2\u230b \u2212 p\u2212 (\u03b2))\nH\u2212 (\u03b1) =\n\nfor \u03b1 \u000f n;\n\n\u03b2\u2265\u03b1\n\nH+ (\u03b1) =\n\nX\n\n(\u22121)k(\u03b2)+p+ (\u03b2)+1 C (p+ (\u03b2), n/2 \u2212 p+ (\u03b2)) for \u03b1 \u000f n, n even.\n\n\u03b2\u2265\u03b1\n\nLemma 5.6. Suppose that \u03b1 = (a1 , . . . , ak ) \u000f n. Then\n\u001a\n(\u22121)n\u22121 2n\u2212ko (\u03b1) C(0, \u230ako (\u03b1)/2\u230b) if ak is odd,\nH\u2212 (\u03b1) =\n0\nif ak is even.\nProof. We will consider the cases \u03b1 = (n) and \u03b1 6= (n) separately.\nCase 1. Suppose that \u03b1 = (n). We need to show that H\u2212 ((n)) = 2n\u22121 if n is odd and\nH\u2212 ((n)) = 0 if n is even. For a composition \u03b3 and a positive integer i, let \u03b3i denote the\nconcatenation of \u03b3 with (i). Using the fact that p\u2212 (\u03b3i) = v(\u03b3), we have\nX\nH\u2212 ((n)) =\n(\u22121)k(\u03b2)+p\u2212 (\u03b2)+1 C(p\u2212 (\u03b2), \u230an/2\u230b \u2212 p\u2212 (\u03b2))\n\u03b2\u000fn\n\n= C(0, \u230an/2\u230b) +\n\nn\u22121 X\nX\n\n(\u22121)k(\u03b3i)+p+ (\u03b3i)+1 C(p\u2212 (\u03b3i), \u230an/2\u230b \u2212 p\u2212 (\u03b3i))\n\ni=1 \u03b3\u000fn\u2212i\n\n= C(0, \u230an/2\u230b) +\n\nn\u22121\nX\n\nX\n\n(\u22121)k(\u03b3)+v(\u03b3) C(v(\u03b3), \u230an/2\u230b \u2212 v(\u03b3))\n\ni=1 \u03b3\u000fn\u2212i\n\n= C(0, \u230an/2\u230b) +\n\nn\u22121 \u230a(n\u2212i)/2\u230b\nX X\nX\ni=1\n\n= C(0, \u230an/2\u230b) +\n\nb=0\n\nn\u22121 \u230a(n\u2212i)/2\u230b\nX\nX\ni=1\n\nb=0\n\n(\u22121)k(\u03b3)+b C(b, \u230an/2\u230b \u2212 b)\n\n\u03b3\u000fn\u2212i\nv(\u03b3)=b\n\n(\u22121)b C(b, \u230an/2\u230b \u2212 b)\n\nX\n\n\u03b3\u000fn\u2212i\nv(\u03b3)=b\n\n(\u22121)k(\u03b3) .\n\n\f16\n\nM. AGUIAR AND S. HSIAO\n\nMake the substitution m = n \u2212 i and apply Lemma 5.4(a) to get\n\u0013\n\u0012\nn\u22121 \u230am/2\u230b\nX\nX\nm \u230am/2\u230b\nC(b, \u230an/2\u230b \u2212 b)\nH\u2212 ((n)) = C(0, \u230an/2\u230b) +\n(\u22121)\nb\ni=1 b=0\n\u0013\n\u0012\n\u230an\u22121/2\u230b\nn\u22121\nX\nX\nm \u230am/2\u230b\n= C(0, \u230an/2\u230b) +\n.\nC(b, \u230an/2\u230b \u2212 b)\n(\u22121)\nb\nm=1\nb=0\n\u0001\n\u0001\n\u0001\nPn\u22121\n\u230am/2\u230b\nm+1 \u230a(m+1)/2\u230b\nLet Sb = m=1 (\u22121)m b . Note that when m is even, (\u22121)m \u230am/2\u230b\n+(\u22121)\n=\nb\nb\n0. So all but at most one term in the sum Sb will cancel.\nIf n is even, then Sb = 0 when b \u2265 1 and S0 =\u0001 \u22121; hence H\u2212 ((n)) = C(0, \u230an/2\u230b) +\n[\u2212C(0, \u230an/2\u230b)] = 0. If n is odd, then Sb = \u230an/2\u230b\nwhen b \u2265 1 and S0 = 0; hence by\nb\nLemma 5.5 (with i = j = 0),\n\u0013\n\u0012\n\u230an/2\u230b\nX\n\u230an/2\u230b\nH\u2212 ((n)) = C(0, \u230an/2\u230b) +\nC(b, \u230an/2\u230b \u2212 b)\nb\nb=1\n\u230an/2\u230b \u0012\nX \u230an/2\u230b\u0013\nC(b, \u230an/2\u230b \u2212 b)\n=\nb\nb=0\n= 22\u230an/2\u230b .\n\nMoreover, we have 2\u230an/2\u230b = n \u2212 1 since n is odd.\nCase 2. Suppose that \u03b1 6= (n). If \u03b2 and \u03b3 are non-empty compositions and \u03b2\u03b3 denotes\ntheir concatenation, then p\u2212 (\u03b2\u03b3) = v(\u03b2) + u(\u03b3\u0303), where \u03b3\u0303 is the reversal of \u03b3. Using this\nobservation we may write\nX\n(\u22121)k(\u03b2\u03b3)+p\u2212 (\u03b2\u03b3) C(p\u2212 (\u03b2\u03b3), \u230an/2\u230b \u2212 p\u2212 (\u03b2\u03b3))\nH\u2212 (\u03b1) =\n\u03b2\u2265\u03b1k\u22121\n\u03b3\u000fak\n\n=\n\nX\n\n(\u22121)k(\u03b2)+v(\u03b2)\n\n(22)\n\n=\n\n\u03b2\u2265\u03b1k\u22121\n\n(\u22121)k(\u03b3)+u(\u03b3\u0303) C(v(\u03b2) + u(\u03b3\u0303), \u230an/2\u230b \u2212 v(\u03b2) \u2212 u(\u03b3\u0303))\n\n\u03b3\u000fak\n\n\u03b2\u2265\u03b1k\u22121\n\nX\n\nX\n\n\u230aak /2\u230b\n\n(\u22121)\n\nk(\u03b2)+v(\u03b2)\n\nX\n\n(\u22121)b C(v(\u03b2) + b, \u230an/2\u230b \u2212 v(\u03b2) \u2212 b)\n\nb=0\n\nX\n\n(\u22121)k(\u03b3) .\n\n\u03b3\u000fak\nu(\u03b3\u0303)=b\n\nBy Lemma 5.4(b), the second sum in (22) equals\n\uf8f1\n\u230aak /2\u230b \u0012\nX \u230aak /2\u230b\u0013\n\uf8f4\n\uf8f2\nak\nC (v(\u03b2) + b, \u230an/2\u230b \u2212 v(\u03b2) \u2212 b) if ak is odd,\n(\u22121)\nb\n\uf8f4\nb=0\n\uf8f3\n0\nif ak is even\n\u001a\n(\u22121)ak 22\u230aak /2\u230b C(v(\u03b2), \u230an/2\u230b \u2212 v(\u03b2) \u2212 \u230aak /2\u230b) if ak is odd,\n(23)\n=\n0\nif ak is even.\nThe last step uses Lemma 5.5. It follows that H\u2212 (\u03b1) = 0 if ak is even.\n\n\fCANONICAL CHARACTERS\n\n17\n\nAssume from now on that ak is odd. For any composition \u03b2 = (b1 , . . . , bl ), let \u230a\u03b2/2\u230b =\n\u230ab1 /2\u230b + * * * + \u230abl /2\u230b. We will show that for 1 \u2264 i < k,\nX\ni\ni\n(\u22121)k(\u03b2)+v(\u03b2) C(v(\u03b2), \u230an/2\u230b \u2212 \u230a\u03b1i /2\u230b \u2212 v(\u03b2)).\n(24)\nH\u2212 (\u03b1) = (\u22121)|\u03b1 | 22\u230a\u03b1 /2\u230b\n\u03b2\u2265\u03b1i\n\nThis holds for i = k \u2212 1, as can be seen by substituting the first alternative of (23) into the\nsecond sum in (22). Suppose by induction that (24) is true for some i such that k > i > 1.\nSince k(\u03b2\u03b3) = k(\u03b2) + k(\u03b3) and v(\u03b2\u03b3) = v(\u03b2) + v(\u03b3), we may rewrite (24) as\nX\ni\ni\n(\u22121)k(\u03b4\u03b3)+v(\u03b4\u03b3) C(v(\u03b4\u03b3), \u230an/2\u230b \u2212 \u230a\u03b1i /2\u230b \u2212 v(\u03b4\u03b3))\nH\u2212 (\u03b1) = (\u22121)|\u03b1 | 22\u230a\u03b1 /2\u230b\n\u03b4\u2265\u03b1i\u22121\n\u03b3\u000fai\n\ni\n\nX\n\ni\n\n= (\u22121)|\u03b1 | 22\u230a\u03b1 /2\u230b\n\n(\u22121)k(\u03b4)+v(\u03b4)\n\n\u03b4\u2265\u03b1i\u22121\n\nX\n\n(\u22121)k(\u03b3)+v(\u03b3)\n\n\u03b3\u000fai\ni\n\nC(v(\u03b4) + v(\u03b3), \u230an/2\u230b \u2212 \u230a\u03b1 /2\u230b \u2212 v(\u03b4) \u2212 v(\u03b3))\n= (\u22121)\n\n|\u03b1i |\n\n2\n\n2\u230a\u03b1i /2\u230b\n\nX\n\n\u230aai /2\u230b\n\n(\u22121)\n\nk(\u03b4)+v(\u03b4)\n\n\u03b4\u2265\u03b1i\u22121\n\nX\n\n(\u22121)b\n\nb=0\n\ni\n\nC(v(\u03b4) + b, \u230an/2\u230b \u2212 \u230a\u03b1 /2\u230b \u2212 v(\u03b4) \u2212 b)\n\nX\n\n(\u22121)k(\u03b3)\n\n\u03b3\u000fai\nv(\u03b3)=b\n\n(25)\n\ni\u22121 |\n\n= (\u22121)|\u03b1\n\ni\n\n22\u230a\u03b1 /2\u230b\n\nX\n\n(\u22121)k(\u03b4)+v(\u03b4)\n\n\u03b4\u2265\u03b1i\u22121\n\u230aai /2\u230b\n\nX\nb=0\n\n\u0013\n\u230aai /2\u230b\n.\nC(v(\u03b4) + b, n/2 \u2212 \u230a\u03b1 /2\u230b \u2212 v(\u03b4) \u2212 b)\nb\ni\n\n\u0012\n\nThe last step uses Lemma 5.4(a). Now apply Lemma 5.5, with i = v(\u03b4) and j = \u230an/2\u230b \u2212\n\u230a\u03b1i\u22121 /2\u230b \u2212 v(\u03b4), to simplify the second sum in (25). The resulting formula is\nX\ni\u22121\ni\u22121\nH\u2212 (\u03b1) = (\u22121)|\u03b1 | 22\u230a\u03b1 /2\u230b\n(\u22121)k(\u03b4)+v(\u03b4) C(v(\u03b4), \u230an/2\u230b \u2212 \u230a\u03b1i\u22121 /2\u230b \u2212 v(\u03b4)).\n\u03b4\u2265\u03b1i\u22121\n\nThis completes the proof of (24).\nWhen i = 1, (24) becomes\n1\n\n1 /2\u230b\n\nH\u2212 (\u03b1) = (\u22121)|\u03b1 | 22\u230a\u03b1\n\nX\n\n(\u22121)k(\u03b2)+v(\u03b2) C(v(\u03b2) + 1, \u230an/2\u230b \u2212 \u230a\u03b11 /2\u230b \u2212 v(\u03b2))\n\n\u03b2\u000fa1\n\u230aa1 /2\u230b\n\n= (\u22121)\n\n|\u03b11 |\n\n2\n\n2\u230a\u03b11 /2\u230b\n\nX\n\n(\u22121)b+1 C(b, \u230an/2\u230b \u2212 \u230a\u03b11 /2\u230b \u2212 b)\n\nb=0\n\n= (\u22121)\n\n|\u03b11 |\n\n2\n\n2\u230a\u03b11 /2\u230b\n\n\u03b2\u000fa1\nv(\u03b2)=b\n\n\u230aa1 /2\u230b \u0012\n\nX\nb=0\n\nX\n\n\u0013\n\u230aa1 /2\u230b\nC(b, \u230an/2\u230b \u2212 \u230a\u03b11 /2\u230b \u2212 b),\nb\n\n(\u22121)k(\u03b2)\n\n\f18\n\nM. AGUIAR AND S. HSIAO\n\nby Lemma 5.4(a). Note that |\u03b11 | = n \u2212 |a1 | \u2261 n \u2212 1 (mod 2) and \u230aa1 /2\u230b + \u230a\u03b11 /2\u230b =\n(n\u2212ko (\u03b1))/2. Thus, by Lemma 5.5, with i = 1 and j = \u230an/2\u230b\u2212\u230aa1 /2\u230b\u2212\u230a\u03b11 /2\u230b = \u230ako (\u03b1)/2\u230b,\nthe preceding formula for H\u2212 (\u03b1) simplifies to\nH\u2212 (\u03b1) = (\u22121)n\u22121 2n\u2212ko (\u03b1) C(0, \u230ako(\u03b1)/2\u230b).\n\u0003\nLemma 5.7. Suppose that n is even and \u03b1 = (a1 , . . . , ak ) \u000f n. Then\n\uf8f1\n\uf8f2 2n\u2212ko (\u03b1) C(1, ko(\u03b1)/2 \u2212 1) if a1 and ak are odd,\nH+ (\u03b1) =\n2n\nif \u03b1 = (n),\n\uf8f3\n0\nif a1 or ak is even and \u03b1 6= (n).\n\nProof. We will consider the cases \u03b1 = (n) and \u03b1 6= (n) separately. In this proof, the notation\n\u03b3i, \u03b3\u0303, and \u230a\u03b2/2\u230b will have the same meaning as in the proof of Lemma 5.6.\nCase 1. Suppose that \u03b1 = (n). Using the fact that p+ (\u03b3i) = 1 + u(\u03b3), a calculation similar\nto the first part of the proof of Case 1 in Lemma 5.6 yields\nH+ ((n)) = C(0, n/2) \u2212\n\nn\u22121 \u230a(n\u2212i)/2\u230b\nX\nX\ni=1\n\n(\u22121)b C(b + 1, n/2 \u2212 b \u2212 1)\n\nb=0\n\nX\n\n\u03b3\u000fn\u2212i\nu(\u03b3)=b\n\nMake the substitution j = \u230a(n \u2212 i)/2\u230b and apply Lemma 5.4(b) to get\nn/2\u22121 j \u0012 \u0013\nX X j\nC(b + 1, n/2 \u2212 b \u2212 1)\nH+ ((n)) = C(0, n/2) +\nb\nj=0 b=0\nn/2\u22121\n\n= C(0, n/2) +\n\nX\n\nC(b + 1, n/2 \u2212 b \u2212 1)\n\nb=0\n\nn/2\u22121\n\n= C(0, n/2) +\n\nX\nb=0\n\nPn/2\u22121\n\n(\u22121)k(\u03b3) .\n\nn/2\u22121 \u0012\n\nX\nj=b\n\nj\nb\n\n\u0013\n\n\u0013\nn/2\n.\nC(b + 1, n/2 \u2212 b \u2212 1)\nb+1\n\u0001\n\u0001\nj\nn/2\n=\n. We have shown that H+ ((n)) =\nb\nb+1\n\u0012\n\nThe last step uses the basic identity j=b\nPn/2 n/2\u0001\nC(b, n/2 \u2212 b), which equals 2n by Lemma 5.5.\nb=0\nb\n\nCase 2. Suppose that \u03b1 6= (n). Using the fact that p+ (\u03b2\u03b3) = 1 + u(\u03b2) + u(\u03b3\u0303) for non-empty\ncompositions \u03b2 and \u03b3, by calculations similar to (22) and (23), we have\nX\n(\u22121)k(\u03b2)+u(\u03b2)+1 C(u(\u03b2) + 1, n/2 \u2212 \u230aak /2\u230b \u2212 u(\u03b2) \u2212 1)\n(26) H+ (\u03b1) = (\u22121)ak 22\u230aak /2\u230b\n\u03b2\u2265\u03b1k\u22121\n\nif ak is odd, and H+ (\u03b1) = 0 if ak is even.\nAssume from now on that ak is odd. Note that u(\u03b4\u03b3) = u(\u03b4) + v(\u03b3) for non-empty\ncompositions, \u03b4 and \u03b3. Using (26) as the base case, an inductive calculation similar to the\nproof of (24) shows that for 1 \u2264 i < k,\nX\ni\ni\n(\u22121)k(\u03b2)+u(\u03b2)+1 C(u(\u03b2) + 1, n/2 \u2212 \u230a\u03b1i /2\u230b \u2212 u(\u03b2) \u2212 1).\n(27) H+ (\u03b1) = (\u22121)|\u03b1 | 22\u230a\u03b1 /2\u230b\n\u03b2\u2265\u03b1i\n\n\fCANONICAL CHARACTERS\n\n19\n\nWhen i = 1, (27) becomes\n1\n\n1 /2\u230b\n\nH+ (\u03b1) = (\u22121)|\u03b1 | 22\u230a\u03b1\n\nX\n\n(\u22121)k(\u03b2)+u(\u03b2)+1 C(u(\u03b2) + 1, n/2 \u2212 \u230a\u03b11 /2\u230b \u2212 u(\u03b2) \u2212 1)\n\n\u03b2\u000fa1\n\u230aa1 /2\u230b\n1\n\n1 /2\u230b\n\n= (\u22121)|\u03b1 | 22\u230a\u03b1\n\nX\n\n(\u22121)b+1 C(b + 1, n/2 \u2212 \u230a\u03b11 /2\u230b \u2212 b \u2212 1)\n\nb=0\n\n=\n\n\uf8f1\n\uf8f4\n\uf8f2\n\uf8f4\n\uf8f3\n\n(\u22121)\n\n|\u03b11 |\n\n2\n\n\u230a\u03b11 /2\u230b\n\n(\u22121)k(\u03b2)\n\n\u03b2\u000fa1\nu(\u03b2)=b\n\n\u230aa1 /2\u230b \u0012\n\nX\nb=0\n\n0\n\nX\n\n\u0013\n\u230aa1 /2\u230b\nC(b + 1, n/2 \u2212 \u230a\u03b11 /2\u230b \u2212 b \u2212 1) if a1 is odd,\nb\nif a1 is even,\n\nby Lemma 5.4(b). Note that |a1 |+|\u03b11| = n \u2261 0 (mod 2) and \u230aa1 /2\u230b+\u230a\u03b11 /2\u230b = (n\u2212ko (\u03b1))/2.\nThus, by Lemma 5.5, with i = 1 and j = n/2 \u2212 \u230aa1 /2\u230b \u2212 \u230a\u03b11 /2\u230b \u2212 1 = ko (\u03b1)/2 \u2212 1, the\npreceding formula simplifies to\nH+ (\u03b1) = 2n\u2212ko (\u03b1) C(1, ko (\u03b1)/2 \u2212 1)\nwhen a1 is odd.\nThe proof is complete.\n\n\u0003\n\nProof of Theorem 5.1. Let \u03c1, \u03c8 : QSym \u2192 k be the linear maps defined by the proposed\nformula for \u03b6+ and \u03b6\u2212 , respectively. In view of (17), to conclude \u03c1 = \u03b6+ and \u03c8 = \u03b6\u2212 , it\nsuffices to show that\nX\n(\u22121)k(\u03b2)\u2212k(\u03b1) \u03c8(F\u03b2 ) = \u03b6\u2212 (M\u03b1 ) for \u03b1 \u000f n;\n(28)\n\u03b2\u2265\u03b1\n\n(29)\n\nX\n(\u22121)k(\u03b2)\u2212k(\u03b1) \u03c1(F\u03b2 ) = \u03b6+ (M\u03b1 )\n\nfor \u03b1 \u000f n, n even.\n\n\u03b2\u2265\u03b1\n\nAccording to (7), we can rewrite (28) as\n(30)\n\n(\u22121)k(\u03b1) X\n(\u22121)k(\u03b2)+p\u2212 (\u03b2) C(p\u2212 (\u03b2), \u230an/2\u230b \u2212 p\u2212 (\u03b2))\n22\u230an/2\u230b \u03b2\u2265\u03b1\n\uf8f1\nke (\u03b1)\n\uf8f4\n\uf8f2 (\u22121)\nC(0, \u230ako (\u03b1)/2\u230b) if ak is odd,\n22\u230ako (\u03b1)/2\u230b\n=\n\uf8f4\n\uf8f3\n0\nif ak is even.\n\nNote that the left-hand side of (30) equals (\u22121)k(\u03b1)+1 H\u2212 (\u03b1)/22\u230an/2\u230b . Furthermore, using the\nfacts k(\u03b1) + ke (\u03b1) \u2261 ko (\u03b1) \u2261 n (mod 2) and \u230an/2\u230b \u2212 \u230ako (\u03b1)/2\u230b = (n \u2212 ko (\u03b1))/2, the first\nalternative in (30) reduces to the equation H\u2212 (\u03b1) = (\u22121)n\u22121 2n\u2212ko (\u03b1) C(0, \u230ako (\u03b1)/2\u230b); the\nsecond alternative is equivalent to H\u2212 (\u03b1) = 0. These formulas for H\u2212 (\u03b1) agree with the\nones from Lemma 5.6. This proves (30) and hence (28).\nBy similar considerations, (29) reduces to the formulas for H+ (\u03b1) given in Lemma 5.7. \u0003\n\n\f20\n\nM. AGUIAR AND S. HSIAO\n\nRemark 5.8. The fact that \u03b6\u2212 is an odd character, which we know from Theorem 3.2, is\nmade transparent by formula (18). Recall that for any composition \u03b1 \u000f n, the antipode of\nQSym is given by [15, Corollaire 4.20]\nS(F\u03b1 ) = (\u22121)n F\u03b1\u2032 ,\n\n(31)\n\nwhere the ribbon diagram of the conjugate composition \u03b1\u2032 is obtained by reflecting the ribbon\ndiagram of \u03b1 across the line y = x. For instance, if \u03b1 = (2, 3, 1, 2, 2) then \u03b1\u2032 = (1, 2, 3, 1, 2, 1),\nas illustrated below:\n\n\u03b1=\n\n\u03b1\u2032 =\n\nIt is clear that the number of upper corners in the ribbon diagrams of \u03b1 and \u03b1\u2032 are the same,\nso p\u2212 (\u03b1) = p\u2212 (\u03b1\u2032), and hence by (18),\n(\u03b6\u2212 )\u22121 (F\u03b1 ) = (\u03b6\u2212 \u25e6 S)(F\u03b1 ) = (\u22121)n \u03b6\u2212 (F\u03b1\u2032 ) = (\u22121)n \u03b6\u2212 (F\u03b1 ) = \u03b6\u0304\u2212 (F\u03b1 ) ,\nwhich shows that \u03b6\u2212 is odd. On the other hand, expressing this condition in the form\n\u03b6\u0304\u2212 \u03b6\u2212 = \u01eb leads to interesting identities involving bivariate Catalan numbers; see Section 6.\nRemark 5.9. Formula (19) reveals an analogous property of the character \u03b6+ , which is not\nobvious from its definition. Recall that if \u03b1 = (a1 , . . . , ak ) then \u03b1\u0303 = (ak , . . . , a1 ) denotes its\nreversal. The ribbon diagram of \u03b1\u0303 is obtained by reflecting the ribbon diagram of \u03b1 across\nthe line y = \u2212x. Consider the linear map T : QSym \u2192 QSym defined by\n(32)\n\nT (F\u03b1 ) = F\u03b1\u0303 .\n\nSince \u03b1 7\u2192 \u03b1\u0303 preserves refinements, the map T is also given by\n(33)\n\nT (M\u03b1 ) = M\u03b1\u0303 .\n\nFrom either formula it follows easily that T is an antimorphism of coalgebras, a morphism\nof algebras, and an involution (properties which are shared by the antipode S of QSym).\nMoreover, we have\n\u03b6+ \u25e6 T = \u03b6+ .\nThis property follows from (19) and the fact that p+ (\u03b1) = p+ (\u03b1\u0303), which is obvious from (16).\nAnother proof of this fact is given in Proposition 8.2.\nRemark 5.10. Let \u03b1 = (a1 , . . . , ak ). As mentioned in the preceding remarks,\np\u2212 (\u03b1\u2032) = p\u2212 (\u03b1) and p+ (\u03b1\u0303) = p+ (\u03b1) .\n\n\fCANONICAL CHARACTERS\n\nWe also have the following formulas:\n\uf8f1\n\uf8f4\n\uf8f2p\u2212 (\u03b1)\n(34)\np\u2212 (\u03b1\u0303) = p\u2212 (\u03b1) \u2212 1\n\uf8f4\n\uf8f3p (\u03b1) + 1\n\u2212\n\uf8f1\n\uf8f4\n\uf8f2p+ (\u03b1)\n\u2032\np+ (\u03b1 ) = p+ (\u03b1) \u2212 1\n(35)\n\uf8f4\n\uf8f3p (\u03b1) + 1\n+\n\n21\n\nif a1 = ak = 1 or a1 , ak 6= 1,\nif a1 =\n6 1 and ak = 1,\nif a1 = 1 and ak 6= 1;\nif exactly one of a1 and ak is 1,\nif both a1 and ak are 1,\nif neither a1 nor ak is 1.\n\nThese formulas follow easily from (15) and (16), but they can also be visualized in terms of\nribbon diagrams. We illustrate the second alternative of (35) below, for \u03b1 = (1, 3, 1, 2, 1).\nRecall that p+ (\u03b1) is the number of upper corners in the augmented ribbon diagram of \u03b1.\n\u2745\n\n\u2745\n\n\u2745\n\n\u2745\n\n\u2745\n\np+ (\u03b1\u2032 ) = 2\n\np+ (\u03b1) = 3\n\nThe statistics p\u2212 (\u03b1\u0303) and p+ (\u03b1\u2032 ) enter in some of the formulas in Section 8.\n6. Application: Identities for bivariate Catalan numbers\nThe first applications we propose stem from evaluating products of characters on the basis\nF\u03b1 of QSym. This requires knowledge of the coproduct of QSym on this basis. Consider\nall ways of cutting the ribbon diagram of \u03b1 into two pieces along the common boundary of\ntwo squares. We include the two trivial cuts along the first and last edges. Thus, if \u03b1 is a\ncomposition of n, there are n + 1 ways of cutting its diagram. For \u03b1 = (2, 3, 1, 2, 2), two\nnon-trivial cuts are shown below.\nL4 (\u03b1) =\n\u03b1=\n\n\u21d2\n\nR4 (\u03b1) =\n\nL5 (\u03b1) =\n\u03b1=\n\n\u21d2\n\nR5 (\u03b1) =\n\nLabel the edges between adjacent squares from 0 to n from left to right and top to bottom,\nincluding the first and last edges. Let Li (\u03b1) and Ri (\u03b1) be the compositions whose ribbon\ndiagrams are the resulting pieces after cutting the ribbon diagram of \u03b1 along edge i, with\n\n\f22\n\nM. AGUIAR AND S. HSIAO\n\nLi (\u03b1) corresponding to the left piece and Ri (\u03b1) to the right one. The two trivial cuts result\nin L0 (\u03b1) = ( ), R0 (\u03b1) = \u03b1, and Ln (\u03b1) = \u03b1, Rn (\u03b1) = ( ). The coproduct of QSym is [15,\nCorollaire 4.17]\n(36)\n\n\u2206(F\u03b1 ) =\n\nn\nX\n\nFLi (\u03b1) \u2297 FRi (\u03b1) .\n\ni=0\n\nThe counit is\n\n(\n1\n\u01eb(F\u03b1 ) =\n0\n\nif \u03b1 = ( ),\notherwise.\n\nWe abbreviate\n\u0001\nli+ (\u03b1) := p+ Li (\u03b1) ,\n\u0001\nli\u2212 (\u03b1) := p\u2212 Li (\u03b1) ,\n\n\u0001\ni\nr+\n(\u03b1) := p+ Ri (\u03b1) ,\n\u0001\ni\nr\u2212\n(\u03b1) := p\u2212 Ri (\u03b1) .\n\nProposition 6.1. For any composition \u03b1 of a positive integer n,\n\u230an/2\u230b\n\n(37)\n\nX\nj=0\n\n\u0001\n\u0001\n2j\n2j\n2j\n2j\n2j\n(\u22121)l+ (\u03b1)+r\u2212 (\u03b1) C l2j\n+ (\u03b1), j \u2212 l+ (\u03b1) C r\u2212 (\u03b1), \u230an/2\u230b \u2212 j \u2212 r\u2212 (\u03b1)\n=\n\n(38)\n\ni\ni\nn\nX\n(\u22121)l\u2212 (\u03b1)+r\u2212 (\u03b1)+i\n\ni=0\n\n4\n\n\u230a 2i \u230b+\u230a n\u2212i\n\u230b\n2\n\n(\n\n4\u230an/2\u230b\n0\n\nif \u03b1 = (n),\notherwise.\n\n\u0001\n\u0001\ni\ni\nC li\u2212 (\u03b1), \u230ai/2\u230b \u2212 li\u2212 (\u03b1) C r\u2212\n(\u03b1), \u230a(n \u2212 i)/2\u230b \u2212 r\u2212\n(\u03b1) = 0 .\n\nProof. Since \u03b6+ and \u03b6\u2212 are the even and odd parts of \u03b6, we have\nn\nX\n\u0001\n\u0001\n\u03b6(F\u03b1 ) = (\u03b6+ \u03b6\u2212 )(F\u03b1 ) =\n\u03b6+ FLi (\u03b1) \u03b6\u2212 FRi (\u03b1) .\ni=0\n\nNote that |Li (\u03b1)| = i. Hence, by (19), only the terms corresponding to even i contribute to\nthis sum. We evaluate these terms using (18), (19), and (2). The power of 2 that results in\nthe denominator is constant and equal to 2\u230an/2\u230b. Identity (37) follows.\nIdentity (38) follows similarly from (\u03b6\u0304\u2212 \u03b6\u2212 )(F\u03b1 ) = \u01eb(F\u03b1 ) = 0.\n\u0003\n\nVarious identities for bivariate Catalan numbers may be obtained through special choices\nof \u03b1 in Proposition 6.1. We discuss one case involving central Catalan numbers that is\nparticularly nice.\nWe refer to the following as central Catalan numbers:\n1\n1\n(39)\nC2 (h) := C(2h, h + 1) ,\nC1 (h) := C(2h + 1, h + 1) ,\n2\n2\n1\n1\nC3 (h) := C(2h, h) ,\nC4 (h) := C(2h + 1, h) .\n2\n2\n\n\fCANONICAL CHARACTERS\n\n23\n\nIt follows from (1) that\n\u0013\n\u0012\n4h + 2\n,\nC1 (h) =\nh\n\u0012 \u0013\n1 4h\n,\nC3 (h) =\n2 h\n\n\u0013\n\u0012\n2h + 1 4h + 1\nC2 (h) =\n,\nh\n4h + 1\n\u0013\n\u0012\n4h + 1\n.\nC4 (h) =\nh\n\nWe have the following wonderful convolution formulas for central Catalan numbers. Note\nthat on each side of each equation, the total sum of the subindices r in Cr is constant (equal\nto 6, 7, and 8 in each case). Ira Gessel has shown us how one may derive these identities via\ngenerating functions [12].\nCorollary 6.2. For any positive integer h,\nh\nX\n\n(40)\n\nC3 (j)C3 (h \u2212 j) = 2\n\nj=0\n\nh\nX\n\n(41)\n\nh\nX\n\nC2 (j)C1 (h \u2212 1 \u2212 j) ,\n\nj=0\n\nC3 (j)C4 (h \u2212 j) =\n\nh\nX\n\nC2 (j)C3 (h \u2212 j) +\n\nj=0\n\nj=0\n\n(42)\n\nh\u22121\nX\n\nC4 (j)C4 (h \u2212 j) = 2\n\nj=0\n\nh\u22121\nX\n\nC1 (j)C1 (h \u2212 1 \u2212 j) ,\n\nj=0\n\nh\nX\n\nC3 (j)C1 (h \u2212 j) .\n\nj=0\n\nProof. Let k be a positive integer and \u03b1 := (2, 1)k = (2, 1, 2, 1, . . . , 2, 1). Formula (36) gives\n\u2206(F\u03b1 ) =\n\nk\nX\n\nF(2,1)i \u2297 F(2,1)k\u2212i +\n\ni=0\n\nEquation (37) then leads to\nk\nX\n\ni=0\ni even\n\nk\u22121\nX\n\nF(2,1)i ,2 \u2297 F1,(2,1)k\u22121\u2212i +\n\ni=0\n\nC(i, i/2)C(k \u2212 i, \u230a(k \u2212 i)/2\u230b) =\n\nk\u22121\nX\n\nF(2,1)i ,1 \u2297 F1,1,(2,1)k\u22121\u2212i .\n\ni=0\n\nk\u22121\nX\n\nC(i, \u230ai/2\u230b + 1)C(k \u2212 1 \u2212 i, \u230ak/2\u230b \u2212 \u230ai/2\u230b) .\n\ni=0\n\nWhen k = 2h this is (40); when k = 2h + 1 this is (41).\nSimilarly, equation (38) for \u03b1 = (2, 1)k leads to (42) when k = 2h (and to a trivial identity\nwhen k = 2h + 1).\n\u0003\nMore identities may be derived from (18) and (19) by imposing the fact that \u03b6\u2212 and \u03b6+ are\nmorphisms of algebras. The multiplication of two basis elements F\u03b1 and F\u03b2 is most easily\ndescribed in terms of permutations. It is thus convenient to work on a larger Hopf algebra\nSSym, of which QSym is a quotient. This is the object of the next section.\n7. Identities for bivariate Catalan numbers via the Hopf algebra of\npermutations\nThe Hopf algebra of permutations SSym has a linear basis {F\u03c3 } indexed by permutations\n\u03c3 \u2208 Sn , n \u2265 0. The multiplication of two basis elements is as follows. Given \u03c3 \u2208 Sn and \u03c4 \u2208\n\n\f24\n\nM. AGUIAR AND S. HSIAO\n\nSm , let S(\u03c3, \u03c4 ) be the set of all shuffles of the words \u03c3(1), . . . , \u03c3(n) and n+\u03c4 (1), . . . , n+\u03c4 (m).\nThen\nX\n(43)\nF\u03c3 * F\u03c4 =\nF\u03c1 .\n\u03c1\u2208S(\u03c3,\u03c4 )\n\nFor example,\nF12 * F312 =\n\nF12534 + F15234 + F15324 + F15342 + F51234\n+ F51324 + F51342 + F53124 + F53142 + F53412 .\n\nFor more information on the Hopf algebra structure of SSym see [3].\nThe descent set of a permutation \u03c3 \u2208 Sn is\nDes(\u03c3) := {i \u2208 [n \u2212 1] | \u03c3(i) > \u03c3(i + 1)} .\nLet D(\u03c3) = (a1 , . . . , ak ) be the composition of n such that {a1 , a1 + a2 , . . . , a1 + * * * + ak\u22121 } =\nDes(\u03c3). The map\n(44)\n\nD : SSym \u2212\u2192 QSym\nF\u03c3 7\u2212\u2192 FD(\u03c3)\n\nis a surjective morphism of graded Hopf algebras [15, Th\u00e9or\u00e8mes 5.12, 5.13, and 5.18].\nLet \u03b6S denote the pull-back of the universal character \u03b6 of QSym via the morphism D:\n\u03b6S := \u03b6 \u25e6 D .\nAccording to Lemma 2.2, the even and odd parts of \u03b6S are\n(45)\n\n(\u03b6S )+ = \u03b6+ \u25e6 D and (\u03b6S )\u2212 = \u03b6\u2212 \u25e6 D .\n\nWe describe these characters directly in terms of permutations.\nAs in [1], consider the following two slightly differing notions of a peak set of a permutation\n\u03c3 \u2208 Sn :\nPeak0 (\u03c3) := {i \u2208 [n \u2212 1] | i 6= 1, \u03c3(i \u2212 1) < \u03c3(i) > \u03c3(i + 1)} ,\nPeak(\u03c3) := {i \u2208 [n \u2212 1] | \u03c3(i \u2212 1) < \u03c3(i) > \u03c3(i + 1)} ,\nwhere we agree that \u03c3(0) = 0. For instance, if \u03c3 = 312546 then Peak0 (\u03c3) = {4} and\nPeak(\u03c3) = {1, 4}. The study of peak enumeration has a long history, but the connections\nbetween peaks and quasi-symmetric functions originate in work of Stembridge [19].\n5r\n3r\n0r\nr\n\n0\n\n\u2745 1\n\u2745r\nr\nr\n\n1\n\n2\n\n2r\n\n\u2745 4\n\u2745r\n\n6r\n\nr\n\nr\n\nr\n\nr\n\n3\n\n4\n\n5\n\n6\n\n\fCANONICAL CHARACTERS\n\n25\n\nNote that Peak0 (\u03c3) and Peak(\u03c3) depend only on Des(\u03c3). In fact,\ni \u2208 Peak(\u03c3) \u21d0\u21d2 i \u2208 Des(\u03c3) and i \u2212 1 \u2208\n/ Des(\u03c3) ,\ni \u2208 Peak0 (\u03c3) \u21d0\u21d2 i \u2208 Peak(\u03c3) and i 6= 1 .\nWe write p\u2212 (\u03c3) := #Peak0 (\u03c3) and p+ (\u03c3) := #Peak(\u03c3).\nfrom (15), (16), and the above that\n(46)\n\np\u2212 (\u03c3) = p\u2212 (\u03b1)\n\nand\n\nLet \u03b1 := D(\u03c3).\n\nIt follows\n\np+ (\u03c3) = p+ (\u03b1) .\n\nProposition 7.1. Let \u03c3 \u2208 Sn be a permutation. Then\n(47)\n(48)\n\n(\u22121)p\u2212 (\u03c3)\nC (p\u2212 (\u03c3), \u230an/2\u230b \u2212 p\u2212 (\u03c3)) .\n2\u230an/2\u230b\n\uf8f12\n\uf8f2 (\u22121)p+ (\u03c3)\nC (p+ (\u03c3), n/2 \u2212 p+ (\u03c3))\nn\n(\u03b6S )+ (F\u03c3 ) =\n\uf8f3 0 2\n(\u03b6S )\u2212 (F\u03c3 ) =\n\nif n is even,\nif n is odd.\n\nProof. This follows at once from Theorem 5.1 together with (44), (45) and (46).\n\n\u0003\n\nWe may now deduce the identities for bivariate Catalan numbers announced at the end of\nSection 6.\nCorollary 7.2. For any non-negative integer n,\nX\n\u0001\n(49)\n(\u22121)p\u2212 (\u03c3) C p\u2212 (\u03c3), \u230an/2\u230b \u2212 p\u2212 (\u03c3) = 22\u230an/2\u230b ,\n\u03c3\u2208Sn\n\nand for any even positive integer n,\nX\n\u0001\n(50)\n(\u22121)p+ (\u03c3) C p+ (\u03c3), n/2 \u2212 p+ (\u03c3) = 0 .\n\u03c3\u2208Sn\n\nProof. Consider the n-th power of the basis element indexed by the permutation 1 \u2208 S1 in\nthe algebra SSym. Since S(1, 1, . . . , 1) = Sn , (43) gives\nX\nF\u03c3 .\n(F1 )n =\n\u03c3\u2208Sn\n\nApplying (\u03b6S )\u2212 to both sides, using that it is a morphism of algebras and (47), we deduce (49).\nSimilarly, applying (\u03b6S )+ we obtain (50).\n\u0003\n\nLet 1n denote the identity permutation in Sn . Note that S(1n , 1m ) is the set of those\npermutations \u03c3 \u2208 Sn+m such that\n\u03c3 \u22121 (1) < * * * < \u03c3 \u22121 (n), \u03c3 \u22121 (n + 1) < * * * < \u03c3 \u22121 (n + m) .\nCorollary 7.3. Let n, m be non-negative integers. Then\nX\n\u0001\n(51)\n(\u22121)p\u2212 (\u03c3) C p\u2212 (\u03c3), \u230a(n + m)/2\u230b \u2212 p\u2212 (\u03c3)\n\u03c3\u2208S(1n ,1m )\n\n(\nC(0, \u230an/2\u230b)C(0, \u230am/2\u230b)\n=\n4C(0, \u230an/2\u230b)C(0, \u230am/2\u230b)\n\nif n or m is even,\nif n and m are odd.\n\n\f26\n\nM. AGUIAR AND S. HSIAO\n\n(52)\n\nX\n\n(\u22121)p+ (\u03c3) C p+ (\u03c3), (n + m)/2 \u2212 p+ (\u03c3)\n\n\u03c3\u2208S(1n ,1m )\n\n\u0001\n\n(\nC(0, n/2)C(0, m/2)\n=\n0\n\nProof. By (43),\nF1n * F1m =\n\nX\n\nif n and m are even,\nif n and m are odd.\n\nF\u03c3 .\n\n\u03c3\u2208S(1n ,1m )\n\nApplying (\u03b6S )\u2212 we deduce (51) and applying (\u03b6S )+ we deduce (52).\n\n\u0003\n\n8. Inverses of canonical characters and more applications\nThe set of characters of a Hopf algebra H is a group under the convolution product\n(Section 1). The inverse of a character \u03c6 is \u03c6 \u25e6 S, where S is the antipode of H.\nProposition 8.1. The inverse of the universal character \u03b6 of QSym is explicitly given by\n(\n(\u22121)|\u03b1| if \u03b1 = (1, 1, . . . , 1),\n\u22121\nk(\u03b1)\n\u22121\n(53)\n\u03b6 (M\u03b1 ) = (\u22121)\n,\n\u03b6 (F\u03b1 ) =\n0\nif not.\nProof. This follows at once from the explicit formulas for the antipode of QSym (12) and (31).\n\u0003\nInverting the canonical decomposition \u03b6 = \u03b6+ \u03b6\u2212 we obtain\n\u0011\n\u0010\n\u0011\n\u0010\n\u03b6 \u22121 = (\u03b6\u2212 )\u22121 (\u03b6+ )\u22121 = (\u03b6+ )\u22121 \u03b6+ (\u03b6\u2212 )\u22121 (\u03b6+ )\u22121 = (\u03b6+ )\u22121 \u03b6+ \u03b6\u0304\u2212 (\u03b6+ )\u22121 .\n\nThe set of even characters is a subgroup of the group of characters, and the set of odd\ncharacters is closed under conjugation by even characters [2, Proposition 1.7]. In particular,\n(\u03b6+ )\u22121 is even and \u03b6+ \u03b6\u0304\u2212 (\u03b6+ )\u22121 is odd. According to Lemma 2.1, these are the even and odd\nparts of \u03b6 \u22121:\n(54)\n\n(\u03b6 \u22121 )+ = (\u03b6+ )\u22121 and (\u03b6 \u22121 )\u2212 = \u03b6+ \u03b6\u0304\u2212 (\u03b6+ )\u22121 .\n\nWe provide explicit descriptions for these characters below. First, we analyze the behavior\nof the map T : QSym \u2192 QSym (Remark 5.9) with respect to the canonical decomposition\nof \u03b6.\nProposition 8.2. We have\n(55)\n\n\u03b6+ \u25e6 T = \u03b6+ and \u03b6\u2212 \u25e6 T = (\u03b6 \u22121)\u2212\n\n\u0001\u22121\n\n.\n\nProof. Both S and T are antimorphism of coalgebras and morphisms of algebras QSym \u2192\nQSym. In addition, \u03b6 \u25e6 S = \u03b6 \u22121 and \u03b6 \u25e6 T = \u03b6; the latter being an immediate consequence\nof (2) and (32). Therefore, T \u25e6 S : QSym \u2192 QSym is a morphism of Hopf algebras such\nthat \u03b6 \u25e6 T \u25e6 S = \u03b6 \u22121 . According to Lemma 2.2 we have\n(\u03b6 \u22121)+ = \u03b6+ \u25e6 T \u25e6 S and (\u03b6 \u22121)\u2212 = \u03b6\u2212 \u25e6 T \u25e6 S .\n\u0001\u22121\nComposing with S we find \u03b6+ \u25e6 T = (\u03b6 \u22121 )+ \u25e6 S = (\u03b6 \u22121)+\n= \u03b6+ , by (54), and \u03b6\u2212 \u25e6 T =\n\u0001\u22121\n\u22121\n\u22121\n(\u03b6 )\u2212 \u25e6 S = (\u03b6 )\u2212 .\n\u0003\n\n\fCANONICAL CHARACTERS\n\n27\n\nRemark 8.3. The fact that \u03b6+ \u25e6 T = \u03b6+ was observed in Remark 5.9. The fact that\n\u0001\u22121\n\u03b6\u2212 \u25e6 T = (\u03b6 \u22121 )\u2212\nmay be rewritten as follows:\n(\u03b6 \u22121)\u2212 = \u03b6\u0304\u2212 \u25e6 T .\n\n(56)\n\nIndeed, any morphism (or antimorphism) preserves inverses, so\n(\u03b6 \u22121)\u2212 = \u03b6\u2212 \u25e6 T\n\n\u0001\u22121\n\n= (\u03b6\u2212 )\u22121 \u25e6 T = \u03b6\u0304\u2212 \u25e6 T ,\n\nsince \u03b6\u2212 is odd. We use this formula to calculate (\u03b6 \u22121)\u2212 below.\nTheorem 8.4. Let \u03b1 = (a1 , . . . , ak ) be a composition of a non-negative integer n. Then\n\n(57)\n\n(58)\n\n\uf8f1\nk(\u03b1)\n\u0001\n\uf8f4\n\uf8f2 (\u22121)\nC\n0,\n\u230ak\n(\u03b1)/2\u230b\no\n2\u230ak\n(\u03b1)/2\u230b\n\u22121\n(\u03b6 )\u2212 (M\u03b1 ) = 2 o\n\uf8f4\n\uf8f3\n0\n\uf8f1\nk(\u03b1)\n\u0001\n\uf8f4\n\uf8f2 (\u22121)\nC\n0,\nk\n(\u03b1)/2\nif\no\nk\n(\u03b1)\n\u22121\n2o\n(\u03b6 )+ (M\u03b1 ) =\n\uf8f4\n\uf8f3\n0\nif\n\nif a1 is odd,\nif a1 is even.\nn is even,\nn is odd;\n\nProof. According to (56) and (33),\n\n\u0001\n(\u03b6 \u22121 )\u2212 (M\u03b1 ) = \u03b6\u0304\u2212 T (M\u03b1 ) = (\u22121)n \u03b6\u2212 (M\u03b1\u0303 ) ,\n\nwhich we can evaluate with (7). To see that this results in (57), note that since \u03b1\u0303 is the\nreversal of \u03b1, the last part of \u03b1\u0303 is a1 , ko (\u03b1\u0303) = ko (\u03b1), and by (6)\nn + ke (\u03b1\u0303) = n + ke (\u03b1) \u2261 ko (\u03b1) + ke (\u03b1) = k(\u03b1) .\nTo settle the remaining identity we give a direct argument. Let \u03c6 : QSym \u2192 k be the\nlinear functional defined by (58). We show that \u03b6+ \u03c6 = \u01eb, which implies \u03c6 = (\u03b6+ )\u22121 = (\u03b6 \u22121)+ .\nSince \u03c6(M( ) ) = 1, we have (\u03b6+ \u03c6)(M( ) ) = 1 = \u01eb(M( ) ).\nAssume from now on that n > 0. We need to show (\u03b6+ \u03c6)(M\u03b1 ) = 0. Write \u03b1 = (a1 , . . . , ak )\nand recall the notations \u03b1i and \u03b1i from (3).\nIf n is odd then for each i one of |\u03b1i | and |\u03b1i | is odd, so every term in the expansion (3)\nof (\u03b6+ \u03c6)(M\u03b1 ) is 0, by (8) and (58). Assume from now on that n is even.\nIf k = 1 (i.e., \u03b1 = (n)), then (\u03b6+ \u03c6)(M(n) ) = \u03c6(M(n) ) + \u03b6+ (M(n) ) = \u22121 + 1 = 0.\nIf k > 1 and a1 is even, then \u03c6(M\u03b1 ) = \u2212\u03c6(M\u03b11 ) (since \u03b11 has one less part than \u03b1 and\nthe same number of odd parts), and \u03b6+ (M\u03b1i ) = 0 when i > 1 by (8). Thus,\n(\u03b6+ \u03c6)(M\u03b1 ) = \u03c6(M\u03b1 ) + \u03b6+ (M(a1 ) )\u03c6(M\u03b11 ) = \u03c6(M\u03b1 ) + \u03c6(M\u03b11 ) = 0.\n\n\f28\n\nM. AGUIAR AND S. HSIAO\n\nSuppose finally that k > 1 and a1 is odd. Using (3) and (8) we compute\nX (\u22121)ke (\u03b1i )+1\n\u0001\n\u0001\n\u0001 (\u22121)k(\u03b1i )\n(\u22121)k(\u03b1)\ni\n(\u03b6+ \u03c6)(M\u03b1 ) =\nB\nk\n(\u03b1)/2\n+\nC\nk\n(\u03b1\n)/2\n\u2212\n1\no\no\ni\ni ) B ko (\u03b1 )/2\nk\n(\u03b1)\nk\n(\u03b1\n)\u22121\nk\n(\u03b1\n2o\n2o i\n2o\n1\u2264i\u2264k\nai odd\n|\u03b1i | even\n\n=\n\n\u0001\n\u0001\n\u0001 (\u22121)k+1 X\n(\u22121)k\ni\nC\nk\n(\u03b1\n)/2\n\u2212\n1\nB\nk\n(\u03b1\n)/2\n.\nB\nk\n(\u03b1)/2\n+\no\ni\no\no\nk\n(\u03b1)\nk\n(\u03b1)\u22121\n2o\n2o\n1\u2264i\u2264k\nai odd\n|\u03b1i | even\n\nTo combine the signs in the last step we used k = k(\u03b1) \u2261 ke (\u03b1i ) + k(\u03b1i ) mod 2, which holds\nby (6) and since |\u03b1i |, |\u03b1i |, and |\u03b1| are all even. The argument may now be completed as in\nthe proof of Theorem 3.2, Case 5.\n\u0003\nWe present some applications. The first one is an identity which appears in [16, Section\n4.2, Example 2] (near the bottom of page 130).\nCorollary 8.5. For any positive integer m,\nm\u22121\nX\n\n(59)\n\n2\n\n2m\u22122j\u22121\n\nC(j) = 2\n\nj=0\n\n2m\n\n\u0013\n2m\n.\n\u2212\nm\n\u0012\n\nProof. We have \u03b6 \u22121 = (\u03b6 \u22121 )+ (\u03b6 \u22121)\u2212 = (\u03b6+ )\u22121 (\u03b6 \u22121)\u2212 , so (\u03b6 \u22121)\u2212 = \u03b6+ \u03b6 \u22121. We evaluate both\nsides on M\u03b1 with \u03b1 = (1, 1, . . . , 1) \u000f 2m. Equations (8), (53), and (57) lead to\n2m\nX\n\u22121\nC(0, m) = 1 +\nC(1, i/2 \u2212 1) .\n2m\n2\n2i\ni=2\n\n1\n\ni even\n\nLetting j = 2i + 2 we obtain (59).\n\n\u0003\n\nThe following identity is analogous to (13).\nCorollary 8.6. For any composition \u03b2 of an even integer,\n\u0013\n\u0012\nX\n\u0001\nko (\u03b2)\nke (\u03b1) ko (\u03b2)\u2212ko (\u03b1)+1\nko (\u03b2)\n;\n(\u22121)\n2\nC ko (\u03b1)/2 \u2212 1 = 2\n\u2212\n(60)\nk\no (\u03b2)/2\n\u03b1\u2264\u03b2\na1 ,ak odd\n\nthe sum being over those compositions \u03b1 = (a1 , . . . , ak ) whose first and last part are odd and\nwhich are refined by \u03b2.\nProof. By (54),\n\u03b6+ \u25e6 S = (\u03b6+ )\u22121 = (\u03b6 \u22121 )+ .\nTherefore, for any composition \u03b2 of n we have, by (12),\nX\n(\u22121)k(\u03b2)\n\u03b6+ (M\u03b1 ) = (\u22121)n (\u03b6 \u22121)+ (M\u03b2 ) .\n\u03b1\u2264\u03b2\u0303\n\n\fCANONICAL CHARACTERS\n\n29\n\nHence, by (8) and (58), and since n is even,\nX\n\n(\u22121)k(\u03b2) + (\u22121)k(\u03b2)\n\n\u03b1\u2264\u03b2\u0303\na1 ,ah odd\n\n(\u22121)k(\u03b2)\n(\u22121)ke (\u03b1)+1\nC(1,\nk\n(\u03b1)/2\n\u2212\n1)\n=\nC(0, ko (\u03b2)/2) .\no\n2ko (\u03b1)\n2ko (\u03b2)\n\nThe above sum remains unchanged if we replace \u03b2 for \u03b2\u0303. Multiplying by 2ko (\u03b2) gives (60). \u0003\nOn the fundamental basis, the even and odd parts of \u03b6 \u22121 are most easily described in\nterms of the statistics p+ (\u03b1\u2032) and p\u2212 (\u03b1\u0303) (Remark 5.10). They may be described directly in\nterms of p+ (\u03b1) and p\u2212 (\u03b1) by means of formulas (34) and (35).\nTheorem 8.7. Let \u03b1 = (a1 , . . . , ak ) be a composition of a non-negative integer n. Then\n(61)\n(62)\n\n\u0001\n(\u22121)n+p\u2212 (\u03b1\u0303)\nC\np\n(\n\u03b1\u0303),\n\u230an/2\u230b\n\u2212\np\n(\n\u03b1\u0303)\n\u2212\n\u2212\n2\u230an/2\u230b\n\uf8f12\np+ (\u03b1\u2032 )\n\u0001\n\uf8f4\n\uf8f2 (\u22121)\nC p+ (\u03b1\u2032 ), n/2 \u2212 p+ (\u03b1\u2032 ) if n is even,\nn\n\u22121\n2\n(\u03b6 )+ (F\u03b1 ) =\n\uf8f4\n\uf8f3\n0\nif n is odd.\n(\u03b6 \u22121 )\u2212 (F\u03b1 ) =\n\nProof. Assume that n is even, n 6= 0. We have, by (31) and (54),\n\n(\u03b6 \u22121)+ (F\u03b1 ) = (\u03b6+ )\u22121 (F\u03b1 ) = (\u03b6+ \u25e6 S)(F\u03b1 ) = \u03b6+ (F\u03b1\u2032 ) .\nFormula (62) now follows from (19). Formula (61) follows similarly from (18) and (56).\nAs an application we derive a recursive formula for the bivariate Catalan numbers.\nCorollary 8.8. For any non-negative integers a, b, and c,\n(63)\n\nc\n\nC(b, a + c) = 4 C(b, a) \u2212\n\nc\nX\n\n4c\u2212j C(b + 1, a + j \u2212 1) .\n\nj=1\n\nProof. We evaluate both sides of (\u03b6 \u22121)\u2212 = \u03b6+ \u03b6 \u22121 on F\u03b1 with\n\u03b1 = (1, . . . , 1, 2, . . . , 2, 1, . . . , 1) .\n| {z } | {z } | {z }\n2a+1\n\nAccording to (36),\n(\u03b6+ \u03b6\n\n\u22121\n\n)(F\u03b1 ) =\n\nn\nX\ni=0\n\nb\n\n2c\n\n\u03b6+ (FLi (\u03b1) )\u03b6 \u22121 (FRi (\u03b1) ) .\n\n\u0003\n\n\f30\n\nM. AGUIAR AND S. HSIAO\n\nSeveral terms in this expansion vanish, in view of (19) and (53): all those for which the size\nof Li (\u03b1) is odd and all those for which Ri (\u03b1) 6= (1, . . . , 1). We are left with\n(\u03b6+ \u03b6 \u22121 )(F\u03b1 ) = \u03b6+ (F(1, . . . , 1,2, . . . , 2,1) )\u03b6 \u22121(F(1, . . . , 1) )\n| {z } | {z }\n| {z }\n2a+1\n\n+\n\n2c\u22121\nX\n\ni=1\ni odd\n\n=\n\n2c+1\n\nb\u22121\n\n\u03b6+ (F(1, . . . , 1,2, . . . , 2,1, . . . , 1) )\u03b6 \u22121 (F(1, . . . , 1) )\n| {z }\n| {z } | {z } | {z }\n2a+1\n\n(\u22121)b\nC(b, a)(\u22121)2c+1 +\n22(a+b)\n\n2c\u2212i\n\ni\n\nb\n\n2c\u22121\nX\n\ni=1\ni odd\n\n(\u22121)b+1\n\n22(a+b)+i+1\n\nC(b + 1, a + (i + 1)/2 \u2212 1)(\u22121)2c\u2212i\n\nc\n\nX (\u22121)b\n(\u22121)b+1\nC(b + 1, a + j \u2212 1) .\n= 2(a+b) C(b, a) +\n2\n22(a+b+j)\nj=1\n\nWe used that p+ (1, . . . , 1, 2, . . . , 2, 1) = b and for i \u2265 1, p+ (1, . . . , 1, 2, . . . , 2, 1, . . . , 1) = b + 1.\n| {z } | {z } | {z }\n| {z } | {z }\n2a+1\n\n2a+1\n\nb\u22121\n\nb\n\ni\n\nOn the other hand, p\u2212 (\u03b1) = b, so by (61),\n\n(\u22121)2(a+b+c)+1+b\nC(b, a + c) .\n22(a+b+c)\nEquating (\u03b6 \u22121 )\u2212 (F\u03b1 ) to (\u03b6+ \u03b6 \u22121)(F\u03b1 ) gives (63).\n(\u03b6 \u22121 )\u2212 (F\u03b1 ) =\n\n\u0003\n\nA few special cases of Corollary 8.8 are worth stating. We obtain formulas expressing a\ncentral binomial coefficient or a Catalan number in terms of bivariate Catalan numbers.\nCorollary 8.9. For any non-negative integers b and c,\n\u0012 \u0013\nc\nX\n1\n1\n2b\n(64)\nC(b + 1, j \u2212 1) ,\n= c C(b, c) +\nj\n4\n4\nb\nj=1\nc\n\n(65)\n\n2C(b) =\n\nX 1\n1\nC(b,\nc\n+\n1)\n+\nC(b + 1, j) .\nj\n4c\n4\nj=1\n\nProof. These follow by choosing a = 0 and a = 1 in (63).\n\n\u0003\n\nCorollary 8.10. Let H(a, b, c) := C(a, b + c) \u2212 C(b, a + c). Then\nc\nX\n1\n1\nH(a, b, c) =\nH(b + 1, a + 1, j \u2212 2) .\n(66)\nc\nj\n4\n4\nj=1\nProof. This follows from (63) since C(a, b) = C(b, a).\nAppendix. Bivariate Catalan numbers as binomial coefficients\nUsing the easily verified formula\nn m+n\n\nC(m, n) = (\u22121) 4\n\n\u0013\n\u0012\nm \u2212 1/2\n,\nm+n\n\n\u0003\n\n\fCANONICAL CHARACTERS\n\n31\n\none may restate all results in this paper in terms of binomial coefficients. This allows for\nsimplifications in some of the formulas. We list here our main results in this notation. Let\n\u03b1 = (a1 , . . . , ak ) be a composition of n.\n\n(67)\n\n(68)\n\n(69)\n\n(70)\n\n(71)\n\n(72)\n\n(73)\n\n(74)\n\n\u03b6\u2212 (M\u03b1 ) =\n\n\u03b6+ (M\u03b1 ) =\n\n\uf8f1\n\uf8f2\n\n\uf8f3\n\uf8f1\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f2\n\n\u0013\n\u22121/2\nif ak is odd,\n(\u22121)\n\u230ako (\u03b1)/2\u230b\n0\nif ak is even;\n\u0013\n\u0012\nko (\u03b1)\n1/2\n(\u22121)ke (\u03b1)+ 2\nif a1 and ak are odd and n is even,\nko (\u03b1)/2\n\n\uf8f4\n\uf8f4\n\uf8f4\n\uf8f3 1\n0\n\nke (\u03b1)+\u230a ko2(\u03b1) \u230b\n\n\u0012\n\nif \u03b1 = (n) and n is even,\notherwise;\n\n\u0013\n\u0012\np\u2212 (\u03b1) \u2212 1/2\n;\n\u03b6\u2212 (F\u03b1 ) = (\u22121)\n\u230an/2\u230b\n\uf8f1\n\u0013\n\u0012\n\uf8f4\nn\np\n(\u03b1)\n\u2212\n1/2\n\uf8f4\n+\n\uf8f2 (\u22121) 2\nif n is even,\nn/2\n\u03b6+ (F\u03b1 ) =\n\uf8f4\n\uf8f4\n\uf8f3 0\nif n is odd;\n\u0013\n\u0012\n\uf8f1\nko (\u03b1)\n\u22121/2\n\u230b\nk(\u03b1)+\u230a\n\uf8f4\n2\n\uf8f2(\u22121)\nif a1 is odd,\n\u230ako (\u03b1)/2\u230b\n(\u03b6 \u22121 )\u2212 (M\u03b1 ) =\n\uf8f4\n\uf8f3\n0\nif a1 is even;\n\u0013\n\u0012\n\uf8f1\nko (\u03b1)\n\u22121/2\n\uf8f4\n\uf8f2(\u22121)k(\u03b1)+ 2\nif n is even,\nko (\u03b1)/2\n(\u03b6 \u22121 )+ (M\u03b1 ) =\n\uf8f4\n\uf8f3\n0\nif n is odd;\n\u0013\n\u0012\nn+1\np\u2212 (\u03b1\u0303) \u2212 1/2\n(\u03b6 \u22121)\u2212 (F\u03b1 ) = (\u22121)\u230a 2 \u230b\n;\n\u230an/2\u230b\n\uf8f1\n\u0013\n\u0012\n\u2032\n\uf8f4\n\uf8f4\n\uf8f2 (\u22121) n2 p+ (\u03b1 ) \u2212 1/2\nif n is even,\nn/2\n(\u03b6 \u22121)+ (F\u03b1 ) =\n\uf8f4\n\uf8f4\n\uf8f3 0\nif n is odd.\n\u230an\n\u230b\n2\n\nWe mention that the convolution powers of the universal character are\n\u0013\n\u0012\nm\nm\n,\n(75)\n\u03b6 (M\u03b1 ) =\nk(\u03b1)\n(76)\n\n\u0013\n\u0012\nm + n \u2212 k(\u03b1)\n,\n\u03b6 (F\u03b1 ) =\nn\nm\n\nfor any integer m [2, Formula (4.4)].\n\n\f32\n\nM. AGUIAR AND S. HSIAO\n\nReferences\n[1] Marcelo Aguiar, Nantel Bergeron, and Kathryn Nyman, The peak algebra and the descent algebras of\ntypes B and D, Trans. Amer. Math. Soc. 356 (2004), 2781\u20132824.\n[2] Marcelo Aguiar, Nantel Bergeron, and Frank Sottile, Combinatorial Hopf algebras and generalized DehnSommerville relations, 2003. math.CO/0310016\n[3] Marcelo Aguiar and Frank Sottile, Structure of the Malvenuto-Reutenauer Hopf algebra of permutations,\nto appear in Adv. Math., math.CO/0203282.\n[4] Eug\u00e8ne Catalan, Question 1135, Nouvelles annales de math\u00e9matiques: Journal des candidats aux \u00e9coles\npolytechniques et normales, Series 2, 13 (1874), 207.\n[5] Eug\u00e8ne Catalan, M\u00e9langes Math\u00e9matiques, Tome II, Bruxelles, F. Hayez, 1887. Published also in Extrait\ndes M\u00e9moires de la soci\u00e9t\u00e9 royale des sciences de Li\u00e8ge, 2e s\u00e9r. , XIII, Paris, Gauthier-Villars, 1885.\n[6] Eug\u00e8ne Catalan, M\u00e9moire sur quelques d\u00e9compositions en carr\u00e9s, Atti dell'Accademia Pontificia Romana\nde Nuovi Lincei, v. XXXVII, sessione I (1883), 49\u2013114.\n[7] Richard Ehrenborg, On posets and Hopf algebras, Adv. Math. 119 (1996), no. 1, 1\u201325.\n[8] \u00d6mer E\u011fecio\u011flu and Alastair King, Random walks and Catalan factorization, Proceedings of the Thirtieth Southeastern International Conference on Combinatorics, Graph Theory, and Computing (Boca\nRaton, FL, 1999). Congr. Numer. 138 (1999), 129\u2013140.\n[9] F. Fares, Quelques constructions d'alg\u00e8bres et de coalg\u00e8bres, Universit\u00e9 du Qu\u00e9bec \u00e0 Montr\u00e9al (1999).\n[10] Ira Gessel, Multipartite P -partitions and products of skew Schur functions, in Combinatorics and Algebra\n(Boulder, Colo., 1983), C. Greene, ed., vol. 34 of Contemp. Math. AMS (1984) pp. 289\u2013317.\n[11] Ira Gessel, Super ballot numbers, J. Symbolic Comput. 14 (1992), no. 2-3, 179\u2013194.\n[12] Ira Gessel, private communication (2004).\n[13] Henry W. Gould, Combinatorial identities. Morgantown, W. Va., 1972.\n[14] Michael E. Hoffman, Quasi-shuffle products, J. Algebraic Combin. 11 (2000), no. 1, 49\u201368.\n[15] Claudia Malvenuto, Produits et coproduits des fonctions quasi-sym\u00e9triques et de l'alg\u00e8bre des descents,\nno. 16, Laboratoire de combinatoire et d'informatique math\u00e9matique (LACIM), Univ. du Qu\u00e9bec \u00e0\nMontr\u00e9al, Montr\u00e9al, 1994.\n[16] John Riordan, Combinatorial identities. John Wiley & Sons, New York, 1968.\n[17] Richard Stanley, Ordered structures and partitions, Mem. Amer. Math. Soc. 119 (1972).\n[18] Richard Stanley, Enumerative combinatorics. Vol. 2, Cambridge University Press, Cambridge, 1999,\nWith a foreword by Gian-Carlo Rota and appendix 1 by Sergey Fomin.\n[19] John Stembridge, Enriched P -partitions, Trans. AMS 349 (1997) 763\u2013788.\n[20] Jean-Yves Thibon and B.-C.-V. Ung, Quantum quasi-symmetric functions and Hecke algebras, J. Phys.\nA 29 (1996), no. 22, 7337\u20137348.\n[21] Koloman von Szily, \u00dcber die quadratsummen der binomialcoefficienten, Mathematische und naturwissenschaftliche Berichte aus Ungarn (Ungar. Ber.) 12 (1893), 84\u201391.\nDepartment of Mathematics, Texas A&M University, College Station, TX 77843, USA\nE-mail address: maguiar@math.tamu.edu\nURL: http://www.math.tamu.edu/\u223cmaguiar\nDepartment of Mathematics, University of Michigan, Ann Arbor, MI 48109, USA\nE-mail address: shsiao@umich.edu\nURL: http://www.math.lsa.umich.edu/\u223cshsiao/\n\n\f"}